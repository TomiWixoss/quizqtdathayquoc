function _j(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function HI(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $I={exports:{}},cm={},zI={exports:{}},Bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ru=Symbol.for("react.element"),wj=Symbol.for("react.portal"),bj=Symbol.for("react.fragment"),Tj=Symbol.for("react.strict_mode"),Cj=Symbol.for("react.profiler"),kj=Symbol.for("react.provider"),Nj=Symbol.for("react.context"),Ej=Symbol.for("react.forward_ref"),Sj=Symbol.for("react.suspense"),Ij=Symbol.for("react.memo"),Aj=Symbol.for("react.lazy"),jT=Symbol.iterator;function Rj(e){return e===null||typeof e!="object"?null:(e=jT&&e[jT]||e["@@iterator"],typeof e=="function"?e:null)}var KI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WI=Object.assign,QI={};function ll(e,t,n){this.props=e,this.context=t,this.refs=QI,this.updater=n||KI}ll.prototype.isReactComponent={};ll.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ll.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function YI(){}YI.prototype=ll.prototype;function F0(e,t,n){this.props=e,this.context=t,this.refs=QI,this.updater=n||KI}var U0=F0.prototype=new YI;U0.constructor=F0;WI(U0,ll.prototype);U0.isPureReactComponent=!0;var FT=Array.isArray,XI=Object.prototype.hasOwnProperty,O0={current:null},JI={key:!0,ref:!0,__self:!0,__source:!0};function ZI(e,t,n){var i,r={},s=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)XI.call(t,i)&&!JI.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];r.children=c}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Ru,type:e,key:s,ref:o,props:r,_owner:O0.current}}function Pj(e,t){return{$$typeof:Ru,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function B0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ru}function Mj(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var UT=/\/+/g;function Op(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Mj(""+e.key):t.toString(36)}function cg(e,t,n,i,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ru:case wj:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+Op(o,0):i,FT(r)?(n="",e!=null&&(n=e.replace(UT,"$&/")+"/"),cg(r,t,n,"",function(h){return h})):r!=null&&(B0(r)&&(r=Pj(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(UT,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",FT(e))for(var a=0;a<e.length;a++){s=e[a];var c=i+Op(s,a);o+=cg(s,t,n,c,r)}else if(c=Rj(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=i+Op(s,a++),o+=cg(s,t,n,c,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function wd(e,t,n){if(e==null)return e;var i=[],r=0;return cg(e,i,"","",function(s){return t.call(n,s,r++)}),i}function Dj(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qn={current:null},lg={transition:null},Lj={ReactCurrentDispatcher:Qn,ReactCurrentBatchConfig:lg,ReactCurrentOwner:O0};function tA(){throw Error("act(...) is not supported in production builds of React.")}Bt.Children={map:wd,forEach:function(e,t,n){wd(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return wd(e,function(){t++}),t},toArray:function(e){return wd(e,function(t){return t})||[]},only:function(e){if(!B0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Bt.Component=ll;Bt.Fragment=bj;Bt.Profiler=Cj;Bt.PureComponent=F0;Bt.StrictMode=Tj;Bt.Suspense=Sj;Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lj;Bt.act=tA;Bt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=WI({},e.props),r=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=O0.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)XI.call(t,c)&&!JI.hasOwnProperty(c)&&(i[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];i.children=a}return{$$typeof:Ru,type:e.type,key:r,ref:s,props:i,_owner:o}};Bt.createContext=function(e){return e={$$typeof:Nj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kj,_context:e},e.Consumer=e};Bt.createElement=ZI;Bt.createFactory=function(e){var t=ZI.bind(null,e);return t.type=e,t};Bt.createRef=function(){return{current:null}};Bt.forwardRef=function(e){return{$$typeof:Ej,render:e}};Bt.isValidElement=B0;Bt.lazy=function(e){return{$$typeof:Aj,_payload:{_status:-1,_result:e},_init:Dj}};Bt.memo=function(e,t){return{$$typeof:Ij,type:e,compare:t===void 0?null:t}};Bt.startTransition=function(e){var t=lg.transition;lg.transition={};try{e()}finally{lg.transition=t}};Bt.unstable_act=tA;Bt.useCallback=function(e,t){return Qn.current.useCallback(e,t)};Bt.useContext=function(e){return Qn.current.useContext(e)};Bt.useDebugValue=function(){};Bt.useDeferredValue=function(e){return Qn.current.useDeferredValue(e)};Bt.useEffect=function(e,t){return Qn.current.useEffect(e,t)};Bt.useId=function(){return Qn.current.useId()};Bt.useImperativeHandle=function(e,t,n){return Qn.current.useImperativeHandle(e,t,n)};Bt.useInsertionEffect=function(e,t){return Qn.current.useInsertionEffect(e,t)};Bt.useLayoutEffect=function(e,t){return Qn.current.useLayoutEffect(e,t)};Bt.useMemo=function(e,t){return Qn.current.useMemo(e,t)};Bt.useReducer=function(e,t,n){return Qn.current.useReducer(e,t,n)};Bt.useRef=function(e){return Qn.current.useRef(e)};Bt.useState=function(e){return Qn.current.useState(e)};Bt.useSyncExternalStore=function(e,t,n){return Qn.current.useSyncExternalStore(e,t,n)};Bt.useTransition=function(){return Qn.current.useTransition()};Bt.version="18.3.1";zI.exports=Bt;var I=zI.exports;const st=HI(I),Vj=_j({__proto__:null,default:st},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qj=I,jj=Symbol.for("react.element"),Fj=Symbol.for("react.fragment"),Uj=Object.prototype.hasOwnProperty,Oj=qj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bj={key:!0,ref:!0,__self:!0,__source:!0};function eA(e,t,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)Uj.call(t,i)&&!Bj.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:jj,type:e,key:s,ref:o,props:r,_owner:Oj.current}}cm.Fragment=Fj;cm.jsx=eA;cm.jsxs=eA;$I.exports=cm;var l=$I.exports,nA={exports:{}},ki={},iA={exports:{}},rA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,W){var j=U.length;U.push(W);t:for(;0<j;){var q=j-1>>>1,J=U[q];if(0<r(J,W))U[q]=W,U[j]=J,j=q;else break t}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var W=U[0],j=U.pop();if(j!==W){U[0]=j;t:for(var q=0,J=U.length,G=J>>>1;q<G;){var Q=2*(q+1)-1,Z=U[Q],O=Q+1,B=U[O];if(0>r(Z,j))O<J&&0>r(B,Z)?(U[q]=B,U[O]=j,q=O):(U[q]=Z,U[Q]=j,q=Q);else if(O<J&&0>r(B,j))U[q]=B,U[O]=j,q=O;else break t}}return W}function r(U,W){var j=U.sortIndex-W.sortIndex;return j!==0?j:U.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],h=[],u=1,d=null,f=3,v=!1,y=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(U){for(var W=n(h);W!==null;){if(W.callback===null)i(h);else if(W.startTime<=U)i(h),W.sortIndex=W.expirationTime,t(c,W);else break;W=n(h)}}function P(U){if(w=!1,k(U),!y)if(n(c)!==null)y=!0,Y(A);else{var W=n(h);W!==null&&K(P,W.startTime-U)}}function A(U,W){y=!1,w&&(w=!1,x(T),T=-1),v=!0;var j=f;try{for(k(W),d=n(c);d!==null&&(!(d.expirationTime>W)||U&&!D());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var J=q(d.expirationTime<=W);W=e.unstable_now(),typeof J=="function"?d.callback=J:d===n(c)&&i(c),k(W)}else i(c);d=n(c)}if(d!==null)var G=!0;else{var Q=n(h);Q!==null&&K(P,Q.startTime-W),G=!1}return G}finally{d=null,f=j,v=!1}}var M=!1,N=null,T=-1,E=5,R=-1;function D(){return!(e.unstable_now()-R<E)}function F(){if(N!==null){var U=e.unstable_now();R=U;var W=!0;try{W=N(!0,U)}finally{W?L():(M=!1,N=null)}}else M=!1}var L;if(typeof C=="function")L=function(){C(F)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,ht=lt.port2;lt.port1.onmessage=F,L=function(){ht.postMessage(null)}}else L=function(){_(F,0)};function Y(U){N=U,M||(M=!0,L())}function K(U,W){T=_(function(){U(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,Y(A))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(U){switch(f){case 1:case 2:case 3:var W=3;break;default:W=f}var j=f;f=W;try{return U()}finally{f=j}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,W){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=f;f=U;try{return W()}finally{f=j}},e.unstable_scheduleCallback=function(U,W,j){var q=e.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?q+j:q):j=q,U){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=j+J,U={id:u++,callback:W,priorityLevel:U,startTime:j,expirationTime:J,sortIndex:-1},j>q?(U.sortIndex=j,t(h,U),n(c)===null&&U===n(h)&&(w?(x(T),T=-1):w=!0,K(P,j-q))):(U.sortIndex=J,t(c,U),y||v||(y=!0,Y(A))),U},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(U){var W=f;return function(){var j=f;f=W;try{return U.apply(this,arguments)}finally{f=j}}}})(rA);iA.exports=rA;var Gj=iA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hj=I,Ti=Gj;function it(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sA=new Set,Kh={};function Da(e,t){Gc(e,t),Gc(e+"Capture",t)}function Gc(e,t){for(Kh[e]=t,e=0;e<t.length;e++)sA.add(t[e])}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),my=Object.prototype.hasOwnProperty,$j=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,OT={},BT={};function zj(e){return my.call(BT,e)?!0:my.call(OT,e)?!1:$j.test(e)?BT[e]=!0:(OT[e]=!0,!1)}function Kj(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Wj(e,t,n,i){if(t===null||typeof t>"u"||Kj(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yn(e,t,n,i,r,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bn[e]=new Yn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bn[t]=new Yn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bn[e]=new Yn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bn[e]=new Yn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bn[e]=new Yn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bn[e]=new Yn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bn[e]=new Yn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bn[e]=new Yn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bn[e]=new Yn(e,5,!1,e.toLowerCase(),null,!1,!1)});var G0=/[\-:]([a-z])/g;function H0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(G0,H0);bn[t]=new Yn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(G0,H0);bn[t]=new Yn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(G0,H0);bn[t]=new Yn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!1,!1)});bn.xlinkHref=new Yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!0,!0)});function $0(e,t,n,i){var r=bn.hasOwnProperty(t)?bn[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Wj(t,n,r,i)&&(n=null),i||r===null?zj(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,i=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Ps=Hj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bd=Symbol.for("react.element"),ic=Symbol.for("react.portal"),rc=Symbol.for("react.fragment"),z0=Symbol.for("react.strict_mode"),py=Symbol.for("react.profiler"),oA=Symbol.for("react.provider"),aA=Symbol.for("react.context"),K0=Symbol.for("react.forward_ref"),vy=Symbol.for("react.suspense"),yy=Symbol.for("react.suspense_list"),W0=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),cA=Symbol.for("react.offscreen"),GT=Symbol.iterator;function zl(e){return e===null||typeof e!="object"?null:(e=GT&&e[GT]||e["@@iterator"],typeof e=="function"?e:null)}var Ae=Object.assign,Bp;function dh(e){if(Bp===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Bp=t&&t[1]||""}return`
`+Bp+e}var Gp=!1;function Hp(e,t){if(!e||Gp)return"";Gp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var i=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){i=h}e.call(t.prototype)}else{try{throw Error()}catch(h){i=h}e()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{Gp=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?dh(e):""}function Qj(e){switch(e.tag){case 5:return dh(e.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return e=Hp(e.type,!1),e;case 11:return e=Hp(e.type.render,!1),e;case 1:return e=Hp(e.type,!0),e;default:return""}}function xy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rc:return"Fragment";case ic:return"Portal";case py:return"Profiler";case z0:return"StrictMode";case vy:return"Suspense";case yy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aA:return(e.displayName||"Context")+".Consumer";case oA:return(e._context.displayName||"Context")+".Provider";case K0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case W0:return t=e.displayName||null,t!==null?t:xy(e.type)||"Memo";case Ys:t=e._payload,e=e._init;try{return xy(e(t))}catch{}}return null}function Yj(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xy(t);case 8:return t===z0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Co(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lA(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Xj(e){var t=lA(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Td(e){e._valueTracker||(e._valueTracker=Xj(e))}function hA(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=lA(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function jg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _y(e,t){var n=t.checked;return Ae({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function HT(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=Co(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function uA(e,t){t=t.checked,t!=null&&$0(e,"checked",t,!1)}function wy(e,t){uA(e,t);var n=Co(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?by(e,t.type,n):t.hasOwnProperty("defaultValue")&&by(e,t.type,Co(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $T(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function by(e,t,n){(t!=="number"||jg(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var gh=Array.isArray;function kc(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Co(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Ty(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(it(91));return Ae({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function zT(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(it(92));if(gh(n)){if(1<n.length)throw Error(it(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Co(n)}}function dA(e,t){var n=Co(t.value),i=Co(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function KT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gA(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gA(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cd,fA=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cd=Cd||document.createElement("div"),Cd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jj=["Webkit","ms","Moz","O"];Object.keys(bh).forEach(function(e){Jj.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bh[t]=bh[e]})});function mA(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||bh.hasOwnProperty(e)&&bh[e]?(""+t).trim():t+"px"}function pA(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=mA(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}var Zj=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ky(e,t){if(t){if(Zj[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(it(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(it(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(it(61))}if(t.style!=null&&typeof t.style!="object")throw Error(it(62))}}function Ny(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ey=null;function Q0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Sy=null,Nc=null,Ec=null;function WT(e){if(e=Du(e)){if(typeof Sy!="function")throw Error(it(280));var t=e.stateNode;t&&(t=gm(t),Sy(e.stateNode,e.type,t))}}function vA(e){Nc?Ec?Ec.push(e):Ec=[e]:Nc=e}function yA(){if(Nc){var e=Nc,t=Ec;if(Ec=Nc=null,WT(e),t)for(e=0;e<t.length;e++)WT(t[e])}}function xA(e,t){return e(t)}function _A(){}var $p=!1;function wA(e,t,n){if($p)return e(t,n);$p=!0;try{return xA(e,t,n)}finally{$p=!1,(Nc!==null||Ec!==null)&&(_A(),yA())}}function Qh(e,t){var n=e.stateNode;if(n===null)return null;var i=gm(n);if(i===null)return null;n=i[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break t;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(it(231,t,typeof n));return n}var Iy=!1;if(ys)try{var Kl={};Object.defineProperty(Kl,"passive",{get:function(){Iy=!0}}),window.addEventListener("test",Kl,Kl),window.removeEventListener("test",Kl,Kl)}catch{Iy=!1}function t3(e,t,n,i,r,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(u){this.onError(u)}}var Th=!1,Fg=null,Ug=!1,Ay=null,e3={onError:function(e){Th=!0,Fg=e}};function n3(e,t,n,i,r,s,o,a,c){Th=!1,Fg=null,t3.apply(e3,arguments)}function i3(e,t,n,i,r,s,o,a,c){if(n3.apply(this,arguments),Th){if(Th){var h=Fg;Th=!1,Fg=null}else throw Error(it(198));Ug||(Ug=!0,Ay=h)}}function La(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function bA(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function QT(e){if(La(e)!==e)throw Error(it(188))}function r3(e){var t=e.alternate;if(!t){if(t=La(e),t===null)throw Error(it(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return QT(r),e;if(s===i)return QT(r),t;s=s.sibling}throw Error(it(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(it(189))}}if(n.alternate!==i)throw Error(it(190))}if(n.tag!==3)throw Error(it(188));return n.stateNode.current===n?e:t}function TA(e){return e=r3(e),e!==null?CA(e):null}function CA(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=CA(e);if(t!==null)return t;e=e.sibling}return null}var kA=Ti.unstable_scheduleCallback,YT=Ti.unstable_cancelCallback,s3=Ti.unstable_shouldYield,o3=Ti.unstable_requestPaint,Fe=Ti.unstable_now,a3=Ti.unstable_getCurrentPriorityLevel,Y0=Ti.unstable_ImmediatePriority,NA=Ti.unstable_UserBlockingPriority,Og=Ti.unstable_NormalPriority,c3=Ti.unstable_LowPriority,EA=Ti.unstable_IdlePriority,lm=null,qr=null;function l3(e){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(lm,e,void 0,(e.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:d3,h3=Math.log,u3=Math.LN2;function d3(e){return e>>>=0,e===0?32:31-(h3(e)/u3|0)|0}var kd=64,Nd=4194304;function fh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Bg(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=fh(a):(s&=o,s!==0&&(i=fh(s)))}else o=n&~r,o!==0?i=fh(o):s!==0&&(i=fh(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-fr(t),r=1<<n,i|=e[n],t&=~r;return i}function g3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f3(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-fr(s),a=1<<o,c=r[o];c===-1?(!(a&n)||a&i)&&(r[o]=g3(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}function Ry(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function SA(){var e=kd;return kd<<=1,!(kd&4194240)&&(kd=64),e}function zp(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fr(t),e[t]=n}function m3(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-fr(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}function X0(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-fr(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var ie=0;function IA(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var AA,J0,RA,PA,MA,Py=!1,Ed=[],co=null,lo=null,ho=null,Yh=new Map,Xh=new Map,Js=[],p3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function XT(e,t){switch(e){case"focusin":case"focusout":co=null;break;case"dragenter":case"dragleave":lo=null;break;case"mouseover":case"mouseout":ho=null;break;case"pointerover":case"pointerout":Yh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xh.delete(t.pointerId)}}function Wl(e,t,n,i,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=Du(t),t!==null&&J0(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function v3(e,t,n,i,r){switch(t){case"focusin":return co=Wl(co,e,t,n,i,r),!0;case"dragenter":return lo=Wl(lo,e,t,n,i,r),!0;case"mouseover":return ho=Wl(ho,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Yh.set(s,Wl(Yh.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Xh.set(s,Wl(Xh.get(s)||null,e,t,n,i,r)),!0}return!1}function DA(e){var t=ia(e.target);if(t!==null){var n=La(t);if(n!==null){if(t=n.tag,t===13){if(t=bA(n),t!==null){e.blockedOn=t,MA(e.priority,function(){RA(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=My(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Ey=i,n.target.dispatchEvent(i),Ey=null}else return t=Du(n),t!==null&&J0(t),e.blockedOn=n,!1;t.shift()}return!0}function JT(e,t,n){hg(e)&&n.delete(t)}function y3(){Py=!1,co!==null&&hg(co)&&(co=null),lo!==null&&hg(lo)&&(lo=null),ho!==null&&hg(ho)&&(ho=null),Yh.forEach(JT),Xh.forEach(JT)}function Ql(e,t){e.blockedOn===t&&(e.blockedOn=null,Py||(Py=!0,Ti.unstable_scheduleCallback(Ti.unstable_NormalPriority,y3)))}function Jh(e){function t(r){return Ql(r,e)}if(0<Ed.length){Ql(Ed[0],e);for(var n=1;n<Ed.length;n++){var i=Ed[n];i.blockedOn===e&&(i.blockedOn=null)}}for(co!==null&&Ql(co,e),lo!==null&&Ql(lo,e),ho!==null&&Ql(ho,e),Yh.forEach(t),Xh.forEach(t),n=0;n<Js.length;n++)i=Js[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Js.length&&(n=Js[0],n.blockedOn===null);)DA(n),n.blockedOn===null&&Js.shift()}var Sc=Ps.ReactCurrentBatchConfig,Gg=!0;function x3(e,t,n,i){var r=ie,s=Sc.transition;Sc.transition=null;try{ie=1,Z0(e,t,n,i)}finally{ie=r,Sc.transition=s}}function _3(e,t,n,i){var r=ie,s=Sc.transition;Sc.transition=null;try{ie=4,Z0(e,t,n,i)}finally{ie=r,Sc.transition=s}}function Z0(e,t,n,i){if(Gg){var r=My(e,t,n,i);if(r===null)nv(e,t,i,Hg,n),XT(e,i);else if(v3(r,e,t,n,i))i.stopPropagation();else if(XT(e,i),t&4&&-1<p3.indexOf(e)){for(;r!==null;){var s=Du(r);if(s!==null&&AA(s),s=My(e,t,n,i),s===null&&nv(e,t,i,Hg,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else nv(e,t,i,null,n)}}var Hg=null;function My(e,t,n,i){if(Hg=null,e=Q0(i),e=ia(e),e!==null)if(t=La(e),t===null)e=null;else if(n=t.tag,n===13){if(e=bA(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Hg=e,null}function LA(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a3()){case Y0:return 1;case NA:return 4;case Og:case c3:return 16;case EA:return 536870912;default:return 16}default:return 16}}var ro=null,t_=null,ug=null;function VA(){if(ug)return ug;var e,t=t_,n=t.length,i,r="value"in ro?ro.value:ro.textContent,s=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===r[s-i];i++);return ug=r.slice(e,1<i?1-i:void 0)}function dg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sd(){return!0}function ZT(){return!1}function Ni(e){function t(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Sd:ZT,this.isPropagationStopped=ZT,this}return Ae(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sd)},persist:function(){},isPersistent:Sd}),t}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},e_=Ni(hl),Mu=Ae({},hl,{view:0,detail:0}),w3=Ni(Mu),Kp,Wp,Yl,hm=Ae({},Mu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:n_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yl&&(Yl&&e.type==="mousemove"?(Kp=e.screenX-Yl.screenX,Wp=e.screenY-Yl.screenY):Wp=Kp=0,Yl=e),Kp)},movementY:function(e){return"movementY"in e?e.movementY:Wp}}),tC=Ni(hm),b3=Ae({},hm,{dataTransfer:0}),T3=Ni(b3),C3=Ae({},Mu,{relatedTarget:0}),Qp=Ni(C3),k3=Ae({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),N3=Ni(k3),E3=Ae({},hl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),S3=Ni(E3),I3=Ae({},hl,{data:0}),eC=Ni(I3),A3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},R3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function M3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=P3[e])?!!t[e]:!1}function n_(){return M3}var D3=Ae({},Mu,{key:function(e){if(e.key){var t=A3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=dg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?R3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:n_,charCode:function(e){return e.type==="keypress"?dg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?dg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),L3=Ni(D3),V3=Ae({},hm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nC=Ni(V3),q3=Ae({},Mu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:n_}),j3=Ni(q3),F3=Ae({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),U3=Ni(F3),O3=Ae({},hm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),B3=Ni(O3),G3=[9,13,27,32],i_=ys&&"CompositionEvent"in window,Ch=null;ys&&"documentMode"in document&&(Ch=document.documentMode);var H3=ys&&"TextEvent"in window&&!Ch,qA=ys&&(!i_||Ch&&8<Ch&&11>=Ch),iC=" ",rC=!1;function jA(e,t){switch(e){case"keyup":return G3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FA(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sc=!1;function $3(e,t){switch(e){case"compositionend":return FA(t);case"keypress":return t.which!==32?null:(rC=!0,iC);case"textInput":return e=t.data,e===iC&&rC?null:e;default:return null}}function z3(e,t){if(sc)return e==="compositionend"||!i_&&jA(e,t)?(e=VA(),ug=t_=ro=null,sc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qA&&t.locale!=="ko"?null:t.data;default:return null}}var K3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!K3[e.type]:t==="textarea"}function UA(e,t,n,i){vA(i),t=$g(t,"onChange"),0<t.length&&(n=new e_("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var kh=null,Zh=null;function W3(e){XA(e,0)}function um(e){var t=cc(e);if(hA(t))return e}function Q3(e,t){if(e==="change")return t}var OA=!1;if(ys){var Yp;if(ys){var Xp="oninput"in document;if(!Xp){var oC=document.createElement("div");oC.setAttribute("oninput","return;"),Xp=typeof oC.oninput=="function"}Yp=Xp}else Yp=!1;OA=Yp&&(!document.documentMode||9<document.documentMode)}function aC(){kh&&(kh.detachEvent("onpropertychange",BA),Zh=kh=null)}function BA(e){if(e.propertyName==="value"&&um(Zh)){var t=[];UA(t,Zh,e,Q0(e)),wA(W3,t)}}function Y3(e,t,n){e==="focusin"?(aC(),kh=t,Zh=n,kh.attachEvent("onpropertychange",BA)):e==="focusout"&&aC()}function X3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return um(Zh)}function J3(e,t){if(e==="click")return um(t)}function Z3(e,t){if(e==="input"||e==="change")return um(t)}function t5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var br=typeof Object.is=="function"?Object.is:t5;function tu(e,t){if(br(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!my.call(t,r)||!br(e[r],t[r]))return!1}return!0}function cC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lC(e,t){var n=cC(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=cC(n)}}function GA(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?GA(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function HA(){for(var e=window,t=jg();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=jg(e.document)}return t}function r_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function e5(e){var t=HA(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&GA(n.ownerDocument.documentElement,n)){if(i!==null&&r_(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=lC(n,s);var o=lC(n,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var n5=ys&&"documentMode"in document&&11>=document.documentMode,oc=null,Dy=null,Nh=null,Ly=!1;function hC(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ly||oc==null||oc!==jg(i)||(i=oc,"selectionStart"in i&&r_(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Nh&&tu(Nh,i)||(Nh=i,i=$g(Dy,"onSelect"),0<i.length&&(t=new e_("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=oc)))}function Id(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ac={animationend:Id("Animation","AnimationEnd"),animationiteration:Id("Animation","AnimationIteration"),animationstart:Id("Animation","AnimationStart"),transitionend:Id("Transition","TransitionEnd")},Jp={},$A={};ys&&($A=document.createElement("div").style,"AnimationEvent"in window||(delete ac.animationend.animation,delete ac.animationiteration.animation,delete ac.animationstart.animation),"TransitionEvent"in window||delete ac.transitionend.transition);function dm(e){if(Jp[e])return Jp[e];if(!ac[e])return e;var t=ac[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in $A)return Jp[e]=t[n];return e}var zA=dm("animationend"),KA=dm("animationiteration"),WA=dm("animationstart"),QA=dm("transitionend"),YA=new Map,uC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vo(e,t){YA.set(e,t),Da(t,[e])}for(var Zp=0;Zp<uC.length;Zp++){var tv=uC[Zp],i5=tv.toLowerCase(),r5=tv[0].toUpperCase()+tv.slice(1);Vo(i5,"on"+r5)}Vo(zA,"onAnimationEnd");Vo(KA,"onAnimationIteration");Vo(WA,"onAnimationStart");Vo("dblclick","onDoubleClick");Vo("focusin","onFocus");Vo("focusout","onBlur");Vo(QA,"onTransitionEnd");Gc("onMouseEnter",["mouseout","mouseover"]);Gc("onMouseLeave",["mouseout","mouseover"]);Gc("onPointerEnter",["pointerout","pointerover"]);Gc("onPointerLeave",["pointerout","pointerover"]);Da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Da("onBeforeInput",["compositionend","keypress","textInput","paste"]);Da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s5=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function dC(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,i3(i,t,void 0,e),e.currentTarget=null}function XA(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;t:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break t;dC(r,a,h),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break t;dC(r,a,h),s=c}}}if(Ug)throw e=Ay,Ug=!1,Ay=null,e}function me(e,t){var n=t[Uy];n===void 0&&(n=t[Uy]=new Set);var i=e+"__bubble";n.has(i)||(JA(t,e,2,!1),n.add(i))}function ev(e,t,n){var i=0;t&&(i|=4),JA(n,e,i,t)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function eu(e){if(!e[Ad]){e[Ad]=!0,sA.forEach(function(n){n!=="selectionchange"&&(s5.has(n)||ev(n,!1,e),ev(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ad]||(t[Ad]=!0,ev("selectionchange",!1,t))}}function JA(e,t,n,i){switch(LA(t)){case 1:var r=x3;break;case 4:r=_3;break;default:r=Z0}n=r.bind(null,t,n,e),r=void 0,!Iy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function nv(e,t,n,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)t:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ia(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue t}a=a.parentNode}}i=i.return}wA(function(){var h=s,u=Q0(n),d=[];t:{var f=YA.get(e);if(f!==void 0){var v=e_,y=e;switch(e){case"keypress":if(dg(n)===0)break t;case"keydown":case"keyup":v=L3;break;case"focusin":y="focus",v=Qp;break;case"focusout":y="blur",v=Qp;break;case"beforeblur":case"afterblur":v=Qp;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=tC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=T3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=j3;break;case zA:case KA:case WA:v=N3;break;case QA:v=U3;break;case"scroll":v=w3;break;case"wheel":v=B3;break;case"copy":case"cut":case"paste":v=S3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=nC}var w=(t&4)!==0,_=!w&&e==="scroll",x=w?f!==null?f+"Capture":null:f;w=[];for(var C=h,k;C!==null;){k=C;var P=k.stateNode;if(k.tag===5&&P!==null&&(k=P,x!==null&&(P=Qh(C,x),P!=null&&w.push(nu(C,P,k)))),_)break;C=C.return}0<w.length&&(f=new v(f,y,null,n,u),d.push({event:f,listeners:w}))}}if(!(t&7)){t:{if(f=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",f&&n!==Ey&&(y=n.relatedTarget||n.fromElement)&&(ia(y)||y[xs]))break t;if((v||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=h,y=y?ia(y):null,y!==null&&(_=La(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=h),v!==y)){if(w=tC,P="onMouseLeave",x="onMouseEnter",C="mouse",(e==="pointerout"||e==="pointerover")&&(w=nC,P="onPointerLeave",x="onPointerEnter",C="pointer"),_=v==null?f:cc(v),k=y==null?f:cc(y),f=new w(P,C+"leave",v,n,u),f.target=_,f.relatedTarget=k,P=null,ia(u)===h&&(w=new w(x,C+"enter",y,n,u),w.target=k,w.relatedTarget=_,P=w),_=P,v&&y)e:{for(w=v,x=y,C=0,k=w;k;k=Qa(k))C++;for(k=0,P=x;P;P=Qa(P))k++;for(;0<C-k;)w=Qa(w),C--;for(;0<k-C;)x=Qa(x),k--;for(;C--;){if(w===x||x!==null&&w===x.alternate)break e;w=Qa(w),x=Qa(x)}w=null}else w=null;v!==null&&gC(d,f,v,w,!1),y!==null&&_!==null&&gC(d,_,y,w,!0)}}t:{if(f=h?cc(h):window,v=f.nodeName&&f.nodeName.toLowerCase(),v==="select"||v==="input"&&f.type==="file")var A=Q3;else if(sC(f))if(OA)A=Z3;else{A=X3;var M=Y3}else(v=f.nodeName)&&v.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(A=J3);if(A&&(A=A(e,h))){UA(d,A,n,u);break t}M&&M(e,f,h),e==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&by(f,"number",f.value)}switch(M=h?cc(h):window,e){case"focusin":(sC(M)||M.contentEditable==="true")&&(oc=M,Dy=h,Nh=null);break;case"focusout":Nh=Dy=oc=null;break;case"mousedown":Ly=!0;break;case"contextmenu":case"mouseup":case"dragend":Ly=!1,hC(d,n,u);break;case"selectionchange":if(n5)break;case"keydown":case"keyup":hC(d,n,u)}var N;if(i_)t:{switch(e){case"compositionstart":var T="onCompositionStart";break t;case"compositionend":T="onCompositionEnd";break t;case"compositionupdate":T="onCompositionUpdate";break t}T=void 0}else sc?jA(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(qA&&n.locale!=="ko"&&(sc||T!=="onCompositionStart"?T==="onCompositionEnd"&&sc&&(N=VA()):(ro=u,t_="value"in ro?ro.value:ro.textContent,sc=!0)),M=$g(h,T),0<M.length&&(T=new eC(T,e,null,n,u),d.push({event:T,listeners:M}),N?T.data=N:(N=FA(n),N!==null&&(T.data=N)))),(N=H3?$3(e,n):z3(e,n))&&(h=$g(h,"onBeforeInput"),0<h.length&&(u=new eC("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:h}),u.data=N))}XA(d,t)})}function nu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $g(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Qh(e,n),s!=null&&i.unshift(nu(e,s,r)),s=Qh(e,t),s!=null&&i.push(nu(e,s,r))),e=e.return}return i}function Qa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gC(e,t,n,i,r){for(var s=t._reactName,o=[];n!==null&&n!==i;){var a=n,c=a.alternate,h=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&h!==null&&(a=h,r?(c=Qh(n,s),c!=null&&o.unshift(nu(n,c,a))):r||(c=Qh(n,s),c!=null&&o.push(nu(n,c,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var o5=/\r\n?/g,a5=/\u0000|\uFFFD/g;function fC(e){return(typeof e=="string"?e:""+e).replace(o5,`
`).replace(a5,"")}function Rd(e,t,n){if(t=fC(t),fC(e)!==t&&n)throw Error(it(425))}function zg(){}var Vy=null,qy=null;function jy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fy=typeof setTimeout=="function"?setTimeout:void 0,c5=typeof clearTimeout=="function"?clearTimeout:void 0,mC=typeof Promise=="function"?Promise:void 0,l5=typeof queueMicrotask=="function"?queueMicrotask:typeof mC<"u"?function(e){return mC.resolve(null).then(e).catch(h5)}:Fy;function h5(e){setTimeout(function(){throw e})}function iv(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),Jh(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Jh(t)}function uo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function pC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ul=Math.random().toString(36).slice(2),Dr="__reactFiber$"+ul,iu="__reactProps$"+ul,xs="__reactContainer$"+ul,Uy="__reactEvents$"+ul,u5="__reactListeners$"+ul,d5="__reactHandles$"+ul;function ia(e){var t=e[Dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[xs]||n[Dr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=pC(e);e!==null;){if(n=e[Dr])return n;e=pC(e)}return t}e=n,n=e.parentNode}return null}function Du(e){return e=e[Dr]||e[xs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function cc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(it(33))}function gm(e){return e[iu]||null}var Oy=[],lc=-1;function qo(e){return{current:e}}function ye(e){0>lc||(e.current=Oy[lc],Oy[lc]=null,lc--)}function de(e,t){lc++,Oy[lc]=e.current,e.current=t}var ko={},jn=qo(ko),ui=qo(!1),pa=ko;function Hc(e,t){var n=e.type.contextTypes;if(!n)return ko;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function di(e){return e=e.childContextTypes,e!=null}function Kg(){ye(ui),ye(jn)}function vC(e,t,n){if(jn.current!==ko)throw Error(it(168));de(jn,t),de(ui,n)}function ZA(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(it(108,Yj(e)||"Unknown",r));return Ae({},n,i)}function Wg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ko,pa=jn.current,de(jn,e),de(ui,ui.current),!0}function yC(e,t,n){var i=e.stateNode;if(!i)throw Error(it(169));n?(e=ZA(e,t,pa),i.__reactInternalMemoizedMergedChildContext=e,ye(ui),ye(jn),de(jn,e)):ye(ui),de(ui,n)}var rs=null,fm=!1,rv=!1;function tR(e){rs===null?rs=[e]:rs.push(e)}function g5(e){fm=!0,tR(e)}function jo(){if(!rv&&rs!==null){rv=!0;var e=0,t=ie;try{var n=rs;for(ie=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}rs=null,fm=!1}catch(r){throw rs!==null&&(rs=rs.slice(e+1)),kA(Y0,jo),r}finally{ie=t,rv=!1}}return null}var hc=[],uc=0,Qg=null,Yg=0,Ri=[],Pi=0,va=null,ss=1,os="";function Xo(e,t){hc[uc++]=Yg,hc[uc++]=Qg,Qg=e,Yg=t}function eR(e,t,n){Ri[Pi++]=ss,Ri[Pi++]=os,Ri[Pi++]=va,va=e;var i=ss;e=os;var r=32-fr(i)-1;i&=~(1<<r),n+=1;var s=32-fr(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,ss=1<<32-fr(t)+r|n<<r|i,os=s+e}else ss=1<<s|n<<r|i,os=e}function s_(e){e.return!==null&&(Xo(e,1),eR(e,1,0))}function o_(e){for(;e===Qg;)Qg=hc[--uc],hc[uc]=null,Yg=hc[--uc],hc[uc]=null;for(;e===va;)va=Ri[--Pi],Ri[Pi]=null,os=Ri[--Pi],Ri[Pi]=null,ss=Ri[--Pi],Ri[Pi]=null}var _i=null,yi=null,Te=!1,ar=null;function nR(e,t){var n=Di(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function xC(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_i=e,yi=uo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_i=e,yi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=va!==null?{id:ss,overflow:os}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Di(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,_i=e,yi=null,!0):!1;default:return!1}}function By(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gy(e){if(Te){var t=yi;if(t){var n=t;if(!xC(e,t)){if(By(e))throw Error(it(418));t=uo(n.nextSibling);var i=_i;t&&xC(e,t)?nR(i,n):(e.flags=e.flags&-4097|2,Te=!1,_i=e)}}else{if(By(e))throw Error(it(418));e.flags=e.flags&-4097|2,Te=!1,_i=e}}}function _C(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_i=e}function Pd(e){if(e!==_i)return!1;if(!Te)return _C(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jy(e.type,e.memoizedProps)),t&&(t=yi)){if(By(e))throw iR(),Error(it(418));for(;t;)nR(e,t),t=uo(t.nextSibling)}if(_C(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(it(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){yi=uo(e.nextSibling);break t}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}yi=null}}else yi=_i?uo(e.stateNode.nextSibling):null;return!0}function iR(){for(var e=yi;e;)e=uo(e.nextSibling)}function $c(){yi=_i=null,Te=!1}function a_(e){ar===null?ar=[e]:ar.push(e)}var f5=Ps.ReactCurrentBatchConfig;function Xl(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(it(309));var i=n.stateNode}if(!i)throw Error(it(147,e));var r=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(it(284));if(!n._owner)throw Error(it(290,e))}return e}function Md(e,t){throw e=Object.prototype.toString.call(t),Error(it(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wC(e){var t=e._init;return t(e._payload)}function rR(e){function t(x,C){if(e){var k=x.deletions;k===null?(x.deletions=[C],x.flags|=16):k.push(C)}}function n(x,C){if(!e)return null;for(;C!==null;)t(x,C),C=C.sibling;return null}function i(x,C){for(x=new Map;C!==null;)C.key!==null?x.set(C.key,C):x.set(C.index,C),C=C.sibling;return x}function r(x,C){return x=po(x,C),x.index=0,x.sibling=null,x}function s(x,C,k){return x.index=k,e?(k=x.alternate,k!==null?(k=k.index,k<C?(x.flags|=2,C):k):(x.flags|=2,C)):(x.flags|=1048576,C)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,C,k,P){return C===null||C.tag!==6?(C=uv(k,x.mode,P),C.return=x,C):(C=r(C,k),C.return=x,C)}function c(x,C,k,P){var A=k.type;return A===rc?u(x,C,k.props.children,P,k.key):C!==null&&(C.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ys&&wC(A)===C.type)?(P=r(C,k.props),P.ref=Xl(x,C,k),P.return=x,P):(P=xg(k.type,k.key,k.props,null,x.mode,P),P.ref=Xl(x,C,k),P.return=x,P)}function h(x,C,k,P){return C===null||C.tag!==4||C.stateNode.containerInfo!==k.containerInfo||C.stateNode.implementation!==k.implementation?(C=dv(k,x.mode,P),C.return=x,C):(C=r(C,k.children||[]),C.return=x,C)}function u(x,C,k,P,A){return C===null||C.tag!==7?(C=da(k,x.mode,P,A),C.return=x,C):(C=r(C,k),C.return=x,C)}function d(x,C,k){if(typeof C=="string"&&C!==""||typeof C=="number")return C=uv(""+C,x.mode,k),C.return=x,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case bd:return k=xg(C.type,C.key,C.props,null,x.mode,k),k.ref=Xl(x,null,C),k.return=x,k;case ic:return C=dv(C,x.mode,k),C.return=x,C;case Ys:var P=C._init;return d(x,P(C._payload),k)}if(gh(C)||zl(C))return C=da(C,x.mode,k,null),C.return=x,C;Md(x,C)}return null}function f(x,C,k,P){var A=C!==null?C.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return A!==null?null:a(x,C,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case bd:return k.key===A?c(x,C,k,P):null;case ic:return k.key===A?h(x,C,k,P):null;case Ys:return A=k._init,f(x,C,A(k._payload),P)}if(gh(k)||zl(k))return A!==null?null:u(x,C,k,P,null);Md(x,k)}return null}function v(x,C,k,P,A){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(k)||null,a(C,x,""+P,A);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case bd:return x=x.get(P.key===null?k:P.key)||null,c(C,x,P,A);case ic:return x=x.get(P.key===null?k:P.key)||null,h(C,x,P,A);case Ys:var M=P._init;return v(x,C,k,M(P._payload),A)}if(gh(P)||zl(P))return x=x.get(k)||null,u(C,x,P,A,null);Md(C,P)}return null}function y(x,C,k,P){for(var A=null,M=null,N=C,T=C=0,E=null;N!==null&&T<k.length;T++){N.index>T?(E=N,N=null):E=N.sibling;var R=f(x,N,k[T],P);if(R===null){N===null&&(N=E);break}e&&N&&R.alternate===null&&t(x,N),C=s(R,C,T),M===null?A=R:M.sibling=R,M=R,N=E}if(T===k.length)return n(x,N),Te&&Xo(x,T),A;if(N===null){for(;T<k.length;T++)N=d(x,k[T],P),N!==null&&(C=s(N,C,T),M===null?A=N:M.sibling=N,M=N);return Te&&Xo(x,T),A}for(N=i(x,N);T<k.length;T++)E=v(N,x,T,k[T],P),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?T:E.key),C=s(E,C,T),M===null?A=E:M.sibling=E,M=E);return e&&N.forEach(function(D){return t(x,D)}),Te&&Xo(x,T),A}function w(x,C,k,P){var A=zl(k);if(typeof A!="function")throw Error(it(150));if(k=A.call(k),k==null)throw Error(it(151));for(var M=A=null,N=C,T=C=0,E=null,R=k.next();N!==null&&!R.done;T++,R=k.next()){N.index>T?(E=N,N=null):E=N.sibling;var D=f(x,N,R.value,P);if(D===null){N===null&&(N=E);break}e&&N&&D.alternate===null&&t(x,N),C=s(D,C,T),M===null?A=D:M.sibling=D,M=D,N=E}if(R.done)return n(x,N),Te&&Xo(x,T),A;if(N===null){for(;!R.done;T++,R=k.next())R=d(x,R.value,P),R!==null&&(C=s(R,C,T),M===null?A=R:M.sibling=R,M=R);return Te&&Xo(x,T),A}for(N=i(x,N);!R.done;T++,R=k.next())R=v(N,x,T,R.value,P),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?T:R.key),C=s(R,C,T),M===null?A=R:M.sibling=R,M=R);return e&&N.forEach(function(F){return t(x,F)}),Te&&Xo(x,T),A}function _(x,C,k,P){if(typeof k=="object"&&k!==null&&k.type===rc&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case bd:t:{for(var A=k.key,M=C;M!==null;){if(M.key===A){if(A=k.type,A===rc){if(M.tag===7){n(x,M.sibling),C=r(M,k.props.children),C.return=x,x=C;break t}}else if(M.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ys&&wC(A)===M.type){n(x,M.sibling),C=r(M,k.props),C.ref=Xl(x,M,k),C.return=x,x=C;break t}n(x,M);break}else t(x,M);M=M.sibling}k.type===rc?(C=da(k.props.children,x.mode,P,k.key),C.return=x,x=C):(P=xg(k.type,k.key,k.props,null,x.mode,P),P.ref=Xl(x,C,k),P.return=x,x=P)}return o(x);case ic:t:{for(M=k.key;C!==null;){if(C.key===M)if(C.tag===4&&C.stateNode.containerInfo===k.containerInfo&&C.stateNode.implementation===k.implementation){n(x,C.sibling),C=r(C,k.children||[]),C.return=x,x=C;break t}else{n(x,C);break}else t(x,C);C=C.sibling}C=dv(k,x.mode,P),C.return=x,x=C}return o(x);case Ys:return M=k._init,_(x,C,M(k._payload),P)}if(gh(k))return y(x,C,k,P);if(zl(k))return w(x,C,k,P);Md(x,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,C!==null&&C.tag===6?(n(x,C.sibling),C=r(C,k),C.return=x,x=C):(n(x,C),C=uv(k,x.mode,P),C.return=x,x=C),o(x)):n(x,C)}return _}var zc=rR(!0),sR=rR(!1),Xg=qo(null),Jg=null,dc=null,c_=null;function l_(){c_=dc=Jg=null}function h_(e){var t=Xg.current;ye(Xg),e._currentValue=t}function Hy(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ic(e,t){Jg=e,c_=dc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(li=!0),e.firstContext=null)}function Hi(e){var t=e._currentValue;if(c_!==e)if(e={context:e,memoizedValue:t,next:null},dc===null){if(Jg===null)throw Error(it(308));dc=e,Jg.dependencies={lanes:0,firstContext:e}}else dc=dc.next=e;return t}var ra=null;function u_(e){ra===null?ra=[e]:ra.push(e)}function oR(e,t,n,i){var r=t.interleaved;return r===null?(n.next=n,u_(t)):(n.next=r.next,r.next=n),t.interleaved=n,_s(e,i)}function _s(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Xs=!1;function d_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function go(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Jt&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,_s(e,n)}return r=i.interleaved,r===null?(t.next=t,u_(i)):(t.next=r.next,r.next=t),i.interleaved=t,_s(e,n)}function gg(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,X0(e,n)}}function bC(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=t:s=s.next=t}else r=s=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Zg(e,t,n,i){var r=e.updateQueue;Xs=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=c))}if(s!==null){var d=r.baseState;o=0,u=h=c=null,a=s;do{var f=a.lane,v=a.eventTime;if((i&f)===f){u!==null&&(u=u.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var y=e,w=a;switch(f=t,v=n,w.tag){case 1:if(y=w.payload,typeof y=="function"){d=y.call(v,d,f);break t}d=y;break t;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,f=typeof y=="function"?y.call(v,d,f):y,f==null)break t;d=Ae({},d,f);break t;case 2:Xs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else v={eventTime:v,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(h=u=v,c=d):u=u.next=v,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(c=d),r.baseState=c,r.firstBaseUpdate=h,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);xa|=o,e.lanes=o,e.memoizedState=d}}function TC(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(it(191,r));r.call(i)}}}var Lu={},jr=qo(Lu),ru=qo(Lu),su=qo(Lu);function sa(e){if(e===Lu)throw Error(it(174));return e}function g_(e,t){switch(de(su,t),de(ru,e),de(jr,Lu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Cy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Cy(t,e)}ye(jr),de(jr,t)}function Kc(){ye(jr),ye(ru),ye(su)}function cR(e){sa(su.current);var t=sa(jr.current),n=Cy(t,e.type);t!==n&&(de(ru,e),de(jr,n))}function f_(e){ru.current===e&&(ye(jr),ye(ru))}var Ce=qo(0);function tf(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sv=[];function m_(){for(var e=0;e<sv.length;e++)sv[e]._workInProgressVersionPrimary=null;sv.length=0}var fg=Ps.ReactCurrentDispatcher,ov=Ps.ReactCurrentBatchConfig,ya=0,Se=null,Ze=null,ln=null,ef=!1,Eh=!1,ou=0,m5=0;function Tn(){throw Error(it(321))}function p_(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!br(e[n],t[n]))return!1;return!0}function v_(e,t,n,i,r,s){if(ya=s,Se=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fg.current=e===null||e.memoizedState===null?x5:_5,e=n(i,r),Eh){s=0;do{if(Eh=!1,ou=0,25<=s)throw Error(it(301));s+=1,ln=Ze=null,t.updateQueue=null,fg.current=w5,e=n(i,r)}while(Eh)}if(fg.current=nf,t=Ze!==null&&Ze.next!==null,ya=0,ln=Ze=Se=null,ef=!1,t)throw Error(it(300));return e}function y_(){var e=ou!==0;return ou=0,e}function Pr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Se.memoizedState=ln=e:ln=ln.next=e,ln}function $i(){if(Ze===null){var e=Se.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var t=ln===null?Se.memoizedState:ln.next;if(t!==null)ln=t,Ze=e;else{if(e===null)throw Error(it(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},ln===null?Se.memoizedState=ln=e:ln=ln.next=e}return ln}function au(e,t){return typeof t=="function"?t(e):t}function av(e){var t=$i(),n=t.queue;if(n===null)throw Error(it(311));n.lastRenderedReducer=e;var i=Ze,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,h=s;do{var u=h.lane;if((ya&u)===u)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:e(i,h.action);else{var d={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=d,o=i):c=c.next=d,Se.lanes|=u,xa|=u}h=h.next}while(h!==null&&h!==s);c===null?o=i:c.next=a,br(i,t.memoizedState)||(li=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(e=n.interleaved,e!==null){r=e;do s=r.lane,Se.lanes|=s,xa|=s,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function cv(e){var t=$i(),n=t.queue;if(n===null)throw Error(it(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);br(s,t.memoizedState)||(li=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function lR(){}function hR(e,t){var n=Se,i=$i(),r=t(),s=!br(i.memoizedState,r);if(s&&(i.memoizedState=r,li=!0),i=i.queue,x_(gR.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||ln!==null&&ln.memoizedState.tag&1){if(n.flags|=2048,cu(9,dR.bind(null,n,i,r,t),void 0,null),gn===null)throw Error(it(349));ya&30||uR(n,t,r)}return r}function uR(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Se.updateQueue,t===null?(t={lastEffect:null,stores:null},Se.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function dR(e,t,n,i){t.value=n,t.getSnapshot=i,fR(t)&&mR(e)}function gR(e,t,n){return n(function(){fR(t)&&mR(e)})}function fR(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!br(e,n)}catch{return!0}}function mR(e){var t=_s(e,1);t!==null&&mr(t,e,1,-1)}function CC(e){var t=Pr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:au,lastRenderedState:e},t.queue=e,e=e.dispatch=y5.bind(null,Se,e),[t.memoizedState,e]}function cu(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Se.updateQueue,t===null?(t={lastEffect:null,stores:null},Se.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function pR(){return $i().memoizedState}function mg(e,t,n,i){var r=Pr();Se.flags|=e,r.memoizedState=cu(1|t,n,void 0,i===void 0?null:i)}function mm(e,t,n,i){var r=$i();i=i===void 0?null:i;var s=void 0;if(Ze!==null){var o=Ze.memoizedState;if(s=o.destroy,i!==null&&p_(i,o.deps)){r.memoizedState=cu(t,n,s,i);return}}Se.flags|=e,r.memoizedState=cu(1|t,n,s,i)}function kC(e,t){return mg(8390656,8,e,t)}function x_(e,t){return mm(2048,8,e,t)}function vR(e,t){return mm(4,2,e,t)}function yR(e,t){return mm(4,4,e,t)}function xR(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _R(e,t,n){return n=n!=null?n.concat([e]):null,mm(4,4,xR.bind(null,t,e),n)}function __(){}function wR(e,t){var n=$i();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&p_(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function bR(e,t){var n=$i();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&p_(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function TR(e,t,n){return ya&21?(br(n,t)||(n=SA(),Se.lanes|=n,xa|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,li=!0),e.memoizedState=n)}function p5(e,t){var n=ie;ie=n!==0&&4>n?n:4,e(!0);var i=ov.transition;ov.transition={};try{e(!1),t()}finally{ie=n,ov.transition=i}}function CR(){return $i().memoizedState}function v5(e,t,n){var i=mo(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},kR(e))NR(t,n);else if(n=oR(e,t,n,i),n!==null){var r=zn();mr(n,e,i,r),ER(n,t,i)}}function y5(e,t,n){var i=mo(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(kR(e))NR(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,br(a,o)){var c=t.interleaved;c===null?(r.next=r,u_(t)):(r.next=c.next,c.next=r),t.interleaved=r;return}}catch{}finally{}n=oR(e,t,r,i),n!==null&&(r=zn(),mr(n,e,i,r),ER(n,t,i))}}function kR(e){var t=e.alternate;return e===Se||t!==null&&t===Se}function NR(e,t){Eh=ef=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ER(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,X0(e,n)}}var nf={readContext:Hi,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useInsertionEffect:Tn,useLayoutEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useMutableSource:Tn,useSyncExternalStore:Tn,useId:Tn,unstable_isNewReconciler:!1},x5={readContext:Hi,useCallback:function(e,t){return Pr().memoizedState=[e,t===void 0?null:t],e},useContext:Hi,useEffect:kC,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,mg(4194308,4,xR.bind(null,t,e),n)},useLayoutEffect:function(e,t){return mg(4194308,4,e,t)},useInsertionEffect:function(e,t){return mg(4,2,e,t)},useMemo:function(e,t){var n=Pr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Pr();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=v5.bind(null,Se,e),[i.memoizedState,e]},useRef:function(e){var t=Pr();return e={current:e},t.memoizedState=e},useState:CC,useDebugValue:__,useDeferredValue:function(e){return Pr().memoizedState=e},useTransition:function(){var e=CC(!1),t=e[0];return e=p5.bind(null,e[1]),Pr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Se,r=Pr();if(Te){if(n===void 0)throw Error(it(407));n=n()}else{if(n=t(),gn===null)throw Error(it(349));ya&30||uR(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,kC(gR.bind(null,i,s,e),[e]),i.flags|=2048,cu(9,dR.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Pr(),t=gn.identifierPrefix;if(Te){var n=os,i=ss;n=(i&~(1<<32-fr(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=ou++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=m5++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_5={readContext:Hi,useCallback:wR,useContext:Hi,useEffect:x_,useImperativeHandle:_R,useInsertionEffect:vR,useLayoutEffect:yR,useMemo:bR,useReducer:av,useRef:pR,useState:function(){return av(au)},useDebugValue:__,useDeferredValue:function(e){var t=$i();return TR(t,Ze.memoizedState,e)},useTransition:function(){var e=av(au)[0],t=$i().memoizedState;return[e,t]},useMutableSource:lR,useSyncExternalStore:hR,useId:CR,unstable_isNewReconciler:!1},w5={readContext:Hi,useCallback:wR,useContext:Hi,useEffect:x_,useImperativeHandle:_R,useInsertionEffect:vR,useLayoutEffect:yR,useMemo:bR,useReducer:cv,useRef:pR,useState:function(){return cv(au)},useDebugValue:__,useDeferredValue:function(e){var t=$i();return Ze===null?t.memoizedState=e:TR(t,Ze.memoizedState,e)},useTransition:function(){var e=cv(au)[0],t=$i().memoizedState;return[e,t]},useMutableSource:lR,useSyncExternalStore:hR,useId:CR,unstable_isNewReconciler:!1};function rr(e,t){if(e&&e.defaultProps){t=Ae({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function $y(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Ae({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pm={isMounted:function(e){return(e=e._reactInternals)?La(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=zn(),r=mo(e),s=hs(i,r);s.payload=t,n!=null&&(s.callback=n),t=go(e,s,r),t!==null&&(mr(t,e,r,i),gg(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=zn(),r=mo(e),s=hs(i,r);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=go(e,s,r),t!==null&&(mr(t,e,r,i),gg(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zn(),i=mo(e),r=hs(n,i);r.tag=2,t!=null&&(r.callback=t),t=go(e,r,i),t!==null&&(mr(t,e,i,n),gg(t,e,i))}};function NC(e,t,n,i,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,o):t.prototype&&t.prototype.isPureReactComponent?!tu(n,i)||!tu(r,s):!0}function SR(e,t,n){var i=!1,r=ko,s=t.contextType;return typeof s=="object"&&s!==null?s=Hi(s):(r=di(t)?pa:jn.current,i=t.contextTypes,s=(i=i!=null)?Hc(e,r):ko),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pm,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function EC(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&pm.enqueueReplaceState(t,t.state,null)}function zy(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},d_(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=Hi(s):(s=di(t)?pa:jn.current,r.context=Hc(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&($y(e,t,s,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&pm.enqueueReplaceState(r,r.state,null),Zg(e,n,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Wc(e,t){try{var n="",i=t;do n+=Qj(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function lv(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ky(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var b5=typeof WeakMap=="function"?WeakMap:Map;function IR(e,t,n){n=hs(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){sf||(sf=!0,ix=i),Ky(e,t)},n}function AR(e,t,n){n=hs(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){Ky(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ky(e,t),typeof i!="function"&&(fo===null?fo=new Set([this]):fo.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function SC(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new b5;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=V5.bind(null,e,t,n),t.then(e,e))}function IC(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function AC(e,t,n,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=hs(-1,1),t.tag=2,go(n,t,1))),n.lanes|=1),e)}var T5=Ps.ReactCurrentOwner,li=!1;function Bn(e,t,n,i){t.child=e===null?sR(t,null,n,i):zc(t,e.child,n,i)}function RC(e,t,n,i,r){n=n.render;var s=t.ref;return Ic(t,r),i=v_(e,t,n,i,s,r),n=y_(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ws(e,t,r)):(Te&&n&&s_(t),t.flags|=1,Bn(e,t,i,r),t.child)}function PC(e,t,n,i,r){if(e===null){var s=n.type;return typeof s=="function"&&!S_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,RR(e,t,s,i,r)):(e=xg(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:tu,n(o,i)&&e.ref===t.ref)return ws(e,t,r)}return t.flags|=1,e=po(s,i),e.ref=t.ref,e.return=t,t.child=e}function RR(e,t,n,i,r){if(e!==null){var s=e.memoizedProps;if(tu(s,i)&&e.ref===t.ref)if(li=!1,t.pendingProps=i=s,(e.lanes&r)!==0)e.flags&131072&&(li=!0);else return t.lanes=e.lanes,ws(e,t,r)}return Wy(e,t,n,i,r)}function PR(e,t,n){var i=t.pendingProps,r=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},de(fc,pi),pi|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,de(fc,pi),pi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,de(fc,pi),pi|=i}else s!==null?(i=s.baseLanes|n,t.memoizedState=null):i=n,de(fc,pi),pi|=i;return Bn(e,t,r,n),t.child}function MR(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Wy(e,t,n,i,r){var s=di(n)?pa:jn.current;return s=Hc(t,s),Ic(t,r),n=v_(e,t,n,i,s,r),i=y_(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ws(e,t,r)):(Te&&i&&s_(t),t.flags|=1,Bn(e,t,n,r),t.child)}function MC(e,t,n,i,r){if(di(n)){var s=!0;Wg(t)}else s=!1;if(Ic(t,r),t.stateNode===null)pg(e,t),SR(t,n,i),zy(t,n,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Hi(h):(h=di(n)?pa:jn.current,h=Hc(t,h));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==h)&&EC(t,o,i,h),Xs=!1;var f=t.memoizedState;o.state=f,Zg(t,i,o,r),c=t.memoizedState,a!==i||f!==c||ui.current||Xs?(typeof u=="function"&&($y(t,n,u,i),c=t.memoizedState),(a=Xs||NC(t,n,a,i,f,c,h))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=h,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,aR(e,t),a=t.memoizedProps,h=t.type===t.elementType?a:rr(t.type,a),o.props=h,d=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Hi(c):(c=di(n)?pa:jn.current,c=Hc(t,c));var v=n.getDerivedStateFromProps;(u=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&EC(t,o,i,c),Xs=!1,f=t.memoizedState,o.state=f,Zg(t,i,o,r);var y=t.memoizedState;a!==d||f!==y||ui.current||Xs?(typeof v=="function"&&($y(t,n,v,i),y=t.memoizedState),(h=Xs||NC(t,n,h,i,f,y,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=y),o.props=i,o.state=y,o.context=c,i=h):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return Qy(e,t,n,i,s,r)}function Qy(e,t,n,i,r,s){MR(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&yC(t,n,!1),ws(e,t,s);i=t.stateNode,T5.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=zc(t,e.child,null,s),t.child=zc(t,null,a,s)):Bn(e,t,a,s),t.memoizedState=i.state,r&&yC(t,n,!0),t.child}function DR(e){var t=e.stateNode;t.pendingContext?vC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vC(e,t.context,!1),g_(e,t.containerInfo)}function DC(e,t,n,i,r){return $c(),a_(r),t.flags|=256,Bn(e,t,n,i),t.child}var Yy={dehydrated:null,treeContext:null,retryLane:0};function Xy(e){return{baseLanes:e,cachePool:null,transitions:null}}function LR(e,t,n){var i=t.pendingProps,r=Ce.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),de(Ce,r&1),e===null)return Gy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,s?(i=t.mode,s=t.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=xm(o,i,0,null),e=da(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Xy(n),t.memoizedState=Yy,e):w_(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return C5(e,t,o,i,a,r,n);if(s){s=i.fallback,o=t.mode,r=e.child,a=r.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=c,t.deletions=null):(i=po(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=po(a,s):(s=da(s,o,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,o=e.child.memoizedState,o=o===null?Xy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=Yy,i}return s=e.child,e=s.sibling,i=po(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function w_(e,t){return t=xm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dd(e,t,n,i){return i!==null&&a_(i),zc(t,e.child,null,n),e=w_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function C5(e,t,n,i,r,s,o){if(n)return t.flags&256?(t.flags&=-257,i=lv(Error(it(422))),Dd(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=xm({mode:"visible",children:i.children},r,0,null),s=da(s,r,o,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&zc(t,e.child,null,o),t.child.memoizedState=Xy(o),t.memoizedState=Yy,s);if(!(t.mode&1))return Dd(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(it(419)),i=lv(s,i,void 0),Dd(e,t,o,i)}if(a=(o&e.childLanes)!==0,li||a){if(i=gn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,_s(e,r),mr(i,e,r,-1))}return E_(),i=lv(Error(it(421))),Dd(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=q5.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,yi=uo(r.nextSibling),_i=t,Te=!0,ar=null,e!==null&&(Ri[Pi++]=ss,Ri[Pi++]=os,Ri[Pi++]=va,ss=e.id,os=e.overflow,va=t),t=w_(t,i.children),t.flags|=4096,t)}function LC(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Hy(e.return,t,n)}function hv(e,t,n,i,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function VR(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Bn(e,t,i.children,n),i=Ce.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&LC(e,n,t);else if(e.tag===19)LC(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(de(Ce,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&tf(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),hv(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&tf(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}hv(t,!0,n,null,s);break;case"together":hv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function pg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ws(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),xa|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(it(153));if(t.child!==null){for(e=t.child,n=po(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=po(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function k5(e,t,n){switch(t.tag){case 3:DR(t),$c();break;case 5:cR(t);break;case 1:di(t.type)&&Wg(t);break;case 4:g_(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;de(Xg,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(de(Ce,Ce.current&1),t.flags|=128,null):n&t.child.childLanes?LR(e,t,n):(de(Ce,Ce.current&1),e=ws(e,t,n),e!==null?e.sibling:null);de(Ce,Ce.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return VR(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),de(Ce,Ce.current),i)break;return null;case 22:case 23:return t.lanes=0,PR(e,t,n)}return ws(e,t,n)}var qR,Jy,jR,FR;qR=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jy=function(){};jR=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,sa(jr.current);var s=null;switch(n){case"input":r=_y(e,r),i=_y(e,i),s=[];break;case"select":r=Ae({},r,{value:void 0}),i=Ae({},i,{value:void 0}),s=[];break;case"textarea":r=Ty(e,r),i=Ty(e,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=zg)}ky(n,i);var o;n=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var a=r[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Kh.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(a=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Kh.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&me("scroll",e),s||a===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};FR=function(e,t,n,i){n!==i&&(t.flags|=4)};function Jl(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function N5(e,t,n){var i=t.pendingProps;switch(o_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(t),null;case 1:return di(t.type)&&Kg(),Cn(t),null;case 3:return i=t.stateNode,Kc(),ye(ui),ye(jn),m_(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Pd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ar!==null&&(ox(ar),ar=null))),Jy(e,t),Cn(t),null;case 5:f_(t);var r=sa(su.current);if(n=t.type,e!==null&&t.stateNode!=null)jR(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(it(166));return Cn(t),null}if(e=sa(jr.current),Pd(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[Dr]=t,i[iu]=s,e=(t.mode&1)!==0,n){case"dialog":me("cancel",i),me("close",i);break;case"iframe":case"object":case"embed":me("load",i);break;case"video":case"audio":for(r=0;r<mh.length;r++)me(mh[r],i);break;case"source":me("error",i);break;case"img":case"image":case"link":me("error",i),me("load",i);break;case"details":me("toggle",i);break;case"input":HT(i,s),me("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},me("invalid",i);break;case"textarea":zT(i,s),me("invalid",i)}ky(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Rd(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Rd(i.textContent,a,e),r=["children",""+a]):Kh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&me("scroll",i)}switch(n){case"input":Td(i),$T(i,s,!0);break;case"textarea":Td(i),KT(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=zg)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gA(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(n,{is:i.is}):(e=o.createElement(n),n==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,n),e[Dr]=t,e[iu]=i,qR(e,t,!1,!1),t.stateNode=e;t:{switch(o=Ny(n,i),n){case"dialog":me("cancel",e),me("close",e),r=i;break;case"iframe":case"object":case"embed":me("load",e),r=i;break;case"video":case"audio":for(r=0;r<mh.length;r++)me(mh[r],e);r=i;break;case"source":me("error",e),r=i;break;case"img":case"image":case"link":me("error",e),me("load",e),r=i;break;case"details":me("toggle",e),r=i;break;case"input":HT(e,i),r=_y(e,i),me("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=Ae({},i,{value:void 0}),me("invalid",e);break;case"textarea":zT(e,i),r=Ty(e,i),me("invalid",e);break;default:r=i}ky(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?pA(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&fA(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Wh(e,c):typeof c=="number"&&Wh(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Kh.hasOwnProperty(s)?c!=null&&s==="onScroll"&&me("scroll",e):c!=null&&$0(e,s,c,o))}switch(n){case"input":Td(e),$T(e,i,!1);break;case"textarea":Td(e),KT(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Co(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?kc(e,!!i.multiple,s,!1):i.defaultValue!=null&&kc(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=zg)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Cn(t),null;case 6:if(e&&t.stateNode!=null)FR(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(it(166));if(n=sa(su.current),sa(jr.current),Pd(t)){if(i=t.stateNode,n=t.memoizedProps,i[Dr]=t,(s=i.nodeValue!==n)&&(e=_i,e!==null))switch(e.tag){case 3:Rd(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Rd(i.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Dr]=t,t.stateNode=i}return Cn(t),null;case 13:if(ye(Ce),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&yi!==null&&t.mode&1&&!(t.flags&128))iR(),$c(),t.flags|=98560,s=!1;else if(s=Pd(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(it(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(it(317));s[Dr]=t}else $c(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Cn(t),s=!1}else ar!==null&&(ox(ar),ar=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Ce.current&1?tn===0&&(tn=3):E_())),t.updateQueue!==null&&(t.flags|=4),Cn(t),null);case 4:return Kc(),Jy(e,t),e===null&&eu(t.stateNode.containerInfo),Cn(t),null;case 10:return h_(t.type._context),Cn(t),null;case 17:return di(t.type)&&Kg(),Cn(t),null;case 19:if(ye(Ce),s=t.memoizedState,s===null)return Cn(t),null;if(i=(t.flags&128)!==0,o=s.rendering,o===null)if(i)Jl(s,!1);else{if(tn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=tf(e),o!==null){for(t.flags|=128,Jl(s,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)s=n,e=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return de(Ce,Ce.current&1|2),t.child}e=e.sibling}s.tail!==null&&Fe()>Qc&&(t.flags|=128,i=!0,Jl(s,!1),t.lanes=4194304)}else{if(!i)if(e=tf(o),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Jl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Te)return Cn(t),null}else 2*Fe()-s.renderingStartTime>Qc&&n!==1073741824&&(t.flags|=128,i=!0,Jl(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Fe(),t.sibling=null,n=Ce.current,de(Ce,i?n&1|2:n&1),t):(Cn(t),null);case 22:case 23:return N_(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?pi&1073741824&&(Cn(t),t.subtreeFlags&6&&(t.flags|=8192)):Cn(t),null;case 24:return null;case 25:return null}throw Error(it(156,t.tag))}function E5(e,t){switch(o_(t),t.tag){case 1:return di(t.type)&&Kg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kc(),ye(ui),ye(jn),m_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return f_(t),null;case 13:if(ye(Ce),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(it(340));$c()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ye(Ce),null;case 4:return Kc(),null;case 10:return h_(t.type._context),null;case 22:case 23:return N_(),null;case 24:return null;default:return null}}var Ld=!1,Sn=!1,S5=typeof WeakSet=="function"?WeakSet:Set,xt=null;function gc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){De(e,t,i)}else n.current=null}function Zy(e,t,n){try{n()}catch(i){De(e,t,i)}}var VC=!1;function I5(e,t){if(Vy=Gg,e=HA(),r_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else t:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break t}var o=0,a=-1,c=-1,h=0,u=0,d=e,f=null;e:for(;;){for(var v;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(c=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(v=d.firstChild)!==null;)f=d,d=v;for(;;){if(d===e)break e;if(f===n&&++h===r&&(a=o),f===s&&++u===i&&(c=o),(v=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=v}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(qy={focusedElem:e,selectionRange:n},Gg=!1,xt=t;xt!==null;)if(t=xt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xt=e;else for(;xt!==null;){t=xt;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,_=y.memoizedState,x=t.stateNode,C=x.getSnapshotBeforeUpdate(t.elementType===t.type?w:rr(t.type,w),_);x.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(it(163))}}catch(P){De(t,t.return,P)}if(e=t.sibling,e!==null){e.return=t.return,xt=e;break}xt=t.return}return y=VC,VC=!1,y}function Sh(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&Zy(t,n,s)}r=r.next}while(r!==i)}}function vm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function tx(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function UR(e){var t=e.alternate;t!==null&&(e.alternate=null,UR(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dr],delete t[iu],delete t[Uy],delete t[u5],delete t[d5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function OR(e){return e.tag===5||e.tag===3||e.tag===4}function qC(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||OR(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ex(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=zg));else if(i!==4&&(e=e.child,e!==null))for(ex(e,t,n),e=e.sibling;e!==null;)ex(e,t,n),e=e.sibling}function nx(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(nx(e,t,n),e=e.sibling;e!==null;)nx(e,t,n),e=e.sibling}var yn=null,or=!1;function zs(e,t,n){for(n=n.child;n!==null;)BR(e,t,n),n=n.sibling}function BR(e,t,n){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(lm,n)}catch{}switch(n.tag){case 5:Sn||gc(n,t);case 6:var i=yn,r=or;yn=null,zs(e,t,n),yn=i,or=r,yn!==null&&(or?(e=yn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):yn.removeChild(n.stateNode));break;case 18:yn!==null&&(or?(e=yn,n=n.stateNode,e.nodeType===8?iv(e.parentNode,n):e.nodeType===1&&iv(e,n),Jh(e)):iv(yn,n.stateNode));break;case 4:i=yn,r=or,yn=n.stateNode.containerInfo,or=!0,zs(e,t,n),yn=i,or=r;break;case 0:case 11:case 14:case 15:if(!Sn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Zy(n,t,o),r=r.next}while(r!==i)}zs(e,t,n);break;case 1:if(!Sn&&(gc(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){De(n,t,a)}zs(e,t,n);break;case 21:zs(e,t,n);break;case 22:n.mode&1?(Sn=(i=Sn)||n.memoizedState!==null,zs(e,t,n),Sn=i):zs(e,t,n);break;default:zs(e,t,n)}}function jC(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new S5),t.forEach(function(i){var r=j5.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}}function er(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,o=t,a=o;t:for(;a!==null;){switch(a.tag){case 5:yn=a.stateNode,or=!1;break t;case 3:yn=a.stateNode.containerInfo,or=!0;break t;case 4:yn=a.stateNode.containerInfo,or=!0;break t}a=a.return}if(yn===null)throw Error(it(160));BR(s,o,r),yn=null,or=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(h){De(r,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)GR(t,e),t=t.sibling}function GR(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(er(t,e),Ar(e),i&4){try{Sh(3,e,e.return),vm(3,e)}catch(w){De(e,e.return,w)}try{Sh(5,e,e.return)}catch(w){De(e,e.return,w)}}break;case 1:er(t,e),Ar(e),i&512&&n!==null&&gc(n,n.return);break;case 5:if(er(t,e),Ar(e),i&512&&n!==null&&gc(n,n.return),e.flags&32){var r=e.stateNode;try{Wh(r,"")}catch(w){De(e,e.return,w)}}if(i&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&uA(r,s),Ny(a,o);var h=Ny(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?pA(r,d):u==="dangerouslySetInnerHTML"?fA(r,d):u==="children"?Wh(r,d):$0(r,u,d,h)}switch(a){case"input":wy(r,s);break;case"textarea":dA(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?kc(r,!!s.multiple,v,!1):f!==!!s.multiple&&(s.defaultValue!=null?kc(r,!!s.multiple,s.defaultValue,!0):kc(r,!!s.multiple,s.multiple?[]:"",!1))}r[iu]=s}catch(w){De(e,e.return,w)}}break;case 6:if(er(t,e),Ar(e),i&4){if(e.stateNode===null)throw Error(it(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(w){De(e,e.return,w)}}break;case 3:if(er(t,e),Ar(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Jh(t.containerInfo)}catch(w){De(e,e.return,w)}break;case 4:er(t,e),Ar(e);break;case 13:er(t,e),Ar(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(C_=Fe())),i&4&&jC(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(Sn=(h=Sn)||u,er(t,e),Sn=h):er(t,e),Ar(e),i&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!u&&e.mode&1)for(xt=e,u=e.child;u!==null;){for(d=xt=u;xt!==null;){switch(f=xt,v=f.child,f.tag){case 0:case 11:case 14:case 15:Sh(4,f,f.return);break;case 1:gc(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){i=f,n=f.return;try{t=i,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(w){De(i,n,w)}}break;case 5:gc(f,f.return);break;case 22:if(f.memoizedState!==null){UC(d);continue}}v!==null?(v.return=f,xt=v):UC(d)}u=u.sibling}t:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=mA("display",o))}catch(w){De(e,e.return,w)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(w){De(e,e.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break t;for(;d.sibling===null;){if(d.return===null||d.return===e)break t;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:er(t,e),Ar(e),i&4&&jC(e);break;case 21:break;default:er(t,e),Ar(e)}}function Ar(e){var t=e.flags;if(t&2){try{t:{for(var n=e.return;n!==null;){if(OR(n)){var i=n;break t}n=n.return}throw Error(it(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Wh(r,""),i.flags&=-33);var s=qC(e);nx(e,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=qC(e);ex(e,a,o);break;default:throw Error(it(161))}}catch(c){De(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function A5(e,t,n){xt=e,HR(e)}function HR(e,t,n){for(var i=(e.mode&1)!==0;xt!==null;){var r=xt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Ld;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||Sn;a=Ld;var h=Sn;if(Ld=o,(Sn=c)&&!h)for(xt=r;xt!==null;)o=xt,c=o.child,o.tag===22&&o.memoizedState!==null?OC(r):c!==null?(c.return=o,xt=c):OC(r);for(;s!==null;)xt=s,HR(s),s=s.sibling;xt=r,Ld=a,Sn=h}FC(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,xt=s):FC(e)}}function FC(e){for(;xt!==null;){var t=xt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Sn||vm(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Sn)if(n===null)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:rr(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&TC(t,s,i);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}TC(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Jh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(it(163))}Sn||t.flags&512&&tx(t)}catch(f){De(t,t.return,f)}}if(t===e){xt=null;break}if(n=t.sibling,n!==null){n.return=t.return,xt=n;break}xt=t.return}}function UC(e){for(;xt!==null;){var t=xt;if(t===e){xt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xt=n;break}xt=t.return}}function OC(e){for(;xt!==null;){var t=xt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{vm(4,t)}catch(c){De(t,n,c)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(c){De(t,r,c)}}var s=t.return;try{tx(t)}catch(c){De(t,s,c)}break;case 5:var o=t.return;try{tx(t)}catch(c){De(t,o,c)}}}catch(c){De(t,t.return,c)}if(t===e){xt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,xt=a;break}xt=t.return}}var R5=Math.ceil,rf=Ps.ReactCurrentDispatcher,b_=Ps.ReactCurrentOwner,Fi=Ps.ReactCurrentBatchConfig,Jt=0,gn=null,He=null,wn=0,pi=0,fc=qo(0),tn=0,lu=null,xa=0,ym=0,T_=0,Ih=null,oi=null,C_=0,Qc=1/0,is=null,sf=!1,ix=null,fo=null,Vd=!1,so=null,of=0,Ah=0,rx=null,vg=-1,yg=0;function zn(){return Jt&6?Fe():vg!==-1?vg:vg=Fe()}function mo(e){return e.mode&1?Jt&2&&wn!==0?wn&-wn:f5.transition!==null?(yg===0&&(yg=SA()),yg):(e=ie,e!==0||(e=window.event,e=e===void 0?16:LA(e.type)),e):1}function mr(e,t,n,i){if(50<Ah)throw Ah=0,rx=null,Error(it(185));Pu(e,n,i),(!(Jt&2)||e!==gn)&&(e===gn&&(!(Jt&2)&&(ym|=n),tn===4&&Zs(e,wn)),gi(e,i),n===1&&Jt===0&&!(t.mode&1)&&(Qc=Fe()+500,fm&&jo()))}function gi(e,t){var n=e.callbackNode;f3(e,t);var i=Bg(e,e===gn?wn:0);if(i===0)n!==null&&YT(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&YT(n),t===1)e.tag===0?g5(BC.bind(null,e)):tR(BC.bind(null,e)),l5(function(){!(Jt&6)&&jo()}),n=null;else{switch(IA(i)){case 1:n=Y0;break;case 4:n=NA;break;case 16:n=Og;break;case 536870912:n=EA;break;default:n=Og}n=JR(n,$R.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function $R(e,t){if(vg=-1,yg=0,Jt&6)throw Error(it(327));var n=e.callbackNode;if(Ac()&&e.callbackNode!==n)return null;var i=Bg(e,e===gn?wn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=af(e,i);else{t=i;var r=Jt;Jt|=2;var s=KR();(gn!==e||wn!==t)&&(is=null,Qc=Fe()+500,ua(e,t));do try{D5();break}catch(a){zR(e,a)}while(!0);l_(),rf.current=s,Jt=r,He!==null?t=0:(gn=null,wn=0,t=tn)}if(t!==0){if(t===2&&(r=Ry(e),r!==0&&(i=r,t=sx(e,r))),t===1)throw n=lu,ua(e,0),Zs(e,i),gi(e,Fe()),n;if(t===6)Zs(e,i);else{if(r=e.current.alternate,!(i&30)&&!P5(r)&&(t=af(e,i),t===2&&(s=Ry(e),s!==0&&(i=s,t=sx(e,s))),t===1))throw n=lu,ua(e,0),Zs(e,i),gi(e,Fe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(it(345));case 2:Jo(e,oi,is);break;case 3:if(Zs(e,i),(i&130023424)===i&&(t=C_+500-Fe(),10<t)){if(Bg(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){zn(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Fy(Jo.bind(null,e,oi,is),t);break}Jo(e,oi,is);break;case 4:if(Zs(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-fr(i);s=1<<o,o=t[o],o>r&&(r=o),i&=~s}if(i=r,i=Fe()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*R5(i/1960))-i,10<i){e.timeoutHandle=Fy(Jo.bind(null,e,oi,is),i);break}Jo(e,oi,is);break;case 5:Jo(e,oi,is);break;default:throw Error(it(329))}}}return gi(e,Fe()),e.callbackNode===n?$R.bind(null,e):null}function sx(e,t){var n=Ih;return e.current.memoizedState.isDehydrated&&(ua(e,t).flags|=256),e=af(e,t),e!==2&&(t=oi,oi=n,t!==null&&ox(t)),e}function ox(e){oi===null?oi=e:oi.push.apply(oi,e)}function P5(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!br(s(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zs(e,t){for(t&=~T_,t&=~ym,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-fr(t),i=1<<n;e[n]=-1,t&=~i}}function BC(e){if(Jt&6)throw Error(it(327));Ac();var t=Bg(e,0);if(!(t&1))return gi(e,Fe()),null;var n=af(e,t);if(e.tag!==0&&n===2){var i=Ry(e);i!==0&&(t=i,n=sx(e,i))}if(n===1)throw n=lu,ua(e,0),Zs(e,t),gi(e,Fe()),n;if(n===6)throw Error(it(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jo(e,oi,is),gi(e,Fe()),null}function k_(e,t){var n=Jt;Jt|=1;try{return e(t)}finally{Jt=n,Jt===0&&(Qc=Fe()+500,fm&&jo())}}function _a(e){so!==null&&so.tag===0&&!(Jt&6)&&Ac();var t=Jt;Jt|=1;var n=Fi.transition,i=ie;try{if(Fi.transition=null,ie=1,e)return e()}finally{ie=i,Fi.transition=n,Jt=t,!(Jt&6)&&jo()}}function N_(){pi=fc.current,ye(fc)}function ua(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,c5(n)),He!==null)for(n=He.return;n!==null;){var i=n;switch(o_(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Kg();break;case 3:Kc(),ye(ui),ye(jn),m_();break;case 5:f_(i);break;case 4:Kc();break;case 13:ye(Ce);break;case 19:ye(Ce);break;case 10:h_(i.type._context);break;case 22:case 23:N_()}n=n.return}if(gn=e,He=e=po(e.current,null),wn=pi=t,tn=0,lu=null,T_=ym=xa=0,oi=Ih=null,ra!==null){for(t=0;t<ra.length;t++)if(n=ra[t],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}ra=null}return e}function zR(e,t){do{var n=He;try{if(l_(),fg.current=nf,ef){for(var i=Se.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}ef=!1}if(ya=0,ln=Ze=Se=null,Eh=!1,ou=0,b_.current=null,n===null||n.return===null){tn=1,lu=t,He=null;break}t:{var s=e,o=n.return,a=n,c=t;if(t=wn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var v=IC(o);if(v!==null){v.flags&=-257,AC(v,o,a,s,t),v.mode&1&&SC(s,h,t),t=v,c=h;var y=t.updateQueue;if(y===null){var w=new Set;w.add(c),t.updateQueue=w}else y.add(c);break t}else{if(!(t&1)){SC(s,h,t),E_();break t}c=Error(it(426))}}else if(Te&&a.mode&1){var _=IC(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),AC(_,o,a,s,t),a_(Wc(c,a));break t}}s=c=Wc(c,a),tn!==4&&(tn=2),Ih===null?Ih=[s]:Ih.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=IR(s,c,t);bC(s,x);break t;case 1:a=c;var C=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(fo===null||!fo.has(k)))){s.flags|=65536,t&=-t,s.lanes|=t;var P=AR(s,a,t);bC(s,P);break t}}s=s.return}while(s!==null)}QR(n)}catch(A){t=A,He===n&&n!==null&&(He=n=n.return);continue}break}while(!0)}function KR(){var e=rf.current;return rf.current=nf,e===null?nf:e}function E_(){(tn===0||tn===3||tn===2)&&(tn=4),gn===null||!(xa&268435455)&&!(ym&268435455)||Zs(gn,wn)}function af(e,t){var n=Jt;Jt|=2;var i=KR();(gn!==e||wn!==t)&&(is=null,ua(e,t));do try{M5();break}catch(r){zR(e,r)}while(!0);if(l_(),Jt=n,rf.current=i,He!==null)throw Error(it(261));return gn=null,wn=0,tn}function M5(){for(;He!==null;)WR(He)}function D5(){for(;He!==null&&!s3();)WR(He)}function WR(e){var t=XR(e.alternate,e,pi);e.memoizedProps=e.pendingProps,t===null?QR(e):He=t,b_.current=null}function QR(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=E5(n,t),n!==null){n.flags&=32767,He=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tn=6,He=null;return}}else if(n=N5(n,t,pi),n!==null){He=n;return}if(t=t.sibling,t!==null){He=t;return}He=t=e}while(t!==null);tn===0&&(tn=5)}function Jo(e,t,n){var i=ie,r=Fi.transition;try{Fi.transition=null,ie=1,L5(e,t,n,i)}finally{Fi.transition=r,ie=i}return null}function L5(e,t,n,i){do Ac();while(so!==null);if(Jt&6)throw Error(it(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(it(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(m3(e,s),e===gn&&(He=gn=null,wn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vd||(Vd=!0,JR(Og,function(){return Ac(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Fi.transition,Fi.transition=null;var o=ie;ie=1;var a=Jt;Jt|=4,b_.current=null,I5(e,n),GR(n,e),e5(qy),Gg=!!Vy,qy=Vy=null,e.current=n,A5(n),o3(),Jt=a,ie=o,Fi.transition=s}else e.current=n;if(Vd&&(Vd=!1,so=e,of=r),s=e.pendingLanes,s===0&&(fo=null),l3(n.stateNode),gi(e,Fe()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(sf)throw sf=!1,e=ix,ix=null,e;return of&1&&e.tag!==0&&Ac(),s=e.pendingLanes,s&1?e===rx?Ah++:(Ah=0,rx=e):Ah=0,jo(),null}function Ac(){if(so!==null){var e=IA(of),t=Fi.transition,n=ie;try{if(Fi.transition=null,ie=16>e?16:e,so===null)var i=!1;else{if(e=so,so=null,of=0,Jt&6)throw Error(it(331));var r=Jt;for(Jt|=4,xt=e.current;xt!==null;){var s=xt,o=s.child;if(xt.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(xt=h;xt!==null;){var u=xt;switch(u.tag){case 0:case 11:case 15:Sh(8,u,s)}var d=u.child;if(d!==null)d.return=u,xt=d;else for(;xt!==null;){u=xt;var f=u.sibling,v=u.return;if(UR(u),u===h){xt=null;break}if(f!==null){f.return=v,xt=f;break}xt=v}}}var y=s.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}xt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xt=o;else t:for(;xt!==null;){if(s=xt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sh(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,xt=x;break t}xt=s.return}}var C=e.current;for(xt=C;xt!==null;){o=xt;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,xt=k;else t:for(o=C;xt!==null;){if(a=xt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:vm(9,a)}}catch(A){De(a,a.return,A)}if(a===o){xt=null;break t}var P=a.sibling;if(P!==null){P.return=a.return,xt=P;break t}xt=a.return}}if(Jt=r,jo(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(lm,e)}catch{}i=!0}return i}finally{ie=n,Fi.transition=t}}return!1}function GC(e,t,n){t=Wc(n,t),t=IR(e,t,1),e=go(e,t,1),t=zn(),e!==null&&(Pu(e,1,t),gi(e,t))}function De(e,t,n){if(e.tag===3)GC(e,e,n);else for(;t!==null;){if(t.tag===3){GC(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(fo===null||!fo.has(i))){e=Wc(n,e),e=AR(t,e,1),t=go(t,e,1),e=zn(),t!==null&&(Pu(t,1,e),gi(t,e));break}}t=t.return}}function V5(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=zn(),e.pingedLanes|=e.suspendedLanes&n,gn===e&&(wn&n)===n&&(tn===4||tn===3&&(wn&130023424)===wn&&500>Fe()-C_?ua(e,0):T_|=n),gi(e,t)}function YR(e,t){t===0&&(e.mode&1?(t=Nd,Nd<<=1,!(Nd&130023424)&&(Nd=4194304)):t=1);var n=zn();e=_s(e,t),e!==null&&(Pu(e,t,n),gi(e,n))}function q5(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),YR(e,n)}function j5(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(it(314))}i!==null&&i.delete(t),YR(e,n)}var XR;XR=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ui.current)li=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return li=!1,k5(e,t,n);li=!!(e.flags&131072)}else li=!1,Te&&t.flags&1048576&&eR(t,Yg,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;pg(e,t),e=t.pendingProps;var r=Hc(t,jn.current);Ic(t,n),r=v_(null,t,i,e,r,n);var s=y_();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,di(i)?(s=!0,Wg(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,d_(t),r.updater=pm,t.stateNode=r,r._reactInternals=t,zy(t,i,e,n),t=Qy(null,t,i,!0,s,n)):(t.tag=0,Te&&s&&s_(t),Bn(null,t,r,n),t=t.child),t;case 16:i=t.elementType;t:{switch(pg(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=U5(i),e=rr(i,e),r){case 0:t=Wy(null,t,i,e,n);break t;case 1:t=MC(null,t,i,e,n);break t;case 11:t=RC(null,t,i,e,n);break t;case 14:t=PC(null,t,i,rr(i.type,e),n);break t}throw Error(it(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),Wy(e,t,i,r,n);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),MC(e,t,i,r,n);case 3:t:{if(DR(t),e===null)throw Error(it(387));i=t.pendingProps,s=t.memoizedState,r=s.element,aR(e,t),Zg(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=Wc(Error(it(423)),t),t=DC(e,t,i,n,r);break t}else if(i!==r){r=Wc(Error(it(424)),t),t=DC(e,t,i,n,r);break t}else for(yi=uo(t.stateNode.containerInfo.firstChild),_i=t,Te=!0,ar=null,n=sR(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($c(),i===r){t=ws(e,t,n);break t}Bn(e,t,i,n)}t=t.child}return t;case 5:return cR(t),e===null&&Gy(t),i=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,o=r.children,jy(i,r)?o=null:s!==null&&jy(i,s)&&(t.flags|=32),MR(e,t),Bn(e,t,o,n),t.child;case 6:return e===null&&Gy(t),null;case 13:return LR(e,t,n);case 4:return g_(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=zc(t,null,i,n):Bn(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),RC(e,t,i,r,n);case 7:return Bn(e,t,t.pendingProps,n),t.child;case 8:return Bn(e,t,t.pendingProps.children,n),t.child;case 12:return Bn(e,t,t.pendingProps.children,n),t.child;case 10:t:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,de(Xg,i._currentValue),i._currentValue=o,s!==null)if(br(s.value,o)){if(s.children===r.children&&!ui.current){t=ws(e,t,n);break t}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=hs(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?c.next=c:(c.next=u.next,u.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Hy(s.return,n,t),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(it(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Hy(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Bn(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ic(t,n),r=Hi(r),i=i(r),t.flags|=1,Bn(e,t,i,n),t.child;case 14:return i=t.type,r=rr(i,t.pendingProps),r=rr(i.type,r),PC(e,t,i,r,n);case 15:return RR(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),pg(e,t),t.tag=1,di(i)?(e=!0,Wg(t)):e=!1,Ic(t,n),SR(t,i,r),zy(t,i,r,n),Qy(null,t,i,!0,e,n);case 19:return VR(e,t,n);case 22:return PR(e,t,n)}throw Error(it(156,t.tag))};function JR(e,t){return kA(e,t)}function F5(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Di(e,t,n,i){return new F5(e,t,n,i)}function S_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function U5(e){if(typeof e=="function")return S_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===K0)return 11;if(e===W0)return 14}return 2}function po(e,t){var n=e.alternate;return n===null?(n=Di(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xg(e,t,n,i,r,s){var o=2;if(i=e,typeof e=="function")S_(e)&&(o=1);else if(typeof e=="string")o=5;else t:switch(e){case rc:return da(n.children,r,s,t);case z0:o=8,r|=8;break;case py:return e=Di(12,n,t,r|2),e.elementType=py,e.lanes=s,e;case vy:return e=Di(13,n,t,r),e.elementType=vy,e.lanes=s,e;case yy:return e=Di(19,n,t,r),e.elementType=yy,e.lanes=s,e;case cA:return xm(n,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case oA:o=10;break t;case aA:o=9;break t;case K0:o=11;break t;case W0:o=14;break t;case Ys:o=16,i=null;break t}throw Error(it(130,e==null?e:typeof e,""))}return t=Di(o,n,t,r),t.elementType=e,t.type=i,t.lanes=s,t}function da(e,t,n,i){return e=Di(7,e,i,t),e.lanes=n,e}function xm(e,t,n,i){return e=Di(22,e,i,t),e.elementType=cA,e.lanes=n,e.stateNode={isHidden:!1},e}function uv(e,t,n){return e=Di(6,e,null,t),e.lanes=n,e}function dv(e,t,n){return t=Di(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function O5(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zp(0),this.expirationTimes=zp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zp(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function I_(e,t,n,i,r,s,o,a,c){return e=new O5(e,t,n,a,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Di(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},d_(s),e}function B5(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ic,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function ZR(e){if(!e)return ko;e=e._reactInternals;t:{if(La(e)!==e||e.tag!==1)throw Error(it(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(it(171))}if(e.tag===1){var n=e.type;if(di(n))return ZA(e,n,t)}return t}function tP(e,t,n,i,r,s,o,a,c){return e=I_(n,i,!0,e,r,s,o,a,c),e.context=ZR(null),n=e.current,i=zn(),r=mo(n),s=hs(i,r),s.callback=t??null,go(n,s,r),e.current.lanes=r,Pu(e,r,i),gi(e,i),e}function _m(e,t,n,i){var r=t.current,s=zn(),o=mo(r);return n=ZR(n),t.context===null?t.context=n:t.pendingContext=n,t=hs(s,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=go(r,t,o),e!==null&&(mr(e,r,o,s),gg(e,r,o)),o}function cf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function HC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function A_(e,t){HC(e,t),(e=e.alternate)&&HC(e,t)}function G5(){return null}var eP=typeof reportError=="function"?reportError:function(e){console.error(e)};function R_(e){this._internalRoot=e}wm.prototype.render=R_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(it(409));_m(e,t,null,null)};wm.prototype.unmount=R_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;_a(function(){_m(null,e,null,null)}),t[xs]=null}};function wm(e){this._internalRoot=e}wm.prototype.unstable_scheduleHydration=function(e){if(e){var t=PA();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Js.length&&t!==0&&t<Js[n].priority;n++);Js.splice(n,0,e),n===0&&DA(e)}};function P_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $C(){}function H5(e,t,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var h=cf(o);s.call(h)}}var o=tP(t,i,e,0,null,!1,!1,"",$C);return e._reactRootContainer=o,e[xs]=o.current,eu(e.nodeType===8?e.parentNode:e),_a(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var h=cf(c);a.call(h)}}var c=I_(e,0,!1,null,null,!1,!1,"",$C);return e._reactRootContainer=c,e[xs]=c.current,eu(e.nodeType===8?e.parentNode:e),_a(function(){_m(t,c,n,i)}),c}function Tm(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=cf(o);a.call(c)}}_m(t,o,e,r)}else o=H5(n,t,e,r,i);return cf(o)}AA=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fh(t.pendingLanes);n!==0&&(X0(t,n|1),gi(t,Fe()),!(Jt&6)&&(Qc=Fe()+500,jo()))}break;case 13:_a(function(){var i=_s(e,1);if(i!==null){var r=zn();mr(i,e,1,r)}}),A_(e,1)}};J0=function(e){if(e.tag===13){var t=_s(e,134217728);if(t!==null){var n=zn();mr(t,e,134217728,n)}A_(e,134217728)}};RA=function(e){if(e.tag===13){var t=mo(e),n=_s(e,t);if(n!==null){var i=zn();mr(n,e,t,i)}A_(e,t)}};PA=function(){return ie};MA=function(e,t){var n=ie;try{return ie=e,t()}finally{ie=n}};Sy=function(e,t,n){switch(t){case"input":if(wy(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=gm(i);if(!r)throw Error(it(90));hA(i),wy(i,r)}}}break;case"textarea":dA(e,n);break;case"select":t=n.value,t!=null&&kc(e,!!n.multiple,t,!1)}};xA=k_;_A=_a;var $5={usingClientEntryPoint:!1,Events:[Du,cc,gm,vA,yA,k_]},Zl={findFiberByHostInstance:ia,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},z5={bundleType:Zl.bundleType,version:Zl.version,rendererPackageName:Zl.rendererPackageName,rendererConfig:Zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=TA(e),e===null?null:e.stateNode},findFiberByHostInstance:Zl.findFiberByHostInstance||G5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qd.isDisabled&&qd.supportsFiber)try{lm=qd.inject(z5),qr=qd}catch{}}ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$5;ki.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!P_(t))throw Error(it(200));return B5(e,t,null,n)};ki.createRoot=function(e,t){if(!P_(e))throw Error(it(299));var n=!1,i="",r=eP;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=I_(e,1,!1,null,null,n,!1,i,r),e[xs]=t.current,eu(e.nodeType===8?e.parentNode:e),new R_(t)};ki.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(it(188)):(e=Object.keys(e).join(","),Error(it(268,e)));return e=TA(t),e=e===null?null:e.stateNode,e};ki.flushSync=function(e){return _a(e)};ki.hydrate=function(e,t,n){if(!bm(t))throw Error(it(200));return Tm(null,e,t,!0,n)};ki.hydrateRoot=function(e,t,n){if(!P_(e))throw Error(it(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=eP;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=tP(t,null,e,1,n??null,r,!1,s,o),e[xs]=t.current,eu(e),i)for(e=0;e<i.length;e++)n=i[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new wm(t)};ki.render=function(e,t,n){if(!bm(t))throw Error(it(200));return Tm(null,e,t,!1,n)};ki.unmountComponentAtNode=function(e){if(!bm(e))throw Error(it(40));return e._reactRootContainer?(_a(function(){Tm(null,null,e,!1,function(){e._reactRootContainer=null,e[xs]=null})}),!0):!1};ki.unstable_batchedUpdates=k_;ki.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!bm(n))throw Error(it(200));if(e==null||e._reactInternals===void 0)throw Error(it(38));return Tm(e,t,n,!1,i)};ki.version="18.3.1-next-f1338f8080-20240426";function nP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nP)}catch(e){console.error(e)}}nP(),nA.exports=ki;var iP=nA.exports;const K5=HI(iP);var rP,zC=iP;rP=zC.createRoot,zC.hydrateRoot;/**
 * react-router v7.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var KC="popstate";function W5(e={}){function t(i,r){let{pathname:s,search:o,hash:a}=i.location;return ax("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:hu(r)}return Y5(t,n,null,e)}function Ie(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function zi(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Q5(){return Math.random().toString(36).substring(2,10)}function WC(e,t){return{usr:e.state,key:e.key,idx:t}}function ax(e,t,n=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?dl(t):t,state:n,key:t&&t.key||i||Q5()}}function hu({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function dl(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function Y5(e,t,n,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a="POP",c=null,h=u();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let _=u(),x=_==null?null:_-h;h=_,c&&c({action:a,location:w.location,delta:x})}function f(_,x){a="PUSH";let C=ax(w.location,_,x);h=u()+1;let k=WC(C,h),P=w.createHref(C);try{o.pushState(k,"",P)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(P)}s&&c&&c({action:a,location:w.location,delta:1})}function v(_,x){a="REPLACE";let C=ax(w.location,_,x);h=u();let k=WC(C,h),P=w.createHref(C);o.replaceState(k,"",P),s&&c&&c({action:a,location:w.location,delta:0})}function y(_){return X5(_)}let w={get action(){return a},get location(){return e(r,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(KC,d),c=_,()=>{r.removeEventListener(KC,d),c=null}},createHref(_){return t(r,_)},createURL:y,encodeLocation(_){let x=y(_);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:v,go(_){return o.go(_)}};return w}function X5(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ie(n,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:hu(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function sP(e,t,n="/"){return J5(e,t,n,!1)}function J5(e,t,n,i){let r=typeof t=="string"?dl(t):t,s=bs(r.pathname||"/",n);if(s==null)return null;let o=oP(e);Z5(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let h=hF(s);a=cF(o[c],h,i)}return a}function oP(e,t=[],n=[],i="",r=!1){let s=(o,a,c=r,h)=>{let u={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(i)&&c)return;Ie(u.relativePath.startsWith(i),`Absolute route path "${u.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(i.length)}let d=us([i,u.relativePath]),f=n.concat(u);o.children&&o.children.length>0&&(Ie(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),oP(o.children,t,f,d,c)),!(o.path==null&&!o.index)&&t.push({path:d,score:oF(d,o.index),routesMeta:f})};return e.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,a);else for(let h of aP(o.path))s(o,a,!0,h)}),t}function aP(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=aP(i.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),r&&a.push(...o),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function Z5(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:aF(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var tF=/^:[\w-]+$/,eF=3,nF=2,iF=1,rF=10,sF=-2,QC=e=>e==="*";function oF(e,t){let n=e.split("/"),i=n.length;return n.some(QC)&&(i+=sF),t&&(i+=nF),n.filter(r=>!QC(r)).reduce((r,s)=>r+(tF.test(s)?eF:s===""?iF:rF),i)}function aF(e,t){return e.length===t.length&&e.slice(0,-1).every((i,r)=>i===t[r])?e[e.length-1]-t[t.length-1]:0}function cF(e,t,n=!1){let{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let c=i[a],h=a===i.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=lf({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},u),f=c.route;if(!d&&h&&n&&!i[i.length-1].route.index&&(d=lf({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:us([s,d.pathname]),pathnameBase:fF(us([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=us([s,d.pathnameBase]))}return o}function lf(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=lF(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((h,{paramName:u,isOptional:d},f)=>{if(u==="*"){let y=a[f]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const v=a[f];return d&&!v?h[u]=void 0:h[u]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:e}}function lF(e,t=!1,n=!0){zi(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(i.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function hF(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return zi(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function bs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}var cP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uF=e=>cP.test(e);function dF(e,t="/"){let{pathname:n,search:i="",hash:r=""}=typeof e=="string"?dl(e):e,s;if(n)if(uF(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),zi(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=YC(n.substring(1),"/"):s=YC(n,t)}else s=t;return{pathname:s,search:mF(i),hash:pF(r)}}function YC(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function gv(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gF(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function lP(e){let t=gF(e);return t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase)}function hP(e,t,n,i=!1){let r;typeof e=="string"?r=dl(e):(r={...e},Ie(!r.pathname||!r.pathname.includes("?"),gv("?","pathname","search",r)),Ie(!r.pathname||!r.pathname.includes("#"),gv("#","pathname","hash",r)),Ie(!r.search||!r.search.includes("#"),gv("#","search","hash",r)));let s=e===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=n;else{let d=t.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;r.pathname=f.join("/")}a=d>=0?t[d]:"/"}let c=dF(r,a),h=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(h||u)&&(c.pathname+="/"),c}var us=e=>e.join("/").replace(/\/\/+/g,"/"),fF=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),mF=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pF=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,vF=class{constructor(e,t,n,i=!1){this.status=e,this.statusText=t||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function yF(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function xF(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var uP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function dP(e,t){let n=e;if(typeof n!="string"||!cP.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,r=!1;if(uP)try{let s=new URL(window.location.href),o=n.startsWith("//")?new URL(s.protocol+n):new URL(n),a=bs(o.pathname,t);o.origin===s.origin&&a!=null?n=a+o.search+o.hash:r=!0}catch{zi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gP=["POST","PUT","PATCH","DELETE"];new Set(gP);var _F=["GET",...gP];new Set(_F);var gl=I.createContext(null);gl.displayName="DataRouter";var Cm=I.createContext(null);Cm.displayName="DataRouterState";var wF=I.createContext(!1),fP=I.createContext({isTransitioning:!1});fP.displayName="ViewTransition";var bF=I.createContext(new Map);bF.displayName="Fetchers";var TF=I.createContext(null);TF.displayName="Await";var Yi=I.createContext(null);Yi.displayName="Navigation";var Vu=I.createContext(null);Vu.displayName="Location";var Jr=I.createContext({outlet:null,matches:[],isDataRoute:!1});Jr.displayName="Route";var M_=I.createContext(null);M_.displayName="RouteError";var mP="REACT_ROUTER_ERROR",CF="REDIRECT",kF="ROUTE_ERROR_RESPONSE";function NF(e){if(e.startsWith(`${mP}:${CF}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function EF(e){if(e.startsWith(`${mP}:${kF}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new vF(t.status,t.statusText,t.data)}catch{}}function SF(e,{relative:t}={}){Ie(qu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=I.useContext(Yi),{hash:r,pathname:s,search:o}=ju(e,{relative:t}),a=s;return n!=="/"&&(a=s==="/"?n:us([n,s])),i.createHref({pathname:a,search:o,hash:r})}function qu(){return I.useContext(Vu)!=null}function Ms(){return Ie(qu(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Vu).location}var pP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vP(e){I.useContext(Yi).static||I.useLayoutEffect(e)}function we(){let{isDataRoute:e}=I.useContext(Jr);return e?OF():IF()}function IF(){Ie(qu(),"useNavigate() may be used only in the context of a <Router> component.");let e=I.useContext(gl),{basename:t,navigator:n}=I.useContext(Yi),{matches:i}=I.useContext(Jr),{pathname:r}=Ms(),s=JSON.stringify(lP(i)),o=I.useRef(!1);return vP(()=>{o.current=!0}),I.useCallback((c,h={})=>{if(zi(o.current,pP),!o.current)return;if(typeof c=="number"){n.go(c);return}let u=hP(c,JSON.parse(s),r,h.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:us([t,u.pathname])),(h.replace?n.replace:n.push)(u,h.state,h)},[t,n,s,r,e])}I.createContext(null);function yP(){let{matches:e}=I.useContext(Jr),t=e[e.length-1];return t?t.params:{}}function ju(e,{relative:t}={}){let{matches:n}=I.useContext(Jr),{pathname:i}=Ms(),r=JSON.stringify(lP(n));return I.useMemo(()=>hP(e,JSON.parse(r),i,t==="path"),[e,r,i,t])}function AF(e,t){return xP(e,t)}function xP(e,t,n,i,r){var C;Ie(qu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=I.useContext(Yi),{matches:o}=I.useContext(Jr),a=o[o.length-1],c=a?a.params:{},h=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let k=d&&d.path||"";wP(h,!d||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let f=Ms(),v;if(t){let k=typeof t=="string"?dl(t):t;Ie(u==="/"||((C=k.pathname)==null?void 0:C.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${k.pathname}" was given in the \`location\` prop.`),v=k}else v=f;let y=v.pathname||"/",w=y;if(u!=="/"){let k=u.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(k.length).join("/")}let _=sP(e,{pathname:w});zi(d||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),zi(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=LF(_&&_.map(k=>Object.assign({},k,{params:Object.assign({},c,k.params),pathname:us([u,s.encodeLocation?s.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?u:us([u,s.encodeLocation?s.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),o,n,i,r);return t&&x?I.createElement(Vu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function RF(){let e=UF(),t=yF(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:s},"ErrorBoundary")," or"," ",I.createElement("code",{style:s},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),n?I.createElement("pre",{style:r},n):null,o)}var PF=I.createElement(RF,null),_P=class extends I.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=EF(e.digest);n&&(e=n)}let t=e!==void 0?I.createElement(Jr.Provider,{value:this.props.routeContext},I.createElement(M_.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?I.createElement(MF,{error:e},t):t}};_P.contextType=wF;var fv=new WeakMap;function MF({children:e,error:t}){let{basename:n}=I.useContext(Yi);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=NF(t.digest);if(i){let r=fv.get(t);if(r)throw r;let s=dP(i.location,n);if(uP&&!fv.get(t))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw fv.set(t,o),o}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function DF({routeContext:e,match:t,children:n}){let i=I.useContext(gl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(Jr.Provider,{value:e},n)}function LF(e,t=[],n=null,i=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let s=e,o=n==null?void 0:n.errors;if(o!=null){let u=s.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Ie(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let a=!1,c=-1;if(n)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:v}=n,y=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!v||v[d.route.id]===void 0);if(d.route.lazy||y){a=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}let h=n&&i?(u,d)=>{var f,v;i(u,{location:n.location,params:((v=(f=n.matches)==null?void 0:f[0])==null?void 0:v.params)??{},unstable_pattern:xF(n.matches),errorInfo:d})}:void 0;return s.reduceRight((u,d,f)=>{let v,y=!1,w=null,_=null;n&&(v=o&&d.route.id?o[d.route.id]:void 0,w=d.route.errorElement||PF,a&&(c<0&&f===0?(wP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):c===f&&(y=!0,_=d.route.hydrateFallbackElement||null)));let x=t.concat(s.slice(0,f+1)),C=()=>{let k;return v?k=w:y?k=_:d.route.Component?k=I.createElement(d.route.Component,null):d.route.element?k=d.route.element:k=u,I.createElement(DF,{match:d,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:k})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?I.createElement(_P,{location:n.location,revalidation:n.revalidation,component:w,error:v,children:C(),routeContext:{outlet:null,matches:x,isDataRoute:!0},onError:h}):C()},null)}function D_(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function VF(e){let t=I.useContext(gl);return Ie(t,D_(e)),t}function qF(e){let t=I.useContext(Cm);return Ie(t,D_(e)),t}function jF(e){let t=I.useContext(Jr);return Ie(t,D_(e)),t}function L_(e){let t=jF(e),n=t.matches[t.matches.length-1];return Ie(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function FF(){return L_("useRouteId")}function UF(){var i;let e=I.useContext(M_),t=qF("useRouteError"),n=L_("useRouteError");return e!==void 0?e:(i=t.errors)==null?void 0:i[n]}function OF(){let{router:e}=VF("useNavigate"),t=L_("useNavigate"),n=I.useRef(!1);return vP(()=>{n.current=!0}),I.useCallback(async(r,s={})=>{zi(n.current,pP),n.current&&(typeof r=="number"?await e.navigate(r):await e.navigate(r,{fromRouteId:t,...s}))},[e,t])}var XC={};function wP(e,t,n){!t&&!XC[e]&&(XC[e]=!0,zi(!1,n))}I.memo(BF);function BF({routes:e,future:t,state:n,onError:i}){return xP(e,void 0,n,i,t)}function Pe(e){Ie(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GF({basename:e="/",children:t=null,location:n,navigationType:i="POP",navigator:r,static:s=!1,unstable_useTransitions:o}){Ie(!qu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),c=I.useMemo(()=>({basename:a,navigator:r,static:s,unstable_useTransitions:o,future:{}}),[a,r,s,o]);typeof n=="string"&&(n=dl(n));let{pathname:h="/",search:u="",hash:d="",state:f=null,key:v="default"}=n,y=I.useMemo(()=>{let w=bs(h,a);return w==null?null:{location:{pathname:w,search:u,hash:d,state:f,key:v},navigationType:i}},[a,h,u,d,f,v,i]);return zi(y!=null,`<Router basename="${a}"> is not able to match the URL "${h}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:I.createElement(Yi.Provider,{value:c},I.createElement(Vu.Provider,{children:t,value:y}))}function HF({children:e,location:t}){return AF(cx(e),t)}function cx(e,t=[]){let n=[];return I.Children.forEach(e,(i,r)=>{if(!I.isValidElement(i))return;let s=[...t,r];if(i.type===I.Fragment){n.push.apply(n,cx(i.props.children,s));return}Ie(i.type===Pe,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ie(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=cx(i.props.children,s)),n.push(o)}),n}var _g="get",wg="application/x-www-form-urlencoded";function km(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function $F(e){return km(e)&&e.tagName.toLowerCase()==="button"}function zF(e){return km(e)&&e.tagName.toLowerCase()==="form"}function KF(e){return km(e)&&e.tagName.toLowerCase()==="input"}function WF(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function QF(e,t){return e.button===0&&(!t||t==="_self")&&!WF(e)}function lx(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function YF(e,t){let n=lx(e);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(s=>{n.append(r,s)})}),n}var jd=null;function XF(){if(jd===null)try{new FormData(document.createElement("form"),0),jd=!1}catch{jd=!0}return jd}var JF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mv(e){return e!=null&&!JF.has(e)?(zi(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wg}"`),null):e}function ZF(e,t){let n,i,r,s,o;if(zF(e)){let a=e.getAttribute("action");i=a?bs(a,t):null,n=e.getAttribute("method")||_g,r=mv(e.getAttribute("enctype"))||wg,s=new FormData(e)}else if($F(e)||KF(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||a.getAttribute("action");if(i=c?bs(c,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||_g,r=mv(e.getAttribute("formenctype"))||mv(a.getAttribute("enctype"))||wg,s=new FormData(a,e),!XF()){let{name:h,type:u,value:d}=e;if(u==="image"){let f=h?`${h}.`:"";s.append(`${f}x`,"0"),s.append(`${f}y`,"0")}else h&&s.append(h,d)}}else{if(km(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=_g,i=null,r=wg,o=e}return s&&r==="text/plain"&&(o=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function V_(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tU(e,t,n,i){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${i}`:r.pathname=`${r.pathname}.${i}`:r.pathname==="/"?r.pathname=`_root.${i}`:t&&bs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${i}`,r}async function eU(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function nU(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function iU(e,t,n){let i=await Promise.all(e.map(async r=>{let s=t.routes[r.route.id];if(s){let o=await eU(s,n);return o.links?o.links():[]}return[]}));return aU(i.flat(1).filter(nU).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function JC(e,t,n,i,r,s){let o=(c,h)=>n[h]?c.route.id!==n[h].route.id:!0,a=(c,h)=>{var u;return n[h].pathname!==c.pathname||((u=n[h].route.path)==null?void 0:u.endsWith("*"))&&n[h].params["*"]!==c.params["*"]};return s==="assets"?t.filter((c,h)=>o(c,h)||a(c,h)):s==="data"?t.filter((c,h)=>{var d;let u=i.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,h)||a(c,h))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function rU(e,t,{includeHydrateFallback:n}={}){return sU(e.map(i=>{let r=t.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function sU(e){return[...new Set(e)]}function oU(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}function aU(e,t){let n=new Set;return new Set(t),e.reduce((i,r)=>{let s=JSON.stringify(oU(r));return n.has(s)||(n.add(s),i.push({key:s,link:r})),i},[])}function bP(){let e=I.useContext(gl);return V_(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function cU(){let e=I.useContext(Cm);return V_(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var q_=I.createContext(void 0);q_.displayName="FrameworkContext";function TP(){let e=I.useContext(q_);return V_(e,"You must render this element inside a <HydratedRouter> element"),e}function lU(e,t){let n=I.useContext(q_),[i,r]=I.useState(!1),[s,o]=I.useState(!1),{onFocus:a,onBlur:c,onMouseEnter:h,onMouseLeave:u,onTouchStart:d}=t,f=I.useRef(null);I.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let w=x=>{x.forEach(C=>{o(C.isIntersecting)})},_=new IntersectionObserver(w,{threshold:.5});return f.current&&_.observe(f.current),()=>{_.disconnect()}}},[e]),I.useEffect(()=>{if(i){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[i]);let v=()=>{r(!0)},y=()=>{r(!1),o(!1)};return n?e!=="intent"?[s,f,{}]:[s,f,{onFocus:th(a,v),onBlur:th(c,y),onMouseEnter:th(h,v),onMouseLeave:th(u,y),onTouchStart:th(d,v)}]:[!1,f,{}]}function th(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function hU({page:e,...t}){let{router:n}=bP(),i=I.useMemo(()=>sP(n.routes,e,n.basename),[n.routes,e,n.basename]);return i?I.createElement(dU,{page:e,matches:i,...t}):null}function uU(e){let{manifest:t,routeModules:n}=TP(),[i,r]=I.useState([]);return I.useEffect(()=>{let s=!1;return iU(e,t,n).then(o=>{s||r(o)}),()=>{s=!0}},[e,t,n]),i}function dU({page:e,matches:t,...n}){let i=Ms(),{future:r,manifest:s,routeModules:o}=TP(),{basename:a}=bP(),{loaderData:c,matches:h}=cU(),u=I.useMemo(()=>JC(e,t,h,s,i,"data"),[e,t,h,s,i]),d=I.useMemo(()=>JC(e,t,h,s,i,"assets"),[e,t,h,s,i]),f=I.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let w=new Set,_=!1;if(t.forEach(C=>{var P;let k=s.routes[C.route.id];!k||!k.hasLoader||(!u.some(A=>A.route.id===C.route.id)&&C.route.id in c&&((P=o[C.route.id])!=null&&P.shouldRevalidate)||k.hasClientLoader?_=!0:w.add(C.route.id))}),w.size===0)return[];let x=tU(e,a,r.unstable_trailingSlashAwareDataRequests,"data");return _&&w.size>0&&x.searchParams.set("_routes",t.filter(C=>w.has(C.route.id)).map(C=>C.route.id).join(",")),[x.pathname+x.search]},[a,r.unstable_trailingSlashAwareDataRequests,c,i,s,u,t,e,o]),v=I.useMemo(()=>rU(d,s),[d,s]),y=uU(d);return I.createElement(I.Fragment,null,f.map(w=>I.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),v.map(w=>I.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),y.map(({key:w,link:_})=>I.createElement("link",{key:w,nonce:n.nonce,..._})))}function gU(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var fU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fU&&(window.__reactRouterVersion="7.12.0")}catch{}function mU({basename:e,children:t,unstable_useTransitions:n,window:i}){let r=I.useRef();r.current==null&&(r.current=W5({window:i,v5Compat:!0}));let s=r.current,[o,a]=I.useState({action:s.action,location:s.location}),c=I.useCallback(h=>{n===!1?a(h):I.startTransition(()=>a(h))},[n]);return I.useLayoutEffect(()=>s.listen(c),[s,c]),I.createElement(GF,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:n})}var CP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kP=I.forwardRef(function({onClick:t,discover:n="render",prefetch:i="none",relative:r,reloadDocument:s,replace:o,state:a,target:c,to:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f,...v},y){let{basename:w,unstable_useTransitions:_}=I.useContext(Yi),x=typeof h=="string"&&CP.test(h),C=dP(h,w);h=C.to;let k=SF(h,{relative:r}),[P,A,M]=lU(i,v),N=xU(h,{replace:o,state:a,target:c,preventScrollReset:u,relative:r,viewTransition:d,unstable_defaultShouldRevalidate:f,unstable_useTransitions:_});function T(R){t&&t(R),R.defaultPrevented||N(R)}let E=I.createElement("a",{...v,...M,href:C.absoluteURL||k,onClick:C.isExternal||s?t:T,ref:gU(y,A),target:c,"data-discover":!x&&n==="render"?"true":void 0});return P&&!x?I.createElement(I.Fragment,null,E,I.createElement(hU,{page:k})):E});kP.displayName="Link";var pU=I.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:i="",end:r=!1,style:s,to:o,viewTransition:a,children:c,...h},u){let d=ju(o,{relative:h.relative}),f=Ms(),v=I.useContext(Cm),{navigator:y,basename:w}=I.useContext(Yi),_=v!=null&&CU(d)&&a===!0,x=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,C=f.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(C=C.toLowerCase(),k=k?k.toLowerCase():null,x=x.toLowerCase()),k&&w&&(k=bs(k,w)||k);const P=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let A=C===x||!r&&C.startsWith(x)&&C.charAt(P)==="/",M=k!=null&&(k===x||!r&&k.startsWith(x)&&k.charAt(x.length)==="/"),N={isActive:A,isPending:M,isTransitioning:_},T=A?t:void 0,E;typeof i=="function"?E=i(N):E=[i,A?"active":null,M?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(N):s;return I.createElement(kP,{...h,"aria-current":T,className:E,ref:u,style:R,to:o,viewTransition:a},typeof c=="function"?c(N):c)});pU.displayName="NavLink";var vU=I.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:i,replace:r,state:s,method:o=_g,action:a,onSubmit:c,relative:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f,...v},y)=>{let{unstable_useTransitions:w}=I.useContext(Yi),_=bU(),x=TU(a,{relative:h}),C=o.toLowerCase()==="get"?"get":"post",k=typeof a=="string"&&CP.test(a),P=A=>{if(c&&c(A),A.defaultPrevented)return;A.preventDefault();let M=A.nativeEvent.submitter,N=(M==null?void 0:M.getAttribute("formmethod"))||o,T=()=>_(M||A.currentTarget,{fetcherKey:t,method:N,navigate:n,replace:r,state:s,relative:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f});w&&n!==!1?I.startTransition(()=>T()):T()};return I.createElement("form",{ref:y,method:C,action:x,onSubmit:i?c:P,...v,"data-discover":!k&&e==="render"?"true":void 0})});vU.displayName="Form";function yU(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function NP(e){let t=I.useContext(gl);return Ie(t,yU(e)),t}function xU(e,{target:t,replace:n,state:i,preventScrollReset:r,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:c}={}){let h=we(),u=Ms(),d=ju(e,{relative:s});return I.useCallback(f=>{if(QF(f,t)){f.preventDefault();let v=n!==void 0?n:hu(u)===hu(d),y=()=>h(e,{replace:v,state:i,preventScrollReset:r,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a});c?I.startTransition(()=>y()):y()}},[u,h,d,n,i,t,e,r,s,o,a,c])}function EP(e){zi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=I.useRef(lx(e)),n=I.useRef(!1),i=Ms(),r=I.useMemo(()=>YF(i.search,n.current?null:t.current),[i.search]),s=we(),o=I.useCallback((a,c)=>{const h=lx(typeof a=="function"?a(new URLSearchParams(r)):a);n.current=!0,s("?"+h,c)},[s,r]);return[r,o]}var _U=0,wU=()=>`__${String(++_U)}__`;function bU(){let{router:e}=NP("useSubmit"),{basename:t}=I.useContext(Yi),n=FF(),i=e.fetch,r=e.navigate;return I.useCallback(async(s,o={})=>{let{action:a,method:c,encType:h,formData:u,body:d}=ZF(s,t);if(o.navigate===!1){let f=o.fetcherKey||wU();await i(f,n,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||c,formEncType:o.encType||h,flushSync:o.flushSync})}else await r(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||c,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,r,t,n])}function TU(e,{relative:t}={}){let{basename:n}=I.useContext(Yi),i=I.useContext(Jr);Ie(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...ju(e||".",{relative:t})},o=Ms();if(e==null){s.search=o.search;let a=new URLSearchParams(s.search),c=a.getAll("index");if(c.some(u=>u==="")){a.delete("index"),c.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:us([n,s.pathname])),hu(s)}function CU(e,{relative:t}={}){let n=I.useContext(fP);Ie(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=NP("useViewTransitionState"),r=ju(e,{relative:t});if(!n.isTransitioning)return!1;let s=bs(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=bs(n.nextLocation.pathname,i)||n.nextLocation.pathname;return lf(r.pathname,o)!=null||lf(r.pathname,s)!=null}function kU(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const NU=e=>{switch(e){case"success":return IU;case"info":return RU;case"warning":return AU;case"error":return PU;default:return null}},EU=Array(12).fill(0),SU=({visible:e,className:t})=>st.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},st.createElement("div",{className:"sonner-spinner"},EU.map((n,i)=>st.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),IU=st.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},st.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),AU=st.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},st.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),RU=st.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},st.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),PU=st.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},st.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),MU=st.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},st.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),st.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),DU=()=>{const[e,t]=st.useState(document.hidden);return st.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let hx=1;class LU{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:i,...r}=t,s=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:hx++,o=this.toasts.find(c=>c.id===s),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),o?this.toasts=this.toasts.map(c=>c.id===s?(this.publish({...c,...t,id:s,title:i}),{...c,...t,id:s,dismissible:a,title:i}):c):this.addToast({title:i,...r,dismissible:a,id:s}),s},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(i=>i({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let i;n.loading!==void 0&&(i=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const r=Promise.resolve(t instanceof Function?t():t);let s=i!==void 0,o;const a=r.then(async h=>{if(o=["resolve",h],st.isValidElement(h))s=!1,this.create({id:i,type:"default",message:h});else if(qU(h)&&!h.ok){s=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${h.status}`):n.error,f=typeof n.description=="function"?await n.description(`HTTP error! status: ${h.status}`):n.description,y=typeof d=="object"&&!st.isValidElement(d)?d:{message:d};this.create({id:i,type:"error",description:f,...y})}else if(h instanceof Error){s=!1;const d=typeof n.error=="function"?await n.error(h):n.error,f=typeof n.description=="function"?await n.description(h):n.description,y=typeof d=="object"&&!st.isValidElement(d)?d:{message:d};this.create({id:i,type:"error",description:f,...y})}else if(n.success!==void 0){s=!1;const d=typeof n.success=="function"?await n.success(h):n.success,f=typeof n.description=="function"?await n.description(h):n.description,y=typeof d=="object"&&!st.isValidElement(d)?d:{message:d};this.create({id:i,type:"success",description:f,...y})}}).catch(async h=>{if(o=["reject",h],n.error!==void 0){s=!1;const u=typeof n.error=="function"?await n.error(h):n.error,d=typeof n.description=="function"?await n.description(h):n.description,v=typeof u=="object"&&!st.isValidElement(u)?u:{message:u};this.create({id:i,type:"error",description:d,...v})}}).finally(()=>{s&&(this.dismiss(i),i=void 0),n.finally==null||n.finally.call(n)}),c=()=>new Promise((h,u)=>a.then(()=>o[0]==="reject"?u(o[1]):h(o[1])).catch(u));return typeof i!="string"&&typeof i!="number"?{unwrap:c}:Object.assign(i,{unwrap:c})},this.custom=(t,n)=>{const i=(n==null?void 0:n.id)||hx++;return this.create({jsx:t(i),id:i,...n}),i},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ri=new LU,VU=(e,t)=>{const n=(t==null?void 0:t.id)||hx++;return ri.addToast({title:e,...t,id:n}),n},qU=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",jU=VU,FU=()=>ri.toasts,UU=()=>ri.getActiveToasts();Object.assign(jU,{success:ri.success,info:ri.info,warning:ri.warning,error:ri.error,custom:ri.custom,message:ri.message,promise:ri.promise,dismiss:ri.dismiss,loading:ri.loading},{getHistory:FU,getToasts:UU});kU("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Fd(e){return e.label!==void 0}const OU=3,BU="24px",GU="16px",ZC=4e3,HU=356,$U=14,zU=45,KU=200;function Rr(...e){return e.filter(Boolean).join(" ")}function WU(e){const[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}const QU=e=>{var t,n,i,r,s,o,a,c,h;const{invert:u,toast:d,unstyled:f,interacting:v,setHeights:y,visibleToasts:w,heights:_,index:x,toasts:C,expanded:k,removeToast:P,defaultRichColors:A,closeButton:M,style:N,cancelButtonStyle:T,actionButtonStyle:E,className:R="",descriptionClassName:D="",duration:F,position:L,gap:lt,expandByDefault:ht,classNames:Y,icons:K,closeButtonAriaLabel:U="Close toast"}=e,[W,j]=st.useState(null),[q,J]=st.useState(null),[G,Q]=st.useState(!1),[Z,O]=st.useState(!1),[B,rt]=st.useState(!1),[z,et]=st.useState(!1),[nt,mt]=st.useState(!1),[Nt,ct]=st.useState(0),[ot,Tt]=st.useState(0),Et=st.useRef(d.duration||F||ZC),Yt=st.useRef(null),St=st.useRef(null),Ut=x===0,pn=x+1<=w,oe=d.type,ft=d.dismissible!==!1,It=d.className||"",ae=d.descriptionClassName||"",vn=st.useMemo(()=>_.findIndex(Rt=>Rt.toastId===d.id)||0,[_,d.id]),Xn=st.useMemo(()=>{var Rt;return(Rt=d.closeButton)!=null?Rt:M},[d.closeButton,M]),Ei=st.useMemo(()=>d.duration||F||ZC,[d.duration,F]),Jn=st.useRef(0),Zn=st.useRef(0),Si=st.useRef(0),ti=st.useRef(null),[Ii,Dl]=L.split("-"),$a=st.useMemo(()=>_.reduce((Rt,be,rn)=>rn>=vn?Rt:Rt+be.height,0),[_,vn]),Er=DU(),hd=d.invert||u,Fs=oe==="loading";Zn.current=st.useMemo(()=>vn*lt+$a,[vn,$a]),st.useEffect(()=>{Et.current=Ei},[Ei]),st.useEffect(()=>{Q(!0)},[]),st.useEffect(()=>{const Rt=St.current;if(Rt){const be=Rt.getBoundingClientRect().height;return Tt(be),y(rn=>[{toastId:d.id,height:be,position:d.position},...rn]),()=>y(rn=>rn.filter(Un=>Un.toastId!==d.id))}},[y,d.id]),st.useLayoutEffect(()=>{if(!G)return;const Rt=St.current,be=Rt.style.height;Rt.style.height="auto";const rn=Rt.getBoundingClientRect().height;Rt.style.height=be,Tt(rn),y(Un=>Un.find(Qe=>Qe.toastId===d.id)?Un.map(Qe=>Qe.toastId===d.id?{...Qe,height:rn}:Qe):[{toastId:d.id,height:rn,position:d.position},...Un])},[G,d.title,d.description,y,d.id,d.jsx,d.action,d.cancel]);const Zi=st.useCallback(()=>{O(!0),ct(Zn.current),y(Rt=>Rt.filter(be=>be.toastId!==d.id)),setTimeout(()=>{P(d)},KU)},[d,P,y,Zn]);st.useEffect(()=>{if(d.promise&&oe==="loading"||d.duration===1/0||d.type==="loading")return;let Rt;return k||v||Er?(()=>{if(Si.current<Jn.current){const Un=new Date().getTime()-Jn.current;Et.current=Et.current-Un}Si.current=new Date().getTime()})():(()=>{Et.current!==1/0&&(Jn.current=new Date().getTime(),Rt=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),Zi()},Et.current))})(),()=>clearTimeout(Rt)},[k,v,d,oe,Er,Zi]),st.useEffect(()=>{d.delete&&(Zi(),d.onDismiss==null||d.onDismiss.call(d,d))},[Zi,d.delete]);function Ho(){var Rt;if(K!=null&&K.loading){var be;return st.createElement("div",{className:Rr(Y==null?void 0:Y.loader,d==null||(be=d.classNames)==null?void 0:be.loader,"sonner-loader"),"data-visible":oe==="loading"},K.loading)}return st.createElement(SU,{className:Rr(Y==null?void 0:Y.loader,d==null||(Rt=d.classNames)==null?void 0:Rt.loader),visible:oe==="loading"})}const ud=d.icon||(K==null?void 0:K[oe])||NU(oe);var nn,Ll;return st.createElement("li",{tabIndex:0,ref:St,className:Rr(R,It,Y==null?void 0:Y.toast,d==null||(t=d.classNames)==null?void 0:t.toast,Y==null?void 0:Y.default,Y==null?void 0:Y[oe],d==null||(n=d.classNames)==null?void 0:n[oe]),"data-sonner-toast":"","data-rich-colors":(nn=d.richColors)!=null?nn:A,"data-styled":!(d.jsx||d.unstyled||f),"data-mounted":G,"data-promise":!!d.promise,"data-swiped":nt,"data-removed":Z,"data-visible":pn,"data-y-position":Ii,"data-x-position":Dl,"data-index":x,"data-front":Ut,"data-swiping":B,"data-dismissible":ft,"data-type":oe,"data-invert":hd,"data-swipe-out":z,"data-swipe-direction":q,"data-expanded":!!(k||ht&&G),"data-testid":d.testId,style:{"--index":x,"--toasts-before":x,"--z-index":C.length-x,"--offset":`${Z?Nt:Zn.current}px`,"--initial-height":ht?"auto":`${ot}px`,...N,...d.style},onDragEnd:()=>{rt(!1),j(null),ti.current=null},onPointerDown:Rt=>{Rt.button!==2&&(Fs||!ft||(Yt.current=new Date,ct(Zn.current),Rt.target.setPointerCapture(Rt.pointerId),Rt.target.tagName!=="BUTTON"&&(rt(!0),ti.current={x:Rt.clientX,y:Rt.clientY})))},onPointerUp:()=>{var Rt,be,rn;if(z||!ft)return;ti.current=null;const Un=Number(((Rt=St.current)==null?void 0:Rt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),tr=Number(((be=St.current)==null?void 0:be.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Qe=new Date().getTime()-((rn=Yt.current)==null?void 0:rn.getTime()),ei=W==="x"?Un:tr,ts=Math.abs(ei)/Qe;if(Math.abs(ei)>=zU||ts>.11){ct(Zn.current),d.onDismiss==null||d.onDismiss.call(d,d),J(W==="x"?Un>0?"right":"left":tr>0?"down":"up"),Zi(),et(!0);return}else{var ni,ii;(ni=St.current)==null||ni.style.setProperty("--swipe-amount-x","0px"),(ii=St.current)==null||ii.style.setProperty("--swipe-amount-y","0px")}mt(!1),rt(!1),j(null)},onPointerMove:Rt=>{var be,rn,Un;if(!ti.current||!ft||((be=window.getSelection())==null?void 0:be.toString().length)>0)return;const Qe=Rt.clientY-ti.current.y,ei=Rt.clientX-ti.current.x;var ts;const ni=(ts=e.swipeDirections)!=null?ts:WU(L);!W&&(Math.abs(ei)>1||Math.abs(Qe)>1)&&j(Math.abs(ei)>Math.abs(Qe)?"x":"y");let ii={x:0,y:0};const za=fi=>1/(1.5+Math.abs(fi)/20);if(W==="y"){if(ni.includes("top")||ni.includes("bottom"))if(ni.includes("top")&&Qe<0||ni.includes("bottom")&&Qe>0)ii.y=Qe;else{const fi=Qe*za(Qe);ii.y=Math.abs(fi)<Math.abs(Qe)?fi:Qe}}else if(W==="x"&&(ni.includes("left")||ni.includes("right")))if(ni.includes("left")&&ei<0||ni.includes("right")&&ei>0)ii.x=ei;else{const fi=ei*za(ei);ii.x=Math.abs(fi)<Math.abs(ei)?fi:ei}(Math.abs(ii.x)>0||Math.abs(ii.y)>0)&&mt(!0),(rn=St.current)==null||rn.style.setProperty("--swipe-amount-x",`${ii.x}px`),(Un=St.current)==null||Un.style.setProperty("--swipe-amount-y",`${ii.y}px`)}},Xn&&!d.jsx&&oe!=="loading"?st.createElement("button",{"aria-label":U,"data-disabled":Fs,"data-close-button":!0,onClick:Fs||!ft?()=>{}:()=>{Zi(),d.onDismiss==null||d.onDismiss.call(d,d)},className:Rr(Y==null?void 0:Y.closeButton,d==null||(i=d.classNames)==null?void 0:i.closeButton)},(Ll=K==null?void 0:K.close)!=null?Ll:MU):null,(oe||d.icon||d.promise)&&d.icon!==null&&((K==null?void 0:K[oe])!==null||d.icon)?st.createElement("div",{"data-icon":"",className:Rr(Y==null?void 0:Y.icon,d==null||(r=d.classNames)==null?void 0:r.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||Ho():null,d.type!=="loading"?ud:null):null,st.createElement("div",{"data-content":"",className:Rr(Y==null?void 0:Y.content,d==null||(s=d.classNames)==null?void 0:s.content)},st.createElement("div",{"data-title":"",className:Rr(Y==null?void 0:Y.title,d==null||(o=d.classNames)==null?void 0:o.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?st.createElement("div",{"data-description":"",className:Rr(D,ae,Y==null?void 0:Y.description,d==null||(a=d.classNames)==null?void 0:a.description)},typeof d.description=="function"?d.description():d.description):null),st.isValidElement(d.cancel)?d.cancel:d.cancel&&Fd(d.cancel)?st.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||T,onClick:Rt=>{Fd(d.cancel)&&ft&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,Rt),Zi())},className:Rr(Y==null?void 0:Y.cancelButton,d==null||(c=d.classNames)==null?void 0:c.cancelButton)},d.cancel.label):null,st.isValidElement(d.action)?d.action:d.action&&Fd(d.action)?st.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||E,onClick:Rt=>{Fd(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,Rt),!Rt.defaultPrevented&&Zi())},className:Rr(Y==null?void 0:Y.actionButton,d==null||(h=d.classNames)==null?void 0:h.actionButton)},d.action.label):null)};function tk(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function YU(e,t){const n={};return[e,t].forEach((i,r)=>{const s=r===1,o=s?"--mobile-offset":"--offset",a=s?GU:BU;function c(h){["top","right","bottom","left"].forEach(u=>{n[`${o}-${u}`]=typeof h=="number"?`${h}px`:h})}typeof i=="number"||typeof i=="string"?c(i):typeof i=="object"?["top","right","bottom","left"].forEach(h=>{i[h]===void 0?n[`${o}-${h}`]=a:n[`${o}-${h}`]=typeof i[h]=="number"?`${i[h]}px`:i[h]}):c(a)}),n}const XU=st.forwardRef(function(t,n){const{id:i,invert:r,position:s="bottom-right",hotkey:o=["altKey","KeyT"],expand:a,closeButton:c,className:h,offset:u,mobileOffset:d,theme:f="light",richColors:v,duration:y,style:w,visibleToasts:_=OU,toastOptions:x,dir:C=tk(),gap:k=$U,icons:P,containerAriaLabel:A="Notifications"}=t,[M,N]=st.useState([]),T=st.useMemo(()=>i?M.filter(G=>G.toasterId===i):M.filter(G=>!G.toasterId),[M,i]),E=st.useMemo(()=>Array.from(new Set([s].concat(T.filter(G=>G.position).map(G=>G.position)))),[T,s]),[R,D]=st.useState([]),[F,L]=st.useState(!1),[lt,ht]=st.useState(!1),[Y,K]=st.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=st.useRef(null),W=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=st.useRef(null),q=st.useRef(!1),J=st.useCallback(G=>{N(Q=>{var Z;return(Z=Q.find(O=>O.id===G.id))!=null&&Z.delete||ri.dismiss(G.id),Q.filter(({id:O})=>O!==G.id)})},[]);return st.useEffect(()=>ri.subscribe(G=>{if(G.dismiss){requestAnimationFrame(()=>{N(Q=>Q.map(Z=>Z.id===G.id?{...Z,delete:!0}:Z))});return}setTimeout(()=>{K5.flushSync(()=>{N(Q=>{const Z=Q.findIndex(O=>O.id===G.id);return Z!==-1?[...Q.slice(0,Z),{...Q[Z],...G},...Q.slice(Z+1)]:[G,...Q]})})})}),[M]),st.useEffect(()=>{if(f!=="system"){K(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;const G=window.matchMedia("(prefers-color-scheme: dark)");try{G.addEventListener("change",({matches:Q})=>{K(Q?"dark":"light")})}catch{G.addListener(({matches:Z})=>{try{K(Z?"dark":"light")}catch(O){console.error(O)}})}},[f]),st.useEffect(()=>{M.length<=1&&L(!1)},[M]),st.useEffect(()=>{const G=Q=>{var Z;if(o.every(rt=>Q[rt]||Q.code===rt)){var B;L(!0),(B=U.current)==null||B.focus()}Q.code==="Escape"&&(document.activeElement===U.current||(Z=U.current)!=null&&Z.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[o]),st.useEffect(()=>{if(U.current)return()=>{j.current&&(j.current.focus({preventScroll:!0}),j.current=null,q.current=!1)}},[U.current]),st.createElement("section",{ref:n,"aria-label":`${A} ${W}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},E.map((G,Q)=>{var Z;const[O,B]=G.split("-");return T.length?st.createElement("ol",{key:G,dir:C==="auto"?tk():C,tabIndex:-1,ref:U,className:h,"data-sonner-toaster":!0,"data-sonner-theme":Y,"data-y-position":O,"data-x-position":B,style:{"--front-toast-height":`${((Z=R[0])==null?void 0:Z.height)||0}px`,"--width":`${HU}px`,"--gap":`${k}px`,...w,...YU(u,d)},onBlur:rt=>{q.current&&!rt.currentTarget.contains(rt.relatedTarget)&&(q.current=!1,j.current&&(j.current.focus({preventScroll:!0}),j.current=null))},onFocus:rt=>{rt.target instanceof HTMLElement&&rt.target.dataset.dismissible==="false"||q.current||(q.current=!0,j.current=rt.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{lt||L(!1)},onDragEnd:()=>L(!1),onPointerDown:rt=>{rt.target instanceof HTMLElement&&rt.target.dataset.dismissible==="false"||ht(!0)},onPointerUp:()=>ht(!1)},T.filter(rt=>!rt.position&&Q===0||rt.position===G).map((rt,z)=>{var et,nt;return st.createElement(QU,{key:rt.id,icons:P,index:z,toast:rt,defaultRichColors:v,duration:(et=x==null?void 0:x.duration)!=null?et:y,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:r,visibleToasts:_,closeButton:(nt=x==null?void 0:x.closeButton)!=null?nt:c,interacting:lt,position:G,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:J,toasts:T.filter(mt=>mt.position==rt.position),heights:R.filter(mt=>mt.position==rt.position),setHeights:D,expandByDefault:a,gap:k,expanded:F,swipeDirections:t.swipeDirections})})):null}))});/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ZU=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),ek=e=>{const t=ZU(e);return t.charAt(0).toUpperCase()+t.slice(1)},SP=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),tO=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=I.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>I.createElement("svg",{ref:c,...eO,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:SP("lucide",r),...!s&&!tO(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,u])=>I.createElement(h,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=(e,t)=>{const n=I.forwardRef(({className:i,...r},s)=>I.createElement(nO,{ref:s,iconNode:t,className:SP(`lucide-${JU(ek(e))}`,`lucide-${e}`,i),...r}));return n.displayName=ek(e),n};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],rO=_t("arrow-down",iO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Xi=_t("arrow-left",sO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],aO=_t("arrow-up",oO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],pr=_t("award",cO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Yc=_t("book-open",lO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]],uO=_t("bookmark-check",hO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],pv=_t("bookmark",dO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],IP=_t("brain",gO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Fu=_t("building",fO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],AP=_t("calendar-check",mO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],vO=_t("calendar-days",pO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],uu=_t("calendar",yO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xO=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],RP=_t("chart-column",xO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],In=_t("check",_O);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],j_=_t("chevron-left",wO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],sr=_t("chevron-right",bO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],CO=_t("chevrons-left",TO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],NO=_t("chevrons-right",kO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ai=_t("circle-check-big",EO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Tr=_t("circle-check",SO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$r=_t("circle-x",IO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Uu=_t("clock",AO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],PP=_t("coins",RO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],hf=_t("crown",PO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]],DO=_t("dumbbell",MO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],VO=_t("file-text",LO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],zr=_t("flame",qO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["line",{x1:"22",x2:"2",y1:"6",y2:"6",key:"15w7dq"}],["line",{x1:"22",x2:"2",y1:"18",y2:"18",key:"1ip48p"}],["line",{x1:"6",x2:"6",y1:"2",y2:"22",key:"a2lnyx"}],["line",{x1:"18",x2:"18",y1:"2",y2:"22",key:"8vb6jd"}]],uf=_t("frame",jO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],MP=_t("gem",FO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],Ue=_t("gift",UO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],DP=_t("graduation-cap",OO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],GO=_t("grip-vertical",BO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],F_=_t("house",HO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Nm=_t("image",$O);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],KO=_t("inbox",zO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ux=_t("info",WO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],nk=_t("list",QO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Li=_t("loader-circle",YO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ou=_t("lock",XO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],LP=_t("mail",JO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Rc=_t("medal",ZO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],eB=_t("moon",tB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ts=_t("package",nB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],dx=_t("pencil",iB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],sB=_t("play",rB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],du=_t("rotate-ccw",oB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],ik=_t("rotate-cw",aB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],VP=_t("shield",cB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],hB=_t("shuffle",lB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],U_=_t("skull",uB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],vv=_t("snowflake",dB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Xt=_t("sparkles",gB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],rk=_t("square-check-big",fB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],pB=_t("square",mB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ge=_t("star",vB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],xB=_t("sun",yB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],wi=_t("swords",_B);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Vi=_t("target",wB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],qP=_t("trash-2",bB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],CB=_t("trending-down",TB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],jP=_t("trending-up",kB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],EB=_t("triangle-alert",NB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Le=_t("trophy",SB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fl=_t("user",IB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fr=_t("x",AB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Lr=_t("zap",RB),PB="modulepreload",MB=function(e){return"/"+e},sk={},df=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=MB(c),c in sk)return;sk[c]=!0;const h=c.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":PB,h||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),h)return new Promise((f,v)=>{d.addEventListener("load",f),d.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function FP(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=FP(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function UP(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=FP(e))&&(i&&(i+=" "),i+=t);return i}const DB=(e,t)=>{const n=new Array(e.length+t.length);for(let i=0;i<e.length;i++)n[i]=e[i];for(let i=0;i<t.length;i++)n[e.length+i]=t[i];return n},LB=(e,t)=>({classGroupId:e,validator:t}),OP=(e=new Map,t=null,n)=>({nextPart:e,validators:t,classGroupId:n}),gf="-",ok=[],VB="arbitrary..",qB=e=>{const t=FB(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return jB(o);const a=o.split(gf),c=a[0]===""&&a.length>1?1:0;return BP(a,c,t)},getConflictingClassGroupIds:(o,a)=>{if(a){const c=i[o],h=n[o];return c?h?DB(h,c):c:h||ok}return n[o]||ok}}},BP=(e,t,n)=>{if(e.length-t===0)return n.classGroupId;const r=e[t],s=n.nextPart.get(r);if(s){const h=BP(e,t+1,s);if(h)return h}const o=n.validators;if(o===null)return;const a=t===0?e.join(gf):e.slice(t).join(gf),c=o.length;for(let h=0;h<c;h++){const u=o[h];if(u.validator(a))return u.classGroupId}},jB=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),n=t.indexOf(":"),i=t.slice(0,n);return i?VB+i:void 0})(),FB=e=>{const{theme:t,classGroups:n}=e;return UB(n,t)},UB=(e,t)=>{const n=OP();for(const i in e){const r=e[i];O_(r,n,i,t)}return n},O_=(e,t,n,i)=>{const r=e.length;for(let s=0;s<r;s++){const o=e[s];OB(o,t,n,i)}},OB=(e,t,n,i)=>{if(typeof e=="string"){BB(e,t,n);return}if(typeof e=="function"){GB(e,t,n,i);return}HB(e,t,n,i)},BB=(e,t,n)=>{const i=e===""?t:GP(t,e);i.classGroupId=n},GB=(e,t,n,i)=>{if($B(e)){O_(e(i),t,n,i);return}t.validators===null&&(t.validators=[]),t.validators.push(LB(n,e))},HB=(e,t,n,i)=>{const r=Object.entries(e),s=r.length;for(let o=0;o<s;o++){const[a,c]=r[o];O_(c,GP(t,a),n,i)}},GP=(e,t)=>{let n=e;const i=t.split(gf),r=i.length;for(let s=0;s<r;s++){const o=i[s];let a=n.nextPart.get(o);a||(a=OP(),n.nextPart.set(o,a)),n=a}return n},$B=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,zB=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=Object.create(null),i=Object.create(null);const r=(s,o)=>{n[s]=o,t++,t>e&&(t=0,i=n,n=Object.create(null))};return{get(s){let o=n[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return r(s,o),o},set(s,o){s in n?n[s]=o:r(s,o)}}},gx="!",ak=":",KB=[],ck=(e,t,n,i,r)=>({modifiers:e,hasImportantModifier:t,baseClassName:n,maybePostfixModifierPosition:i,isExternal:r}),WB=e=>{const{prefix:t,experimentalParseClassName:n}=e;let i=r=>{const s=[];let o=0,a=0,c=0,h;const u=r.length;for(let w=0;w<u;w++){const _=r[w];if(o===0&&a===0){if(_===ak){s.push(r.slice(c,w)),c=w+1;continue}if(_==="/"){h=w;continue}}_==="["?o++:_==="]"?o--:_==="("?a++:_===")"&&a--}const d=s.length===0?r:r.slice(c);let f=d,v=!1;d.endsWith(gx)?(f=d.slice(0,-1),v=!0):d.startsWith(gx)&&(f=d.slice(1),v=!0);const y=h&&h>c?h-c:void 0;return ck(s,v,f,y)};if(t){const r=t+ak,s=i;i=o=>o.startsWith(r)?s(o.slice(r.length)):ck(KB,!1,o,void 0,!0)}if(n){const r=i;i=s=>n({className:s,parseClassName:r})}return i},QB=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((n,i)=>{t.set(n,1e6+i)}),n=>{const i=[];let r=[];for(let s=0;s<n.length;s++){const o=n[s],a=o[0]==="[",c=t.has(o);a||c?(r.length>0&&(r.sort(),i.push(...r),r=[]),i.push(o)):r.push(o)}return r.length>0&&(r.sort(),i.push(...r)),i}},YB=e=>({cache:zB(e.cacheSize),parseClassName:WB(e),sortModifiers:QB(e),...qB(e)}),XB=/\s+/,JB=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:r,sortModifiers:s}=t,o=[],a=e.trim().split(XB);let c="";for(let h=a.length-1;h>=0;h-=1){const u=a[h],{isExternal:d,modifiers:f,hasImportantModifier:v,baseClassName:y,maybePostfixModifierPosition:w}=n(u);if(d){c=u+(c.length>0?" "+c:c);continue}let _=!!w,x=i(_?y.substring(0,w):y);if(!x){if(!_){c=u+(c.length>0?" "+c:c);continue}if(x=i(y),!x){c=u+(c.length>0?" "+c:c);continue}_=!1}const C=f.length===0?"":f.length===1?f[0]:s(f).join(":"),k=v?C+gx:C,P=k+x;if(o.indexOf(P)>-1)continue;o.push(P);const A=r(x,_);for(let M=0;M<A.length;++M){const N=A[M];o.push(k+N)}c=u+(c.length>0?" "+c:c)}return c},ZB=(...e)=>{let t=0,n,i,r="";for(;t<e.length;)(n=e[t++])&&(i=HP(n))&&(r&&(r+=" "),r+=i);return r},HP=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=HP(e[i]))&&(n&&(n+=" "),n+=t);return n},tG=(e,...t)=>{let n,i,r,s;const o=c=>{const h=t.reduce((u,d)=>d(u),e());return n=YB(h),i=n.cache.get,r=n.cache.set,s=a,a(c)},a=c=>{const h=i(c);if(h)return h;const u=JB(c,n);return r(c,u),u};return s=o,(...c)=>s(ZB(...c))},eG=[],Xe=e=>{const t=n=>n[e]||eG;return t.isThemeGetter=!0,t},$P=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,zP=/^\((?:(\w[\w-]*):)?(.+)\)$/i,nG=/^\d+\/\d+$/,iG=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rG=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,sG=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,oG=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,aG=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ya=e=>nG.test(e),Ft=e=>!!e&&!Number.isNaN(Number(e)),Ks=e=>!!e&&Number.isInteger(Number(e)),yv=e=>e.endsWith("%")&&Ft(e.slice(0,-1)),es=e=>iG.test(e),cG=()=>!0,lG=e=>rG.test(e)&&!sG.test(e),KP=()=>!1,hG=e=>oG.test(e),uG=e=>aG.test(e),dG=e=>!wt(e)&&!bt(e),gG=e=>ml(e,YP,KP),wt=e=>$P.test(e),Qo=e=>ml(e,XP,lG),xv=e=>ml(e,yG,Ft),lk=e=>ml(e,WP,KP),fG=e=>ml(e,QP,uG),Ud=e=>ml(e,JP,hG),bt=e=>zP.test(e),eh=e=>pl(e,XP),mG=e=>pl(e,xG),hk=e=>pl(e,WP),pG=e=>pl(e,YP),vG=e=>pl(e,QP),Od=e=>pl(e,JP,!0),ml=(e,t,n)=>{const i=$P.exec(e);return i?i[1]?t(i[1]):n(i[2]):!1},pl=(e,t,n=!1)=>{const i=zP.exec(e);return i?i[1]?t(i[1]):n:!1},WP=e=>e==="position"||e==="percentage",QP=e=>e==="image"||e==="url",YP=e=>e==="length"||e==="size"||e==="bg-size",XP=e=>e==="length",yG=e=>e==="number",xG=e=>e==="family-name",JP=e=>e==="shadow",_G=()=>{const e=Xe("color"),t=Xe("font"),n=Xe("text"),i=Xe("font-weight"),r=Xe("tracking"),s=Xe("leading"),o=Xe("breakpoint"),a=Xe("container"),c=Xe("spacing"),h=Xe("radius"),u=Xe("shadow"),d=Xe("inset-shadow"),f=Xe("text-shadow"),v=Xe("drop-shadow"),y=Xe("blur"),w=Xe("perspective"),_=Xe("aspect"),x=Xe("ease"),C=Xe("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[...P(),bt,wt],M=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],T=()=>[bt,wt,c],E=()=>[Ya,"full","auto",...T()],R=()=>[Ks,"none","subgrid",bt,wt],D=()=>["auto",{span:["full",Ks,bt,wt]},Ks,bt,wt],F=()=>[Ks,"auto",bt,wt],L=()=>["auto","min","max","fr",bt,wt],lt=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ht=()=>["start","end","center","stretch","center-safe","end-safe"],Y=()=>["auto",...T()],K=()=>[Ya,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...T()],U=()=>[e,bt,wt],W=()=>[...P(),hk,lk,{position:[bt,wt]}],j=()=>["no-repeat",{repeat:["","x","y","space","round"]}],q=()=>["auto","cover","contain",pG,gG,{size:[bt,wt]}],J=()=>[yv,eh,Qo],G=()=>["","none","full",h,bt,wt],Q=()=>["",Ft,eh,Qo],Z=()=>["solid","dashed","dotted","double"],O=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>[Ft,yv,hk,lk],rt=()=>["","none",y,bt,wt],z=()=>["none",Ft,bt,wt],et=()=>["none",Ft,bt,wt],nt=()=>[Ft,bt,wt],mt=()=>[Ya,"full",...T()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[es],breakpoint:[es],color:[cG],container:[es],"drop-shadow":[es],ease:["in","out","in-out"],font:[dG],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[es],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[es],shadow:[es],spacing:["px",Ft],text:[es],"text-shadow":[es],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ya,wt,bt,_]}],container:["container"],columns:[{columns:[Ft,wt,bt,a]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:E()}],"inset-x":[{"inset-x":E()}],"inset-y":[{"inset-y":E()}],start:[{start:E()}],end:[{end:E()}],top:[{top:E()}],right:[{right:E()}],bottom:[{bottom:E()}],left:[{left:E()}],visibility:["visible","invisible","collapse"],z:[{z:[Ks,"auto",bt,wt]}],basis:[{basis:[Ya,"full","auto",a,...T()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ft,Ya,"auto","initial","none",wt]}],grow:[{grow:["",Ft,bt,wt]}],shrink:[{shrink:["",Ft,bt,wt]}],order:[{order:[Ks,"first","last","none",bt,wt]}],"grid-cols":[{"grid-cols":R()}],"col-start-end":[{col:D()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":R()}],"row-start-end":[{row:D()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:T()}],"gap-x":[{"gap-x":T()}],"gap-y":[{"gap-y":T()}],"justify-content":[{justify:[...lt(),"normal"]}],"justify-items":[{"justify-items":[...ht(),"normal"]}],"justify-self":[{"justify-self":["auto",...ht()]}],"align-content":[{content:["normal",...lt()]}],"align-items":[{items:[...ht(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ht(),{baseline:["","last"]}]}],"place-content":[{"place-content":lt()}],"place-items":[{"place-items":[...ht(),"baseline"]}],"place-self":[{"place-self":["auto",...ht()]}],p:[{p:T()}],px:[{px:T()}],py:[{py:T()}],ps:[{ps:T()}],pe:[{pe:T()}],pt:[{pt:T()}],pr:[{pr:T()}],pb:[{pb:T()}],pl:[{pl:T()}],m:[{m:Y()}],mx:[{mx:Y()}],my:[{my:Y()}],ms:[{ms:Y()}],me:[{me:Y()}],mt:[{mt:Y()}],mr:[{mr:Y()}],mb:[{mb:Y()}],ml:[{ml:Y()}],"space-x":[{"space-x":T()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":T()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[a,"screen",...K()]}],"min-w":[{"min-w":[a,"screen","none",...K()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",n,eh,Qo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,bt,xv]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",yv,wt]}],"font-family":[{font:[mG,wt,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,bt,wt]}],"line-clamp":[{"line-clamp":[Ft,"none",bt,xv]}],leading:[{leading:[s,...T()]}],"list-image":[{"list-image":["none",bt,wt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",bt,wt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ft,"from-font","auto",bt,Qo]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Ft,"auto",bt,wt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",bt,wt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",bt,wt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:W()}],"bg-repeat":[{bg:j()}],"bg-size":[{bg:q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ks,bt,wt],radial:["",bt,wt],conic:[Ks,bt,wt]},vG,fG]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:J()}],"gradient-via-pos":[{via:J()}],"gradient-to-pos":[{to:J()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:G()}],"rounded-s":[{"rounded-s":G()}],"rounded-e":[{"rounded-e":G()}],"rounded-t":[{"rounded-t":G()}],"rounded-r":[{"rounded-r":G()}],"rounded-b":[{"rounded-b":G()}],"rounded-l":[{"rounded-l":G()}],"rounded-ss":[{"rounded-ss":G()}],"rounded-se":[{"rounded-se":G()}],"rounded-ee":[{"rounded-ee":G()}],"rounded-es":[{"rounded-es":G()}],"rounded-tl":[{"rounded-tl":G()}],"rounded-tr":[{"rounded-tr":G()}],"rounded-br":[{"rounded-br":G()}],"rounded-bl":[{"rounded-bl":G()}],"border-w":[{border:Q()}],"border-w-x":[{"border-x":Q()}],"border-w-y":[{"border-y":Q()}],"border-w-s":[{"border-s":Q()}],"border-w-e":[{"border-e":Q()}],"border-w-t":[{"border-t":Q()}],"border-w-r":[{"border-r":Q()}],"border-w-b":[{"border-b":Q()}],"border-w-l":[{"border-l":Q()}],"divide-x":[{"divide-x":Q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Z(),"hidden","none"]}],"divide-style":[{divide:[...Z(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...Z(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ft,bt,wt]}],"outline-w":[{outline:["",Ft,eh,Qo]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",u,Od,Ud]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",d,Od,Ud]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Ft,Qo]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":Q()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",f,Od,Ud]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Ft,bt,wt]}],"mix-blend":[{"mix-blend":[...O(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":O()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ft]}],"mask-image-linear-from-pos":[{"mask-linear-from":B()}],"mask-image-linear-to-pos":[{"mask-linear-to":B()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":B()}],"mask-image-t-to-pos":[{"mask-t-to":B()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":B()}],"mask-image-r-to-pos":[{"mask-r-to":B()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":B()}],"mask-image-b-to-pos":[{"mask-b-to":B()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":B()}],"mask-image-l-to-pos":[{"mask-l-to":B()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":B()}],"mask-image-x-to-pos":[{"mask-x-to":B()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":B()}],"mask-image-y-to-pos":[{"mask-y-to":B()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[bt,wt]}],"mask-image-radial-from-pos":[{"mask-radial-from":B()}],"mask-image-radial-to-pos":[{"mask-radial-to":B()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Ft]}],"mask-image-conic-from-pos":[{"mask-conic-from":B()}],"mask-image-conic-to-pos":[{"mask-conic-to":B()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:W()}],"mask-repeat":[{mask:j()}],"mask-size":[{mask:q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",bt,wt]}],filter:[{filter:["","none",bt,wt]}],blur:[{blur:rt()}],brightness:[{brightness:[Ft,bt,wt]}],contrast:[{contrast:[Ft,bt,wt]}],"drop-shadow":[{"drop-shadow":["","none",v,Od,Ud]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Ft,bt,wt]}],"hue-rotate":[{"hue-rotate":[Ft,bt,wt]}],invert:[{invert:["",Ft,bt,wt]}],saturate:[{saturate:[Ft,bt,wt]}],sepia:[{sepia:["",Ft,bt,wt]}],"backdrop-filter":[{"backdrop-filter":["","none",bt,wt]}],"backdrop-blur":[{"backdrop-blur":rt()}],"backdrop-brightness":[{"backdrop-brightness":[Ft,bt,wt]}],"backdrop-contrast":[{"backdrop-contrast":[Ft,bt,wt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ft,bt,wt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ft,bt,wt]}],"backdrop-invert":[{"backdrop-invert":["",Ft,bt,wt]}],"backdrop-opacity":[{"backdrop-opacity":[Ft,bt,wt]}],"backdrop-saturate":[{"backdrop-saturate":[Ft,bt,wt]}],"backdrop-sepia":[{"backdrop-sepia":["",Ft,bt,wt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":T()}],"border-spacing-x":[{"border-spacing-x":T()}],"border-spacing-y":[{"border-spacing-y":T()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",bt,wt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ft,"initial",bt,wt]}],ease:[{ease:["linear","initial",x,bt,wt]}],delay:[{delay:[Ft,bt,wt]}],animate:[{animate:["none",C,bt,wt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,bt,wt]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:z()}],"rotate-x":[{"rotate-x":z()}],"rotate-y":[{"rotate-y":z()}],"rotate-z":[{"rotate-z":z()}],scale:[{scale:et()}],"scale-x":[{"scale-x":et()}],"scale-y":[{"scale-y":et()}],"scale-z":[{"scale-z":et()}],"scale-3d":["scale-3d"],skew:[{skew:nt()}],"skew-x":[{"skew-x":nt()}],"skew-y":[{"skew-y":nt()}],transform:[{transform:[bt,wt,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:mt()}],"translate-x":[{"translate-x":mt()}],"translate-y":[{"translate-y":mt()}],"translate-z":[{"translate-z":mt()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",bt,wt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",bt,wt]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Ft,eh,Qo,xv]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},wG=tG(_G);function Vt(...e){return wG(UP(e))}function ff(e,t=0){var u,d;if(!e)return{quizScore:0,conquestScore:0,gachaScore:0,towerScore:0,achievementScore:0,totalScore:0};const n=(e.totalCorrect??0)*10+(e.perfectLessons??0)*50,i=e.conquestStats,r=((i==null?void 0:i.rankPoints)??0)+((i==null?void 0:i.totalConquests)??0)*5+((i==null?void 0:i.bestWinStreak)??0)*20,s=(u=e.gachaInventory)==null?void 0:u.gachaStats,o=((s==null?void 0:s.totalURCards)??0)*100+((s==null?void 0:s.totalSRCards)??0)*50+((s==null?void 0:s.totalRCards)??0)*20+((s==null?void 0:s.totalNCards)??0)*5+((s==null?void 0:s.completedCollections)??0)*200,a=t*10,c=(((d=e.achievements)==null?void 0:d.length)??0)*25,h=n+r+o+a+c;return{quizScore:n,conquestScore:r,gachaScore:o,towerScore:a,achievementScore:c,totalScore:h}}function Mn(e,t=1){if(e<1e3)return e.toString();if(e<1e6){const i=e/1e3;return i%1===0?`${i}K`:`${i.toFixed(t)}K`}if(e<1e9){const i=e/1e6;return i%1===0?`${i}M`:`${i.toFixed(t)}M`}const n=e/1e9;return n%1===0?`${n}B`:`${n.toFixed(t)}B`}function re({children:e,className:t}){return l.jsx("div",{className:Vt("min-h-screen",t),children:e})}const uk=e=>{let t;const n=new Set,i=(h,u)=>{const d=typeof h=="function"?h(t):h;if(!Object.is(d,t)){const f=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(v=>v(t,f))}},r=()=>t,a={setState:i,getState:r,getInitialState:()=>c,subscribe:h=>(n.add(h),()=>n.delete(h))},c=t=e(i,r,a);return a},bG=e=>e?uk(e):uk,TG=e=>e;function CG(e,t=TG){const n=st.useSyncExternalStore(e.subscribe,st.useCallback(()=>t(e.getState()),[e,t]),st.useCallback(()=>t(e.getInitialState()),[e,t]));return st.useDebugValue(n),n}const dk=e=>{const t=bG(e),n=i=>CG(t,i);return Object.assign(n,t),n},Bu=e=>e?dk(e):dk,kG=[{id:1,name:"TNG QUAN D N",totalQuestions:16,icon:"ClipboardList"},{id:2,name:"GIAO TIP V TRUYN THNG",totalQuestions:20,icon:"MessageCircle"},{id:3,name:"C LNG D N",totalQuestions:17,icon:"BarChart3"},{id:4,name:"LP LCH D N",totalQuestions:16,icon:"Calendar"},{id:5,name:"KIM SOT V GIM ST",totalQuestions:8,icon:"Search"},{id:6,name:"QUN L PHM VI",totalQuestions:8,icon:"Target"},{id:7,name:"QUN L THI GIAN",totalQuestions:8,icon:"Clock"},{id:8,name:"QUN L CHI PH",totalQuestions:9,icon:"DollarSign"},{id:9,name:"QUN L CHT LNG",totalQuestions:7,icon:"CheckCircle"},{id:10,name:"QUN L NHN LC",totalQuestions:8,icon:"Users"},{id:11,name:"TRUYN THNG V GIAO TIP",totalQuestions:9,icon:"Megaphone"},{id:12,name:"QUN L RI RO",totalQuestions:8,icon:"AlertTriangle"},{id:13,name:"QUN L TCH HP",totalQuestions:9,icon:"Link"},{id:100,name:"EX 1 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0},{id:101,name:"EX 2 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0},{id:102,name:"EX 3 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0},{id:103,name:"EX 4 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0},{id:104,name:"EX 5 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0},{id:105,name:"EX 6 -  LUYN TP",totalQuestions:10,icon:"Star",isEx:!0}],NG=[{id:1,question:"D n l g?",options:[{id:"A",text:"L hot ng nghin cu mang tnh l thuyt."},{id:"B",text:"L cng vic lp li nhiu ln theo chu k nht nh."},{id:"C",text:"L hot ng c phng php, s dng ngun lc  to sn phm mi."},{id:"D",text:"L k hoch sn xut c p dng lu di."}],correctAnswer:"C",chapter:1,chapterName:"TNG QUAN D N"},{id:2,question:"Mc tiu ca d n l g?",options:[{id:"A",text:"Gii quyt vn  thc t v p ng nhu cu ngi dng."},{id:"B",text:"a ra m hnh khoa hc v phng php nghin cu."},{id:"C",text:"Xy dng chin lc ti chnh cho t chc."},{id:"D",text:"Pht trin h thng phn mm phc v nghin cu."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:3,question:"Qun l d n CNTT l g?",options:[{id:"A",text:"L vic t chc cc hot ng nhm t c mc tiu trong gii hn v thi gian, kinh ph v cht lng."},{id:"B",text:"L cng vic lp trnh v pht trin phn mm cho doanh nghip."},{id:"C",text:"L hot ng nghin cu cng ngh thng tin ng dng."},{id:"D",text:"L k hoch kim th v vn hnh phn mm."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:4,question:"Mt d n CNTT c nh gi l thnh cng khi:",options:[{id:"A",text:"Hon thnh ng thi gian v p ng yu cu ngi dng."},{id:"B",text:"c u t ngun vn ln v c nhiu nhn lc tham gia."},{id:"C",text:"C sn phm ng dng cng ngh mi."},{id:"D",text:"S dng phn mm qun l hin i."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:5,question:"Trong giai on khi to d n, ngi qun l cn thc hin vic no sau y?",options:[{id:"A",text:"nh gi hiu qu sau khi bn giao sn phm."},{id:"B",text:"Xc nh yu cu, mc u tin v phn cng trch nhim."},{id:"C",text:"Thc hin kim th v vit ti liu hng dn."},{id:"D",text:"Xy dng bo co ti chnh cui k."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:6,question:"Giai on lp k hoch d n c nhim v:",options:[{id:"A",text:"Hon thin sn phm v bn giao cho khch hng."},{id:"B",text:"Lp k hoch chi tit, xc nh phm vi v iu chnh mc tiu."},{id:"C",text:"Thc hin gim st tin  d n."},{id:"D",text:"nh gi ri ro v  xut kt thc d n."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:7,question:"Theo quy trnh qun l d n phn mm, giai on kt thc nhm:",options:[{id:"A",text:"Thc hin kim th h thng v vn hnh th."},{id:"B",text:"Chnh thc ng d n v hon tt cc hot ng cn li."},{id:"C",text:"Trin khai nng cp v bo tr phn mm."},{id:"D",text:"Lp k hoch cho d n tip theo."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:8,question:"Mt d n CNTT tht bi ch yu v:",options:[{id:"A",text:"Thiu k hoch chi tit v khng hiu r yu cu ngi dng."},{id:"B",text:"S dng cng ngh li thi hoc qu hin i."},{id:"C",text:"Thiu ngun vn t c quan nh nc."},{id:"D",text:"Thay i nhn s trong qu trnh bo tr."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:9,question:"Theo phn loi d n, d n ln thng c c im:",options:[{id:"A",text:"Ngun kinh ph t, nhn lc gn nh, thi gian ngn."},{id:"B",text:"Nhiu bn tham gia, phm vi rng v chi ph ln."},{id:"C",text:"Ch thc hin trong phm vi ni b."},{id:"D",text:"Khng cn c c cu t chc ring bit."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:10,question:"Cc nhim v trong hot ng qun l d n bao gm:",options:[{id:"A",text:"Qun l thi gian, kinh ph, nhn lc v kt qu chuyn giao."},{id:"B",text:"Qun l cng ngh, truyn thng, d liu v bo mt."},{id:"C",text:"Qun l ti chnh, k ton, nhn s v hnh chnh."},{id:"D",text:"Qun l phn cng, phn mm, mng v ti liu."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:11,question:"Mc ch ca qun l d n l:",options:[{id:"A",text:"m bo sn phm p ng yu cu, ng hn, trong gii hn chi ph."},{id:"B",text:"t li nhun cao nht v m rng quy m t chc."},{id:"C",text:"a ra gii php mi v ci tin quy trnh cng ngh."},{id:"D",text:"Gim thiu ri ro ti chnh v nng cao uy tn doanh nghip."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:12,question:"Trong quy trnh lp k hoch, yu t rng buc ca d n gm:",options:[{id:"A",text:"Thi gian, nhn lc v ngn sch."},{id:"B",text:"Khch hng, sn phm v th trng."},{id:"C",text:"Ti nguyn, k nng v k thut."},{id:"D",text:"Thi gian, a im v cng ngh."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:13,question:"D n bn ngoi l:",options:[{id:"A",text:"D n phc v chnh ni b t chc."},{id:"B",text:"D n c thc hin cho mt n v khc."},{id:"C",text:"D n khng c yu t khch hng tham gia."},{id:"D",text:"D n nghin cu pht trin ni b."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:14,question:"Khi mt d n ko di vt 50% thi gian d kin, c coi l:",options:[{id:"A",text:"D n chm tin ."},{id:"B",text:"D n tht bi."},{id:"C",text:"D n ang tm dng."},{id:"D",text:"D n cn ti cu trc."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:15,question:"Mt trong nhng nguyn nhn su xa khin d n tht bi l:",options:[{id:"A",text:"Bt u lp trnh khi cha hiu r yu cu thc t."},{id:"B",text:"Khng c  kinh ph v nhn lc."},{id:"C",text:"Khng c khch hng ph duyt yu cu."},{id:"D",text:"S dng phn mm khng tng thch."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:16,question:" cn bng b ba rng buc (phm vi  chi ph  thi gian), nh qun l cn:",options:[{id:"A",text:"Ct gim phm vi khi chi ph vt qu gii hn."},{id:"B",text:"Phn tch u tin, iu chnh linh hot gia ba yu t."},{id:"C",text:"Tng ngn sch  rt ngn tin  d n."},{id:"D",text:"Gi nguyn thi gian, gim cht lng sn phm."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:17,question:"Giao tip l g?",options:[{id:"A",text:"L qu trnh truyn t thng tin bng vn bn."},{id:"B",text:"L hnh ng truyn tin mt chiu t ngi ni n ngi nghe."},{id:"C",text:"L qu trnh trao i thng tin, tnh cm v hiu bit gia con ngi."},{id:"D",text:"L hot ng truyn thng qua cc phng tin k thut."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:18,question:"Giao tip hiu qu nht din ra trong tnh hung no?",options:[{id:"A",text:"Giao tip trc tip, mt i mt gia hai bn."},{id:"B",text:"Giao tip qua th in t v bo co."},{id:"C",text:"Giao tip qua in thoi v tin nhn."},{id:"D",text:"Giao tip bng cc vn bn hnh chnh."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:19,question:"Trong bn quy m giao tip, quy m no l c bn nht?",options:[{id:"A",text:"Giao tip vi chnh bn thn."},{id:"B",text:"Giao tip nhm."},{id:"C",text:"Giao tip gia cc t chc."},{id:"D",text:"Giao tip trong cng ng."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:20,question:"Nguyn tc quan trng nht trong giao tip l:",options:[{id:"A",text:"Cnh tranh v khng nh bn thn."},{id:"B",text:"Dng quyn lc  iu khin ngi khc."},{id:"C",text:"Tn trng nhn cch v i x bnh ng trong giao tip."},{id:"D",text:"Gi im lng  trnh xung t."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:21,question:"Theo thuyt hot ng, giao tip l:",options:[{id:"A",text:"Qu trnh biu t cm xc bng li ni."},{id:"B",text:"Phng tin  tha mn nhu cu tm l."},{id:"C",text:"H thng qu trnh c mc ch m bo s tng tc gia ngi vi ngi trong hot ng tp th."},{id:"D",text:"Phn ng tm l khi tip xc x hi."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:22,question:"Phong cch giao tip c on c u im l:",options:[{id:"A",text:"To mi trng dn ch v hp tc."},{id:"B",text:"Gip a ra quyt nh nhanh chng trong tnh hung khn cp."},{id:"C",text:"Tng s t tin v sng to ca cp di."},{id:"D",text:"Lm tng tnh dn ch trong t chc."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:23,question:"Phong cch giao tip dn ch c c trng bi:",options:[{id:"A",text:"Kim sot cht ch v p t  kin c nhn."},{id:"B",text:"Linh hot nhng d thay i mc tiu."},{id:"C",text:"Biu hin s tn trng, lng nghe v hp tc gia cc bn."},{id:"D",text:"Khng quan tm n cm xc ngi i thoi."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:24,question:"S khc bit gia nghe v lng nghe l g?",options:[{id:"A",text:"Nghe ch ng, cn lng nghe l th ng."},{id:"B",text:"Nghe l th ng, cn lng nghe l ch ng, c chn lc v tp trung."},{id:"C",text:"Nghe dng gic quan, cn lng nghe dng l tr."},{id:"D",text:"Nghe dnh cho cng vic, cn lng nghe dnh cho cm xc."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:25,question:"Mt trong nhng yu t lm gim hiu qu lng nghe l:",options:[{id:"A",text:"Gi im lng khi i phng ni."},{id:"B",text:"Ngt li hoc nh gi ngi ni khi cha hiu r."},{id:"C",text:"Gt u v phn hi tch cc."},{id:"D",text:"Ghi ch li cc  chnh trong khi nghe."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:26,question:"Mt trong cc k nng gip rn luyn lng nghe hiu qu l:",options:[{id:"A",text:"Tp trung vo phong cch ngi ni hn l ni dung."},{id:"B",text:"Phn bin lin tc  th hin hiu bit."},{id:"C",text:"Ch , tp trung, khng ngt li v phn hi ng lc."},{id:"D",text:"Gi khong cch  trnh b chi phi cm xc."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:27,question:"Vit trong giao tip c vai tr g?",options:[{id:"A",text:"Th hin cm xc v s quan tm c nhn."},{id:"B",text:"L cng c truyn ti thng tin chnh xc, lu tr v xem xt chi tit."},{id:"C",text:"L hnh thc giao tip khng chnh thc."},{id:"D",text:"L cch th hin uy quyn v kim sot thng tin."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:28,question:"Mt bi vit tt cn m bo yu t no?",options:[{id:"A",text:"Cm xc, hnh thc v b cc."},{id:"B",text:"R rng, sc tch, ng ng php v d hiu."},{id:"C",text:"Di dng, chi tit v dng nhiu v d."},{id:"D",text:"Phc tp, khoa trng v mang tnh hc thut."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:29,question:"Trong k nng ni, yu t quyt nh hiu qu l:",options:[{id:"A",text:"Ni dung bi ni di v c s liu."},{id:"B",text:"Cch din t, ging ni v s t tin khi trnh by."},{id:"C",text:"Vit sn ton b ni dung  c li."},{id:"D",text:"Dng ngn t phc tp v tru tng."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:30,question:"Trc khi thuyt trnh, bc chun b quan trng nht l:",options:[{id:"A",text:"Vit li ton b bi thuyt trnh t tr nh."},{id:"B",text:"Chun b trang phc ph hp v phn thng."},{id:"C",text:"Xc nh mc tiu, i tng ngi nghe v ni dung chnh."},{id:"D",text:"Hc thuc lng ton b ni dung bi ni."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:31,question:"Ngn ng c th trong khi ni gip:",options:[{id:"A",text:"Lm gim cng thng cho ngi ni."},{id:"B",text:"Tng tnh thuyt phc v th hin cm xc chn tht."},{id:"C",text:"Thay th hon ton li ni trong giao tip."},{id:"D",text:"Gim nhu cu s dng ngn ng."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:32,question:"Thuyt trnh bng cch c ton vn bi vit c hn ch g?",options:[{id:"A",text:"Gip m bo tnh chnh xc ca ni dung."},{id:"B",text:"Gy bun chn, thiu tng tc v kh thu ht ngi nghe."},{id:"C",text:"Tng kh nng ghi nh cho ngi ni."},{id:"D",text:"Th hin s chuyn nghip trong trnh by."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:33,question:"Theo Maslow, nguyn nhn khin ngi thuyt trnh hi hp l do:",options:[{id:"A",text:"Lo ngi phn ng tiu cc t khn gi."},{id:"B",text:"Nhu cu an ton b e da trong tnh hung cng khai."},{id:"C",text:"Thiu s chun b v kinh nghim."},{id:"D",text:"S mt v th x hi v uy tn c nhn."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:34,question:"Yu t phi ngn t trong giao tip gm:",options:[{id:"A",text:"Ging ni, t ng v cu trc cu."},{id:"B",text:"Ni dung, cch vit v thi ."},{id:"C",text:"nh mt, c ch, t th, trang phc v nt mt."},{id:"D",text:"Hnh thc trnh by vn bn."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:35,question:"Trong giao tip nhm,  t hiu qu cn:",options:[{id:"A",text:"Trnh bt ng v chp nhn mi  kin."},{id:"B",text:"Lng nghe, tn trng v phi hp hi ha gia cc thnh vin."},{id:"C",text:"Phn chia nhim v khng r rng  linh hot hn."},{id:"D",text:"Ch tp trung vo mc tiu c nhn."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:36,question:"Khi vit bo co hoc email cng vic, iu cn trnh nht l:",options:[{id:"A",text:"Vit ngn gn, r rng v ng chnh t."},{id:"B",text:"Ghi ch y  cc s liu quan trng."},{id:"C",text:"Dng t ng cm tnh, thiu trng tm v khng c cu trc."},{id:"D",text:"Trnh by ni dung theo th t logic."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:37,question:"c lng trong qun l d n l g?",options:[{id:"A",text:"Qu trnh kim tra v iu chnh chi ph thc t ca d n."},{id:"B",text:"Qu trnh d on cng sc, chi ph v thi gian cn thit  hon thnh cng vic."},{id:"C",text:"Qu trnh so snh kt qu thc t vi k hoch ban u."},{id:"D",text:"Hot ng tng kt sau khi d n kt thc."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:38,question:"Khi d n tin trin v thng tin r hn, sai s c lng c xu hng:",options:[{id:"A",text:"Tng dn do ri ro cao hn."},{id:"B",text:"Gim dn nh d liu thc t c cp nht."},{id:"C",text:"Khng thay i v  c d bo ban u."},{id:"D",text:"Ph thuc vo  kin ca khch hng."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:39,question:"Phng php c lng nh gi chuyn gia da trn yu t no?",options:[{id:"A",text:"Kinh nghim v kin thc thc t ca cc chuyn gia trong lnh vc."},{id:"B",text:"S liu thng k t cc d n  hon thnh."},{id:"C",text:"Mc chi ph trung bnh ca ngnh."},{id:"D",text:"Quy nh k thut ca c quan qun l."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:40,question:"u im ca phng php nh gi chuyn gia l:",options:[{id:"A",text:"Nhanh chng, c th chnh xc nu chn ng chuyn gia."},{id:"B",text:"Tit kim chi ph v d t ng ha."},{id:"C",text:"Khng ph thuc vo con ngi."},{id:"D",text:"Ph hp vi cc d n cha c d liu lch s."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:41,question:"Nhc im ca phng php nh gi chuyn gia l:",options:[{id:"A",text:"Tn thi gian v chi ph cao."},{id:"B",text:"Ph thuc vo ch quan v kinh nghim c nhn."},{id:"C",text:"Khng p dng cho cc d n nh."},{id:"D",text:"Khng ph hp vi d n phn mm."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:42,question:"Phng php c lng quy trnh lch s da vo:",options:[{id:"A",text:"Cm nhn ca nhm d n v tin  cng vic."},{id:"B",text:"D liu v kt qu thc t t cc d n trc ."},{id:"C",text:"Bo co ti chnh v chi ph u t."},{id:"D",text:"Thi gian thc hin trung bnh ca d n mu."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:43,question:"Khi s dng quy trnh lch s  c lng, yu t quan trng nht l:",options:[{id:"A",text:"C c s d liu y  v thi gian, chi ph v nhn lc d n trc."},{id:"B",text:"Tnh ton theo cm tnh v kinh nghim c nhn."},{id:"C",text:"p dng quy tc phn trm tng trng."},{id:"D",text:"Da vo m hnh d ton ti chnh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:44,question:"Cng thc COCOMO c dng  c lng:",options:[{id:"A",text:"Chi ph, thi gian, nhn lc v lch biu ca d n phn mm."},{id:"B",text:"Ri ro, cht lng v chi ph vn hnh."},{id:"C",text:"Ti nguyn phn cng v hiu nng h thng."},{id:"D",text:"K hoch o to v bo tr sn phm."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:45,question:"Trong m hnh COCOMO, thng tin u vo quan trng nht l:",options:[{id:"A",text:"S dng lnh m ngun (LOSC) d kin."},{id:"B",text:"S lng lp trnh vin tham gia."},{id:"C",text:"Mc lng bnh qun ca nhm k thut."},{id:"D",text:"Tc  x l ca h thng my tnh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:46,question:"Phng php im chc nng dng :",options:[{id:"A",text:"o  phc tp v khi lng cng vic ca phn mm."},{id:"B",text:"nh gi cht lng m ngun chng trnh."},{id:"C",text:"Kim th hiu nng h thng."},{id:"D",text:"o tc  x l ca phn mm."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:47,question:"Theo cng thc D=C(G+J), trong  D l thi gian thc hin, C l  phc tp, G l kinh nghim, J l tri thc chuyn mn, ta hiu rng:",options:[{id:"A",text:"Thi gian hon thnh ph thuc vo  phc tp v nng lc ngi thc hin."},{id:"B",text:"Hiu nng h thng quyt nh hon ton thi gian d n."},{id:"C",text:"Ch cn kinh nghim chung l   gim thi gian."},{id:"D",text:"Tri thc chuyn mn khng nh hng n tin ."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:48,question:"Mt nguyn tc quan trng ca quy tc c lng theo DEC l:",options:[{id:"A",text:"Nn  ngi mi c lng  c gc nhn khch quan."},{id:"B",text:"Khng cn tho lun khi c sai khc gia cc nhm."},{id:"C",text:"Nu c chnh lch ln gia cc nhm c lng, phi hp li  thng nht."},{id:"D",text:"Ly trung bnh cng ca mi kt qu c lng  tng  tin cy."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:49,question:"Yu t no l nguyn nhn chnh khin vic c lng sai lch ln?",options:[{id:"A",text:"Khng c d liu lch s hoc khng phn tch k yu cu d n."},{id:"B",text:"Thiu nhn lc c trnh  cao."},{id:"C",text:"Do khch hng thay i yu cu gia chng."},{id:"D",text:"Do thit b phn cng cha n nh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:50,question:"Theo quy tc DEC, v sao khng nn p buc lp trnh vin a ra c lng?",options:[{id:"A",text:"V h khng c kh nng tnh ton."},{id:"B",text:"V h thng nh gi qu thp cng vic."},{id:"C",text:"V vic p buc lm mt tnh khch quan v gim  tin cy ca kt qu."},{id:"D",text:"V h khng c trch nhim vi tin  d n."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:51,question:"Theo DEC, cch x l hp l nht khi c nhiu c lng khc nhau cho cng mt cng vic l:",options:[{id:"A",text:"Chn gi tr cao nht  trnh thiu ht thi gian."},{id:"B",text:"Ly trung bnh cng  m bo cn bng."},{id:"C",text:"T chc tho lun  tm nguyn nhn sai khc v thng nht li kt qu."},{id:"D",text:"Chn ngu nhin mt kt qu v iu chnh sau."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:52,question:"Theo tin trnh c lng, ngu nhin c thm vo nhm mc ch:",options:[{id:"A",text:"Tng  chnh xc cho kt qu tnh ton."},{id:"B",text:"m bo c lng ph hp vi thc t thng k."},{id:"C",text:"B tr cho nhng bin ng hoc ri ro khng lng trc."},{id:"D",text:"Gim s khc bit gia cc nhm thc hin."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:53,question:"Kt lun ca ti liu v k nng c lng trong d n l g?",options:[{id:"A",text:"L mt quy trnh nh lng chnh xc."},{id:"B",text:"C th t ng ha hon ton bng phn mm."},{id:"C",text:"L mt qu trnh va mang tnh ngh thut, va cn iu chnh lin tc."},{id:"D",text:"Khng cn thit nu d n  c k hoch c th."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:54,question:"Mc ch chnh ca vic lp lch trong qun l d n l g?",options:[{id:"A",text:"D on chi ph v phn b ngn sch d n."},{id:"B",text:"Xc nh th t, thi gian v quan h gia cc cng vic."},{id:"C",text:"Xc nh ngi chu trch nhim trong tng giai on."},{id:"D",text:"nh gi hiu qu tng th ca kt qu thc hin."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:55,question:"T PERT trong qun l d n l vit tt ca cm t no sau y?",options:[{id:"A",text:"Program Evaluation and Review Technique."},{id:"B",text:"Project Execution and Reporting Template."},{id:"C",text:"Process Evaluation and Resource Tracking."},{id:"D",text:"Planning Estimation and Review Tool."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:56,question:"ng gng (Critical Path) trong s  PERT c  ngha g?",options:[{id:"A",text:"L ng c s lng hot ng ln nht trong d n."},{id:"B",text:"L chui hot ng di nht quyt nh thi gian hon thnh d n."},{id:"C",text:"L tuyn ng c mc chi ph thc hin thp nht."},{id:"D",text:"L chui hot ng c  th ni cao nht trong d n."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:57,question:"Mi quan h gia ng gng v thi hn hon thnh d n l g?",options:[{id:"A",text:"Mi thay i trn ng gng u lm thay i thi hn d n."},{id:"B",text:"ng gng ch nh hng n cc cng vic u tin."},{id:"C",text:"Cc cng vic trn ng gng c th di lch ty ."},{id:"D",text:"ng gng ch dng  theo di chi ph d kin."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:58,question:"Khi mt cng vic khng nm trn ng gng, iu  cho bit:",options:[{id:"A",text:"Cng vic  c vai tr trung tm ca d n."},{id:"B",text:"Cng vic  c th tr trong gii hn cho php m khng nh hng d n."},{id:"C",text:"Cng vic  phi hon thnh sm nht  t tin ."},{id:"D",text:"Cng vic  khng nh hng n sn phm cui cng."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:59,question:"Th ni ton b (Total Float) trong d n c hiu l g?",options:[{id:"A",text:"Thi gian cng vic c th tr m khng lm tr ton b d n."},{id:"B",text:"Thi gian d n c th ko di trc khi b hy b."},{id:"C",text:"Thi gian ch i gia hai hot ng lin tip nhau."},{id:"D",text:"Thi gian m ngi qun l d n c th phn b li nhn s."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:60,question:"Th ni t do (Free Float) c  ngha nh th no trong qun l d n?",options:[{id:"A",text:"Khong thi gian d n c th ko di ti a."},{id:"B",text:"Khong thi gian cng vic c th tr m khng nh hng n cng vic sau."},{id:"C",text:"Khong thi gian ngi qun l c th ngh gia chng."},{id:"D",text:"Khong thi gian dng  chun b bo co kt qu."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:61,question:"Khi mt hot ng b ko di v lm thay i ng gng, ngi qun l cn:",options:[{id:"A",text:"Cp nht s  PERT v iu chnh k hoch tng th."},{id:"B",text:"Gi nguyn tin  v ch nh gi sau."},{id:"C",text:"Gim yu cu cht lng  b thi gian."},{id:"D",text:"Di cc hot ng khc sang giai on sau."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:62,question:"Vic cp pht ti nguyn nhn lc cn da trn nguyn tc no?",options:[{id:"A",text:"Da trn thm nin cng tc v chc v ca mi ngi."},{id:"B",text:"Da trn k nng, mc  ph hp v s tin cy ca nhn s."},{id:"C",text:"Da trn  tui, gii tnh v kh nng lm vic nhm."},{id:"D",text:"Da trn s lng ngi c th huy ng trong giai on ."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:63,question:"Theo quy tc cng nghip, khi b sung thm ngi vo nhm, iu g xy ra?",options:[{id:"A",text:"Hiu sut gim v cn thm thi gian phi hp gia cc thnh vin."},{id:"B",text:"Hiu sut tng v nhiu ngi cng chia s cng vic."},{id:"C",text:"Chi ph gim v rt ngn c thi gian d n."},{id:"D",text:"Tin  c rt ngn t l thun vi s lng nhn vin."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:64,question:"Ti nguyn phi con ngi trong d n thng bao gm nhng g?",options:[{id:"A",text:"Phn cng, phn mm, ti liu, thit b v cc dch v h tr."},{id:"B",text:"Chi ph nhn s, phng tin i li v ph cp cng tc."},{id:"C",text:"Hp ng, giy t hnh chnh v ti liu o to."},{id:"D",text:"Thi gian ngh php v lch cng tc ca nhm d n."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:65,question:"Rng buc b ba (Triple Constraint) trong qun l d n gm nhng yu t no?",options:[{id:"A",text:"Thi gian  Chi ph  Phm vi (hoc Cht lng)."},{id:"B",text:"Nhn lc  Cng ngh  Kinh nghim."},{id:"C",text:"Thi gian  a im  Ngun lc."},{id:"D",text:"K hoch  Tin   nh gi."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:66,question:"S  Gantt c vai tr g trong qun l d n?",options:[{id:"A",text:"Th hin tin  cng vic theo trc thi gian  theo di thc hin."},{id:"B",text:"M t quan h nhn qu gia cc cng vic d n."},{id:"C",text:"nh gi nng sut ca tng thnh vin trong nhm."},{id:"D",text:"Biu din mc  ri ro v s ph thuc k thut."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:67,question:"Vic lp lch li cc hot ng trong d n c thc hin khi no?",options:[{id:"A",text:"Khi d n kt thc v cn rt kinh nghim."},{id:"B",text:"Khi c thay i trong tin , ngun lc hoc cc rng buc khc."},{id:"C",text:"Khi khch hng yu cu b sung thm chc nng mi."},{id:"D",text:"Khi nhm d n thay i ngi qun l hoc nh ti tr."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:68,question:"Ngi qun l d n cn c bit tp trung vo ng gng v l do no?",options:[{id:"A",text:"ng gng cha cc cng vic t quan trng nht."},{id:"B",text:"ng gng xc nh chi ph pht sinh ca tng cng on."},{id:"C",text:"Mi s chm tr trn ng gng u lm chm ton b tin  d n."},{id:"D",text:"ng gng ch nh hng n cc cng vic ph tr trong d n."}],correctAnswer:"C",chapter:4,chapterName:"LP LCH D N"},{id:69,question:"Khi rt ngn tin  d n, iu gi nh no cn c m bo?",options:[{id:"A",text:"Cc nhim v c th rt ngn c lp v khng nh hng ln nhau."},{id:"B",text:"Thm nhn lc lun gip tin  c rt ngn nhanh chng."},{id:"C",text:"C th gim thi gian m khng tng thm chi ph hoc ri ro."},{id:"D",text:"Mi hot ng c th c rt ngn m khng cn iu chnh k hoch."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:70,question:"Kim sot d n bao gm cc cng vic chnh no?",options:[{id:"A",text:"Phn tch yu cu, thit k v th nghim sn phm."},{id:"B",text:"Gim st tin , pht hin vn  v iu chnh k hoch."},{id:"C",text:"Lp k hoch ngn sch v phn cng nhn s."},{id:"D",text:"Tng kt d n v nh gi cht lng sn phm."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:71,question:"Mc tiu quan trng ca kim sot d n l:",options:[{id:"A",text:"m bo d n c thc hin ng k hoch, ng thi gian v ngn sch."},{id:"B",text:"Tng doanh thu, gim chi ph v m rng th trng."},{id:"C",text:"Gim bt cc bc trin khai v ti gin nhn s."},{id:"D",text:"m bo tt c yu cu k thut u c vit bng ti liu."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:72,question:"Gim st d n l qu trnh:",options:[{id:"A",text:"Pht trin cc tnh nng mi theo yu cu khch hng."},{id:"B",text:"Theo di, kim tra tin  v cht lng cng vic so vi k hoch."},{id:"C",text:"Kim th phn mm v sa li sau trin khai."},{id:"D",text:"nh gi tng kt khi d n  hon thnh."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:73,question:"Ai l ngi chu trch nhim gim st chi tit cc cng on k thut trong d n?",options:[{id:"A",text:"Ph gim c iu hnh (PG iu hnh)."},{id:"B",text:"Gim c d n (G d n)."},{id:"C",text:"Khch hng s dng phn mm."},{id:"D",text:"Ban ch o cp trn ca d n."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:74,question:"Theo ti liu, gim st d n t pha khch hng c  ngha g?",options:[{id:"A",text:"Gip khch hng nm tin , cht lng v chi ph  m bo quyn li."},{id:"B",text:"Gip nh ti tr kim sot ngun vn u t hiu qu hn."},{id:"C",text:"Gip ban ch o theo di hiu sut lm vic ca nhn vin."},{id:"D",text:"Gip nhm k thut pht trin thm cc chc nng b sung."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:75,question:"Khi d n b ko di thi hn, ngi qun l cn lm g trc tin?",options:[{id:"A",text:"B sung nhn lc v yu cu lm thm gi."},{id:"B",text:"Gim phm vi d n  rt ngn thi gian."},{id:"C",text:"Kim tra nguyn nhn, xc nh cng vic gng v iu chnh k hoch."},{id:"D",text:"Tm dng d n  nh gi li ton b k hoch."}],correctAnswer:"C",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:76,question:"Trong kim sot chi ph, gi tr phn vic  thc hin (EV) th hin iu g?",options:[{id:"A",text:"Tng chi ph  chi tr tnh n thi im hin ti."},{id:"B",text:"Gi tr cng vic hon thnh theo ngn sch d kin."},{id:"C",text:"Khon chi ph pht sinh vt ngoi k hoch."},{id:"D",text:"Li nhun d kin thu c sau khi bn giao d n."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:77,question:"Ngi qun l nn pht hin vn  ca d n vo giai on no?",options:[{id:"A",text:"Cng sm cng tt, trc khi vn  nh hng n tin  v chi ph."},{id:"B",text:"Sau khi d n kt thc  c s liu chnh xc."},{id:"C",text:"Khi khch hng yu cu bo co chnh thc."},{id:"D",text:"Khi nhm d n hon thnh 50% khi lng cng vic."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:78,question:"Phm vi d n c hiu l g?",options:[{id:"A",text:"Tp hp cc ri ro c th xy ra trong qu trnh thc hin d n."},{id:"B",text:"Danh sch ton b nhng cng vic m d n phi thc hin."},{id:"C",text:"Tp hp cc ngun lc cn thit  hon thnh d n."},{id:"D",text:"Cc ch tiu ti chnh v li nhun ca d n."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:79,question:"Qun l phm vi d n nhm mc ch chnh l g?",options:[{id:"A",text:"Gim thiu ri ro v tng hiu qu vn hnh ca d n."},{id:"B",text:"m bo d n hon thnh ng nhng ni dung  c xc nh."},{id:"C",text:"Duy tr tin  v cn bng chi ph ca d n."},{id:"D",text:"Theo di kt qu v nh gi cht lng sn phm."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:80,question:"Cc kt qu chuyn giao (deliverables) ca d n l:",options:[{id:"A",text:"Cc chi ph  c chi tr cho cc hot ng."},{id:"B",text:"Nhng sn phm hoc kt qu c th m d n phi bn giao."},{id:"C",text:"Nhng cng vic ang trong qu trnh thc hin."},{id:"D",text:"Nhng ti liu hng dn k thut v bo co chi tit."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:81,question:"Tuyn b phm vi (Scope Statement) thng bao gm nhng ni dung no?",options:[{id:"A",text:"Mc tiu ti chnh, thi gian hon thnh v kt qu kim th."},{id:"B",text:"L do d n, m t sn phm, cc sn phm trung gian v tiu ch thnh cng."},{id:"C",text:"Danh sch nhn s, s  PERT v biu  Gantt."},{id:"D",text:"K hoch chi ph, ngun lc v tin  thc hin."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:82,question:"Xc nh phm vi d n l bc nhm:",options:[{id:"A",text:"Chia nh cng vic thnh cc phn chi tit d qun l v kim sot."},{id:"B",text:"Tng hp tt c kt qu ca cc giai on trin khai d n."},{id:"C",text:"Thit lp c ch theo di v nh gi tin ."},{id:"D",text:"Kim tra tnh kh thi ca cc phng n k thut."}],correctAnswer:"A",chapter:6,chapterName:"QUN L PHM VI"},{id:83,question:"Li ch ca vic xc nh phm vi ng n l:",options:[{id:"A",text:"Gip d n linh hot hn khi m rng quy m thc hin."},{id:"B",text:"Gip c lng chnh xc thi gian, chi ph v ti nguyn cn thit."},{id:"C",text:"Gip tit kim ngn sch v gim nhn s trong d n."},{id:"D",text:"Gip tp trung vo giai on cui m khng cn kim sot u vo."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:84,question:"Vn  ph bin khi qun l phm vi d n CNTT l g?",options:[{id:"A",text:"Phm vi b m rng lin tc do thay i yu cu (scope creep)."},{id:"B",text:"Khng xc nh c ngn sch v thi hn c th cho tng cng vic."},{id:"C",text:"Cc thnh vin nhm d n khng c k nng lp k hoch."},{id:"D",text:"Thiu d liu nh gi ri ro trong giai on u d n."}],correctAnswer:"A",chapter:6,chapterName:"QUN L PHM VI"},{id:85,question:" kim sot v hn ch phm vi phnh ra (scope creep), ngi qun l cn:",options:[{id:"A",text:"Cho php thay i ty   m bo s linh hot trong d n."},{id:"B",text:"Tr hon vic cp nht k hoch cho n khi hon thnh giai on chnh."},{id:"C",text:"Xc lp quy trnh kim sot thay i v c ph duyt trc khi thc hin."},{id:"D",text:"Tng thm nhn lc v kinh ph  p ng cc yu cu mi."}],correctAnswer:"C",chapter:6,chapterName:"QUN L PHM VI"},{id:86,question:"Ti sao qun l thi gian d n li quan trng?",options:[{id:"A",text:"V thi gian l yu t d thay i v t nh hng n chi ph."},{id:"B",text:"V tin  d n quyt nh s thnh cng ca sn phm cui cng."},{id:"C",text:"V vic hon thnh ng hn l thch thc ln nht i vi mi d n."},{id:"D",text:"V thi gian c th c iu chnh linh hot trong mi giai on."}],correctAnswer:"C",chapter:7,chapterName:"QUN L THI GIAN"},{id:87,question:"Qun l thi gian d n bao gm hot ng no sau y?",options:[{id:"A",text:"Xc nh hot ng, sp xp th t, c lng v pht trin lch biu."},{id:"B",text:"Ln k hoch chi ph, phn b ngun lc v theo di hiu sut."},{id:"C",text:"Xc nh ri ro, nh gi phm vi v iu chnh nhn s."},{id:"D",text:"Kim sot cht lng, lp bo co v phn tch nng sut."}],correctAnswer:"A",chapter:7,chapterName:"QUN L THI GIAN"},{id:88,question:"Sp xp th t cc hot ng trong d n nhm mc ch g?",options:[{id:"A",text:"Gip xc nh chi ph trung bnh ca tng hng mc."},{id:"B",text:"Gip xc nh quan h ph thuc gia cc hot ng  lp k hoch."},{id:"C",text:"Gip tng tnh linh hot trong qu trnh kim sot d n."},{id:"D",text:"Gip rt ngn thi gian thc hin thng qua lm song song cng vic."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:89,question:"Ph thuc bt buc gia cc hot ng l g?",options:[{id:"A",text:"L s ph thuc c nhm d n quyt nh."},{id:"B",text:"L mi quan h do bn cht k thut ca cng vic quy nh."},{id:"C",text:"L s ph thuc do khch hng hoc nh ti tr t ra."},{id:"D",text:"L mi quan h tm thi do thiu ngun lc thc hin."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:90,question:"Phng php CPM (Critical Path Method) c s dng :",options:[{id:"A",text:"Xc nh ng gng v thi gian hon thnh sm nht ca d n."},{id:"B",text:"Tnh ton chi ph d kin v ngn sch ca tng cng vic."},{id:"C",text:"c lng nhn lc v vt t cn thit cho mi giai on."},{id:"D",text:"nh gi mc  hi lng ca khch hng trong qu trnh thc hin."}],correctAnswer:"A",chapter:7,chapterName:"QUN L THI GIAN"},{id:91,question:"Khi lp lch, iu khin lch biu c ngha l g?",options:[{id:"A",text:"Tnh ton li chi ph d n da trn tin  thc t."},{id:"B",text:"Xy dng k hoch nhn s theo nng lc ca tng c nhn."},{id:"C",text:"Theo di tin , x l sai lch v cp nht li lch biu khi cn."},{id:"D",text:"Dng cc hot ng tr  bo m chi ph khng vt qu d kin."}],correctAnswer:"C",chapter:7,chapterName:"QUN L THI GIAN"},{id:92,question:"Trong phng php PERT, cng thc tnh thi gian k vng l g?",options:[{id:"A",text:"(Thi gian lc quan + 4  Thi gian trung bnh) / 6"},{id:"B",text:"(Thi gian lc quan + 4  Thi gian kh d + Thi gian bi quan) / 6"},{id:"C",text:"(Thi gian bi quan + Thi gian trung bnh) / 2"},{id:"D",text:"(Thi gian thc t + Thi gian d kin) / 2"}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:93,question:"Yu t no gy xung t nhiu nht trong cc d n l g?",options:[{id:"A",text:"Chi ph pht sinh v thay i yu cu khch hng."},{id:"B",text:"Lch biu v tin  cng vic, c bit  giai on cui d n."},{id:"C",text:"Phm vi cng vic khng r rng gia cc b phn."},{id:"D",text:"Thiu thng tin v truyn thng trong nhm d n."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:94,question:"Qun l chi ph d n l g?",options:[{id:"A",text:"L qu trnh lp k hoch, gim st v phn b ngun lc cho nhn s."},{id:"B",text:"L qu trnh c lng, lp k hoch v kim sot chi ph ca d n."},{id:"C",text:"L hot ng gim st ri ro v kim sot tin  ca d n."},{id:"D",text:"L qu trnh nh gi hiu sut v cht lng ca cc hot ng."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:95,question:"Mc tiu chnh ca qun l chi ph d n l:",options:[{id:"A",text:"m bo d n hon thnh trong gii hn ngn sch  c ph duyt."},{id:"B",text:"Tng doanh thu v ti u ha li nhun cho t chc thc hin."},{id:"C",text:"Duy tr tin  thc hin v hn ch ri ro pht sinh trong d n."},{id:"D",text:"Ti a ha hiu sut s dng nhn lc v vt t ca d n."}],correctAnswer:"A",chapter:8,chapterName:"QUN L CHI PH"},{id:96,question:"Cc quy trnh chnh ca qun l chi ph bao gm:",options:[{id:"A",text:"Lp ngn sch, qun l ri ro v nh gi cht lng sn phm."},{id:"B",text:"c lng ngun lc, o to nhn s v xc nh mc tiu d n."},{id:"C",text:"Lp k hoch ti nguyn, c lng chi ph, d ton v kim sot chi ph."},{id:"D",text:"Tnh ton lng, chi tiu ni b v li nhun sau d n."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:97,question:"Trong qun l chi ph, c lng chi ph c ngha l g?",options:[{id:"A",text:"Xc nh gi bn sn phm cui cng ca d n."},{id:"B",text:"D on chi ph cn thit  hon thnh cc hot ng d n."},{id:"C",text:"Phn tch cc khon chi pht sinh trong giai on kt thc d n."},{id:"D",text:"nh gi mc  hiu qu ca vic s dng ngn sch."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:98,question:"Phng php c lng t di ln (Bottom-up Estimating) l:",options:[{id:"A",text:"c tnh chi ph tng th da trn phm vi cng vic chung."},{id:"B",text:"c lng chi ph chi tit cho tng hng mc ri tng hp li ton d n."},{id:"C",text:"c lng chi ph bng cch ly trung bnh chi ph ca cc nhm."},{id:"D",text:"c lng chi ph theo t l phn trm doanh thu ca d n."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:99,question:"Phng php thng s (Parametric Estimating) c hiu l:",options:[{id:"A",text:"c lng da vo d liu t cc d n khc c quy m tng ng."},{id:"B",text:"c lng da vo kinh nghim thc t ca ngi qun l d n."},{id:"C",text:"c lng da trn cc bin s ton hc phn nh mi quan h chi ph."},{id:"D",text:"c lng bng cch so snh cc bo co ti chnh ca nhiu d n."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:100,question:"Qun l chi ph s dng cng c EMV (Earned Value Management) nhm mc ch:",options:[{id:"A",text:"nh gi mc  hon thnh cng vic thng qua so snh chi ph v tin ."},{id:"B",text:"Theo di cc khon n v doanh thu t hp ng d n."},{id:"C",text:"Tnh ton cc ch tiu ti chnh  nh gi li nhun u t."},{id:"D",text:"Xc nh s lng nhn s cn thit trong tng giai on."}],correctAnswer:"A",chapter:8,chapterName:"QUN L CHI PH"},{id:101,question:"Trong EMV, ch s SPI = EV/PV phn nh iu g?",options:[{id:"A",text:"Hiu sut chi ph so vi gi tr thc t  chi tiu."},{id:"B",text:"Mc  tin   nu SPI < 1 ngha l d n b tr so vi k hoch."},{id:"C",text:"T l gia chi ph d kin v chi ph thc t ca d n."},{id:"D",text:"Hiu qu u t  nu SPI > 1 ngha l li nhun cao hn d kin."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:102,question:" kim sot chi ph hiu qu, ngi qun l d n cn:",options:[{id:"A",text:"Tng ngn sch d n khi chi ph vt k hoch."},{id:"B",text:"Ch iu chnh chi ph vo giai on cui d n."},{id:"C",text:"Gim st chi ph nh k, pht hin sai lch v iu chnh kp thi."},{id:"D",text:"Gim chi ph bng cch ct gim nhn s v trang thit b."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:103,question:"Theo ISO, cht lng c nh ngha l g?",options:[{id:"A",text:"L chi ph u t  m bo sn phm t tiu chun."},{id:"B",text:"L mc  m sn phm p ng cc yu cu  c xc nh."},{id:"C",text:"L kh nng sn phm to ra li nhun cho t chc thc hin."},{id:"D",text:"L mc  ph hp gia sn phm v nhu cu ca khch hng."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:104,question:"Mc tiu c bn ca qun l cht lng trong d n l g?",options:[{id:"A",text:"Tng doanh thu v m rng quy m hot ng ca t chc."},{id:"B",text:"m bo sn phm tho mn yu cu khch hng v tiu chun  ra."},{id:"C",text:"Gim chi ph sn xut  nng cao hiu qu kinh t tng th."},{id:"D",text:"Rt ngn thi gian thc hin m vn m bo hiu sut ti a."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:105,question:"Trong quy trnh qun l cht lng, lp k hoch cht lng l g?",options:[{id:"A",text:"Giai on kim tra cc kt qu u ra ca d n."},{id:"B",text:"Qu trnh xc nh tiu chun v cch thc  m bo sn phm t yu cu."},{id:"C",text:"Hot ng o lng hiu qu v chi ph ca tng cng vic."},{id:"D",text:"Giai on ph duyt kt qu trc khi bn giao cho khch hng."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:106,question:"m bo cht lng (Quality Assurance) tp trung vo:",options:[{id:"A",text:"nh gi quy trnh lm vic nhm m bo sn phm tun th tiu chun."},{id:"B",text:"Sa li k thut v khc phc s c phn mm pht sinh trong d n."},{id:"C",text:"Kim tra kt qu cui cng trc khi giao cho ngi s dng."},{id:"D",text:"Xc nh phm vi d n v o lng hiu qu qun l thi gian."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:107,question:"Kim tra cht lng (Quality Control) c hiu l:",options:[{id:"A",text:"Xem xt chi tit kt qu  xc nh mc  tun th cc tiu chun  t ra."},{id:"B",text:"nh gi kh nng nhn vin trong vic m bo tin  d n."},{id:"C",text:"Kim tra ngn sch v iu chnh chi ph thc hin tng phn vic."},{id:"D",text:"Kim nh mc  hi lng ca khch hng sau khi bn giao sn phm."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:108,question:"Chi ph ngn nga trong qun l cht lng l g?",options:[{id:"A",text:"L chi ph dng  phng trnh sai li trc khi sn phm c to ra."},{id:"B",text:"L chi ph cho vic sa li sau khi sn phm  c bn giao."},{id:"C",text:"L chi ph kim nh cht lng v kim tra ti liu hng dn."},{id:"D",text:"L chi ph pht sinh do khng tun th quy trnh  c ph duyt."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:109,question:"Yu t quan trng nht  ci tin cht lng l g?",options:[{id:"A",text:"S dng phn mm kim th t ng v cc cng c qun l tin tin."},{id:"B",text:"S cam kt v h tr ca lnh o trong vic thc y vn ha cht lng."},{id:"C",text:"Gim thiu thi gian kim th  tit kim chi ph nhn s."},{id:"D",text:"Tng s lng nhn vin  kim sot tt hn qu trnh thc hin."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:110,question:"Qun l ngun nhn lc d n l g?",options:[{id:"A",text:"L hot ng phn b ngn sch cho cc hot ng k thut ca d n."},{id:"B",text:"L qu trnh t chc, phn cng v gim st con ngi tham gia d n."},{id:"C",text:"L qu trnh xy dng chin lc pht trin sn phm phn mm."},{id:"D",text:"L hot ng lp k hoch chi ph v theo di tin  d n."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:111,question:"Mc tiu chnh ca qun l nhn lc trong d n l:",options:[{id:"A",text:"m bo cc cng vic c giao ng ngi, ng thi im v ng nng lc."},{id:"B",text:"Ti a ha li nhun v gim chi ph lao ng ca d n."},{id:"C",text:"m bo tin  bng cch phn chia khi lng ng u cho mi ngi."},{id:"D",text:"Duy tr tinh thn lm vic v vn ha t chc trong doanh nghip."}],correctAnswer:"A",chapter:10,chapterName:"QUN L NHN LC"},{id:112,question:"Nhn s ca d n bao gm:",options:[{id:"A",text:"Ch nhng ngi tham gia trc tip vo lp trnh v kim th."},{id:"B",text:"Nhng ngi h tr d n  cp qun l hoc hnh chnh."},{id:"C",text:"Tt c c nhn tham gia vo qu trnh thc hin, iu hnh v h tr d n."},{id:"D",text:"Cc nh ti tr v khch hng cung cp ngun vn cho d n."}],correctAnswer:"C",chapter:10,chapterName:"QUN L NHN LC"},{id:113,question:"Trong d n CNTT, G d n c trch nhim g?",options:[{id:"A",text:"Bo co k hoch, gim st tin  v duy tr lin h gia d n v bn ngoi."},{id:"B",text:"Thc hin kim th k thut v m bo cht lng ca phn mm."},{id:"C",text:"Ph trch lp trnh chi tit v x l li trong qu trnh pht trin."},{id:"D",text:"Gim st vic bo tr v vn hnh h thng sau khi bn giao."}],correctAnswer:"A",chapter:10,chapterName:"QUN L NHN LC"},{id:114,question:"Ph Gim c k thut (PG k thut) trong d n c vai tr chnh l:",options:[{id:"A",text:"Qun l ngn sch, hp ng v chi ph nhn cng cho ton d n."},{id:"B",text:"Ch o k thut, gim st tin  v m bo cht lng sn phm."},{id:"C",text:"Qun l khch hng v gii quyt cc vn  truyn thng."},{id:"D",text:"Phn tch yu cu v thit k chc nng ca h thng phn mm."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:115,question:"Theo ti liu, cn b lp trnh c trch nhim g trong d n?",options:[{id:"A",text:" xut yu cu v xc nhn phm vi cng vic ca d n."},{id:"B",text:"Thit k chi tit, lp trnh, kim th v bo co tin  thc hin."},{id:"C",text:"Xy dng ti liu qun l ri ro v nh gi chi ph thc t."},{id:"D",text:"Qun l ngn sch v phn cng cng vic cho cc nhm k thut."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:116,question:"Ngi i din pha khch hng trong d n c nhim v chnh l:",options:[{id:"A",text:"Theo di tin  ti chnh v ph duyt chi ph d n."},{id:"B",text:"Lin h, cung cp d liu v xc nhn cc ti liu k thut."},{id:"C",text:"Tham gia vit m ngun v kim th h thng phn mm."},{id:"D",text:"Gim st vic phn cng nhn s trong i ng pht trin."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:117,question:"Tnh cch quan trng ca ngi qun l d n l g?",options:[{id:"A",text:"Kin nhn, cn thn v ch o theo quy trnh chi tit."},{id:"B",text:"Tp trung tuyt i vo k thut v hn ch tng tc x hi."},{id:"C",text:"Bit giao tip, c t chc, bit lng nghe v c kh nng ra quyt nh."},{id:"D",text:"Cu ton, thch lm vic c lp v khng cn s h tr t ngi khc."}],correctAnswer:"C",chapter:10,chapterName:"QUN L NHN LC"},{id:118,question:"V sao truyn thng ng vai tr quan trng trong qun l d n?",options:[{id:"A",text:"V thng tin c chia s y  gip phi hp hiu qu v trnh sai lch."},{id:"B",text:"V truyn thng gip gim chi ph v rt ngn thi gian d n."},{id:"C",text:"V truyn thng gip kim sot cht lng k thut ca sn phm."},{id:"D",text:"V truyn thng gip xc nh vai tr ca cc thnh vin d n."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:119,question:"Qun l truyn thng trong d n bao gm cc qu trnh no?",options:[{id:"A",text:"Phn tch ri ro, iu phi ti nguyn v nh gi kt qu."},{id:"B",text:"Lp k hoch truyn thng, phn phi thng tin, bo co hiu sut v kt thc hnh chnh."},{id:"C",text:"Lp k hoch chi ph, bo co tin  v kim sot thay i."},{id:"D",text:"Phn cng nhn s, t chc hp v nh gi hiu qu cng vic."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:120,question:"K hoch qun l truyn thng l ti liu nhm:",options:[{id:"A",text:"M t yu cu k thut v quy trnh lp bo co ni b."},{id:"B",text:"Xc nh cch thc, ni dung v thi gian chia s thng tin trong d n."},{id:"C",text:"Ghi nhn ton b chi ph lin quan n truyn thng ni b."},{id:"D",text:"Tng hp kt qu d n v lp bo co sau khi hon thnh."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:121,question:"Phn tch cc bn lin quan trong k hoch truyn thng gip:",options:[{id:"A",text:"Xc nh chi ph lin lc v mc  tng tc gia cc b phn."},{id:"B",text:"Xy dng quy trnh gim st hot ng ca tng c nhn trong nhm."},{id:"C",text:"Xc nh nhu cu thng tin v hnh thc truyn t ph hp cho tng i tng."},{id:"D",text:"Xc nh ni dung o to v thi im hun luyn nhn vin mi."}],correctAnswer:"C",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:122,question:"Phn phi thng tin trong qun l truyn thng c ngha l:",options:[{id:"A",text:"Cung cp thng tin ng ngi, ng thi im v ng nh dng yu cu."},{id:"B",text:"Gi bo co nh k n lnh o cp cao  ph duyt ngn sch."},{id:"C",text:"To iu kin  cc bn tho lun v chnh sa yu cu d n."},{id:"D",text:"Tng hp d liu k thut v truyn t qua cc phng tin s."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:123,question:"Bo co hiu sut (Performance Reporting) c vai tr g trong d n?",options:[{id:"A",text:"Gip cc bn nm c tnh hnh s dng ti nguyn v tin  t c."},{id:"B",text:"Gip khch hng xem xt cc thay i trong thit k h thng phn mm."},{id:"C",text:"Gip i ng k thut kim tra li v iu chnh chng trnh."},{id:"D",text:"Gip nh qun l xc nh chi ph pht sinh trong tng giai on."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:124,question:"Giai on kt thc hnh chnh trong qun l truyn thng nhm mc ch:",options:[{id:"A",text:"Lu tr cc bo co ti chnh v h s k thut ca d n."},{id:"B",text:"To v lu h s chnh thc, chp nhn kt qu v rt ra bi hc kinh nghim."},{id:"C",text:"Gii quyt cc tranh chp hp ng v thanh ton cc khon chi ph."},{id:"D",text:"Cp nht d liu khch hng v thng tin phn mm sau trin khai."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:125,question:"Yu t no gip ci thin hiu qu truyn thng trong nhm d n?",options:[{id:"A",text:"Tng cng gim st  gim sai st khi truyn t thng tin."},{id:"B",text:"Lng nghe tch cc, phn hi kp thi v m bo thng tin hai chiu."},{id:"C",text:"Gii hn s lng knh lin lc  trnh trng lp d liu."},{id:"D",text:"Tp trung s dng vn bn thay v giao tip trc tip."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:126,question:" t chc cuc hp d n hiu qu, ngi ch tr cn:",options:[{id:"A",text:"M rng thi gian hp  mi ngi c pht biu  kin y ."},{id:"B",text:"Ch nh mt ngi ghi chp v mt ngi iu hnh  tit kim thi gian."},{id:"C",text:"Xc nh mc tiu, ni dung, ngi tham d v chun b ti liu trc khi hp."},{id:"D",text:"Tp trung tho lun chi tit k thut thay v cc vn  tng th."}],correctAnswer:"C",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:127,question:"Qun l ri ro trong d n bao gm my bc c bn?",options:[{id:"A",text:"Bn bc: d on, kh b, gim tc ng v kim sot khi xy ra."},{id:"B",text:"Ba bc: phn tch, nh gi v x l ri ro."},{id:"C",text:"Hai bc: xc nh v loi tr ri ro."},{id:"D",text:"Nm bc: phn tch, lp k hoch, theo di, nh gi v bo co."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:128,question:"Trong qun l ri ro, bc u tin cn thc hin l g?",options:[{id:"A",text:"Nhn din v d on cc tnh hung ri ro c th xy ra."},{id:"B",text:"Tnh ton chi ph  khc phc khi ri ro xy ra."},{id:"C",text:"Ln k hoch ti chnh  phng nga ri ro."},{id:"D",text:"nh gi thit hi sau khi ri ro  pht sinh."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:129,question:"Ri ro v nhn s trong d n thng xut pht t nguyn nhn no?",options:[{id:"A",text:"Nhn vin c k nng cao nhng thiu kinh nghim thc t."},{id:"B",text:"Nhn vin khng ph hp, thiu kinh nghim hoc thiu o to."},{id:"C",text:"Nhn vin lm vic qu nng sut dn n mt cn bng tin ."},{id:"D",text:"Nhn vin khng ng  lm thm gi v thiu ng lc."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:130,question:"Ri ro k thut trong d n CNTT thng lin quan n:",options:[{id:"A",text:"S thay i trong t chc hoc m hnh lm vic ca nhm."},{id:"B",text:"Vic la chn sai cng ngh, ngn ng lp trnh hoc phn cng."},{id:"C",text:"S chm tr trong ph duyt ti chnh v k hp ng."},{id:"D",text:"Vic thiu d liu u vo v thng tin v khch hng."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:131,question:"Trong qu trnh nh gi ri ro, hai yu t quan trng cn xem xt l g?",options:[{id:"A",text:"Tc ng v phm vi nh hng ca ri ro."},{id:"B",text:"Xc sut xy ra v mc  tc ng ca ri ro."},{id:"C",text:"Nguyn nhn hnh thnh v chi ph khc phc ri ro."},{id:"D",text:"Mc  quan tm ca lnh o v nhm k thut."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:132,question:"Khi khng th loi b ri ro, ngi qun l nn lm g?",options:[{id:"A",text:"Chuyn giao ri ro cho cc i tc hoc nh ti tr."},{id:"B",text:"Lp k hoch d phng  gim thiu tc ng khi ri ro xy ra."},{id:"C",text:"B qua ri ro  tp trung vo mc tiu chnh ca d n."},{id:"D",text:"Ko di tin  nhm trnh ri ro trong giai on hin ti."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:133,question:"Kh b ri ro trong qun l d n c ngha l g?",options:[{id:"A",text:"Loi tr nguyn nhn gy ri ro hoc thay i iu kin  ri ro khng xy ra."},{id:"B",text:"Gim bt nh hng ca ri ro bng cch phn chia cng vic nh hn."},{id:"C",text:"Chuyn ton b trch nhim cho b phn kim sot ni b."},{id:"D",text:"Gim thi gian thc hin  ri ro khng kp pht sinh."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:134,question:"Khi mt ri ro  xy ra, hnh ng u tin ca ngi qun l d n l g?",options:[{id:"A",text:"Bo co ngay cho cp trn v ch hng dn x l c th."},{id:"B",text:"nh gi mc  nh hng, kim sot tnh hnh v trin khai bin php ng ph."},{id:"C",text:"Tm dng ton b hot ng cho n khi c hng x l mi."},{id:"D",text:"Ct gim chi ph  b vo thit hi do ri ro gy ra."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:135,question:"Qun l tch hp d n c hiu l g?",options:[{id:"A",text:"L qu trnh qun l ti chnh, nhn s v truyn thng trong d n."},{id:"B",text:"L vic phi hp tt c cc lnh vc kin thc  m bo d n thng nht."},{id:"C",text:"L hot ng tng hp d liu, bo co v lu tr ti liu ca d n."},{id:"D",text:"L cng tc kt ni gia cc nh ti tr v i ng k thut trong d n."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:136,question:"Qun l tch hp d n gip nh qun l t c iu g?",options:[{id:"A",text:"Ti u ha hiu qu ca tng b phn ring bit trong d n."},{id:"B",text:"m bo cc quy trnh d n phi hp nhp nhng v ng b vi nhau."},{id:"C",text:"Gim thiu chi ph vn hnh v s lng nhn s trong nhm d n."},{id:"D",text:"Gii hn phm vi cng vic  rt ngn tin  d n."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:137,question:"Cc quy trnh chnh ca qun l tch hp bao gm:",options:[{id:"A",text:"Phn b ti nguyn, kim sot ri ro v kt thc d n."},{id:"B",text:"Pht trin k hoch, thc thi k hoch v iu khin thay i tch hp."},{id:"C",text:"Lp ngn sch, qun l thi gian v theo di tin  cng vic."},{id:"D",text:"nh gi hiu sut, kim tra cht lng v bn giao sn phm."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:138,question:"K hoch d n l ti liu nhm mc ch g?",options:[{id:"A",text:"M t chi tit cc chi ph, li nhun v ri ro ca d n."},{id:"B",text:"Hng dn thc thi d n v nh gi tnh trng thc hin so vi mc tiu."},{id:"C",text:"Ghi li danh sch nhn s, c cu t chc v quy trnh kim th."},{id:"D",text:"Thng k ti nguyn v thi gian s dng trong sut qu trnh lm vic."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:139,question:"Mt k hoch d n hiu qu cn c c im no sau y?",options:[{id:"A",text:"C nh, khng thay i trong sut vng i d n."},{id:"B",text:"Ch tp trung vo cc yu t k thut ca d n."},{id:"C",text:"Mang tnh linh hot, c th cp nht v iu chnh khi c thay i."},{id:"D",text:"Ch do gim c d n bin son m khng cn s tham gia ca nhm."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"},{id:140,question:"Thc thi k hoch d n (Project Execution) l giai on nhm:",options:[{id:"A",text:"nh gi cc ri ro v tnh ton chi ph cho ton b d n."},{id:"B",text:"Qun l v thc hin cc cng vic c m t trong k hoch d n."},{id:"C",text:"Lu tr d liu v lp bo co tng hp kt qu thc hin."},{id:"D",text:"Kim tra v nghim thu sn phm trc khi bn giao cho khch hng."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:141,question:"iu khin thay i tch hp (Integrated Change Control) c mc tiu l:",options:[{id:"A",text:"nh gi nng sut ca nhn vin trong qu trnh thc hin d n."},{id:"B",text:"To iu kin cho cc nhm t do thay i quy trnh khi cn thit."},{id:"C",text:"Phi hp v qun l mi thay i trong phm vi v mc tiu ca d n."},{id:"D",text:"Hn ch s tham gia ca cc bn lin quan khi thay i d n."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"},{id:142,question:"V sao qun l thay i tch hp li quan trng trong d n CNTT?",options:[{id:"A",text:"V khch hng thng xuyn thay i yu cu k thut trong qu trnh thc hin."},{id:"B",text:"V cc yu t phm vi, chi ph v thi gian lun c th b tc ng ln nhau."},{id:"C",text:"V nhm d n thng khng tun th quy trnh khi thay i nhim v."},{id:"D",text:"V vic thay i lun gip d n t kt qu nhanh v hiu qu hn."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:143,question:"Yu t ct li gip vic qun l tch hp d n thnh cng l g?",options:[{id:"A",text:"Cu trc t chc phc tp v h thng bo co a tng."},{id:"B",text:"S dng cc cng c phn mm tin tin  kim sot tin ."},{id:"C",text:"Duy tr giao tip hiu qu v s phi hp cht ch gia cc bn lin quan."},{id:"D",text:"Tp trung vo cc ch tiu ti chnh v li nhun ca d n."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"},{id:1e4,question:"Mnh  no sau y v ng gng trong s  mng l NG?",options:[{id:"A",text:"Cc cng vic trn ng gng cha ng nhiu ri ro nht trong d n."},{id:"B",text:"Cc cng vic trn ng gng khng c thi gian d tr."},{id:"C",text:"ng kt ni lin tc tnh t s kin u n s kin cui."},{id:"D",text:"ng gng l ng ngn nht trong s  mng."}],correctAnswer:"B",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10001,question:"Hy cho bit cng thc tnh  di thi gian thc hin cng vic?",options:[{id:"A",text:"CV) =EV-AC"},{id:"B",text:"CV =EV-AC"},{id:"C",text:"D=C x (G+J)"},{id:"D",text:"EV=PV* % thi gian hon thnh."}],correctAnswer:"C",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10002,question:"Giai on m bo cht lng l giai on no?",options:[{id:"A",text:"nh gi ton b vic thc hin d n  chc chn d n s tho mn nhng vn  lin quan ti tiu chun cht lng."},{id:"B",text:"Kim tra chi tit nhng kt qu d n  chc chn rng chng  tun th nhng tiu chun cht lng c lin quan."},{id:"C",text:"nh gi c th s dng  pht minh nhng sng kin ci tin cht lng."},{id:"D",text:"Nhn bit c tiu chun cht lng no c lin quan ti d n."}],correctAnswer:"A",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10003,question:"B ba rng buc trong qun l d n l g?",options:[{id:"A",text:"Khi to, lp k hoch, trin khai."},{id:"B",text:"Phm vi, thi gian, chi ph."},{id:"C",text:"Thng k, Kim sot, Tng hp."},{id:"D",text:"T chc, phn tch, lp lch."}],correctAnswer:"B",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10004,question:"WBS (Work breakdown structure) l g?",options:[{id:"A",text:"Trnh by k hoch tin , m t di dng s  quan h lin tc gia cc cng vic."},{id:"B",text:"Nhn t tri thc v cng vic ang xt trong d n."},{id:"C",text:"Quy trnh yu cu m bo cho d n c hon tt trong s cho php ca ngn sch."},{id:"D",text:"Mt danh sch chi tit cc bc cn  hon thnh mt d n."}],correctAnswer:"D",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10005,question:"Mnh  no sau y v biu  GANTT l SAI?",options:[{id:"A",text:"Phn nh mi quan h gia cc cng vic."},{id:"B",text:"Cho bit tin trnh cha ng nhiu ri ro nht trong d n."},{id:"C",text:"D v, d nhn bit tin trnh thc t ca tng cng vic."},{id:"D",text:"Cho bit  di thi gian thc hin tng cng vic v ton b d n."}],correctAnswer:"B",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10006,question:"Hy cho bit cng thc tnh chi ph pht sinh CV (Cost Variance)?",options:[{id:"A",text:"EV - AC"},{id:"B",text:"EV - PV"},{id:"C",text:"EV / PV"},{id:"D",text:"EV / AC"}],correctAnswer:"A",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10007,question:"Mt giai on trong qui trnh qun l d n m Yu cu thit lp phm vi cng vic ca d n, iu chnh li mc tiu v xc nh ng i ti mc tiu ., c gi l giai on no?",options:[{id:"A",text:"Trin khai."},{id:"B",text:"Gim st v kim sot."},{id:"C",text:"Kt thc."},{id:"D",text:"Lp k hoch d n."}],correctAnswer:"D",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10008,question:"Cng thc  di thi gian thc hin cng vic: D=C x (G+J). Vy k hiu C c  ngha g?",options:[{id:"A",text:"Nhn t tri thc v cng vic ang xt."},{id:"B",text:"Nhn t kinh nghim."},{id:"C",text:"Nhn t  phc tp."},{id:"D",text:"Gi tr tr tnh."}],correctAnswer:"C",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10009,question:" c lng d n, cng thc D=C x (G+J). Vy k hiu D c  ngha g:",options:[{id:"A",text:"Gi tr tr tnh."},{id:"B",text:" di thi gian thc hin cng vic."},{id:"C",text:"Nhn t  phc tp."},{id:"D",text:"Nhn t tri thc v cng vic ang xt."}],correctAnswer:"B",chapter:100,chapterName:"EX 1 -  LUYN TP",isEx:!0},{id:10010,question:"Mt giai on trong qui trnh qun l d n m Thc hin hon thnh cc cng vic c xc nh trong phn lp k hoch  m bo cc yu cu ca d n., c gi l giai on no?",options:[{id:"A",text:"Kt thc."},{id:"B",text:"Lp k hoch d n."},{id:"C",text:"Gim st v kim sot."},{id:"D",text:"Trin khai."}],correctAnswer:"D",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10011,question:"Hy cho bit cng thc tnh bin ng lch SV (Schedule Variance)?",options:[{id:"A",text:"BAC / CPI"},{id:"B",text:"EV / AC"},{id:"C",text:"EV - PV"},{id:"D",text:"EV / PV"}],correctAnswer:"C",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10012,question:"Mt giai on trong qui trnh qun l d n m thc hin  kt thc tt c cc hot ng ca d n  chnh thc ng li d n., c gi l giai on no?",options:[{id:"A",text:"Lp k hoch d n."},{id:"B",text:"Kt thc."},{id:"C",text:"Trin khai."},{id:"D",text:"Gim st v kim sot."}],correctAnswer:"B",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10013,question:"D n phn mm cn thc hin cc bc no?",options:[{id:"A",text:"Tng th cng vic lp i, lp li."},{id:"B",text:"Xc nh yu cu chung; Vit d n"},{id:"C",text:"Ch thc hin mt bc l Trin khai."},{id:"D",text:"Tiu chun ha m hnh cht lng theo ISO (International Standart Organisation)."}],correctAnswer:"B",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10014,question:"ISO (International Standart Organisation) ngha l g?",options:[{id:"A",text:"Qui trnh qun l cht lng."},{id:"B",text:"T chc quc t v tiu chun ho."},{id:"C",text:"Thc o cng vic thc hin th hin bng ngn sch."},{id:"D",text:"K thut o lng s thc hin d n."}],correctAnswer:"B",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10015,question:"Theo thng k chung trn th gii, 33% cc d n tht bi v l do g?",options:[{id:"A",text:"Ngi qun l d n khng phn cng r nhim v ca tng ngi."},{id:"B",text:"Thiu hoc khng hiu r cc cng c h tr cho vic pht trin h thng cng nh cho vic qun l - theo di d n."},{id:"C",text:"D n c th mc sai lm trong giai on phn tch v thit k."},{id:"D",text:"Cng ngh  b thay i qu nhiu so vi hiu qu m d n s mang li."}],correctAnswer:"D",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10016,question:"Qun l d n l g?",options:[{id:"A",text:"Mt qu trnh gm nhiu cng vic c thc hin m c tnh lp i lp li, lin tc."},{id:"B",text:"Mt qu trnh gm nhiu cng vic, nhim v c lin quan vi nhau, c thc hin nhm t mc tiu   ra, trong iu kin rng but v thi gian, phm vi v chi ph."},{id:"C",text:"N lc ngn hn trong vi tun, hoc vi thng c thc hin bi mt t chc no ."},{id:"D",text:"Mt k hoch di hn, tng hp, c thc hin trn mt phm vi khng gian rng ln, thi gian di khng xc nh."}],correctAnswer:"B",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10017,question:"Lp k hoch cht lng l giai on no sau y?",options:[{id:"A",text:"Nhn bit c tiu chun cht lng c lin quan ti d n."},{id:"B",text:"nh gi ton b vic thc hin d n  chc chn d n s tho mn nhng vn  lin quan ti tiu chun cht lng."},{id:"C",text:"Kim tra chi tit nhng kt qu d n."},{id:"D",text:"nh gi c th s dng  pht minh nhng sng kin ci tin cht lng."}],correctAnswer:"A",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10018,question:"Nguyn l no KHNG l nguyn l c bn to WBS (Work breakdown structure)?",options:[{id:"A",text:"Mt mc WBS l nhim v ca ch mt ngi, ngay c khi c nhiu ngi thc hin cng vic ny."},{id:"B",text:"Nhng quy trnh yu cu m bo cho d n c hon tt trong s cho php ca ngn sch."},{id:"C",text:"Mt n v cng vic ch xut hin mt ni trong WBS."},{id:"D",text:"Ni dung cng vic trong mt mc WBS bng tng cc cng vic di n."}],correctAnswer:"B",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10019,question:"Qui trnh qun l cht lng bao gm cc giai on no?",options:[{id:"A",text:"Lp k hoch d n; Trin khai; Kt thc"},{id:"B",text:"Khi to d n; Lp k hoch d n; Trin khai; Gim st v kim sot; Kt thc"},{id:"C",text:"Lp k hoch; m bo; Kim tra"},{id:"D",text:"Lp k hoch d n; Trin khai; Kt thc"}],correctAnswer:"C",chapter:101,chapterName:"EX 2 -  LUYN TP",isEx:!0},{id:10020,question:"Th ni hay  chng trong s  mng cng vic l g?",options:[{id:"A",text:"Mt khong thi gian m cc hot ng  c th trt m vn khng nh hng ti ng gng."},{id:"B",text:"Khong thi gian th ni m mt hot ng c trc khi n nh hng ti bt k hot ng no khc (khng gng)."},{id:"C",text:"Trnh by k hoch tin , m t di dng s  mi quan h lin tc gia cc cng vic."},{id:"D",text:"Cho bit tin trnh cha ng nhiu ri ro nht trong d n."}],correctAnswer:"D",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10021,question:"Trong qun l d n phn mm vic lp k hoch thc hin d n l cng vic g?",options:[{id:"A",text:"Hot ng din ra ch trong qu trnh giao sn phm."},{id:"B",text:"Hot ng din ra ch trong qu trnh khi to d n."},{id:"C",text:"Hot ng din ra trong sut qu trnh t khi bt u thc hin d n n khi bn giao sn phm vi nhiu loi."},{id:"D",text:"Hot ng din ra ch trong qu trnh h tr k hoch chnh ca d n."}],correctAnswer:"C",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10022,question:"Ngy nghim thu d n, ngy bn giao d n l ni dung ti liu m t  n v ni dung no?",options:[{id:"A",text:"Rng buc thi gian thc hin d n ."},{id:"B",text:"Rng buc cng ngh pht trin."},{id:"C",text:"Rng buc kinh ph."},{id:"D",text:"Ch k cc bn lin quan ti d n."}],correctAnswer:"A",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10023,question:"Gim c d n c vai tr g trong d n?",options:[{id:"A",text:"Qun l cc hot ng bn trong d n."},{id:"B",text:"Nhn c thit k mc trung  tin hnh thit k chi tit."},{id:"C",text:"Son tho ti liu hoc cung cp d liu  th nghim."},{id:"D",text:"Lin h gia d n vi bn ngoi."}],correctAnswer:"D",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10024,question:"Nhng ngi lin quan ti d n, cc hot ng nghip v cn tin hc ha l ni dung ti liu m t  n v ni dung no?",options:[{id:"A",text:"Ngun nhn lc tham gia d n."},{id:"B",text:"Rng buc kinh ph."},{id:"C",text:"Rng buc thi gian thc hin d n."},{id:"D",text:"Phm vi d n ca mt d n."}],correctAnswer:"D",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10025,question:"Trnh t no sau y theo ng Qui trnh qun l d n?",options:[{id:"A",text:"Khi to D n -> Lp k hoch d n -> (Kim tra & gim st) <-> Trin khai d n -> Kt thc d n."},{id:"B",text:"Khi to D n -> (Kim tra & gim st) <-> Lp k hoch d n -> Trin khai d n -> Kt thc d n."},{id:"C",text:"Khi to D n -> Trin khai d n -> (Kim tra & gim st) <-> Lp k hoch d n -> Kt thc d n."},{id:"D",text:"Khi to D -> Lp k hoch d n -> Kt thc d n ->(Kim tra & gim st) <-> Trin khai d n."}],correctAnswer:"A",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10026,question:"Trong cng c h tr kim tra chi ph, BAC (Budget At Completion) l g?",options:[{id:"A",text:"Chi ph thc s ca cng vic c thc hin."},{id:"B",text:"K thut o lng s thc hin d n thng qua tch hp cc d liu v chi ph."},{id:"C",text:"Tng ngn sch chi ph cng vic  ln lch ti thi im hon thnh."},{id:"D",text:"Chi ph ngn sch cho vic tin hnh cng vic."}],correctAnswer:"C",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10027,question:"Qui trnh no  qun l chi ph d n?",options:[{id:"A",text:"Tng kt v tt c cc sn phm trung gian ca d n."},{id:"B",text:"Nhn bit iu g c th dn n sai st v vn trong kim sot khi c iu trc trc."},{id:"C",text:"Lp k hoch cho ngun ti nguyn."},{id:"D",text:"Cn bng c cc yu cu cnh tranh trong d n."}],correctAnswer:"C",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10028,question:"Cn c php l  thc hin d n, hin trng cng ngh thng tin ca khch hng trc khi c d n, nhu cu ng dng phn mm ca khch hng, c im v phm vi ca phn mm s xy dng l ni dung ti liu m t  n v vn  g?",options:[{id:"A",text:"Ngun nhn lc tham gia d n."},{id:"B",text:"Bi cnh thc hin d n."},{id:"C",text:"Phm vi d n ca mt d n."},{id:"D",text:"Mc ch v mc tiu ca d n."}],correctAnswer:"B",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10029,question:"Phm vi d n l g?",options:[{id:"A",text:"K thut nh gi v xem xt chng trnh."},{id:"B",text:"Mt danh sch tt c nhng g d n phi lm."},{id:"C",text:"Quy trnh yu cu m bo cho d n hon tt trong s cho php ca ngn sch."},{id:"D",text:"Nhng qui trnh bo m hon tt d n ng hn."}],correctAnswer:"D",chapter:102,chapterName:"EX 3 -  LUYN TP",isEx:!0},{id:10030,question:"Tuyn b no l thnh phn chnh trong bn tuyn b phm vi?",options:[{id:"A",text:"Khng bao gi yu cu mt ngi khng c kinh nghim lm c lng."},{id:"B",text:"Quy trnh yu cu m bo cho d n hon tt trong s cho php ca ngn sch."},{id:"C",text:"Mt danh sch tt c nhng g d n phi lm."},{id:"D",text:"Tuyn b v nhng yu t xc nh thnh cng ca d n."}],correctAnswer:"D",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10031,question:"Theo thng k chung trn th gii, c cc nguyn nhn dn n 33% cc d n b hu, NGOI TR nguyn nhn no?",options:[{id:"A",text:"Ngi qun l d n khng phn cng r nhim v ca tng ngi."},{id:"B",text:"Vt qua gii hn v thi gian hoc kinh ph."},{id:"C",text:"Ngi dng hoc khch hng khng cn ti n na."},{id:"D",text:"Cng ngh  b thay i qu nhiu so vi hiu qu m d n s mang li."}],correctAnswer:"A",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10032,question:"Mnh  no l NG v ng gng trong s  mng cng vic?",options:[{id:"A",text:"L ng ni cc s kin gng."},{id:"B",text:"Cc cng vic trn ng gng cha ng nhiu ri ro nht trong d n."},{id:"C",text:"ng gng l ng ngn nht trong s  mng."},{id:"D",text:"ng kt ni lin tc tnh t s kin u n s kin cui."}],correctAnswer:"A",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10033,question:"Cng thc  di thi gian thc hin cng vic: D=C x (G+J). Vy k hiu J c  ngha g?",options:[{id:"A",text:"Nhn t tri thc v cng vic ang xt."},{id:"B",text:"Gi tr tr tnh."},{id:"C",text:"Bin ng lch."},{id:"D",text:"Nhn t kinh nghim."}],correctAnswer:"A",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10034,question:"Nguyn l no sau y KHNG phi l nguyn l to ra WBS (Work breakdown structure)?",options:[{id:"A",text:"Trnh by k hoch tin , m t di dng s  mi quan h lin tc gia cc cng vic."},{id:"B",text:"WBS phi nht qun vi cch thc hin cng vic; trc ht n phi phc v nhm d n v cc mc ch khc nu thc t cho php."},{id:"C",text:"Mi mc WBS phi c ti liu i km  bo m hiu c chnh xc phm vi cng vic."},{id:"D",text:"Cc thnh vin nhm d n phi tham gia pht trin WBS  bo m tnh nht qun."}],correctAnswer:"A",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10035,question:"S ng gng c trong s  mng nh th no?",options:[{id:"A",text:"Mc nh l mt gng."},{id:"B",text:"Trn hai ng gng."},{id:"C",text:"Mc nh l hai ng gng"},{id:"D",text:"Mt ng gng hoc nhiu hn."}],correctAnswer:"D",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10036,question:"Trong cng c h tr kim tra chi ph, PV (Planned Value) gi l Gi tr tr tnh, vy gi tr tr tnh l g?",options:[{id:"A",text:"Chi ph ngn sch cho vic tin hnh cng vic."},{id:"B",text:"Ngn sch chi ph cng vic  ln lch."},{id:"C",text:"Chi ph thc s ca cng vic c thc hin."},{id:"D",text:"K thut o lng s thc hin d n thng qua tch hp cc d liu v chi ph."}],correctAnswer:"B",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10037,question:"WBS (Work breakdown structure) l cng c hu ch g cho nh qun l d n?",options:[{id:"A",text:"Tin hnh c tnh chi ph."},{id:"B",text:"Xc nh s bt u ca cng vic."},{id:"C",text:"Xc nh thi gian d tr ca cc cng vic."},{id:"D",text:"Xc nh cc cng vic c th ca d n."}],correctAnswer:"D",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10038,question:"Mt giai on trong qui trnh qun l d n m thc hin  kt thc tt c cc hot ng ca d n  chnh thc ng li d n., c gi l giai on no?",options:[{id:"A",text:"Gim st v kim sot."},{id:"B",text:"Kt thc."},{id:"C",text:"Lp k hoch d n."},{id:"D",text:"Trin khai."}],correctAnswer:"B",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10039,question:"Yu t no KHNG thuc c trng b ba rng buc trong qun l d n?",options:[{id:"A",text:"Cht lng (ISO)"},{id:"B",text:"Thi gian (Time)"},{id:"C",text:"Chi ph (Cost)"},{id:"D",text:"Phm vi (Scope)"}],correctAnswer:"A",chapter:103,chapterName:"EX 4 -  LUYN TP",isEx:!0},{id:10040,question:"Trong cng c h tr kim tra chi ph, EV (Earned Value) gi l Gi tr thu c, vy gi tr thu c l g?",options:[{id:"A",text:"Ngn sch chi ph cng vic  ln lch."},{id:"B",text:"Chi ph ngn sch cho vic tin hnh cng vic."},{id:"C",text:"K thut o lng s thc hin d n thng qua tch hp cc d liu v chi ph."},{id:"D",text:"Tng cng cc chi ph trc tip hay gin tip trong vic hon tt cng vic trong mt giai on nh trc."}],correctAnswer:"B",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10041,question:"Hy cho bit cng thc tnh chi ph thc s AC (Actual Cost)?",options:[{id:"A",text:"EV - PV"},{id:"B",text:"EV - CV"},{id:"C",text:"EV / AC"},{id:"D",text:"EV / PV"}],correctAnswer:"B",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10042,question:"Chi ph trong qun l d n l g?",options:[{id:"A",text:"Nhng qui trnh bo m hon tt d n ng hn."},{id:"B",text:"Nhng kt qu ca d n m s chuyn giao."},{id:"C",text:"Mt danh sch tt c nhng g d n phi lm."},{id:"D",text:"Ti nguyn c hy sinh hay tnh trc  t c mt mc tiu r rng hay  trao i ci g , c o bng n v tin t."}],correctAnswer:"D",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10043,question:"Theo thng k chung trn th gii, c 50% - 100% cc d n b hy nguyn nhn bi?",options:[{id:"A",text:"D n c th mc sai lm trong giai on phn tch v thit k."},{id:"B",text:"Mt d n m ko di qu 50% thi gian d nh."},{id:"C",text:"Cng ngh  b thay i qu nhiu so vi hiu qu m d n s mang li."},{id:"D",text:"Ngi qun l d n khng phn cng r nhim v ca tng ngi."}],correctAnswer:"B",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10044,question:"Cng vic: m t cc phng php, ngun lc, lch trnh thm nh h thng, l loi k hoch no?",options:[{id:"A",text:"K hoch thm nh."},{id:"B",text:"K hoch pht trin i ng."},{id:"C",text:"K hoch qun l cu hnh."},{id:"D",text:"K hoch bo tr."}],correctAnswer:"A",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10045,question:" qun l chi ph d n, cn qui trnh no?",options:[{id:"A",text:"Tng kt v tt c cc sn phm trung gian ca d n."},{id:"B",text:"Cn bng c cc yu cu cnh tranh trong d n."},{id:"C",text:"Nhn bit iu g c th dn n sai st."},{id:"D",text:"Kim sot  iu chnh chi ph: iu chnh thay i chi ph d n"}],correctAnswer:"D",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10046,question:"Trong qun l cht lng c Chi ph ngn nga, ngha l g?",options:[{id:"A",text:"Chi ph lin quan n tt c li khng c nhn ra trc khi a n cho khch hng."},{id:"B",text:"Chi ph nh gi qu trnh v sn phm a ra t cht lng."},{id:"C",text:"Chi ph d tnh v thc thi d n c th l khng li hay li c th chp nhn c."},{id:"D",text:"Chi ph dng  ch nh chnh xc thiu xt c nh ra trc khi khch hng nhn c sn phm."}],correctAnswer:"C",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10047,question:"Theo thng k chung trn th gii, c 33% cc d n b hu bi nguyn nhn?",options:[{id:"A",text:"D n c th mc sai lm trong giai on phn tch v thit k."},{id:"B",text:"Ngi qun l d n khng phn cng r nhim v ca tng ngi."},{id:"C",text:"Vt qua gii hn v thi gian hoc kinh ph."},{id:"D",text:"Thiu hoc khng hiu r cc cng c h tr cho vic pht trin h thng."}],correctAnswer:"C",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10048,question:"Mt s k thut v cng c trong giai on Kim tra cht lng d n bao gm:",options:[{id:"A",text:"phn tch Pareto, mu thng k,  lch chun."},{id:"B",text:"s  mng, EMV (Earned value management)."},{id:"C",text:"biu  GANTT, s  mng."},{id:"D",text:"EMV (Earned value management). biu  GANTT."}],correctAnswer:"A",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10049,question:"Nguyn tc 80-20 thuc k thut hay cng c no sau y?",options:[{id:"A",text:"EMV (Earned value management)."},{id:"B",text:"Phn tch Pareto."},{id:"C",text:"PERT (Program Evaluation and Review Technique)."},{id:"D",text:"ISO (International Organization for Standardization)."}],correctAnswer:"B",chapter:104,chapterName:"EX 5 -  LUYN TP",isEx:!0},{id:10050,question:"Mc tiu ca d n l g?",options:[{id:"A",text:"Theo di, r sot v iu chnh li tin  v kh nng thc hin ca d n"},{id:"B",text:"Mt qu trnh gm nhiu cng vic, nhim v c lin quan vi nhau, c thc hin nhm t mc tiu   ra."},{id:"C",text:"Gii quyt c nhng yu cu c t ra trong thc t khi bt u d n."},{id:"D",text:"Mt danh sch tt c nhng g d n phi lm (v cng c th l khng phi lm)."}],correctAnswer:"D",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10051,question:"D on ri ro, ngha l g?",options:[{id:"A",text:"Bo m cc chin lc i ph ri ro c ln k hoch."},{id:"B",text:"Chn la chin lc v phng php i ph ri ro."},{id:"C",text:"Xc nh v chn ra nhng ri ro quan trng cn gii quyt."},{id:"D",text:"Nhn bit iu g c th dn n sai st."}],correctAnswer:"D",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10052,question:"Loi d n no thuc v Xy dng c s h tng cng ngh thng tin (CNTT)?",options:[{id:"A",text:"Pht trin h thng mng t 4G ln 5G."},{id:"B",text:"Xy dng Khu Cng ngh Phn mm ti Thnh ph ABC."},{id:"C",text:"Xy dng c s d liu v cn cc cng dn."},{id:"D",text:"Xy dng c s d liu v cn cc cng dn"}],correctAnswer:"A",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10053,question:"S  mng PERT (Program Evaluation and Review Technique), l g?",options:[{id:"A",text:"Nhng qui trnh bo m hon tt d n ng hn."},{id:"B",text:"Nhng quy trnh yu cu m bo cho d n."},{id:"C",text:"K thut nh gi v xem xt chng trnh."},{id:"D",text:"Mt danh sch tt c nhng g d n phi lm."}],correctAnswer:"C",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10054,question:"Kinh ph trong tng giai on thc hin d n l ni dung ti liu m t  n v ni dung no?",options:[{id:"A",text:"Rng buc kinh ph."},{id:"B",text:"Ngun nhn lc tham gia d n."},{id:"C",text:"Rng buc cng ngh pht trin."},{id:"D",text:"Ch k cc bn lin quan ti d n."}],correctAnswer:"A",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10055,question:"Th ni ton b trong s  mng cng vic l g?",options:[{id:"A",text:"Nhim v khng c tnh lp li, lin tc m c tnh cht mi m."},{id:"B",text:"Qung thi gian th ni m mt hot ng c trc khi nh hng ti ng gng"},{id:"C",text:"Trnh by k hoch tin , m t di dng s  mi quan h lin tc gia cc cng vic."},{id:"D",text:"Khong thi gian th ni m mt hot ng c trc khi n nh hng ti bt k hot ng no khc."}],correctAnswer:"B",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10056,question:"Trong qun l chi ph d n, qui trnh no  qun l chi ph?",options:[{id:"A",text:"Nhn bit iu g c th dn n sai st v vn trong kim sot khi c iu trc trc."},{id:"B",text:"Cn bng c cc yu cu cnh tranh trong d n."},{id:"C",text:"Tng kt v tt c cc sn phm trung gian ca d n."},{id:"D",text:"D ton chi ph: phn b ton b chi ph c tnh vo tng hng mc cng vic  thit lp mt ng mc cho vic o lng vic thc hin"}],correctAnswer:"D",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10057,question:"Thnh phn no KHNG phi l thnh phn chnh ca bn tuyn b phm vi?",options:[{id:"A",text:"M t ngn v sn phm ca d n."},{id:"B",text:"Tuyn b v nhng yu t xc nh thnh cng ca d n,"},{id:"C",text:"Tng kt v tt c cc sn phm trung gian ca d n."},{id:"D",text:"Khng bao gi yu cu mt ngi khng c kinh nghim lm c lng."}],correctAnswer:"D",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10058,question:"Vai tr ca Ph gim c k thut d n l g?",options:[{id:"A",text:"Qun l cc hot ng bn trong d n."},{id:"B",text:"Nhn c thit k mc trung  tin hnh thit k chi tit."},{id:"C",text:"Son tho ti liu hoc cung cp d liu  th nghim."},{id:"D",text:"Lin h gia d n vi bn ngoi."}],correctAnswer:"A",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0},{id:10059,question:"Biu  GANTT c nhiu tc dng, TR trng hp no sau y?",options:[{id:"A",text:"D v, d nhn bit tin trnh thc t ca tng cng vic."},{id:"B",text:"Khng phn nh mi quan h gia cc cng vic."},{id:"C",text:"Phn nh chnh xc mi quan h gia cc cng vic ca d n phc tp"},{id:"D",text:"Cho bit  di thi gian thc hin tng cng vic v ton b d n."}],correctAnswer:"C",chapter:105,chapterName:"EX 6 -  LUYN TP",isEx:!0}],fx={chapters:kG,questions:NG};function nh(e){const t=[...e];for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t}const ds=Bu((e,t)=>({chapters:[],questions:[],currentChapter:null,currentQuestions:[],currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"chapter",timeLimit:null,maxWrong:null,loadQuiz:()=>{const n=fx;e({chapters:n.chapters,questions:n.questions})},selectChapter:n=>{const{questions:i}=t(),r=nh(i.filter(s=>s.chapter===n));e({currentChapter:n,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"chapter",timeLimit:null,maxWrong:null})},startRandomQuiz:(n=20)=>{const{questions:i}=t(),r=nh(i).slice(0,n);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"random",timeLimit:null,maxWrong:null})},startAllQuiz:()=>{const{questions:n}=t();e({currentChapter:null,currentQuestions:nh(n),currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"all",timeLimit:null,maxWrong:null})},startTimeAttack:n=>{const{questions:i}=t(),r=nh(i).slice(0,10);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"timeattack",timeLimit:n,maxWrong:null})},startSurvival:n=>{const{questions:i}=t(),r=nh(i).slice(0,10);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"survival",timeLimit:null,maxWrong:n})},selectAnswer:n=>{const{isAnswered:i,currentQuestions:r,currentIndex:s}=t();if(i)return;const o=r[s],a=n===o.correctAnswer;e(c=>({selectedAnswer:n,isAnswered:!0,score:c.score+(a?10:0),correctCount:c.correctCount+(a?1:0),wrongCount:c.wrongCount+(a?0:1)}))},nextQuestion:()=>{e(n=>({currentIndex:n.currentIndex+1,selectedAnswer:null,isAnswered:!1}))},resetQuiz:()=>{e({currentChapter:null,currentQuestions:[],currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0})},getChapterQuestions:n=>{const{questions:i}=t();return i.filter(r=>r.chapter===n)}})),EG=()=>{};var gk={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut=function(e,t){if(!e)throw vl(t)},vl=function(e){return new Error("Firebase Database ("+ZP.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},SG=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=e[n++],o=e[n++],a=e[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},B_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const s=e[r],o=r+1<e.length,a=o?e[r+1]:0,c=r+2<e.length,h=c?e[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let f=(a&15)<<2|h>>6,v=h&63;c||(v=64,o||(f=64)),i.push(n[u],n[d],n[f],n[v])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(tM(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):SG(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const s=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const h=r<e.length?n[e.charAt(r)]:64;++r;const d=r<e.length?n[e.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new IG;const f=s<<2|a>>4;if(i.push(f),h!==64){const v=a<<4&240|h>>2;if(i.push(v),d!==64){const y=h<<6&192|d;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class IG extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eM=function(e){const t=tM(e);return B_.encodeByteArray(t,!0)},mf=function(e){return eM(e).replace(/\./g,"")},pf=function(e){try{return B_.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AG(e){return nM(void 0,e)}function nM(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!RG(n)||(e[n]=nM(e[n],t[n]));return e}function RG(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MG=()=>PG().__FIREBASE_DEFAULTS__,DG=()=>{if(typeof process>"u"||typeof gk>"u")return;const e=gk.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},LG=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&pf(e[1]);return t&&JSON.parse(t)},Em=()=>{try{return EG()||MG()||DG()||LG()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},iM=e=>{var t,n;return(n=(t=Em())==null?void 0:t.emulatorHosts)==null?void 0:n[e]},G_=e=>{const t=iM(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},rM=()=>{var e;return(e=Em())==null?void 0:e.config},sM=e=>{var t;return(t=Em())==null?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sm(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[mf(JSON.stringify(n)),mf(JSON.stringify(o)),""].join(".")}const Rh={};function VG(){const e={prod:[],emulator:[]};for(const t of Object.keys(Rh))Rh[t]?e.emulator.push(t):e.prod.push(t);return e}function qG(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let fk=!1;function Im(e,t){if(typeof window>"u"||typeof document>"u"||!Ds(window.location.host)||Rh[e]===t||Rh[e]||fk)return;Rh[e]=t;function n(f){return`__firebase__banner__${f}`}const i="__firebase__banner",s=VG().prod.length>0;function o(){const f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,v){f.setAttribute("width","24"),f.setAttribute("id",v),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function h(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{fk=!0,o()},f}function u(f,v){f.setAttribute("id",v),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=qG(i),v=n("text"),y=document.getElementById(v)||document.createElement("span"),w=n("learnmore"),_=document.getElementById(w)||document.createElement("a"),x=n("preprendIcon"),C=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const k=f.element;a(k),u(_,w);const P=h();c(C,x),k.append(C,y,_,P),document.body.appendChild(k)}s?(y.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function z_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fn())}function jG(){var t;const e=(t=Em())==null?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FG(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oM(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function aM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UG(){const e=Fn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function OG(){return ZP.NODE_ADMIN===!0}function BG(){return!jG()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cM(){try{return typeof indexedDB=="object"}catch{return!1}}function lM(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;t(((s=r.error)==null?void 0:s.message)||"")}}catch(n){t(n)}})}function GG(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HG="FirebaseError";class Ji extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=HG,Object.setPrototypeOf(this,Ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Va.prototype.create)}}class Va{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?$G(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ji(r,a,i)}}function $G(e,t){return e.replace(zG,(n,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const zG=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(e){return JSON.parse(e)}function _n(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=gu(pf(s[0])||""),n=gu(pf(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:i,signature:r}},KG=function(e){const t=hM(e),n=t.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},WG=function(e){const t=hM(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xc(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function mx(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function vf(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function No(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const s=e[r],o=t[r];if(mk(s)&&mk(o)){if(!No(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function mk(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const i=this.W_;if(typeof t=="string")for(let d=0;d<16;d++)i[d]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],h,u;for(let d=0;d<80;d++){d<40?d<20?(h=a^s&(o^a),u=1518500249):(h=s^o^a,u=1859775393):d<60?(h=s&o|a&(s|o),u=2400959708):(h=s^o^a,u=3395469782);const f=(r<<5|r>>>27)+h+c+u+i[d]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(t,n){if(t==null)return;n===void 0&&(n=t.length);const i=n-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(t,r),r+=this.blockSize;if(typeof t=="string"){for(;r<n;)if(s[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=t[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const t=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)t[i]=this.chain_[r]>>s&255,++i;return t}}function YG(e,t){const n=new XG(e,t);return n.subscribe.bind(n)}class XG{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,i){let r;if(t===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");JG(t,["next","error","complete"])?r=t:r={next:t,error:n,complete:i},r.next===void 0&&(r.next=_v),r.error===void 0&&(r.error=_v),r.complete===void 0&&(r.complete=_v);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{n(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JG(e,t){if(typeof e!="object"||e===null)return!1;for(const n of t)if(n in e&&typeof e[n]=="function")return!0;return!1}function _v(){}function ZG(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,ut(i<e.length,"Surrogate pair missing trail surrogate.");const o=e.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},Am=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6=1e3,n6=2,i6=4*60*60*1e3,r6=.5;function pk(e,t=e6,n=n6){const i=t*Math.pow(n,e),r=Math.round(r6*i*(Math.random()-.5)*2);return Math.min(i6,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(e){return e&&e._delegate?e._delegate:e}class Ci{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new H_;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(t==null?void 0:t.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(a6(t))try{this.getOrInitializeService({instanceIdentifier:Zo})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=Zo){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Zo){return this.instances.has(t)}getOptions(t=Zo){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,n){const i=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(i)??new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:o6(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Zo){return this.component?this.component.multipleInstances?t:Zo:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o6(e){return e===Zo?void 0:e}function a6(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new s6(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ot;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ot||(Ot={}));const l6={debug:Ot.DEBUG,verbose:Ot.VERBOSE,info:Ot.INFO,warn:Ot.WARN,error:Ot.ERROR,silent:Ot.SILENT},h6=Ot.INFO,u6={[Ot.DEBUG]:"log",[Ot.VERBOSE]:"log",[Ot.INFO]:"info",[Ot.WARN]:"warn",[Ot.ERROR]:"error"},d6=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=u6[t];if(r)console[r](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Gu{constructor(t){this.name=t,this._logLevel=h6,this._logHandler=d6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ot))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?l6[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ot.DEBUG,...t),this._logHandler(this,Ot.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ot.VERBOSE,...t),this._logHandler(this,Ot.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ot.INFO,...t),this._logHandler(this,Ot.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ot.WARN,...t),this._logHandler(this,Ot.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ot.ERROR,...t),this._logHandler(this,Ot.ERROR,...t)}}const g6=(e,t)=>t.some(n=>e instanceof n);let vk,yk;function f6(){return vk||(vk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m6(){return yk||(yk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uM=new WeakMap,px=new WeakMap,dM=new WeakMap,wv=new WeakMap,K_=new WeakMap;function p6(e){const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(vo(e.result)),r()},o=()=>{i(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&uM.set(n,e)}).catch(()=>{}),K_.set(t,e),t}function v6(e){if(px.has(e))return;const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});px.set(e,t)}let vx={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return px.get(e);if(t==="objectStoreNames")return e.objectStoreNames||dM.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vo(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function y6(e){vx=e(vx)}function x6(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(bv(this),t,...n);return dM.set(i,t.sort?t.sort():[t]),vo(i)}:m6().includes(e)?function(...t){return e.apply(bv(this),t),vo(uM.get(this))}:function(...t){return vo(e.apply(bv(this),t))}}function _6(e){return typeof e=="function"?x6(e):(e instanceof IDBTransaction&&v6(e),g6(e,f6())?new Proxy(e,vx):e)}function vo(e){if(e instanceof IDBRequest)return p6(e);if(wv.has(e))return wv.get(e);const t=_6(e);return t!==e&&(wv.set(e,t),K_.set(t,e)),t}const bv=e=>K_.get(e);function gM(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=vo(o);return i&&o.addEventListener("upgradeneeded",c=>{i(vo(o.result),c.oldVersion,c.newVersion,vo(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const w6=["get","getKey","getAll","getAllKeys","count"],b6=["put","add","delete","clear"],Tv=new Map;function xk(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Tv.get(t))return Tv.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=b6.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||w6.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[n](...a),r&&c.done]))[0]};return Tv.set(t,s),s}y6(e=>({...e,get:(t,n,i)=>xk(t,n)||e.get(t,n,i),has:(t,n)=>!!xk(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(C6(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function C6(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const yx="@firebase/app",_k="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new Gu("@firebase/app"),k6="@firebase/app-compat",N6="@firebase/analytics-compat",E6="@firebase/analytics",S6="@firebase/app-check-compat",I6="@firebase/app-check",A6="@firebase/auth",R6="@firebase/auth-compat",P6="@firebase/database",M6="@firebase/data-connect",D6="@firebase/database-compat",L6="@firebase/functions",V6="@firebase/functions-compat",q6="@firebase/installations",j6="@firebase/installations-compat",F6="@firebase/messaging",U6="@firebase/messaging-compat",O6="@firebase/performance",B6="@firebase/performance-compat",G6="@firebase/remote-config",H6="@firebase/remote-config-compat",$6="@firebase/storage",z6="@firebase/storage-compat",K6="@firebase/firestore",W6="@firebase/ai",Q6="@firebase/firestore-compat",Y6="firebase",X6="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="[DEFAULT]",J6={[yx]:"fire-core",[k6]:"fire-core-compat",[E6]:"fire-analytics",[N6]:"fire-analytics-compat",[I6]:"fire-app-check",[S6]:"fire-app-check-compat",[A6]:"fire-auth",[R6]:"fire-auth-compat",[P6]:"fire-rtdb",[M6]:"fire-data-connect",[D6]:"fire-rtdb-compat",[L6]:"fire-fn",[V6]:"fire-fn-compat",[q6]:"fire-iid",[j6]:"fire-iid-compat",[F6]:"fire-fcm",[U6]:"fire-fcm-compat",[O6]:"fire-perf",[B6]:"fire-perf-compat",[G6]:"fire-rc",[H6]:"fire-rc-compat",[$6]:"fire-gcs",[z6]:"fire-gcs-compat",[K6]:"fire-fst",[Q6]:"fire-fst-compat",[W6]:"fire-vertex","fire-js":"fire-js",[Y6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=new Map,Z6=new Map,_x=new Map;function wk(e,t){try{e.container.addComponent(t)}catch(n){Cs.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ki(e){const t=e.name;if(_x.has(t))return Cs.debug(`There were multiple attempts to register component ${t}.`),!1;_x.set(t,e);for(const n of yf.values())wk(n,e);for(const n of Z6.values())wk(n,e);return!0}function qa(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Mi(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tH={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yo=new Va("app","Firebase",tH);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eH{constructor(t,n,i){this._isDeleted=!1,this._options={...t},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ci("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw yo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo=X6;function fM(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i={name:xx,automaticDataCollectionEnabled:!0,...t},r=i.name;if(typeof r!="string"||!r)throw yo.create("bad-app-name",{appName:String(r)});if(n||(n=rM()),!n)throw yo.create("no-options");const s=yf.get(r);if(s){if(No(n,s.options)&&No(i,s.config))return s;throw yo.create("duplicate-app",{appName:r})}const o=new c6(r);for(const c of _x.values())o.addComponent(c);const a=new eH(n,i,o);return yf.set(r,a),a}function Rm(e=xx){const t=yf.get(e);if(!t&&e===xx&&rM())return fM();if(!t)throw yo.create("no-app",{appName:e});return t}function qn(e,t,n){let i=J6[e]??e;n&&(i+=`-${n}`);const r=i.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${t}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Cs.warn(o.join(" "));return}Ki(new Ci(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nH="firebase-heartbeat-database",iH=1,fu="firebase-heartbeat-store";let Cv=null;function mM(){return Cv||(Cv=gM(nH,iH,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(fu)}catch(n){console.warn(n)}}}}).catch(e=>{throw yo.create("idb-open",{originalErrorMessage:e.message})})),Cv}async function rH(e){try{const n=(await mM()).transaction(fu),i=await n.objectStore(fu).get(pM(e));return await n.done,i}catch(t){if(t instanceof Ji)Cs.warn(t.message);else{const n=yo.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(n.message)}}}async function bk(e,t){try{const i=(await mM()).transaction(fu,"readwrite");await i.objectStore(fu).put(t,pM(e)),await i.done}catch(n){if(n instanceof Ji)Cs.warn(n.message);else{const i=yo.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cs.warn(i.message)}}}function pM(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sH=1024,oH=30;class aH{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new lH(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Tk();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>oH){const o=hH(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Cs.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Tk(),{heartbeatsToSend:i,unsentEntries:r}=cH(this._heartbeatsCache.heartbeats),s=mf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Cs.warn(n),""}}}function Tk(){return new Date().toISOString().substring(0,10)}function cH(e,t=sH){const n=[];let i=e.slice();for(const r of e){const s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Ck(n)>t){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Ck(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class lH{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cM()?lM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await rH(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return bk(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return bk(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Ck(e){return mf(JSON.stringify({version:2,heartbeats:e})).length}function hH(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uH(e){Ki(new Ci("platform-logger",t=>new T6(t),"PRIVATE")),Ki(new Ci("heartbeat",t=>new aH(t),"PRIVATE")),qn(yx,_k,e),qn(yx,_k,"esm2020"),qn("fire-js","")}uH("");var kk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xo,vM;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(N,T){function E(){}E.prototype=T.prototype,N.F=T.prototype,N.prototype=new E,N.prototype.constructor=N,N.D=function(R,D,F){for(var L=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)L[lt-2]=arguments[lt];return T.prototype[D].apply(R,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(N,T,E){E||(E=0);const R=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)R[D]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(D=0;D<16;++D)R[D]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=N.g[0],E=N.g[1],D=N.g[2];let F=N.g[3],L;L=T+(F^E&(D^F))+R[0]+3614090360&4294967295,T=E+(L<<7&4294967295|L>>>25),L=F+(D^T&(E^D))+R[1]+3905402710&4294967295,F=T+(L<<12&4294967295|L>>>20),L=D+(E^F&(T^E))+R[2]+606105819&4294967295,D=F+(L<<17&4294967295|L>>>15),L=E+(T^D&(F^T))+R[3]+3250441966&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(F^E&(D^F))+R[4]+4118548399&4294967295,T=E+(L<<7&4294967295|L>>>25),L=F+(D^T&(E^D))+R[5]+1200080426&4294967295,F=T+(L<<12&4294967295|L>>>20),L=D+(E^F&(T^E))+R[6]+2821735955&4294967295,D=F+(L<<17&4294967295|L>>>15),L=E+(T^D&(F^T))+R[7]+4249261313&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(F^E&(D^F))+R[8]+1770035416&4294967295,T=E+(L<<7&4294967295|L>>>25),L=F+(D^T&(E^D))+R[9]+2336552879&4294967295,F=T+(L<<12&4294967295|L>>>20),L=D+(E^F&(T^E))+R[10]+4294925233&4294967295,D=F+(L<<17&4294967295|L>>>15),L=E+(T^D&(F^T))+R[11]+2304563134&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(F^E&(D^F))+R[12]+1804603682&4294967295,T=E+(L<<7&4294967295|L>>>25),L=F+(D^T&(E^D))+R[13]+4254626195&4294967295,F=T+(L<<12&4294967295|L>>>20),L=D+(E^F&(T^E))+R[14]+2792965006&4294967295,D=F+(L<<17&4294967295|L>>>15),L=E+(T^D&(F^T))+R[15]+1236535329&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(D^F&(E^D))+R[1]+4129170786&4294967295,T=E+(L<<5&4294967295|L>>>27),L=F+(E^D&(T^E))+R[6]+3225465664&4294967295,F=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(F^T))+R[11]+643717713&4294967295,D=F+(L<<14&4294967295|L>>>18),L=E+(F^T&(D^F))+R[0]+3921069994&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^F&(E^D))+R[5]+3593408605&4294967295,T=E+(L<<5&4294967295|L>>>27),L=F+(E^D&(T^E))+R[10]+38016083&4294967295,F=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(F^T))+R[15]+3634488961&4294967295,D=F+(L<<14&4294967295|L>>>18),L=E+(F^T&(D^F))+R[4]+3889429448&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^F&(E^D))+R[9]+568446438&4294967295,T=E+(L<<5&4294967295|L>>>27),L=F+(E^D&(T^E))+R[14]+3275163606&4294967295,F=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(F^T))+R[3]+4107603335&4294967295,D=F+(L<<14&4294967295|L>>>18),L=E+(F^T&(D^F))+R[8]+1163531501&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^F&(E^D))+R[13]+2850285829&4294967295,T=E+(L<<5&4294967295|L>>>27),L=F+(E^D&(T^E))+R[2]+4243563512&4294967295,F=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(F^T))+R[7]+1735328473&4294967295,D=F+(L<<14&4294967295|L>>>18),L=E+(F^T&(D^F))+R[12]+2368359562&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(E^D^F)+R[5]+4294588738&4294967295,T=E+(L<<4&4294967295|L>>>28),L=F+(T^E^D)+R[8]+2272392833&4294967295,F=T+(L<<11&4294967295|L>>>21),L=D+(F^T^E)+R[11]+1839030562&4294967295,D=F+(L<<16&4294967295|L>>>16),L=E+(D^F^T)+R[14]+4259657740&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^F)+R[1]+2763975236&4294967295,T=E+(L<<4&4294967295|L>>>28),L=F+(T^E^D)+R[4]+1272893353&4294967295,F=T+(L<<11&4294967295|L>>>21),L=D+(F^T^E)+R[7]+4139469664&4294967295,D=F+(L<<16&4294967295|L>>>16),L=E+(D^F^T)+R[10]+3200236656&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^F)+R[13]+681279174&4294967295,T=E+(L<<4&4294967295|L>>>28),L=F+(T^E^D)+R[0]+3936430074&4294967295,F=T+(L<<11&4294967295|L>>>21),L=D+(F^T^E)+R[3]+3572445317&4294967295,D=F+(L<<16&4294967295|L>>>16),L=E+(D^F^T)+R[6]+76029189&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^F)+R[9]+3654602809&4294967295,T=E+(L<<4&4294967295|L>>>28),L=F+(T^E^D)+R[12]+3873151461&4294967295,F=T+(L<<11&4294967295|L>>>21),L=D+(F^T^E)+R[15]+530742520&4294967295,D=F+(L<<16&4294967295|L>>>16),L=E+(D^F^T)+R[2]+3299628645&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(D^(E|~F))+R[0]+4096336452&4294967295,T=E+(L<<6&4294967295|L>>>26),L=F+(E^(T|~D))+R[7]+1126891415&4294967295,F=T+(L<<10&4294967295|L>>>22),L=D+(T^(F|~E))+R[14]+2878612391&4294967295,D=F+(L<<15&4294967295|L>>>17),L=E+(F^(D|~T))+R[5]+4237533241&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~F))+R[12]+1700485571&4294967295,T=E+(L<<6&4294967295|L>>>26),L=F+(E^(T|~D))+R[3]+2399980690&4294967295,F=T+(L<<10&4294967295|L>>>22),L=D+(T^(F|~E))+R[10]+4293915773&4294967295,D=F+(L<<15&4294967295|L>>>17),L=E+(F^(D|~T))+R[1]+2240044497&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~F))+R[8]+1873313359&4294967295,T=E+(L<<6&4294967295|L>>>26),L=F+(E^(T|~D))+R[15]+4264355552&4294967295,F=T+(L<<10&4294967295|L>>>22),L=D+(T^(F|~E))+R[6]+2734768916&4294967295,D=F+(L<<15&4294967295|L>>>17),L=E+(F^(D|~T))+R[13]+1309151649&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~F))+R[4]+4149444226&4294967295,T=E+(L<<6&4294967295|L>>>26),L=F+(E^(T|~D))+R[11]+3174756917&4294967295,F=T+(L<<10&4294967295|L>>>22),L=D+(T^(F|~E))+R[2]+718787259&4294967295,D=F+(L<<15&4294967295|L>>>17),L=E+(F^(D|~T))+R[9]+3951481745&4294967295,N.g[0]=N.g[0]+T&4294967295,N.g[1]=N.g[1]+(D+(L<<21&4294967295|L>>>11))&4294967295,N.g[2]=N.g[2]+D&4294967295,N.g[3]=N.g[3]+F&4294967295}i.prototype.v=function(N,T){T===void 0&&(T=N.length);const E=T-this.blockSize,R=this.C;let D=this.h,F=0;for(;F<T;){if(D==0)for(;F<=E;)r(this,N,F),F+=this.blockSize;if(typeof N=="string"){for(;F<T;)if(R[D++]=N.charCodeAt(F++),D==this.blockSize){r(this,R),D=0;break}}else for(;F<T;)if(R[D++]=N[F++],D==this.blockSize){r(this,R),D=0;break}}this.h=D,this.o+=T},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var T=1;T<N.length-8;++T)N[T]=0;T=this.o*8;for(var E=N.length-8;E<N.length;++E)N[E]=T&255,T/=256;for(this.v(N),N=Array(16),T=0,E=0;E<4;++E)for(let R=0;R<32;R+=8)N[T++]=this.g[E]>>>R&255;return N};function s(N,T){var E=a;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=T(N)}function o(N,T){this.h=T;const E=[];let R=!0;for(let D=N.length-1;D>=0;D--){const F=N[D]|0;R&&F==T||(E[D]=F,R=!1)}this.g=E}var a={};function c(N){return-128<=N&&N<128?s(N,function(T){return new o([T|0],T<0?-1:0)}):new o([N|0],N<0?-1:0)}function h(N){if(isNaN(N)||!isFinite(N))return d;if(N<0)return _(h(-N));const T=[];let E=1;for(let R=0;N>=E;R++)T[R]=N/E|0,E*=4294967296;return new o(T,0)}function u(N,T){if(N.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(N.charAt(0)=="-")return _(u(N.substring(1),T));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=h(Math.pow(T,8));let R=d;for(let F=0;F<N.length;F+=8){var D=Math.min(8,N.length-F);const L=parseInt(N.substring(F,F+D),T);D<8?(D=h(Math.pow(T,D)),R=R.j(D).add(h(L))):(R=R.j(E),R=R.add(h(L)))}return R}var d=c(0),f=c(1),v=c(16777216);e=o.prototype,e.m=function(){if(w(this))return-_(this).m();let N=0,T=1;for(let E=0;E<this.g.length;E++){const R=this.i(E);N+=(R>=0?R:4294967296+R)*T,T*=4294967296}return N},e.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(y(this))return"0";if(w(this))return"-"+_(this).toString(N);const T=h(Math.pow(N,6));var E=this;let R="";for(;;){const D=P(E,T).g;E=x(E,D.j(T));let F=((E.g.length>0?E.g[0]:E.h)>>>0).toString(N);if(E=D,y(E))return F+R;for(;F.length<6;)F="0"+F;R=F+R}},e.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function y(N){if(N.h!=0)return!1;for(let T=0;T<N.g.length;T++)if(N.g[T]!=0)return!1;return!0}function w(N){return N.h==-1}e.l=function(N){return N=x(this,N),w(N)?-1:y(N)?0:1};function _(N){const T=N.g.length,E=[];for(let R=0;R<T;R++)E[R]=~N.g[R];return new o(E,~N.h).add(f)}e.abs=function(){return w(this)?_(this):this},e.add=function(N){const T=Math.max(this.g.length,N.g.length),E=[];let R=0;for(let D=0;D<=T;D++){let F=R+(this.i(D)&65535)+(N.i(D)&65535),L=(F>>>16)+(this.i(D)>>>16)+(N.i(D)>>>16);R=L>>>16,F&=65535,L&=65535,E[D]=L<<16|F}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(N,T){return N.add(_(T))}e.j=function(N){if(y(this)||y(N))return d;if(w(this))return w(N)?_(this).j(_(N)):_(_(this).j(N));if(w(N))return _(this.j(_(N)));if(this.l(v)<0&&N.l(v)<0)return h(this.m()*N.m());const T=this.g.length+N.g.length,E=[];for(var R=0;R<2*T;R++)E[R]=0;for(R=0;R<this.g.length;R++)for(let D=0;D<N.g.length;D++){const F=this.i(R)>>>16,L=this.i(R)&65535,lt=N.i(D)>>>16,ht=N.i(D)&65535;E[2*R+2*D]+=L*ht,C(E,2*R+2*D),E[2*R+2*D+1]+=F*ht,C(E,2*R+2*D+1),E[2*R+2*D+1]+=L*lt,C(E,2*R+2*D+1),E[2*R+2*D+2]+=F*lt,C(E,2*R+2*D+2)}for(N=0;N<T;N++)E[N]=E[2*N+1]<<16|E[2*N];for(N=T;N<2*T;N++)E[N]=0;return new o(E,0)};function C(N,T){for(;(N[T]&65535)!=N[T];)N[T+1]+=N[T]>>>16,N[T]&=65535,T++}function k(N,T){this.g=N,this.h=T}function P(N,T){if(y(T))throw Error("division by zero");if(y(N))return new k(d,d);if(w(N))return T=P(_(N),T),new k(_(T.g),_(T.h));if(w(T))return T=P(N,_(T)),new k(_(T.g),T.h);if(N.g.length>30){if(w(N)||w(T))throw Error("slowDivide_ only works with positive integers.");for(var E=f,R=T;R.l(N)<=0;)E=A(E),R=A(R);var D=M(E,1),F=M(R,1);for(R=M(R,2),E=M(E,2);!y(R);){var L=F.add(R);L.l(N)<=0&&(D=D.add(E),F=L),R=M(R,1),E=M(E,1)}return T=x(N,D.j(T)),new k(D,T)}for(D=d;N.l(T)>=0;){for(E=Math.max(1,Math.floor(N.m()/T.m())),R=Math.ceil(Math.log(E)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),F=h(E),L=F.j(T);w(L)||L.l(N)>0;)E-=R,F=h(E),L=F.j(T);y(F)&&(F=f),D=D.add(F),N=x(N,L)}return new k(D,N)}e.B=function(N){return P(this,N).h},e.and=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)&N.i(R);return new o(E,this.h&N.h)},e.or=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)|N.i(R);return new o(E,this.h|N.h)},e.xor=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)^N.i(R);return new o(E,this.h^N.h)};function A(N){const T=N.g.length+1,E=[];for(let R=0;R<T;R++)E[R]=N.i(R)<<1|N.i(R-1)>>>31;return new o(E,N.h)}function M(N,T){const E=T>>5;T%=32;const R=N.g.length-E,D=[];for(let F=0;F<R;F++)D[F]=T>0?N.i(F+E)>>>T|N.i(F+E+1)<<32-T:N.i(F+E);return new o(D,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,vM=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=u,xo=o}).apply(typeof kk<"u"?kk:typeof self<"u"?self:typeof window<"u"?window:{});var Bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yM,ph,xM,bg,wx,_M,wM,bM;(function(){var e,t=Object.defineProperty;function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bd=="object"&&Bd];for(var b=0;b<p.length;++b){var S=p[b];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function r(p,b){if(b)t:{var S=i;p=p.split(".");for(var V=0;V<p.length-1;V++){var H=p[V];if(!(H in S))break t;S=S[H]}p=p[p.length-1],V=S[p],b=b(V),b!=V&&b!=null&&t(S,p,{configurable:!0,writable:!0,value:b})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(b){var S=[],V;for(V in b)Object.prototype.hasOwnProperty.call(b,V)&&S.push([V,b[V]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function c(p,b,S){return p.call.apply(p.bind,arguments)}function h(p,b,S){return h=c,h.apply(null,arguments)}function u(p,b){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function d(p,b){function S(){}S.prototype=b.prototype,p.Z=b.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(V,H,$){for(var at=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)at[jt-2]=arguments[jt];return b.prototype[H].apply(V,at)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const b=p.length;if(b>0){const S=Array(b);for(let V=0;V<b;V++)S[V]=p[V];return S}return[]}function y(p,b){for(let V=1;V<arguments.length;V++){const H=arguments[V];var S=typeof H;if(S=S!="object"?S:H?Array.isArray(H)?"array":S:"null",S=="array"||S=="object"&&typeof H.length=="number"){S=p.length||0;const $=H.length||0;p.length=S+$;for(let at=0;at<$;at++)p[S+at]=H[at]}else p.push(H)}}class w{constructor(b,S){this.i=b,this.j=S,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function _(p){o.setTimeout(()=>{throw p},0)}function x(){var p=N;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class C{constructor(){this.h=this.g=null}add(b,S){const V=k.get();V.set(b,S),this.h?this.h.next=V:this.g=V,this.h=V}}var k=new w(()=>new P,p=>p.reset());class P{constructor(){this.next=this.g=this.h=null}set(b,S){this.h=b,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let A,M=!1,N=new C,T=()=>{const p=Promise.resolve(void 0);A=()=>{p.then(E)}};function E(){for(var p;p=x();){try{p.h.call(p.g)}catch(S){_(S)}var b=k;b.j(p),b.h<100&&(b.h++,p.next=b.g,b.g=p)}M=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};o.addEventListener("test",S,b),o.removeEventListener("test",S,b)}catch{}return p}();function L(p){return/^[\s\xa0]*$/.test(p)}function lt(p,b){D.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,b)}d(lt,D),lt.prototype.init=function(p,b){const S=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget,b||(S=="mouseover"?b=p.fromElement:S=="mouseout"&&(b=p.toElement)),this.relatedTarget=b,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&lt.Z.h.call(this)},lt.prototype.h=function(){lt.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ht="closure_listenable_"+(Math.random()*1e6|0),Y=0;function K(p,b,S,V,H){this.listener=p,this.proxy=null,this.src=b,this.type=S,this.capture=!!V,this.ha=H,this.key=++Y,this.da=this.fa=!1}function U(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function W(p,b,S){for(const V in p)b.call(S,p[V],V,p)}function j(p,b){for(const S in p)b.call(void 0,p[S],S,p)}function q(p){const b={};for(const S in p)b[S]=p[S];return b}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(p,b){let S,V;for(let H=1;H<arguments.length;H++){V=arguments[H];for(S in V)p[S]=V[S];for(let $=0;$<J.length;$++)S=J[$],Object.prototype.hasOwnProperty.call(V,S)&&(p[S]=V[S])}}function Q(p){this.src=p,this.g={},this.h=0}Q.prototype.add=function(p,b,S,V,H){const $=p.toString();p=this.g[$],p||(p=this.g[$]=[],this.h++);const at=O(p,b,V,H);return at>-1?(b=p[at],S||(b.fa=!1)):(b=new K(b,this.src,$,!!V,H),b.fa=S,p.push(b)),b};function Z(p,b){const S=b.type;if(S in p.g){var V=p.g[S],H=Array.prototype.indexOf.call(V,b,void 0),$;($=H>=0)&&Array.prototype.splice.call(V,H,1),$&&(U(b),p.g[S].length==0&&(delete p.g[S],p.h--))}}function O(p,b,S,V){for(let H=0;H<p.length;++H){const $=p[H];if(!$.da&&$.listener==b&&$.capture==!!S&&$.ha==V)return H}return-1}var B="closure_lm_"+(Math.random()*1e6|0),rt={};function z(p,b,S,V,H){if(Array.isArray(b)){for(let $=0;$<b.length;$++)z(p,b[$],S,V,H);return null}return S=Yt(S),p&&p[ht]?p.J(b,S,a(V)?!!V.capture:!1,H):et(p,b,S,!1,V,H)}function et(p,b,S,V,H,$){if(!b)throw Error("Invalid event type");const at=a(H)?!!H.capture:!!H;let jt=Tt(p);if(jt||(p[B]=jt=new Q(p)),S=jt.add(b,S,V,at,$),S.proxy)return S;if(V=nt(),S.proxy=V,V.src=p,V.listener=S,p.addEventListener)F||(H=at),H===void 0&&(H=!1),p.addEventListener(b.toString(),V,H);else if(p.attachEvent)p.attachEvent(ct(b.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function nt(){function p(S){return b.call(p.src,p.listener,S)}const b=ot;return p}function mt(p,b,S,V,H){if(Array.isArray(b))for(var $=0;$<b.length;$++)mt(p,b[$],S,V,H);else V=a(V)?!!V.capture:!!V,S=Yt(S),p&&p[ht]?(p=p.i,$=String(b).toString(),$ in p.g&&(b=p.g[$],S=O(b,S,V,H),S>-1&&(U(b[S]),Array.prototype.splice.call(b,S,1),b.length==0&&(delete p.g[$],p.h--)))):p&&(p=Tt(p))&&(b=p.g[b.toString()],p=-1,b&&(p=O(b,S,V,H)),(S=p>-1?b[p]:null)&&Nt(S))}function Nt(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[ht])Z(b.i,p);else{var S=p.type,V=p.proxy;b.removeEventListener?b.removeEventListener(S,V,p.capture):b.detachEvent?b.detachEvent(ct(S),V):b.addListener&&b.removeListener&&b.removeListener(V),(S=Tt(b))?(Z(S,p),S.h==0&&(S.src=null,b[B]=null)):U(p)}}}function ct(p){return p in rt?rt[p]:rt[p]="on"+p}function ot(p,b){if(p.da)p=!0;else{b=new lt(b,this);const S=p.listener,V=p.ha||p.src;p.fa&&Nt(p),p=S.call(V,b)}return p}function Tt(p){return p=p[B],p instanceof Q?p:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function Yt(p){return typeof p=="function"?p:(p[Et]||(p[Et]=function(b){return p.handleEvent(b)}),p[Et])}function St(){R.call(this),this.i=new Q(this),this.M=this,this.G=null}d(St,R),St.prototype[ht]=!0,St.prototype.removeEventListener=function(p,b,S,V){mt(this,p,b,S,V)};function Ut(p,b){var S,V=p.G;if(V)for(S=[];V;V=V.G)S.push(V);if(p=p.M,V=b.type||b,typeof b=="string")b=new D(b,p);else if(b instanceof D)b.target=b.target||p;else{var H=b;b=new D(V,p),G(b,H)}H=!0;let $,at;if(S)for(at=S.length-1;at>=0;at--)$=b.g=S[at],H=pn($,V,!0,b)&&H;if($=b.g=p,H=pn($,V,!0,b)&&H,H=pn($,V,!1,b)&&H,S)for(at=0;at<S.length;at++)$=b.g=S[at],H=pn($,V,!1,b)&&H}St.prototype.N=function(){if(St.Z.N.call(this),this.i){var p=this.i;for(const b in p.g){const S=p.g[b];for(let V=0;V<S.length;V++)U(S[V]);delete p.g[b],p.h--}}this.G=null},St.prototype.J=function(p,b,S,V){return this.i.add(String(p),b,!1,S,V)},St.prototype.K=function(p,b,S,V){return this.i.add(String(p),b,!0,S,V)};function pn(p,b,S,V){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();let H=!0;for(let $=0;$<b.length;++$){const at=b[$];if(at&&!at.da&&at.capture==S){const jt=at.listener,Ye=at.ha||at.src;at.fa&&Z(p.i,at),H=jt.call(Ye,V)!==!1&&H}}return H&&!V.defaultPrevented}function oe(p,b){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:o.setTimeout(p,b||0)}function ft(p){p.g=oe(()=>{p.g=null,p.i&&(p.i=!1,ft(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class It extends R{constructor(b,S){super(),this.m=b,this.l=S,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:ft(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(p){R.call(this),this.h=p,this.g={}}d(ae,R);var vn=[];function Xn(p){W(p.g,function(b,S){this.g.hasOwnProperty(S)&&Nt(b)},p),p.g={}}ae.prototype.N=function(){ae.Z.N.call(this),Xn(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ei=o.JSON.stringify,Jn=o.JSON.parse,Zn=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function Si(){}function ti(){}var Ii={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Dl(){D.call(this,"d")}d(Dl,D);function $a(){D.call(this,"c")}d($a,D);var Er={},hd=null;function Fs(){return hd=hd||new St}Er.Ia="serverreachability";function Zi(p){D.call(this,Er.Ia,p)}d(Zi,D);function Ho(p){const b=Fs();Ut(b,new Zi(b))}Er.STAT_EVENT="statevent";function ud(p,b){D.call(this,Er.STAT_EVENT,p),this.stat=b}d(ud,D);function nn(p){const b=Fs();Ut(b,new ud(b,p))}Er.Ja="timingevent";function Ll(p,b){D.call(this,Er.Ja,p),this.size=b}d(Ll,D);function Rt(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},b)}function be(){this.g=!0}be.prototype.ua=function(){this.g=!1};function rn(p,b,S,V,H,$){p.info(function(){if(p.g)if($){var at="",jt=$.split("&");for(let ce=0;ce<jt.length;ce++){var Ye=jt[ce].split("=");if(Ye.length>1){const sn=Ye[0];Ye=Ye[1];const Ir=sn.split("_");at=Ir.length>=2&&Ir[1]=="type"?at+(sn+"="+Ye+"&"):at+(sn+"=redacted&")}}}else at=null;else at=$;return"XMLHTTP REQ ("+V+") [attempt "+H+"]: "+b+`
`+S+`
`+at})}function Un(p,b,S,V,H,$,at){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+H+"]: "+b+`
`+S+`
`+$+" "+at})}function tr(p,b,S,V){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+ei(p,S)+(V?" "+V:"")})}function Qe(p,b){p.info(function(){return"TIMEOUT: "+b})}be.prototype.info=function(){};function ei(p,b){if(!p.g)return b;if(!b)return null;try{const $=JSON.parse(b);if($){for(p=0;p<$.length;p++)if(Array.isArray($[p])){var S=$[p];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var H=V[0];if(H!="noop"&&H!="stop"&&H!="close")for(let at=1;at<V.length;at++)V[at]=""}}}}return Ei($)}catch{return b}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ni={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ii;function za(){}d(za,Si),za.prototype.g=function(){return new XMLHttpRequest},ii=new za;function fi(p){return encodeURIComponent(String(p))}function tT(p){var b=1;p=p.split(":");const S=[];for(;b>0&&p.length;)S.push(p.shift()),b--;return p.length&&S.push(p.join(":")),S}function Us(p,b,S,V){this.j=p,this.i=b,this.l=S,this.S=V||1,this.V=new ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new eT}function eT(){this.i=null,this.g="",this.h=!1}var nT={},Sp={};function Ip(p,b,S){p.M=1,p.A=gd(Sr(b)),p.u=S,p.R=!0,iT(p,null)}function iT(p,b){p.F=Date.now(),dd(p),p.B=Sr(p.A);var S=p.B,V=p.S;Array.isArray(V)||(V=[String(V)]),pT(S.i,"t",V),p.C=0,S=p.j.L,p.h=new eT,p.g=DT(p.j,S?b:null,!p.u),p.P>0&&(p.O=new It(h(p.Y,p,p.g),p.P)),b=p.V,S=p.g,V=p.ba;var H="readystatechange";Array.isArray(H)||(H&&(vn[0]=H.toString()),H=vn);for(let $=0;$<H.length;$++){const at=z(S,H[$],V||b.handleEvent,!1,b.h||b);if(!at)break;b.g[at.key]=at}b=p.J?q(p.J):{},p.u?(p.v||(p.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,b)):(p.v="GET",p.g.ea(p.B,p.v,null,b)),Ho(),rn(p.i,p.v,p.B,p.l,p.S,p.u)}Us.prototype.ba=function(p){p=p.target;const b=this.O;b&&Gs(p)==3?b.j():this.Y(p)},Us.prototype.Y=function(p){try{if(p==this.g)t:{const jt=Gs(this.g),Ye=this.g.ya(),ce=this.g.ca();if(!(jt<3)&&(jt!=3||this.g&&(this.h.h||this.g.la()||TT(this.g)))){this.K||jt!=4||Ye==7||(Ye==8||ce<=0?Ho(3):Ho(2)),Ap(this);var b=this.g.ca();this.X=b;var S=ij(this);if(this.o=b==200,Un(this.i,this.v,this.B,this.l,this.S,jt,b),this.o){if(this.U&&!this.L){e:{if(this.g){var V,H=this.g;if((V=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(V)){var $=V;break e}}$=null}if(p=$)tr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Rp(this,p);else{this.o=!1,this.m=3,nn(12),$o(this),Vl(this);break t}}if(this.R){p=!0;let sn;for(;!this.K&&this.C<S.length;)if(sn=rj(this,S),sn==Sp){jt==4&&(this.m=4,nn(14),p=!1),tr(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==nT){this.m=4,nn(15),tr(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else tr(this.i,this.l,sn,null),Rp(this,sn);if(rT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),jt!=4||S.length!=0||this.h.h||(this.m=1,nn(16),p=!1),this.o=this.o&&p,!p)tr(this.i,this.l,S,"[Invalid Chunked Response]"),$o(this),Vl(this);else if(S.length>0&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.aa&&!at.P&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Fp(at),at.P=!0,nn(11))}}else tr(this.i,this.l,S,null),Rp(this,S);jt==4&&$o(this),this.o&&!this.K&&(jt==4?AT(this.j,this):(this.o=!1,dd(this)))}else yj(this.g),b==400&&S.indexOf("Unknown SID")>0?(this.m=3,nn(12)):(this.m=0,nn(13)),$o(this),Vl(this)}}}catch{}finally{}};function ij(p){if(!rT(p))return p.g.la();const b=TT(p.g);if(b==="")return"";let S="";const V=b.length,H=Gs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return $o(p),Vl(p),"";p.h.i=new o.TextDecoder}for(let $=0;$<V;$++)p.h.h=!0,S+=p.h.i.decode(b[$],{stream:!(H&&$==V-1)});return b.length=0,p.h.g+=S,p.C=0,p.h.g}function rT(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function rj(p,b){var S=p.C,V=b.indexOf(`
`,S);return V==-1?Sp:(S=Number(b.substring(S,V)),isNaN(S)?nT:(V+=1,V+S>b.length?Sp:(b=b.slice(V,V+S),p.C=V+S,b)))}Us.prototype.cancel=function(){this.K=!0,$o(this)};function dd(p){p.T=Date.now()+p.H,sT(p,p.H)}function sT(p,b){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Rt(h(p.aa,p),b)}function Ap(p){p.D&&(o.clearTimeout(p.D),p.D=null)}Us.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Qe(this.i,this.B),this.M!=2&&(Ho(),nn(17)),$o(this),this.m=2,Vl(this)):sT(this,this.T-p)};function Vl(p){p.j.I==0||p.K||AT(p.j,p)}function $o(p){Ap(p);var b=p.O;b&&typeof b.dispose=="function"&&b.dispose(),p.O=null,Xn(p.V),p.g&&(b=p.g,p.g=null,b.abort(),b.dispose())}function Rp(p,b){try{var S=p.j;if(S.I!=0&&(S.g==p||Pp(S.h,p))){if(!p.L&&Pp(S.h,p)&&S.I==3){try{var V=S.Ba.g.parse(b)}catch{V=null}if(Array.isArray(V)&&V.length==3){var H=V;if(H[0]==0){t:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)yd(S),pd(S);else break t;jp(S),nn(18)}}else S.xa=H[1],0<S.xa-S.K&&H[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Rt(h(S.Va,S),6e3));cT(S.h)<=1&&S.ta&&(S.ta=void 0)}else Ko(S,11)}else if((p.L||S.g==p)&&yd(S),!L(b))for(H=S.Ba.g.parse(b),b=0;b<H.length;b++){let ce=H[b];const sn=ce[0];if(!(sn<=S.K))if(S.K=sn,ce=ce[1],S.I==2)if(ce[0]=="c"){S.M=ce[1],S.ba=ce[2];const Ir=ce[3];Ir!=null&&(S.ka=Ir,S.j.info("VER="+S.ka));const Wo=ce[4];Wo!=null&&(S.za=Wo,S.j.info("SVER="+S.za));const Hs=ce[5];Hs!=null&&typeof Hs=="number"&&Hs>0&&(V=1.5*Hs,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const $s=p.g;if($s){const _d=$s.g?$s.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_d){var $=V.h;$.g||_d.indexOf("spdy")==-1&&_d.indexOf("quic")==-1&&_d.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Mp($,$.h),$.h=null))}if(V.G){const Up=$s.g?$s.g.getResponseHeader("X-HTTP-Session-Id"):null;Up&&(V.wa=Up,fe(V.J,V.G,Up))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var at=p;if(V.na=MT(V,V.L?V.ba:null,V.W),at.L){lT(V.h,at);var jt=at,Ye=V.O;Ye&&(jt.H=Ye),jt.D&&(Ap(jt),dd(jt)),V.g=at}else ST(V);S.i.length>0&&vd(S)}else ce[0]!="stop"&&ce[0]!="close"||Ko(S,7);else S.I==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?Ko(S,7):qp(S):ce[0]!="noop"&&S.l&&S.l.qa(ce),S.A=0)}}Ho(4)}catch{}}var sj=class{constructor(p,b){this.g=p,this.map=b}};function oT(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function aT(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function cT(p){return p.h?1:p.g?p.g.size:0}function Pp(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function Mp(p,b){p.g?p.g.add(b):p.h=b}function lT(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}oT.prototype.cancel=function(){if(this.i=hT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function hT(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const S of p.g.values())b=b.concat(S.G);return b}return v(p.i)}var uT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oj(p,b){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const V=p[S].indexOf("=");let H,$=null;V>=0?(H=p[S].substring(0,V),$=p[S].substring(V+1)):H=p[S],b(H,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Os(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;p instanceof Os?(this.l=p.l,ql(this,p.j),this.o=p.o,this.g=p.g,jl(this,p.u),this.h=p.h,Dp(this,vT(p.i)),this.m=p.m):p&&(b=String(p).match(uT))?(this.l=!1,ql(this,b[1]||"",!0),this.o=Fl(b[2]||""),this.g=Fl(b[3]||"",!0),jl(this,b[4]),this.h=Fl(b[5]||"",!0),Dp(this,b[6]||"",!0),this.m=Fl(b[7]||"")):(this.l=!1,this.i=new Ol(null,this.l))}Os.prototype.toString=function(){const p=[];var b=this.j;b&&p.push(Ul(b,dT,!0),":");var S=this.g;return(S||b=="file")&&(p.push("//"),(b=this.o)&&p.push(Ul(b,dT,!0),"@"),p.push(fi(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Ul(S,S.charAt(0)=="/"?lj:cj,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Ul(S,uj)),p.join("")},Os.prototype.resolve=function(p){const b=Sr(this);let S=!!p.j;S?ql(b,p.j):S=!!p.o,S?b.o=p.o:S=!!p.g,S?b.g=p.g:S=p.u!=null;var V=p.h;if(S)jl(b,p.u);else if(S=!!p.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var H=b.h.lastIndexOf("/");H!=-1&&(V=b.h.slice(0,H+1)+V)}if(H=V,H==".."||H==".")V="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){V=H.lastIndexOf("/",0)==0,H=H.split("/");const $=[];for(let at=0;at<H.length;){const jt=H[at++];jt=="."?V&&at==H.length&&$.push(""):jt==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),V&&at==H.length&&$.push("")):($.push(jt),V=!0)}V=$.join("/")}else V=H}return S?b.h=V:S=p.i.toString()!=="",S?Dp(b,vT(p.i)):S=!!p.m,S&&(b.m=p.m),b};function Sr(p){return new Os(p)}function ql(p,b,S){p.j=S?Fl(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function jl(p,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);p.u=b}else p.u=null}function Dp(p,b,S){b instanceof Ol?(p.i=b,dj(p.i,p.l)):(S||(b=Ul(b,hj)),p.i=new Ol(b,p.l))}function fe(p,b,S){p.i.set(b,S)}function gd(p){return fe(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Fl(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ul(p,b,S){return typeof p=="string"?(p=encodeURI(p).replace(b,aj),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function aj(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var dT=/[#\/\?@]/g,cj=/[#\?:]/g,lj=/[#\?]/g,hj=/[#\?@]/g,uj=/#/g;function Ol(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function zo(p){p.g||(p.g=new Map,p.h=0,p.i&&oj(p.i,function(b,S){p.add(decodeURIComponent(b.replace(/\+/g," ")),S)}))}e=Ol.prototype,e.add=function(p,b){zo(this),this.i=null,p=Ka(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(b),this.h+=1,this};function gT(p,b){zo(p),b=Ka(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function fT(p,b){return zo(p),b=Ka(p,b),p.g.has(b)}e.forEach=function(p,b){zo(this),this.g.forEach(function(S,V){S.forEach(function(H){p.call(b,H,V,this)},this)},this)};function mT(p,b){zo(p);let S=[];if(typeof b=="string")fT(p,b)&&(S=S.concat(p.g.get(Ka(p,b))));else for(p=Array.from(p.g.values()),b=0;b<p.length;b++)S=S.concat(p[b]);return S}e.set=function(p,b){return zo(this),this.i=null,p=Ka(this,p),fT(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},e.get=function(p,b){return p?(p=mT(this,p),p.length>0?String(p[0]):b):b};function pT(p,b,S){gT(p,b),S.length>0&&(p.i=null,p.g.set(Ka(p,b),v(S)),p.h+=S.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(let V=0;V<b.length;V++){var S=b[V];const H=fi(S);S=mT(this,S);for(let $=0;$<S.length;$++){let at=H;S[$]!==""&&(at+="="+fi(S[$])),p.push(at)}}return this.i=p.join("&")};function vT(p){const b=new Ol;return b.i=p.i,p.g&&(b.g=new Map(p.g),b.h=p.h),b}function Ka(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function dj(p,b){b&&!p.j&&(zo(p),p.i=null,p.g.forEach(function(S,V){const H=V.toLowerCase();V!=H&&(gT(this,V),pT(this,H,S))},p)),p.j=b}function gj(p,b){const S=new be;if(o.Image){const V=new Image;V.onload=u(Bs,S,"TestLoadImage: loaded",!0,b,V),V.onerror=u(Bs,S,"TestLoadImage: error",!1,b,V),V.onabort=u(Bs,S,"TestLoadImage: abort",!1,b,V),V.ontimeout=u(Bs,S,"TestLoadImage: timeout",!1,b,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else b(!1)}function fj(p,b){const S=new be,V=new AbortController,H=setTimeout(()=>{V.abort(),Bs(S,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:V.signal}).then($=>{clearTimeout(H),$.ok?Bs(S,"TestPingServer: ok",!0,b):Bs(S,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(H),Bs(S,"TestPingServer: error",!1,b)})}function Bs(p,b,S,V,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),V(S)}catch{}}function mj(){this.g=new Zn}function Lp(p){this.i=p.Sb||null,this.h=p.ab||!1}d(Lp,Si),Lp.prototype.g=function(){return new fd(this.i,this.h)};function fd(p,b){St.call(this),this.H=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(fd,St),e=fd.prototype,e.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=b,this.readyState=1,Gl(this)},e.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(b.body=p),(this.H||o).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Bl(this)),this.readyState=0},e.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Gl(this)),this.g&&(this.readyState=3,Gl(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;yT(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function yT(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}e.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?Bl(this):Gl(this),this.readyState==3&&yT(this)}},e.Oa=function(p){this.g&&(this.response=this.responseText=p,Bl(this))},e.Na=function(p){this.g&&(this.response=p,Bl(this))},e.ga=function(){this.g&&Bl(this)};function Bl(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Gl(p)}e.setRequestHeader=function(p,b){this.A.append(p,b)},e.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var S=b.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=b.next();return p.join(`\r
`)};function Gl(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(fd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function xT(p){let b="";return W(p,function(S,V){b+=V,b+=":",b+=S,b+=`\r
`}),b}function Vp(p,b,S){t:{for(V in S){var V=!1;break t}V=!0}V||(S=xT(S),typeof p=="string"?S!=null&&fi(S):fe(p,b,S))}function Re(p){St.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Re,St);var pj=/^https?$/i,vj=["POST","PUT"];e=Re.prototype,e.Fa=function(p){this.H=p},e.ea=function(p,b,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ii.g(),this.g.onreadystatechange=f(h(this.Ca,this));try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch($){_T(this,$);return}if(p=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var H in V)S.set(H,V[H]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const $ of V.keys())S.set($,V.get($));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find($=>$.toLowerCase()=="content-type"),H=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(vj,b,void 0)>=0)||V||H||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,at]of S)this.g.setRequestHeader($,at);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch($){_T(this,$)}};function _T(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.o=5,wT(p),md(p)}function wT(p){p.A||(p.A=!0,Ut(p,"complete"),Ut(p,"error"))}e.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Ut(this,"complete"),Ut(this,"abort"),md(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),md(this,!0)),Re.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?bT(this):this.Xa())},e.Xa=function(){bT(this)};function bT(p){if(p.h&&typeof s<"u"){if(p.v&&Gs(p)==4)setTimeout(p.Ca.bind(p),0);else if(Ut(p,"readystatechange"),Gs(p)==4){p.h=!1;try{const $=p.ca();t:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break t;default:b=!1}var S;if(!(S=b)){var V;if(V=$===0){let at=String(p.D).match(uT)[1]||null;!at&&o.self&&o.self.location&&(at=o.self.location.protocol.slice(0,-1)),V=!pj.test(at?at.toLowerCase():"")}S=V}if(S)Ut(p,"complete"),Ut(p,"success");else{p.o=6;try{var H=Gs(p)>2?p.g.statusText:""}catch{H=""}p.l=H+" ["+p.ca()+"]",wT(p)}}finally{md(p)}}}}function md(p,b){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,b||Ut(p,"ready");try{S.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function Gs(p){return p.g?p.g.readyState:0}e.ca=function(){try{return Gs(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),Jn(b)}};function TT(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function yj(p){const b={};p=(p.g&&Gs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(L(p[V]))continue;var S=tT(p[V]);const H=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const $=b[H]||[];b[H]=$,$.push(S)}j(b,function(V){return V.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hl(p,b,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||b}function CT(p){this.za=0,this.i=[],this.j=new be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Hl("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Hl("baseRetryDelayMs",5e3,p),this.Za=Hl("retryDelaySeedMs",1e4,p),this.Ta=Hl("forwardChannelMaxRetries",2,p),this.va=Hl("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new oT(p&&p.concurrentRequestLimit),this.Ba=new mj,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=CT.prototype,e.ka=8,e.I=1,e.connect=function(p,b,S,V){nn(0),this.W=p,this.H=b||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=MT(this,null,this.W),vd(this)};function qp(p){if(kT(p),p.I==3){var b=p.V++,S=Sr(p.J);if(fe(S,"SID",p.M),fe(S,"RID",b),fe(S,"TYPE","terminate"),$l(p,S),b=new Us(p,p.j,b),b.M=2,b.A=gd(Sr(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(b.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=b.A,S=!0),S||(b.g=DT(b.j,null),b.g.ea(b.A)),b.F=Date.now(),dd(b)}PT(p)}function pd(p){p.g&&(Fp(p),p.g.cancel(),p.g=null)}function kT(p){pd(p),p.v&&(o.clearTimeout(p.v),p.v=null),yd(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function vd(p){if(!aT(p.h)&&!p.m){p.m=!0;var b=p.Ea;A||T(),M||(A(),M=!0),N.add(b,p),p.D=0}}function xj(p,b){return cT(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=b.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Rt(h(p.Ea,p,b),RT(p,p.D)),p.D++,!0)}e.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const H=new Us(this,this.j,p);let $=this.o;if(this.U&&($?($=q($),G($,this.U)):$=this.U),this.u!==null||this.R||(H.J=$,$=null),this.S)t:{for(var b=0,S=0;S<this.i.length;S++){e:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break e}V=void 0}if(V===void 0)break;if(b+=V,b>4096){b=S;break t}if(b===4096||S===this.i.length-1){b=S+1;break t}}b=1e3}else b=1e3;b=ET(this,H,b),S=Sr(this.J),fe(S,"RID",p),fe(S,"CVER",22),this.G&&fe(S,"X-HTTP-Session-Id",this.G),$l(this,S),$&&(this.R?b="headers="+fi(xT($))+"&"+b:this.u&&Vp(S,this.u,$)),Mp(this.h,H),this.Ra&&fe(S,"TYPE","init"),this.S?(fe(S,"$req",b),fe(S,"SID","null"),H.U=!0,Ip(H,S,null)):Ip(H,S,b),this.I=2}}else this.I==3&&(p?NT(this,p):this.i.length==0||aT(this.h)||NT(this))};function NT(p,b){var S;b?S=b.l:S=p.V++;const V=Sr(p.J);fe(V,"SID",p.M),fe(V,"RID",S),fe(V,"AID",p.K),$l(p,V),p.u&&p.o&&Vp(V,p.u,p.o),S=new Us(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),b&&(p.i=b.G.concat(p.i)),b=ET(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Mp(p.h,S),Ip(S,V,b)}function $l(p,b){p.H&&W(p.H,function(S,V){fe(b,V,S)}),p.l&&W({},function(S,V){fe(b,V,S)})}function ET(p,b,S){S=Math.min(p.i.length,S);const V=p.l?h(p.l.Ka,p.l,p):null;t:{var H=p.i;let jt=-1;for(;;){const Ye=["count="+S];jt==-1?S>0?(jt=H[0].g,Ye.push("ofs="+jt)):jt=0:Ye.push("ofs="+jt);let ce=!0;for(let sn=0;sn<S;sn++){var $=H[sn].g;const Ir=H[sn].map;if($-=jt,$<0)jt=Math.max(0,H[sn].g-100),ce=!1;else try{$="req"+$+"_"||"";try{var at=Ir instanceof Map?Ir:Object.entries(Ir);for(const[Wo,Hs]of at){let $s=Hs;a(Hs)&&($s=Ei(Hs)),Ye.push($+Wo+"="+encodeURIComponent($s))}}catch(Wo){throw Ye.push($+"type="+encodeURIComponent("_badmap")),Wo}}catch{V&&V(Ir)}}if(ce){at=Ye.join("&");break t}}at=void 0}return p=p.i.splice(0,S),b.G=p,at}function ST(p){if(!p.g&&!p.v){p.Y=1;var b=p.Da;A||T(),M||(A(),M=!0),N.add(b,p),p.A=0}}function jp(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Rt(h(p.Da,p),RT(p,p.A)),p.A++,!0)}e.Da=function(){if(this.v=null,IT(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Rt(h(this.Wa,this),p)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,nn(10),pd(this),IT(this))};function Fp(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function IT(p){p.g=new Us(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var b=Sr(p.na);fe(b,"RID","rpc"),fe(b,"SID",p.M),fe(b,"AID",p.K),fe(b,"CI",p.F?"0":"1"),!p.F&&p.ia&&fe(b,"TO",p.ia),fe(b,"TYPE","xmlhttp"),$l(p,b),p.u&&p.o&&Vp(b,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=gd(Sr(b)),S.u=null,S.R=!0,iT(S,p)}e.Va=function(){this.C!=null&&(this.C=null,pd(this),jp(this),nn(19))};function yd(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function AT(p,b){var S=null;if(p.g==b){yd(p),Fp(p),p.g=null;var V=2}else if(Pp(p.h,b))S=b.G,lT(p.h,b),V=1;else return;if(p.I!=0){if(b.o)if(V==1){S=b.u?b.u.length:0,b=Date.now()-b.F;var H=p.D;V=Fs(),Ut(V,new Ll(V,S)),vd(p)}else ST(p);else if(H=b.m,H==3||H==0&&b.X>0||!(V==1&&xj(p,b)||V==2&&jp(p)))switch(S&&S.length>0&&(b=p.h,b.i=b.i.concat(S)),H){case 1:Ko(p,5);break;case 4:Ko(p,10);break;case 3:Ko(p,6);break;default:Ko(p,2)}}}function RT(p,b){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*b}function Ko(p,b){if(p.j.info("Error code "+b),b==2){var S=h(p.bb,p),V=p.Ua;const H=!V;V=new Os(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ql(V,"https"),gd(V),H?gj(V.toString(),S):fj(V.toString(),S)}else nn(2);p.I=0,p.l&&p.l.pa(b),PT(p),kT(p)}e.bb=function(p){p?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function PT(p){if(p.I=0,p.ja=[],p.l){const b=hT(p.h);(b.length!=0||p.i.length!=0)&&(y(p.ja,b),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function MT(p,b,S){var V=S instanceof Os?Sr(S):new Os(S);if(V.g!="")b&&(V.g=b+"."+V.g),jl(V,V.u);else{var H=o.location;V=H.protocol,b=b?b+"."+H.hostname:H.hostname,H=+H.port;const $=new Os(null);V&&ql($,V),b&&($.g=b),H&&jl($,H),S&&($.h=S),V=$}return S=p.G,b=p.wa,S&&b&&fe(V,S,b),fe(V,"VER",p.ka),$l(p,V),V}function DT(p,b,S){if(b&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Aa&&!p.ma?new Re(new Lp({ab:S})):new Re(p.ma),b.Fa(p.L),b}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function LT(){}e=LT.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function xd(){}xd.prototype.g=function(p,b){return new mi(p,b)};function mi(p,b){St.call(this),this.g=new CT(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(p?p["X-WebChannel-Client-Profile"]=b.sa:p={"X-WebChannel-Client-Profile":b.sa}),this.g.U=p,(p=b&&b.Qb)&&!L(p)&&(this.g.u=p),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!L(b)&&(this.g.G=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new Wa(this)}d(mi,St),mi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},mi.prototype.close=function(){qp(this.g)},mi.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=Ei(p),p=S);b.i.push(new sj(b.Ya++,p)),b.I==3&&vd(b)},mi.prototype.N=function(){this.g.l=null,delete this.j,qp(this.g),delete this.g,mi.Z.N.call(this)};function VT(p){Dl.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){t:{for(const S in b){p=S;break t}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}d(VT,Dl);function qT(){$a.call(this),this.status=1}d(qT,$a);function Wa(p){this.g=p}d(Wa,LT),Wa.prototype.ra=function(){Ut(this.g,"a")},Wa.prototype.qa=function(p){Ut(this.g,new VT(p))},Wa.prototype.pa=function(p){Ut(this.g,new qT)},Wa.prototype.oa=function(){Ut(this.g,"b")},xd.prototype.createWebChannel=xd.prototype.g,mi.prototype.send=mi.prototype.o,mi.prototype.open=mi.prototype.m,mi.prototype.close=mi.prototype.close,bM=function(){return new xd},wM=function(){return Fs()},_M=Er,wx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,bg=ts,ni.COMPLETE="complete",xM=ni,ti.EventType=Ii,Ii.OPEN="a",Ii.CLOSE="b",Ii.ERROR="c",Ii.MESSAGE="d",St.prototype.listen=St.prototype.J,ph=ti,Re.prototype.listenOnce=Re.prototype.K,Re.prototype.getLastError=Re.prototype.Ha,Re.prototype.getLastErrorCode=Re.prototype.ya,Re.prototype.getStatus=Re.prototype.ca,Re.prototype.getResponseJson=Re.prototype.La,Re.prototype.getResponseText=Re.prototype.la,Re.prototype.send=Re.prototype.ea,Re.prototype.setWithCredentials=Re.prototype.Fa,yM=Re}).apply(typeof Bd<"u"?Bd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xl="12.8.0";function dH(e){xl=e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Gu("@firebase/firestore");function Ja(){return wa.logLevel}function vt(e,...t){if(wa.logLevel<=Ot.DEBUG){const n=t.map(W_);wa.debug(`Firestore (${xl}): ${e}`,...n)}}function ks(e,...t){if(wa.logLevel<=Ot.ERROR){const n=t.map(W_);wa.error(`Firestore (${xl}): ${e}`,...n)}}function ba(e,...t){if(wa.logLevel<=Ot.WARN){const n=t.map(W_);wa.warn(`Firestore (${xl}): ${e}`,...n)}}function W_(e){if(typeof e=="string")return e;try{return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,TM(e,i,n)}function TM(e,t,n){let i=`FIRESTORE (${xl}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw ks(i),new Error(i)}function ne(e,t,n,i){let r="Unexpected state";typeof n=="string"?r=n:i=n,e||TM(t,r,i)}function qt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dt extends Ji{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class kM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(En.UNAUTHENTICATED))}shutdown(){}}class gH{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class fH{constructor(t){this.t=t,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ne(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let s=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gs,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{vt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(vt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gs)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(vt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ne(typeof i.accessToken=="string",31837,{l:i}),new CM(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ne(t===null||typeof t=="string",2055,{h:t}),new En(t)}}class mH{constructor(t,n,i){this.P=t,this.T=n,this.I=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class pH{constructor(t,n,i){this.P=t,this.T=n,this.I=i}getToken(){return Promise.resolve(new mH(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(En.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Nk{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vH{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mi(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ne(this.o===void 0,3512);const i=s=>{s.error!=null&&vt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,vt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const r=s=>{vt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):vt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Nk(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ne(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Nk(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yH(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=yH(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=t.charAt(r[s]%62))}return i}}function Ht(e,t){return e<t?-1:e>t?1:0}function bx(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const r=e.charAt(i),s=t.charAt(i);if(r!==s)return kv(r)===kv(s)?Ht(r,s):kv(r)?1:-1}return Ht(e.length,t.length)}const xH=55296,_H=57343;function kv(e){const t=e.charCodeAt(0);return t>=xH&&t<=_H}function Jc(e,t,n){return e.length===t.length&&e.every((i,r)=>n(i,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="__name__";class Mr{constructor(t,n,i){n===void 0?n=0:n>t.length&&At(637,{offset:n,range:t.length}),i===void 0?i=t.length-n:i>t.length-n&&At(1746,{length:i,range:t.length-n}),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Mr.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Mr?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let r=0;r<i;r++){const s=Mr.compareSegments(t.get(r),n.get(r));if(s!==0)return s}return Ht(t.length,n.length)}static compareSegments(t,n){const i=Mr.isNumericId(t),r=Mr.isNumericId(n);return i&&!r?-1:!i&&r?1:i&&r?Mr.extractNumericId(t).compare(Mr.extractNumericId(n)):bx(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return xo.fromString(t.substring(4,t.length-2))}}class he extends Mr{construct(t,n,i){return new he(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new dt(X.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new he(n)}static emptyPath(){return new he([])}}const wH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends Mr{construct(t,n,i){return new un(t,n,i)}static isValidIdentifier(t){return wH.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ek}static keyField(){return new un([Ek])}static fromServerFormat(t){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new dt(X.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new dt(X.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new dt(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new dt(X.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new un(n)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(t){this.path=t}static fromPath(t){return new Ct(he.fromString(t))}static fromName(t){return new Ct(he.fromString(t).popFirst(5))}static empty(){return new Ct(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&he.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return he.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ct(new he(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(e,t,n){if(!n)throw new dt(X.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function EM(e,t,n,i){if(t===!0&&i===!0)throw new dt(X.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Sk(e){if(!Ct.isDocumentKey(e))throw new dt(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ik(e){if(Ct.isDocumentKey(e))throw new dt(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function SM(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Mm(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":At(12329,{type:typeof e})}function Cr(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new dt(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Mm(e);throw new dt(X.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function bH(e,t){if(t<=0)throw new dt(X.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(e,t){const n={typeString:e};return t&&(n.value=t),n}function Hu(e,t){if(!SM(e))throw new dt(X.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in t)if(t[i]){const r=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){n=`JSON missing required field: '${i}'`;break}const o=e[i];if(r&&typeof o!==r){n=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${i}' field to equal '${s.value}'`;break}}if(n)throw new dt(X.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=-62135596800,Rk=1e6;class ue{static now(){return ue.fromMillis(Date.now())}static fromDate(t){return ue.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*Rk);return new ue(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new dt(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new dt(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<Ak)throw new dt(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new dt(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Rk}_compareTo(t){return this.seconds===t.seconds?Ht(this.nanoseconds,t.nanoseconds):Ht(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Hu(t,ue._jsonSchema))return new ue(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Ak;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ue._jsonSchemaVersion="firestore/timestamp/1.0",ue._jsonSchema={type:ze("string",ue._jsonSchemaVersion),seconds:ze("number"),nanoseconds:ze("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{static fromTimestamp(t){return new Lt(t)}static min(){return new Lt(new ue(0,0))}static max(){return new Lt(new ue(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=-1;function TH(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Lt.fromTimestamp(i===1e9?new ue(n+1,0):new ue(n,i));return new Eo(r,Ct.empty(),t)}function CH(e){return new Eo(e.readTime,e.key,mu)}class Eo{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new Eo(Lt.min(),Ct.empty(),mu)}static max(){return new Eo(Lt.max(),Ct.empty(),mu)}}function kH(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Ct.comparator(e.documentKey,t.documentKey),n!==0?n:Ht(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class EH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _l(e){if(e.code!==X.FAILED_PRECONDITION||e.message!==NH)throw e;vt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&At(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new tt((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof tt?n:tt.resolve(n)}catch(n){return tt.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):tt.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):tt.reject(n)}static resolve(t){return new tt((n,i)=>{n(t)})}static reject(t){return new tt((n,i)=>{i(t)})}static waitFor(t){return new tt((n,i)=>{let r=0,s=0,o=!1;t.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},c=>i(c))}),o=!0,s===r&&n()})}static or(t){let n=tt.resolve(!1);for(const i of t)n=n.next(r=>r?tt.resolve(r):i());return n}static forEach(t,n){const i=[];return t.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(t,n){return new tt((i,r)=>{const s=t.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;n(t[h]).next(u=>{o[h]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(t,n){return new tt((i,r)=>{const s=()=>{t()===!0?n().next(()=>{s()},r):i()};s()})}}function SH(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function wl(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Dm.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_=-1;function Lm(e){return e==null}function xf(e){return e===0&&1/e==-1/0}function IH(e){return typeof e=="number"&&Number.isInteger(e)&&!xf(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM="";function AH(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Pk(t)),t=RH(e.get(n),t);return Pk(t)}function RH(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const s=e.charAt(r);switch(s){case"\0":n+="";break;case IM:n+="";break;default:n+=s}}return n}function Pk(e){return e+IM+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Uo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function AM(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let We=class Tx{constructor(t,n){this.comparator=t,this.root=n||_o.EMPTY}insert(t,n){return new Tx(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,_o.BLACK,null,null))}remove(t){return new Tx(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_o.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gd(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gd(this.root,t,this.comparator,!0)}},Gd=class{constructor(t,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?i(t.key,n):1,n&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},_o=class ns{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i??ns.RED,this.left=r??ns.EMPTY,this.right=s??ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,r,s){return new ns(t??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ns.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,r=this;if(n(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(t,r.key)===0){if(r.right.isEmpty())return ns.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw At(43730,{key:this.key,value:this.value});if(this.right.isRed())throw At(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw At(27949);return t+(this.isRed()?0:1)}};_o.EMPTY=null,_o.RED=!0,_o.BLACK=!1;_o.EMPTY=new class{constructor(){this.size=0}get key(){throw At(57766)}get value(){throw At(16141)}get color(){throw At(16727)}get left(){throw At(29726)}get right(){throw At(36894)}copy(t,n,i,r,s){return this}insert(t,n,i){return new _o(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(t){this.comparator=t,this.data=new We(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;n(r.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new Dk(this.data.getIterator())}getIteratorFrom(t){return new Dk(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof en)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new en(this.comparator);return n.data=t,n}}class Dk{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(t){this.fields=t,t.sort(un.comparator)}static empty(){return new xi([])}unionWith(t){let n=new en(un.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new xi(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return Jc(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new RM("Invalid base64 string: "+s):s}}(t);return new fn(n)}static fromUint8Array(t){const n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(t);return new fn(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ht(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}fn.EMPTY_BYTE_STRING=new fn("");const PH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function So(e){if(ne(!!e,39018),typeof e=="string"){let t=0;const n=PH.exec(e);if(ne(!!n,46558,{timestamp:e}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:qe(e.seconds),nanos:qe(e.nanos)}}function qe(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Io(e){return typeof e=="string"?fn.fromBase64String(e):fn.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM="server_timestamp",MM="__type__",DM="__previous_value__",LM="__local_write_time__";function Y_(e){var n,i;return((i=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[MM])==null?void 0:i.stringValue)===PM}function Vm(e){const t=e.mapValue.fields[DM];return Y_(t)?Vm(t):t}function pu(e){const t=So(e.mapValue.fields[LM].timestampValue);return new ue(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(t,n,i,r,s,o,a,c,h,u,d){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=u,this.apiKey=d}}const _f="(default)";class Zc{constructor(t,n){this.projectId=t,this.database=n||_f}static empty(){return new Zc("","")}get isDefaultDatabase(){return this.database===_f}isEqual(t){return t instanceof Zc&&t.projectId===this.projectId&&t.database===this.database}}function DH(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new dt(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zc(e.options.projectId,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM="__type__",LH="__max__",Hd={mapValue:{}},qM="__vector__",wf="value";function Ao(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Y_(e)?4:qH(e)?9007199254740991:VH(e)?10:11:At(28295,{value:e})}function Kr(e,t){if(e===t)return!0;const n=Ao(e);if(n!==Ao(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return pu(e).isEqual(pu(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=So(r.timestampValue),a=So(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,s){return Io(r.bytesValue).isEqual(Io(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,s){return qe(r.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(r.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(e,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return qe(r.integerValue)===qe(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=qe(r.doubleValue),a=qe(s.doubleValue);return o===a?xf(o)===xf(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return Jc(e.arrayValue.values||[],t.arrayValue.values||[],Kr);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(Mk(o)!==Mk(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Kr(o[c],a[c])))return!1;return!0}(e,t);default:return At(52216,{left:e})}}function vu(e,t){return(e.values||[]).find(n=>Kr(n,t))!==void 0}function tl(e,t){if(e===t)return 0;const n=Ao(e),i=Ao(t);if(n!==i)return Ht(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ht(e.booleanValue,t.booleanValue);case 2:return function(s,o){const a=qe(s.integerValue||s.doubleValue),c=qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(e,t);case 3:return Lk(e.timestampValue,t.timestampValue);case 4:return Lk(pu(e),pu(t));case 5:return bx(e.stringValue,t.stringValue);case 6:return function(s,o){const a=Io(s),c=Io(o);return a.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const u=Ht(a[h],c[h]);if(u!==0)return u}return Ht(a.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const a=Ht(qe(s.latitude),qe(o.latitude));return a!==0?a:Ht(qe(s.longitude),qe(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Vk(e.arrayValue,t.arrayValue);case 10:return function(s,o){var f,v,y,w;const a=s.fields||{},c=o.fields||{},h=(f=a[wf])==null?void 0:f.arrayValue,u=(v=c[wf])==null?void 0:v.arrayValue,d=Ht(((y=h==null?void 0:h.values)==null?void 0:y.length)||0,((w=u==null?void 0:u.values)==null?void 0:w.length)||0);return d!==0?d:Vk(h,u)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Hd.mapValue&&o===Hd.mapValue)return 0;if(s===Hd.mapValue)return 1;if(o===Hd.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},u=Object.keys(h);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=bx(c[d],u[d]);if(f!==0)return f;const v=tl(a[c[d]],h[u[d]]);if(v!==0)return v}return Ht(c.length,u.length)}(e.mapValue,t.mapValue);default:throw At(23264,{he:n})}}function Lk(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Ht(e,t);const n=So(e),i=So(t),r=Ht(n.seconds,i.seconds);return r!==0?r:Ht(n.nanos,i.nanos)}function Vk(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const s=tl(n[r],i[r]);if(s)return s}return Ht(n.length,i.length)}function el(e){return Cx(e)}function Cx(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=So(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Io(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Ct.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",r=!0;for(const s of n.values||[])r?r=!1:i+=",",i+=Cx(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Cx(n.fields[o])}`;return r+"}"}(e.mapValue):At(61005,{value:e})}function Tg(e){switch(Ao(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Vm(e);return t?16+Tg(t):16;case 5:return 2*e.stringValue.length;case 6:return Io(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+Tg(s),0)}(e.arrayValue);case 10:case 11:return function(i){let r=0;return Uo(i.fields,(s,o)=>{r+=s.length+Tg(o)}),r}(e.mapValue);default:throw At(13486,{value:e})}}function qk(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function kx(e){return!!e&&"integerValue"in e}function X_(e){return!!e&&"arrayValue"in e}function jk(e){return!!e&&"nullValue"in e}function Fk(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Cg(e){return!!e&&"mapValue"in e}function VH(e){var n,i;return((i=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[VM])==null?void 0:i.stringValue)===qM}function Ph(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Uo(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=Ph(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ph(e.arrayValue.values[n]);return t}return{...e}}function qH(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===LH}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(t){this.value=t}static empty(){return new ci({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!Cg(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ph(n)}setAll(t){let n=un.emptyPath(),i={},r=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=Ph(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(t){const n=this.field(t.popLast());Cg(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Kr(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=n.mapValue.fields[t.get(i)];Cg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(t,n,i){Uo(n,(r,s)=>t[r]=s);for(const r of i)delete t[r]}clone(){return new ci(Ph(this.value))}}function jM(e){const t=[];return Uo(e.fields,(n,i)=>{const r=new un([n]);if(Cg(i)){const s=jM(i.mapValue).fields;if(s.length===0)t.push(r);else for(const o of s)t.push(r.child(o))}else t.push(r)}),new xi(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(t,n,i,r,s,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new An(t,0,Lt.min(),Lt.min(),Lt.min(),ci.empty(),0)}static newFoundDocument(t,n,i,r){return new An(t,1,n,Lt.min(),i,r,0)}static newNoDocument(t,n){return new An(t,2,n,Lt.min(),Lt.min(),ci.empty(),0)}static newUnknownDocument(t,n){return new An(t,3,n,Lt.min(),Lt.min(),ci.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ci.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ci.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof An&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new An(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(t,n){this.position=t,this.inclusive=n}}function Uk(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(s.field.isKeyField()?i=Ct.comparator(Ct.fromName(o.referenceValue),n.key):i=tl(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ok(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Kr(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(t,n="asc"){this.field=t,this.dir=n}}function jH(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{}class $e extends FM{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new UH(t,n,i):n==="array-contains"?new GH(t,i):n==="in"?new HH(t,i):n==="not-in"?new $H(t,i):n==="array-contains-any"?new zH(t,i):new $e(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new OH(t,i):new BH(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(tl(n,this.value)):n!==null&&Ao(this.value)===Ao(n)&&this.matchesComparison(tl(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return At(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kr extends FM{constructor(t,n){super(),this.filters=t,this.op=n,this.Pe=null}static create(t,n){return new kr(t,n)}matches(t){return UM(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function UM(e){return e.op==="and"}function OM(e){return FH(e)&&UM(e)}function FH(e){for(const t of e.filters)if(t instanceof kr)return!1;return!0}function Nx(e){if(e instanceof $e)return e.field.canonicalString()+e.op.toString()+el(e.value);if(OM(e))return e.filters.map(t=>Nx(t)).join(",");{const t=e.filters.map(n=>Nx(n)).join(",");return`${e.op}(${t})`}}function BM(e,t){return e instanceof $e?function(i,r){return r instanceof $e&&i.op===r.op&&i.field.isEqual(r.field)&&Kr(i.value,r.value)}(e,t):e instanceof kr?function(i,r){return r instanceof kr&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&BM(o,r.filters[a]),!0):!1}(e,t):void At(19439)}function GM(e){return e instanceof $e?function(n){return`${n.field.canonicalString()} ${n.op} ${el(n.value)}`}(e):e instanceof kr?function(n){return n.op.toString()+" {"+n.getFilters().map(GM).join(" ,")+"}"}(e):"Filter"}class UH extends $e{constructor(t,n,i){super(t,n,i),this.key=Ct.fromName(i.referenceValue)}matches(t){const n=Ct.comparator(t.key,this.key);return this.matchesComparison(n)}}class OH extends $e{constructor(t,n){super(t,"in",n),this.keys=HM("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class BH extends $e{constructor(t,n){super(t,"not-in",n),this.keys=HM("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function HM(e,t){var n;return(((n=t.arrayValue)==null?void 0:n.values)||[]).map(i=>Ct.fromName(i.referenceValue))}class GH extends $e{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return X_(n)&&vu(n.arrayValue,this.value)}}class HH extends $e{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&vu(this.value.arrayValue,n)}}class $H extends $e{constructor(t,n){super(t,"not-in",n)}matches(t){if(vu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!vu(this.value.arrayValue,n)}}class zH extends $e{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!X_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>vu(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KH{constructor(t,n=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Bk(e,t=null,n=[],i=[],r=null,s=null,o=null){return new KH(e,t,n,i,r,s,o)}function J_(e){const t=qt(e);if(t.Te===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>Nx(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Lm(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>el(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>el(i)).join(",")),t.Te=n}return t.Te}function Z_(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!jH(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!BM(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ok(e.startAt,t.startAt)&&Ok(e.endAt,t.endAt)}function Ex(e){return Ct.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(t,n=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function WH(e,t,n,i,r,s,o,a){return new bl(e,t,n,i,r,s,o,a)}function tw(e){return new bl(e)}function Gk(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function QH(e){return Ct.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}function $M(e){return e.collectionGroup!==null}function Mh(e){const t=qt(e);if(t.Ie===null){t.Ie=[];const n=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),n.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new en(un.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new yu(s,i))}),n.has(un.keyField().canonicalString())||t.Ie.push(new yu(un.keyField(),i))}return t.Ie}function Ur(e){const t=qt(e);return t.Ee||(t.Ee=YH(t,Mh(e))),t.Ee}function YH(e,t){if(e.limitType==="F")return Bk(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new yu(r.field,s)});const n=e.endAt?new bf(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new bf(e.startAt.position,e.startAt.inclusive):null;return Bk(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function Sx(e,t){const n=e.filters.concat([t]);return new bl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function XH(e,t){const n=e.explicitOrderBy.concat([t]);return new bl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function Tf(e,t,n){return new bl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function qm(e,t){return Z_(Ur(e),Ur(t))&&e.limitType===t.limitType}function zM(e){return`${J_(Ur(e))}|lt:${e.limitType}`}function Za(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>GM(r)).join(", ")}]`),Lm(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>el(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>el(r)).join(",")),`Target(${i})`}(Ur(e))}; limitType=${e.limitType})`}function jm(e,t){return t.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ct.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,r){for(const s of Mh(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(e,t)&&function(i,r){return!(i.startAt&&!function(o,a,c){const h=Uk(o,a,c);return o.inclusive?h<=0:h<0}(i.startAt,Mh(i),r)||i.endAt&&!function(o,a,c){const h=Uk(o,a,c);return o.inclusive?h>=0:h>0}(i.endAt,Mh(i),r))}(e,t)}function JH(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function KM(e){return(t,n)=>{let i=!1;for(const r of Mh(e)){const s=ZH(r,t,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function ZH(e,t,n){const i=e.field.isKeyField()?Ct.comparator(t.key,n.key):function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?tl(c,h):At(42886)}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return At(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,n]);r.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Uo(this.inner,(n,i)=>{for(const[r,s]of i)t(r,s)})}isEmpty(){return AM(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8=new We(Ct.comparator);function Ns(){return t8}const WM=new We(Ct.comparator);function vh(...e){let t=WM;for(const n of e)t=t.insert(n.key,n);return t}function QM(e){let t=WM;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function oa(){return Dh()}function YM(){return Dh()}function Dh(){return new ja(e=>e.toString(),(e,t)=>e.isEqual(t))}const e8=new We(Ct.comparator),n8=new en(Ct.comparator);function $t(...e){let t=n8;for(const n of e)t=t.add(n);return t}const i8=new en(Ht);function r8(){return i8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xf(t)?"-0":t}}function XM(e){return{integerValue:""+e}}function s8(e,t){return IH(t)?XM(t):ew(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(){this._=void 0}}function o8(e,t,n){return e instanceof xu?function(r,s){const o={fields:{[MM]:{stringValue:PM},[LM]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Y_(s)&&(s=Vm(s)),s&&(o.fields[DM]=s),{mapValue:o}}(n,t):e instanceof _u?ZM(e,t):e instanceof wu?t2(e,t):function(r,s){const o=JM(r,s),a=Hk(o)+Hk(r.Ae);return kx(o)&&kx(r.Ae)?XM(a):ew(r.serializer,a)}(e,t)}function a8(e,t,n){return e instanceof _u?ZM(e,t):e instanceof wu?t2(e,t):n}function JM(e,t){return e instanceof Cf?function(i){return kx(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class xu extends Fm{}class _u extends Fm{constructor(t){super(),this.elements=t}}function ZM(e,t){const n=e2(t);for(const i of e.elements)n.some(r=>Kr(r,i))||n.push(i);return{arrayValue:{values:n}}}class wu extends Fm{constructor(t){super(),this.elements=t}}function t2(e,t){let n=e2(t);for(const i of e.elements)n=n.filter(r=>!Kr(r,i));return{arrayValue:{values:n}}}class Cf extends Fm{constructor(t,n){super(),this.serializer=t,this.Ae=n}}function Hk(e){return qe(e.integerValue||e.doubleValue)}function e2(e){return X_(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(t,n){this.field=t,this.transform=n}}function l8(e,t){return e.field.isEqual(t.field)&&function(i,r){return i instanceof _u&&r instanceof _u||i instanceof wu&&r instanceof wu?Jc(i.elements,r.elements,Kr):i instanceof Cf&&r instanceof Cf?Kr(i.Ae,r.Ae):i instanceof xu&&r instanceof xu}(e.transform,t.transform)}class h8{constructor(t,n){this.version=t,this.transformResults=n}}class vr{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new vr}static exists(t){return new vr(void 0,t)}static updateTime(t){return new vr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function kg(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Um{}function n2(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new r2(e.key,vr.none()):new $u(e.key,e.data,vr.none());{const n=e.data,i=ci.empty();let r=new en(un.comparator);for(let s of t.fields)if(!r.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Oo(e.key,i,new xi(r.toArray()),vr.none())}}function u8(e,t,n){e instanceof $u?function(r,s,o){const a=r.value.clone(),c=zk(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Oo?function(r,s,o){if(!kg(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=zk(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(i2(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Lh(e,t,n,i){return e instanceof $u?function(s,o,a,c){if(!kg(s.precondition,o))return a;const h=s.value.clone(),u=Kk(s.fieldTransforms,c,o);return h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(e,t,n,i):e instanceof Oo?function(s,o,a,c){if(!kg(s.precondition,o))return a;const h=Kk(s.fieldTransforms,c,o),u=o.data;return u.setAll(i2(s)),u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,i):function(s,o,a){return kg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function d8(e,t){let n=null;for(const i of e.fieldTransforms){const r=t.data.field(i.field),s=JM(i.transform,r||null);s!=null&&(n===null&&(n=ci.empty()),n.set(i.field,s))}return n||null}function $k(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Jc(i,r,(s,o)=>l8(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class $u extends Um{constructor(t,n,i,r=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Oo extends Um{constructor(t,n,i,r,s=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function i2(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function zk(e,t,n){const i=new Map;ne(e.length===n.length,32656,{Ve:n.length,de:e.length});for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,a8(o,a,n[r]))}return i}function Kk(e,t,n){const i=new Map;for(const r of e){const s=r.transform,o=n.data.field(r.field);i.set(r.field,o8(s,o,t))}return i}class r2 extends Um{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class g8 extends Um{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(t,n,i,r){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&u8(s,t,i[r])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=Lh(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=Lh(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=YM();return this.mutations.forEach(r=>{const s=t.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(r.key)?null:a;const c=n2(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Lt.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),$t())}isEqual(t){return this.batchId===t.batchId&&Jc(this.mutations,t.mutations,(n,i)=>$k(n,i))&&Jc(this.baseMutations,t.baseMutations,(n,i)=>$k(n,i))}}class nw{constructor(t,n,i,r){this.batch=t,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(t,n,i){ne(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let r=function(){return e8}();const s=t.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new nw(t,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be,Kt;function v8(e){switch(e){case X.OK:return At(64938);case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0;default:return At(15467,{code:e})}}function s2(e){if(e===void 0)return ks("GRPC error has no .code"),X.UNKNOWN;switch(e){case Be.OK:return X.OK;case Be.CANCELLED:return X.CANCELLED;case Be.UNKNOWN:return X.UNKNOWN;case Be.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case Be.INTERNAL:return X.INTERNAL;case Be.UNAVAILABLE:return X.UNAVAILABLE;case Be.UNAUTHENTICATED:return X.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case Be.NOT_FOUND:return X.NOT_FOUND;case Be.ALREADY_EXISTS:return X.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return X.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case Be.ABORTED:return X.ABORTED;case Be.OUT_OF_RANGE:return X.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return X.UNIMPLEMENTED;case Be.DATA_LOSS:return X.DATA_LOSS;default:return At(39323,{code:e})}}(Kt=Be||(Be={}))[Kt.OK=0]="OK",Kt[Kt.CANCELLED=1]="CANCELLED",Kt[Kt.UNKNOWN=2]="UNKNOWN",Kt[Kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kt[Kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kt[Kt.NOT_FOUND=5]="NOT_FOUND",Kt[Kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kt[Kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kt[Kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kt[Kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kt[Kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kt[Kt.ABORTED=10]="ABORTED",Kt[Kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kt[Kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kt[Kt.INTERNAL=13]="INTERNAL",Kt[Kt.UNAVAILABLE=14]="UNAVAILABLE",Kt[Kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x8=new xo([4294967295,4294967295],0);function Wk(e){const t=y8().encode(e),n=new vM;return n.update(t),new Uint8Array(n.digest())}function Qk(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new xo([n,i],0),new xo([r,s],0)]}class iw{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new yh(`Invalid padding: ${n}`);if(i<0)throw new yh(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new yh(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new yh(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*t.length-n,this.pe=xo.fromNumber(this.ge)}ye(t,n,i){let r=t.add(n.multiply(xo.fromNumber(i)));return r.compare(x8)===1&&(r=new xo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const n=Wk(t),[i,r]=Qk(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(t,n,i){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new iw(s,r,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.ge===0)return;const n=Wk(t),[i,r]=Qk(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.be(o)}}be(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class yh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(t,n,i,r,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const r=new Map;return r.set(t,zu.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new Om(Lt.min(),r,new We(Ht),Ns(),$t())}}class zu{constructor(t,n,i,r,s){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new zu(i,n,$t(),$t(),$t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(t,n,i,r){this.Se=t,this.removedTargetIds=n,this.key=i,this.De=r}}class o2{constructor(t,n){this.targetId=t,this.Ce=n}}class a2{constructor(t,n,i=fn.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=r}}class Yk{constructor(){this.ve=0,this.Fe=Xk(),this.Me=fn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=$t(),n=$t(),i=$t();return this.Fe.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:At(38017,{changeType:s})}}),new zu(this.Me,this.xe,t,n,i)}Ke(){this.Oe=!1,this.Fe=Xk()}qe(t,n){this.Oe=!0,this.Fe=this.Fe.insert(t,n)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,ne(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class _8{constructor(t){this.Ge=t,this.ze=new Map,this.je=Ns(),this.He=$d(),this.Je=$d(),this.Ze=new We(Ht)}Xe(t){for(const n of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(n,t.De):this.et(n,t.key,t.De);for(const n of t.removedTargetIds)this.et(n,t.key,t.De)}tt(t){this.forEachTarget(t,n=>{const i=this.nt(n);switch(t.state){case 0:this.rt(n)&&i.Le(t.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(t.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(t.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(t.resumeToken));break;default:At(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ze.forEach((i,r)=>{this.rt(r)&&n(r)})}st(t){const n=t.targetId,i=t.Ce.count,r=this.ot(n);if(r){const s=r.target;if(Ex(s))if(i===0){const o=new Ct(s.path);this.et(n,o,An.newNoDocument(o,Lt.min()))}else ne(i===1,20013,{expectedCount:i});else{const o=this._t(n);if(o!==i){const a=this.ut(t),c=a?this.ct(a,t,o):1;if(c!==0){this.it(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,h)}}}}}ut(t){const n=t.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let o,a;try{o=Io(i).toUint8Array()}catch(c){if(c instanceof RM)return ba("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new iw(o,r,s)}catch(c){return ba(c instanceof yh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(t,n,i){return n.Ce.count===i-this.Pt(t,n.targetId)?0:2}Pt(t,n){const i=this.Ge.getRemoteKeysForTarget(n);let r=0;return i.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.et(n,s,null),r++)}),r}Tt(t){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Ex(a.target)){const c=new Ct(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,An.newNoDocument(c,t))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let i=$t();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.je.forEach((s,o)=>o.setReadTime(t));const r=new Om(t,n,this.Ze,this.je,i);return this.je=Ns(),this.He=$d(),this.Je=$d(),this.Ze=new We(Ht),r}Ye(t,n){if(!this.rt(t))return;const i=this.Et(t,n.key)?2:0;this.nt(t).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(t)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(t))}et(t,n,i){if(!this.rt(t))return;const r=this.nt(t);this.Et(t,n)?r.qe(n,1):r.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(t)),this.Je=this.Je.insert(n,this.Rt(n).add(t)),i&&(this.je=this.je.insert(n,i))}removeTarget(t){this.ze.delete(t)}_t(t){const n=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let n=this.ze.get(t);return n||(n=new Yk,this.ze.set(t,n)),n}Rt(t){let n=this.Je.get(t);return n||(n=new en(Ht),this.Je=this.Je.insert(t,n)),n}It(t){let n=this.He.get(t);return n||(n=new en(Ht),this.He=this.He.insert(t,n)),n}rt(t){const n=this.ot(t)!==null;return n||vt("WatchChangeAggregator","Detected inactive target",t),n}ot(t){const n=this.ze.get(t);return n&&n.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Yk),this.Ge.getRemoteKeysForTarget(t).forEach(n=>{this.et(t,n,null)})}Et(t,n){return this.Ge.getRemoteKeysForTarget(t).has(n)}}function $d(){return new We(Ct.comparator)}function Xk(){return new We(Ct.comparator)}const w8={asc:"ASCENDING",desc:"DESCENDING"},b8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},T8={and:"AND",or:"OR"};class C8{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Ix(e,t){return e.useProto3Json||Lm(t)?t:{value:t}}function kf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function c2(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function k8(e,t){return kf(e,t.toTimestamp())}function Or(e){return ne(!!e,49232),Lt.fromTimestamp(function(n){const i=So(n);return new ue(i.seconds,i.nanos)}(e))}function rw(e,t){return Ax(e,t).canonicalString()}function Ax(e,t){const n=function(r){return new he(["projects",r.projectId,"databases",r.database])}(e).child("documents");return t===void 0?n:n.child(t)}function l2(e){const t=he.fromString(e);return ne(f2(t),10190,{key:t.toString()}),t}function Rx(e,t){return rw(e.databaseId,t.path)}function Nv(e,t){const n=l2(t);if(n.get(1)!==e.databaseId.projectId)throw new dt(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new dt(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ct(u2(n))}function h2(e,t){return rw(e.databaseId,t)}function N8(e){const t=l2(e);return t.length===4?he.emptyPath():u2(t)}function Px(e){return new he(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function u2(e){return ne(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function Jk(e,t,n){return{name:Rx(e,t),fields:n.value.mapValue.fields}}function E8(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:At(39313,{state:h})}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(h,u){return h.useProto3Json?(ne(u===void 0||typeof u=="string",58123),fn.fromBase64String(u||"")):(ne(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),fn.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(h){const u=h.code===void 0?X.UNKNOWN:s2(h.code);return new dt(u,h.message||"")}(o);n=new a2(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=Nv(e,i.document.name),s=Or(i.document.updateTime),o=i.document.createTime?Or(i.document.createTime):Lt.min(),a=new ci({mapValue:{fields:i.document.fields}}),c=An.newFoundDocument(r,s,o,a),h=i.targetIds||[],u=i.removedTargetIds||[];n=new Ng(h,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=Nv(e,i.document),s=i.readTime?Or(i.readTime):Lt.min(),o=An.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Ng([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=Nv(e,i.document),s=i.removedTargetIds||[];n=new Ng([],s,r,null)}else{if(!("filter"in t))return At(11601,{Vt:t});{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new p8(r,s),a=i.targetId;n=new o2(a,o)}}return n}function S8(e,t){let n;if(t instanceof $u)n={update:Jk(e,t.key,t.value)};else if(t instanceof r2)n={delete:Rx(e,t.key)};else if(t instanceof Oo)n={update:Jk(e,t.key,t.data),updateMask:q8(t.fieldMask)};else{if(!(t instanceof g8))return At(16599,{dt:t.type});n={verify:Rx(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof xu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof _u)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Cf)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw At(20930,{transform:o.transform})}(0,i))),t.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:k8(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:At(27497)}(e,t.precondition)),n}function I8(e,t){return e&&e.length>0?(ne(t!==void 0,14353),e.map(n=>function(r,s){let o=r.updateTime?Or(r.updateTime):Or(s);return o.isEqual(Lt.min())&&(o=Or(s)),new h8(o,r.transformResults||[])}(n,t))):[]}function A8(e,t){return{documents:[h2(e,t.path)]}}function R8(e,t){const n={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=h2(e,r);const s=function(h){if(h.length!==0)return g2(kr.create(h,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(u=>function(f){return{field:tc(f.field),direction:D8(f.dir)}}(u))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ix(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(t.endAt)),{ft:n,parent:r}}function P8(e){let t=N8(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ne(i===1,65062);const u=n.from[0];u.allDescendants?r=u.collectionId:t=t.child(u.collectionId)}let s=[];n.where&&(s=function(d){const f=d2(d);return f instanceof kr&&OM(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(f=>function(y){return new yu(ec(y.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Lm(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(d){const f=!!d.before,v=d.values||[];return new bf(v,f)}(n.startAt));let h=null;return n.endAt&&(h=function(d){const f=!d.before,v=d.values||[];return new bf(v,f)}(n.endAt)),WH(t,r,o,s,a,"F",c,h)}function M8(e,t){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return At(28987,{purpose:r})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function d2(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=ec(n.unaryFilter.field);return $e.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=ec(n.unaryFilter.field);return $e.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ec(n.unaryFilter.field);return $e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ec(n.unaryFilter.field);return $e.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return At(61313);default:return At(60726)}}(e):e.fieldFilter!==void 0?function(n){return $e.create(ec(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return At(58110);default:return At(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return kr.create(n.compositeFilter.filters.map(i=>d2(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return At(1026)}}(n.compositeFilter.op))}(e):At(30097,{filter:e})}function D8(e){return w8[e]}function L8(e){return b8[e]}function V8(e){return T8[e]}function tc(e){return{fieldPath:e.canonicalString()}}function ec(e){return un.fromServerFormat(e.fieldPath)}function g2(e){return e instanceof $e?function(n){if(n.op==="=="){if(Fk(n.value))return{unaryFilter:{field:tc(n.field),op:"IS_NAN"}};if(jk(n.value))return{unaryFilter:{field:tc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Fk(n.value))return{unaryFilter:{field:tc(n.field),op:"IS_NOT_NAN"}};if(jk(n.value))return{unaryFilter:{field:tc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tc(n.field),op:L8(n.op),value:n.value}}}(e):e instanceof kr?function(n){const i=n.getFilters().map(r=>g2(r));return i.length===1?i[0]:{compositeFilter:{op:V8(n.op),filters:i}}}(e):At(54877,{filter:e})}function q8(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function f2(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}function m2(e){return!!e&&typeof e._toProto=="function"&&e._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(t,n,i,r,s=Lt.min(),o=Lt.min(),a=fn.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new oo(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(t){this.yt=t}}function F8(e){const t=P8({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Tf(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U8{constructor(){this.Sn=new O8}addToCollectionParentIndex(t,n){return this.Sn.add(n),tt.resolve()}getCollectionParents(t,n){return tt.resolve(this.Sn.getEntries(n))}addFieldIndex(t,n){return tt.resolve()}deleteFieldIndex(t,n){return tt.resolve()}deleteAllFieldIndexes(t){return tt.resolve()}createTargetIndexes(t,n){return tt.resolve()}getDocumentsMatchingTarget(t,n){return tt.resolve(null)}getIndexType(t,n){return tt.resolve(0)}getFieldIndexes(t,n){return tt.resolve([])}getNextCollectionGroupToUpdate(t){return tt.resolve(null)}getMinOffset(t,n){return tt.resolve(Eo.min())}getMinOffsetFromCollectionGroup(t,n){return tt.resolve(Eo.min())}updateCollectionGroup(t,n,i){return tt.resolve()}updateIndexEntries(t,n){return tt.resolve()}}class O8{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n]||new en(he.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(t){return(this.index[t]||new en(he.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},p2=41943040;class si{static withCacheSize(t){return new si(t,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(p2,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new nl(0)}static ar(){return new nl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN="LruGarbageCollector",B8=1048576;function eN([e,t],[n,i]){const r=Ht(e,n);return r===0?Ht(t,i):r}class G8{constructor(t){this.Pr=t,this.buffer=new en(eN),this.Tr=0}Ir(){return++this.Tr}Er(t){const n=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();eN(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class H8{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){vt(tN,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){wl(n)?vt(tN,"Ignoring IndexedDB error during garbage collection: ",n):await _l(n)}await this.Ar(3e5)})}}class $8{constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.dr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return tt.resolve(Dm.ce);const i=new G8(n);return this.Vr.forEachTarget(t,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(t,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.Vr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(vt("LruGarbageCollector","Garbage collection skipped; disabled"),tt.resolve(Zk)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(vt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Zk):this.gr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,n){let i,r,s,o,a,c,h;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(vt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(t,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(t,i,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,i))).next(d=>(h=Date.now(),Ja()<=Ot.DEBUG&&vt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(h-c)+`ms
Total Duration: ${h-u}ms`),tt.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}}function z8(e,t){return new $8(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(){this.changes=new ja(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,An.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?tt.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(t,n,i,r){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,n))).next(r=>(i!==null&&Lh(i.mutation,r,xi.empty(),ue.now()),r))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,$t()).next(()=>i))}getLocalViewOfDocuments(t,n,i=$t()){const r=oa();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,i).next(s=>{let o=vh();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=oa();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,$t()))}populateOverlays(t,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(t,r).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,r){let s=Ns();const o=Dh(),a=function(){return Dh()}();return n.forEach((c,h)=>{const u=i.get(h.key);r.has(h.key)&&(u===void 0||u.mutation instanceof Oo)?s=s.insert(h.key,h):u!==void 0?(o.set(h.key,u.mutation.getFieldMask()),Lh(u.mutation,h,u.mutation.getFieldMask(),ue.now())):o.set(h.key,xi.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((h,u)=>o.set(h,u)),n.forEach((h,u)=>a.set(h,new W8(u,o.get(h)??null))),a))}recalculateAndSaveOverlays(t,n){const i=Dh();let r=new We((o,a)=>o-a),s=$t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let u=i.get(c)||xi.empty();u=a.applyToLocalView(h,u),i.set(c,u);const d=(r.get(a.batchId)||$t()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,u=c.value,d=YM();u.forEach(f=>{if(!s.has(f)){const v=n2(n.get(f),i.get(f));v!==null&&d.set(f,v),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,d))}return tt.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,r){return QH(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):$M(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,r):this.getDocumentsMatchingCollectionQuery(t,n,i,r)}getNextDocuments(t,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,r-s.size):tt.resolve(oa());let a=mu,c=s;return o.next(h=>tt.forEach(h,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?tt.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(t,h,s)).next(()=>this.computeViews(t,c,h,$t())).next(u=>({batchId:a,changes:QM(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Ct(n)).next(i=>{let r=vh();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,n,i,r){const s=n.collectionGroup;let o=vh();return this.indexManager.getCollectionParents(t,s).next(a=>tt.forEach(a,c=>{const h=function(d,f){return new bl(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,i,r).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,s,r))).next(o=>{s.forEach((c,h)=>{const u=h.getKey();o.get(u)===null&&(o=o.insert(u,An.newInvalidDocument(u)))});let a=vh();return o.forEach((c,h)=>{const u=s.get(c);u!==void 0&&Lh(u.mutation,h,xi.empty(),ue.now()),jm(n,h)&&(a=a.insert(c,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,n){return tt.resolve(this.Nr.get(n))}saveBundleMetadata(t,n){return this.Nr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Or(r.createTime)}}(n)),tt.resolve()}getNamedQuery(t,n){return tt.resolve(this.Br.get(n))}saveNamedQuery(t,n){return this.Br.set(n.name,function(r){return{name:r.name,query:F8(r.bundledQuery),readTime:Or(r.readTime)}}(n)),tt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(){this.overlays=new We(Ct.comparator),this.Lr=new Map}getOverlay(t,n){return tt.resolve(this.overlays.get(n))}getOverlays(t,n){const i=oa();return tt.forEach(n,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((r,s)=>{this.bt(t,n,s)}),tt.resolve()}removeOverlaysForBatchId(t,n,i){const r=this.Lr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(i)),tt.resolve()}getOverlaysForCollection(t,n,i){const r=oa(),s=n.length+1,o=new Ct(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return tt.resolve(r)}getOverlaysForCollectionGroup(t,n,i,r){let s=new We((h,u)=>h-u);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>i){let u=s.get(h.largestBatchId);u===null&&(u=oa(),s=s.insert(h.largestBatchId,u)),u.set(h.getKey(),h)}}const a=oa(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,u)=>a.set(h,u)),!(a.size()>=r)););return tt.resolve(a)}bt(t,n,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new m8(n,i));let s=this.Lr.get(n);s===void 0&&(s=$t(),this.Lr.set(n,s)),this.Lr.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(){this.sessionToken=fn.EMPTY_BYTE_STRING}getSessionToken(t){return tt.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,tt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(){this.kr=new en(cn.Kr),this.qr=new en(cn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,n){const i=new cn(t,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.Wr(new cn(t,n))}Qr(t,n){t.forEach(i=>this.removeReference(i,n))}Gr(t){const n=new Ct(new he([])),i=new cn(n,t),r=new cn(n,t+1),s=[];return this.qr.forEachInRange([i,r],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(t=>this.Wr(t))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const n=new Ct(new he([])),i=new cn(n,t),r=new cn(n,t+1);let s=$t();return this.qr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new cn(t,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class cn{constructor(t,n){this.key=t,this.Hr=n}static Kr(t,n){return Ct.comparator(t.key,n.key)||Ht(t.Hr,n.Hr)}static Ur(t,n){return Ht(t.Hr,n.Hr)||Ct.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new en(cn.Kr)}checkEmpty(t){return tt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,r){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new f8(s,n,i,r);this.mutationQueue.push(o);for(const a of r)this.Jr=this.Jr.add(new cn(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return tt.resolve(o)}lookupMutationBatch(t,n){return tt.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,r=this.Xr(i),s=r<0?0:r;return tt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return tt.resolve(this.mutationQueue.length===0?Q_:this.Yn-1)}getAllMutationBatches(t){return tt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new cn(n,0),r=new cn(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([i,r],o=>{const a=this.Zr(o.Hr);s.push(a)}),tt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new en(Ht);return n.forEach(r=>{const s=new cn(r,0),o=new cn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{i=i.add(a.Hr)})}),tt.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,r=i.length+1;let s=i;Ct.isDocumentKey(s)||(s=s.child(""));const o=new cn(new Ct(s),0);let a=new en(Ht);return this.Jr.forEachWhile(c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Hr)),!0)},o),tt.resolve(this.Yr(a))}Yr(t){const n=[];return t.forEach(i=>{const r=this.Zr(i);r!==null&&n.push(r)}),n}removeMutationBatch(t,n){ne(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return tt.forEach(n.mutations,r=>{const s=new cn(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Jr=i})}nr(t){}containsKey(t,n){const i=new cn(n,0),r=this.Jr.firstAfterOrEqual(i);return tt.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,tt.resolve()}ei(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(t){this.ti=t,this.docs=function(){return new We(Ct.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,o=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return tt.resolve(i?i.document.mutableCopy():An.newInvalidDocument(n))}getEntries(t,n){let i=Ns();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():An.newInvalidDocument(r))}),tt.resolve(i)}getDocumentsMatchingQuery(t,n,i,r){let s=Ns();const o=n.path,a=new Ct(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:u}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||kH(CH(u),i)<=0||(r.has(u.key)||jm(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return tt.resolve(s)}getAllFromCollectionGroup(t,n,i,r){At(9500)}ni(t,n){return tt.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new e$(this)}getSize(t){return tt.resolve(this.size)}}class e$ extends K8{constructor(t){super(),this.Mr=t}applyChanges(t){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.Mr.addEntry(t,r)):this.Mr.removeEntry(i)}),tt.waitFor(n)}getFromCache(t,n){return this.Mr.getEntry(t,n)}getAllFromCache(t,n){return this.Mr.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n${constructor(t){this.persistence=t,this.ri=new ja(n=>J_(n),Z_),this.lastRemoteSnapshotVersion=Lt.min(),this.highestTargetId=0,this.ii=0,this.si=new sw,this.targetCount=0,this.oi=nl._r()}forEachTarget(t,n){return this.ri.forEach((i,r)=>n(r)),tt.resolve()}getLastRemoteSnapshotVersion(t){return tt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return tt.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),tt.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),tt.resolve()}lr(t){this.ri.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.oi=new nl(n),this.highestTargetId=n),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,n){return this.lr(n),this.targetCount+=1,tt.resolve()}updateTargetData(t,n){return this.lr(n),tt.resolve()}removeTargetData(t,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,tt.resolve()}removeTargets(t,n,i){let r=0;const s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)}),tt.waitFor(s).next(()=>r)}getTargetCount(t){return tt.resolve(this.targetCount)}getTargetData(t,n){const i=this.ri.get(n)||null;return tt.resolve(i)}addMatchingKeys(t,n,i){return this.si.$r(n,i),tt.resolve()}removeMatchingKeys(t,n,i){this.si.Qr(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(t,o))}),tt.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.si.Gr(n),tt.resolve()}getMatchingKeysForTargetId(t,n){const i=this.si.jr(n);return tt.resolve(i)}containsKey(t,n){return tt.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(t,n){this._i={},this.overlays={},this.ai=new Dm(0),this.ui=!1,this.ui=!0,this.ci=new J8,this.referenceDelegate=t(this),this.li=new n$(this),this.indexManager=new U8,this.remoteDocumentCache=function(r){return new t$(r)}(i=>this.referenceDelegate.hi(i)),this.serializer=new j8(n),this.Pi=new Y8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new X8,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this._i[t.toKey()];return i||(i=new Z8(n,this.referenceDelegate),this._i[t.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,n,i){vt("MemoryPersistence","Starting transaction:",t);const r=new i$(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(s=>this.referenceDelegate.Ii(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ei(t,n){return tt.or(Object.values(this._i).map(i=>()=>i.containsKey(t,n)))}}class i$ extends EH{constructor(t){super(),this.currentSequenceNumber=t}}class ow{constructor(t){this.persistence=t,this.Ri=new sw,this.Ai=null}static Vi(t){return new ow(t)}get di(){if(this.Ai)return this.Ai;throw At(60996)}addReference(t,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),tt.resolve()}removeReference(t,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),tt.resolve()}markPotentiallyOrphaned(t,n){return this.di.add(n.toString()),tt.resolve()}removeTarget(t,n){this.Ri.Gr(n.targetId).forEach(r=>this.di.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(r=>{r.forEach(s=>this.di.add(s.toString()))}).next(()=>i.removeTargetData(t,n))}Ti(){this.Ai=new Set}Ii(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tt.forEach(this.di,i=>{const r=Ct.fromPath(i);return this.mi(t,r).next(s=>{s||n.removeEntry(r,Lt.min())})}).next(()=>(this.Ai=null,n.apply(t)))}updateLimboDocument(t,n){return this.mi(t,n).next(i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(t){return 0}mi(t,n){return tt.or([()=>tt.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class Nf{constructor(t,n){this.persistence=t,this.fi=new ja(i=>AH(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=z8(this,n)}static Vi(t,n){return new Nf(t,n)}Ti(){}Ii(t){return tt.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}dr(t){const n=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(r=>i+r))}pr(t){let n=0;return this.mr(t,i=>{n++}).next(()=>n)}mr(t,n){return tt.forEach(this.fi,(i,r)=>this.wr(t,i,r).next(s=>s?tt.resolve():n(r)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ni(t,o=>this.wr(t,o,n).next(a=>{a||(i++,s.removeEntry(o,Lt.min()))})).next(()=>s.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.fi.set(n,t.currentSequenceNumber),tt.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.fi.set(i,t.currentSequenceNumber),tt.resolve()}removeReference(t,n,i){return this.fi.set(i,t.currentSequenceNumber),tt.resolve()}updateLimboDocument(t,n){return this.fi.set(n,t.currentSequenceNumber),tt.resolve()}hi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Tg(t.data.value)),n}wr(t,n,i){return tt.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const r=this.fi.get(n);return tt.resolve(r!==void 0&&r>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(t,n,i,r){this.targetId=t,this.fromCache=n,this.Ts=i,this.Is=r}static Es(t,n){let i=$t(),r=$t();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new aw(t,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s${constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return BG()?8:SH(Fn())>0?6:4}()}initialize(t,n){this.fs=t,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(t,n,i,r){const s={result:null};return this.gs(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(t,n,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new r$;return this.ys(t,n,o).next(a=>{if(s.result=a,this.As)return this.ws(t,n,o,a.size)})}).next(()=>s.result)}ws(t,n,i,r){return i.documentReadCount<this.Vs?(Ja()<=Ot.DEBUG&&vt("QueryEngine","SDK will not create cache indexes for query:",Za(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),tt.resolve()):(Ja()<=Ot.DEBUG&&vt("QueryEngine","Query:",Za(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(Ja()<=Ot.DEBUG&&vt("QueryEngine","The SDK decides to create cache indexes for query:",Za(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ur(n))):tt.resolve())}gs(t,n){if(Gk(n))return tt.resolve(null);let i=Ur(n);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Tf(n,null,"F"),i=Ur(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const o=$t(...s);return this.fs.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(c=>{const h=this.bs(n,a);return this.Ss(n,h,o,c.readTime)?this.gs(t,Tf(n,null,"F")):this.Ds(t,h,n,c)}))})))}ps(t,n,i,r){return Gk(n)||r.isEqual(Lt.min())?tt.resolve(null):this.fs.getDocuments(t,i).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,i,r)?tt.resolve(null):(Ja()<=Ot.DEBUG&&vt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Za(n)),this.Ds(t,o,n,TH(r,mu)).next(a=>a))})}bs(t,n){let i=new en(KM(t));return n.forEach((r,s)=>{jm(t,s)&&(i=i.add(s))}),i}Ss(t,n,i,r){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ys(t,n,i){return Ja()<=Ot.DEBUG&&vt("QueryEngine","Using full collection scan to execute query:",Za(n)),this.fs.getDocumentsMatchingQuery(t,n,Eo.min(),i)}Ds(t,n,i,r){return this.fs.getDocumentsMatchingQuery(t,i,r).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw="LocalStore",o$=3e8;class a${constructor(t,n,i,r){this.persistence=t,this.Cs=n,this.serializer=r,this.vs=new We(Ht),this.Fs=new ja(s=>J_(s),Z_),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(i)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Q8(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.vs))}}function c$(e,t,n,i){return new a$(e,t,n,i)}async function y2(e,t){const n=qt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.Os(t),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let c=$t();for(const h of r){o.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}for(const h of s){a.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(i,c).next(h=>({Ns:h,removedBatchIds:o,addedBatchIds:a}))})})}function l$(e,t){const n=qt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,h,u){const d=h.batch,f=d.keys();let v=tt.resolve();return f.forEach(y=>{v=v.next(()=>u.getEntry(c,y)).next(w=>{const _=h.docVersions.get(y);ne(_!==null,48541),w.version.compareTo(_)<0&&(d.applyToRemoteDocument(w,h),w.isValidDocument()&&(w.setReadTime(h.commitVersion),u.addEntry(w)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,i,t,s).next(()=>s.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let c=$t();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c}(t))).next(()=>n.localDocuments.getDocuments(i,r))})}function x2(e){const t=qt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.li.getLastRemoteSnapshotVersion(n))}function h$(e,t){const n=qt(e),i=t.snapshotVersion;let r=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});r=n.vs;const a=[];t.targetChanges.forEach((u,d)=>{const f=r.get(d);if(!f)return;a.push(n.li.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.li.addMatchingKeys(s,u.addedDocuments,d)));let v=f.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?v=v.withResumeToken(fn.EMPTY_BYTE_STRING,Lt.min()).withLastLimboFreeSnapshotVersion(Lt.min()):u.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(u.resumeToken,i)),r=r.insert(d,v),function(w,_,x){return w.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=o$?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,v,u)&&a.push(n.li.updateTargetData(s,v))});let c=Ns(),h=$t();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(u$(s,o,t.documentUpdates).next(u=>{c=u.Bs,h=u.Ls})),!i.isEqual(Lt.min())){const u=n.li.getLastRemoteSnapshotVersion(s).next(d=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return tt.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(n.vs=r,s))}function u$(e,t,n){let i=$t(),r=$t();return n.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let o=Ns();return n.forEach((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(Lt.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):vt(cw,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)}),{Bs:o,Ls:r}})}function d$(e,t){const n=qt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=Q_),n.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function g$(e,t){const n=qt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.li.getTargetData(i,t).next(s=>s?(r=s,tt.resolve(r)):n.li.allocateTargetId(i).next(o=>(r=new oo(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(t,i.targetId)),i})}async function Mx(e,t,n){const i=qt(e),r=i.vs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!wl(o))throw o;vt(cw,`Failed to update sequence numbers for target ${t}: ${o}`)}i.vs=i.vs.remove(t),i.Fs.delete(r.target)}function nN(e,t,n){const i=qt(e);let r=Lt.min(),s=$t();return i.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,u){const d=qt(c),f=d.Fs.get(u);return f!==void 0?tt.resolve(d.vs.get(f)):d.li.getTargetData(h,u)}(i,o,Ur(t)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.Cs.getDocumentsMatchingQuery(o,t,n?r:Lt.min(),n?s:$t())).next(a=>(f$(i,JH(t),a),{documents:a,ks:s})))}function f$(e,t,n){let i=e.Ms.get(t)||Lt.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.Ms.set(t,i)}class iN{constructor(){this.activeTargetIds=r8()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class m${constructor(){this.vo=new iN,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,n,i){this.Fo[t]=n}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new iN,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${Mo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="ConnectivityMonitor";class sN{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){vt(rN,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){vt(rN,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zd=null;function Dx(){return zd===null?zd=function(){return 268435456+Math.round(2147483648*Math.random())}():zd++,"0x"+zd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="RestConnection",v$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class y${get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+t.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===_f?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(t,n,i,r,s){const o=Dx(),a=this.Qo(t,n.toUriEncodedString());vt(Ev,`Sending RPC '${t}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,r,s);const{host:h}=new URL(a),u=Ds(h);return this.zo(t,a,c,i,u).then(d=>(vt(Ev,`Received RPC '${t}' ${o}: `,d),d),d=>{throw ba(Ev,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",i),d})}jo(t,n,i,r,s,o){return this.Wo(t,n,i,r,s)}Go(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>t[s]=r),i&&i.headers.forEach((r,s)=>t[s]=r)}Qo(t,n){const i=v$[t];let r=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x${constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="WebChannelConnection",ih=(e,t,n)=>{e.listen(t,i=>{try{n(i)}catch(r){setTimeout(()=>{throw r},0)}})};class Pc extends y${constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!Pc.c_){const t=wM();ih(t,_M.STAT_EVENT,n=>{n.stat===wx.PROXY?vt(kn,"STAT_EVENT: detected buffering proxy"):n.stat===wx.NOPROXY&&vt(kn,"STAT_EVENT: detected no buffering proxy")}),Pc.c_=!0}}zo(t,n,i,r,s){const o=Dx();return new Promise((a,c)=>{const h=new yM;h.setWithCredentials(!0),h.listenOnce(xM.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case bg.NO_ERROR:const d=h.getResponseJson();vt(kn,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case bg.TIMEOUT:vt(kn,`RPC '${t}' ${o} timed out`),c(new dt(X.DEADLINE_EXCEEDED,"Request time out"));break;case bg.HTTP_ERROR:const f=h.getStatus();if(vt(kn,`RPC '${t}' ${o} failed with status:`,f,"response text:",h.getResponseText()),f>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v==null?void 0:v.error;if(y&&y.status&&y.message){const w=function(x){const C=x.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(C)>=0?C:X.UNKNOWN}(y.status);c(new dt(w,y.message))}else c(new dt(X.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new dt(X.UNAVAILABLE,"Connection failed."));break;default:At(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{vt(kn,`RPC '${t}' ${o} completed.`)}});const u=JSON.stringify(r);vt(kn,`RPC '${t}' ${o} sending request:`,r),h.send(n,"POST",u,i,15)})}T_(t,n,i){const r=Dx(),s=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,i),a.encodeInitMessageHeaders=!0;const h=s.join("");vt(kn,`Creating RPC '${t}' stream ${r}: ${h}`,a);const u=o.createWebChannel(h,a);this.I_(u);let d=!1,f=!1;const v=new x$({Ho:y=>{f?vt(kn,`Not sending because RPC '${t}' stream ${r} is closed:`,y):(d||(vt(kn,`Opening RPC '${t}' stream ${r} transport.`),u.open(),d=!0),vt(kn,`RPC '${t}' stream ${r} sending:`,y),u.send(y))},Jo:()=>u.close()});return ih(u,ph.EventType.OPEN,()=>{f||(vt(kn,`RPC '${t}' stream ${r} transport opened.`),v.i_())}),ih(u,ph.EventType.CLOSE,()=>{f||(f=!0,vt(kn,`RPC '${t}' stream ${r} transport closed`),v.o_(),this.E_(u))}),ih(u,ph.EventType.ERROR,y=>{f||(f=!0,ba(kn,`RPC '${t}' stream ${r} transport errored. Name:`,y.name,"Message:",y.message),v.o_(new dt(X.UNAVAILABLE,"The operation could not be completed")))}),ih(u,ph.EventType.MESSAGE,y=>{var w;if(!f){const _=y.data[0];ne(!!_,16349);const x=_,C=(x==null?void 0:x.error)||((w=x[0])==null?void 0:w.error);if(C){vt(kn,`RPC '${t}' stream ${r} received error:`,C);const k=C.status;let P=function(N){const T=Be[N];if(T!==void 0)return s2(T)}(k),A=C.message;P===void 0&&(P=X.INTERNAL,A="Unknown error status: "+k+" with message "+C.message),f=!0,v.o_(new dt(P,A)),u.close()}else vt(kn,`RPC '${t}' stream ${r} received:`,_),v.__(_)}}),Pc.u_(),setTimeout(()=>{v.s_()},0),v}terminate(){this.a_.forEach(t=>t.close()),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter(n=>n===t)}Go(t,n,i){super.Go(t,n,i),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return bM()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _$(e){return new Pc(e)}function Sv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bm(e){return new C8(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pc.c_=!1;class _2{constructor(t,n,i=1e3,r=1.5,s=6e4){this.Ci=t,this.timerId=n,this.R_=i,this.A_=r,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-i);r>0&&vt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),t())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN="PersistentStream";class w2{constructor(t,n,i,r,s,o,a,c){this.Ci=t,this.b_=i,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _2(t,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():n&&n.code===X.RESOURCE_EXHAUSTED?(ks(n.toString()),ks("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(n)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===n&&this.G_(i,r)},i=>{t(()=>{const r=new dt(X.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(t,n){const i=this.Q_(this.D_);this.stream=this.j_(t,n),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return vt(oN,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return n=>{this.Ci.enqueueAndForget(()=>this.D_===t?n():(vt(oN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class w$ extends w2{constructor(t,n,i,r,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}j_(t,n){return this.connection.T_("Listen",t,n)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const n=E8(this.serializer,t),i=function(s){if(!("targetChange"in s))return Lt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Lt.min():o.readTime?Or(o.readTime):Lt.min()}(t);return this.listener.J_(n,i)}Z_(t){const n={};n.database=Px(this.serializer),n.addTarget=function(s,o){let a;const c=o.target;if(a=Ex(c)?{documents:A8(s,c)}:{query:R8(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=c2(s,o.resumeToken);const h=Ix(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Lt.min())>0){a.readTime=kf(s,o.snapshotVersion.toTimestamp());const h=Ix(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,t);const i=M8(this.serializer,t);i&&(n.labels=i),this.K_(n)}X_(t){const n={};n.database=Px(this.serializer),n.removeTarget=t,this.K_(n)}}class b$ extends w2{constructor(t,n,i,r,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,n){return this.connection.T_("Write",t,n)}H_(t){return ne(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ne(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ne(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const n=I8(t.writeResults,t.commitTime),i=Or(t.commitTime);return this.listener.na(i,n)}ra(){const t={};t.database=Px(this.serializer),this.K_(t)}ea(t){const n={streamToken:this.lastStreamToken,writes:t.map(i=>S8(this.serializer,i))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${}class C$ extends T${constructor(t,n,i,r){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new dt(X.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,Ax(n,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new dt(X.UNKNOWN,s.toString())})}jo(t,n,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(t,Ax(n,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new dt(X.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function k$(e,t,n,i){return new C$(e,t,n,i)}class N${constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ks(n),this.aa=!1):vt("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta="RemoteStore";class E${constructor(t,n,i,r,s){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{i.enqueueAndForget(async()=>{Fa(this)&&(vt(Ta,"Restarting streams for network reachability change."),await async function(c){const h=qt(c);h.Ea.add(4),await Ku(h),h.Va.set("Unknown"),h.Ea.delete(4),await Gm(h)}(this))})}),this.Va=new N$(i,r)}}async function Gm(e){if(Fa(e))for(const t of e.Ra)await t(!0)}async function Ku(e){for(const t of e.Ra)await t(!1)}function b2(e,t){const n=qt(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),dw(n)?uw(n):Tl(n).O_()&&hw(n,t))}function lw(e,t){const n=qt(e),i=Tl(n);n.Ia.delete(t),i.O_()&&T2(n,t),n.Ia.size===0&&(i.O_()?i.L_():Fa(n)&&n.Va.set("Unknown"))}function hw(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Lt.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Tl(e).Z_(t)}function T2(e,t){e.da.$e(t),Tl(e).X_(t)}function uw(e){e.da=new _8({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Tl(e).start(),e.Va.ua()}function dw(e){return Fa(e)&&!Tl(e).x_()&&e.Ia.size>0}function Fa(e){return qt(e).Ea.size===0}function C2(e){e.da=void 0}async function S$(e){e.Va.set("Online")}async function I$(e){e.Ia.forEach((t,n)=>{hw(e,t)})}async function A$(e,t){C2(e),dw(e)?(e.Va.ha(t),uw(e)):e.Va.set("Unknown")}async function R$(e,t,n){if(e.Va.set("Online"),t instanceof a2&&t.state===2&&t.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.da.removeTarget(a))}(e,t)}catch(i){vt(Ta,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await Ef(e,i)}else if(t instanceof Ng?e.da.Xe(t):t instanceof o2?e.da.st(t):e.da.tt(t),!n.isEqual(Lt.min()))try{const i=await x2(e.localStore);n.compareTo(i)>=0&&await function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.Ia.get(h);u&&s.Ia.set(h,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,h)=>{const u=s.Ia.get(c);if(!u)return;s.Ia.set(c,u.withResumeToken(fn.EMPTY_BYTE_STRING,u.snapshotVersion)),T2(s,c);const d=new oo(u.target,c,h,u.sequenceNumber);hw(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){vt(Ta,"Failed to raise snapshot:",i),await Ef(e,i)}}async function Ef(e,t,n){if(!wl(t))throw t;e.Ea.add(1),await Ku(e),e.Va.set("Offline"),n||(n=()=>x2(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{vt(Ta,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Gm(e)})}function k2(e,t){return t().catch(n=>Ef(e,n,t))}async function Hm(e){const t=qt(e),n=Ro(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Q_;for(;P$(t);)try{const r=await d$(t.localStore,i);if(r===null){t.Ta.length===0&&n.L_();break}i=r.batchId,M$(t,r)}catch(r){await Ef(t,r)}N2(t)&&E2(t)}function P$(e){return Fa(e)&&e.Ta.length<10}function M$(e,t){e.Ta.push(t);const n=Ro(e);n.O_()&&n.Y_&&n.ea(t.mutations)}function N2(e){return Fa(e)&&!Ro(e).x_()&&e.Ta.length>0}function E2(e){Ro(e).start()}async function D$(e){Ro(e).ra()}async function L$(e){const t=Ro(e);for(const n of e.Ta)t.ea(n.mutations)}async function V$(e,t,n){const i=e.Ta.shift(),r=nw.from(i,t,n);await k2(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await Hm(e)}async function q$(e,t){t&&Ro(e).Y_&&await async function(i,r){if(function(o){return v8(o)&&o!==X.ABORTED}(r.code)){const s=i.Ta.shift();Ro(i).B_(),await k2(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Hm(i)}}(e,t),N2(e)&&E2(e)}async function aN(e,t){const n=qt(e);n.asyncQueue.verifyOperationInProgress(),vt(Ta,"RemoteStore received new credentials");const i=Fa(n);n.Ea.add(3),await Ku(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Gm(n)}async function j$(e,t){const n=qt(e);t?(n.Ea.delete(2),await Gm(n)):t||(n.Ea.add(2),await Ku(n),n.Va.set("Unknown"))}function Tl(e){return e.ma||(e.ma=function(n,i,r){const s=qt(n);return s.sa(),new w$(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Zo:S$.bind(null,e),Yo:I$.bind(null,e),t_:A$.bind(null,e),J_:R$.bind(null,e)}),e.Ra.push(async t=>{t?(e.ma.B_(),dw(e)?uw(e):e.Va.set("Unknown")):(await e.ma.stop(),C2(e))})),e.ma}function Ro(e){return e.fa||(e.fa=function(n,i,r){const s=qt(n);return s.sa(),new b$(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),Yo:D$.bind(null,e),t_:q$.bind(null,e),ta:L$.bind(null,e),na:V$.bind(null,e)}),e.Ra.push(async t=>{t?(e.fa.B_(),await Hm(e)):(await e.fa.stop(),e.Ta.length>0&&(vt(Ta,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(t,n,i,r,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,r,s){const o=Date.now()+i,a=new gw(t,n,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new dt(X.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fw(e,t){if(ks("AsyncQueue",`${t}: ${e}`),wl(e))return new dt(X.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{static emptySet(t){return new Mc(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Ct.comparator(n.key,i.key):(n,i)=>Ct.comparator(n.key,i.key),this.keyedMap=vh(),this.sortedSet=new We(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Mc)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Mc;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this.ga=new We(Ct.comparator)}track(t){const n=t.doc.key,i=this.ga.get(n);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(n,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(n):t.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):At(63341,{Vt:t,pa:i}):this.ga=this.ga.insert(n,t)}ya(){const t=[];return this.ga.inorderTraversal((n,i)=>{t.push(i)}),t}}class il{constructor(t,n,i,r,s,o,a,c,h){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(t,n,i,r,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new il(t,n,Mc.emptySet(n),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&qm(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(t=>t.Da())}}class U${constructor(){this.queries=lN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const r=qt(n),s=r.queries;r.queries=lN(),s.forEach((o,a)=>{for(const c of a.ba)c.onError(i)})})(this,new dt(X.ABORTED,"Firestore shutting down"))}}function lN(){return new ja(e=>zM(e),qm)}async function S2(e,t){const n=qt(e);let i=3;const r=t.query;let s=n.queries.get(r);s?!s.Sa()&&t.Da()&&(i=2):(s=new F$,i=t.Da()?0:1);try{switch(i){case 0:s.wa=await n.onListen(r,!0);break;case 1:s.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=fw(o,`Initialization of query '${Za(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,s),s.ba.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&mw(n)}async function I2(e,t){const n=qt(e),i=t.query;let r=3;const s=n.queries.get(i);if(s){const o=s.ba.indexOf(t);o>=0&&(s.ba.splice(o,1),s.ba.length===0?r=t.Da()?0:1:!s.Sa()&&t.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function O$(e,t){const n=qt(e);let i=!1;for(const r of t){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.ba)a.Fa(r)&&(i=!0);o.wa=r}}i&&mw(n)}function B$(e,t,n){const i=qt(e),r=i.queries.get(t);if(r)for(const s of r.ba)s.onError(n);i.queries.delete(t)}function mw(e){e.Ca.forEach(t=>{t.next()})}var Lx,hN;(hN=Lx||(Lx={})).Ma="default",hN.Cache="cache";class A2{constructor(t,n,i){this.query=t,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new il(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),n=!0):this.La(t,this.onlineState)&&(this.ka(t),n=!0),this.Na=t,n}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),n=!0),n}La(t,n){if(!t.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(t){t=il.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Lx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(t){this.key=t}}class P2{constructor(t){this.key=t}}class G${constructor(t,n){this.query=t,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=$t(),this.mutatedKeys=$t(),this.eu=KM(t),this.tu=new Mc(this.eu)}get nu(){return this.Za}ru(t,n){const i=n?n.iu:new cN,r=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((u,d)=>{const f=r.get(u),v=jm(this.query,d)?d:null,y=!!f&&this.mutatedKeys.has(f.key),w=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let _=!1;f&&v?f.data.isEqual(v.data)?y!==w&&(i.track({type:3,doc:v}),_=!0):this.su(f,v)||(i.track({type:2,doc:v}),_=!0,(c&&this.eu(v,c)>0||h&&this.eu(v,h)<0)&&(a=!0)):!f&&v?(i.track({type:0,doc:v}),_=!0):f&&!v&&(i.track({type:1,doc:f}),_=!0,(c||h)&&(a=!0)),_&&(v?(o=o.add(v),s=w?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{tu:o,iu:i,Ss:a,mutatedKeys:s}}su(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,r){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort((u,d)=>function(v,y){const w=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return At(20277,{Vt:_})}};return w(v)-w(y)}(u.type,d.type)||this.eu(u.doc,d.doc)),this.ou(i),r=r??!1;const a=n&&!r?this._u():[],c=this.Ya.size===0&&this.current&&!r?1:0,h=c!==this.Xa;return this.Xa=c,o.length!==0||h?{snapshot:new il(this.query,t.tu,s,o,t.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new cN,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=$t(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});const n=[];return t.forEach(i=>{this.Ya.has(i)||n.push(new P2(i))}),this.Ya.forEach(i=>{t.has(i)||n.push(new R2(i))}),n}cu(t){this.Za=t.ks,this.Ya=$t();const n=this.ru(t.documents);return this.applyChanges(n,!0)}lu(){return il.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const pw="SyncEngine";class H${constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class $${constructor(t){this.key=t,this.hu=!1}}class z${constructor(t,n,i,r,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ja(a=>zM(a),qm),this.Iu=new Map,this.Eu=new Set,this.Ru=new We(Ct.comparator),this.Au=new Map,this.Vu=new sw,this.du={},this.mu=new Map,this.fu=nl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function K$(e,t,n=!0){const i=j2(e);let r;const s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await M2(i,t,n,!0),r}async function W$(e,t){const n=j2(e);await M2(n,t,!0,!1)}async function M2(e,t,n,i){const r=await g$(e.localStore,Ur(t)),s=r.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await Q$(e,t,s,o==="current",r.resumeToken)),e.isPrimaryClient&&n&&b2(e.remoteStore,r),a}async function Q$(e,t,n,i,r){e.pu=(d,f,v)=>async function(w,_,x,C){let k=_.view.ru(x);k.Ss&&(k=await nN(w.localStore,_.query,!1).then(({documents:N})=>_.view.ru(N,k)));const P=C&&C.targetChanges.get(_.targetId),A=C&&C.targetMismatches.get(_.targetId)!=null,M=_.view.applyChanges(k,w.isPrimaryClient,P,A);return dN(w,_.targetId,M.au),M.snapshot}(e,d,f,v);const s=await nN(e.localStore,t,!0),o=new G$(t,s.ks),a=o.ru(s.documents),c=zu.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",r),h=o.applyChanges(a,e.isPrimaryClient,c);dN(e,n,h.au);const u=new H$(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),h.snapshot}async function Y$(e,t,n){const i=qt(e),r=i.Tu.get(t),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter(o=>!qm(o,t))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Mx(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&lw(i.remoteStore,r.targetId),Vx(i,r.targetId)}).catch(_l)):(Vx(i,r.targetId),await Mx(i.localStore,r.targetId,!0))}async function X$(e,t){const n=qt(e),i=n.Tu.get(t),r=n.Iu.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),lw(n.remoteStore,i.targetId))}async function J$(e,t,n){const i=s9(e);try{const r=await function(o,a){const c=qt(o),h=ue.now(),u=a.reduce((v,y)=>v.add(y.key),$t());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let y=Ns(),w=$t();return c.xs.getEntries(v,u).next(_=>{y=_,y.forEach((x,C)=>{C.isValidDocument()||(w=w.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,y)).next(_=>{d=_;const x=[];for(const C of a){const k=d8(C,d.get(C.key).overlayedDocument);k!=null&&x.push(new Oo(C.key,k,jM(k.value.mapValue),vr.exists(!0)))}return c.mutationQueue.addMutationBatch(v,h,x,a)}).next(_=>{f=_;const x=_.applyToLocalDocumentSet(d,w);return c.documentOverlayCache.saveOverlays(v,_.batchId,x)})}).then(()=>({batchId:f.batchId,changes:QM(d)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let h=o.du[o.currentUser.toKey()];h||(h=new We(Ht)),h=h.insert(a,c),o.du[o.currentUser.toKey()]=h}(i,r.batchId,n),await Wu(i,r.changes),await Hm(i.remoteStore)}catch(r){const s=fw(r,"Failed to persist write");n.reject(s)}}async function D2(e,t){const n=qt(e);try{const i=await h$(n.localStore,t);t.targetChanges.forEach((r,s)=>{const o=n.Au.get(s);o&&(ne(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?ne(o.hu,14607):r.removedDocuments.size>0&&(ne(o.hu,42227),o.hu=!1))}),await Wu(n,i,t)}catch(i){await _l(i)}}function uN(e,t,n){const i=qt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.Tu.forEach((s,o)=>{const a=o.view.va(t);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=qt(o);c.onlineState=a;let h=!1;c.queries.forEach((u,d)=>{for(const f of d.ba)f.va(a)&&(h=!0)}),h&&mw(c)}(i.eventManager,t),r.length&&i.Pu.J_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Z$(e,t,n){const i=qt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Au.get(t),s=r&&r.key;if(s){let o=new We(Ct.comparator);o=o.insert(s,An.newNoDocument(s,Lt.min()));const a=$t().add(s),c=new Om(Lt.min(),new Map,new We(Ht),o,a);await D2(i,c),i.Ru=i.Ru.remove(s),i.Au.delete(t),vw(i)}else await Mx(i.localStore,t,!1).then(()=>Vx(i,t,n)).catch(_l)}async function t9(e,t){const n=qt(e),i=t.batch.batchId;try{const r=await l$(n.localStore,t);V2(n,i,null),L2(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Wu(n,r)}catch(r){await _l(r)}}async function e9(e,t,n){const i=qt(e);try{const r=await function(o,a){const c=qt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let u;return c.mutationQueue.lookupMutationBatch(h,a).next(d=>(ne(d!==null,37113),u=d.keys(),c.mutationQueue.removeMutationBatch(h,d))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,u)).next(()=>c.localDocuments.getDocuments(h,u))})}(i.localStore,t);V2(i,t,n),L2(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await Wu(i,r)}catch(r){await _l(r)}}function L2(e,t){(e.mu.get(t)||[]).forEach(n=>{n.resolve()}),e.mu.delete(t)}function V2(e,t,n){const i=qt(e);let r=i.du[i.currentUser.toKey()];if(r){const s=r.get(t);s&&(n?s.reject(n):s.resolve(),r=r.remove(t)),i.du[i.currentUser.toKey()]=r}}function Vx(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Iu.get(t))e.Tu.delete(i),n&&e.Pu.yu(i,n);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(i=>{e.Vu.containsKey(i)||q2(e,i)})}function q2(e,t){e.Eu.delete(t.path.canonicalString());const n=e.Ru.get(t);n!==null&&(lw(e.remoteStore,n),e.Ru=e.Ru.remove(t),e.Au.delete(n),vw(e))}function dN(e,t,n){for(const i of n)i instanceof R2?(e.Vu.addReference(i.key,t),n9(e,i)):i instanceof P2?(vt(pw,"Document no longer in limbo: "+i.key),e.Vu.removeReference(i.key,t),e.Vu.containsKey(i.key)||q2(e,i.key)):At(19791,{wu:i})}function n9(e,t){const n=t.key,i=n.path.canonicalString();e.Ru.get(n)||e.Eu.has(i)||(vt(pw,"New document in limbo: "+n),e.Eu.add(i),vw(e))}function vw(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Ct(he.fromString(t)),i=e.fu.next();e.Au.set(i,new $$(n)),e.Ru=e.Ru.insert(n,i),b2(e.remoteStore,new oo(Ur(tw(n.path)),i,"TargetPurposeLimboResolution",Dm.ce))}}async function Wu(e,t,n){const i=qt(e),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach((a,c)=>{o.push(i.pu(c,t,n).then(h=>{var u;if((h||n)&&i.isPrimaryClient){const d=h?!h.fromCache:(u=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=aw.Es(c.targetId,h);s.push(d)}}))}),await Promise.all(o),i.Pu.J_(r),await async function(c,h){const u=qt(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>tt.forEach(h,f=>tt.forEach(f.Ts,v=>u.persistence.referenceDelegate.addReference(d,f.targetId,v)).next(()=>tt.forEach(f.Is,v=>u.persistence.referenceDelegate.removeReference(d,f.targetId,v)))))}catch(d){if(!wl(d))throw d;vt(cw,"Failed to update sequence numbers: "+d)}for(const d of h){const f=d.targetId;if(!d.fromCache){const v=u.vs.get(f),y=v.snapshotVersion,w=v.withLastLimboFreeSnapshotVersion(y);u.vs=u.vs.insert(f,w)}}}(i.localStore,s))}async function i9(e,t){const n=qt(e);if(!n.currentUser.isEqual(t)){vt(pw,"User change. New user:",t.toKey());const i=await y2(n.localStore,t);n.currentUser=t,function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new dt(X.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Wu(n,i.Ns)}}function r9(e,t){const n=qt(e),i=n.Au.get(t);if(i&&i.hu)return $t().add(i.key);{let r=$t();const s=n.Iu.get(t);if(!s)return r;for(const o of s){const a=n.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function j2(e){const t=qt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=D2.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=r9.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Z$.bind(null,t),t.Pu.J_=O$.bind(null,t.eventManager),t.Pu.yu=B$.bind(null,t.eventManager),t}function s9(e){const t=qt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=t9.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=e9.bind(null,t),t}class Sf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Bm(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,n){return null}Mu(t,n){return null}vu(t){return c$(this.persistence,new s$,t.initialUser,this.serializer)}Cu(t){return new v2(ow.Vi,this.serializer)}Du(t){return new m$}async terminate(){var t,n;(t=this.gcScheduler)==null||t.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sf.provider={build:()=>new Sf};class o9 extends Sf{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,n){ne(this.persistence.referenceDelegate instanceof Nf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new H8(i,t.asyncQueue,n)}Cu(t){const n=this.cacheSizeBytes!==void 0?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new v2(i=>Nf.Vi(i,n),this.serializer)}}class qx{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>uN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=i9.bind(null,this.syncEngine),await j$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new U$}()}createDatastore(t){const n=Bm(t.databaseInfo.databaseId),i=_$(t.databaseInfo);return k$(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,r,s,o,a){return new E$(i,r,s,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>uN(this.syncEngine,n,0),function(){return sN.v()?new sN:new p$}())}createSyncEngine(t,n){return function(r,s,o,a,c,h,u){const d=new z$(r,s,o,a,c,h);return u&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(r){const s=qt(r);vt(Ta,"RemoteStore shutting down."),s.Ea.add(5),await Ku(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(n=this.eventManager)==null||n.terminate()}}qx.provider={build:()=>new qx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):ks("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="FirestoreClient";class a9{constructor(t,n,i,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=r,this.user=En.UNAUTHENTICATED,this.clientId=Pm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{vt(Po,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(vt(Po,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=fw(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function Iv(e,t){e.asyncQueue.verifyOperationInProgress(),vt(Po,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async r=>{i.isEqual(r)||(await y2(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function gN(e,t){e.asyncQueue.verifyOperationInProgress();const n=await c9(e);vt(Po,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>aN(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,r)=>aN(t.remoteStore,r)),e._onlineComponents=t}async function c9(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){vt(Po,"Using user provided OfflineComponentProvider");try{await Iv(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(r){return r.name==="FirebaseError"?r.code===X.FAILED_PRECONDITION||r.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;ba("Error using user provided cache. Falling back to memory cache: "+n),await Iv(e,new Sf)}}else vt(Po,"Using default OfflineComponentProvider"),await Iv(e,new o9(void 0));return e._offlineComponents}async function U2(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(vt(Po,"Using user provided OnlineComponentProvider"),await gN(e,e._uninitializedComponentsProvider._online)):(vt(Po,"Using default OnlineComponentProvider"),await gN(e,new qx))),e._onlineComponents}function l9(e){return U2(e).then(t=>t.syncEngine)}async function O2(e){const t=await U2(e),n=t.eventManager;return n.onListen=K$.bind(null,t.syncEngine),n.onUnlisten=Y$.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=W$.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=X$.bind(null,t.syncEngine),n}function h9(e,t,n={}){const i=new gs;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,h){const u=new F2({next:f=>{u.Nu(),o.enqueueAndForget(()=>I2(s,d));const v=f.docs.has(a);!v&&f.fromCache?h.reject(new dt(X.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&f.fromCache&&c&&c.source==="server"?h.reject(new dt(X.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new A2(tw(a.path),u,{includeMetadataChanges:!0,Ka:!0});return S2(s,d)}(await O2(e),e.asyncQueue,t,n,i)),i.promise}function u9(e,t,n={}){const i=new gs;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,h){const u=new F2({next:f=>{u.Nu(),o.enqueueAndForget(()=>I2(s,d)),f.fromCache&&c.source==="server"?h.reject(new dt(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new A2(a,u,{includeMetadataChanges:!0,Ka:!0});return S2(s,d)}(await O2(e),e.asyncQueue,t,n,i)),i.promise}function d9(e,t){const n=new gs;return e.asyncQueue.enqueueAndForget(async()=>J$(await l9(e),t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g9="ComponentProvider",fN=new Map;function f9(e,t,n,i,r){return new MH(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,B2(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2="firestore.googleapis.com",mN=!0;class pN{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new dt(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=G2,this.ssl=mN}else this.host=t.host,this.ssl=t.ssl??mN;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=p2;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<B8)throw new dt(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}EM("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=B2(t.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new dt(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new dt(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new dt(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class $m{constructor(t,n,i,r){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new dt(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new dt(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pN(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new kM;switch(i.type){case"firstParty":return new pH(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new dt(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=fN.get(n);i&&(vt(g9,"Removing Datastore"),fN.delete(n),i.terminate())}(this),Promise.resolve()}}function H2(e,t,n,i={}){var h;e=Cr(e,$m);const r=Ds(t),s=e._getSettings(),o={...s,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;r&&(Sm(`https://${a}`),Im("Firestore",!0)),s.host!==G2&&s.host!==a&&ba("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:r,emulatorOptions:i};if(!No(c,o)&&(e._setSettings(c),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=En.MOCK_USER;else{u=$_(i.mockUserToken,(h=e._app)==null?void 0:h.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new dt(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new En(f)}e._authCredentials=new gH(new CM(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Vs(this.firestore,t,this._query)}}class Ve{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ve(this.firestore,t,this._key)}toJSON(){return{type:Ve._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,i){if(Hu(n,Ve._jsonSchema))return new Ve(t,i||null,new Ct(he.fromString(n.referencePath)))}}Ve._jsonSchemaVersion="firestore/documentReference/1.0",Ve._jsonSchema={type:ze("string",Ve._jsonSchemaVersion),referencePath:ze("string")};class fs extends Vs{constructor(t,n,i){super(t,n,tw(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ve(this.firestore,null,new Ct(t))}withConverter(t){return new fs(this.firestore,t,this._path)}}function Wr(e,t,...n){if(e=Ke(e),NM("collection","path",t),e instanceof $m){const i=he.fromString(t,...n);return Ik(i),new fs(e,null,i)}{if(!(e instanceof Ve||e instanceof fs))throw new dt(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(he.fromString(t,...n));return Ik(i),new fs(e.firestore,null,i)}}function Mt(e,t,...n){if(e=Ke(e),arguments.length===1&&(t=Pm.newId()),NM("doc","path",t),e instanceof $m){const i=he.fromString(t,...n);return Sk(i),new Ve(e,null,new Ct(i))}{if(!(e instanceof Ve||e instanceof fs))throw new dt(X.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(he.fromString(t,...n));return Sk(i),new Ve(e.firestore,e instanceof fs?e.converter:null,new Ct(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN="AsyncQueue";class yN{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _2(this,"async_queue_retry"),this._c=()=>{const i=Sv();i&&vt(vN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const n=Sv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const n=Sv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const n=new gs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Yu.push(t),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!wl(t))throw t;vt(vN,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const n=this.ac.then(()=>(this.rc=!0,t().catch(i=>{throw this.nc=i,this.rc=!1,ks("INTERNAL UNHANDLED ERROR: ",xN(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=n,n}enqueueAfterDelay(t,n,i){this.uc(),this.oc.indexOf(t)>-1&&(n=0);const r=gw.createAndSchedule(this,t,n,i,s=>this.hc(s));return this.tc.push(r),r}uc(){this.nc&&At(47125,{Pc:xN(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const n of this.tc)if(n.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Tc()})}Rc(t){this.oc.push(t)}hc(t){const n=this.tc.indexOf(t);this.tc.splice(n,1)}}function xN(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class Ua extends $m{constructor(t,n,i,r){super(t,n,i,r),this.type="firestore",this._queue=new yN,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new yN(t),this._firestoreClient=void 0,await t}}}function $2(e,t){const n=typeof e=="object"?e:Rm(),i=typeof e=="string"?e:_f,r=qa(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=G_("firestore");s&&H2(r,...s)}return r}function zm(e){if(e._terminated)throw new dt(X.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||m9(e),e._firestoreClient}function m9(e){var i,r,s,o;const t=e._freezeSettings(),n=f9(e._databaseId,((i=e._app)==null?void 0:i.options.appId)||"",e._persistenceKey,(r=e._app)==null?void 0:r.options.apiKey,t);e._componentsProvider||(s=t.localCache)!=null&&s._offlineComponentProvider&&((o=t.localCache)!=null&&o._onlineComponentProvider)&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new a9(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(c){const h=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(h),_online:h}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(t){this._byteString=t}static fromBase64String(t){try{return new vi(fn.fromBase64String(t))}catch(n){throw new dt(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new vi(fn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:vi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Hu(t,vi._jsonSchema))return vi.fromBase64String(t.bytes)}}vi._jsonSchemaVersion="firestore/bytes/1.0",vi._jsonSchema={type:ze("string",vi._jsonSchemaVersion),bytes:ze("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new dt(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new dt(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new dt(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Ht(this._lat,t._lat)||Ht(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yr._jsonSchemaVersion}}static fromJSON(t){if(Hu(t,yr._jsonSchema))return new yr(t.latitude,t.longitude)}}yr._jsonSchemaVersion="firestore/geoPoint/1.0",yr._jsonSchema={type:ze("string",yr._jsonSchemaVersion),latitude:ze("number"),longitude:ze("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Ui._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Hu(t,Ui._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new Ui(t.vectorValues);throw new dt(X.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ui._jsonSchemaVersion="firestore/vectorValue/1.0",Ui._jsonSchema={type:ze("string",Ui._jsonSchemaVersion),vectorValues:ze("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=/^__.*__$/;class v9{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Oo(t,this.data,this.fieldMask,n,this.fieldTransforms):new $u(t,this.data,n,this.fieldTransforms)}}class z2{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Oo(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function K2(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw At(40011,{dataSource:e})}}class yw{constructor(t,n,i,r,s,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new yw({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){var r;const n=(r=this.path)==null?void 0:r.child(t),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(t),i}childContextForFieldPath(t){var r;const n=(r=this.path)==null?void 0:r.child(t),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return If(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(K2(this.dataSource)&&p9.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class y9{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||Bm(t)}createContext(t,n,i,r=!1){return new yw({dataSource:t,methodName:n,targetDoc:i,path:un.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wm(e){const t=e._freezeSettings(),n=Bm(e._databaseId);return new y9(e._databaseId,!!t.ignoreUndefinedProperties,n)}function W2(e,t,n,i,r,s={}){const o=e.createContext(s.merge||s.mergeFields?2:0,t,n,r);_w("Data must be an object, but it was:",o,i);const a=Q2(i,o);let c,h;if(s.merge)c=new xi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const f=Ca(t,d,n);if(!o.contains(f))throw new dt(X.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);J2(u,f)||u.push(f)}c=new xi(u),h=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,h=o.fieldTransforms;return new v9(new ci(a),c,h)}class Qm extends Qu{_toFieldTransform(t){if(t.dataSource!==2)throw t.dataSource===1?t.createError(`${this._methodName}() can only appear at the top level of your update data`):t.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Qm}}class xw extends Qu{_toFieldTransform(t){return new c8(t.path,new xu)}isEqual(t){return t instanceof xw}}function x9(e,t,n,i){const r=e.createContext(1,t,n);_w("Data must be an object, but it was:",r,i);const s=[],o=ci.empty();Uo(i,(c,h)=>{const u=X2(t,c,n);h=Ke(h);const d=r.childContextForFieldPath(u);if(h instanceof Qm)s.push(u);else{const f=Yu(h,d);f!=null&&(s.push(u),o.set(u,f))}});const a=new xi(s);return new z2(o,a,r.fieldTransforms)}function _9(e,t,n,i,r,s){const o=e.createContext(1,t,n),a=[Ca(t,i,n)],c=[r];if(s.length%2!=0)throw new dt(X.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Ca(t,s[f])),c.push(s[f+1]);const h=[],u=ci.empty();for(let f=a.length-1;f>=0;--f)if(!J2(h,a[f])){const v=a[f];let y=c[f];y=Ke(y);const w=o.childContextForFieldPath(v);if(y instanceof Qm)h.push(v);else{const _=Yu(y,w);_!=null&&(h.push(v),u.set(v,_))}}const d=new xi(h);return new z2(u,d,o.fieldTransforms)}function w9(e,t,n,i=!1){return Yu(n,e.createContext(i?4:3,t))}function Yu(e,t){if(Y2(e=Ke(e)))return _w("Unsupported field value:",t,e),Q2(e,t);if(e instanceof Qu)return function(i,r){if(!K2(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let c=Yu(a,r.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(i,r){if((i=Ke(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return s8(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=ue.fromDate(i);return{timestampValue:kf(r.serializer,s)}}if(i instanceof ue){const s=new ue(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:kf(r.serializer,s)}}if(i instanceof yr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vi)return{bytesValue:c2(r.serializer,i._byteString)};if(i instanceof Ve){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rw(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ui)return function(o,a){const c=o instanceof Ui?o.toArray():o;return{mapValue:{fields:{[VM]:{stringValue:qM},[wf]:{arrayValue:{values:c.map(u=>{if(typeof u!="number")throw a.createError("VectorValues must only contain numeric values.");return ew(a.serializer,u)})}}}}}}(i,r);if(m2(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Mm(i)}`)}(e,t)}function Q2(e,t){const n={};return AM(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Uo(e,(i,r)=>{const s=Yu(r,t.childContextForField(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function Y2(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof ue||e instanceof yr||e instanceof vi||e instanceof Ve||e instanceof Qu||e instanceof Ui||m2(e))}function _w(e,t,n){if(!Y2(n)||!SM(n)){const i=Mm(n);throw i==="an object"?t.createError(e+" a custom object"):t.createError(e+" "+i)}}function Ca(e,t,n){if((t=Ke(t))instanceof Km)return t._internalPath;if(typeof t=="string")return X2(e,t);throw If("Field path arguments must be of type string or ",e,!1,void 0,n)}const b9=new RegExp("[~\\*/\\[\\]]");function X2(e,t,n){if(t.search(b9)>=0)throw If(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Km(...t.split("."))._internalPath}catch{throw If(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function If(e,t,n,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new dt(X.INVALID_ARGUMENT,a+e+c)}function J2(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{convertValue(t,n="none"){switch(Ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qe(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Io(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw At(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Uo(t,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertVectorValue(t){var i,r,s;const n=(s=(r=(i=t.fields)==null?void 0:i[wf].arrayValue)==null?void 0:r.values)==null?void 0:s.map(o=>qe(o.doubleValue));return new Ui(n)}convertGeoPoint(t){return new yr(qe(t.latitude),qe(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=Vm(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(pu(t));default:return null}}convertTimestamp(t){const n=So(t);return new ue(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=he.fromString(t);ne(f2(i),9688,{name:t});const r=new Zc(i.get(1),i.get(3)),s=new Ct(i.popFirst(5));return r.isEqual(n)||ks(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD extends Z2{constructor(t){super(),this.firestore=t}convertBytes(t){return new vi(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Ve(this.firestore,null,n)}}function eD(){return new xw("serverTimestamp")}const _N="@firebase/firestore",wN="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(t,n,i,r,s){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new T9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var t;return((t=this._document)==null?void 0:t.data.clone().value.mapValue.fields)??void 0}get(t){if(this._document){const n=this._document.data.field(Ca("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class T9 extends nD{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C9(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new dt(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ww{}class Ym extends ww{}function rl(e,t,...n){let i=[];t instanceof ww&&i.push(t),i=i.concat(n),function(s){const o=s.filter(c=>c instanceof Xm).length,a=s.filter(c=>c instanceof Xu).length;if(o>1||o>0&&a>0)throw new dt(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)e=r._apply(e);return e}class Xu extends Ym{constructor(t,n,i){super(),this._field=t,this._op=n,this._value=i,this.type="where"}static _create(t,n,i){return new Xu(t,n,i)}_apply(t){const n=this._parse(t);return iD(t._query,n),new Vs(t.firestore,t.converter,Sx(t._query,n))}_parse(t){const n=Wm(t.firestore);return function(s,o,a,c,h,u,d){let f;if(h.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new dt(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){TN(d,u);const y=[];for(const w of d)y.push(bN(c,s,w));f={arrayValue:{values:y}}}else f=bN(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||TN(d,u),f=w9(a,o,d,u==="in"||u==="not-in");return $e.create(h,u,f)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}function Af(e,t,n){const i=t,r=Ca("where",e);return Xu._create(r,i,n)}class Xm extends ww{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new Xm(t,n)}_parse(t){const n=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:kr.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)iD(o,c),o=Sx(o,c)}(t._query,n),new Vs(t.firestore,t.converter,Sx(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jm extends Ym{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new Jm(t,n)}_apply(t){const n=function(r,s,o){if(r.startAt!==null)throw new dt(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new dt(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yu(s,o)}(t._query,this._field,this._direction);return new Vs(t.firestore,t.converter,XH(t._query,n))}}function bw(e,t="asc"){const n=t,i=Ca("orderBy",e);return Jm._create(i,n)}class Zm extends Ym{constructor(t,n,i){super(),this.type=t,this._limit=n,this._limitType=i}static _create(t,n,i){return new Zm(t,n,i)}_apply(t){return new Vs(t.firestore,t.converter,Tf(t._query,this._limit,this._limitType))}}function Tw(e){return bH("limit",e),Zm._create("limit",e,"F")}function bN(e,t,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new dt(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$M(t)&&n.indexOf("/")!==-1)throw new dt(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(he.fromString(n));if(!Ct.isDocumentKey(i))throw new dt(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return qk(e,new Ct(i))}if(n instanceof Ve)return qk(e,n._key);throw new dt(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mm(n)}.`)}function TN(e,t){if(!Array.isArray(e)||e.length===0)throw new dt(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function iD(e,t){const n=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(e.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new dt(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new dt(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function rD(e,t,n){let i;return i=e?e.toFirestore(t):t,i}class mc{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class wo extends nD{constructor(t,n,i,r,s,o){super(t,n,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new Vh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Ca("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new dt(X.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=wo._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}wo._jsonSchemaVersion="firestore/documentSnapshot/1.0",wo._jsonSchema={type:ze("string",wo._jsonSchemaVersion),bundleSource:ze("string","DocumentSnapshot"),bundleName:ze("string"),bundle:ze("string")};class Vh extends wo{data(t={}){return super.data(t)}}class ga{constructor(t,n,i,r){this._firestore=t,this._userDataWriter=n,this._snapshot=r,this.metadata=new mc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new Vh(this._firestore,this._userDataWriter,i.key,i,new mc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new dt(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const c=new Vh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new mc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const c=new Vh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new mc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,u=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:k9(a.type),doc:c,oldIndex:h,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new dt(X.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=ga._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Pm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function k9(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return At(61501,{type:e})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ga._jsonSchemaVersion="firestore/querySnapshot/1.0",ga._jsonSchema={type:ze("string",ga._jsonSchemaVersion),bundleSource:ze("string","QuerySnapshot"),bundleName:ze("string"),bundle:ze("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(e){e=Cr(e,Ve);const t=Cr(e.firestore,Ua),n=zm(t);return h9(n,e._key).then(i=>N9(t,e,i))}function ka(e){e=Cr(e,Vs);const t=Cr(e.firestore,Ua),n=zm(t),i=new tD(t);return C9(e._query),u9(n,e._query).then(r=>new ga(t,i,e,r))}function Cw(e,t,n){e=Cr(e,Ve);const i=Cr(e.firestore,Ua),r=rD(e.converter,t),s=Wm(i);return ep(i,[W2(s,"setDoc",e._key,r,e.converter!==null,n).toMutation(e._key,vr.none())])}function Gt(e,t,n,...i){e=Cr(e,Ve);const r=Cr(e.firestore,Ua),s=Wm(r);let o;return o=typeof(t=Ke(t))=="string"||t instanceof Km?_9(s,"updateDoc",e._key,t,n,i):x9(s,"updateDoc",e._key,t),ep(r,[o.toMutation(e._key,vr.exists(!0))])}function tp(e,t){const n=Cr(e.firestore,Ua),i=Mt(e),r=rD(e.converter,t),s=Wm(e.firestore);return ep(n,[W2(s,"addDoc",i._key,r,e.converter!==null,{}).toMutation(i._key,vr.exists(!1))]).then(()=>i)}function ep(e,t){const n=zm(e);return d9(n,t)}function N9(e,t,n){const i=n.docs.get(t._key),r=new tD(e);return new wo(e,r,t._key,i,new mc(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){dH(Fo),Ki(new Ci("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Ua(new fH(i.getProvider("auth-internal")),new vH(o,i.getProvider("app-check-internal")),DH(o,r),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),qn(_N,wN,t),qn(_N,wN,"esm2020")})();const sD=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Z2,Bytes:vi,CollectionReference:fs,DocumentReference:Ve,DocumentSnapshot:wo,FieldPath:Km,FieldValue:Qu,Firestore:Ua,FirestoreError:dt,GeoPoint:yr,Query:Vs,QueryCompositeFilterConstraint:Xm,QueryConstraint:Ym,QueryDocumentSnapshot:Vh,QueryFieldFilterConstraint:Xu,QueryLimitConstraint:Zm,QueryOrderByConstraint:Jm,QuerySnapshot:ga,SnapshotMetadata:mc,Timestamp:ue,VectorValue:Ui,_AutoId:Pm,_ByteString:fn,_DatabaseId:Zc,_DocumentKey:Ct,_EmptyAuthCredentialsProvider:kM,_FieldPath:un,_cast:Cr,_logWarn:ba,_validateIsNotUsedTogether:EM,addDoc:tp,collection:Wr,connectFirestoreEmulator:H2,doc:Mt,ensureFirestoreConfigured:zm,executeWrite:ep,getDoc:Qr,getDocs:ka,getFirestore:$2,limit:Tw,orderBy:bw,query:rl,serverTimestamp:eD,setDoc:Cw,updateDoc:Gt,where:Af},Symbol.toStringTag,{value:"Module"}));var E9="firebase",S9="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn(E9,S9,"app");var CN={};const kN="@firebase/database",NN="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oD="";function I9(e){oD=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){n==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),_n(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return n==null?null:gu(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){n==null?delete this.cache_[t]:this.cache_[t]=n}get(t){return Ls(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new A9(t)}}catch{}return new R9},aa=aD("localStorage"),P9=aD("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=new Gu("@firebase/database"),M9=function(){let e=1;return function(){return e++}}(),cD=function(e){const t=t6(e),n=new QG;n.update(t);const i=n.digest();return B_.encodeByteArray(i)},Ju=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=Ju.apply(null,i):typeof i=="object"?t+=_n(i):t+=i,t+=" "}return t};let qh=null,EN=!0;const D9=function(e,t){ut(!0,"Can't turn on custom loggers persistently."),Dc.logLevel=Ot.VERBOSE,qh=Dc.log.bind(Dc)},Rn=function(...e){if(EN===!0&&(EN=!1,qh===null&&P9.get("logging_enabled")===!0&&D9()),qh){const t=Ju.apply(null,e);qh(t)}},Zu=function(e){return function(...t){Rn(e,...t)}},jx=function(...e){const t="FIREBASE INTERNAL ERROR: "+Ju(...e);Dc.error(t)},Es=function(...e){const t=`FIREBASE FATAL ERROR: ${Ju(...e)}`;throw Dc.error(t),new Error(t)},bi=function(...e){const t="FIREBASE WARNING: "+Ju(...e);Dc.warn(t)},L9=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&bi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},lD=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},V9=function(e){if(document.readyState==="complete")e();else{let t=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},sl="[MIN_NAME]",Na="[MAX_NAME]",Cl=function(e,t){if(e===t)return 0;if(e===sl||t===Na)return-1;if(t===sl||e===Na)return 1;{const n=SN(e),i=SN(t);return n!==null?i!==null?n-i===0?e.length-t.length:n-i:-1:i!==null?1:e<t?-1:1}},q9=function(e,t){return e===t?0:e<t?-1:1},rh=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+_n(t))},kw=function(e){if(typeof e!="object"||e===null)return _n(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)i!==0&&(n+=","),n+=_n(t[i]),n+=":",n+=kw(e[t[i]]);return n+="}",n},hD=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function Wi(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const uD=function(e){ut(!lD(e),"Invalid JSON number");const t=11,n=52,i=(1<<t-1)-1;let r,s,o,a,c;e===0?(s=0,o=0,r=1/e===-1/0?1:0):(r=e<0,e=Math.abs(e),e>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),i),s=a+i,o=Math.round(e*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(e/Math.pow(2,1-i-n))));const h=[];for(c=n;c;c-=1)h.push(o%2?1:0),o=Math.floor(o/2);for(c=t;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(r?1:0),h.reverse();const u=h.join("");let d="";for(c=0;c<64;c+=8){let f=parseInt(u.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},j9=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},F9=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},U9=new RegExp("^-?(0*)\\d{1,10}$"),O9=-2147483648,B9=2147483647,SN=function(e){if(U9.test(e)){const t=Number(e);if(t>=O9&&t<=B9)return t}return null},td=function(e){try{e()}catch(t){setTimeout(()=>{const n=t.stack||"";throw bi("Exception was thrown by user callback.",n),t},Math.floor(0))}},G9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},jh=function(e,t){const n=setTimeout(e,t);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(t,n){this.appCheckProvider=n,this.appName=t.name,Mi(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){var n;(n=this.appCheckProvider)==null||n.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){bi(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $9{constructor(t,n,i){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&n.code==="auth/token-not-initialized"?(Rn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',bi(t)}}class Eg{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Eg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw="5",dD="v",gD="s",fD="r",mD="f",pD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,vD="ls",yD="p",Fx="ac",xD="websocket",_D="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(t,n,i,r,s=!1,o="",a=!1,c=!1,h=null){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=h,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=aa.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&aa.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${n}`}}function z9(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function bD(e,t,n){ut(typeof t=="string","typeof type must == string"),ut(typeof n=="object","typeof params must == object");let i;if(t===xD)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===_D)i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);z9(e)&&(n.ns=e.namespace);const r=[];return Wi(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(){this.counters_={}}incrementCounter(t,n=1){Ls(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return AG(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av={},Rv={};function Ew(e){const t=e.toString();return Av[t]||(Av[t]=new K9),Av[t]}function W9(e,t){const n=e.toString();return Rv[n]||(Rv[n]=t()),Rv[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q9{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&td(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="start",Y9="close",X9="pLPCommand",J9="pRTLPCB",TD="id",CD="pw",kD="ser",Z9="cb",tz="seg",ez="ts",nz="d",iz="dframe",ND=1870,ED=30,rz=ND-ED,sz=25e3,oz=3e4;class pc{constructor(t,n,i,r,s,o,a){this.connId=t,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zu(t),this.stats_=Ew(n),this.urlFn=c=>(this.appCheckToken&&(c[Fx]=this.appCheckToken),bD(n,_D,c))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Q9(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(oz)),V9(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Sw((...s)=>{const[o,a,c,h,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===IN)this.id=a,this.password=c;else if(o===Y9)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[IN]="t",i[kD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Z9]=this.scriptTagHolder.uniqueCallbackIdentifier),i[dD]=Nw,this.transportSessionId&&(i[gD]=this.transportSessionId),this.lastSessionId&&(i[vD]=this.lastSessionId),this.applicationId&&(i[yD]=this.applicationId),this.appCheckToken&&(i[Fx]=this.appCheckToken),typeof location<"u"&&location.hostname&&pD.test(location.hostname)&&(i[fD]=mD);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){pc.forceAllow_=!0}static forceDisallow(){pc.forceDisallow_=!0}static isAvailable(){return pc.forceAllow_?!0:!pc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!j9()&&!F9()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=_n(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=eM(n),r=hD(i,rz);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[iz]="t",i[TD]=t,i[CD]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=_n(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Sw{constructor(t,n,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=M9(),window[X9+this.uniqueCallbackIdentifier]=t,window[J9+this.uniqueCallbackIdentifier]=n,this.myIFrame=Sw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Rn("frame writing exception"),a.stack&&Rn(a.stack),Rn(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Rn("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[TD]=this.myID,t[CD]=this.myPW,t[kD]=this.currentSerial;let n=this.urlFn(t),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ED+i.length<=ND;){const o=this.pendingSegs.shift();i=i+"&"+tz+r+"="+o.seg+"&"+ez+r+"="+o.ts+"&"+nz+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(t,n,i){this.pendingSegs.push({seg:t,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(sz)),s=()=>{clearTimeout(r),i()};this.addTag(t,s)}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{Rn("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=16384,cz=45e3;let Rf=null;typeof MozWebSocket<"u"?Rf=MozWebSocket:typeof WebSocket<"u"&&(Rf=WebSocket);class lr{constructor(t,n,i,r,s,o,a){this.connId=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zu(this.connId),this.stats_=Ew(n),this.connURL=lr.connectionURL_(n,o,a,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,i,r,s){const o={};return o[dD]=Nw,typeof location<"u"&&location.hostname&&pD.test(location.hostname)&&(o[fD]=mD),n&&(o[gD]=n),i&&(o[vD]=i),r&&(o[Fx]=r),s&&(o[yD]=s),bD(t,xD,o)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,aa.set("previous_websocket_failure",!0);try{let i;OG(),this.mySock=new Rf(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){lr.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Rf!==null&&!lr.forceDisallow_}static previouslyFailed(){return aa.isInMemoryStorage||aa.get("previous_websocket_failure")===!0}markConnectionHealthy(){aa.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=gu(n);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(ut(this.frames===null,"We already have a frame buffer"),t.length<=6){const n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const n=_n(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=hD(n,az);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(cz))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}lr.responsesRequiredToBeHealthy=2;lr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{static get ALL_TRANSPORTS(){return[pc,lr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const n=lr&&lr.isAvailable();let i=n&&!lr.previouslyFailed();if(t.webSocketOnly&&(n||bi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[lr];else{const r=this.transports_=[];for(const s of bu.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);bu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}bu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz=6e4,hz=5e3,uz=10*1024,dz=100*1024,Pv="t",AN="d",gz="s",RN="r",fz="e",PN="o",MN="a",DN="n",LN="p",mz="h";class pz{constructor(t,n,i,r,s,o,a,c,h,u){this.id=t,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zu("c:"+this.id+":"),this.transportManager_=new bu(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=jh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>dz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>uz?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){const n={t:"d",d:t};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Pv in t){const n=t[Pv];n===MN?this.upgradeIfSecondaryHealthy_():n===RN?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===PN&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=rh("t",t),i=rh("d",t);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:LN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:MN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:DN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=rh("t",t),i=rh("d",t);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=rh(Pv,t);if(AN in t){const i=t[AN];if(n===mz){const r={...i};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===DN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===gz?this.onConnectionShutdown_(i):n===RN?this.onReset_(i):n===fz?jx("Server Error: "+i):n===PN?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):jx("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,i=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Nw!==i&&bi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),jh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(lz))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):jh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(hz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:LN,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(aa.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{put(t,n,i,r){}merge(t,n,i,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,i){}onDisconnectMerge(t,n,i){}onDisconnectCancel(t,n){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(t){this.allowedEvents_=t,this.listeners_={},ut(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(t,n,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:i});const r=this.getInitialEvent(t);r&&n.apply(i,r)}off(t,n,i){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(t){ut(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf extends ID{static getInstance(){return new Pf}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!z_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return ut(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=32,qN=768;class _e{constructor(t,n){if(n===void 0){this.pieces_=t.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(t+="/"+this.pieces_[n]);return t||"/"}}function se(){return new _e("")}function Wt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Mo(e){return e.pieces_.length-e.pieceNum_}function ve(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new _e(e.pieces_,t)}function AD(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function vz(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)e.pieces_[n]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function RD(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function PD(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new _e(t,0)}function dn(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof _e)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const i=t.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new _e(n,0)}function zt(e){return e.pieceNum_>=e.pieces_.length}function qi(e,t){const n=Wt(e),i=Wt(t);if(n===null)return t;if(n===i)return qi(ve(e),ve(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function MD(e,t){if(Mo(e)!==Mo(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function hr(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(Mo(e)>Mo(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class yz{constructor(t,n){this.errorPrefix_=n,this.parts_=RD(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Am(this.parts_[i]);DD(this)}}function xz(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Am(t),DD(e)}function _z(e){const t=e.parts_.pop();e.byteLength_-=Am(t),e.parts_.length>0&&(e.byteLength_-=1)}function DD(e){if(e.byteLength_>qN)throw new Error(e.errorPrefix_+"has a key path longer than "+qN+" bytes ("+e.byteLength_+").");if(e.parts_.length>VN)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+VN+") or object contains a cycle "+ta(e))}function ta(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw extends ID{static getInstance(){return new Iw}constructor(){super(["visible"]);let t,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(t){return ut(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh=1e3,wz=60*5*1e3,jN=30*1e3,bz=1.3,Tz=3e4,Cz="server_kill",FN=3;class ms extends SD{constructor(t,n,i,r,s,o,a,c){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=ms.nextPersistentConnectionId_++,this.log_=Zu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=sh,this.maxReconnectDelay_=wz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Iw.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Pf.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){const r=++this.requestNumber_,s={r,a:t,b:n};this.log_(_n(s)),ut(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(t){this.initConnection_();const n=new H_,r={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(t,n,i,r){this.initConnection_();const s=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ut(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ut(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:t,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(t){const n=t.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},o="q";t.tag&&(s.q=n._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(o,s,a=>{const c=a.d,h=a.s;ms.warnOnListenWarnings_(c,n),(this.listens.get(i)&&this.listens.get(i).get(r))===t&&(this.log_("listen response",a),h!=="ok"&&this.removeListen_(i,r),t.onComplete&&t.onComplete(h,c))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Ls(t,"w")){const i=Xc(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();bi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||WG(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=jN)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,n=KG(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{const s=r.s,o=r.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const n=t.s,i=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(t,n){const i=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),ut(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,t._queryObject,n)}sendUnlisten_(t,n,i,r){this.log_("Unlisten on "+t+" for "+n);const s={p:t},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:i})}onDisconnectMerge(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:i})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,i,r){const s={p:n,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(t,n,i,r){this.putInternal("p",t,n,i,r)}merge(t,n,i,r){this.putInternal("m",t,n,i,r)}putInternal(t,n,i,r,s){this.initConnection_();const o={p:n,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(t){const n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(t){if(this.connected_){const n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+_n(t));const n=t.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):jx("Unrecognized action received from server: "+_n(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){ut(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Tz&&(this.reconnectDelay_=sh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*bz)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+ms.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,i())},h=function(d){ut(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:c,sendRequest:h};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Rn("getToken() completed but was canceled"):(Rn("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,a=new pz(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,v=>{bi(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(Cz)},s))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&bi(d),c())}}}interrupt(t){Rn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Rn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],mx(this.interruptReasons_)&&(this.reconnectDelay_=sh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let i;n?i=n.map(s=>kw(s)).join("$"):i="default";const r=this.removeListen_(t,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(t,n){const i=new _e(t).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(t,n){Rn("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=FN&&(this.reconnectDelay_=jN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){Rn("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=FN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let n="js";t["sdk."+n+"."+oD.replace(/\./g,"-")]=1,z_()?t["framework.cordova"]=1:aM()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Pf.getInstance().currentlyOnline();return mx(this.interruptReasons_)&&t}}ms.nextPersistentConnectionId_=0;ms.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new Qt(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const i=new Qt(sl,t),r=new Qt(sl,n);return this.compare(i,r)!==0}minPost(){return Qt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kd;class LD extends np{static get __EMPTY_NODE(){return Kd}static set __EMPTY_NODE(t){Kd=t}compare(t,n){return Cl(t.name,n.name)}isDefinedOn(t){throw vl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return Qt.MIN}maxPost(){return new Qt(Na,Kd)}makePost(t,n){return ut(typeof t=="string","KeyIndex indexValue must always be a string."),new Qt(t,Kd)}toString(){return".key"}}const Lc=new LD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(t,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(t=t,o=n?i(t.key,n):1,r&&(o*=-1),o<0)this.isReverse_?t=t.left:t=t.right;else if(o===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(t.key,t.value):n={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class hn{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i??hn.RED,this.left=r??hi.EMPTY_NODE,this.right=s??hi.EMPTY_NODE}copy(t,n,i,r,s){return new hn(t??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return hi.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let i,r;if(i=this,n(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(t,i.key)===0){if(i.right.isEmpty())return hi.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}hn.RED=!0;hn.BLACK=!1;class kz{copy(t,n,i,r,s){return this}insert(t,n,i){return new hn(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class hi{constructor(t,n=hi.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new hi(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,hn.BLACK,null,null))}remove(t){return new hi(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,hn.BLACK,null,null))}get(t){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(t,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(t){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(t,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Wd(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new Wd(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new Wd(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new Wd(this.root_,null,this.comparator_,!0,t)}}hi.EMPTY_NODE=new kz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(e,t){return Cl(e.name,t.name)}function Aw(e,t){return Cl(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ux;function Ez(e){Ux=e}const VD=function(e){return typeof e=="number"?"number:"+uD(e):"string:"+e},qD=function(e){if(e.isLeafNode()){const t=e.val();ut(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Ls(t,".sv"),"Priority must be a string or number.")}else ut(e===Ux||e.isEmpty(),"priority of unexpected type.");ut(e===Ux||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UN;class an{static set __childrenNodeConstructor(t){UN=t}static get __childrenNodeConstructor(){return UN}constructor(t,n=an.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,ut(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),qD(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new an(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:an.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return zt(t)?this:Wt(t)===".priority"?this.priorityNode_:an.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:an.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){const i=Wt(t);return i===null?n:n.isEmpty()&&i!==".priority"?this:(ut(i!==".priority"||Mo(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,an.__childrenNodeConstructor.EMPTY_NODE.updateChild(ve(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+VD(this.priorityNode_.val())+":");const n=typeof this.value_;t+=n+":",n==="number"?t+=uD(this.value_):t+=this.value_,this.lazyHash_=cD(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===an.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof an.__childrenNodeConstructor?-1:(ut(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,i=typeof this.value_,r=an.VALUE_TYPE_ORDER.indexOf(n),s=an.VALUE_TYPE_ORDER.indexOf(i);return ut(r>=0,"Unknown leaf type: "+n),ut(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}an.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jD,FD;function Sz(e){jD=e}function Iz(e){FD=e}class Az extends np{compare(t,n){const i=t.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Cl(t.name,n.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return Qt.MIN}maxPost(){return new Qt(Na,new an("[PRIORITY-POST]",FD))}makePost(t,n){const i=jD(t);return new Qt(n,new an("[PRIORITY-POST]",i))}toString(){return".priority"}}const Dn=new Az;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz=Math.log(2);class Pz{constructor(t){const n=s=>parseInt(Math.log(s)/Rz,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(t+1),this.current_=this.count-1;const r=i(this.count);this.bits_=t+1&r}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Mf=function(e,t,n,i){e.sort(t);const r=function(c,h){const u=h-c;let d,f;if(u===0)return null;if(u===1)return d=e[c],f=n?n(d):d,new hn(f,d.node,hn.BLACK,null,null);{const v=parseInt(u/2,10)+c,y=r(c,v),w=r(v+1,h);return d=e[v],f=n?n(d):d,new hn(f,d.node,hn.BLACK,y,w)}},s=function(c){let h=null,u=null,d=e.length;const f=function(y,w){const _=d-y,x=d;d-=y;const C=r(_+1,x),k=e[_],P=n?n(k):k;v(new hn(P,k.node,w,null,C))},v=function(y){h?(h.left=y,h=y):(u=y,h=y)};for(let y=0;y<c.count;++y){const w=c.nextBitIsOne(),_=Math.pow(2,c.count-(y+1));w?f(_,hn.BLACK):(f(_,hn.BLACK),f(_,hn.RED))}return u},o=new Pz(e.length),a=s(o);return new hi(i||t,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mv;const Xa={};class as{static get Default(){return ut(Xa&&Dn,"ChildrenNode.ts has not been loaded"),Mv=Mv||new as({".priority":Xa},{".priority":Dn}),Mv}constructor(t,n){this.indexes_=t,this.indexSet_=n}get(t){const n=Xc(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof hi?n:null}hasIndex(t){return Ls(this.indexSet_,t.toString())}addIndex(t,n){ut(t!==Lc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=n.getIterator(Qt.Wrap);let o=s.getNext();for(;o;)r=r||t.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Mf(i,t.getCompare()):a=Xa;const c=t.toString(),h={...this.indexSet_};h[c]=t;const u={...this.indexes_};return u[c]=a,new as(u,h)}addToIndexes(t,n){const i=vf(this.indexes_,(r,s)=>{const o=Xc(this.indexSet_,s);if(ut(o,"Missing index implementation for "+s),r===Xa)if(o.isDefinedOn(t.node)){const a=[],c=n.getIterator(Qt.Wrap);let h=c.getNext();for(;h;)h.name!==t.name&&a.push(h),h=c.getNext();return a.push(t),Mf(a,o.getCompare())}else return Xa;else{const a=n.get(t.name);let c=r;return a&&(c=c.remove(new Qt(t.name,a))),c.insert(t,t.node)}});return new as(i,this.indexSet_)}removeFromIndexes(t,n){const i=vf(this.indexes_,r=>{if(r===Xa)return r;{const s=n.get(t.name);return s?r.remove(new Qt(t.name,s)):r}});return new as(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oh;class ee{static get EMPTY_NODE(){return oh||(oh=new ee(new hi(Aw),null,as.Default))}constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&qD(this.priorityNode_),this.children_.isEmpty()&&ut(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||oh}updatePriority(t){return this.children_.isEmpty()?this:new ee(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const n=this.children_.get(t);return n===null?oh:n}}getChild(t){const n=Wt(t);return n===null?this:this.getImmediateChild(n).getChild(ve(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if(ut(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{const i=new Qt(t,n);let r,s;n.isEmpty()?(r=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?oh:this.priorityNode_;return new ee(r,o,s)}}updateChild(t,n){const i=Wt(t);if(i===null)return n;{ut(Wt(t)!==".priority"||Mo(t)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(ve(t),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(Dn,(o,a)=>{n[o]=a.val(t),i++,s&&ee.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!t&&s&&r<2*i){const o=[];for(const a in n)o[a]=n[a];return o}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+VD(this.getPriority().val())+":"),this.forEachChild(Dn,(n,i)=>{const r=i.hash();r!==""&&(t+=":"+n+":"+r)}),this.lazyHash_=t===""?"":cD(t)}return this.lazyHash_}getPredecessorChildName(t,n,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new Qt(t,n));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const n=this.getFirstChildName(t);return n?new Qt(n,this.children_.get(n)):null}getLastChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const n=this.getLastChildName(t);return n?new Qt(n,this.children_.get(n)):null}forEachChild(t,n){const i=this.resolveIndex_(t);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(t,r=>r);{const r=this.children_.getIteratorFrom(t.name,Qt.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(t,r=>r);{const r=this.children_.getReverseIteratorFrom(t.name,Qt.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)>0;)r.getNext(),s=r.peek();return r}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ed?-1:0}withIndex(t){if(t===Lc||this.indexMap_.hasIndex(t))return this;{const n=this.indexMap_.addIndex(t,this.children_);return new ee(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===Lc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(Dn),r=n.getIterator(Dn);let s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(t){return t===Lc?null:this.indexMap_.get(t.toString())}}ee.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Mz extends ee{constructor(){super(new hi(Aw),ee.EMPTY_NODE,as.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ee.EMPTY_NODE}isEmpty(){return!1}}const ed=new Mz;Object.defineProperties(Qt,{MIN:{value:new Qt(sl,ee.EMPTY_NODE)},MAX:{value:new Qt(Na,ed)}});LD.__EMPTY_NODE=ee.EMPTY_NODE;an.__childrenNodeConstructor=ee;Ez(ed);Iz(ed);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz=!0;function Pn(e,t=null){if(e===null)return ee.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),ut(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const n=e;return new an(n,Pn(t))}if(!(e instanceof Array)&&Dz){const n=[];let i=!1;if(Wi(e,(o,a)=>{if(o.substring(0,1)!=="."){const c=Pn(a);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new Qt(o,c)))}}),n.length===0)return ee.EMPTY_NODE;const s=Mf(n,Nz,o=>o.name,Aw);if(i){const o=Mf(n,Dn.getCompare());return new ee(s,Pn(t),new as({".priority":o},{".priority":Dn}))}else return new ee(s,Pn(t),as.Default)}else{let n=ee.EMPTY_NODE;return Wi(e,(i,r)=>{if(Ls(e,i)&&i.substring(0,1)!=="."){const s=Pn(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(Pn(t))}}Sz(Pn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lz extends np{constructor(t){super(),this.indexPath_=t,ut(!zt(t)&&Wt(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const i=this.extractChild(t.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Cl(t.name,n.name):s}makePost(t,n){const i=Pn(t),r=ee.EMPTY_NODE.updateChild(this.indexPath_,i);return new Qt(n,r)}maxPost(){const t=ee.EMPTY_NODE.updateChild(this.indexPath_,ed);return new Qt(Na,t)}toString(){return RD(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vz extends np{compare(t,n){const i=t.node.compareTo(n.node);return i===0?Cl(t.name,n.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return Qt.MIN}maxPost(){return Qt.MAX}makePost(t,n){const i=Pn(t);return new Qt(n,i)}toString(){return".value"}}const qz=new Vz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jz(e){return{type:"value",snapshotNode:e}}function Fz(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Uz(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ON(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function Oz(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Dn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ut(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ut(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:sl}hasEnd(){return this.endSet_}getIndexEndValue(){return ut(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ut(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Na}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ut(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Dn}copy(){const t=new Rw;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function BN(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Dn?n="$priority":e.index_===qz?n="$value":e.index_===Lc?n="$key":(ut(e.index_ instanceof Lz,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=_n(n),e.startSet_){const i=e.startAfterSet_?"startAfter":"startAt";t[i]=_n(e.indexStartValue_),e.startNameSet_&&(t[i]+=","+_n(e.indexStartName_))}if(e.endSet_){const i=e.endBeforeSet_?"endBefore":"endAt";t[i]=_n(e.indexEndValue_),e.endNameSet_&&(t[i]+=","+_n(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function GN(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;n===""&&(e.isViewFromLeft()?n="l":n="r"),t.vf=n}return e.index_!==Dn&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df extends SD{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return n!==void 0?"tag$"+n:(ut(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,n,i,r){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Zu("p:rest:"),this.listens_={}}listen(t,n,i,r){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=Df.getListenId_(t,i),a={};this.listens_[o]=a;const c=BN(t._queryParams);this.restRequest_(s+".json",c,(h,u)=>{let d=u;if(h===404&&(d=null,h=null),h===null&&this.onDataUpdate_(s,d,!1,i),Xc(this.listens_,o)===a){let f;h?h===401?f="permission_denied":f="rest_error:"+h:f="ok",r(f,null)}})}unlisten(t,n){const i=Df.getListenId_(t,n);delete this.listens_[i]}get(t){const n=BN(t._queryParams),i=t._path.toString(),r=new H_;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(t){}restRequest_(t,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+yl(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=gu(a.responseText)}catch{bi("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,c)}else a.status!==401&&a.status!==404&&bi("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(){return{value:null,children:new Map}}function UD(e,t,n){if(zt(t))e.value=n,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,n);else{const i=Wt(t);e.children.has(i)||e.children.set(i,Lf());const r=e.children.get(i);t=ve(t),UD(r,t,n)}}function Ox(e,t,n){e.value!==null?n(t,e.value):Gz(e,(i,r)=>{const s=new _e(t.toString()+"/"+i);Ox(r,s,n)})}function Gz(e,t){e.children.forEach((n,i)=>{t(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n={...t};return this.last_&&Wi(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN=10*1e3,$z=30*1e3,zz=5*60*1e3;class Kz{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Hz(t);const i=HN+($z-HN)*Math.random();jh(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),n={};let i=!1;Wi(t,(r,s)=>{s>0&&Ls(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),jh(this.reportStats_.bind(this),Math.floor(Math.random()*2*zz))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vr;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Vr||(Vr={}));function OD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function BD(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function GD(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(t,n,i){this.path=t,this.affectedTree=n,this.revert=i,this.type=Vr.ACK_USER_WRITE,this.source=OD()}operationForChild(t){if(zt(this.path)){if(this.affectedTree.value!=null)return ut(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new _e(t));return new Vf(se(),n,this.revert)}}else return ut(Wt(this.path)===t,"operationForChild called for unrelated child."),new Vf(ve(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(t,n,i){this.source=t,this.path=n,this.snap=i,this.type=Vr.OVERWRITE}operationForChild(t){return zt(this.path)?new Ea(this.source,se(),this.snap.getImmediateChild(t)):new Ea(this.source,ve(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(t,n,i){this.source=t,this.path=n,this.children=i,this.type=Vr.MERGE}operationForChild(t){if(zt(this.path)){const n=this.children.subtree(new _e(t));return n.isEmpty()?null:n.value?new Ea(this.source,se(),n.value):new Tu(this.source,se(),n)}else return ut(Wt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Tu(this.source,ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(t,n,i){this.node_=t,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(zt(t))return this.isFullyInitialized()&&!this.filtered_;const n=Wt(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}function Wz(e,t,n,i){const r=[],s=[];return t.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Oz(o.childName,o.snapshotNode))}),ah(e,r,"child_removed",t,i,n),ah(e,r,"child_added",t,i,n),ah(e,r,"child_moved",s,i,n),ah(e,r,"child_changed",t,i,n),ah(e,r,"value",t,i,n),r}function ah(e,t,n,i,r,s){const o=i.filter(a=>a.type===n);o.sort((a,c)=>Yz(e,a,c)),o.forEach(a=>{const c=Qz(e,a,s);r.forEach(h=>{h.respondsTo(a.type)&&t.push(h.createEvent(c,e.query_))})})}function Qz(e,t,n){return t.type==="value"||t.type==="child_removed"||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function Yz(e,t,n){if(t.childName==null||n.childName==null)throw vl("Should only compare child_ events.");const i=new Qt(t.childName,t.snapshotNode),r=new Qt(n.childName,n.snapshotNode);return e.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(e,t){return{eventCache:e,serverCache:t}}function Fh(e,t,n,i){return HD(new Pw(t,n,i),e.serverCache)}function $D(e,t,n,i){return HD(e.eventCache,new Pw(t,n,i))}function Bx(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Sa(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dv;const Xz=()=>(Dv||(Dv=new hi(q9)),Dv);class pe{static fromObject(t){let n=new pe(null);return Wi(t,(i,r)=>{n=n.set(new _e(i),r)}),n}constructor(t,n=Xz()){this.value=t,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(this.value!=null&&n(this.value))return{path:se(),value:this.value};if(zt(t))return null;{const i=Wt(t),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(ve(t),n);return s!=null?{path:dn(new _e(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(zt(t))return this;{const n=Wt(t),i=this.children.get(n);return i!==null?i.subtree(ve(t)):new pe(null)}}set(t,n){if(zt(t))return new pe(n,this.children);{const i=Wt(t),s=(this.children.get(i)||new pe(null)).set(ve(t),n),o=this.children.insert(i,s);return new pe(this.value,o)}}remove(t){if(zt(t))return this.children.isEmpty()?new pe(null):new pe(null,this.children);{const n=Wt(t),i=this.children.get(n);if(i){const r=i.remove(ve(t));let s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new pe(null):new pe(this.value,s)}else return this}}get(t){if(zt(t))return this.value;{const n=Wt(t),i=this.children.get(n);return i?i.get(ve(t)):null}}setTree(t,n){if(zt(t))return n;{const i=Wt(t),s=(this.children.get(i)||new pe(null)).setTree(ve(t),n);let o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new pe(this.value,o)}}fold(t){return this.fold_(se(),t)}fold_(t,n){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(dn(t,r),n)}),n(t,this.value,i)}findOnPath(t,n){return this.findOnPath_(t,se(),n)}findOnPath_(t,n,i){const r=this.value?i(n,this.value):!1;if(r)return r;if(zt(t))return null;{const s=Wt(t),o=this.children.get(s);return o?o.findOnPath_(ve(t),dn(n,s),i):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,se(),n)}foreachOnPath_(t,n,i){if(zt(t))return this;{this.value&&i(n,this.value);const r=Wt(t),s=this.children.get(r);return s?s.foreachOnPath_(ve(t),dn(n,r),i):new pe(null)}}foreach(t){this.foreach_(se(),t)}foreach_(t,n){this.children.inorderTraversal((i,r)=>{r.foreach_(dn(t,i),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,i)=>{i.value&&t(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(t){this.writeTree_=t}static empty(){return new xr(new pe(null))}}function Uh(e,t,n){if(zt(t))return new xr(new pe(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(i!=null){const r=i.path;let s=i.value;const o=qi(r,t);return s=s.updateChild(o,n),new xr(e.writeTree_.set(r,s))}else{const r=new pe(n),s=e.writeTree_.setTree(t,r);return new xr(s)}}}function $N(e,t,n){let i=e;return Wi(n,(r,s)=>{i=Uh(i,dn(t,r),s)}),i}function zN(e,t){if(zt(t))return xr.empty();{const n=e.writeTree_.setTree(t,new pe(null));return new xr(n)}}function Gx(e,t){return Oa(e,t)!=null}function Oa(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return n!=null?e.writeTree_.get(n.path).getChild(qi(n.path,t)):null}function KN(e){const t=[],n=e.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Dn,(i,r)=>{t.push(new Qt(i,r))}):e.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&t.push(new Qt(i,r.value))}),t}function bo(e,t){if(zt(t))return e;{const n=Oa(e,t);return n!=null?new xr(new pe(n)):new xr(e.writeTree_.subtree(t))}}function Hx(e){return e.writeTree_.isEmpty()}function ol(e,t){return zD(se(),e.writeTree_,t)}function zD(e,t,n){if(t.value!=null)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal((r,s)=>{r===".priority"?(ut(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=zD(dn(e,r),s,n)}),!n.getChild(e).isEmpty()&&i!==null&&(n=n.updateChild(dn(e,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KD(e,t){return JD(t,e)}function Jz(e,t,n,i,r){ut(i>e.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=Uh(e.visibleWrites,t,n)),e.lastWriteId=i}function Zz(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}function tK(e,t){const n=e.allWrites.findIndex(a=>a.writeId===t);ut(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const a=e.allWrites[o];a.visible&&(o>=n&&eK(a,i.path)?r=!1:hr(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return nK(e),!0;if(i.snap)e.visibleWrites=zN(e.visibleWrites,i.path);else{const a=i.children;Wi(a,c=>{e.visibleWrites=zN(e.visibleWrites,dn(i.path,c))})}return!0}else return!1}function eK(e,t){if(e.snap)return hr(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&hr(dn(e.path,n),t))return!0;return!1}function nK(e){e.visibleWrites=WD(e.allWrites,iK,se()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function iK(e){return e.visible}function WD(e,t,n){let i=xr.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const o=s.path;let a;if(s.snap)hr(n,o)?(a=qi(n,o),i=Uh(i,a,s.snap)):hr(o,n)&&(a=qi(o,n),i=Uh(i,se(),s.snap.getChild(a)));else if(s.children){if(hr(n,o))a=qi(n,o),i=$N(i,a,s.children);else if(hr(o,n))if(a=qi(o,n),zt(a))i=$N(i,se(),s.children);else{const c=Xc(s.children,Wt(a));if(c){const h=c.getChild(ve(a));i=Uh(i,se(),h)}}}else throw vl("WriteRecord should have .snap or .children")}}return i}function QD(e,t,n,i,r){if(!i&&!r){const s=Oa(e.visibleWrites,t);if(s!=null)return s;{const o=bo(e.visibleWrites,t);if(Hx(o))return n;if(n==null&&!Gx(o,se()))return null;{const a=n||ee.EMPTY_NODE;return ol(o,a)}}}else{const s=bo(e.visibleWrites,t);if(!r&&Hx(s))return n;if(!r&&n==null&&!Gx(s,se()))return null;{const o=function(h){return(h.visible||r)&&(!i||!~i.indexOf(h.writeId))&&(hr(h.path,t)||hr(t,h.path))},a=WD(e.allWrites,o,t),c=n||ee.EMPTY_NODE;return ol(a,c)}}}function rK(e,t,n){let i=ee.EMPTY_NODE;const r=Oa(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(Dn,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){const s=bo(e.visibleWrites,t);return n.forEachChild(Dn,(o,a)=>{const c=ol(bo(s,new _e(o)),a);i=i.updateImmediateChild(o,c)}),KN(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const s=bo(e.visibleWrites,t);return KN(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function sK(e,t,n,i,r){ut(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=dn(t,n);if(Gx(e.visibleWrites,s))return null;{const o=bo(e.visibleWrites,s);return Hx(o)?r.getChild(n):ol(o,r.getChild(n))}}function oK(e,t,n,i){const r=dn(t,n),s=Oa(e.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){const o=bo(e.visibleWrites,r);return ol(o,i.getNode().getImmediateChild(n))}else return null}function aK(e,t){return Oa(e.visibleWrites,t)}function cK(e,t,n,i,r,s,o){let a;const c=bo(e.visibleWrites,t),h=Oa(c,se());if(h!=null)a=h;else if(n!=null)a=ol(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=o.getCompare(),f=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let v=f.getNext();for(;v&&u.length<r;)d(v,i)!==0&&u.push(v),v=f.getNext();return u}else return[]}function lK(){return{visibleWrites:xr.empty(),allWrites:[],lastWriteId:-1}}function $x(e,t,n,i){return QD(e.writeTree,e.treePath,t,n,i)}function YD(e,t){return rK(e.writeTree,e.treePath,t)}function WN(e,t,n,i){return sK(e.writeTree,e.treePath,t,n,i)}function qf(e,t){return aK(e.writeTree,dn(e.treePath,t))}function hK(e,t,n,i,r,s){return cK(e.writeTree,e.treePath,t,n,i,r,s)}function Mw(e,t,n){return oK(e.writeTree,e.treePath,t,n)}function XD(e,t){return JD(dn(e.treePath,t),e.writeTree)}function JD(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uK{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,i=t.childName;ut(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ut(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,ON(i,t.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Uz(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Fz(i,t.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,ON(i,t.snapshotNode,r.oldSnap));else throw vl("Illegal combination of changes: "+t+" occurred after "+r)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dK{getCompleteChild(t){return null}getChildAfterChild(t,n,i){return null}}const ZD=new dK;class Dw{constructor(t,n,i=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Pw(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Mw(this.writes_,t,i)}}getChildAfterChild(t,n,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Sa(this.viewCache_),s=hK(this.writes_,r,n,1,i,t);return s.length===0?null:s[0]}}function gK(e,t){ut(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),ut(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function fK(e,t,n,i,r){const s=new uK;let o,a;if(n.type===Vr.OVERWRITE){const h=n;h.source.fromUser?o=zx(e,t,h.path,h.snap,i,r,s):(ut(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered()&&!zt(h.path),o=jf(e,t,h.path,h.snap,i,r,a,s))}else if(n.type===Vr.MERGE){const h=n;h.source.fromUser?o=pK(e,t,h.path,h.children,i,r,s):(ut(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered(),o=Kx(e,t,h.path,h.children,i,r,a,s))}else if(n.type===Vr.ACK_USER_WRITE){const h=n;h.revert?o=xK(e,t,h.path,i,r,s):o=vK(e,t,h.path,h.affectedTree,i,r,s)}else if(n.type===Vr.LISTEN_COMPLETE)o=yK(e,t,n.path,i,s);else throw vl("Unknown operation type: "+n.type);const c=s.getChanges();return mK(t,o,c),{viewCache:o,changes:c}}function mK(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Bx(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(jz(Bx(t)))}}function tL(e,t,n,i,r,s){const o=t.eventCache;if(qf(i,n)!=null)return t;{let a,c;if(zt(n))if(ut(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const h=Sa(t),u=h instanceof ee?h:ee.EMPTY_NODE,d=YD(i,u);a=e.filter.updateFullNode(t.eventCache.getNode(),d,s)}else{const h=$x(i,Sa(t));a=e.filter.updateFullNode(t.eventCache.getNode(),h,s)}else{const h=Wt(n);if(h===".priority"){ut(Mo(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=t.serverCache.getNode();const d=WN(i,n,u,c);d!=null?a=e.filter.updatePriority(u,d):a=o.getNode()}else{const u=ve(n);let d;if(o.isCompleteForChild(h)){c=t.serverCache.getNode();const f=WN(i,n,o.getNode(),c);f!=null?d=o.getNode().getImmediateChild(h).updateChild(u,f):d=o.getNode().getImmediateChild(h)}else d=Mw(i,h,t.serverCache);d!=null?a=e.filter.updateChild(o.getNode(),h,d,u,r,s):a=o.getNode()}}return Fh(t,a,o.isFullyInitialized()||zt(n),e.filter.filtersNodes())}}function jf(e,t,n,i,r,s,o,a){const c=t.serverCache;let h;const u=o?e.filter:e.filter.getIndexedFilter();if(zt(n))h=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){const v=c.getNode().updateChild(n,i);h=u.updateFullNode(c.getNode(),v,null)}else{const v=Wt(n);if(!c.isCompleteForPath(n)&&Mo(n)>1)return t;const y=ve(n),_=c.getNode().getImmediateChild(v).updateChild(y,i);v===".priority"?h=u.updatePriority(c.getNode(),_):h=u.updateChild(c.getNode(),v,_,y,ZD,null)}const d=$D(t,h,c.isFullyInitialized()||zt(n),u.filtersNodes()),f=new Dw(r,d,s);return tL(e,d,n,r,f,a)}function zx(e,t,n,i,r,s,o){const a=t.eventCache;let c,h;const u=new Dw(r,t,s);if(zt(n))h=e.filter.updateFullNode(t.eventCache.getNode(),i,o),c=Fh(t,h,!0,e.filter.filtersNodes());else{const d=Wt(n);if(d===".priority")h=e.filter.updatePriority(t.eventCache.getNode(),i),c=Fh(t,h,a.isFullyInitialized(),a.isFiltered());else{const f=ve(n),v=a.getNode().getImmediateChild(d);let y;if(zt(f))y=i;else{const w=u.getCompleteChild(d);w!=null?AD(f)===".priority"&&w.getChild(PD(f)).isEmpty()?y=w:y=w.updateChild(f,i):y=ee.EMPTY_NODE}if(v.equals(y))c=t;else{const w=e.filter.updateChild(a.getNode(),d,y,f,u,o);c=Fh(t,w,a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function QN(e,t){return e.eventCache.isCompleteForChild(t)}function pK(e,t,n,i,r,s,o){let a=t;return i.foreach((c,h)=>{const u=dn(n,c);QN(t,Wt(u))&&(a=zx(e,a,u,h,r,s,o))}),i.foreach((c,h)=>{const u=dn(n,c);QN(t,Wt(u))||(a=zx(e,a,u,h,r,s,o))}),a}function YN(e,t,n){return n.foreach((i,r)=>{t=t.updateChild(i,r)}),t}function Kx(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c=t,h;zt(n)?h=i:h=new pe(null).setTree(n,i);const u=t.serverCache.getNode();return h.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const v=t.serverCache.getNode().getImmediateChild(d),y=YN(e,v,f);c=jf(e,c,new _e(d),y,r,s,o,a)}}),h.children.inorderTraversal((d,f)=>{const v=!t.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!v){const y=t.serverCache.getNode().getImmediateChild(d),w=YN(e,y,f);c=jf(e,c,new _e(d),w,r,s,o,a)}}),c}function vK(e,t,n,i,r,s,o){if(qf(r,n)!=null)return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(i.value!=null){if(zt(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return jf(e,t,n,c.getNode().getChild(n),r,s,a,o);if(zt(n)){let h=new pe(null);return c.getNode().forEachChild(Lc,(u,d)=>{h=h.set(new _e(u),d)}),Kx(e,t,n,h,r,s,a,o)}else return t}else{let h=new pe(null);return i.foreach((u,d)=>{const f=dn(n,u);c.isCompleteForPath(f)&&(h=h.set(u,c.getNode().getChild(f)))}),Kx(e,t,n,h,r,s,a,o)}}function yK(e,t,n,i,r){const s=t.serverCache,o=$D(t,s.getNode(),s.isFullyInitialized()||zt(n),s.isFiltered());return tL(e,o,n,i,ZD,r)}function xK(e,t,n,i,r,s){let o;if(qf(i,n)!=null)return t;{const a=new Dw(i,t,r),c=t.eventCache.getNode();let h;if(zt(n)||Wt(n)===".priority"){let u;if(t.serverCache.isFullyInitialized())u=$x(i,Sa(t));else{const d=t.serverCache.getNode();ut(d instanceof ee,"serverChildren would be complete if leaf node"),u=YD(i,d)}u=u,h=e.filter.updateFullNode(c,u,s)}else{const u=Wt(n);let d=Mw(i,u,t.serverCache);d==null&&t.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?h=e.filter.updateChild(c,u,d,ve(n),a,s):t.eventCache.getNode().hasChild(u)?h=e.filter.updateChild(c,u,ee.EMPTY_NODE,ve(n),a,s):h=c,h.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=$x(i,Sa(t)),o.isLeafNode()&&(h=e.filter.updateFullNode(h,o,s)))}return o=t.serverCache.isFullyInitialized()||qf(i,se())!=null,Fh(t,h,o,e.filter.filtersNodes())}}function _K(e,t){const n=Sa(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!zt(t)&&!n.getImmediateChild(Wt(t)).isEmpty())?n.getChild(t):null}function XN(e,t,n,i){t.type===Vr.MERGE&&t.source.queryId!==null&&(ut(Sa(e.viewCache_),"We should always have a full cache before handling merges"),ut(Bx(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=fK(e.processor_,r,t,n,i);return gK(e.processor_,s.viewCache),ut(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,wK(e,s.changes,s.viewCache.eventCache.getNode())}function wK(e,t,n,i){const r=e.eventRegistrations_;return Wz(e.eventGenerator_,t,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let JN;function bK(e){ut(!JN,"__referenceConstructor has already been defined"),JN=e}function Lw(e,t,n,i){const r=t.source.queryId;if(r!==null){const s=e.views.get(r);return ut(s!=null,"SyncTree gave us an op for an invalid query."),XN(s,t,n,i)}else{let s=[];for(const o of e.views.values())s=s.concat(XN(o,t,n,i));return s}}function Vw(e,t){let n=null;for(const i of e.views.values())n=n||_K(i,t);return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ZN;function TK(e){ut(!ZN,"__referenceConstructor has already been defined"),ZN=e}class tE{constructor(t){this.listenProvider_=t,this.syncPointTree_=new pe(null),this.pendingWriteTree_=lK(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function CK(e,t,n,i,r){return Jz(e.pendingWriteTree_,t,n,i,r),r?rp(e,new Ea(OD(),t,n)):[]}function vc(e,t,n=!1){const i=Zz(e.pendingWriteTree_,t);if(tK(e.pendingWriteTree_,t)){let s=new pe(null);return i.snap!=null?s=s.set(se(),!0):Wi(i.children,o=>{s=s.set(new _e(o),!0)}),rp(e,new Vf(i.path,s,n))}else return[]}function ip(e,t,n){return rp(e,new Ea(BD(),t,n))}function kK(e,t,n){const i=pe.fromObject(n);return rp(e,new Tu(BD(),t,i))}function NK(e,t,n,i){const r=rL(e,i);if(r!=null){const s=sL(r),o=s.path,a=s.queryId,c=qi(o,t),h=new Ea(GD(a),c,n);return oL(e,o,h)}else return[]}function EK(e,t,n,i){const r=rL(e,i);if(r){const s=sL(r),o=s.path,a=s.queryId,c=qi(o,t),h=pe.fromObject(n),u=new Tu(GD(a),c,h);return oL(e,o,u)}else return[]}function eL(e,t,n){const r=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(o,a)=>{const c=qi(o,t),h=Vw(a,c);if(h)return h});return QD(r,t,s,n,!0)}function rp(e,t){return nL(t,e.syncPointTree_,null,KD(e.pendingWriteTree_,se()))}function nL(e,t,n,i){if(zt(e.path))return iL(e,t,n,i);{const r=t.get(se());n==null&&r!=null&&(n=Vw(r,se()));let s=[];const o=Wt(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const h=n?n.getImmediateChild(o):null,u=XD(i,o);s=s.concat(nL(a,c,h,u))}return r&&(s=s.concat(Lw(r,e,i,n))),s}}function iL(e,t,n,i){const r=t.get(se());n==null&&r!=null&&(n=Vw(r,se()));let s=[];return t.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,h=XD(i,o),u=e.operationForChild(o);u&&(s=s.concat(iL(u,a,c,h)))}),r&&(s=s.concat(Lw(r,e,i,n))),s}function rL(e,t){return e.tagToQueryMap.get(t)}function sL(e){const t=e.indexOf("$");return ut(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new _e(e.substr(0,t))}}function oL(e,t,n){const i=e.syncPointTree_.get(t);ut(i,"Missing sync point for query tag that we're tracking");const r=KD(e.pendingWriteTree_,t);return Lw(i,n,r,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new qw(n)}node(){return this.node_}}class jw{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=dn(this.path_,t);return new jw(this.syncTree_,n)}node(){return eL(this.syncTree_,this.path_)}}const SK=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},eE=function(e,t,n){if(!e||typeof e!="object")return e;if(ut(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return IK(e[".sv"],t,n);if(typeof e[".sv"]=="object")return AK(e[".sv"],t);ut(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},IK=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:ut(!1,"Unexpected server value: "+e)}},AK=function(e,t,n){e.hasOwnProperty("increment")||ut(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;typeof i!="number"&&ut(!1,"Unexpected increment value: "+i);const r=t.node();if(ut(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return typeof o!="number"?i:o+i},RK=function(e,t,n,i){return Fw(t,new jw(n,e),i)},PK=function(e,t,n){return Fw(e,new qw(t),n)};function Fw(e,t,n){const i=e.getPriority().val(),r=eE(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const o=e,a=eE(o.getValue(),t,n);return a!==o.getValue()||r!==o.getPriority().val()?new an(a,Pn(r)):e}else{const o=e;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new an(r))),o.forEachChild(Dn,(a,c)=>{const h=Fw(c,t.getImmediateChild(a),n);h!==c&&(s=s.updateImmediateChild(a,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(t="",n=null,i={children:{},childCount:0}){this.name=t,this.parent=n,this.node=i}}function Ow(e,t){let n=t instanceof _e?t:new _e(t),i=e,r=Wt(n);for(;r!==null;){const s=Xc(i.node.children,r)||{children:{},childCount:0};i=new Uw(r,i,s),n=ve(n),r=Wt(n)}return i}function kl(e){return e.node.value}function aL(e,t){e.node.value=t,Wx(e)}function cL(e){return e.node.childCount>0}function MK(e){return kl(e)===void 0&&!cL(e)}function sp(e,t){Wi(e.node.children,(n,i)=>{t(new Uw(n,e,i))})}function lL(e,t,n,i){n&&t(e),sp(e,r=>{lL(r,t,!0)})}function DK(e,t,n){let i=e.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function nd(e){return new _e(e.parent===null?e.name:nd(e.parent)+"/"+e.name)}function Wx(e){e.parent!==null&&LK(e.parent,e.name,e)}function LK(e,t,n){const i=MK(n),r=Ls(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,Wx(e)):!i&&!r&&(e.node.children[t]=n.node,e.node.childCount++,Wx(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VK=/[\[\].#$\/\u0000-\u001F\u007F]/,qK=/[\[\].#$\u0000-\u001F\u007F]/,Lv=10*1024*1024,hL=function(e){return typeof e=="string"&&e.length!==0&&!VK.test(e)},jK=function(e){return typeof e=="string"&&e.length!==0&&!qK.test(e)},FK=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),jK(e)},uL=function(e,t,n){const i=n instanceof _e?new yz(n,e):n;if(t===void 0)throw new Error(e+"contains undefined "+ta(i));if(typeof t=="function")throw new Error(e+"contains a function "+ta(i)+" with contents = "+t.toString());if(lD(t))throw new Error(e+"contains "+t.toString()+" "+ta(i));if(typeof t=="string"&&t.length>Lv/3&&Am(t)>Lv)throw new Error(e+"contains a string greater than "+Lv+" utf8 bytes "+ta(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let r=!1,s=!1;if(Wi(t,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!hL(o)))throw new Error(e+" contains an invalid key ("+o+") "+ta(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);xz(i,o),uL(e,a,i),_z(i)}),r&&s)throw new Error(e+' contains ".value" child '+ta(i)+" in addition to actual children.")}},UK=function(e,t){const n=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!hL(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!FK(n))throw new Error(ZG(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function BK(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();n!==null&&!MD(s,n.path)&&(e.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function Ba(e,t,n){BK(e,n),GK(e,i=>hr(i,t)||hr(t,i))}function GK(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){const s=r.path;t(s)?(HK(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function HK(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(n!==null){e.events[t]=null;const i=n.getEventRunner();qh&&Rn("event: "+n.toString()),td(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $K="repo_interrupt",zK=25;class KK{constructor(t,n,i,r){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new OK,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Lf(),this.transactionQueueTree_=new Uw,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function WK(e,t,n){if(e.stats_=Ew(e.repoInfo_),e.forceRestClient_||G9())e.server_=new Df(e.repoInfo_,(i,r,s,o)=>{nE(e,i,r,s,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>iE(e,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_n(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}e.persistentConnection_=new ms(e.repoInfo_,t,(i,r,s,o)=>{nE(e,i,r,s,o)},i=>{iE(e,i)},i=>{YK(e,i)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(i=>{e.server_.refreshAuthToken(i)}),e.appCheckProvider_.addTokenChangeListener(i=>{e.server_.refreshAppCheckToken(i.token)}),e.statsReporter_=W9(e.repoInfo_,()=>new Kz(e.stats_,e.server_)),e.infoData_=new Bz,e.infoSyncTree_=new tE({startListening:(i,r,s,o)=>{let a=[];const c=e.infoData_.getNode(i._path);return c.isEmpty()||(a=ip(e.infoSyncTree_,i._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Bw(e,"connected",!1),e.serverSyncTree_=new tE({startListening:(i,r,s,o)=>(e.server_.listen(i,s,r,(a,c)=>{const h=o(a,c);Ba(e.eventQueue_,i._path,h)}),[]),stopListening:(i,r)=>{e.server_.unlisten(i,r)}})}function QK(e){const n=e.infoData_.getNode(new _e(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function dL(e){return SK({timestamp:QK(e)})}function nE(e,t,n,i,r){e.dataUpdateCount++;const s=new _e(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const c=vf(n,h=>Pn(h));o=EK(e.serverSyncTree_,s,c,r)}else{const c=Pn(n);o=NK(e.serverSyncTree_,s,c,r)}else if(i){const c=vf(n,h=>Pn(h));o=kK(e.serverSyncTree_,s,c)}else{const c=Pn(n);o=ip(e.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Hw(e,s)),Ba(e.eventQueue_,a,o)}function iE(e,t){Bw(e,"connected",t),t===!1&&JK(e)}function YK(e,t){Wi(t,(n,i)=>{Bw(e,n,i)})}function Bw(e,t,n){const i=new _e("/.info/"+t),r=Pn(n);e.infoData_.updateSnapshot(i,r);const s=ip(e.infoSyncTree_,i,r);Ba(e.eventQueue_,i,s)}function XK(e){return e.nextWriteId_++}function JK(e){gL(e,"onDisconnectEvents");const t=dL(e),n=Lf();Ox(e.onDisconnect_,se(),(r,s)=>{const o=RK(r,s,e.serverSyncTree_,t);UD(n,r,o)});let i=[];Ox(n,se(),(r,s)=>{i=i.concat(ip(e.serverSyncTree_,r,s));const o=n7(e,r);Hw(e,o)}),e.onDisconnect_=Lf(),Ba(e.eventQueue_,se(),i)}function ZK(e){e.persistentConnection_&&e.persistentConnection_.interrupt($K)}function gL(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Rn(n,...t)}function fL(e,t,n){return eL(e.serverSyncTree_,t,n)||ee.EMPTY_NODE}function Gw(e,t=e.transactionQueueTree_){if(t||op(e,t),kl(t)){const n=pL(e,t);ut(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&t7(e,nd(t),n)}else cL(t)&&sp(t,n=>{Gw(e,n)})}function t7(e,t,n){const i=n.map(h=>h.currentWriteId),r=fL(e,t,i);let s=r;const o=r.hash();for(let h=0;h<n.length;h++){const u=n[h];ut(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=qi(t,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,h=>{gL(e,"transaction put response",{path:c.toString(),status:h});let u=[];if(h==="ok"){const d=[];for(let f=0;f<n.length;f++)n[f].status=2,u=u.concat(vc(e.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&d.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();op(e,Ow(e.transactionQueueTree_,t)),Gw(e,e.transactionQueueTree_),Ba(e.eventQueue_,t,u);for(let f=0;f<d.length;f++)td(d[f])}else{if(h==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{bi("transaction at "+c.toString()+" failed: "+h);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=h}Hw(e,t)}},o)}function Hw(e,t){const n=mL(e,t),i=nd(n),r=pL(e,n);return e7(e,r,i),i}function e7(e,t,n){if(t.length===0)return;const i=[];let r=[];const o=t.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const c=t[a],h=qi(n,c.path);let u=!1,d;if(ut(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,r=r.concat(vc(e.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=zK)u=!0,d="maxretry",r=r.concat(vc(e.serverSyncTree_,c.currentWriteId,!0));else{const f=fL(e,c.path,o);c.currentInputSnapshot=f;const v=t[a].update(f.val());if(v!==void 0){uL("transaction failed: Data returned ",v,c.path);let y=Pn(v);typeof v=="object"&&v!=null&&Ls(v,".priority")||(y=y.updatePriority(f.getPriority()));const _=c.currentWriteId,x=dL(e),C=PK(y,f,x);c.currentOutputSnapshotRaw=y,c.currentOutputSnapshotResolved=C,c.currentWriteId=XK(e),o.splice(o.indexOf(_),1),r=r.concat(CK(e.serverSyncTree_,c.path,C,c.currentWriteId,c.applyLocally)),r=r.concat(vc(e.serverSyncTree_,_,!0))}else u=!0,d="nodata",r=r.concat(vc(e.serverSyncTree_,c.currentWriteId,!0))}Ba(e.eventQueue_,n,r),r=[],u&&(t[a].status=2,function(f){setTimeout(f,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&(d==="nodata"?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(d),!1,null))))}op(e,e.transactionQueueTree_);for(let a=0;a<i.length;a++)td(i[a]);Gw(e,e.transactionQueueTree_)}function mL(e,t){let n,i=e.transactionQueueTree_;for(n=Wt(t);n!==null&&kl(i)===void 0;)i=Ow(i,n),t=ve(t),n=Wt(t);return i}function pL(e,t){const n=[];return vL(e,t,n),n.sort((i,r)=>i.order-r.order),n}function vL(e,t,n){const i=kl(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);sp(t,r=>{vL(e,r,n)})}function op(e,t){const n=kl(t);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,aL(t,n.length>0?n:void 0)}sp(t,i=>{op(e,i)})}function n7(e,t){const n=nd(mL(e,t)),i=Ow(e.transactionQueueTree_,t);return DK(i,r=>{Vv(e,r)}),Vv(e,i),lL(i,r=>{Vv(e,r)}),n}function Vv(e,t){const n=kl(t);if(n){const i=[];let r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(ut(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(ut(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(vc(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?aL(t,void 0):n.length=s+1,Ba(e.eventQueue_,nd(t),r);for(let o=0;o<i.length;o++)td(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i7(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}t+="/"+r}return t}function r7(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const n of e.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):bi(`Invalid query segment '${n}' in query '${e}'`)}return t}const rE=function(e,t){const n=s7(e),i=n.namespace;n.domain==="firebase.com"&&Es(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Es("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||L9();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new wD(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new _e(n.pathString)}},s7=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",c=443;if(typeof e=="string"){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let u=e.indexOf("/");u===-1&&(u=e.length);let d=e.indexOf("?");d===-1&&(d=e.length),t=e.substring(0,Math.min(u,d)),u<d&&(r=i7(e.substring(u,d)));const f=r7(e.substring(Math.min(e.length,d)));h=t.indexOf(":"),h>=0?(o=a==="https"||a==="wss",c=parseInt(t.substring(h+1),10)):h=t.length;const v=t.slice(0,h);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const y=t.indexOf(".");i=t.substring(0,y).toLowerCase(),n=t.substring(y+1),s=i}"ns"in f&&(s=f.ns)}return{host:t,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(t,n,i,r){this._repo=t,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return zt(this._path)?null:AD(this._path)}get ref(){return new Nl(this._repo,this._path)}get _queryIdentifier(){const t=GN(this._queryParams),n=kw(t);return n==="{}"?"default":n}get _queryObject(){return GN(this._queryParams)}isEqual(t){if(t=Ke(t),!(t instanceof $w))return!1;const n=this._repo===t._repo,i=MD(this._path,t._path),r=this._queryIdentifier===t._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+vz(this._path)}}class Nl extends $w{constructor(t,n){super(t,n,new Rw,!1)}get parent(){const t=PD(this._path);return t===null?null:new Nl(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}bK(Nl);TK(Nl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7="FIREBASE_DATABASE_EMULATOR_HOST",Qx={};let a7=!1;function c7(e,t,n,i){const r=t.lastIndexOf(":"),s=t.substring(0,r),o=Ds(s);e.repoInfo_=new wD(t,o,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),i&&(e.authTokenProvider_=i)}function l7(e,t,n,i,r){let s=i||e.options.databaseURL;s===void 0&&(e.options.projectId||Es("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rn("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=rE(s,r),a=o.repoInfo,c;typeof process<"u"&&CN&&(c=CN[o7]),c?(s=`http://${c}?ns=${a.namespace}`,o=rE(s,r),a=o.repoInfo):o.repoInfo.secure;const h=new $9(e.name,e.options,t);UK("Invalid Firebase Database URL",o),zt(o.path)||Es("Database URL must point to the root of a Firebase Database (not including a child path).");const u=u7(a,e,h,new H9(e,n));return new d7(u,e)}function h7(e,t){const n=Qx[t];(!n||n[e.key]!==e)&&Es(`Database ${t}(${e.repoInfo_}) has already been deleted.`),ZK(e),delete n[e.key]}function u7(e,t,n,i){let r=Qx[t.name];r||(r={},Qx[t.name]=r);let s=r[e.toURLString()];return s&&Es("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new KK(e,a7,n,i),r[e.toURLString()]=s,s}class d7{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(WK(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Nl(this._repo,se())),this._rootInternal}_delete(){return this._rootInternal!==null&&(h7(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Es("Cannot call "+t+" on a deleted database.")}}function g7(e=Rm(),t){const n=qa(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const i=G_("database");i&&f7(n,...i)}return n}function f7(e,t,n,i={}){e=Ke(e),e._checkNotDeleted("useEmulator");const r=`${t}:${n}`,s=e._repoInternal;if(e._instanceStarted){if(r===e._repoInternal.repoInfo_.host&&No(i,s.repoInfo_.emulatorOptions))return;Es("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Es('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Eg(Eg.OWNER);else if(i.mockUserToken){const a=typeof i.mockUserToken=="string"?i.mockUserToken:$_(i.mockUserToken,e.app.options.projectId);o=new Eg(a)}Ds(t)&&(Sm(t),Im("Database",!0)),c7(s,r,i,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m7(e){I9(Fo),Ki(new Ci("database",(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return l7(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),qn(kN,NN,e),qn(kN,NN,"esm2020")}ms.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};ms.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};m7();function yL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const p7=yL,xL=new Va("auth","Firebase",yL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ff=new Gu("@firebase/auth");function v7(e,...t){Ff.logLevel<=Ot.WARN&&Ff.warn(`Auth (${Fo}): ${e}`,...t)}function Sg(e,...t){Ff.logLevel<=Ot.ERROR&&Ff.error(`Auth (${Fo}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(e,...t){throw zw(e,...t)}function Br(e,...t){return zw(e,...t)}function _L(e,t,n){const i={...p7(),[t]:n};return new Va("auth","Firebase",i).create(t,{appName:e.name})}function fa(e){return _L(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zw(e,...t){if(typeof e!="string"){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return xL.create(e,...t)}function Pt(e,t,...n){if(!e)throw zw(t,...n)}function cs(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Sg(t),new Error(t)}function Is(e,t){e||cs(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){var e;return typeof self<"u"&&((e=self.location)==null?void 0:e.href)||""}function y7(){return sE()==="http:"||sE()==="https:"}function sE(){var e;return typeof self<"u"&&((e=self.location)==null?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(y7()||oM()||"connection"in navigator)?navigator.onLine:!0}function _7(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(t,n){this.shortDelay=t,this.longDelay=n,Is(n>t,"Short delay should be less than long delay!"),this.isMobile=z_()||aM()}get(){return x7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(e,t){Is(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{static initialize(t,n,i){this.fetchImpl=t,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],T7=new id(3e4,6e4);function Ww(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function El(e,t,n,i,r={}){return bL(e,r,async()=>{let s={},o={};i&&(t==="GET"?o=i:s={body:JSON.stringify(i)});const a=yl({key:e.config.apiKey,...o}).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const h={method:t,headers:c,...s};return FG()||(h.referrerPolicy="no-referrer"),e.emulatorConfig&&Ds(e.emulatorConfig.host)&&(h.credentials="include"),wL.fetch()(await TL(e,e.config.apiHost,n,a),h)})}async function bL(e,t,n){e._canInitEmulator=!1;const i={...w7,...t};try{const r=new k7(e),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Qd(e,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qd(e,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Qd(e,"email-already-in-use",o);if(c==="USER_DISABLED")throw Qd(e,"user-disabled",o);const u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _L(e,u,h);Ss(e,u)}}catch(r){if(r instanceof Ji)throw r;Ss(e,"network-request-failed",{message:String(r)})}}async function C7(e,t,n,i,r={}){const s=await El(e,t,n,i,r);return"mfaPendingCredential"in s&&Ss(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function TL(e,t,n,i){const r=`${t}${n}?${i}`,s=e,o=s.config.emulator?Kw(e.config,r):`${e.config.apiScheme}://${r}`;return b7.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class k7{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Br(this.auth,"network-request-failed")),T7.get())})}}function Qd(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Br(e,t,i);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N7(e,t){return El(e,"POST","/v1/accounts:delete",t)}async function Uf(e,t){return El(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function E7(e,t=!1){const n=Ke(e),i=await n.getIdToken(t),r=Qw(i);Pt(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Oh(qv(r.auth_time)),issuedAtTime:Oh(qv(r.iat)),expirationTime:Oh(qv(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function qv(e){return Number(e)*1e3}function Qw(e){const[t,n,i]=e.split(".");if(t===void 0||n===void 0||i===void 0)return Sg("JWT malformed, contained fewer than 3 sections"),null;try{const r=pf(n);return r?JSON.parse(r):(Sg("Failed to decode base64 JWT payload"),null)}catch(r){return Sg("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function oE(e){const t=Qw(e);return Pt(t,"internal-error"),Pt(typeof t.exp<"u","internal-error"),Pt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cu(e,t,n=!1){if(n)return t;try{return await t}catch(i){throw i instanceof Ji&&S7(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function S7({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oh(this.lastLoginAt),this.creationTime=Oh(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Of(e){var d;const t=e.auth,n=await e.getIdToken(),i=await Cu(e,Uf(t,{idToken:n}));Pt(i==null?void 0:i.users.length,t,"internal-error");const r=i.users[0];e._notifyReloadListener(r);const s=(d=r.providerUserInfo)!=null&&d.length?CL(r.providerUserInfo):[],o=R7(e.providerData,s),a=e.isAnonymous,c=!(e.email&&r.passwordHash)&&!(o!=null&&o.length),h=a?c:!1,u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Xx(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(e,u)}async function A7(e){const t=Ke(e);await Of(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function R7(e,t){return[...e.filter(i=>!t.some(r=>r.providerId===i.providerId)),...t]}function CL(e){return e.map(({providerId:t,...n})=>({providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P7(e,t){const n=await bL(e,{},async()=>{const i=yl({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,o=await TL(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return e.emulatorConfig&&Ds(e.emulatorConfig.host)&&(c.credentials="include"),wL.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function M7(e,t){return El(e,"POST","/v2/accounts:revokeToken",Ww(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Pt(t.idToken,"internal-error"),Pt(typeof t.idToken<"u","internal-error"),Pt(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):oE(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){Pt(t.length!==0,"internal-error");const n=oE(t);this.updateTokensAndExpiration(t,null,n)}async getToken(t,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Pt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,n){const{accessToken:i,refreshToken:r,expiresIn:s}=await P7(t,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(t,n,i){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,n){const{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new Vc;return i&&(Pt(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),r&&(Pt(typeof r=="string","internal-error",{appName:t}),o.accessToken=r),s&&(Pt(typeof s=="number","internal-error",{appName:t}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Vc,this.toJSON())}_performRefresh(){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(e,t){Pt(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ur{constructor({uid:t,auth:n,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new I7(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Xx(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const n=await Cu(this,this.stsTokenManager.getToken(this.auth,t));return Pt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(t){return E7(this,t)}reload(){return A7(this)}_assign(t){this!==t&&(Pt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>({...n})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new ur({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(t){Pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,n=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),n&&await Of(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mi(this.auth.app))return Promise.reject(fa(this.auth));const t=await this.getIdToken();return await Cu(this,N7(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){const i=n.displayName??void 0,r=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,h=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:v,providerData:y,stsTokenManager:w}=n;Pt(d&&w,t,"internal-error");const _=Vc.fromJSON(this.name,w);Pt(typeof d=="string",t,"internal-error"),Ws(i,t.name),Ws(r,t.name),Pt(typeof f=="boolean",t,"internal-error"),Pt(typeof v=="boolean",t,"internal-error"),Ws(s,t.name),Ws(o,t.name),Ws(a,t.name),Ws(c,t.name),Ws(h,t.name),Ws(u,t.name);const x=new ur({uid:d,auth:t,email:r,emailVerified:f,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:_,createdAt:h,lastLoginAt:u});return y&&Array.isArray(y)&&(x.providerData=y.map(C=>({...C}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(t,n,i=!1){const r=new Vc;r.updateFromServerResponse(n);const s=new ur({uid:n.localId,auth:t,stsTokenManager:r,isAnonymous:i});return await Of(s),s}static async _fromGetAccountInfoResponse(t,n,i){const r=n.users[0];Pt(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?CL(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Vc;a.updateFromIdToken(i);const c=new ur({uid:r.localId,auth:t,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Xx(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=new Map;function ls(e){Is(e instanceof Function,"Expected a class definition");let t=aE.get(e);return t?(Is(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,aE.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,n){this.storage[t]=n}async _get(t){const n=this.storage[t];return n===void 0?null:n}async _remove(t){delete this.storage[t]}_addListener(t,n){}_removeListener(t,n){}}kL.type="NONE";const cE=kL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(e,t,n){return`firebase:${e}:${t}:${n}`}class qc{constructor(t,n,i){this.persistence=t,this.auth=n,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Ig(this.userKey,r.apiKey,s),this.fullPersistenceKey=Ig("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const n=await Uf(this.auth,{idToken:t}).catch(()=>{});return n?ur._fromGetAccountInfoResponse(this.auth,n,t):null}return ur._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,i="authUser"){if(!n.length)return new qc(ls(cE),t,i);const r=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||ls(cE);const o=Ig(i,t.config.apiKey,t.name);let a=null;for(const h of n)try{const u=await h._get(o);if(u){let d;if(typeof u=="string"){const f=await Uf(t,{idToken:u}).catch(()=>{});if(!f)break;d=await ur._fromGetAccountInfoResponse(t,f,u)}else d=ur._fromJSON(t,u);h!==s&&(a=d),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new qc(s,t,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new qc(s,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(IL(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(NL(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(RL(t))return"Blackberry";if(PL(t))return"Webos";if(EL(t))return"Safari";if((t.includes("chrome/")||SL(t))&&!t.includes("edge/"))return"Chrome";if(AL(t))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function NL(e=Fn()){return/firefox\//i.test(e)}function EL(e=Fn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function SL(e=Fn()){return/crios\//i.test(e)}function IL(e=Fn()){return/iemobile/i.test(e)}function AL(e=Fn()){return/android/i.test(e)}function RL(e=Fn()){return/blackberry/i.test(e)}function PL(e=Fn()){return/webos/i.test(e)}function Yw(e=Fn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function D7(e=Fn()){var t;return Yw(e)&&!!((t=window.navigator)!=null&&t.standalone)}function L7(){return UG()&&document.documentMode===10}function ML(e=Fn()){return Yw(e)||AL(e)||PL(e)||RL(e)||/windows phone/i.test(e)||IL(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(e,t=[]){let n;switch(e){case"Browser":n=lE(Fn());break;case"Worker":n=`${lE(Fn())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fo}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const i=s=>new Promise((o,a)=>{try{const c=t(s);o(c)}catch(c){a(c)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const n=[];try{for(const i of this.queue)await i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q7(e,t={}){return El(e,"GET","/v2/passwordPolicy",Ww(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j7=6;class F7{constructor(t){var i;const n=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??j7,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=t.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,n),this.validatePasswordCharacterOptions(t,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(t,n){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=t.length>=i),r&&(n.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<t.length;r++)i=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(t,n,i,r){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hE(this),this.idTokenSubscription=new hE(this),this.beforeStateQueue=new V7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=ls(n)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await qc.create(this,t),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const n=await Uf(this,{idToken:t}),i=await ur._fromGetAccountInfoResponse(this,n,t);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var s;if(Mi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(t);(!o||o===a)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(t){try{await Of(t)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=_7()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Mi(this.app))return Promise.reject(fa(this));const n=t?Ke(t):null;return n&&Pt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(t,n=!1){if(!this._deleted)return t&&Pt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Mi(this.app)?Promise.reject(fa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Mi(this.app)?Promise.reject(fa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ls(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await q7(this),n=new F7(t);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Va("auth","Firebase",t())}onAuthStateChanged(t,n,i){return this.registerStateListener(this.authStateSubscription,t,n,i)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,i){return this.registerStateListener(this.idTokenSubscription,t,n,i)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},n)}})}async revokeAccessToken(t){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await M7(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)==null?void 0:t.toJSON()}}async _setRedirectUser(t,n){const i=await this.getOrInitRedirectPersistenceManager(n);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const n=t&&ls(t)||this._popupRedirectResolver;Pt(n,this,"argument-error"),this.redirectPersistenceManager=await qc.create(this,[ls(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===t?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,i,r){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=t.addObserver(n,i,r);return()=>{o=!0,c()}}else{const c=t.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=DL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var n;if(Mi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return t!=null&&t.error&&v7(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Xw(e){return Ke(e)}class hE{constructor(t){this.auth=t,this.observer=null,this.addObserver=YG(n=>this.observer=n)}get next(){return Pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function O7(e){Jw=e}function B7(e){return Jw.loadJS(e)}function G7(){return Jw.gapiScript}function H7(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $7(e,t){const n=qa(e,"auth");if(n.isInitialized()){const r=n.getImmediate(),s=n.getOptions();if(No(s,t??{}))return r;Ss(r,"already-initialized")}return n.initialize({options:t})}function z7(e,t){const n=(t==null?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ls);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function K7(e,t,n){const i=Xw(e);Pt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!1,s=LL(t),{host:o,port:a}=W7(t),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Pt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Pt(No(h,i.config.emulator)&&No(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,Ds(o)?(Sm(`${s}//${o}${c}`),Im("Auth",!0)):Q7()}function LL(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function W7(e){const t=LL(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:uE(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:uE(o)}}}function uE(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function Q7(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return cs("not implemented")}_getIdTokenResponse(t){return cs("not implemented")}_linkToIdToken(t,n){return cs("not implemented")}_getReauthenticationResolver(t){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jc(e,t){return C7(e,"POST","/v1/accounts:signInWithIdp",Ww(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y7="http://localhost";class Ia extends VL{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new Ia(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Ss("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:r,...s}=n;if(!i||!r)return null;const o=new Ia(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){const n=this.buildRequest();return jc(t,n)}_linkToIdToken(t,n){const i=this.buildRequest();return i.idToken=n,jc(t,i)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,jc(t,n)}buildRequest(){const t={requestUri:Y7,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=yl(n)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends qL{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends rd{constructor(){super("facebook.com")}static credential(t){return Ia._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return to.credentialFromTaggedObject(t)}static credentialFromError(t){return to.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return to.credential(t.oauthAccessToken)}catch{return null}}}to.FACEBOOK_SIGN_IN_METHOD="facebook.com";to.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends rd{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return Ia._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return eo.credentialFromTaggedObject(t)}static credentialFromError(t){return eo.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return eo.credential(n,i)}catch{return null}}}eo.GOOGLE_SIGN_IN_METHOD="google.com";eo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends rd{constructor(){super("github.com")}static credential(t){return Ia._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return no.credentialFromTaggedObject(t)}static credentialFromError(t){return no.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return no.credential(t.oauthAccessToken)}catch{return null}}}no.GITHUB_SIGN_IN_METHOD="github.com";no.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends rd{constructor(){super("twitter.com")}static credential(t,n){return Ia._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return io.credentialFromTaggedObject(t)}static credentialFromError(t){return io.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return io.credential(n,i)}catch{return null}}}io.TWITTER_SIGN_IN_METHOD="twitter.com";io.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,n,i,r=!1){const s=await ur._fromIdTokenResponse(t,i,r),o=dE(i);return new al({user:s,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(t,n,i){await t._updateTokensIfNecessary(i,!0);const r=dE(i);return new al({user:t,providerId:r,_tokenResponse:i,operationType:n})}}function dE(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf extends Ji{constructor(t,n,i,r){super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Bf.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,n,i,r){return new Bf(t,n,i,r)}}function jL(e,t,n,i){return(t==="reauthenticate"?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Bf._fromErrorAndOperation(e,s,t,i):s})}async function X7(e,t,n=!1){const i=await Cu(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return al._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J7(e,t,n=!1){const{auth:i}=e;if(Mi(i.app))return Promise.reject(fa(i));const r="reauthenticate";try{const s=await Cu(e,jL(i,r,t,e),n);Pt(s.idToken,i,"internal-error");const o=Qw(s.idToken);Pt(o,i,"internal-error");const{sub:a}=o;return Pt(e.uid===a,i,"user-mismatch"),al._forOperation(e,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ss(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z7(e,t,n=!1){if(Mi(e.app))return Promise.reject(fa(e));const i="signIn",r=await jL(e,i,t),s=await al._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}function tW(e,t,n,i){return Ke(e).onIdTokenChanged(t,n,i)}function eW(e,t,n){return Ke(e).beforeAuthStateChanged(t,n)}const Gf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Gf,"1"),this.storage.removeItem(Gf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nW=1e3,iW=10;class UL extends FL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ML(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&t(n,r,i)}}onStorageEvent(t,n=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=t.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);L7()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,iW):r()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},nW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,n){await super._set(t,n),this.localCache[t]=JSON.stringify(n)}async _get(t){const n=await super._get(t);return this.localCache[t]=JSON.stringify(n),n}async _remove(t){await super._remove(t),delete this.localCache[t]}}UL.type="LOCAL";const rW=UL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL extends FL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}OL.type="SESSION";const BL=OL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sW(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(r=>r.isListeningto(t));if(n)return n;const i=new ap(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const n=t,{eventId:i,eventType:r,data:s}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(n.origin,s)),c=await sW(a);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(t,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ap.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(Math.random()*10);return e+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oW{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=Zw("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const f=d;if(f.data.eventId===h)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(){return window}function aW(e){Gr().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(){return typeof Gr().WorkerGlobalScope<"u"&&typeof Gr().importScripts=="function"}async function cW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function lW(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)==null?void 0:e.controller)||null}function hW(){return GL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL="firebaseLocalStorageDb",uW=1,Hf="firebaseLocalStorage",$L="fbase_key";class sd{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function cp(e,t){return e.transaction([Hf],t?"readwrite":"readonly").objectStore(Hf)}function dW(){const e=indexedDB.deleteDatabase(HL);return new sd(e).toPromise()}function Jx(){const e=indexedDB.open(HL,uW);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(Hf,{keyPath:$L})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(Hf)?t(i):(i.close(),await dW(),t(await Jx()))})})}async function gE(e,t,n){const i=cp(e,!0).put({[$L]:t,value:n});return new sd(i).toPromise()}async function gW(e,t){const n=cp(e,!1).get(t),i=await new sd(n).toPromise();return i===void 0?null:i.value}function fE(e,t){const n=cp(e,!0).delete(t);return new sd(n).toPromise()}const fW=800,mW=3;class zL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jx(),this.db)}async _withRetries(t){let n=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(n++>mW)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ap._getInstance(hW()),this.receiver._subscribe("keyChanged",async(t,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(t,n)=>["keyChanged"])}async initializeSender(){var n,i;if(this.activeServiceWorker=await cW(),!this.activeServiceWorker)return;this.sender=new oW(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&(n=t[0])!=null&&n.fulfilled&&(i=t[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||lW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Jx();return await gE(t,Gf,"1"),await fE(t,Gf),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>gE(i,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){const n=await this._withRetries(i=>gW(i,t));return this.localCache[t]=n,n}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(n=>fE(n,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(r=>{const s=cp(r,!1).getAll();return new sd(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(t.length!==0)for(const{fbase_key:r,value:s}of t)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zL.type="LOCAL";const pW=zL;new id(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vW(e,t){return t?ls(t):(Pt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb extends VL{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return jc(t,this._buildIdpRequest())}_linkToIdToken(t,n){return jc(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return jc(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function yW(e){return Z7(e.auth,new tb(e),e.bypassAuthState)}function xW(e){const{auth:t,user:n}=e;return Pt(n,t,"internal-error"),J7(n,new tb(e),e.bypassAuthState)}async function _W(e){const{auth:t,user:n}=e;return Pt(n,t,"internal-error"),X7(n,new tb(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(t,n,i,r,s=!1){this.auth=t,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(t,n)=>{this.pendingPromise={resolve:t,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return yW;case"linkViaPopup":case"linkViaRedirect":return _W;case"reauthViaPopup":case"reauthViaRedirect":return xW;default:Ss(this.auth,"internal-error")}}resolve(t){Is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wW=new id(2e3,1e4);class yc extends KL{constructor(t,n,i,r,s){super(t,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,yc.currentPopupAction&&yc.currentPopupAction.cancel(),yc.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Pt(t,this.auth,"internal-error"),t}async onExecution(){Is(this.filter.length===1,"Popup operations only handle one event");const t=Zw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)==null?void 0:t.associatedEvent)||null}cancel(){this.reject(Br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yc.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;if((i=(n=this.authWindow)==null?void 0:n.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,wW.get())};t()}}yc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW="pendingRedirect",Ag=new Map;class TW extends KL{constructor(t,n,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let t=Ag.get(this.auth._key());if(!t){try{const i=await CW(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(n){t=()=>Promise.reject(n)}Ag.set(this.auth._key(),t)}return this.bypassAuthState||Ag.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const n=await this.auth._redirectUserForId(t.eventId);if(n)return this.user=n,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CW(e,t){const n=EW(t),i=NW(e);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}function kW(e,t){Ag.set(e._key(),t)}function NW(e){return ls(e._redirectPersistence)}function EW(e){return Ig(bW,e.config.apiKey,e.name)}async function SW(e,t,n=!1){if(Mi(e.app))return Promise.reject(fa(e));const i=Xw(e),r=vW(i,t),o=await new TW(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW=10*60*1e3;class AW{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(n=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!RW(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var i;if(t.error&&!WL(t)){const r=((i=t.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";n.onError(Br(this.auth,r))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const i=n.eventId===null||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=IW&&this.cachedEventUids.clear(),this.cachedEventUids.has(mE(t))}saveEventToCache(t){this.cachedEventUids.add(mE(t)),this.lastProcessedEventTime=Date.now()}}function mE(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function WL({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function RW(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WL(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PW(e,t={}){return El(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DW=/^https?/;async function LW(e){if(e.config.emulator)return;const{authorizedDomains:t}=await PW(e);for(const n of t)try{if(VW(n))return}catch{}Ss(e,"unauthorized-domain")}function VW(e){const t=Yx(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const o=new URL(e);return o.hostname===""&&i===""?n==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!DW.test(n))return!1;if(MW.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW=new id(3e4,6e4);function pE(){const e=Gr().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}function jW(e){return new Promise((t,n)=>{var r,s,o;function i(){pE(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{pE(),n(Br(e,"network-request-failed"))},timeout:qW.get()})}if((s=(r=Gr().gapi)==null?void 0:r.iframes)!=null&&s.Iframe)t(gapi.iframes.getContext());else if((o=Gr().gapi)!=null&&o.load)i();else{const a=H7("iframefcb");return Gr()[a]=()=>{gapi.load?i():n(Br(e,"network-request-failed"))},B7(`${G7()}?onload=${a}`).catch(c=>n(c))}}).catch(t=>{throw Rg=null,t})}let Rg=null;function FW(e){return Rg=Rg||jW(e),Rg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW=new id(5e3,15e3),OW="__/auth/iframe",BW="emulator/auth/iframe",GW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $W(e){const t=e.config;Pt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Kw(t,BW):`https://${e.config.authDomain}/${OW}`,i={apiKey:t.apiKey,appName:e.name,v:Fo},r=HW.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${yl(i).slice(1)}`}async function zW(e){const t=await FW(e),n=Gr().gapi;return Pt(n,e,"internal-error"),t.open({where:document.body,url:$W(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GW,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Br(e,"network-request-failed"),a=Gr().setTimeout(()=>{s(o)},UW.get());function c(){Gr().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WW=500,QW=600,YW="_blank",XW="http://localhost";class vE{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function JW(e,t,n,i=WW,r=QW){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...KW,width:i.toString(),height:r.toString(),top:s,left:o},h=Fn().toLowerCase();n&&(a=SL(h)?YW:n),NL(h)&&(t=t||XW,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[v,y])=>`${f}${v}=${y},`,"");if(D7(h)&&a!=="_self")return ZW(t||"",a),new vE(null);const d=window.open(t||"",a,u);Pt(d,e,"popup-blocked");try{d.focus()}catch{}return new vE(d)}function ZW(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tQ="__/auth/handler",eQ="emulator/auth/handler",nQ=encodeURIComponent("fac");async function yE(e,t,n,i,r,s){Pt(e.config.authDomain,e,"auth-domain-config-required"),Pt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Fo,eventId:r};if(t instanceof qL){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",mx(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(t instanceof rd){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const c=await e._getAppCheckToken(),h=c?`#${nQ}=${encodeURIComponent(c)}`:"";return`${iQ(e)}?${yl(a).slice(1)}${h}`}function iQ({config:e}){return e.emulator?Kw(e,eQ):`https://${e.authDomain}/${tQ}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="webStorageSupport";class rQ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BL,this._completeRedirectFn=SW,this._overrideRedirectResult=kW}async _openPopup(t,n,i,r){var o;Is((o=this.eventManagers[t._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await yE(t,n,i,Yx(),r);return JW(t,s,Zw())}async _openRedirect(t,n,i,r){await this._originValidation(t);const s=await yE(t,n,i,Yx(),r);return aW(s),new Promise(()=>{})}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(Is(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(t){const n=await zW(t),i=new AW(t);return n.register("authEvent",r=>(Pt(r==null?void 0:r.authEvent,t,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=n,i}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(jv,{type:jv},r=>{var o;const s=(o=r==null?void 0:r[0])==null?void 0:o[jv];s!==void 0&&n(!!s),Ss(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=LW(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return ML()||EL()||Yw()}}const sQ=rQ;var xE="@firebase/auth",_E="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oQ{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)==null?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aQ(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cQ(e){Ki(new Ci("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Pt(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DL(e)},h=new U7(i,r,s,c);return z7(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,i)=>{t.getProvider("auth-internal").initialize()})),Ki(new Ci("auth-internal",t=>{const n=Xw(t.getProvider("auth").getImmediate());return(i=>new oQ(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qn(xE,_E,aQ(e)),qn(xE,_E,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lQ=5*60,hQ=sM("authIdTokenMaxAge")||lQ;let wE=null;const uQ=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>hQ)return;const r=n==null?void 0:n.token;wE!==r&&(wE=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function dQ(e=Rm()){const t=qa(e,"auth");if(t.isInitialized())return t.getImmediate();const n=$7(e,{popupRedirectResolver:sQ,persistence:[pW,rW,BL]}),i=sM("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=uQ(s.toString());eW(n,o,()=>o(n.currentUser)),tW(n,a=>o(a))}}const r=iM("auth");return r&&K7(n,`http://${r}`),n}function gQ(){var e;return((e=document.getElementsByTagName("head"))==null?void 0:e[0])??document}O7({loadJS(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=r=>{const s=Br("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",gQ().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cQ("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL="firebasestorage.googleapis.com",fQ="storageBucket",mQ=2*60*1e3,pQ=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Ji{constructor(t,n,i=0){super(Fv(t),`Firebase Storage: ${n} (${Fv(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zr.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Fv(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Yr;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Yr||(Yr={}));function Fv(e){return"storage/"+e}function vQ(){const e="An unknown error occurred, please check the error payload for server response.";return new Zr(Yr.UNKNOWN,e)}function yQ(){return new Zr(Yr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function xQ(){return new Zr(Yr.CANCELED,"User canceled the upload/download.")}function _Q(e){return new Zr(Yr.INVALID_URL,"Invalid URL '"+e+"'.")}function wQ(e){return new Zr(Yr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function bE(e){return new Zr(Yr.INVALID_ARGUMENT,e)}function YL(){return new Zr(Yr.APP_DELETED,"The Firebase app was deleted.")}function bQ(e){return new Zr(Yr.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=dr.makeFromUrl(t,n)}catch{return new dr(t,"")}if(i.path==="")return i;throw wQ(t)}static makeFromUrl(t,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",v=new RegExp(`^https?://${d}/${u}/b/${r}/o${f}`,"i"),y={bucket:1,path:3},w=n===QL?"(?:storage.googleapis.com|storage.cloud.google.com)":n,_="([^?#]*)",x=new RegExp(`^https?://${w}/${r}/${_}`,"i"),k=[{regex:a,indices:c,postModify:s},{regex:v,indices:y,postModify:h},{regex:x,indices:{bucket:1,path:2},postModify:h}];for(let P=0;P<k.length;P++){const A=k[P],M=A.regex.exec(t);if(M){const N=M[A.indices.bucket];let T=M[A.indices.path];T||(T=""),i=new dr(N,T),A.postModify(i);break}}if(i==null)throw _Q(t);return i}}class TQ{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CQ(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function u(..._){h||(h=!0,t.apply(null,_))}function d(_){r=setTimeout(()=>{r=null,e(v,c())},_)}function f(){s&&clearTimeout(s)}function v(_,...x){if(h){f();return}if(_){f(),u.call(null,_,...x);return}if(c()||o){f(),u.call(null,_,...x);return}i<64&&(i*=2);let k;a===1?(a=2,k=0):k=(i+Math.random())*1e3,d(k)}let y=!1;function w(_){y||(y=!0,f(),!h&&(r!==null?(_||(a=2),clearTimeout(r),d(0)):_||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,w(!0)},n),w}function kQ(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NQ(e){return e!==void 0}function TE(e,t,n,i){if(i<t)throw bE(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw bE(`Invalid value for '${e}'. Expected ${n} or less.`)}function EQ(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const r=t(i)+"="+t(e[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var $f;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})($f||($f={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SQ(e,t){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return n||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ{constructor(t,n,i,r,s,o,a,c,h,u,d,f=!0,v=!1){this.url_=t,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=u,this.connectionFactory_=d,this.retry=f,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,w)=>{this.resolve_=y,this.reject_=w,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new Yd(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===$f.NO_ERROR,c=s.getStatus();if(!a||SQ(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===$f.ABORT;i(!1,new Yd(!1,null,u));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Yd(h,s))})},n=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());NQ(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=vQ();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?YL():xQ();o(c)}else{const c=yQ();o(c)}};this.canceled_?n(!1,new Yd(!1,null,!0)):this.backoffId_=CQ(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&kQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Yd{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function AQ(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function RQ(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function PQ(e,t){t&&(e["X-Firebase-GMPID"]=t)}function MQ(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function DQ(e,t,n,i,r,s,o=!0,a=!1){const c=EQ(e.urlParams),h=e.url+c,u=Object.assign({},e.headers);return PQ(u,t),AQ(u,n),RQ(u,s),MQ(u,i),new IQ(h,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LQ(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function VQ(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(t,n){this._service=t,n instanceof dr?this._location=n:this._location=dr.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new zf(t,n)}get root(){const t=new dr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VQ(this._location.path)}get storage(){return this._service}get parent(){const t=LQ(this._location.path);if(t===null)return null;const n=new dr(this._location.bucket,t);return new zf(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw bQ(t)}}function CE(e,t){const n=t==null?void 0:t[fQ];return n==null?null:dr.makeFromBucketSpec(n,e)}function qQ(e,t,n,i={}){e.host=`${t}:${n}`;const r=Ds(t);r&&(Sm(`https://${e.host}/b`),Im("Storage",!0)),e._isUsingEmulator=!0,e._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:$_(s,e.app.options.projectId))}class jQ{constructor(t,n,i,r,s,o=!1){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=QL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=mQ,this._maxUploadRetryTime=pQ,this._requests=new Set,r!=null?this._bucket=dr.makeFromBucketSpec(r,this._host):this._bucket=CE(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=dr.makeFromBucketSpec(this._url,t):this._bucket=CE(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){TE("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){TE("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Mi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new zf(this,t)}_makeRequest(t,n,i,r,s=!0){if(this._deleted)return new TQ(YL());{const o=DQ(t,this._appId,i,r,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,r).getPromise()}}const kE="@firebase/storage",NE="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL="storage";function FQ(e=Rm(),t){e=Ke(e);const i=qa(e,XL).getImmediate({identifier:t}),r=G_("storage");return r&&UQ(i,...r),i}function UQ(e,t,n,i={}){qQ(e,t,n,i)}function OQ(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new jQ(n,i,r,t,Fo)}function BQ(){Ki(new Ci(XL,OQ,"PUBLIC").setMultipleInstances(!0)),qn(kE,NE,""),qn(kE,NE,"esm2020")}BQ();const JL="@firebase/installations",eb="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=1e4,tV=`w:${eb}`,eV="FIS_v2",GQ="https://firebaseinstallations.googleapis.com/v1",HQ=60*60*1e3,$Q="installations",zQ="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KQ={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Aa=new Va($Q,zQ,KQ);function nV(e){return e instanceof Ji&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV({projectId:e}){return`${GQ}/projects/${e}/installations`}function rV(e){return{token:e.token,requestStatus:2,expiresIn:QQ(e.expiresIn),creationTime:Date.now()}}async function sV(e,t){const i=(await t.json()).error;return Aa.create("request-failed",{requestName:e,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function oV({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function WQ(e,{refreshToken:t}){const n=oV(e);return n.append("Authorization",YQ(t)),n}async function aV(e){const t=await e();return t.status>=500&&t.status<600?e():t}function QQ(e){return Number(e.replace("s","000"))}function YQ(e){return`${eV} ${e}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XQ({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=iV(e),r=oV(e),s=t.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={fid:n,authVersion:eV,appId:e.appId,sdkVersion:tV},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await aV(()=>fetch(i,a));if(c.ok){const h=await c.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:rV(h.authToken)}}else throw await sV("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cV(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JQ(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZQ=/^[cdef][\w-]{21}$/,Zx="";function tY(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const n=eY(e);return ZQ.test(n)?n:Zx}catch{return Zx}}function eY(e){return JQ(e).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lV=new Map;function hV(e,t){const n=lp(e);uV(n,t),nY(n,t)}function uV(e,t){const n=lV.get(e);if(n)for(const i of n)i(t)}function nY(e,t){const n=iY();n&&n.postMessage({key:e,fid:t}),rY()}let ca=null;function iY(){return!ca&&"BroadcastChannel"in self&&(ca=new BroadcastChannel("[Firebase] FID Change"),ca.onmessage=e=>{uV(e.data.key,e.data.fid)}),ca}function rY(){lV.size===0&&ca&&(ca.close(),ca=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sY="firebase-installations-database",oY=1,Ra="firebase-installations-store";let Uv=null;function nb(){return Uv||(Uv=gM(sY,oY,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Ra)}}})),Uv}async function Kf(e,t){const n=lp(e),r=(await nb()).transaction(Ra,"readwrite"),s=r.objectStore(Ra),o=await s.get(n);return await s.put(t,n),await r.done,(!o||o.fid!==t.fid)&&hV(e,t.fid),t}async function dV(e){const t=lp(e),i=(await nb()).transaction(Ra,"readwrite");await i.objectStore(Ra).delete(t),await i.done}async function hp(e,t){const n=lp(e),r=(await nb()).transaction(Ra,"readwrite"),s=r.objectStore(Ra),o=await s.get(n),a=t(o);return a===void 0?await s.delete(n):await s.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&hV(e,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ib(e){let t;const n=await hp(e.appConfig,i=>{const r=aY(i),s=cY(e,r);return t=s.registrationPromise,s.installationEntry});return n.fid===Zx?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function aY(e){const t=e||{fid:tY(),registrationStatus:0};return gV(t)}function cY(e,t){if(t.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Aa.create("app-offline"));return{installationEntry:t,registrationPromise:r}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=lY(e,n);return{installationEntry:n,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:hY(e)}:{installationEntry:t}}async function lY(e,t){try{const n=await XQ(e,t);return Kf(e.appConfig,n)}catch(n){throw nV(n)&&n.customData.serverCode===409?await dV(e.appConfig):await Kf(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function hY(e){let t=await EE(e.appConfig);for(;t.registrationStatus===1;)await cV(100),t=await EE(e.appConfig);if(t.registrationStatus===0){const{installationEntry:n,registrationPromise:i}=await ib(e);return i||n}return t}function EE(e){return hp(e,t=>{if(!t)throw Aa.create("installation-not-found");return gV(t)})}function gV(e){return uY(e)?{fid:e.fid,registrationStatus:0}:e}function uY(e){return e.registrationStatus===1&&e.registrationTime+ZL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dY({appConfig:e,heartbeatServiceProvider:t},n){const i=gY(e,n),r=WQ(e,n),s=t.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={installation:{sdkVersion:tV,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await aV(()=>fetch(i,a));if(c.ok){const h=await c.json();return rV(h)}else throw await sV("Generate Auth Token",c)}function gY(e,{fid:t}){return`${iV(e)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rb(e,t=!1){let n;const i=await hp(e.appConfig,s=>{if(!fV(s))throw Aa.create("not-registered");const o=s.authToken;if(!t&&pY(o))return s;if(o.requestStatus===1)return n=fY(e,t),s;{if(!navigator.onLine)throw Aa.create("app-offline");const a=yY(s);return n=mY(e,a),a}});return n?await n:i.authToken}async function fY(e,t){let n=await SE(e.appConfig);for(;n.authToken.requestStatus===1;)await cV(100),n=await SE(e.appConfig);const i=n.authToken;return i.requestStatus===0?rb(e,t):i}function SE(e){return hp(e,t=>{if(!fV(t))throw Aa.create("not-registered");const n=t.authToken;return xY(n)?{...t,authToken:{requestStatus:0}}:t})}async function mY(e,t){try{const n=await dY(e,t),i={...t,authToken:n};return await Kf(e.appConfig,i),n}catch(n){if(nV(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await dV(e.appConfig);else{const i={...t,authToken:{requestStatus:0}};await Kf(e.appConfig,i)}throw n}}function fV(e){return e!==void 0&&e.registrationStatus===2}function pY(e){return e.requestStatus===2&&!vY(e)}function vY(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+HQ}function yY(e){const t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}function xY(e){return e.requestStatus===1&&e.requestTime+ZL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _Y(e){const t=e,{installationEntry:n,registrationPromise:i}=await ib(t);return i?i.catch(console.error):rb(t).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wY(e,t=!1){const n=e;return await bY(n),(await rb(n,t)).token}async function bY(e){const{registrationPromise:t}=await ib(e);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TY(e){if(!e||!e.options)throw Ov("App Configuration");if(!e.name)throw Ov("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Ov(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function Ov(e){return Aa.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV="installations",CY="installations-internal",kY=e=>{const t=e.getProvider("app").getImmediate(),n=TY(t),i=qa(t,"heartbeat");return{app:t,appConfig:n,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},NY=e=>{const t=e.getProvider("app").getImmediate(),n=qa(t,mV).getImmediate();return{getId:()=>_Y(n),getToken:r=>wY(n,r)}};function EY(){Ki(new Ci(mV,kY,"PUBLIC")),Ki(new Ci(CY,NY,"PRIVATE"))}EY();qn(JL,eb);qn(JL,eb,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="analytics",SY="firebase_id",IY="origin",AY=60*1e3,RY="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",sb="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new Gu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PY={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Oi=new Va("analytics","Analytics",PY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MY(e){if(!e.startsWith(sb)){const t=Oi.create("invalid-gtag-resource",{gtagURL:e});return Kn.warn(t.message),""}return e}function pV(e){return Promise.all(e.map(t=>t.catch(n=>n)))}function DY(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function LY(e,t){const n=DY("firebase-js-sdk-policy",{createScriptURL:MY}),i=document.createElement("script"),r=`${sb}?l=${e}&id=${t}`;i.src=n?n==null?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function VY(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function qY(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const c=(await pV(n)).find(h=>h.measurementId===r);c&&await t[c.appId]}}catch(a){Kn.error(a)}e("config",r,s)}async function jY(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await pV(n);for(const c of o){const h=a.find(d=>d.measurementId===c),u=h&&t[h.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(s){Kn.error(s)}}function FY(e,t,n,i){async function r(s,...o){try{if(s==="event"){const[a,c]=o;await jY(e,t,n,a,c)}else if(s==="config"){const[a,c]=o;await qY(e,t,n,i,a,c)}else if(s==="consent"){const[a,c]=o;e("consent",a,c)}else if(s==="get"){const[a,c,h]=o;e("get",a,c,h)}else if(s==="set"){const[a]=o;e("set",a)}else e(s,...o)}catch(a){Kn.error(a)}}return r}function UY(e,t,n,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=FY(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}function OY(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(sb)&&n.src.includes(e))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BY=30,GY=1e3;class HY{constructor(t={},n=GY){this.throttleMetadata=t,this.intervalMillis=n}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,n){this.throttleMetadata[t]=n}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const vV=new HY;function $Y(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function zY(e){var o;const{appId:t,apiKey:n}=e,i={method:"GET",headers:$Y(n)},r=RY.replace("{app-id}",t),s=await fetch(r,i);if(s.status!==200&&s.status!==304){let a="";try{const c=await s.json();(o=c.error)!=null&&o.message&&(a=c.error.message)}catch{}throw Oi.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function KY(e,t=vV,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw Oi.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Oi.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new YY;return setTimeout(async()=>{a.abort()},AY),yV({appId:i,apiKey:r,measurementId:s},o,a,t)}async function yV(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=vV){var a;const{appId:s,measurementId:o}=e;try{await WY(i,t)}catch(c){if(o)return Kn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:s,measurementId:o};throw c}try{const c=await zY(e);return r.deleteThrottleMetadata(s),c}catch(c){const h=c;if(!QY(h)){if(r.deleteThrottleMetadata(s),o)return Kn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:s,measurementId:o};throw c}const u=Number((a=h==null?void 0:h.customData)==null?void 0:a.httpStatus)===503?pk(n,r.intervalMillis,BY):pk(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(s,d),Kn.debug(`Calling attemptFetch again in ${u} millis`),yV(e,d,i,r)}}function WY(e,t){return new Promise((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener(()=>{clearTimeout(s),i(Oi.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function QY(e){if(!(e instanceof Ji)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}class YY{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function XY(e,t,n,i,r){if(r&&r.global){e("event",n,i);return}else{const s=await t,o={...i,send_to:s};e("event",n,o)}}async function JY(e,t,n,i){if(i&&i.global){const r={};for(const s of Object.keys(n))r[`user_properties.${s}`]=n[s];return e("set",r),Promise.resolve()}else{const r=await t;e("config",r,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZY(){if(cM())try{await lM()}catch(e){return Kn.warn(Oi.create("indexeddb-unavailable",{errorInfo:e==null?void 0:e.toString()}).message),!1}else return Kn.warn(Oi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function tX(e,t,n,i,r,s,o){const a=KY(e);a.then(f=>{n[f.measurementId]=f.appId,e.options.measurementId&&f.measurementId!==e.options.measurementId&&Kn.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Kn.error(f)),t.push(a);const c=ZY().then(f=>{if(f)return i.getId()}),[h,u]=await Promise.all([a,c]);OY(s)||LY(s,h.measurementId),r("js",new Date);const d=(o==null?void 0:o.config)??{};return d[IY]="firebase",d.update=!0,u!=null&&(d[SY]=u),r("config",h.measurementId,d),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eX{constructor(t){this.app=t}_delete(){return delete Fc[this.app.options.appId],Promise.resolve()}}let Fc={},AE=[];const RE={};let Bv="dataLayer",nX="gtag",PE,ob,ME=!1;function iX(){const e=[];if(oM()&&e.push("This is a browser extension environment."),GG()||e.push("Cookies are not available."),e.length>0){const t=e.map((i,r)=>`(${r+1}) ${i}`).join(" "),n=Oi.create("invalid-analytics-context",{errorInfo:t});Kn.warn(n.message)}}function rX(e,t,n){iX();const i=e.options.appId;if(!i)throw Oi.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)Kn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Oi.create("no-api-key");if(Fc[i]!=null)throw Oi.create("already-exists",{id:i});if(!ME){VY(Bv);const{wrappedGtag:s,gtagCore:o}=UY(Fc,AE,RE,Bv,nX);ob=s,PE=o,ME=!0}return Fc[i]=tX(e,AE,RE,t,PE,Bv,n),new eX(e)}function sX(e,t,n){e=Ke(e),JY(ob,Fc[e.app.options.appId],t,n).catch(i=>Kn.error(i))}function oX(e,t,n,i){e=Ke(e),XY(ob,Fc[e.app.options.appId],t,n,i).catch(r=>Kn.error(r))}const DE="@firebase/analytics",LE="0.10.19";function aX(){Ki(new Ci(IE,(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();return rX(i,r,n)},"PUBLIC")),Ki(new Ci("analytics-internal",e,"PRIVATE")),qn(DE,LE),qn(DE,LE,"esm2020");function e(t){try{const n=t.getProvider(IE).getImmediate();return{logEvent:(i,r,s)=>oX(n,i,r,s),setUserProperties:(i,r)=>sX(n,i,r)}}catch(n){throw Oi.create("interop-component-reg-failed",{reason:n})}}}aX();const cX={apiKey:"AIzaSyDgAQpq-gbHeYVJen_cMMgepsxf0TzUopI",authDomain:"quiz-cd4c1.firebaseapp.com",projectId:"quiz-cd4c1",storageBucket:"quiz-cd4c1.firebasestorage.app",messagingSenderId:"252346768980",appId:"1:252346768980:web:16f1f4b9d365d6e1ad57c1",measurementId:"G-8JDJSZR9X9",databaseURL:"https://quiz-cd4c1-default-rtdb.asia-southeast1.firebasedatabase.app"},up=fM(cX),kt=$2(up);g7(up);dQ(up);FQ(up);const lX=Object.freeze(Object.defineProperty({__proto__:null,db:kt},Symbol.toStringTag,{value:"Module"})),hX=()=>{const e="quiz_user_id";let t=localStorage.getItem(e);return t||(t="web_user_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),localStorage.setItem(e,t)),t},uX=()=>localStorage.getItem("quiz_user_name")||"Ngi chi",xV=()=>{const e=new Date,t=e.getDay(),n=e.getDate()-t+(t===0?-6:1);return new Date(e.setDate(n)).toDateString()},VE=e=>e<=1?0:100*e*(e-1)/2,_V=e=>{const t=Math.floor((1+Math.sqrt(1+8*e/100))/2);return Math.max(1,t)},dX=e=>{const t=_V(e),n=VE(t),i=VE(t+1);return{current:e-n,required:i-n}},Nn={dailyCorrect:0,dailyQuizzes:0,dailyDate:new Date().toDateString(),weeklyXP:0,weeklyPerfect:0,weeklyStartDate:xV(),claimedDailyQuests:[],claimedWeeklyQuests:[],dailyConquests:0,weeklyConquests:0,weeklyConquestWins:0,dailyGachaPulls:0,weeklyGachaPulls:0,dailyTowerFloors:0,weeklyTowerFloors:0,dailyAvatarChanged:0,dailyFrameChanged:0,dailyBadgeChanged:0,dailyCardViewed:0,weeklyCardViewed:0},qE={totalScore:0,totalCorrect:0,totalWrong:0,totalQuizzes:0,streak:0,lastPlayDate:"",level:1,exp:0,badges:[],chapterProgress:{},hearts:5,maxHearts:5,lastHeartRefill:"",gems:300,dailyGoal:50,dailyProgress:0,achievements:[],totalPlayTime:0,perfectLessons:0,longestStreak:0,conquestStats:{rankPoints:0,highestRankId:"wood_1",totalConquests:0,totalConquestCorrect:0,totalConquestWrong:0,bestWinStreak:0,currentWinStreak:0,lastConquestDate:""},questProgress:Nn,claimedAchievementRewards:[],claimedMails:[],usedRedeemCodes:[],gachaInventory:{cards:{},rewards:[],shards:0,totalPulls:0,pityCounters:{},gachaStats:{totalNCards:0,totalRCards:0,totalSRCards:0,totalURCards:0,totalAvatars:0,totalFrames:0,totalBadges:0,completedCollections:0}}},Zt=Bu((e,t)=>({user:null,isLoading:!1,error:null,updateUsername:async n=>{const{user:i}=t();if(!i||!n.trim())return!1;const r=n.trim();if(r.length<2||r.length>20)return!1;try{const s=Mt(kt,"users",i.oderId);return await Gt(s,{odername:r}),e({user:{...i,odername:r}}),!0}catch(s){return console.error("Error updating username:",s),!1}},initUser:async()=>{e({isLoading:!0,error:null});try{const n=hX(),i=uX(),r=Mt(kt,"users",n),s=await Qr(r);if(s.exists()){const o=s.data(),a=Date.now(),c=o.lastHeartRefill?new Date(o.lastHeartRefill).getTime():0,h=(a-c)/(1e3*60*30),u=Math.min(Math.floor(h),o.maxHearts-o.hearts);u>0&&(o.hearts=Math.min(o.hearts+u,o.maxHearts),o.lastHeartRefill=new Date().toISOString(),await Gt(r,{hearts:o.hearts,lastHeartRefill:o.lastHeartRefill}));const d=new Date().toDateString();(o.lastPlayDate?new Date(o.lastPlayDate).toDateString():"")!==d&&(o.dailyProgress=0),e({user:o,isLoading:!1})}else{const o={oderId:n,odername:i,avatar:"",...qE};await Cw(r,o),e({user:o,isLoading:!1})}}catch(n){console.error("Error init user:",n);const i={oderId:"dev_user_"+Date.now(),odername:"Dev User",avatar:"",...qE};e({user:i,isLoading:!1})}},updateStats:async(n,i,r)=>{const{user:s,checkAchievements:o,getXPMultiplier:a}=t();if(!s)return;const c=a(),u=(n?10:2)*c,d={totalScore:s.totalScore+r,totalCorrect:s.totalCorrect+(n?1:0),totalWrong:s.totalWrong+(n?0:1),exp:s.exp+u,gems:s.gems+(n?15:0)},f=_V(d.exp);try{const v=Mt(kt,"users",s.oderId);await Gt(v,{...d,level:f}),e({user:{...s,...d,level:f}}),await o()}catch(v){console.error("Error updating stats:",v),e({user:{...s,...d,level:f}})}},loseHeart:async()=>{const{user:n,hasUnlimitedHearts:i}=t();if(!n)return!1;if(i())return!0;if(n.hearts<=0)return!1;const r=n.hearts-1;try{const s=Mt(kt,"users",n.oderId);return await Gt(s,{hearts:r}),e({user:{...n,hearts:r}}),r>0}catch{return e({user:{...n,hearts:r}}),r>0}},refillHearts:async()=>{const{user:n}=t();if(n)try{const i=Mt(kt,"users",n.oderId);await Gt(i,{hearts:n.maxHearts,lastHeartRefill:new Date().toISOString()}),e({user:{...n,hearts:n.maxHearts,lastHeartRefill:new Date().toISOString()}})}catch{e({user:{...n,hearts:n.maxHearts}})}},addGems:async n=>{const{user:i}=t();if(!i)return;const r=i.gems+n;try{const s=Mt(kt,"users",i.oderId);await Gt(s,{gems:r}),e({user:{...i,gems:r}})}catch{e({user:{...i,gems:r}})}},spendGems:async n=>{const{user:i}=t();if(!i||i.gems<n)return!1;const r=i.gems-n;try{const s=Mt(kt,"users",i.oderId);return await Gt(s,{gems:r}),e({user:{...i,gems:r}}),!0}catch{return e({user:{...i,gems:r}}),!0}},updateDailyProgress:async n=>{const{user:i}=t();if(!i)return;const r=i.dailyProgress+n;try{const s=Mt(kt,"users",i.oderId);await Gt(s,{dailyProgress:r}),e({user:{...i,dailyProgress:r}})}catch{e({user:{...i,dailyProgress:r}})}},addPerfectLesson:async()=>{const{user:n,checkAchievements:i}=t();if(!n)return;const r=n.perfectLessons+1,s=150;try{const o=Mt(kt,"users",n.oderId);await Gt(o,{perfectLessons:r,gems:n.gems+s}),e({user:{...n,perfectLessons:r,gems:n.gems+s}}),await i()}catch{e({user:{...n,perfectLessons:r,gems:n.gems+s}})}},updateChapterProgress:async(n,i)=>{const{user:r}=t();if(!r)return;const o={...r.chapterProgress[n]||{completed:0,correct:0,bestScore:0,lastAttempt:"",stars:0,locked:!1},...i},a={...r.chapterProgress,[n]:o};try{const c=Mt(kt,"users",r.oderId);await Gt(c,{chapterProgress:a}),e({user:{...r,chapterProgress:a}})}catch{e({user:{...r,chapterProgress:a}})}},addBadge:async n=>{const{user:i}=t();if(!i||i.badges.includes(n))return;const r=[...i.badges,n];try{const s=Mt(kt,"users",i.oderId);await Gt(s,{badges:r}),e({user:{...i,badges:r}})}catch{e({user:{...i,badges:r}})}},updateStreak:async()=>{const{user:n,checkAchievements:i}=t();if(!n)return;const r=new Date().toDateString(),s=n.lastPlayDate?new Date(n.lastPlayDate).toDateString():"",o=new Date(Date.now()-864e5).toDateString(),a=n.lastPlayDate?new Date(n.lastPlayDate).getTime():0,c=new Date(r).getTime(),h=a?Math.floor((c-a)/864e5)-1:0;let u=n.streak,d=0;const f=n.streakFreezes||0;if(s===r)return;s===o?u+=1:h>0&&f>=h?(d=h,u+=1):h>0&&f>0?(d=f,u=1):s!==r&&(u=1);const v=f-d,y=Math.max(n.longestStreak,u),w=u%7===0?300:0;try{const _=Mt(kt,"users",n.oderId);await Gt(_,{streak:u,lastPlayDate:r,longestStreak:y,gems:n.gems+w,streakFreezes:v,lastStreakFreezeUsed:d>0?d:null}),e({user:{...t().user,streak:u,lastPlayDate:r,longestStreak:y,gems:t().user.gems+w,streakFreezes:v,lastStreakFreezeUsed:d>0?d:void 0}}),await i(),d>0&&console.log(` s dng ${d} Streak Freeze t ng!`)}catch{e({user:{...n,streak:u,lastPlayDate:r,longestStreak:y,streakFreezes:v}})}},checkAchievements:async()=>{var s,o,a,c,h;const{user:n}=t();if(!n)return[];const{ACHIEVEMENTS:i}=await df(async()=>{const{ACHIEVEMENTS:u}=await Promise.resolve().then(()=>mX);return{ACHIEVEMENTS:u}},[]),r=[];for(const u of i){if(n.achievements.includes(u.id))continue;let d=!1;const f=(s=n.gachaInventory)==null?void 0:s.gachaStats,v=((f==null?void 0:f.totalURCards)??0)+((f==null?void 0:f.totalSRCards)??0)+((f==null?void 0:f.totalRCards)??0)+((f==null?void 0:f.totalNCards)??0);switch(u.type){case"streak":d=n.streak>=u.requirement;break;case"correct":d=n.totalCorrect>=u.requirement;break;case"perfect":d=(n.perfectLessons??0)>=u.requirement;break;case"level":d=(n.level??1)>=u.requirement;break;case"conquest":d=(((o=n.conquestStats)==null?void 0:o.totalConquests)??0)>=u.requirement;break;case"conquest_wins":d=(((a=n.conquestStats)==null?void 0:a.bestWinStreak)??0)>=u.requirement;break;case"rank_points":d=(((c=n.conquestStats)==null?void 0:c.rankPoints)??0)>=u.requirement;break;case"gems":d=n.gems>=u.requirement;break;case"gacha_pulls":d=(((h=n.gachaInventory)==null?void 0:h.totalPulls)??0)>=u.requirement;break;case"gacha_ur":d=((f==null?void 0:f.totalURCards)??0)>=u.requirement;break;case"gacha_sr":d=((f==null?void 0:f.totalSRCards)??0)>=u.requirement;break;case"gacha_total_cards":d=v>=u.requirement;break;case"gacha_collections":d=((f==null?void 0:f.completedCollections)??0)>=u.requirement;break;case"quizzes":d=(n.totalQuizzes??0)>=u.requirement;break}if(d){r.push(u.id);const y=[...n.achievements,u.id];try{const w=Mt(kt,"users",n.oderId);await Gt(w,{achievements:y,gems:n.gems+50}),e({user:{...n,achievements:y,gems:n.gems+50}})}catch{e({user:{...n,achievements:y}})}}}return r},updateQuestProgress:async n=>{const{user:i}=t();if(!i)return;const r=i.questProgress||Nn,s=new Date().toDateString(),o=xV();let a={...r};r.dailyDate!==s&&(a={...a,dailyCorrect:0,dailyQuizzes:0,dailyDate:s,claimedDailyQuests:[]}),r.weeklyStartDate!==o&&(a={...a,weeklyXP:0,weeklyPerfect:0,weeklyStartDate:o,claimedWeeklyQuests:[]}),a={...a,...n};try{const c=Mt(kt,"users",i.oderId);await Gt(c,{questProgress:a}),e({user:{...i,questProgress:a}})}catch(c){console.error("Error updating quest progress:",c),e({user:{...i,questProgress:a}})}},claimDailyQuest:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const o=[...(i.questProgress||Nn).claimedDailyQuests,n];await r({claimedDailyQuests:o})},claimWeeklyQuest:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const o=[...(i.questProgress||Nn).claimedWeeklyQuests,n];await r({claimedWeeklyQuests:o})},incrementDailyCorrect:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyCorrect:r.dailyCorrect+1})},incrementDailyQuizzes:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyQuizzes:r.dailyQuizzes+1})},incrementWeeklyXP:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const s=i.questProgress||Nn;await r({weeklyXP:s.weeklyXP+n})},incrementWeeklyPerfect:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({weeklyPerfect:r.weeklyPerfect+1})},incrementDailyConquests:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyConquests:(r.dailyConquests||0)+1,weeklyConquests:(r.weeklyConquests||0)+1})},incrementWeeklyConquestWins:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({weeklyConquestWins:(r.weeklyConquestWins||0)+1})},incrementDailyGachaPulls:async(n=1)=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const s=i.questProgress||Nn;await r({dailyGachaPulls:(s.dailyGachaPulls||0)+n,weeklyGachaPulls:(s.weeklyGachaPulls||0)+n})},incrementDailyTowerFloors:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyTowerFloors:(r.dailyTowerFloors||0)+1,weeklyTowerFloors:(r.weeklyTowerFloors||0)+1})},incrementDailyAvatarChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyAvatarChanged:(r.dailyAvatarChanged||0)+1})},incrementDailyFrameChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyFrameChanged:(r.dailyFrameChanged||0)+1})},incrementDailyBadgeChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyBadgeChanged:(r.dailyBadgeChanged||0)+1})},incrementDailyCardViewed:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Nn;await i({dailyCardViewed:(r.dailyCardViewed||0)+1,weeklyCardViewed:(r.weeklyCardViewed||0)+1})},claimAchievementReward:async n=>{const i=t().user;if(!i)return;const r=i.claimedAchievementRewards||[];if(r.includes(n))return;const s=[...r,n];try{const o=Mt(kt,"users",i.oderId);await Gt(o,{claimedAchievementRewards:s});const a=t().user;a&&e({user:{...a,claimedAchievementRewards:s}})}catch(o){console.error("Error claiming achievement reward:",o);const a=t().user;a&&e({user:{...a,claimedAchievementRewards:s}})}},claimMail:async n=>{const{user:i}=t();if(!i)return;const r=i.claimedMails||[];if(r.includes(n))return;const s=[...r,n];try{const o=Mt(kt,"users",i.oderId);await Gt(o,{claimedMails:s}),e({user:{...i,claimedMails:s}})}catch(o){console.error("Error claiming mail:",o),e({user:{...i,claimedMails:s}})}},deleteMail:async n=>{const{user:i}=t();if(!i)return;const r=i.deletedMails||[];if(r.includes(n))return;const s=[...r,n];try{const o=Mt(kt,"users",i.oderId);await Gt(o,{deletedMails:s}),e({user:{...i,deletedMails:s}})}catch(o){console.error("Error deleting mail:",o),e({user:{...i,deletedMails:s}})}},useRedeemCode:async n=>{const{user:i}=t();if(!i)return;const r=i.usedRedeemCodes||[];if(r.includes(n))return;const s=[...r,n];try{const o=Mt(kt,"users",i.oderId);await Gt(o,{usedRedeemCodes:s}),e({user:{...i,usedRedeemCodes:s}})}catch(o){console.error("Error using redeem code:",o),e({user:{...i,usedRedeemCodes:s}})}},buyUnlimitedHearts:async()=>{const{user:n,spendGems:i}=t();if(!n)return!1;const r=3e3,s=24*60*60*1e3;if(n.gems<r||!await i(r))return!1;const a=new Date(Date.now()+s).toISOString();try{const c=Mt(kt,"users",n.oderId);return await Gt(c,{unlimitedHeartsUntil:a}),e({user:{...t().user,unlimitedHeartsUntil:a}}),!0}catch(c){return console.error("Error buying unlimited hearts:",c),!1}},hasUnlimitedHearts:()=>{const{user:n}=t();if(!(n!=null&&n.unlimitedHeartsUntil))return!1;const i=new Date(n.unlimitedHeartsUntil).getTime();return Date.now()<i},getUnlimitedHeartsTimeLeft:()=>{const{user:n}=t();if(!(n!=null&&n.unlimitedHeartsUntil))return null;const r=new Date(n.unlimitedHeartsUntil).getTime()-Date.now();if(r<=0)return null;const s=Math.floor(r/(60*60*1e3)),o=Math.floor(r%(60*60*1e3)/6e4);return`${s}h ${o}m`},equipAvatar:async n=>{const{user:i}=t();if(i)try{const r=Mt(kt,"users",i.oderId);await Gt(r,{equippedAvatar:n||null}),e({user:{...i,equippedAvatar:n||void 0}})}catch(r){console.error("Error equipping avatar:",r),e({user:{...i,equippedAvatar:n||void 0}})}},equipFrame:async n=>{const{user:i}=t();if(i)try{const r=Mt(kt,"users",i.oderId);await Gt(r,{equippedFrame:n||null}),e({user:{...i,equippedFrame:n||void 0}})}catch(r){console.error("Error equipping frame:",r),e({user:{...i,equippedFrame:n||void 0}})}},equipBadge:async n=>{const{user:i}=t();if(i)try{const r=Mt(kt,"users",i.oderId);await Gt(r,{equippedBadge:n||null}),e({user:{...i,equippedBadge:n||void 0}})}catch(r){console.error("Error equipping badge:",r),e({user:{...i,equippedBadge:n||void 0}})}},buyXPBoost:async n=>{const{user:i,spendGems:r}=t();if(!i)return!1;const o={1:500,3:1200,8:2500}[n];if(!o||i.gems<o||!await r(o))return!1;const c=i.xpBoostUntil?new Date(i.xpBoostUntil).getTime():Date.now(),h=c>Date.now()?c:Date.now(),u=new Date(h+n*60*60*1e3).toISOString();try{const d=Mt(kt,"users",i.oderId);return await Gt(d,{xpBoostUntil:u,xpBoostMultiplier:2}),e({user:{...t().user,xpBoostUntil:u,xpBoostMultiplier:2}}),!0}catch(d){return console.error("Error buying XP boost:",d),!1}},hasXPBoost:()=>{const{user:n}=t();return n!=null&&n.xpBoostUntil?Date.now()<new Date(n.xpBoostUntil).getTime():!1},getXPBoostTimeLeft:()=>{const{user:n}=t();if(!(n!=null&&n.xpBoostUntil))return null;const r=new Date(n.xpBoostUntil).getTime()-Date.now();if(r<=0)return null;const s=Math.floor(r/(60*60*1e3)),o=Math.floor(r%(60*60*1e3)/6e4);return`${s}h ${o}m`},getXPMultiplier:()=>{const{hasXPBoost:n,user:i}=t();return n()?(i==null?void 0:i.xpBoostMultiplier)||2:1},buyStreakFreeze:async()=>{const{user:n,spendGems:i}=t();if(!n)return!1;const r=1e3,s=5,o=n.streakFreezes||0;if(o>=s||n.gems<r||!await i(r))return!1;const c=o+1;try{const h=Mt(kt,"users",n.oderId);return await Gt(h,{streakFreezes:c}),e({user:{...t().user,streakFreezes:c}}),!0}catch(h){return console.error("Error buying streak freeze:",h),!1}},useStreakFreeze:async()=>{const{user:n}=t();if(!n)return!1;const i=n.streakFreezes||0;if(i<=0)return!1;const r=i-1;try{const s=Mt(kt,"users",n.oderId);return await Gt(s,{streakFreezes:r}),e({user:{...n,streakFreezes:r}}),!0}catch(s){return console.error("Error using streak freeze:",s),!1}},getStreakFreezeCount:()=>{const{user:n}=t();return(n==null?void 0:n.streakFreezes)||0}}));function t0({isOpen:e,onClose:t,title:n,children:i,showCloseButton:r=!0}){return e?l.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),l.jsxs("div",{className:"relative bg-[var(--card)] rounded-3xl p-6 mx-4 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",children:[r&&l.jsx("button",{onClick:t,className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--muted-foreground)]"})}),n&&l.jsx("h2",{className:"font-bold text-xl text-foreground text-center mb-4",children:n}),i]})]}):null}function wV({isOpen:e,onClose:t,onBuyHearts:n,onGoToShop:i,userGems:r,heartCost:s}){const[o,a]=I.useState(!1),c=r>=s,h=()=>{c?n():a(!0)},u=()=>{a(!1),t()};return o?l.jsx(t0,{isOpen:e,onClose:u,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-12 h-12 grayscale opacity-50"})}),l.jsx("h2",{className:"font-bold text-xl text-foreground mb-2",children:"Khng  Gems!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-4",children:"Bn cn thm gems  mua tim."}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Cn"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-foreground",children:s})]})]}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Hin c"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:r})]})]}),l.jsx("div",{className:"border-t border-[var(--border)] pt-2",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-[var(--duo-red)]",children:"Thiu"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:s-r})]})]})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>{a(!1),i()},className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #1cb0f6 0%, #1899d6 100%)",boxShadow:"0 4px 0 #1682c4"},children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{children:"Kim thm Gems"})]}),l.jsx("button",{onClick:()=>a(!1),className:"w-full py-3 px-4 rounded-xl font-bold text-[var(--muted-foreground)] bg-[var(--secondary)]",children:"Quay li"})]})]})}):l.jsx(t0,{isOpen:e,onClose:u,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-12 h-12 grayscale opacity-50"})}),l.jsx("h2",{className:"font-bold text-xl text-foreground mb-2",children:"Ht tim ri!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-4",children:"Bn cn tim  tip tc chi. Hy ch hi phc hoc dng gems  mua thm."}),l.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Gems hin c:"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:r})]})]}),l.jsx("div",{className:"bg-[var(--duo-blue)]/10 rounded-xl p-3 mb-4",children:l.jsxs("p",{className:"text-xs text-[var(--duo-blue)] font-semibold",children:["Vo ",l.jsx("span",{className:"font-bold",children:"Luyn tp"})," hoc"," ",l.jsx("span",{className:"font-bold",children:"Chinh chin"}),"  cy gems m hi tim nh!"]})}),l.jsxs("div",{className:"space-y-3",children:[c&&l.jsxs("button",{onClick:h,className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #58cc02 0%, #46a302 100%)",boxShadow:"0 4px 0 #3d8c02"},children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-5 h-5"}),l.jsx("span",{children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center gap-1 ml-2 bg-white/20 px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{children:s})]})]}),!c&&l.jsxs("button",{onClick:i,className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #1cb0f6 0%, #1899d6 100%)",boxShadow:"0 4px 0 #1682c4"},children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{children:"Kim thm Gems"})]}),l.jsx("button",{onClick:u,className:"w-full py-3 px-4 rounded-xl font-bold text-[var(--muted-foreground)] bg-[var(--secondary)]",children:"Ch hi phc"})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-4",children:"Tim t hi phc mi 30 pht"})]})})}function Gn({isOpen:e,onClose:t,title:n="Nhn qu thnh cng!",subtitle:i,rewards:r,buttonText:s="Tuyt vi!",gradientFrom:o="var(--duo-green)",gradientTo:a="var(--duo-blue)"}){if(!e)return null;const c=u=>{if(u.icon)return u.icon;switch(u.type){case"gems":return"/AppAssets/BlueDiamond.png";case"xp":case"exp":return"/AppAssets/Lighting.png";case"hearts":return"/AppAssets/Heart.png";case"shard":return"/AppAssets/Shard.png";default:return"/AppAssets/BlueDiamond.png"}},h=u=>{if(u.label)return u.label;switch(u.type){case"gems":return"Gems";case"xp":case"exp":return"XP";case"hearts":return"Tim";case"shard":return"Mnh";default:return""}};return l.jsx(t0,{isOpen:e,onClose:t,showCloseButton:!1,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:`linear-gradient(135deg, ${o}, ${a})`},children:l.jsx(Ue,{className:"w-10 h-10 text-white"})}),l.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:o},children:n}),i&&l.jsx("p",{className:"text-[var(--muted-foreground)] mb-4",children:i}),l.jsx("div",{className:"bg-[var(--secondary)] rounded-2xl p-4 mb-4 space-y-3",children:r.map((u,d)=>l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("img",{src:c(u),alt:u.type,className:"w-10 h-10"}),l.jsxs("span",{className:"text-3xl font-bold text-[var(--duo-blue)]",children:["+",u.amount]}),h(u)&&l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:h(u)})]},d))}),l.jsx("button",{onClick:t,className:"btn-3d btn-3d-green w-full py-3",children:s})]})})}function gX(){const e=we(),{loadQuiz:t,chapters:n}=ds(),{initUser:i,user:r,spendGems:s,refillHearts:o,hasUnlimitedHearts:a}=Zt(),[c,h]=I.useState(!1),[u,d]=I.useState(null),[f,v]=I.useState(!1),[y,w]=I.useState(0);I.useEffect(()=>{t(),i()},[]),I.useEffect(()=>{r!=null&&r.lastStreakFreezeUsed&&r.lastStreakFreezeUsed>0&&(w(r.lastStreakFreezeUsed),v(!0),(async()=>{const{doc:T,updateDoc:E}=await df(async()=>{const{doc:D,updateDoc:F}=await Promise.resolve().then(()=>sD);return{doc:D,updateDoc:F}},void 0),{db:R}=await df(async()=>{const{db:D}=await Promise.resolve().then(()=>lX);return{db:D}},void 0);try{const D=T(R,"users",r.oderId);await E(D,{lastStreakFreezeUsed:null})}catch(D){console.error("Error clearing freeze notification:",D)}})())},[r==null?void 0:r.lastStreakFreezeUsed]);const _=N=>{if(r&&r.hearts<=0&&!a()){d(N),h(!0);return}ds.getState().selectChapter(N),e("/quiz")},x=async()=>{await s(500)&&(await o(),h(!1),u!==null&&(ds.getState().selectChapter(u),e("/quiz")))},C=()=>{h(!1),e("/shop")},k=["#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b","#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b","#ff9600"],P=(r==null?void 0:r.dailyProgress)??0,A=(r==null?void 0:r.dailyGoal)??50,M=A>0?Math.min(P/A*100,100):0;return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 pt-3 pb-3 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-11 h-11 rounded-2xl bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Yc,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-lg text-foreground",children:"Quiz QTDA"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[n.length," chng"]})]})]}),r&&l.jsx("div",{className:"bg-[var(--duo-yellow)] px-2.5 py-1 rounded-lg",children:l.jsxs("span",{className:"text-xs font-bold text-[#1a2c35]",children:["Lv.",r.level]})})]}),r&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[a()?l.jsxs("div",{className:"flex items-center gap-1 bg-gradient-to-r from-[var(--duo-red)] to-[var(--duo-pink)] px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),l.jsx("span",{className:"text-white font-bold text-sm",children:""})]}):l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(r.maxHearts??5)].map((N,T)=>l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:`w-4 h-4 ${T>=(r.hearts??5)?"opacity-30 grayscale":""}`},T))}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-orange)]",children:r.streak})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-blue)]",children:Mn(r.gems)})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Le,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-yellow)]",children:Mn(ff(r,0).totalScore)})]})]})]})]}),l.jsxs("div",{className:"px-4 pt-40 pb-28",children:[r&&l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(Vi,{className:"w-4 h-4 text-[var(--duo-green)]"}),l.jsx("span",{className:"font-bold text-sm text-foreground",children:"Mc tiu hm nay"})]}),l.jsxs("span",{className:`font-bold text-sm ${(r.dailyProgress??0)>=(r.dailyGoal??50)?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`,children:[r.dailyProgress??0,"/",r.dailyGoal??50," XP"]})]}),l.jsx("div",{className:"progress-duo h-2.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${M}%`,background:(r.dailyProgress??0)>=(r.dailyGoal??50)?"var(--duo-yellow)":void 0}})})]}),l.jsxs("button",{onClick:()=>e("/battle"),className:"btn-battle w-full mb-3 py-4 px-4 rounded-2xl font-bold text-white text-lg flex items-center justify-center gap-3",style:{background:"linear-gradient(135deg, #58cc02 0%, #46a302 100%)",boxShadow:"0 6px 0 #3d8c02, 0 8px 20px rgba(88, 204, 2, 0.4)"},children:[l.jsx(DO,{className:"w-7 h-7"}),l.jsx("span",{children:"LUYN TP"})]}),l.jsxs("button",{onClick:()=>e("/conquest"),className:"btn-battle w-full mb-5 py-4 px-4 rounded-2xl font-bold text-white text-lg flex items-center justify-center gap-3",style:{background:"linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%)",boxShadow:"0 6px 0 #7c3aed, 0 8px 20px rgba(139, 92, 246, 0.4)"},children:[l.jsx(wi,{className:"w-7 h-7"}),l.jsx("span",{children:"CHINH CHIN"})]}),l.jsx("h2",{className:"text-sm font-bold mb-3 text-[var(--muted-foreground)]",children:"Chn chng"}),l.jsx("div",{className:"space-y-2.5",children:n.map((N,T)=>{const E=r==null?void 0:r.chapterProgress[N.id],R=E?Math.round(E.completed/N.totalQuestions*100):0,D=(E==null?void 0:E.stars)||0;return l.jsx("button",{onClick:()=>_(N.id),className:"card-3d w-full p-3 text-left",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center text-white font-bold text-base shrink-0",style:{background:k[T%k.length]},children:N.id}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground line-clamp-1",children:N.name}),l.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[N.totalQuestions," cu"]}),D>0&&l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(3)].map((F,L)=>l.jsx(ge,{className:`w-3 h-3 ${L<D?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},L))})]}),l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})})]}),l.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[(E==null?void 0:E.isCompleted)&&l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}),E&&E.bestScore>0&&l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Best"}),l.jsx("div",{className:"font-bold text-sm text-[var(--duo-green)]",children:E.bestScore})]})]})]})},N.id)})})]}),l.jsx(wV,{isOpen:c,onClose:()=>{h(!1),d(null)},onBuyHearts:x,onGoToShop:C,userGems:(r==null?void 0:r.gems)??0,heartCost:500}),l.jsx(Gn,{isOpen:f,onClose:()=>v(!1),title:"Streak  c bo v! ",subtitle:` s dng ${y} Streak Freeze  gi streak ca bn`,rewards:[{type:"custom",amount:(r==null?void 0:r.streak)||0,icon:"/AppAssets/Fire.png",label:"ngy streak c gi"}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-blue)",gradientTo:"#84d8ff"})]})}var ab={};(function e(t,n,i,r){var s=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=function(){if(!t.OffscreenCanvas)return!1;try{var j=new OffscreenCanvas(1,1),q=j.getContext("2d");q.fillRect(0,0,1,1);var J=j.transferToImageBitmap();q.createPattern(J,"no-repeat")}catch{return!1}return!0}();function c(){}function h(j){var q=n.exports.Promise,J=q!==void 0?q:t.Promise;return typeof J=="function"?new J(j):(j(c,c),null)}var u=function(j,q){return{transform:function(J){if(j)return J;if(q.has(J))return q.get(J);var G=new OffscreenCanvas(J.width,J.height),Q=G.getContext("2d");return Q.drawImage(J,0,0),q.set(J,G),G},clear:function(){q.clear()}}}(a,new Map),d=function(){var j=Math.floor(16.666666666666668),q,J,G={},Q=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(q=function(Z){var O=Math.random();return G[O]=requestAnimationFrame(function B(rt){Q===rt||Q+j-1<rt?(Q=rt,delete G[O],Z()):G[O]=requestAnimationFrame(B)}),O},J=function(Z){G[Z]&&cancelAnimationFrame(G[Z])}):(q=function(Z){return setTimeout(Z,j)},J=function(Z){return clearTimeout(Z)}),{frame:q,cancel:J}}(),f=function(){var j,q,J={};function G(Q){function Z(O,B){Q.postMessage({options:O||{},callback:B})}Q.init=function(B){var rt=B.transferControlToOffscreen();Q.postMessage({canvas:rt},[rt])},Q.fire=function(B,rt,z){if(q)return Z(B,null),q;var et=Math.random().toString(36).slice(2);return q=h(function(nt){function mt(Nt){Nt.data.callback===et&&(delete J[et],Q.removeEventListener("message",mt),q=null,u.clear(),z(),nt())}Q.addEventListener("message",mt),Z(B,et),J[et]=mt.bind(null,{data:{callback:et}})}),q},Q.reset=function(){Q.postMessage({reset:!0});for(var B in J)J[B](),delete J[B]}}return function(){if(j)return j;if(!i&&s){var Q=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{j=new Worker(URL.createObjectURL(new Blob([Q])))}catch(Z){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",Z),null}G(j)}return j}}(),v={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function y(j,q){return q?q(j):j}function w(j){return j!=null}function _(j,q,J){return y(j&&w(j[q])?j[q]:v[q],J)}function x(j){return j<0?0:Math.floor(j)}function C(j,q){return Math.floor(Math.random()*(q-j))+j}function k(j){return parseInt(j,16)}function P(j){return j.map(A)}function A(j){var q=String(j).replace(/[^0-9a-f]/gi,"");return q.length<6&&(q=q[0]+q[0]+q[1]+q[1]+q[2]+q[2]),{r:k(q.substring(0,2)),g:k(q.substring(2,4)),b:k(q.substring(4,6))}}function M(j){var q=_(j,"origin",Object);return q.x=_(q,"x",Number),q.y=_(q,"y",Number),q}function N(j){j.width=document.documentElement.clientWidth,j.height=document.documentElement.clientHeight}function T(j){var q=j.getBoundingClientRect();j.width=q.width,j.height=q.height}function E(j){var q=document.createElement("canvas");return q.style.position="fixed",q.style.top="0px",q.style.left="0px",q.style.pointerEvents="none",q.style.zIndex=j,q}function R(j,q,J,G,Q,Z,O,B,rt){j.save(),j.translate(q,J),j.rotate(Z),j.scale(G,Q),j.arc(0,0,1,O,B,rt),j.restore()}function D(j){var q=j.angle*(Math.PI/180),J=j.spread*(Math.PI/180);return{x:j.x,y:j.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:j.startVelocity*.5+Math.random()*j.startVelocity,angle2D:-q+(.5*J-Math.random()*J),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:j.color,shape:j.shape,tick:0,totalTicks:j.ticks,decay:j.decay,drift:j.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:j.gravity*3,ovalScalar:.6,scalar:j.scalar,flat:j.flat}}function F(j,q){q.x+=Math.cos(q.angle2D)*q.velocity+q.drift,q.y+=Math.sin(q.angle2D)*q.velocity+q.gravity,q.velocity*=q.decay,q.flat?(q.wobble=0,q.wobbleX=q.x+10*q.scalar,q.wobbleY=q.y+10*q.scalar,q.tiltSin=0,q.tiltCos=0,q.random=1):(q.wobble+=q.wobbleSpeed,q.wobbleX=q.x+10*q.scalar*Math.cos(q.wobble),q.wobbleY=q.y+10*q.scalar*Math.sin(q.wobble),q.tiltAngle+=.1,q.tiltSin=Math.sin(q.tiltAngle),q.tiltCos=Math.cos(q.tiltAngle),q.random=Math.random()+2);var J=q.tick++/q.totalTicks,G=q.x+q.random*q.tiltCos,Q=q.y+q.random*q.tiltSin,Z=q.wobbleX+q.random*q.tiltCos,O=q.wobbleY+q.random*q.tiltSin;if(j.fillStyle="rgba("+q.color.r+", "+q.color.g+", "+q.color.b+", "+(1-J)+")",j.beginPath(),o&&q.shape.type==="path"&&typeof q.shape.path=="string"&&Array.isArray(q.shape.matrix))j.fill(K(q.shape.path,q.shape.matrix,q.x,q.y,Math.abs(Z-G)*.1,Math.abs(O-Q)*.1,Math.PI/10*q.wobble));else if(q.shape.type==="bitmap"){var B=Math.PI/10*q.wobble,rt=Math.abs(Z-G)*.1,z=Math.abs(O-Q)*.1,et=q.shape.bitmap.width*q.scalar,nt=q.shape.bitmap.height*q.scalar,mt=new DOMMatrix([Math.cos(B)*rt,Math.sin(B)*rt,-Math.sin(B)*z,Math.cos(B)*z,q.x,q.y]);mt.multiplySelf(new DOMMatrix(q.shape.matrix));var Nt=j.createPattern(u.transform(q.shape.bitmap),"no-repeat");Nt.setTransform(mt),j.globalAlpha=1-J,j.fillStyle=Nt,j.fillRect(q.x-et/2,q.y-nt/2,et,nt),j.globalAlpha=1}else if(q.shape==="circle")j.ellipse?j.ellipse(q.x,q.y,Math.abs(Z-G)*q.ovalScalar,Math.abs(O-Q)*q.ovalScalar,Math.PI/10*q.wobble,0,2*Math.PI):R(j,q.x,q.y,Math.abs(Z-G)*q.ovalScalar,Math.abs(O-Q)*q.ovalScalar,Math.PI/10*q.wobble,0,2*Math.PI);else if(q.shape==="star")for(var ct=Math.PI/2*3,ot=4*q.scalar,Tt=8*q.scalar,Et=q.x,Yt=q.y,St=5,Ut=Math.PI/St;St--;)Et=q.x+Math.cos(ct)*Tt,Yt=q.y+Math.sin(ct)*Tt,j.lineTo(Et,Yt),ct+=Ut,Et=q.x+Math.cos(ct)*ot,Yt=q.y+Math.sin(ct)*ot,j.lineTo(Et,Yt),ct+=Ut;else j.moveTo(Math.floor(q.x),Math.floor(q.y)),j.lineTo(Math.floor(q.wobbleX),Math.floor(Q)),j.lineTo(Math.floor(Z),Math.floor(O)),j.lineTo(Math.floor(G),Math.floor(q.wobbleY));return j.closePath(),j.fill(),q.tick<q.totalTicks}function L(j,q,J,G,Q){var Z=q.slice(),O=j.getContext("2d"),B,rt,z=h(function(et){function nt(){B=rt=null,O.clearRect(0,0,G.width,G.height),u.clear(),Q(),et()}function mt(){i&&!(G.width===r.width&&G.height===r.height)&&(G.width=j.width=r.width,G.height=j.height=r.height),!G.width&&!G.height&&(J(j),G.width=j.width,G.height=j.height),O.clearRect(0,0,G.width,G.height),Z=Z.filter(function(Nt){return F(O,Nt)}),Z.length?B=d.frame(mt):nt()}B=d.frame(mt),rt=nt});return{addFettis:function(et){return Z=Z.concat(et),z},canvas:j,promise:z,reset:function(){B&&d.cancel(B),rt&&rt()}}}function lt(j,q){var J=!j,G=!!_(q||{},"resize"),Q=!1,Z=_(q,"disableForReducedMotion",Boolean),O=s&&!!_(q||{},"useWorker"),B=O?f():null,rt=J?N:T,z=j&&B?!!j.__confetti_initialized:!1,et=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,nt;function mt(ct,ot,Tt){for(var Et=_(ct,"particleCount",x),Yt=_(ct,"angle",Number),St=_(ct,"spread",Number),Ut=_(ct,"startVelocity",Number),pn=_(ct,"decay",Number),oe=_(ct,"gravity",Number),ft=_(ct,"drift",Number),It=_(ct,"colors",P),ae=_(ct,"ticks",Number),vn=_(ct,"shapes"),Xn=_(ct,"scalar"),Ei=!!_(ct,"flat"),Jn=M(ct),Zn=Et,Si=[],ti=j.width*Jn.x,Ii=j.height*Jn.y;Zn--;)Si.push(D({x:ti,y:Ii,angle:Yt,spread:St,startVelocity:Ut,color:It[Zn%It.length],shape:vn[C(0,vn.length)],ticks:ae,decay:pn,gravity:oe,drift:ft,scalar:Xn,flat:Ei}));return nt?nt.addFettis(Si):(nt=L(j,Si,rt,ot,Tt),nt.promise)}function Nt(ct){var ot=Z||_(ct,"disableForReducedMotion",Boolean),Tt=_(ct,"zIndex",Number);if(ot&&et)return h(function(Ut){Ut()});J&&nt?j=nt.canvas:J&&!j&&(j=E(Tt),document.body.appendChild(j)),G&&!z&&rt(j);var Et={width:j.width,height:j.height};B&&!z&&B.init(j),z=!0,B&&(j.__confetti_initialized=!0);function Yt(){if(B){var Ut={getBoundingClientRect:function(){if(!J)return j.getBoundingClientRect()}};rt(Ut),B.postMessage({resize:{width:Ut.width,height:Ut.height}});return}Et.width=Et.height=null}function St(){nt=null,G&&(Q=!1,t.removeEventListener("resize",Yt)),J&&j&&(document.body.contains(j)&&document.body.removeChild(j),j=null,z=!1)}return G&&!Q&&(Q=!0,t.addEventListener("resize",Yt,!1)),B?B.fire(ct,Et,St):mt(ct,Et,St)}return Nt.reset=function(){B&&B.reset(),nt&&nt.reset()},Nt}var ht;function Y(){return ht||(ht=lt(null,{useWorker:!0,resize:!0})),ht}function K(j,q,J,G,Q,Z,O){var B=new Path2D(j),rt=new Path2D;rt.addPath(B,new DOMMatrix(q));var z=new Path2D;return z.addPath(rt,new DOMMatrix([Math.cos(O)*Q,Math.sin(O)*Q,-Math.sin(O)*Z,Math.cos(O)*Z,J,G])),z}function U(j){if(!o)throw new Error("path confetti are not supported in this browser");var q,J;typeof j=="string"?q=j:(q=j.path,J=j.matrix);var G=new Path2D(q),Q=document.createElement("canvas"),Z=Q.getContext("2d");if(!J){for(var O=1e3,B=O,rt=O,z=0,et=0,nt,mt,Nt=0;Nt<O;Nt+=2)for(var ct=0;ct<O;ct+=2)Z.isPointInPath(G,Nt,ct,"nonzero")&&(B=Math.min(B,Nt),rt=Math.min(rt,ct),z=Math.max(z,Nt),et=Math.max(et,ct));nt=z-B,mt=et-rt;var ot=10,Tt=Math.min(ot/nt,ot/mt);J=[Tt,0,0,Tt,-Math.round(nt/2+B)*Tt,-Math.round(mt/2+rt)*Tt]}return{type:"path",path:q,matrix:J}}function W(j){var q,J=1,G="#000000",Q='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof j=="string"?q=j:(q=j.text,J="scalar"in j?j.scalar:J,Q="fontFamily"in j?j.fontFamily:Q,G="color"in j?j.color:G);var Z=10*J,O=""+Z+"px "+Q,B=new OffscreenCanvas(Z,Z),rt=B.getContext("2d");rt.font=O;var z=rt.measureText(q),et=Math.ceil(z.actualBoundingBoxRight+z.actualBoundingBoxLeft),nt=Math.ceil(z.actualBoundingBoxAscent+z.actualBoundingBoxDescent),mt=2,Nt=z.actualBoundingBoxLeft+mt,ct=z.actualBoundingBoxAscent+mt;et+=mt+mt,nt+=mt+mt,B=new OffscreenCanvas(et,nt),rt=B.getContext("2d"),rt.font=O,rt.fillStyle=G,rt.fillText(q,Nt,ct);var ot=1/J;return{type:"bitmap",bitmap:B.transferToImageBitmap(),matrix:[ot,0,0,ot,-et*ot/2,-nt*ot/2]}}n.exports=function(){return Y().apply(this,arguments)},n.exports.reset=function(){Y().reset()},n.exports.create=lt,n.exports.shapeFromPath=U,n.exports.shapeFromText=W})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),ab,!1);const Ee=ab.exports;ab.exports.create;function fX(){var K;const e=we(),{currentQuestions:t,currentIndex:n,selectedAnswer:i,isAnswered:r,selectAnswer:s,nextQuestion:o,score:a,quizMode:c}=ds(),{user:h,updateStats:u,updateStreak:d,loseHeart:f,updateDailyProgress:v,spendGems:y,refillHearts:w,hasUnlimitedHearts:_}=Zt(),[x,C]=I.useState(!1),[k,P]=I.useState(!1),[A,M]=I.useState(!1),[N,T]=I.useState(null),E=t[n],R=(n+1)/t.length*100,D=i===(E==null?void 0:E.correctAnswer),F=n===t.length-1;I.useEffect(()=>{T(null)},[n]),I.useEffect(()=>{r&&(D?(C(!0),Ee({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]}),setTimeout(()=>C(!1),800)):c==="chapter"&&!_()&&(P(!0),setTimeout(()=>P(!1),800)))},[r,D,c]);const L=U=>{r||T(U)},lt=async()=>{if(!N||r)return;const U=c!=="chapter";if(h&&h.hearts<=0&&!_()&&!U){M(!0);return}s(N);const W=N===E.correctAnswer;if(!W&&!U&&await f(),W){const j=new Date().toDateString(),q=parseInt(localStorage.getItem(`daily_correct_${j}`)||"0");localStorage.setItem(`daily_correct_${j}`,(q+1).toString());const J=parseInt(localStorage.getItem("weekly_xp")||"0");localStorage.setItem("weekly_xp",(J+10).toString())}await u(W,E.chapter,W?10:0),await v(W?10:2),n===0&&await d()},ht=async()=>{if(!h)return;await y(500)&&(await w(),M(!1))},Y=()=>{M(!1),e("/shop")};return E?l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})}),l.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Cu ",n+1,"/",t.length]}),l.jsxs("div",{className:"flex items-center gap-3",children:[h&&c==="chapter"&&(_()?l.jsxs("div",{className:"flex items-center gap-1 bg-gradient-to-r from-[var(--duo-red)] to-[var(--duo-pink)] px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),l.jsx("span",{className:"text-white font-bold text-sm",children:""})]}):l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(h.maxHearts??5)].map((U,W)=>l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:`w-4 h-4 ${W>=(h.hearts??5)?"opacity-30 grayscale":""}`},W))})),l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-yellow)]",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:a})]})]})]})]}),x&&l.jsx("div",{className:"fixed top-1/3 left-1/2 -translate-x-1/2 z-50",children:l.jsxs("div",{className:"xp-pop flex items-center gap-2 bg-[var(--duo-green)] text-white px-4 py-2 rounded-full font-bold",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"}),"+10 XP"]})}),k&&l.jsx("div",{className:"fixed top-1/3 left-1/2 -translate-x-1/2 z-50",children:l.jsxs("div",{className:"xp-pop flex items-center gap-2 bg-[var(--duo-red)] text-white px-4 py-2 rounded-full font-bold",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-5 h-5"}),"-1"]})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-[var(--secondary)] text-xs text-[var(--muted-foreground)] mb-3",children:E.chapterName}),l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:E.question}),l.jsx("div",{className:"space-y-2.5",children:E.options.map(U=>{const W=N===U.id,j=i===U.id,q=U.id===E.correctAnswer,J=r&&q,G=r&&j&&!q;return l.jsxs("button",{onClick:()=>L(U.id),disabled:r,className:Vt("option-btn w-full p-3 text-left flex items-center gap-3",W&&!r&&"selected",J&&"correct",G&&"wrong"),children:[l.jsx("div",{className:Vt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",J&&"bg-[var(--duo-green)] text-white",G&&"bg-[var(--duo-red)] text-white",!r&&!W&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",W&&!r&&"bg-[var(--duo-blue)] text-white"),children:J?l.jsx(Tr,{className:"w-4 h-4"}):G?l.jsx($r,{className:"w-4 h-4"}):U.id}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:U.text})]},U.id)})})]}),l.jsx("div",{className:Vt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",r?D?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:r?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[D?l.jsx(Tr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:Vt("font-bold text-xl",D?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:D?"Chnh xc!":"Sai mt ri!"}),!D&&l.jsxs("p",{className:"text-[var(--duo-red)]/80 text-sm",children:["p n:"," ",(K=E.options.find(U=>U.id===E.correctAnswer))==null?void 0:K.text]})]})]}),l.jsx("button",{onClick:o,className:Vt("btn-3d w-full py-3.5 text-base",D?"btn-3d-green":"btn-3d-orange"),children:F?"XEM KT QU":"TIP TC"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:lt,disabled:!N,className:Vt("btn-3d w-full py-3.5 text-base",N?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})}),l.jsx("div",{className:"h-24"}),l.jsx(wV,{isOpen:A,onClose:()=>M(!1),onBuyHearts:ht,onGoToShop:Y,userGems:(h==null?void 0:h.gems)??0,heartCost:500})]}):null}const cr=[{id:"first_quiz",name:"Khi u",description:"Tr li ng cu u tin",icon:"Target",requirement:1,type:"correct"},{id:"streak_3",name:"Kin tr",description:"t streak 3 ngy",icon:"Flame",requirement:3,type:"streak"},{id:"streak_7",name:"Tun l hon ho",description:"t streak 7 ngy",icon:"Zap",requirement:7,type:"streak"},{id:"streak_30",name:"Thng vng",description:"t streak 30 ngy",icon:"Crown",requirement:30,type:"streak"},{id:"correct_50",name:"Hc sinh gii",description:"Tr li ng 50 cu",icon:"BookOpen",requirement:50,type:"correct"},{id:"correct_100",name:"Xut sc",description:"Tr li ng 100 cu",icon:"Trophy",requirement:100,type:"correct"},{id:"correct_500",name:"Bc thy",description:"Tr li ng 500 cu",icon:"GraduationCap",requirement:500,type:"correct"},{id:"correct_1000",name:"Huyn thoi",description:"Tr li ng 1000 cu",icon:"Crown",requirement:1e3,type:"correct"},{id:"perfect_5",name:"Hon ho",description:"5 bi quiz 100%",icon:"Gem",requirement:5,type:"perfect"},{id:"perfect_20",name:"Siu sao",description:"20 bi quiz 100%",icon:"Star",requirement:20,type:"perfect"},{id:"perfect_50",name:"Thin ti",description:"50 bi quiz 100%",icon:"Sparkles",requirement:50,type:"perfect"},{id:"level_5",name:"Cp 5",description:"t level 5",icon:"Sparkles",requirement:5,type:"level"},{id:"level_10",name:"Cp 10",description:"t level 10",icon:"Medal",requirement:10,type:"level"},{id:"level_20",name:"Cp 20",description:"t level 20",icon:"Trophy",requirement:20,type:"level"},{id:"gems_100",name:"Nh giu",description:"S hu 100 gems",icon:"Coins",requirement:100,type:"gems"},{id:"gems_500",name:"Triu ph",description:"S hu 500 gems",icon:"Gem",requirement:500,type:"gems"},{id:"gems_1000",name:"T ph",description:"S hu 1000 gems",icon:"Crown",requirement:1e3,type:"gems"},{id:"conquest_first",name:"Chin binh",description:"Hon thnh trn Chinh Chin u tin",icon:"Swords",requirement:1,type:"conquest"},{id:"conquest_10",name:"Dng s",description:"Hon thnh 10 trn Chinh Chin",icon:"Shield",requirement:10,type:"conquest"},{id:"conquest_50",name:"Chin tng",description:"Hon thnh 50 trn Chinh Chin",icon:"Award",requirement:50,type:"conquest"},{id:"conquest_wins_5",name:"Chui thng",description:"t chui thng 5 trn",icon:"Zap",requirement:5,type:"conquest_wins"},{id:"conquest_wins_10",name:"Bt bi",description:"t chui thng 10 trn",icon:"Crown",requirement:10,type:"conquest_wins"},{id:"rank_100",name:"Tn binh",description:"t 100 Rank Points",icon:"Target",requirement:100,type:"rank_points"},{id:"rank_500",name:"Tinh anh",description:"t 500 Rank Points",icon:"Star",requirement:500,type:"rank_points"},{id:"rank_1000",name:"Cao th",description:"t 1000 Rank Points",icon:"Medal",requirement:1e3,type:"rank_points"},{id:"rank_2000",name:"i cao th",description:"t 2000 Rank Points",icon:"Trophy",requirement:2e3,type:"rank_points"},{id:"gacha_first",name:"Ln u quay",description:"Quay gacha ln u tin",icon:"Sparkles",requirement:1,type:"gacha_pulls"},{id:"gacha_pulls_50",name:"Ngi chi h",description:"Quay gacha 50 ln",icon:"Package",requirement:50,type:"gacha_pulls"},{id:"gacha_pulls_100",name:"am m su tp",description:"Quay gacha 100 ln",icon:"Sparkles",requirement:100,type:"gacha_pulls"},{id:"gacha_pulls_500",name:"Gacha Master",description:"Quay gacha 500 ln",icon:"Crown",requirement:500,type:"gacha_pulls"},{id:"gacha_ur_1",name:"Th vng u tin",description:"S hu 1 th UR",icon:"Star",requirement:1,type:"gacha_ur"},{id:"gacha_ur_5",name:"B su tp vng",description:"S hu 5 th UR",icon:"Star",requirement:5,type:"gacha_ur"},{id:"gacha_ur_10",name:"Kho bu UR",description:"S hu 10 th UR",icon:"Crown",requirement:10,type:"gacha_ur"},{id:"gacha_ur_25",name:"Vua th UR",description:"S hu 25 th UR",icon:"Crown",requirement:25,type:"gacha_ur"},{id:"gacha_sr_10",name:"B su tp tm",description:"S hu 10 th SR",icon:"Gem",requirement:10,type:"gacha_sr"},{id:"gacha_sr_50",name:"Kho bu SR",description:"S hu 50 th SR",icon:"Gem",requirement:50,type:"gacha_sr"},{id:"gacha_cards_25",name:"Nh su tp nh",description:"S hu 25 th unique",icon:"Image",requirement:25,type:"gacha_total_cards"},{id:"gacha_cards_100",name:"Nh su tp",description:"S hu 100 th unique",icon:"Image",requirement:100,type:"gacha_total_cards"},{id:"gacha_cards_250",name:"i su tp gia",description:"S hu 250 th unique",icon:"Crown",requirement:250,type:"gacha_total_cards"},{id:"gacha_collection_1",name:"Hon thnh b u",description:"Hon thnh 1 b su tp",icon:"Package",requirement:1,type:"gacha_collections"},{id:"gacha_collection_3",name:"Ngi su tp",description:"Hon thnh 3 b su tp",icon:"Package",requirement:3,type:"gacha_collections"},{id:"gacha_collection_5",name:"Bc thy su tp",description:"Hon thnh 5 b su tp",icon:"Trophy",requirement:5,type:"gacha_collections"},{id:"tower_floor_10",name:"Ngi leo thp",description:"t tng 10 trong Thp Luyn Ngc",icon:"Building",requirement:10,type:"tower_floor"},{id:"tower_floor_50",name:"Chinh phc thp",description:"t tng 50 trong Thp Luyn Ngc",icon:"Building",requirement:50,type:"tower_floor"},{id:"tower_floor_100",name:"B ch thp",description:"t tng 100 trong Thp Luyn Ngc",icon:"Building",requirement:100,type:"tower_floor"},{id:"tower_floor_200",name:"Huyn thoi thp",description:"t tng 200 trong Thp Luyn Ngc",icon:"Crown",requirement:200,type:"tower_floor"},{id:"tower_complete",name:"nh cao thp ngc",description:"Hon thnh ton b Thp Luyn Ngc",icon:"Trophy",requirement:1,type:"tower_complete"},{id:"quizzes_10",name:"Chm ch",description:"Hon thnh 10 bi luyn tp",icon:"Brain",requirement:10,type:"quizzes"},{id:"quizzes_50",name:"Sing nng",description:"Hon thnh 50 bi luyn tp",icon:"Brain",requirement:50,type:"quizzes"},{id:"quizzes_100",name:"Cn c",description:"Hon thnh 100 bi luyn tp",icon:"Brain",requirement:100,type:"quizzes"},{id:"quizzes_500",name:"Hc gi",description:"Hon thnh 500 bi luyn tp",icon:"GraduationCap",requirement:500,type:"quizzes"},{id:"correct_2000",name:"Siu nhn",description:"Tr li ng 2000 cu",icon:"Crown",requirement:2e3,type:"correct"},{id:"correct_5000",name:"Thn ng",description:"Tr li ng 5000 cu",icon:"Crown",requirement:5e3,type:"correct"},{id:"correct_10000",name:"Bt t",description:"Tr li ng 10000 cu",icon:"Crown",requirement:1e4,type:"correct"},{id:"streak_60",name:"2 thng lin tc",description:"t streak 60 ngy",icon:"Flame",requirement:60,type:"streak"},{id:"streak_100",name:"100 ngy huyn thoi",description:"t streak 100 ngy",icon:"Crown",requirement:100,type:"streak"},{id:"streak_365",name:"C nm khng ngh",description:"t streak 365 ngy",icon:"Crown",requirement:365,type:"streak"},{id:"level_30",name:"Cp 30",description:"t level 30",icon:"Star",requirement:30,type:"level"},{id:"level_50",name:"Cp 50",description:"t level 50",icon:"Crown",requirement:50,type:"level"},{id:"level_100",name:"Cp 100",description:"t level 100",icon:"Crown",requirement:100,type:"level"},{id:"conquest_100",name:"i tng",description:"Hon thnh 100 trn Chinh Chin",icon:"Swords",requirement:100,type:"conquest"},{id:"conquest_500",name:"Chin thn",description:"Hon thnh 500 trn Chinh Chin",icon:"Crown",requirement:500,type:"conquest"},{id:"rank_3000",name:"Hc Ngc",description:"t 3000 Rank Points",icon:"Trophy",requirement:3e3,type:"rank_points"},{id:"rank_4000",name:"Huyn Thoi",description:"t 4000 Rank Points",icon:"Crown",requirement:4e3,type:"rank_points"},{id:"rank_5000",name:"Thn thoi",description:"t 5000 Rank Points",icon:"Crown",requirement:5e3,type:"rank_points"},{id:"gacha_pulls_1000",name:"Gacha Legend",description:"Quay gacha 1000 ln",icon:"Crown",requirement:1e3,type:"gacha_pulls"},{id:"gacha_ur_50",name:"Vua UR",description:"S hu 50 th UR",icon:"Crown",requirement:50,type:"gacha_ur"},{id:"gacha_ur_100",name:"Hong  UR",description:"S hu 100 th UR",icon:"Crown",requirement:100,type:"gacha_ur"},{id:"gacha_cards_500",name:"Bo tng th",description:"S hu 500 th unique",icon:"Crown",requirement:500,type:"gacha_total_cards"},{id:"quizzes_1000",name:"Gio s",description:"Hon thnh 1000 bi luyn tp",icon:"GraduationCap",requirement:1e3,type:"quizzes"},{id:"quizzes_5000",name:"Vin s",description:"Hon thnh 5000 bi luyn tp",icon:"Crown",requirement:5e3,type:"quizzes"},{id:"perfect_100",name:"Hon ho tuyt i",description:"100 bi quiz 100%",icon:"Crown",requirement:100,type:"perfect"},{id:"perfect_500",name:"Khng sai mt cu",description:"500 bi quiz 100%",icon:"Crown",requirement:500,type:"perfect"},{id:"gems_5000",name:"i gia",description:"S hu 5000 gems",icon:"Gem",requirement:5e3,type:"gems"},{id:"gems_10000",name:"Ti phit",description:"S hu 10000 gems",icon:"Crown",requirement:1e4,type:"gems"}],mX=Object.freeze(Object.defineProperty({__proto__:null,ACHIEVEMENTS:cr},Symbol.toStringTag,{value:"Module"})),pX={Target:Vi,Flame:zr,Zap:Lr,Crown:hf,BookOpen:Yc,Trophy:Le,GraduationCap:DP,Gem:MP,Star:ge,Sparkles:Xt,Medal:Rc,Coins:PP,Swords:wi,Shield:VP,Award:pr,Package:Ts,Image:Nm,Building:Fu,Brain:IP};function vX(){const e=we(),{score:t,correctCount:n,wrongCount:i,currentQuestions:r,currentChapter:s,resetQuiz:o,selectChapter:a,chapters:c,quizMode:h}=ds(),{user:u,updateChapterProgress:d,addBadge:f,addPerfectLesson:v,addGems:y,checkAchievements:w,incrementDailyQuizzes:_,incrementDailyCorrect:x,incrementWeeklyXP:C,incrementWeeklyPerfect:k}=Zt(),[P,A]=I.useState(0),[M,N]=I.useState([]),[T,E]=I.useState(!1),[R,D]=I.useState(!1),[F,L]=I.useState([]),lt=r.length,ht=lt>0?Math.round(n/lt*100):0,Y=ht===100,U=ht>=90?3:ht>=70?2:ht>=50?1:0,W=s?c.find(Z=>Z.id===s):null,j=W&&n>=W.totalQuestions*.7;I.useEffect(()=>{(async()=>{var Nt;await _();for(let ct=0;ct<n;ct++)await x();if(await C(t),Y&&await k(),s&&u){const ct=(Nt=u.chapterProgress)==null?void 0:Nt[s];await d(s,{completed:n,correct:((ct==null?void 0:ct.correct)??0)+n,bestScore:Math.max((ct==null?void 0:ct.bestScore)??0,t),lastAttempt:new Date().toISOString(),stars:Math.max((ct==null?void 0:ct.stars)??0,U),isCompleted:j||((ct==null?void 0:ct.isCompleted)??!1)})}const O=[],B=h==="survival"?3:h==="timeattack"?2:1,rt=n*20*B;let z=0,et="";Y?(await v(),z=100*B,et=h==="survival"?"Hardcore Perfect!":h==="timeattack"?"Speed Perfect!":"Hon ho!"):ht>=80?(z=60*B,et="Xut sc!"):ht>=50&&(z=30*B,et="Tt lm!");const nt=rt+z;nt>0&&(await y(nt),A(nt),O.push({type:"gems",amount:nt,label:et||`${n} cu ng`})),t>0&&O.push({type:"xp",amount:t}),O.length>0&&(L(O),D(!0));const mt=await w();if(mt.length>0){const ct=cr.filter(ot=>mt.includes(ot.id));N(ct),E(!0)}if(ht>=80){const ct=Y?3e3:1500,ot=Date.now()+ct,Tt=()=>{Ee({particleCount:Y?7:3,angle:60,spread:55,origin:{x:0},colors:["#58cc02","#ffc800","#1cb0f6"]}),Ee({particleCount:Y?7:3,angle:120,spread:55,origin:{x:1},colors:["#58cc02","#ffc800","#1cb0f6"]}),Date.now()<ot&&requestAnimationFrame(Tt)};Tt()}Y&&await f("perfect_score")})()},[]);const J=ht>=90?{label:"Xut sc!",icon:Le,color:"var(--duo-yellow)"}:ht>=70?{label:"Tt lm!",icon:ge,color:"var(--duo-green)"}:ht>=50?{label:"Kh n!",icon:Vi,color:"var(--duo-blue)"}:{label:"C gng hn!",icon:zr,color:"var(--duo-orange)"},G=J.icon,Q=()=>{s?a(s):(o(),e("/battle"))};return l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[65vh] px-4",children:[l.jsx(Gn,{isOpen:R,onClose:()=>D(!1),title:Y?"Hon ho!":ht>=80?"Xut sc!":"Hon thnh!",subtitle:s?`Chng ${s}`:"Luyn tp",rewards:F,gradientFrom:Y?"var(--duo-yellow)":"var(--duo-green)",gradientTo:Y?"var(--duo-orange)":"var(--duo-blue)"}),T&&M.length>0&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full text-center",children:[l.jsx(pr,{className:"w-16 h-16 text-[var(--duo-yellow)] mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-bold text-[var(--duo-yellow)] mb-2",children:"Thnh tu mi!"}),l.jsx("div",{className:"space-y-3 mb-4",children:M.map(Z=>{const O=pX[Z.icon];return l.jsxs("div",{className:"flex items-center gap-3 bg-[var(--secondary)] p-3 rounded-xl",children:[l.jsx(O,{className:"w-8 h-8 text-[var(--duo-yellow)]"}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-bold text-foreground",children:Z.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:Z.description})]})]},Z.id)})}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)] mb-4",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"}),l.jsxs("span",{className:"font-bold",children:["+",M.length*50," Gems"]})]}),l.jsx("button",{onClick:()=>E(!1),className:"btn-3d btn-3d-green w-full py-3",children:"Tuyt vi!"})]})}),l.jsx("div",{className:"w-20 h-20 rounded-full bg-[var(--secondary)] flex items-center justify-center mb-3",children:l.jsx(G,{className:"w-10 h-10",style:{color:J.color}})}),l.jsx("h1",{className:"text-2xl font-bold mb-1",style:{color:J.color},children:J.label}),j&&l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-green)] mb-2",children:[l.jsx(ai,{className:"w-5 h-5"}),l.jsx("span",{className:"font-semibold text-sm",children:"Chng hon thnh!"})]}),l.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(3)].map((Z,O)=>l.jsx(ge,{className:`w-8 h-8 ${O<U?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},O))}),l.jsxs("div",{className:"relative w-32 h-32 mb-4",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",children:[l.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:"var(--secondary)",strokeWidth:"10"}),l.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:J.color,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:`${ht/100*352} 352`})]}),l.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:l.jsxs("span",{className:"text-3xl font-bold text-foreground",children:[ht,"%"]})})]}),l.jsxs("div",{className:"w-full max-w-xs card-3d p-3 mb-4",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-green)]/20 flex items-center justify-center mb-1",children:l.jsx(ai,{className:"w-4 h-4 text-[var(--duo-green)]"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-green)]",children:n}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"ng"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-red)]/20 flex items-center justify-center mb-1",children:l.jsx(Vi,{className:"w-4 h-4 text-[var(--duo-red)]"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-red)]",children:i}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Sai"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-1",children:l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-yellow)]",children:t}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"XP"})]})]}),P>0&&l.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--border)] text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold",children:["+",P," Gems bonus!"]})]})}),u&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--border)] flex items-center justify-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-orange)]",children:u.streak})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Le,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsxs("span",{className:"font-bold text-sm",children:["Lv.",u.level]})]})]})]}),l.jsxs("div",{className:"w-full max-w-xs space-y-2.5",children:[l.jsxs("button",{onClick:Q,className:"btn-3d btn-3d-green w-full py-3 flex items-center justify-center gap-2",children:[l.jsx(du,{className:"w-4 h-4"})," Lm li"]}),l.jsxs("button",{onClick:()=>{const Z=!s;o(),e(Z?"/battle":"/")},className:"btn-3d btn-3d-blue w-full py-3 flex items-center justify-center gap-2",children:[l.jsx(F_,{className:"w-4 h-4"})," ",s?"Trang ch":"Luyn tp"]})]})]})}function yX(){var N;const e=we(),{currentQuestions:t,currentIndex:n,resetQuiz:i,chapters:r,currentChapter:s,correctCount:o,wrongCount:a,score:c,quizMode:h,timeLimit:u,maxWrong:d}=ds(),{user:f,updateChapterProgress:v}=Zt(),[y,w]=I.useState(u??0),[_,x]=I.useState(!1),C=I.useRef(null);I.useEffect(()=>{if(h==="timeattack"&&u&&!_)return w(u),C.current=setInterval(()=>{w(T=>T<=1?(clearInterval(C.current),x(!0),0):T-1)},1e3),()=>{C.current&&clearInterval(C.current)}},[h,u]);const k=h==="survival"&&d&&a>=d,P=n>=t.length||_||k,A=s?(N=r.find(T=>T.id===s))==null?void 0:N.name:h==="timeattack"?"Time Attack":h==="survival"?"Sinh Tn":"Trc nghim";I.useEffect(()=>{t.length===0&&(window.location.pathname!=="/quiz"||e("/"))},[]);const M=async()=>{var E;if(C.current&&clearInterval(C.current),s&&n>0&&f){const R=(E=f.chapterProgress)==null?void 0:E[s],D=o+a;await v(s,{completed:Math.max((R==null?void 0:R.completed)??0,D),correct:((R==null?void 0:R.correct)??0)+o,bestScore:Math.max((R==null?void 0:R.bestScore)??0,c),lastAttempt:new Date().toISOString()})}const T=!s;i(),e(T?"/battle":"/")};return t.length===0?null:l.jsxs(re,{className:"bg-background min-h-screen",children:[!P&&l.jsx("div",{className:"pt-4 pb-2 px-4 bg-background sticky top-0 z-10",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:M,className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h1",{className:"font-bold text-sm text-[var(--muted-foreground)] truncate max-w-[200px]",children:s?`Chng ${s}: ${A}`:A}),h==="timeattack"&&l.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-lg ${y<=10?"bg-[var(--duo-red)]":"bg-[var(--duo-blue)]"}`,children:[l.jsx(Uu,{className:"w-4 h-4 text-white"}),l.jsxs("span",{className:"font-bold text-sm text-white",children:[y,"s"]})]}),h==="survival"&&d&&l.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-lg bg-[var(--duo-red)]",children:[l.jsx(U_,{className:"w-4 h-4 text-white"}),l.jsx("span",{className:"font-bold text-sm text-white",children:d-a})]})]}),l.jsx("div",{className:"w-10"})," "]})}),l.jsx("div",{className:`px-4 pb-8 ${P?"pt-4":""}`,style:{minHeight:"calc(100vh - 100px)"},children:P?l.jsx(vX,{}):l.jsx(fX,{})})]})}var xX={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _X,wX;function bX(){return{geminiUrl:_X,vertexUrl:wX}}function TX(e,t,n,i){var r,s;if(!(e!=null&&e.baseUrl)){const o=bX();return t?(r=o.vertexUrl)!==null&&r!==void 0?r:n:(s=o.geminiUrl)!==null&&s!==void 0?s:i}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qs{}function gt(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(i,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){const s=t[r];return s!=null?String(s):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function m(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e))if(Array.isArray(n))e[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[a])){const c=e[a];if(Array.isArray(n))for(let h=0;h<c.length;h++){const u=c[h];m(u,t.slice(s+1),n[h])}else for(const h of c)m(h,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in e||(e[a]=[{}]);const c=e[a];m(c[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const i=t[t.length-1],r=e[i];if(r!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===r)return;if(typeof r=="object"&&typeof n=="object"&&r!==null&&n!==null)Object.assign(r,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[i]=n}function g(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let i=0;i<t.length;i++){if(typeof e!="object"||e===null)return n;const r=t[i];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in e){const o=e[s];return Array.isArray(o)?o.map(a=>g(a,t.slice(i+1),n)):n}else return n}else e=e[r]}return e}catch(i){if(i instanceof TypeError)return n;throw i}}function CX(e,t){for(const[n,i]of Object.entries(t)){const r=n.split("."),s=i.split("."),o=new Set;let a=-1;for(let c=0;c<r.length;c++)if(r[c]==="*"){a=c;break}if(a!==-1&&s.length>a)for(let c=a;c<s.length;c++){const h=s[c];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&o.add(h)}e0(e,r,s,0,o)}}function e0(e,t,n,i,r){if(i>=t.length||typeof e!="object"||e===null)return;const s=t[i];if(s.endsWith("[]")){const o=s.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const c of a[o])e0(c,t,n,i+1,r)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const o=e,a=Object.keys(o).filter(h=>!h.startsWith("_")&&!r.has(h)),c={};for(const h of a)c[h]=o[h];for(const[h,u]of Object.entries(c)){const d=[];for(const f of n.slice(i))f==="*"?d.push(h):d.push(f);m(o,d,u)}for(const h of a)delete o[h]}}else{const o=e;s in o&&e0(o[s],t,n,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cb(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kX(e){const t={},n=g(e,["operationName"]);n!=null&&m(t,["operationName"],n);const i=g(e,["resourceName"]);return i!=null&&m(t,["_url","resourceName"],i),t}function NX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response","generateVideoResponse"]);return o!=null&&m(t,["response"],SX(o)),t}function EX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],IX(o)),t}function SX(e){const t={},n=g(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>AX(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function IX(e){const t={},n=g(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>RX(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function AX(e){const t={},n=g(e,["video"]);return n!=null&&m(t,["video"],qX(n)),t}function RX(e){const t={},n=g(e,["_self"]);return n!=null&&m(t,["video"],jX(n)),t}function PX(e){const t={},n=g(e,["operationName"]);return n!=null&&m(t,["_url","operationName"],n),t}function MX(e){const t={},n=g(e,["operationName"]);return n!=null&&m(t,["_url","operationName"],n),t}function DX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],LX(o)),t}function LX(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function bV(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],VX(o)),t}function VX(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function qX(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["encodedVideo"]);i!=null&&m(t,["videoBytes"],cb(i));const r=g(e,["encoding"]);return r!=null&&m(t,["mimeType"],r),t}function jX(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["uri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["videoBytes"],cb(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var jE;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(jE||(jE={}));var FE;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(FE||(FE={}));var UE;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(UE||(UE={}));var le;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(le||(le={}));var OE;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(OE||(OE={}));var BE;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(BE||(BE={}));var GE;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(GE||(GE={}));var HE;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(HE||(HE={}));var $E;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})($E||($E={}));var zE;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(zE||(zE={}));var KE;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(KE||(KE={}));var WE;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(WE||(WE={}));var QE;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(QE||(QE={}));var YE;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(YE||(YE={}));var XE;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(XE||(XE={}));var JE;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(JE||(JE={}));var ZE;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(ZE||(ZE={}));var t1;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(t1||(t1={}));var e1;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(e1||(e1={}));var n1;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(n1||(n1={}));var i1;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(i1||(i1={}));var Wf;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Wf||(Wf={}));var r1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(r1||(r1={}));var s1;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(s1||(s1={}));var o1;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(o1||(o1={}));var n0;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(n0||(n0={}));var a1;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(a1||(a1={}));var c1;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(c1||(c1={}));var l1;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(l1||(l1={}));var h1;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(h1||(h1={}));var u1;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(u1||(u1={}));var d1;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(d1||(d1={}));var g1;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(g1||(g1={}));var f1;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(f1||(f1={}));var m1;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(m1||(m1={}));var p1;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(p1||(p1={}));var v1;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(v1||(v1={}));var y1;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(y1||(y1={}));var x1;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(x1||(x1={}));var _1;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(_1||(_1={}));var w1;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(w1||(w1={}));var b1;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(b1||(b1={}));var T1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(T1||(T1={}));var C1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(C1||(C1={}));var k1;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(k1||(k1={}));var N1;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(N1||(N1={}));var E1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(E1||(E1={}));var S1;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(S1||(S1={}));var I1;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(I1||(I1={}));var A1;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(A1||(A1={}));var R1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(R1||(R1={}));var P1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(P1||(P1={}));var M1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(M1||(M1={}));var D1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(D1||(D1={}));var L1;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(L1||(L1={}));var xc;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(xc||(xc={}));class i0{constructor(t){const n={};for(const i of t.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class ch{get text(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",u=!1;const d=[];for(const f of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[v,y]of Object.entries(f))v!=="text"&&v!=="thought"&&v!=="thoughtSignature"&&(y!==null||y!==void 0)&&d.push(v);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;u=!0,h+=f.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?h:void 0}get data(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const u=[];for(const d of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[f,v]of Object.entries(d))f!=="inlineData"&&(v!==null||v!==void 0)&&u.push(f);d.inlineData&&typeof d.inlineData.data=="string"&&(h+=atob(d.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,n,i,r,s,o,a,c,h;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(d=>d.executableCode).map(d=>d.executableCode).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return(h=u==null?void 0:u[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,n,i,r,s,o,a,c,h;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(d=>d.codeExecutionResult).map(d=>d.codeExecutionResult).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return(h=u==null?void 0:u[0])===null||h===void 0?void 0:h.output}}class V1{}class q1{}class FX{}class UX{}class OX{}class BX{}class j1{}class F1{}class U1{}class GX{}class Qf{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new Qf;let r;const s=t;return n?r=EX(s):r=NX(s),Object.assign(i,r),i}}class O1{}class B1{}class G1{}class H1{}class HX{}class $X{}class zX{}class lb{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new lb,s=DX(t);return Object.assign(i,s),i}}class KX{}class WX{}class QX{}class $1{}class YX{get text(){var t,n,i;let r="",s=!1;const o=[];for(const a of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[c,h]of Object.entries(a))c!=="text"&&c!=="thought"&&h!==null&&o.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,r+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?r:void 0}get data(){var t,n,i;let r="";const s=[];for(const o of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[a,c]of Object.entries(o))a!=="inlineData"&&c!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(r+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class XX{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class hb{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new hb,s=bV(t);return Object.assign(i,s),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function te(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function TV(e,t){const n=te(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function CV(e){return Array.isArray(e)?e.map(t=>Yf(t)):[Yf(e)]}function Yf(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function kV(e){const t=Yf(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function NV(e){const t=Yf(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function z1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function EV(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>z1(t)):[z1(e)]}function r0(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function K1(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function W1(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ln(e){if(e==null)throw new Error("ContentUnion is required");return r0(e)?e:{role:"user",parts:EV(e)}}function ub(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const i=Ln(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(e.isVertexAI()){const n=Ln(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Ln(n)):[Ln(t)]}function Bi(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(K1(e)||W1(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ln(e)]}const t=[],n=[],i=r0(e[0]);for(const r of e){const s=r0(r);if(s!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(r);else{if(K1(r)||W1(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return i||t.push({role:"user",parts:EV(n)}),t}function JX(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(i=>i!=="null");if(n.length===1)t.type=Object.values(le).includes(n[0].toUpperCase())?n[0].toUpperCase():le.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const i of n)t.anyOf.push({type:Object.values(le).includes(i.toUpperCase())?i.toUpperCase():le.TYPE_UNSPECIFIED})}}function Uc(e){const t={},n=["items"],i=["anyOf"],r=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&JX(e.type,t);for(const[o,a]of Object.entries(e))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(le).includes(a.toUpperCase())?a.toUpperCase():le.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Uc(a);else if(i.includes(o)){const c=[];for(const h of a){if(h.type=="null"){t.nullable=!0;continue}c.push(Uc(h))}t[o]=c}else if(r.includes(o)){const c={};for(const[h,u]of Object.entries(a))c[h]=Uc(u);t[o]=c}else{if(o==="additionalProperties")continue;t[o]=a}return t}function db(e){return Uc(e)}function gb(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function fb(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Sl(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Uc(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Uc(t.response));return e}function Il(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function ZX(e,t,n,i=1){const r=!t.startsWith(`${n}/`)&&t.split("/").length===i;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:r?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:r?`${n}/${t}`:t}function js(e,t){if(typeof t!="string")throw new Error("name must be a string");return ZX(e,t,"cachedContents")}function SV(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Bo(e){return cb(e)}function tJ(e){return e!=null&&typeof e=="object"&&"name"in e}function eJ(e){return e!=null&&typeof e=="object"&&"video"in e}function nJ(e){return e!=null&&typeof e=="object"&&"uri"in e}function IV(e){var t;let n;if(tJ(e)&&(n=e.name),!(nJ(e)&&(n=e.uri,n===void 0))&&!(eJ(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function AV(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function RV(e){for(const t of["models","tunedModels","publisherModels"])if(iJ(e,t))return e[t];return[]}function iJ(e,t){return e!==null&&typeof e=="object"&&t in e}function rJ(e,t={}){const n=e,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),t.behavior&&(i.behavior=t.behavior),{functionDeclarations:[i]}}function sJ(e,t={}){const n=[],i=new Set;for(const r of e){const s=r.name;if(i.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);i.add(s);const o=rJ(r,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function PV(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function oJ(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function MV(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const r=n.inlinedResponses;if(!Array.isArray(r)||r.length===0)return e;let s=!1;for(const o of r){if(typeof o!="object"||o===null)continue;const c=o.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Al(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function DV(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aJ(e){const t={},n=g(e,["responsesFile"]);n!=null&&m(t,["fileName"],n);const i=g(e,["inlinedResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>OJ(o))),m(t,["inlinedResponses"],s)}const r=g(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["inlinedEmbedContentResponses"],s)}return t}function cJ(e){const t={},n=g(e,["predictionsFormat"]);n!=null&&m(t,["format"],n);const i=g(e,["gcsDestination","outputUriPrefix"]);i!=null&&m(t,["gcsUri"],i);const r=g(e,["bigqueryDestination","outputUri"]);return r!=null&&m(t,["bigqueryUri"],r),t}function lJ(e){const t={},n=g(e,["format"]);n!=null&&m(t,["predictionsFormat"],n);const i=g(e,["gcsUri"]);i!=null&&m(t,["gcsDestination","outputUriPrefix"],i);const r=g(e,["bigqueryUri"]);if(r!=null&&m(t,["bigqueryDestination","outputUri"],r),g(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Pg(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata","displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["metadata","state"]);r!=null&&m(t,["state"],DV(r));const s=g(e,["metadata","createTime"]);s!=null&&m(t,["createTime"],s);const o=g(e,["metadata","endTime"]);o!=null&&m(t,["endTime"],o);const a=g(e,["metadata","updateTime"]);a!=null&&m(t,["updateTime"],a);const c=g(e,["metadata","model"]);c!=null&&m(t,["model"],c);const h=g(e,["metadata","output"]);return h!=null&&m(t,["dest"],aJ(MV(h))),t}function s0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["state"]);r!=null&&m(t,["state"],DV(r));const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["createTime"]);o!=null&&m(t,["createTime"],o);const a=g(e,["startTime"]);a!=null&&m(t,["startTime"],a);const c=g(e,["endTime"]);c!=null&&m(t,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(t,["updateTime"],h);const u=g(e,["model"]);u!=null&&m(t,["model"],u);const d=g(e,["inputConfig"]);d!=null&&m(t,["src"],hJ(d));const f=g(e,["outputConfig"]);f!=null&&m(t,["dest"],cJ(MV(f)));const v=g(e,["completionStats"]);return v!=null&&m(t,["completionStats"],v),t}function hJ(e){const t={},n=g(e,["instancesFormat"]);n!=null&&m(t,["format"],n);const i=g(e,["gcsSource","uris"]);i!=null&&m(t,["gcsUri"],i);const r=g(e,["bigquerySource","inputUri"]);return r!=null&&m(t,["bigqueryUri"],r),t}function uJ(e,t){const n={};if(g(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=g(t,["fileName"]);i!=null&&m(n,["fileName"],i);const r=g(t,["inlinedRequests"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>UJ(e,o))),m(n,["requests","requests"],s)}return n}function dJ(e){const t={},n=g(e,["format"]);n!=null&&m(t,["instancesFormat"],n);const i=g(e,["gcsUri"]);i!=null&&m(t,["gcsSource","uris"],i);const r=g(e,["bigqueryUri"]);if(r!=null&&m(t,["bigquerySource","inputUri"],r),g(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function gJ(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function fJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function mJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function pJ(e){const t={},n=g(e,["content"]);n!=null&&m(t,["content"],n);const i=g(e,["citationMetadata"]);i!=null&&m(t,["citationMetadata"],vJ(i));const r=g(e,["tokenCount"]);r!=null&&m(t,["tokenCount"],r);const s=g(e,["finishReason"]);s!=null&&m(t,["finishReason"],s);const o=g(e,["avgLogprobs"]);o!=null&&m(t,["avgLogprobs"],o);const a=g(e,["groundingMetadata"]);a!=null&&m(t,["groundingMetadata"],a);const c=g(e,["index"]);c!=null&&m(t,["index"],c);const h=g(e,["logprobsResult"]);h!=null&&m(t,["logprobsResult"],h);const u=g(e,["safetyRatings"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(v=>v)),m(t,["safetyRatings"],f)}const d=g(e,["urlContextMetadata"]);return d!=null&&m(t,["urlContextMetadata"],d),t}function vJ(e){const t={},n=g(e,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["citations"],i)}return t}function LV(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>WJ(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function yJ(e,t){const n={},i=g(e,["displayName"]);if(t!==void 0&&i!=null&&m(t,["batch","displayName"],i),g(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function xJ(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["dest"]);return t!==void 0&&r!=null&&m(t,["outputConfig"],lJ(oJ(r))),n}function Q1(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["src"]);r!=null&&m(n,["batch","inputConfig"],uJ(e,PV(e,r)));const s=g(t,["config"]);return s!=null&&yJ(s,n),n}function _J(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],te(e,i));const r=g(t,["src"]);r!=null&&m(n,["inputConfig"],dJ(PV(e,r)));const s=g(t,["config"]);return s!=null&&xJ(s,n),n}function wJ(e,t){const n={},i=g(e,["displayName"]);return t!==void 0&&i!=null&&m(t,["batch","displayName"],i),n}function bJ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["src"]);r!=null&&m(n,["batch","inputConfig"],IJ(e,r));const s=g(t,["config"]);return s!=null&&wJ(s,n),n}function TJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function CJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function kJ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);return s!=null&&m(t,["error"],s),t}function NJ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);return s!=null&&m(t,["error"],s),t}function EJ(e,t){const n={},i=g(t,["contents"]);if(i!=null){let s=ub(e,i);Array.isArray(s)&&(s=s.map(o=>o)),m(n,["requests[]","request","content"],s)}const r=g(t,["config"]);return r!=null&&(m(n,["_self"],SJ(r,n)),CX(n,{"requests[].*":"requests[].request.*"})),n}function SJ(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["requests[]","taskType"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["requests[]","title"],r);const s=g(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&m(t,["requests[]","outputDimensionality"],s),g(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function IJ(e,t){const n={},i=g(t,["fileName"]);i!=null&&m(n,["file_name"],i);const r=g(t,["inlinedRequests"]);return r!=null&&m(n,["requests"],EJ(e,r)),n}function AJ(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function RJ(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function PJ(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function MJ(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],LV(Ln(r)));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const w=g(t,["seed"]);w!=null&&m(i,["seed"],w);const _=g(t,["responseMimeType"]);_!=null&&m(i,["responseMimeType"],_);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],db(x));const C=g(t,["responseJsonSchema"]);if(C!=null&&m(i,["responseJsonSchema"],C),g(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=g(t,["safetySettings"]);if(n!==void 0&&k!=null){let L=k;Array.isArray(L)&&(L=L.map(lt=>QJ(lt))),m(n,["safetySettings"],L)}const P=g(t,["tools"]);if(n!==void 0&&P!=null){let L=Il(P);Array.isArray(L)&&(L=L.map(lt=>XJ(Sl(lt)))),m(n,["tools"],L)}const A=g(t,["toolConfig"]);if(n!==void 0&&A!=null&&m(n,["toolConfig"],YJ(A)),g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=g(t,["cachedContent"]);n!==void 0&&M!=null&&m(n,["cachedContent"],js(e,M));const N=g(t,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const T=g(t,["mediaResolution"]);T!=null&&m(i,["mediaResolution"],T);const E=g(t,["speechConfig"]);if(E!=null&&m(i,["speechConfig"],gb(E)),g(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=g(t,["thinkingConfig"]);R!=null&&m(i,["thinkingConfig"],R);const D=g(t,["imageConfig"]);D!=null&&m(i,["imageConfig"],FJ(D));const F=g(t,["enableEnhancedCivicAnswers"]);return F!=null&&m(i,["enableEnhancedCivicAnswers"],F),i}function DJ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(h=>pJ(h))),m(t,["candidates"],c)}const r=g(e,["modelVersion"]);r!=null&&m(t,["modelVersion"],r);const s=g(e,["promptFeedback"]);s!=null&&m(t,["promptFeedback"],s);const o=g(e,["responseId"]);o!=null&&m(t,["responseId"],o);const a=g(e,["usageMetadata"]);return a!=null&&m(t,["usageMetadata"],a),t}function LJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function VJ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Al(e,i)),n}function qJ(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function jJ(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function FJ(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);if(i!=null&&m(t,["imageSize"],i),g(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function UJ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["request","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let a=Bi(r);Array.isArray(a)&&(a=a.map(c=>LV(c))),m(n,["request","contents"],a)}const s=g(t,["metadata"]);s!=null&&m(n,["metadata"],s);const o=g(t,["config"]);return o!=null&&m(n,["request","generationConfig"],MJ(e,o,g(n,["request"],{}))),n}function OJ(e){const t={},n=g(e,["response"]);n!=null&&m(t,["response"],DJ(n));const i=g(e,["error"]);return i!=null&&m(t,["error"],i),t}function BJ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);if(t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),g(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function GJ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);t!==void 0&&r!=null&&m(t,["_query","pageToken"],r);const s=g(e,["filter"]);return t!==void 0&&s!=null&&m(t,["_query","filter"],s),n}function HJ(e){const t={},n=g(e,["config"]);return n!=null&&BJ(n,t),t}function $J(e){const t={},n=g(e,["config"]);return n!=null&&GJ(n,t),t}function zJ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["operations"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Pg(o))),m(t,["batchJobs"],s)}return t}function KJ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["batchPredictionJobs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>s0(o))),m(t,["batchJobs"],s)}return t}function WJ(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],AJ(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],RJ(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],gJ(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function QJ(e){const t={},n=g(e,["category"]);if(n!=null&&m(t,["category"],n),g(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(e,["threshold"]);return i!=null&&m(t,["threshold"],i),t}function YJ(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],PJ(i)),t}function XJ(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],qJ(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],jJ(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var As;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(As||(As={}));class Ga{constructor(t,n,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,i,r)}init(t,n,i){var r,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(r=o.config)===null||r===void 0?void 0:r.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JJ extends qs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ga(As.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(t){const n=Q1(this.apiClient,t),i=n._url,r=gt("{model}:batchGenerateContent",i),a=n.batch.inputConfig.requests,c=a.requests,h=[];for(const u of c){const d=Object.assign({},u);if(d.systemInstruction){const f=d.systemInstruction;delete d.systemInstruction;const v=d.request;v.systemInstruction=f,d.request=v}h.push(d)}return a.requests=h,delete n.config,delete n._url,delete n._query,{path:r,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const i=n?Object.assign({},n):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const s=this.getGcsUri(t),o=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?i.dest=`${s.slice(0,-6)}/dest`:i.dest=`${s}_dest_${r}`;else if(o)i.dest=`${o}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=_J(this.apiClient,t);return a=gt("batchPredictionJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>s0(u))}else{const h=Q1(this.apiClient,t);return a=gt("{model}:batchGenerateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>Pg(u))}}async createEmbeddingsInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=bJ(this.apiClient,t);return s=gt("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>Pg(c))}}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=VJ(this.apiClient,t);return a=gt("batchPredictionJobs/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>s0(u))}else{const h=LJ(this.apiClient,t);return a=gt("batches/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>Pg(u))}}async cancel(t){var n,i,r,s;let o="",a={};if(this.apiClient.isVertexAI()){const c=mJ(this.apiClient,t);o=gt("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}else{const c=fJ(this.apiClient,t);o=gt("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=$J(t);return a=gt("batchPredictionJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=KJ(u),f=new $1;return Object.assign(f,d),f})}else{const h=HJ(t);return a=gt("batches",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=zJ(u),f=new $1;return Object.assign(f,d),f})}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=CJ(this.apiClient,t);return a=gt("batchPredictionJobs/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>NJ(u))}else{const h=TJ(this.apiClient,t);return a=gt("batches/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>kJ(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZJ(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Y1(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>bZ(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function tZ(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);t!==void 0&&r!=null&&m(t,["expireTime"],r);const s=g(e,["displayName"]);t!==void 0&&s!=null&&m(t,["displayName"],s);const o=g(e,["contents"]);if(t!==void 0&&o!=null){let u=Bi(o);Array.isArray(u)&&(u=u.map(d=>Y1(d))),m(t,["contents"],u)}const a=g(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],Y1(Ln(a)));const c=g(e,["tools"]);if(t!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(d=>CZ(d))),m(t,["tools"],u)}const h=g(e,["toolConfig"]);if(t!==void 0&&h!=null&&m(t,["toolConfig"],TZ(h)),g(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function eZ(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);t!==void 0&&r!=null&&m(t,["expireTime"],r);const s=g(e,["displayName"]);t!==void 0&&s!=null&&m(t,["displayName"],s);const o=g(e,["contents"]);if(t!==void 0&&o!=null){let d=Bi(o);Array.isArray(d)&&(d=d.map(f=>f)),m(t,["contents"],d)}const a=g(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],Ln(a));const c=g(e,["tools"]);if(t!==void 0&&c!=null){let d=c;Array.isArray(d)&&(d=d.map(f=>kZ(f))),m(t,["tools"],d)}const h=g(e,["toolConfig"]);t!==void 0&&h!=null&&m(t,["toolConfig"],h);const u=g(e,["kmsKeyName"]);return t!==void 0&&u!=null&&m(t,["encryption_spec","kmsKeyName"],u),n}function nZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],TV(e,i));const r=g(t,["config"]);return r!=null&&tZ(r,n),n}function iZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],TV(e,i));const r=g(t,["config"]);return r!=null&&eZ(r,n),n}function rZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],js(e,i)),n}function sZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],js(e,i)),n}function oZ(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function aZ(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function cZ(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function lZ(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function hZ(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function uZ(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function dZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],js(e,i)),n}function gZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],js(e,i)),n}function fZ(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function mZ(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function pZ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function vZ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function yZ(e){const t={},n=g(e,["config"]);return n!=null&&pZ(n,t),t}function xZ(e){const t={},n=g(e,["config"]);return n!=null&&vZ(n,t),t}function _Z(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["cachedContents"],s)}return t}function wZ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["cachedContents"],s)}return t}function bZ(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],cZ(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],lZ(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],ZJ(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function TZ(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],hZ(i)),t}function CZ(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],fZ(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],mZ(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function kZ(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>uZ(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function NZ(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);return t!==void 0&&r!=null&&m(t,["expireTime"],r),n}function EZ(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);return t!==void 0&&r!=null&&m(t,["expireTime"],r),n}function SZ(e,t){const n={},i=g(t,["name"]);i!=null&&m(n,["_url","name"],js(e,i));const r=g(t,["config"]);return r!=null&&NZ(r,n),n}function IZ(e,t){const n={},i=g(t,["name"]);i!=null&&m(n,["_url","name"],js(e,i));const r=g(t,["config"]);return r!=null&&EZ(r,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AZ extends qs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ga(As.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=iZ(this.apiClient,t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=nZ(this.apiClient,t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=gZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=dZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=sZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=aZ(u),f=new G1;return Object.assign(f,d),f})}else{const h=rZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=oZ(u),f=new G1;return Object.assign(f,d),f})}}async update(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=IZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=SZ(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=xZ(t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=wZ(u),f=new H1;return Object.assign(f,d),f})}else{const h=yZ(t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=_Z(u),f=new H1;return Object.assign(f,d),f})}}}function Xf(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function X1(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dt(e){return this instanceof Dt?(this.v=e,this):new Dt(e)}function _r(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(v){return function(y){return Promise.resolve(y).then(v,d)}}function a(v,y){i[v]&&(r[v]=function(w){return new Promise(function(_,x){s.push([v,w,_,x])>1||c(v,w)})},y&&(r[v]=y(r[v])))}function c(v,y){try{h(i[v](y))}catch(w){f(s[0][3],w)}}function h(v){v.value instanceof Dt?Promise.resolve(v.value.v).then(u,d):f(s[0][2],v)}function u(v){c("next",v)}function d(v){c("throw",v)}function f(v,y){v(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function wr(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof X1=="function"?X1(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(h){s({value:h,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RZ(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:VV(n)}function VV(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function PZ(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function J1(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let i=0;for(;i<n;)if(e[i].role==="user")t.push(e[i]),i++;else{const r=[];let s=!0;for(;i<n&&e[i].role==="model";)r.push(e[i]),s&&!VV(e[i])&&(s=!1),i++;s?t.push(...r):t.pop()}return t}class MZ{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new DZ(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class DZ{constructor(t,n,i,r={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=i,this.config=r,this.history=s,this.sendPromise=Promise.resolve(),PZ(s)}async sendMessage(t){var n;await this.sendPromise;const i=Ln(t.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const c=await r,h=(o=(s=c.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,u=c.automaticFunctionCallingHistory,d=this.getHistory(!0).length;let f=[];u!=null&&(f=(a=u.slice(d))!==null&&a!==void 0?a:[]);const v=h?[h]:[];this.recordHistory(i,v,f)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(t){var n;await this.sendPromise;const i=Ln(t.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const s=await r;return this.processStreamResponse(s,i)}getHistory(t=!1){const n=t?J1(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){return _r(this,arguments,function*(){var r,s,o,a,c,h;const u=[];try{for(var d=!0,f=wr(t),v;v=yield Dt(f.next()),r=v.done,!r;d=!0){a=v.value,d=!1;const y=a;if(RZ(y)){const w=(h=(c=y.candidates)===null||c===void 0?void 0:c[0])===null||h===void 0?void 0:h.content;w!==void 0&&u.push(w)}yield yield Dt(y)}}catch(y){s={error:y}}finally{try{!d&&!r&&(o=f.return)&&(yield Dt(o.call(f)))}finally{if(s)throw s.error}}this.recordHistory(n,u)})}recordHistory(t,n,i){let r=[];n.length>0&&n.every(s=>s.role!==void 0)?r=n:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...J1(i)):this.history.push(t),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dp extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,dp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LZ(e){const t={},n=g(e,["file"]);return n!=null&&m(t,["file"],n),t}function VZ(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function qZ(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","file"],IV(n)),t}function jZ(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function FZ(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","file"],IV(n)),t}function UZ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function OZ(e){const t={},n=g(e,["config"]);return n!=null&&UZ(n,t),t}function BZ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["files"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GZ extends qs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ga(As.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=OZ(t);return s=gt("files",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=BZ(c),u=new KX;return Object.assign(u,h),u})}}async createInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LZ(t);return s=gt("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=VZ(c),u=new WX;return Object.assign(u,h),u})}}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FZ(t);return s=gt("files/{file}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=qZ(t);return s=gt("files/{file}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=jZ(c),u=new QX;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mg(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function HZ(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>ott(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function $Z(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function zZ(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function KZ(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function WZ(e){const t={},n=g(e,["modelSelectionConfig"]);n!=null&&m(t,["modelConfig"],n);const i=g(e,["responseJsonSchema"]);i!=null&&m(t,["responseJsonSchema"],i);const r=g(e,["audioTimestamp"]);r!=null&&m(t,["audioTimestamp"],r);const s=g(e,["candidateCount"]);s!=null&&m(t,["candidateCount"],s);const o=g(e,["enableAffectiveDialog"]);o!=null&&m(t,["enableAffectiveDialog"],o);const a=g(e,["frequencyPenalty"]);a!=null&&m(t,["frequencyPenalty"],a);const c=g(e,["logprobs"]);c!=null&&m(t,["logprobs"],c);const h=g(e,["maxOutputTokens"]);h!=null&&m(t,["maxOutputTokens"],h);const u=g(e,["mediaResolution"]);u!=null&&m(t,["mediaResolution"],u);const d=g(e,["presencePenalty"]);d!=null&&m(t,["presencePenalty"],d);const f=g(e,["responseLogprobs"]);f!=null&&m(t,["responseLogprobs"],f);const v=g(e,["responseMimeType"]);v!=null&&m(t,["responseMimeType"],v);const y=g(e,["responseModalities"]);y!=null&&m(t,["responseModalities"],y);const w=g(e,["responseSchema"]);w!=null&&m(t,["responseSchema"],w);const _=g(e,["routingConfig"]);_!=null&&m(t,["routingConfig"],_);const x=g(e,["seed"]);x!=null&&m(t,["seed"],x);const C=g(e,["speechConfig"]);C!=null&&m(t,["speechConfig"],C);const k=g(e,["stopSequences"]);k!=null&&m(t,["stopSequences"],k);const P=g(e,["temperature"]);P!=null&&m(t,["temperature"],P);const A=g(e,["thinkingConfig"]);A!=null&&m(t,["thinkingConfig"],A);const M=g(e,["topK"]);M!=null&&m(t,["topK"],M);const N=g(e,["topP"]);if(N!=null&&m(t,["topP"],N),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function QZ(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function YZ(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function XZ(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],i);const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],fb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],HZ(Ln(y)));const w=g(e,["tools"]);if(t!==void 0&&w!=null){let M=Il(w);Array.isArray(M)&&(M=M.map(N=>ctt(Sl(N)))),m(t,["setup","tools"],M)}const _=g(e,["sessionResumption"]);t!==void 0&&_!=null&&m(t,["setup","sessionResumption"],att(_));const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);if(t!==void 0&&A!=null&&m(t,["setup","proactivity"],A),g(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function JZ(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],WZ(i));const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],fb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],Ln(y));const w=g(e,["tools"]);if(t!==void 0&&w!=null){let N=Il(w);Array.isArray(N)&&(N=N.map(T=>ltt(Sl(T)))),m(t,["setup","tools"],N)}const _=g(e,["sessionResumption"]);t!==void 0&&_!=null&&m(t,["setup","sessionResumption"],_);const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);t!==void 0&&A!=null&&m(t,["setup","proactivity"],A);const M=g(e,["explicitVadSignal"]);return t!==void 0&&M!=null&&m(t,["setup","explicitVadSignal"],M),n}function ZZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],te(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],XZ(r,n)),n}function ttt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],te(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],JZ(r,n)),n}function ett(e){const t={},n=g(e,["musicGenerationConfig"]);return n!=null&&m(t,["musicGenerationConfig"],n),t}function ntt(e){const t={},n=g(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["weightedPrompts"],i)}return t}function itt(e){const t={},n=g(e,["media"]);if(n!=null){let h=CV(n);Array.isArray(h)&&(h=h.map(u=>Mg(u))),m(t,["mediaChunks"],h)}const i=g(e,["audio"]);i!=null&&m(t,["audio"],Mg(NV(i)));const r=g(e,["audioStreamEnd"]);r!=null&&m(t,["audioStreamEnd"],r);const s=g(e,["video"]);s!=null&&m(t,["video"],Mg(kV(s)));const o=g(e,["text"]);o!=null&&m(t,["text"],o);const a=g(e,["activityStart"]);a!=null&&m(t,["activityStart"],a);const c=g(e,["activityEnd"]);return c!=null&&m(t,["activityEnd"],c),t}function rtt(e){const t={},n=g(e,["media"]);if(n!=null){let h=CV(n);Array.isArray(h)&&(h=h.map(u=>u)),m(t,["mediaChunks"],h)}const i=g(e,["audio"]);i!=null&&m(t,["audio"],NV(i));const r=g(e,["audioStreamEnd"]);r!=null&&m(t,["audioStreamEnd"],r);const s=g(e,["video"]);s!=null&&m(t,["video"],kV(s));const o=g(e,["text"]);o!=null&&m(t,["text"],o);const a=g(e,["activityStart"]);a!=null&&m(t,["activityStart"],a);const c=g(e,["activityEnd"]);return c!=null&&m(t,["activityEnd"],c),t}function stt(e){const t={},n=g(e,["setupComplete"]);n!=null&&m(t,["setupComplete"],n);const i=g(e,["serverContent"]);i!=null&&m(t,["serverContent"],i);const r=g(e,["toolCall"]);r!=null&&m(t,["toolCall"],r);const s=g(e,["toolCallCancellation"]);s!=null&&m(t,["toolCallCancellation"],s);const o=g(e,["usageMetadata"]);o!=null&&m(t,["usageMetadata"],htt(o));const a=g(e,["goAway"]);a!=null&&m(t,["goAway"],a);const c=g(e,["sessionResumptionUpdate"]);c!=null&&m(t,["sessionResumptionUpdate"],c);const h=g(e,["voiceActivityDetectionSignal"]);h!=null&&m(t,["voiceActivityDetectionSignal"],h);const u=g(e,["voiceActivity"]);return u!=null&&m(t,["voiceActivity"],utt(u)),t}function ott(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],$Z(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],zZ(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],Mg(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function att(e){const t={},n=g(e,["handle"]);if(n!=null&&m(t,["handle"],n),g(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function ctt(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],QZ(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],YZ(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function ltt(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>KZ(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function htt(e){const t={},n=g(e,["promptTokenCount"]);n!=null&&m(t,["promptTokenCount"],n);const i=g(e,["cachedContentTokenCount"]);i!=null&&m(t,["cachedContentTokenCount"],i);const r=g(e,["candidatesTokenCount"]);r!=null&&m(t,["responseTokenCount"],r);const s=g(e,["toolUsePromptTokenCount"]);s!=null&&m(t,["toolUsePromptTokenCount"],s);const o=g(e,["thoughtsTokenCount"]);o!=null&&m(t,["thoughtsTokenCount"],o);const a=g(e,["totalTokenCount"]);a!=null&&m(t,["totalTokenCount"],a);const c=g(e,["promptTokensDetails"]);if(c!=null){let v=c;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["promptTokensDetails"],v)}const h=g(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["cacheTokensDetails"],v)}const u=g(e,["candidatesTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["responseTokensDetails"],v)}const d=g(e,["toolUsePromptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["toolUsePromptTokensDetails"],v)}const f=g(e,["trafficType"]);return f!=null&&m(t,["trafficType"],f),t}function utt(e){const t={},n=g(e,["type"]);return n!=null&&m(t,["voiceActivityType"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dtt(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function gtt(e){const t={},n=g(e,["content"]);n!=null&&m(t,["content"],n);const i=g(e,["citationMetadata"]);i!=null&&m(t,["citationMetadata"],ftt(i));const r=g(e,["tokenCount"]);r!=null&&m(t,["tokenCount"],r);const s=g(e,["finishReason"]);s!=null&&m(t,["finishReason"],s);const o=g(e,["avgLogprobs"]);o!=null&&m(t,["avgLogprobs"],o);const a=g(e,["groundingMetadata"]);a!=null&&m(t,["groundingMetadata"],a);const c=g(e,["index"]);c!=null&&m(t,["index"],c);const h=g(e,["logprobsResult"]);h!=null&&m(t,["logprobsResult"],h);const u=g(e,["safetyRatings"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(v=>v)),m(t,["safetyRatings"],f)}const d=g(e,["urlContextMetadata"]);return d!=null&&m(t,["urlContextMetadata"],d),t}function ftt(e){const t={},n=g(e,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["citations"],i)}return t}function mtt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let s=Bi(r);Array.isArray(s)&&(s=s.map(o=>o)),m(n,["contents"],s)}return n}function ptt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(t,["tokensInfo"],r)}return t}function vtt(e){const t={},n=g(e,["values"]);n!=null&&m(t,["values"],n);const i=g(e,["statistics"]);return i!=null&&m(t,["statistics"],ytt(i)),t}function ytt(e){const t={},n=g(e,["truncated"]);n!=null&&m(t,["truncated"],n);const i=g(e,["token_count"]);return i!=null&&m(t,["tokenCount"],i),t}function gp(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Iet(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function xtt(e){const t={},n=g(e,["controlType"]);n!=null&&m(t,["controlType"],n);const i=g(e,["enableControlImageComputation"]);return i!=null&&m(t,["computeControl"],i),t}function _tt(e){const t={};if(g(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function wtt(e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],Ln(i));const r=g(e,["tools"]);if(t!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>UV(a))),m(t,["tools"],o)}const s=g(e,["generationConfig"]);return t!==void 0&&s!=null&&m(t,["generationConfig"],get(s)),n}function btt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let o=Bi(r);Array.isArray(o)&&(o=o.map(a=>gp(a))),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&_tt(s),n}function Ttt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let o=Bi(r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&wtt(s,n),n}function Ctt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["totalTokens"]);i!=null&&m(t,["totalTokens"],i);const r=g(e,["cachedContentTokenCount"]);return r!=null&&m(t,["cachedContentTokenCount"],r),t}function ktt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["totalTokens"]);return i!=null&&m(t,["totalTokens"],i),t}function Ntt(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],te(e,i)),n}function Ett(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],te(e,i)),n}function Stt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function Itt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function Att(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["negativePrompt"]);t!==void 0&&r!=null&&m(t,["parameters","negativePrompt"],r);const s=g(e,["numberOfImages"]);t!==void 0&&s!=null&&m(t,["parameters","sampleCount"],s);const o=g(e,["aspectRatio"]);t!==void 0&&o!=null&&m(t,["parameters","aspectRatio"],o);const a=g(e,["guidanceScale"]);t!==void 0&&a!=null&&m(t,["parameters","guidanceScale"],a);const c=g(e,["seed"]);t!==void 0&&c!=null&&m(t,["parameters","seed"],c);const h=g(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&m(t,["parameters","safetySetting"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&m(t,["parameters","includeSafetyAttributes"],d);const f=g(e,["includeRaiReason"]);t!==void 0&&f!=null&&m(t,["parameters","includeRaiReason"],f);const v=g(e,["language"]);t!==void 0&&v!=null&&m(t,["parameters","language"],v);const y=g(e,["outputMimeType"]);t!==void 0&&y!=null&&m(t,["parameters","outputOptions","mimeType"],y);const w=g(e,["outputCompressionQuality"]);t!==void 0&&w!=null&&m(t,["parameters","outputOptions","compressionQuality"],w);const _=g(e,["addWatermark"]);t!==void 0&&_!=null&&m(t,["parameters","addWatermark"],_);const x=g(e,["labels"]);t!==void 0&&x!=null&&m(t,["labels"],x);const C=g(e,["editMode"]);t!==void 0&&C!=null&&m(t,["parameters","editMode"],C);const k=g(e,["baseSteps"]);return t!==void 0&&k!=null&&m(t,["parameters","editConfig","baseSteps"],k),n}function Rtt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>Let(c))),m(n,["instances[0]","referenceImages"],a)}const o=g(t,["config"]);return o!=null&&Att(o,n),n}function Ptt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>fp(s))),m(t,["generatedImages"],r)}return t}function Mtt(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["requests[]","taskType"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["requests[]","title"],r);const s=g(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&m(t,["requests[]","outputDimensionality"],s),g(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Dtt(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["instances[]","task_type"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["instances[]","title"],r);const s=g(e,["outputDimensionality"]);t!==void 0&&s!=null&&m(t,["parameters","outputDimensionality"],s);const o=g(e,["mimeType"]);t!==void 0&&o!=null&&m(t,["instances[]","mimeType"],o);const a=g(e,["autoTruncate"]);return t!==void 0&&a!=null&&m(t,["parameters","autoTruncate"],a),n}function Ltt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let a=ub(e,r);Array.isArray(a)&&(a=a.map(c=>c)),m(n,["requests[]","content"],a)}const s=g(t,["config"]);s!=null&&Mtt(s,n);const o=g(t,["model"]);return o!==void 0&&m(n,["requests[]","model"],te(e,o)),n}function Vtt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let o=ub(e,r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["instances[]","content"],o)}const s=g(t,["config"]);return s!=null&&Dtt(s,n),n}function qtt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["embeddings"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["embeddings"],s)}const r=g(e,["metadata"]);return r!=null&&m(t,["metadata"],r),t}function jtt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions[]","embeddings"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>vtt(o))),m(t,["embeddings"],s)}const r=g(e,["metadata"]);return r!=null&&m(t,["metadata"],r),t}function Ftt(e){const t={},n=g(e,["endpoint"]);n!=null&&m(t,["name"],n);const i=g(e,["deployedModelId"]);return i!=null&&m(t,["deployedModelId"],i),t}function Utt(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Ott(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Btt(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function Gtt(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function Htt(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],gp(Ln(r)));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const w=g(t,["seed"]);w!=null&&m(i,["seed"],w);const _=g(t,["responseMimeType"]);_!=null&&m(i,["responseMimeType"],_);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],db(x));const C=g(t,["responseJsonSchema"]);if(C!=null&&m(i,["responseJsonSchema"],C),g(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=g(t,["safetySettings"]);if(n!==void 0&&k!=null){let L=k;Array.isArray(L)&&(L=L.map(lt=>Vet(lt))),m(n,["safetySettings"],L)}const P=g(t,["tools"]);if(n!==void 0&&P!=null){let L=Il(P);Array.isArray(L)&&(L=L.map(lt=>Get(Sl(lt)))),m(n,["tools"],L)}const A=g(t,["toolConfig"]);if(n!==void 0&&A!=null&&m(n,["toolConfig"],Bet(A)),g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=g(t,["cachedContent"]);n!==void 0&&M!=null&&m(n,["cachedContent"],js(e,M));const N=g(t,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const T=g(t,["mediaResolution"]);T!=null&&m(i,["mediaResolution"],T);const E=g(t,["speechConfig"]);if(E!=null&&m(i,["speechConfig"],gb(E)),g(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=g(t,["thinkingConfig"]);R!=null&&m(i,["thinkingConfig"],R);const D=g(t,["imageConfig"]);D!=null&&m(i,["imageConfig"],yet(D));const F=g(t,["enableEnhancedCivicAnswers"]);return F!=null&&m(i,["enableEnhancedCivicAnswers"],F),i}function $tt(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],Ln(r));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const w=g(t,["seed"]);w!=null&&m(i,["seed"],w);const _=g(t,["responseMimeType"]);_!=null&&m(i,["responseMimeType"],_);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],db(x));const C=g(t,["responseJsonSchema"]);C!=null&&m(i,["responseJsonSchema"],C);const k=g(t,["routingConfig"]);k!=null&&m(i,["routingConfig"],k);const P=g(t,["modelSelectionConfig"]);P!=null&&m(i,["modelConfig"],P);const A=g(t,["safetySettings"]);if(n!==void 0&&A!=null){let Y=A;Array.isArray(Y)&&(Y=Y.map(K=>K)),m(n,["safetySettings"],Y)}const M=g(t,["tools"]);if(n!==void 0&&M!=null){let Y=Il(M);Array.isArray(Y)&&(Y=Y.map(K=>UV(Sl(K)))),m(n,["tools"],Y)}const N=g(t,["toolConfig"]);n!==void 0&&N!=null&&m(n,["toolConfig"],N);const T=g(t,["labels"]);n!==void 0&&T!=null&&m(n,["labels"],T);const E=g(t,["cachedContent"]);n!==void 0&&E!=null&&m(n,["cachedContent"],js(e,E));const R=g(t,["responseModalities"]);R!=null&&m(i,["responseModalities"],R);const D=g(t,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const F=g(t,["speechConfig"]);F!=null&&m(i,["speechConfig"],gb(F));const L=g(t,["audioTimestamp"]);L!=null&&m(i,["audioTimestamp"],L);const lt=g(t,["thinkingConfig"]);lt!=null&&m(i,["thinkingConfig"],lt);const ht=g(t,["imageConfig"]);if(ht!=null&&m(i,["imageConfig"],xet(ht)),g(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function Z1(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let o=Bi(r);Array.isArray(o)&&(o=o.map(a=>gp(a))),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&m(n,["generationConfig"],Htt(e,s,n)),n}function tS(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["contents"]);if(r!=null){let o=Bi(r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&m(n,["generationConfig"],$tt(e,s,n)),n}function eS(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(h=>gtt(h))),m(t,["candidates"],c)}const r=g(e,["modelVersion"]);r!=null&&m(t,["modelVersion"],r);const s=g(e,["promptFeedback"]);s!=null&&m(t,["promptFeedback"],s);const o=g(e,["responseId"]);o!=null&&m(t,["responseId"],o);const a=g(e,["usageMetadata"]);return a!=null&&m(t,["usageMetadata"],a),t}function nS(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(u=>u)),m(t,["candidates"],h)}const r=g(e,["createTime"]);r!=null&&m(t,["createTime"],r);const s=g(e,["modelVersion"]);s!=null&&m(t,["modelVersion"],s);const o=g(e,["promptFeedback"]);o!=null&&m(t,["promptFeedback"],o);const a=g(e,["responseId"]);a!=null&&m(t,["responseId"],a);const c=g(e,["usageMetadata"]);return c!=null&&m(t,["usageMetadata"],c),t}function ztt(e,t){const n={};if(g(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=g(e,["numberOfImages"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["aspectRatio"]);t!==void 0&&r!=null&&m(t,["parameters","aspectRatio"],r);const s=g(e,["guidanceScale"]);if(t!==void 0&&s!=null&&m(t,["parameters","guidanceScale"],s),g(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=g(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&m(t,["parameters","safetySetting"],o);const a=g(e,["personGeneration"]);t!==void 0&&a!=null&&m(t,["parameters","personGeneration"],a);const c=g(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&m(t,["parameters","includeSafetyAttributes"],c);const h=g(e,["includeRaiReason"]);t!==void 0&&h!=null&&m(t,["parameters","includeRaiReason"],h);const u=g(e,["language"]);t!==void 0&&u!=null&&m(t,["parameters","language"],u);const d=g(e,["outputMimeType"]);t!==void 0&&d!=null&&m(t,["parameters","outputOptions","mimeType"],d);const f=g(e,["outputCompressionQuality"]);if(t!==void 0&&f!=null&&m(t,["parameters","outputOptions","compressionQuality"],f),g(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=g(e,["imageSize"]);if(t!==void 0&&v!=null&&m(t,["parameters","sampleImageSize"],v),g(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Ktt(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["negativePrompt"]);t!==void 0&&r!=null&&m(t,["parameters","negativePrompt"],r);const s=g(e,["numberOfImages"]);t!==void 0&&s!=null&&m(t,["parameters","sampleCount"],s);const o=g(e,["aspectRatio"]);t!==void 0&&o!=null&&m(t,["parameters","aspectRatio"],o);const a=g(e,["guidanceScale"]);t!==void 0&&a!=null&&m(t,["parameters","guidanceScale"],a);const c=g(e,["seed"]);t!==void 0&&c!=null&&m(t,["parameters","seed"],c);const h=g(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&m(t,["parameters","safetySetting"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&m(t,["parameters","includeSafetyAttributes"],d);const f=g(e,["includeRaiReason"]);t!==void 0&&f!=null&&m(t,["parameters","includeRaiReason"],f);const v=g(e,["language"]);t!==void 0&&v!=null&&m(t,["parameters","language"],v);const y=g(e,["outputMimeType"]);t!==void 0&&y!=null&&m(t,["parameters","outputOptions","mimeType"],y);const w=g(e,["outputCompressionQuality"]);t!==void 0&&w!=null&&m(t,["parameters","outputOptions","compressionQuality"],w);const _=g(e,["addWatermark"]);t!==void 0&&_!=null&&m(t,["parameters","addWatermark"],_);const x=g(e,["labels"]);t!==void 0&&x!=null&&m(t,["labels"],x);const C=g(e,["imageSize"]);t!==void 0&&C!=null&&m(t,["parameters","sampleImageSize"],C);const k=g(e,["enhancePrompt"]);return t!==void 0&&k!=null&&m(t,["parameters","enhancePrompt"],k),n}function Wtt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["config"]);return s!=null&&ztt(s,n),n}function Qtt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["config"]);return s!=null&&Ktt(s,n),n}function Ytt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>cet(o))),m(t,["generatedImages"],s)}const r=g(e,["positivePromptSafetyAttributes"]);return r!=null&&m(t,["positivePromptSafetyAttributes"],jV(r)),t}function Xtt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>fp(o))),m(t,["generatedImages"],s)}const r=g(e,["positivePromptSafetyAttributes"]);return r!=null&&m(t,["positivePromptSafetyAttributes"],FV(r)),t}function Jtt(e,t){const n={},i=g(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i),g(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=g(e,["durationSeconds"]);if(t!==void 0&&r!=null&&m(t,["parameters","durationSeconds"],r),g(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=g(e,["aspectRatio"]);t!==void 0&&s!=null&&m(t,["parameters","aspectRatio"],s);const o=g(e,["resolution"]);t!==void 0&&o!=null&&m(t,["parameters","resolution"],o);const a=g(e,["personGeneration"]);if(t!==void 0&&a!=null&&m(t,["parameters","personGeneration"],a),g(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=g(e,["negativePrompt"]);t!==void 0&&c!=null&&m(t,["parameters","negativePrompt"],c);const h=g(e,["enhancePrompt"]);if(t!==void 0&&h!=null&&m(t,["parameters","enhancePrompt"],h),g(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const u=g(e,["lastFrame"]);t!==void 0&&u!=null&&m(t,["instances[0]","lastFrame"],mp(u));const d=g(e,["referenceImages"]);if(t!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(v=>nnt(v))),m(t,["instances[0]","referenceImages"],f)}if(g(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Ztt(e,t){const n={},i=g(e,["numberOfVideos"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["outputGcsUri"]);t!==void 0&&r!=null&&m(t,["parameters","storageUri"],r);const s=g(e,["fps"]);t!==void 0&&s!=null&&m(t,["parameters","fps"],s);const o=g(e,["durationSeconds"]);t!==void 0&&o!=null&&m(t,["parameters","durationSeconds"],o);const a=g(e,["seed"]);t!==void 0&&a!=null&&m(t,["parameters","seed"],a);const c=g(e,["aspectRatio"]);t!==void 0&&c!=null&&m(t,["parameters","aspectRatio"],c);const h=g(e,["resolution"]);t!==void 0&&h!=null&&m(t,["parameters","resolution"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["pubsubTopic"]);t!==void 0&&d!=null&&m(t,["parameters","pubsubTopic"],d);const f=g(e,["negativePrompt"]);t!==void 0&&f!=null&&m(t,["parameters","negativePrompt"],f);const v=g(e,["enhancePrompt"]);t!==void 0&&v!=null&&m(t,["parameters","enhancePrompt"],v);const y=g(e,["generateAudio"]);t!==void 0&&y!=null&&m(t,["parameters","generateAudio"],y);const w=g(e,["lastFrame"]);t!==void 0&&w!=null&&m(t,["instances[0]","lastFrame"],Nr(w));const _=g(e,["referenceImages"]);if(t!==void 0&&_!=null){let k=_;Array.isArray(k)&&(k=k.map(P=>int(P))),m(t,["instances[0]","referenceImages"],k)}const x=g(e,["mask"]);t!==void 0&&x!=null&&m(t,["instances[0]","mask"],ent(x));const C=g(e,["compressionQuality"]);return t!==void 0&&C!=null&&m(t,["parameters","compressionQuality"],C),n}function tet(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response","generateVideoResponse"]);return o!=null&&m(t,["response"],ret(o)),t}function eet(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],set(o)),t}function net(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["image"]);s!=null&&m(n,["instances[0]","image"],mp(s));const o=g(t,["video"]);o!=null&&m(n,["instances[0]","video"],OV(o));const a=g(t,["source"]);a!=null&&oet(a,n);const c=g(t,["config"]);return c!=null&&Jtt(c,n),n}function iet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["image"]);s!=null&&m(n,["instances[0]","image"],Nr(s));const o=g(t,["video"]);o!=null&&m(n,["instances[0]","video"],BV(o));const a=g(t,["source"]);a!=null&&aet(a,n);const c=g(t,["config"]);return c!=null&&Ztt(c,n),n}function ret(e){const t={},n=g(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>uet(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function set(e){const t={},n=g(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>det(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function oet(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],mp(r));const s=g(e,["video"]);return t!==void 0&&s!=null&&m(t,["instances[0]","video"],OV(s)),n}function aet(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],Nr(r));const s=g(e,["video"]);return t!==void 0&&s!=null&&m(t,["instances[0]","video"],BV(s)),n}function cet(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["image"],_et(n));const i=g(e,["raiFilteredReason"]);i!=null&&m(t,["raiFilteredReason"],i);const r=g(e,["_self"]);return r!=null&&m(t,["safetyAttributes"],jV(r)),t}function fp(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["image"],qV(n));const i=g(e,["raiFilteredReason"]);i!=null&&m(t,["raiFilteredReason"],i);const r=g(e,["_self"]);r!=null&&m(t,["safetyAttributes"],FV(r));const s=g(e,["prompt"]);return s!=null&&m(t,["enhancedPrompt"],s),t}function het(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["mask"],qV(n));const i=g(e,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(t,["labels"],r)}return t}function uet(e){const t={},n=g(e,["video"]);return n!=null&&m(t,["video"],Zet(n)),t}function det(e){const t={},n=g(e,["_self"]);return n!=null&&m(t,["video"],tnt(n)),t}function get(e){const t={},n=g(e,["modelSelectionConfig"]);n!=null&&m(t,["modelConfig"],n);const i=g(e,["responseJsonSchema"]);i!=null&&m(t,["responseJsonSchema"],i);const r=g(e,["audioTimestamp"]);r!=null&&m(t,["audioTimestamp"],r);const s=g(e,["candidateCount"]);s!=null&&m(t,["candidateCount"],s);const o=g(e,["enableAffectiveDialog"]);o!=null&&m(t,["enableAffectiveDialog"],o);const a=g(e,["frequencyPenalty"]);a!=null&&m(t,["frequencyPenalty"],a);const c=g(e,["logprobs"]);c!=null&&m(t,["logprobs"],c);const h=g(e,["maxOutputTokens"]);h!=null&&m(t,["maxOutputTokens"],h);const u=g(e,["mediaResolution"]);u!=null&&m(t,["mediaResolution"],u);const d=g(e,["presencePenalty"]);d!=null&&m(t,["presencePenalty"],d);const f=g(e,["responseLogprobs"]);f!=null&&m(t,["responseLogprobs"],f);const v=g(e,["responseMimeType"]);v!=null&&m(t,["responseMimeType"],v);const y=g(e,["responseModalities"]);y!=null&&m(t,["responseModalities"],y);const w=g(e,["responseSchema"]);w!=null&&m(t,["responseSchema"],w);const _=g(e,["routingConfig"]);_!=null&&m(t,["routingConfig"],_);const x=g(e,["seed"]);x!=null&&m(t,["seed"],x);const C=g(e,["speechConfig"]);C!=null&&m(t,["speechConfig"],C);const k=g(e,["stopSequences"]);k!=null&&m(t,["stopSequences"],k);const P=g(e,["temperature"]);P!=null&&m(t,["temperature"],P);const A=g(e,["thinkingConfig"]);A!=null&&m(t,["thinkingConfig"],A);const M=g(e,["topK"]);M!=null&&m(t,["topK"],M);const N=g(e,["topP"]);if(N!=null&&m(t,["topP"],N),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function fet(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],te(e,i)),n}function met(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],te(e,i)),n}function pet(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function vet(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function yet(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);if(i!=null&&m(t,["imageSize"],i),g(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function xet(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);i!=null&&m(t,["imageSize"],i);const r=g(e,["personGeneration"]);r!=null&&m(t,["personGeneration"],r);const s=g(e,["outputMimeType"]);s!=null&&m(t,["imageOutputOptions","mimeType"],s);const o=g(e,["outputCompressionQuality"]);return o!=null&&m(t,["imageOutputOptions","compressionQuality"],o),t}function _et(e){const t={},n=g(e,["bytesBase64Encoded"]);n!=null&&m(t,["imageBytes"],Bo(n));const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function qV(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["imageBytes"],Bo(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function mp(e){const t={};if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=g(e,["imageBytes"]);n!=null&&m(t,["bytesBase64Encoded"],Bo(n));const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Nr(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["imageBytes"]);i!=null&&m(t,["bytesBase64Encoded"],Bo(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function wet(e,t,n){const i={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&m(n,["_query","pageSize"],r);const s=g(t,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const o=g(t,["filter"]);n!==void 0&&o!=null&&m(n,["_query","filter"],o);const a=g(t,["queryBase"]);return n!==void 0&&a!=null&&m(n,["_url","models_url"],AV(e,a)),i}function bet(e,t,n){const i={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&m(n,["_query","pageSize"],r);const s=g(t,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const o=g(t,["filter"]);n!==void 0&&o!=null&&m(n,["_query","filter"],o);const a=g(t,["queryBase"]);return n!==void 0&&a!=null&&m(n,["_url","models_url"],AV(e,a)),i}function Tet(e,t){const n={},i=g(t,["config"]);return i!=null&&wet(e,i,n),n}function Cet(e,t){const n={},i=g(t,["config"]);return i!=null&&bet(e,i,n),n}function ket(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["_self"]);if(r!=null){let s=RV(r);Array.isArray(s)&&(s=s.map(o=>o0(o))),m(t,["models"],s)}return t}function Net(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["_self"]);if(r!=null){let s=RV(r);Array.isArray(s)&&(s=s.map(o=>a0(o))),m(t,["models"],s)}return t}function Eet(e){const t={},n=g(e,["maskMode"]);n!=null&&m(t,["maskMode"],n);const i=g(e,["segmentationClasses"]);i!=null&&m(t,["maskClasses"],i);const r=g(e,["maskDilation"]);return r!=null&&m(t,["dilation"],r),t}function o0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);r!=null&&m(t,["description"],r);const s=g(e,["version"]);s!=null&&m(t,["version"],s);const o=g(e,["_self"]);o!=null&&m(t,["tunedModelInfo"],Het(o));const a=g(e,["inputTokenLimit"]);a!=null&&m(t,["inputTokenLimit"],a);const c=g(e,["outputTokenLimit"]);c!=null&&m(t,["outputTokenLimit"],c);const h=g(e,["supportedGenerationMethods"]);h!=null&&m(t,["supportedActions"],h);const u=g(e,["temperature"]);u!=null&&m(t,["temperature"],u);const d=g(e,["maxTemperature"]);d!=null&&m(t,["maxTemperature"],d);const f=g(e,["topP"]);f!=null&&m(t,["topP"],f);const v=g(e,["topK"]);v!=null&&m(t,["topK"],v);const y=g(e,["thinking"]);return y!=null&&m(t,["thinking"],y),t}function a0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);r!=null&&m(t,["description"],r);const s=g(e,["versionId"]);s!=null&&m(t,["version"],s);const o=g(e,["deployedModels"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Ftt(f))),m(t,["endpoints"],d)}const a=g(e,["labels"]);a!=null&&m(t,["labels"],a);const c=g(e,["_self"]);c!=null&&m(t,["tunedModelInfo"],$et(c));const h=g(e,["defaultCheckpointId"]);h!=null&&m(t,["defaultCheckpointId"],h);const u=g(e,["checkpoints"]);if(u!=null){let d=u;Array.isArray(d)&&(d=d.map(f=>f)),m(t,["checkpoints"],d)}return t}function Iet(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],Utt(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],Ott(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],dtt(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function Aet(e){const t={},n=g(e,["productImage"]);return n!=null&&m(t,["image"],Nr(n)),t}function Ret(e,t){const n={},i=g(e,["numberOfImages"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["baseSteps"]);t!==void 0&&r!=null&&m(t,["parameters","baseSteps"],r);const s=g(e,["outputGcsUri"]);t!==void 0&&s!=null&&m(t,["parameters","storageUri"],s);const o=g(e,["seed"]);t!==void 0&&o!=null&&m(t,["parameters","seed"],o);const a=g(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&m(t,["parameters","safetySetting"],a);const c=g(e,["personGeneration"]);t!==void 0&&c!=null&&m(t,["parameters","personGeneration"],c);const h=g(e,["addWatermark"]);t!==void 0&&h!=null&&m(t,["parameters","addWatermark"],h);const u=g(e,["outputMimeType"]);t!==void 0&&u!=null&&m(t,["parameters","outputOptions","mimeType"],u);const d=g(e,["outputCompressionQuality"]);t!==void 0&&d!=null&&m(t,["parameters","outputOptions","compressionQuality"],d);const f=g(e,["enhancePrompt"]);t!==void 0&&f!=null&&m(t,["parameters","enhancePrompt"],f);const v=g(e,["labels"]);return t!==void 0&&v!=null&&m(t,["labels"],v),n}function Pet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["source"]);r!=null&&Det(r,n);const s=g(t,["config"]);return s!=null&&Ret(s,n),n}function Met(e){const t={},n=g(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>fp(r))),m(t,["generatedImages"],i)}return t}function Det(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["personImage"]);t!==void 0&&r!=null&&m(t,["instances[0]","personImage","image"],Nr(r));const s=g(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Aet(a))),m(t,["instances[0]","productImages"],o)}return n}function Let(e){const t={},n=g(e,["referenceImage"]);n!=null&&m(t,["referenceImage"],Nr(n));const i=g(e,["referenceId"]);i!=null&&m(t,["referenceId"],i);const r=g(e,["referenceType"]);r!=null&&m(t,["referenceType"],r);const s=g(e,["maskImageConfig"]);s!=null&&m(t,["maskImageConfig"],Eet(s));const o=g(e,["controlImageConfig"]);o!=null&&m(t,["controlImageConfig"],xtt(o));const a=g(e,["styleImageConfig"]);a!=null&&m(t,["styleImageConfig"],a);const c=g(e,["subjectImageConfig"]);return c!=null&&m(t,["subjectImageConfig"],c),t}function jV(e){const t={},n=g(e,["safetyAttributes","categories"]);n!=null&&m(t,["categories"],n);const i=g(e,["safetyAttributes","scores"]);i!=null&&m(t,["scores"],i);const r=g(e,["contentType"]);return r!=null&&m(t,["contentType"],r),t}function FV(e){const t={},n=g(e,["safetyAttributes","categories"]);n!=null&&m(t,["categories"],n);const i=g(e,["safetyAttributes","scores"]);i!=null&&m(t,["scores"],i);const r=g(e,["contentType"]);return r!=null&&m(t,["contentType"],r),t}function Vet(e){const t={},n=g(e,["category"]);if(n!=null&&m(t,["category"],n),g(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(e,["threshold"]);return i!=null&&m(t,["threshold"],i),t}function qet(e){const t={},n=g(e,["image"]);return n!=null&&m(t,["image"],Nr(n)),t}function jet(e,t){const n={},i=g(e,["mode"]);t!==void 0&&i!=null&&m(t,["parameters","mode"],i);const r=g(e,["maxPredictions"]);t!==void 0&&r!=null&&m(t,["parameters","maxPredictions"],r);const s=g(e,["confidenceThreshold"]);t!==void 0&&s!=null&&m(t,["parameters","confidenceThreshold"],s);const o=g(e,["maskDilation"]);t!==void 0&&o!=null&&m(t,["parameters","maskDilation"],o);const a=g(e,["binaryColorThreshold"]);t!==void 0&&a!=null&&m(t,["parameters","binaryColorThreshold"],a);const c=g(e,["labels"]);return t!==void 0&&c!=null&&m(t,["labels"],c),n}function Fet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["source"]);r!=null&&Oet(r,n);const s=g(t,["config"]);return s!=null&&jet(s,n),n}function Uet(e){const t={},n=g(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>het(r))),m(t,["generatedMasks"],i)}return t}function Oet(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],Nr(r));const s=g(e,["scribbleImage"]);return t!==void 0&&s!=null&&m(t,["instances[0]","scribble"],qet(s)),n}function Bet(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],Btt(i)),t}function Get(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],pet(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],vet(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function UV(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Gtt(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function Het(e){const t={},n=g(e,["baseModel"]);n!=null&&m(t,["baseModel"],n);const i=g(e,["createTime"]);i!=null&&m(t,["createTime"],i);const r=g(e,["updateTime"]);return r!=null&&m(t,["updateTime"],r),t}function $et(e){const t={},n=g(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(t,["baseModel"],n);const i=g(e,["createTime"]);i!=null&&m(t,["createTime"],i);const r=g(e,["updateTime"]);return r!=null&&m(t,["updateTime"],r),t}function zet(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);t!==void 0&&r!=null&&m(t,["description"],r);const s=g(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&m(t,["defaultCheckpointId"],s),n}function Ket(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);t!==void 0&&r!=null&&m(t,["description"],r);const s=g(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&m(t,["defaultCheckpointId"],s),n}function Wet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","name"],te(e,i));const r=g(t,["config"]);return r!=null&&zet(r,n),n}function Qet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["config"]);return r!=null&&Ket(r,n),n}function Yet(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["safetyFilterLevel"]);t!==void 0&&r!=null&&m(t,["parameters","safetySetting"],r);const s=g(e,["personGeneration"]);t!==void 0&&s!=null&&m(t,["parameters","personGeneration"],s);const o=g(e,["includeRaiReason"]);t!==void 0&&o!=null&&m(t,["parameters","includeRaiReason"],o);const a=g(e,["outputMimeType"]);t!==void 0&&a!=null&&m(t,["parameters","outputOptions","mimeType"],a);const c=g(e,["outputCompressionQuality"]);t!==void 0&&c!=null&&m(t,["parameters","outputOptions","compressionQuality"],c);const h=g(e,["enhanceInputImage"]);t!==void 0&&h!=null&&m(t,["parameters","upscaleConfig","enhanceInputImage"],h);const u=g(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&m(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const d=g(e,["labels"]);t!==void 0&&d!=null&&m(t,["labels"],d);const f=g(e,["numberOfImages"]);t!==void 0&&f!=null&&m(t,["parameters","sampleCount"],f);const v=g(e,["mode"]);return t!==void 0&&v!=null&&m(t,["parameters","mode"],v),n}function Xet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],te(e,i));const r=g(t,["image"]);r!=null&&m(n,["instances[0]","image"],Nr(r));const s=g(t,["upscaleFactor"]);s!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=g(t,["config"]);return o!=null&&Yet(o,n),n}function Jet(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>fp(s))),m(t,["generatedImages"],r)}return t}function Zet(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["encodedVideo"]);i!=null&&m(t,["videoBytes"],Bo(i));const r=g(e,["encoding"]);return r!=null&&m(t,["mimeType"],r),t}function tnt(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["uri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["videoBytes"],Bo(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function ent(e){const t={},n=g(e,["image"]);n!=null&&m(t,["_self"],Nr(n));const i=g(e,["maskMode"]);return i!=null&&m(t,["maskMode"],i),t}function nnt(e){const t={},n=g(e,["image"]);n!=null&&m(t,["image"],mp(n));const i=g(e,["referenceType"]);return i!=null&&m(t,["referenceType"],i),t}function int(e){const t={},n=g(e,["image"]);n!=null&&m(t,["image"],Nr(n));const i=g(e,["referenceType"]);return i!=null&&m(t,["referenceType"],i),t}function OV(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["videoBytes"]);i!=null&&m(t,["encodedVideo"],Bo(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["encoding"],r),t}function BV(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["videoBytes"]);i!=null&&m(t,["bytesBase64Encoded"],Bo(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rnt(e,t){const n={},i=g(e,["displayName"]);return t!==void 0&&i!=null&&m(t,["displayName"],i),n}function snt(e){const t={},n=g(e,["config"]);return n!=null&&rnt(n,t),t}function ont(e,t){const n={},i=g(e,["force"]);return t!==void 0&&i!=null&&m(t,["_query","force"],i),n}function ant(e){const t={},n=g(e,["name"]);n!=null&&m(t,["_url","name"],n);const i=g(e,["config"]);return i!=null&&ont(i,t),t}function cnt(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","name"],n),t}function lnt(e,t){const n={},i=g(e,["customMetadata"]);if(t!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["customMetadata"],s)}const r=g(e,["chunkingConfig"]);return t!==void 0&&r!=null&&m(t,["chunkingConfig"],r),n}function hnt(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],dnt(o)),t}function unt(e){const t={},n=g(e,["fileSearchStoreName"]);n!=null&&m(t,["_url","file_search_store_name"],n);const i=g(e,["fileName"]);i!=null&&m(t,["fileName"],i);const r=g(e,["config"]);return r!=null&&lnt(r,t),t}function dnt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function gnt(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function fnt(e){const t={},n=g(e,["config"]);return n!=null&&gnt(n,t),t}function mnt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["fileSearchStores"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["fileSearchStores"],s)}return t}function GV(e,t){const n={},i=g(e,["mimeType"]);t!==void 0&&i!=null&&m(t,["mimeType"],i);const r=g(e,["displayName"]);t!==void 0&&r!=null&&m(t,["displayName"],r);const s=g(e,["customMetadata"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),m(t,["customMetadata"],a)}const o=g(e,["chunkingConfig"]);return t!==void 0&&o!=null&&m(t,["chunkingConfig"],o),n}function pnt(e){const t={},n=g(e,["fileSearchStoreName"]);n!=null&&m(t,["_url","file_search_store_name"],n);const i=g(e,["config"]);return i!=null&&GV(i,t),t}function vnt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ynt="Content-Type",xnt="X-Server-Timeout",_nt="User-Agent",c0="x-goog-api-client",wnt="1.37.0",bnt=`google-genai-sdk/${wnt}`,Tnt="v1beta1",Cnt="v1beta";class knt{constructor(t){var n,i;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Tnt,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Cnt,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&i.push(t.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,i){const r=[this.getRequestUrlInternal(n)];return i&&r.push(this.getBaseResourcePath()),t!==""&&r.push(t),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,n,i);if(t.queryParams)for(const[o,a]of Object.entries(t.queryParams))r.searchParams.append(o,String(a));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,r.toString(),t.abortSignal),this.unaryApiCall(r,s,t.httpMethod)}patchHttpOptions(t,n){const i=JSON.parse(JSON.stringify(t));for(const[r,s]of Object.entries(n))typeof s=="object"?i[r]=Object.assign(Object.assign({},i[r]),s):s!==void 0&&(i[r]=s);return i}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,n,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,r.toString(),t.abortSignal),this.streamApiCall(r,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,i,r){if(n&&n.timeout||r){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}r&&r.addEventListener("abort",()=>{s.abort()}),t.signal=o}return n&&n.extraBody!==null&&Nnt(t,n.extraBody),t.headers=await this.getHeadersInternal(n,i),t}async unaryApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await iS(r),new i0(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await iS(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(t){return _r(this,arguments,function*(){var i;const r=(i=t==null?void 0:t.body)===null||i===void 0?void 0:i.getReader(),s=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let o="";const a="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:u}=yield Dt(r.read());if(h){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(u,{stream:!0});try{const y=JSON.parse(d);if("error"in y){const w=JSON.parse(JSON.stringify(y.error)),_=w.status,x=w.code,C=`got status: ${_}. ${JSON.stringify(y)}`;if(x>=400&&x<600)throw new dp({message:C,status:x})}}catch(y){if(y.name==="ApiError")throw y}o+=d;let f=-1,v=0;for(;;){f=-1,v=0;for(const _ of c){const x=o.indexOf(_);x!==-1&&(f===-1||x<f)&&(f=x,v=_.length)}if(f===-1)break;const y=o.substring(0,f);o=o.substring(f+v);const w=y.trim();if(w.startsWith(a)){const _=w.substring(a.length).trim();try{const x=new Response(_,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Dt(new i0(x))}catch(x){throw new Error(`exception parsing stream chunk ${_}. ${x}`)}}}}}finally{r.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const t={},n=bnt+" "+this.clientOptions.userAgentExtra;return t[_nt]=n,t[c0]=n,t[ynt]="application/json",t}async getHeadersInternal(t,n){const i=new Headers;if(t&&t.headers){for(const[r,s]of Object.entries(t.headers))i.append(r,s);t.timeout&&t.timeout>0&&i.append(xnt,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,n),i}getFileName(t){var n;let i="";return typeof t=="string"&&(i=t.replace(/[/\\]+$/,""),i=(n=i.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),i}async uploadFile(t,n){var i;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);r.sizeBytes=String(o.size);const a=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;const c={file:r},h=this.getFileName(t),u=gt("upload/v1beta/files",c._url),d=await this.fetchUploadUrl(u,r.sizeBytes,r.mimeType,h,c,n==null?void 0:n.httpOptions);return s.upload(t,d,this)}async uploadFileToFileSearchStore(t,n,i){var r;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),c=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:o.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${t}:uploadToFileSearchStore`,u=this.getFileName(n),d={};i!=null&&GV(i,d);const f=await this.fetchUploadUrl(h,a,c,u,d,i==null?void 0:i.httpOptions);return s.uploadToFileSearchStore(n,f,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,i,r,s,o){var a;let c={};o?c=o:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const h=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:c});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(a=h==null?void 0:h.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function iS(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let i;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await e.json():i={error:{message:await e.text(),code:e.status,status:e.statusText}};const r=JSON.stringify(i);throw n>=400&&n<600?new dp({message:r,status:n}):new Error(r)}}function Nnt(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(s,o){const a=Object.assign({},s);for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const h=o[c],u=a[c];h&&typeof h=="object"&&!Array.isArray(h)&&u&&typeof u=="object"&&!Array.isArray(u)?a[c]=i(u,h):(u&&h&&typeof u!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof u}, New type: ${typeof h}. Overwriting.`),a[c]=h)}return a}const r=i(n,t);e.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ent="mcp_used/unknown";let Snt=!1;function HV(e){for(const t of e)if(Int(t)||typeof t=="object"&&"inputSchema"in t)return!0;return Snt}function $V(e){var t;const n=(t=e[c0])!==null&&t!==void 0?t:"";e[c0]=(n+` ${Ent}`).trimStart()}function Int(e){return e!==null&&typeof e=="object"&&e instanceof mb}function Ant(e){return _r(this,arguments,function*(n,i=100){let r,s=0;for(;s<i;){const o=yield Dt(n.listTools({cursor:r}));for(const a of o.tools)yield yield Dt(a),s++;if(!o.nextCursor)break;r=o.nextCursor}})}class mb{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new mb(t,n)}async initialize(){var t,n,i,r;if(this.mcpTools.length>0)return;const s={},o=[];for(const u of this.mcpClients)try{for(var a=!0,c=(n=void 0,wr(Ant(u))),h;h=await c.next(),t=h.done,!t;a=!0){r=h.value,a=!1;const d=r;o.push(d);const f=d.name;if(s[f])throw new Error(`Duplicate function name ${f} found in MCP tools. Please ensure function names are unique.`);s[f]=u}}catch(d){n={error:d}}finally{try{!a&&!t&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),sJ(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const i of t)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await r.callTool({name:i.name,arguments:i.args},void 0,s);n.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Rnt(e,t,n){const i=new XX;let r;n.data instanceof Blob?r=JSON.parse(await n.data.text()):r=JSON.parse(n.data),Object.assign(i,r),t(i)}class Pnt{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i}async connect(t){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=Lnt(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let h=()=>{};const u=new Promise(k=>{h=k}),d=t.callbacks,f=function(){h({})},v=this.apiClient,y={onopen:f,onmessage:k=>{Rnt(v,d.onmessage,k)},onerror:(n=d==null?void 0:d.onerror)!==null&&n!==void 0?n:function(k){},onclose:(i=d==null?void 0:d.onclose)!==null&&i!==void 0?i:function(k){}},w=this.webSocketFactory.create(c,Dnt(o),y);w.connect(),await u;const C={setup:{model:te(this.apiClient,t.model)}};return w.send(JSON.stringify(C)),new Mnt(w,this.apiClient)}}class Mnt{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=ntt(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=ett(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(xc.PLAY)}pause(){this.sendPlaybackControl(xc.PAUSE)}stop(){this.sendPlaybackControl(xc.STOP)}resetContext(){this.sendPlaybackControl(xc.RESET_CONTEXT)}close(){this.conn.close()}}function Dnt(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function Lnt(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vnt="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function qnt(e,t,n){const i=new YX;let r;n.data instanceof Blob?r=await n.data.text():n.data instanceof ArrayBuffer?r=new TextDecoder().decode(n.data):r=n.data;const s=JSON.parse(r);if(e.isVertexAI()){const o=stt(s);Object.assign(i,o)}else Object.assign(i,s);t(i)}class jnt{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i,this.music=new Pnt(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,i,r,s,o,a;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let u;const d=this.apiClient.getHeaders();t.config&&t.config.tools&&HV(t.config.tools)&&$V(d);const f=Bnt(d);if(this.apiClient.isVertexAI())u=`${c}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(f,u);else{const E=this.apiClient.getApiKey();let R="BidiGenerateContent",D="key";E!=null&&E.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),R="BidiGenerateContentConstrained",D="access_token"),u=`${c}/ws/google.ai.generativelanguage.${h}.GenerativeService.${R}?${D}=${E}`}let v=()=>{};const y=new Promise(E=>{v=E}),w=t.callbacks,_=function(){var E;(E=w==null?void 0:w.onopen)===null||E===void 0||E.call(w),v({})},x=this.apiClient,C={onopen:_,onmessage:E=>{qnt(x,w.onmessage,E)},onerror:(n=w==null?void 0:w.onerror)!==null&&n!==void 0?n:function(E){},onclose:(i=w==null?void 0:w.onclose)!==null&&i!==void 0?i:function(E){}},k=this.webSocketFactory.create(u,Ont(f),C);k.connect(),await y;let P=te(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const E=this.apiClient.getProject(),R=this.apiClient.getLocation();P=`projects/${E}/locations/${R}/`+P}let A={};this.apiClient.isVertexAI()&&((r=t.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Wf.AUDIO]}:t.config.responseModalities=[Wf.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],N=[];for(const E of M)if(this.isCallableTool(E)){const R=E;N.push(await R.tool())}else N.push(E);N.length>0&&(t.config.tools=N);const T={model:P,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?A=ttt(this.apiClient,T):A=ZZ(this.apiClient,T),delete A.config,k.send(JSON.stringify(A)),new Unt(k,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const Fnt={turnComplete:!0};class Unt{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Bi(n.turns),t.isVertexAI()||(i=i.map(r=>gp(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const s of i){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(Vnt)}return{toolResponse:{functionResponses:i}}}sendClientContent(t){t=Object.assign(Object.assign({},Fnt),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rtt(t)}:n={realtimeInput:itt(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Ont(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function Bnt(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rS=10;function sS(e){var t,n,i;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let r=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Oc(o)){r=!0;break}if(!r)return!0;const s=(i=e==null?void 0:e.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Oc(e){return"callTool"in e&&typeof e.callTool=="function"}function Gnt(e){var t,n,i;return(i=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(r=>Oc(r)))!==null&&i!==void 0?i:!1}function oS(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((i,r)=>{if(Oc(i))return;const s=i;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(r)}),n}function aS(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hnt extends qs{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var i,r,s,o,a;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!Gnt(n)||sS(n.config))return await this.generateContentInternal(c);const h=oS(n);if(h.length>0){const w=h.map(_=>`tools[${_}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${w}.`)}let u,d;const f=Bi(c.contents),v=(s=(r=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:rS;let y=0;for(;y<v&&(u=await this.generateContentInternal(c),!(!u.functionCalls||u.functionCalls.length===0));){const w=u.candidates[0].content,_=[];for(const x of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(Oc(x)){const k=await x.callTool(u.functionCalls);_.push(...k)}y++,d={role:"user",parts:_},c.contents=Bi(c.contents),c.contents.push(w),c.contents.push(d),aS(c.config)&&(f.push(w),f.push(d))}return aS(c.config)&&(u.automaticFunctionCallingHistory=f),u},this.generateContentStream=async n=>{var i,r,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),sS(n.config)){const d=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(d)}const c=oS(n);if(c.length>0){const d=c.map(f=>`tools[${f}]`).join(", ");throw new Error(`Incompatible tools found at ${d}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(s=(r=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,u=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(h&&!u)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var r;let s;const o=[];if(i!=null&&i.generatedImages)for(const c of i.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((r=c==null?void 0:c.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?s=c==null?void 0:c.safetyAttributes:o.push(c);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async n=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ga(As.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const r={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async n=>{var i,r,s,o,a,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=n.video)===null||i===void 0)&&i.uri&&(!((r=n.video)===null||r===void 0)&&r.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,i,r;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async c=>Oc(c)?await c.tool():c)),a={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(a.config.tools=o,t.config&&t.config.tools&&HV(t.config.tools)){const c=(r=(i=t.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let h=Object.assign({},c);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),$V(h),a.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return a}async initAfcToolsMap(t){var n,i,r;const s=new Map;for(const o of(i=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if(Oc(o)){const a=o,c=await a.tool();for(const h of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!h.name)throw new Error("Function declaration name is required.");if(s.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);s.set(h.name,a)}}return s}async processAfcStream(t){var n,i,r;const s=(r=(i=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:rS;let o=!1,a=0;const c=await this.initAfcToolsMap(t);return function(h,u,d){return _r(this,arguments,function*(){for(var f,v,y,w,_,x;a<s;){o&&(a++,o=!1);const A=yield Dt(h.processParamsMaybeAddMcpUsage(d)),M=yield Dt(h.generateContentStreamInternal(A)),N=[],T=[];try{for(var C=!0,k=(v=void 0,wr(M)),P;P=yield Dt(k.next()),f=P.done,!f;C=!0){w=P.value,C=!1;const E=w;if(yield yield Dt(E),E.candidates&&(!((_=E.candidates[0])===null||_===void 0)&&_.content)){T.push(E.candidates[0].content);for(const R of(x=E.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<s&&R.functionCall){if(!R.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(R.functionCall.name)){const D=yield Dt(u.get(R.functionCall.name).callTool([R.functionCall]));N.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${R.functionCall.name}`)}}}}catch(E){v={error:E}}finally{try{!C&&!f&&(y=k.return)&&(yield Dt(y.call(k)))}finally{if(v)throw v.error}}if(N.length>0){o=!0;const E=new ch;E.candidates=[{content:{role:"user",parts:N}}],yield yield Dt(E);const R=[];R.push(...T),R.push({role:"user",parts:N});const D=Bi(d.contents).concat(R);d.contents=D}else break}})}(this,c,t)}async generateContentInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=tS(this.apiClient,t);return a=gt("{model}:generateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=nS(u),f=new ch;return Object.assign(f,d),f})}else{const h=Z1(this.apiClient,t);return a=gt("{model}:generateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=eS(u),f=new ch;return Object.assign(f,d),f})}}async generateContentStreamInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=tS(this.apiClient,t);return a=gt("{model}:streamGenerateContent?alt=sse",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(d){return _r(this,arguments,function*(){var f,v,y,w;try{for(var _=!0,x=wr(d),C;C=yield Dt(x.next()),f=C.done,!f;_=!0){w=C.value,_=!1;const k=w,P=nS(yield Dt(k.json()));P.sdkHttpResponse={headers:k.headers};const A=new ch;Object.assign(A,P),yield yield Dt(A)}}catch(k){v={error:k}}finally{try{!_&&!f&&(y=x.return)&&(yield Dt(y.call(x)))}finally{if(v)throw v.error}}})})}else{const h=Z1(this.apiClient,t);return a=gt("{model}:streamGenerateContent?alt=sse",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(d){return _r(this,arguments,function*(){var f,v,y,w;try{for(var _=!0,x=wr(d),C;C=yield Dt(x.next()),f=C.done,!f;_=!0){w=C.value,_=!1;const k=w,P=eS(yield Dt(k.json()));P.sdkHttpResponse={headers:k.headers};const A=new ch;Object.assign(A,P),yield yield Dt(A)}}catch(k){v={error:k}}finally{try{!_&&!f&&(y=x.return)&&(yield Dt(y.call(x)))}finally{if(v)throw v.error}}})})}}async embedContent(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Vtt(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=jtt(u),f=new V1;return Object.assign(f,d),f})}else{const h=Ltt(this.apiClient,t);return a=gt("{model}:batchEmbedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=qtt(u),f=new V1;return Object.assign(f,d),f})}}async generateImagesInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Qtt(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Xtt(u),f=new q1;return Object.assign(f,d),f})}else{const h=Wtt(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Ytt(u),f=new q1;return Object.assign(f,d),f})}}async editImageInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Rtt(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=Ptt(c),u=new FX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Xet(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=Jet(c),u=new UX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Pet(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Met(c),u=new OX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Fet(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Uet(c),u=new BX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=met(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>a0(u))}else{const h=fet(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>o0(u))}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Cet(this.apiClient,t);return a=gt("{models_url}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Net(u),f=new j1;return Object.assign(f,d),f})}else{const h=Tet(this.apiClient,t);return a=gt("{models_url}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ket(u),f=new j1;return Object.assign(f,d),f})}}async update(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Qet(this.apiClient,t);return a=gt("{model}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>a0(u))}else{const h=Wet(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>o0(u))}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Ett(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Itt(u),f=new F1;return Object.assign(f,d),f})}else{const h=Ntt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Stt(u),f=new F1;return Object.assign(f,d),f})}}async countTokens(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Ttt(this.apiClient,t);return a=gt("{model}:countTokens",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ktt(u),f=new U1;return Object.assign(f,d),f})}else{const h=btt(this.apiClient,t);return a=gt("{model}:countTokens",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Ctt(u),f=new U1;return Object.assign(f,d),f})}}async computeTokens(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=mtt(this.apiClient,t);return s=gt("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=ptt(c),u=new GX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=iet(this.apiClient,t);return a=gt("{model}:predictLongRunning",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=eet(u),f=new Qf;return Object.assign(f,d),f})}else{const h=net(this.apiClient,t);return a=gt("{model}:predictLongRunning",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>{const d=tet(u),f=new Qf;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $nt extends qs{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let s;i&&"httpOptions"in i&&(s=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let s;i&&"httpOptions"in i&&(s=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=MX(t);return a=gt("{operationName}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o}else{const h=PX(t);return a=gt("{operationName}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o}}async fetchPredictVideosOperationInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=kX(t);return s=gt("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function znt(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Knt(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>nit(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function Wnt(e,t,n){const i={},r=g(t,["expireTime"]);n!==void 0&&r!=null&&m(n,["expireTime"],r);const s=g(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&m(n,["newSessionExpireTime"],s);const o=g(t,["uses"]);n!==void 0&&o!=null&&m(n,["uses"],o);const a=g(t,["liveConnectConstraints"]);n!==void 0&&a!=null&&m(n,["bidiGenerateContentSetup"],eit(e,a));const c=g(t,["lockAdditionalFields"]);return n!==void 0&&c!=null&&m(n,["fieldMask"],c),i}function Qnt(e,t){const n={},i=g(t,["config"]);return i!=null&&m(n,["config"],Wnt(e,i,n)),n}function Ynt(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Xnt(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Jnt(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function Znt(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function tit(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],i);const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],fb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],Knt(Ln(y)));const w=g(e,["tools"]);if(t!==void 0&&w!=null){let M=Il(w);Array.isArray(M)&&(M=M.map(N=>rit(Sl(N)))),m(t,["setup","tools"],M)}const _=g(e,["sessionResumption"]);t!==void 0&&_!=null&&m(t,["setup","sessionResumption"],iit(_));const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);if(t!==void 0&&A!=null&&m(t,["setup","proactivity"],A),g(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function eit(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],te(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],tit(r,n)),n}function nit(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],Ynt(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],Xnt(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],znt(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function iit(e){const t={},n=g(e,["handle"]);if(n!=null&&m(t,["handle"],n),g(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function rit(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],Jnt(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],Znt(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sit(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(s=>`${n}.${s}`);t.push(...r)}else t.push(n)}return t.join(",")}function oit(e,t){let n=null;const i=e.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const s=i.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else i!==void 0&&delete e.bidiGenerateContentSetup;const r=e.fieldMask;if(n){const s=sit(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];r.length>0&&(a=r.map(h=>o.includes(h)?`generationConfig.${h}`:h));const c=[];s&&c.push(s),a.length>0&&c.push(...a),c.length>0?e.fieldMask=c.join(","):delete e.fieldMask}else delete e.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?e.fieldMask=r.join(","):delete e.fieldMask;return e}class ait extends qs{constructor(t){super(),this.apiClient=t}async create(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=Qnt(this.apiClient,t);s=gt("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const c=oit(a,t.config);return r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),r.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cit(e,t){const n={},i=g(e,["force"]);return t!==void 0&&i!=null&&m(t,["_query","force"],i),n}function lit(e){const t={},n=g(e,["name"]);n!=null&&m(t,["_url","name"],n);const i=g(e,["config"]);return i!=null&&cit(i,t),t}function hit(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","name"],n),t}function uit(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function dit(e){const t={},n=g(e,["parent"]);n!=null&&m(t,["_url","parent"],n);const i=g(e,["config"]);return i!=null&&uit(i,t),t}function git(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["documents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fit extends qs{constructor(t){super(),this.apiClient=t,this.list=async n=>new Ga(As.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:n.parent,config:i.config}),await this.listInternal(n),n)}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=hit(t);return s=gt("{name}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=lit(t);r=gt("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=dit(t);return s=gt("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=git(c),u=new HX;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mit extends qs{constructor(t,n=new fit(t)){super(),this.apiClient=t,this.documents=n,this.list=async(i={})=>new Ga(As.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=snt(t);return s=gt("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cnt(t);return s=gt("{name}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=ant(t);r=gt("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=fnt(t);return s=gt("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=mnt(c),u=new $X;return Object.assign(u,h),u})}}async uploadToFileSearchStoreInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pnt(t);return s=gt("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=vnt(c),u=new zX;return Object.assign(u,h),u})}}async importFile(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=unt(t);return s=gt("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=hnt(c),u=new lb;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let zV=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return zV=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^n()&15>>+i/4).toString(16))};const pit=()=>zV();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function l0(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const h0=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qi extends Error{}class Wn extends Qi{constructor(t,n,i,r){super(`${Wn.makeMessage(t,n,i)}`),this.status=t,this.headers=r,this.error=n}static makeMessage(t,n,i){const r=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,n,i,r){if(!t||!r)return new pp({message:i,cause:h0(n)});const s=n;return t===400?new WV(t,s,i,r):t===401?new QV(t,s,i,r):t===403?new YV(t,s,i,r):t===404?new XV(t,s,i,r):t===409?new JV(t,s,i,r):t===422?new ZV(t,s,i,r):t===429?new tq(t,s,i,r):t>=500?new eq(t,s,i,r):new Wn(t,s,i,r)}}class u0 extends Wn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class pp extends Wn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class KV extends pp{constructor({message:t}={}){super({message:t??"Request timed out."})}}class WV extends Wn{}class QV extends Wn{}class YV extends Wn{}class XV extends Wn{}class JV extends Wn{}class ZV extends Wn{}class tq extends Wn{}class eq extends Wn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vit=/^[a-z][a-z0-9+.-]*:/i,yit=e=>vit.test(e);let d0=e=>(d0=Array.isArray,d0(e));const xit=d0;let _it=xit;const cS=_it;function wit(e){if(!e)return!0;for(const t in e)return!1;return!0}function bit(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Tit=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Qi(`${e} must be an integer`);if(t<0)throw new Qi(`${e} must be a positive integer`);return t},Cit=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kit=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nc="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nit(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Eit=()=>{var e,t,n,i,r;const s=Nit();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":nc,"X-Stainless-OS":hS(Deno.build.os),"X-Stainless-Arch":lS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":nc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":nc,"X-Stainless-OS":hS((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":lS((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const o=Sit();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":nc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":nc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Sit(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const i=n.exec(navigator.userAgent);if(i){const r=i[1]||0,s=i[2]||0,o=i[3]||0;return{browser:t,version:`${r}.${s}.${o}`}}}return null}const lS=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",hS=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Xd;const Iit=()=>Xd??(Xd=Eit());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ait(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function nq(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function Rit(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return nq({start(){},async pull(n){const{done:i,value:r}=await t.next();i?n.close():n.enqueue(r)},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}function iq(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Pit(e){var t,n;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((n=(t=e[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(t));return}const i=e.getReader(),r=i.cancel();i.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mit=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rq=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Gv(e,t,n){return rq(),new File(e,t??"unknown_file",n)}function Dit(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Lit=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sq=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Vit=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&sq(e),qit=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function jit(e,t,n){if(rq(),e=await e,Vit(e))return e instanceof File?e:Gv([await e.arrayBuffer()],e.name);if(qit(e)){const r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Gv(await g0(r),t,n)}const i=await g0(e);if(t||(t=Dit(e)),!(n!=null&&n.type)){const r=i.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof r=="string"&&(n=Object.assign(Object.assign({},n),{type:r}))}return Gv(i,t,n)}async function g0(e){var t,n,i,r,s;let o=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)o.push(e);else if(sq(e))o.push(e instanceof Blob?e:await e.arrayBuffer());else if(Lit(e))try{for(var a=!0,c=wr(e),h;h=await c.next(),t=h.done,!t;a=!0){r=h.value,a=!1;const u=r;o.push(...await g0(u))}}catch(u){n={error:u}}finally{try{!a&&!t&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}else{const u=(s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${u?`; constructor: ${u}`:""}${Fit(e)}`)}return o}function Fit(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oq{constructor(t){this._client=t}}oq._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aq(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const uS=Object.freeze(Object.create(null)),Uit=(e=aq)=>function(n,...i){if(n.length===1)return n[0];let r=!1;const s=[],o=n.reduce((u,d,f)=>{var v,y,w;/[?#]/.test(d)&&(r=!0);const _=i[f];let x=(r?encodeURIComponent:e)(""+_);return f!==i.length&&(_==null||typeof _=="object"&&_.toString===((w=Object.getPrototypeOf((y=Object.getPrototypeOf((v=_.hasOwnProperty)!==null&&v!==void 0?v:uS))!==null&&y!==void 0?y:uS))===null||w===void 0?void 0:w.toString))&&(x=_+"",s.push({start:u.length+d.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),u+d+(f===i.length?"":x)},""),a=o.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=c.exec(a))!==null;)s.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(s.sort((u,d)=>u.start-d.start),s.length>0){let u=0;const d=s.reduce((f,v)=>{const y=" ".repeat(v.start-u),w="^".repeat(v.length);return u=v.start+v.length,f+y+w},"");throw new Qi(`Path parameters result in path with invalid segments:
${s.map(f=>f.error).join(`
`)}
${o}
${d}`)}return o},Jd=Uit(aq);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cq extends oq{create(t,n){var i;const{api_version:r=this._client.apiVersion}=t,s=Xf(t,["api_version"]);if("model"in s&&"agent_config"in s)throw new Qi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new Qi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Jd`/${r}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(i=t.stream)!==null&&i!==void 0?i:!1}))}delete(t,n={},i){const{api_version:r=this._client.apiVersion}=n??{};return this._client.delete(Jd`/${r}/interactions/${t}`,i)}cancel(t,n={},i){const{api_version:r=this._client.apiVersion}=n??{};return this._client.post(Jd`/${r}/interactions/${t}/cancel`,i)}get(t,n={},i){var r;const s=n??{},{api_version:o=this._client.apiVersion}=s,a=Xf(s,["api_version"]);return this._client.get(Jd`/${o}/interactions/${t}`,Object.assign(Object.assign({query:a},i),{stream:(r=n==null?void 0:n.stream)!==null&&r!==void 0?r:!1}))}}cq._key=Object.freeze(["interactions"]);class lq extends cq{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oit(e){let t=0;for(const r of e)t+=r.length;const n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}let Zd;function pb(e){let t;return(Zd??(t=new globalThis.TextEncoder,Zd=t.encode.bind(t)))(e)}let tg;function dS(e){let t;return(tg??(t=new globalThis.TextDecoder,tg=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vp{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?pb(t):t;this.buffer=Oit([this.buffer,n]);const i=[];let r;for(;(r=Bit(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(dS(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,o=dS(this.buffer.subarray(0,s));i.push(o),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}vp.NEWLINE_CHARS=new Set([`
`,"\r"]);vp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Bit(e,t){for(let r=t??0;r<e.length;r++){if(e[r]===10)return{preceding:r,index:r+1,carriage:!1};if(e[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Git(e){for(let i=0;i<e.length-1;i++){if(e[i]===10&&e[i+1]===10||e[i]===13&&e[i+1]===13)return i+2;if(e[i]===13&&e[i+1]===10&&i+3<e.length&&e[i+2]===13&&e[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jf={off:0,error:200,warn:300,info:400,debug:500},gS=(e,t,n)=>{if(e){if(bit(Jf,e))return e;On(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Jf))}`)}};function xh(){}function eg(e,t,n){return!t||Jf[e]>Jf[n]?xh:t[e].bind(t)}const Hit={error:xh,warn:xh,info:xh,debug:xh};let fS=new WeakMap;function On(e){var t;const n=e.logger,i=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!n)return Hit;const r=fS.get(n);if(r&&r[0]===i)return r[1];const s={error:eg("error",n,i),warn:eg("warn",n,i),info:eg("info",n,i),debug:eg("debug",n,i)};return fS.set(n,[i,s]),s}const ea=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _c{constructor(t,n,i){this.iterator=t,this.controller=n,this.client=i}static fromSSEResponse(t,n,i){let r=!1;const s=i?On(i):console;function o(){return _r(this,arguments,function*(){var c,h,u,d;if(r)throw new Qi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let f=!1;try{try{for(var v=!0,y=wr($it(t,n)),w;w=yield Dt(y.next()),c=w.done,!c;v=!0){d=w.value,v=!1;const _=d;if(!f)if(_.data.startsWith("[DONE]")){f=!0;continue}else try{yield yield Dt(JSON.parse(_.data))}catch(x){throw s.error("Could not parse message into JSON:",_.data),s.error("From chunk:",_.raw),x}}}catch(_){h={error:_}}finally{try{!v&&!c&&(u=y.return)&&(yield Dt(u.call(y)))}finally{if(h)throw h.error}}f=!0}catch(_){if(l0(_))return yield Dt(void 0);throw _}finally{f||n.abort()}})}return new _c(o,n,i)}static fromReadableStream(t,n,i){let r=!1;function s(){return _r(this,arguments,function*(){var c,h,u,d;const f=new vp,v=iq(t);try{for(var y=!0,w=wr(v),_;_=yield Dt(w.next()),c=_.done,!c;y=!0){d=_.value,y=!1;const x=d;for(const C of f.decode(x))yield yield Dt(C)}}catch(x){h={error:x}}finally{try{!y&&!c&&(u=w.return)&&(yield Dt(u.call(w)))}finally{if(h)throw h.error}}for(const x of f.flush())yield yield Dt(x)})}function o(){return _r(this,arguments,function*(){var c,h,u,d;if(r)throw new Qi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let f=!1;try{try{for(var v=!0,y=wr(s()),w;w=yield Dt(y.next()),c=w.done,!c;v=!0){d=w.value,v=!1;const _=d;f||_&&(yield yield Dt(JSON.parse(_)))}}catch(_){h={error:_}}finally{try{!v&&!c&&(u=y.return)&&(yield Dt(u.call(y)))}finally{if(h)throw h.error}}f=!0}catch(_){if(l0(_))return yield Dt(void 0);throw _}finally{f||n.abort()}})}return new _c(o,n,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],i=this.iterator(),r=s=>({next:()=>{if(s.length===0){const o=i.next();t.push(o),n.push(o)}return s.shift()}});return[new _c(()=>r(t),this.controller,this.client),new _c(()=>r(n),this.controller,this.client)]}toReadableStream(){const t=this;let n;return nq({async start(){n=t[Symbol.asyncIterator]()},async pull(i){try{const{value:r,done:s}=await n.next();if(s)return i.close();const o=pb(JSON.stringify(r)+`
`);i.enqueue(o)}catch(r){i.error(r)}},async cancel(){var i;await((i=n.return)===null||i===void 0?void 0:i.call(n))}})}}function $it(e,t){return _r(this,arguments,function*(){var i,r,s,o;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Qi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Qi("Attempted to iterate over a response with no body");const a=new Kit,c=new vp,h=iq(e.body);try{for(var u=!0,d=wr(zit(h)),f;f=yield Dt(d.next()),i=f.done,!i;u=!0){o=f.value,u=!1;const v=o;for(const y of c.decode(v)){const w=a.decode(y);w&&(yield yield Dt(w))}}}catch(v){r={error:v}}finally{try{!u&&!i&&(s=d.return)&&(yield Dt(s.call(d)))}finally{if(r)throw r.error}}for(const v of c.flush()){const y=a.decode(v);y&&(yield yield Dt(y))}})}function zit(e){return _r(this,arguments,function*(){var n,i,r,s;let o=new Uint8Array;try{for(var a=!0,c=wr(e),h;h=yield Dt(c.next()),n=h.done,!n;a=!0){s=h.value,a=!1;const u=s;if(u==null)continue;const d=u instanceof ArrayBuffer?new Uint8Array(u):typeof u=="string"?pb(u):u;let f=new Uint8Array(o.length+d.length);f.set(o),f.set(d,o.length),o=f;let v;for(;(v=Git(o))!==-1;)yield yield Dt(o.slice(0,v)),o=o.slice(v)}}catch(u){i={error:u}}finally{try{!a&&!n&&(r=c.return)&&(yield Dt(r.call(c)))}finally{if(i)throw i.error}}o.length>0&&(yield yield Dt(o))})}class Kit{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,i,r]=Wit(t,":");return r.startsWith(" ")&&(r=r.substring(1)),n==="event"?this.event=r:n==="data"&&this.data.push(r),null}}function Wit(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Qit(e,t){const{response:n,requestLogID:i,retryOfRequestLogID:r,startTime:s}=t,o=await(async()=>{var a;if(t.options.stream)return On(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):_c.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const c=n.headers.get("content-type"),h=(a=c==null?void 0:c.split(";")[0])===null||a===void 0?void 0:a.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await n.json():await n.text()})();return On(e).debug(`[${i}] response parsed`,ea({retryOfRequestLogID:r,url:n.url,status:n.status,body:o,durationMs:Date.now()-s})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vb extends Promise{constructor(t,n,i=Qit){super(r=>{r(null)}),this.responsePromise=n,this.parseResponse=i,this.client=t}_thenUnwrap(t){return new vb(this.client,this.responsePromise,async(n,i)=>t(await this.parseResponse(n,i),i))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hq=Symbol("brand.privateNullableHeaders");function*Yit(e){if(!e)return;if(hq in e){const{values:i,nulls:r}=e;yield*i.entries();for(const s of r)yield[s,null];return}let t=!1,n;e instanceof Headers?n=e.entries():cS(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let i of n){const r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const s=cS(i[1])?i[1]:[i[1]];let o=!1;for(const a of s)a!==void 0&&(t&&!o&&(o=!0,yield[r,null]),yield[r,a])}}const lh=e=>{const t=new Headers,n=new Set;for(const i of e){const r=new Set;for(const[s,o]of Yit(i)){const a=s.toLowerCase();r.has(a)||(t.delete(s),r.add(a)),o===null?(t.delete(s),n.add(a)):(t.append(s,o),n.delete(a))}}return{[hq]:!0,values:t,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hv=e=>{var t,n,i,r,s,o;if(typeof globalThis.process<"u")return(i=(n=(t=xX)===null||t===void 0?void 0:t[e])===null||n===void 0?void 0:n.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(o=(s=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||s===void 0?void 0:s.call(r,e))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uq;class yp{constructor(t){var n,i,r,s,o,a,c,{baseURL:h=Hv("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=(n=Hv("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:d="v1beta"}=t,f=Xf(t,["baseURL","apiKey","apiVersion"]);const v=Object.assign(Object.assign({apiKey:u,apiVersion:d},f),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=v.baseURL,this.timeout=(i=v.timeout)!==null&&i!==void 0?i:yp.DEFAULT_TIMEOUT,this.logger=(r=v.logger)!==null&&r!==void 0?r:console;const y="warn";this.logLevel=y,this.logLevel=(o=(s=gS(v.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:gS(Hv("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:y,this.fetchOptions=v.fetchOptions,this.maxRetries=(a=v.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(c=v.fetch)!==null&&c!==void 0?c:Ait(),this.encoder=Mit,this._options=v,this.apiKey=u,this.apiVersion=d,this.clientAdapter=v.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const n=lh([t.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return lh([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return lh([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([n,i])=>typeof i<"u").map(([n,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(n)}=`;throw new Qi(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${nc}`}defaultIdempotencyKey(){return`stainless-node-retry-${pit()}`}makeStatusError(t,n,i,r){return Wn.generate(t,n,i,r)}buildURL(t,n,i){const r=!this.baseURLOverridden()&&i||this.baseURL,s=yit(t)?new URL(t):new URL(r+(r.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return wit(o)||(n=Object.assign(Object.assign({},o),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const n=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(t,{url:n,options:i}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,i){return this.request(Promise.resolve(i).then(r=>Object.assign({method:t,path:n},r)))}request(t,n=null){return new vb(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,i){var r,s,o;const a=await t,c=(r=a.maxRetries)!==null&&r!==void 0?r:this.maxRetries;n==null&&(n=c),await this.prepareOptions(a);const{req:h,url:u,timeout:d}=await this.buildRequest(a,{retryCount:c-n});await this.prepareRequest(h,{url:u,options:a});const f="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),v=i===void 0?"":`, retryOf: ${i}`,y=Date.now();if(On(this).debug(`[${f}] sending request`,ea({retryOfRequestLogID:i,method:a.method,url:u,options:a,headers:h.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new u0;const w=new AbortController,_=await this.fetchWithTimeout(u,h,d,w).catch(h0),x=Date.now();if(_ instanceof globalThis.Error){const k=`retrying, ${n} attempts remaining`;if(!((o=a.signal)===null||o===void 0)&&o.aborted)throw new u0;const P=l0(_)||/timed? ?out/i.test(String(_)+("cause"in _?String(_.cause):""));if(n)return On(this).info(`[${f}] connection ${P?"timed out":"failed"} - ${k}`),On(this).debug(`[${f}] connection ${P?"timed out":"failed"} (${k})`,ea({retryOfRequestLogID:i,url:u,durationMs:x-y,message:_.message})),this.retryRequest(a,n,i??f);throw On(this).info(`[${f}] connection ${P?"timed out":"failed"} - error; no more retries left`),On(this).debug(`[${f}] connection ${P?"timed out":"failed"} (error; no more retries left)`,ea({retryOfRequestLogID:i,url:u,durationMs:x-y,message:_.message})),P?new KV:new pp({cause:_})}const C=`[${f}${v}] ${h.method} ${u} ${_.ok?"succeeded":"failed"} with status ${_.status} in ${x-y}ms`;if(!_.ok){const k=await this.shouldRetry(_);if(n&&k){const E=`retrying, ${n} attempts remaining`;return await Pit(_.body),On(this).info(`${C} - ${E}`),On(this).debug(`[${f}] response error (${E})`,ea({retryOfRequestLogID:i,url:_.url,status:_.status,headers:_.headers,durationMs:x-y})),this.retryRequest(a,n,i??f,_.headers)}const P=k?"error; no more retries left":"error; not retryable";On(this).info(`${C} - ${P}`);const A=await _.text().catch(E=>h0(E).message),M=Cit(A),N=M?void 0:A;throw On(this).debug(`[${f}] response error (${P})`,ea({retryOfRequestLogID:i,url:_.url,status:_.status,headers:_.headers,message:N,durationMs:Date.now()-y})),this.makeStatusError(_.status,M,N,_.headers)}return On(this).info(C),On(this).debug(`[${f}] response start`,ea({retryOfRequestLogID:i,url:_.url,status:_.status,headers:_.headers,durationMs:x-y})),{response:_,options:a,controller:w,requestLogID:f,retryOfRequestLogID:i,startTime:y}}async fetchWithTimeout(t,n,i,r){const s=n||{},{signal:o,method:a}=s,c=Xf(s,["signal","method"]);o&&o.addEventListener("abort",()=>r.abort());const h=setTimeout(()=>r.abort(),i),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,d=Object.assign(Object.assign(Object.assign({signal:r.signal},u?{duplex:"half"}:{}),{method:"GET"}),c);a&&(d.method=a.toUpperCase());try{return await this.fetch.call(void 0,t,d)}finally{clearTimeout(h)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,i,r){var s;let o;const a=r==null?void 0:r.get("retry-after-ms");if(a){const h=parseFloat(a);Number.isNaN(h)||(o=h)}const c=r==null?void 0:r.get("retry-after");if(c&&!o){const h=parseFloat(c);Number.isNaN(h)?o=Date.parse(c)-Date.now():o=h*1e3}if(!(o&&0<=o&&o<60*1e3)){const h=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,h)}return await kit(o),this.makeRequest(t,n-1,i)}calculateDefaultRetryTimeoutMillis(t,n){const s=n-t,o=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(t,{retryCount:n=0}={}){var i,r,s;const o=Object.assign({},t),{method:a,path:c,query:h,defaultBaseURL:u}=o,d=this.buildURL(c,h,u);"timeout"in o&&Tit("timeout",o.timeout),o.timeout=(i=o.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:f,body:v}=this.buildBody({options:o}),y=await this.buildHeaders({options:t,method:a,bodyHeaders:f,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:y},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&v instanceof globalThis.ReadableStream&&{duplex:"half"}),v&&{body:v}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(s=o.fetchOptions)!==null&&s!==void 0?s:{}),url:d,timeout:o.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:i,retryCount:r}){let s={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const o=await this.authHeaders(t);let a=lh([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),Iit()),this._options.defaultHeaders,i,t.headers,o]);return this.validateHeaders(a),a.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const i=lh([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&i.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:Rit(t)}:this.encoder({body:t,headers:i})}}yp.DEFAULT_TIMEOUT=6e4;class mn extends yp{constructor(){super(...arguments),this.interactions=new lq(this)}}uq=mn;mn.GeminiNextGenAPIClient=uq;mn.GeminiNextGenAPIClientError=Qi;mn.APIError=Wn;mn.APIConnectionError=pp;mn.APIConnectionTimeoutError=KV;mn.APIUserAbortError=u0;mn.NotFoundError=XV;mn.ConflictError=JV;mn.RateLimitError=tq;mn.BadRequestError=WV;mn.AuthenticationError=QV;mn.InternalServerError=eq;mn.PermissionDeniedError=YV;mn.UnprocessableEntityError=ZV;mn.toFile=jit;mn.Interactions=lq;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xit(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function Jit(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function Zit(e,t){const n={},i=g(e,["sdkHttpResponse"]);return i!=null&&m(n,["sdkHttpResponse"],i),n}function trt(e,t){const n={},i=g(e,["sdkHttpResponse"]);return i!=null&&m(n,["sdkHttpResponse"],i),n}function ert(e,t,n){const i={};if(g(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=g(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&m(t,["displayName"],r),g(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=g(e,["epochCount"]);t!==void 0&&s!=null&&m(t,["tuningTask","hyperparameters","epochCount"],s);const o=g(e,["learningRateMultiplier"]);if(o!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],o),g(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=g(e,["batchSize"]);t!==void 0&&a!=null&&m(t,["tuningTask","hyperparameters","batchSize"],a);const c=g(e,["learningRate"]);if(t!==void 0&&c!=null&&m(t,["tuningTask","hyperparameters","learningRate"],c),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function nrt(e,t,n){const i={};let r=g(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const v=g(e,["validationDataset"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec"],mS(v))}else if(r==="PREFERENCE_TUNING"){const v=g(e,["validationDataset"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec"],mS(v))}const s=g(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&m(t,["tunedModelDisplayName"],s);const o=g(e,["description"]);t!==void 0&&o!=null&&m(t,["description"],o);let a=g(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=g(e,["epochCount"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=g(e,["epochCount"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let c=g(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const v=g(e,["learningRateMultiplier"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(c==="PREFERENCE_TUNING"){const v=g(e,["learningRateMultiplier"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let h=g(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const v=g(e,["exportLastCheckpointOnly"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(h==="PREFERENCE_TUNING"){const v=g(e,["exportLastCheckpointOnly"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let u=g(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=g(e,["adapterSize"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(u==="PREFERENCE_TUNING"){const v=g(e,["adapterSize"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(g(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const d=g(e,["labels"]);t!==void 0&&d!=null&&m(t,["labels"],d);const f=g(e,["beta"]);return t!==void 0&&f!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","beta"],f),i}function irt(e,t){const n={},i=g(e,["baseModel"]);i!=null&&m(n,["baseModel"],i);const r=g(e,["preTunedModel"]);r!=null&&m(n,["preTunedModel"],r);const s=g(e,["trainingDataset"]);s!=null&&frt(s);const o=g(e,["config"]);return o!=null&&ert(o,n),n}function rrt(e,t){const n={},i=g(e,["baseModel"]);i!=null&&m(n,["baseModel"],i);const r=g(e,["preTunedModel"]);r!=null&&m(n,["preTunedModel"],r);const s=g(e,["trainingDataset"]);s!=null&&mrt(s,n,t);const o=g(e,["config"]);return o!=null&&nrt(o,n,t),n}function srt(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function ort(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function art(e,t,n){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&m(t,["_query","pageSize"],r);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=g(e,["filter"]);return t!==void 0&&o!=null&&m(t,["_query","filter"],o),i}function crt(e,t,n){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&m(t,["_query","pageSize"],r);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=g(e,["filter"]);return t!==void 0&&o!=null&&m(t,["_query","filter"],o),i}function lrt(e,t){const n={},i=g(e,["config"]);return i!=null&&art(i,n),n}function hrt(e,t){const n={},i=g(e,["config"]);return i!=null&&crt(i,n),n}function urt(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["nextPageToken"]);r!=null&&m(n,["nextPageToken"],r);const s=g(e,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>dq(a))),m(n,["tuningJobs"],o)}return n}function drt(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["nextPageToken"]);r!=null&&m(n,["nextPageToken"],r);const s=g(e,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>f0(a))),m(n,["tuningJobs"],o)}return n}function grt(e,t){const n={},i=g(e,["name"]);i!=null&&m(n,["model"],i);const r=g(e,["name"]);return r!=null&&m(n,["endpoint"],r),n}function frt(e,t){const n={};if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=g(e,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(n,["examples","examples"],r)}return n}function mrt(e,t,n){const i={};let r=g(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=g(e,["gcsUri"]);t!==void 0&&o!=null&&m(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=g(e,["gcsUri"]);t!==void 0&&o!=null&&m(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=g(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=g(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&m(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=g(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&m(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(g(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function dq(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["state"]);s!=null&&m(n,["state"],SV(s));const o=g(e,["createTime"]);o!=null&&m(n,["createTime"],o);const a=g(e,["tuningTask","startTime"]);a!=null&&m(n,["startTime"],a);const c=g(e,["tuningTask","completeTime"]);c!=null&&m(n,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(n,["updateTime"],h);const u=g(e,["description"]);u!=null&&m(n,["description"],u);const d=g(e,["baseModel"]);d!=null&&m(n,["baseModel"],d);const f=g(e,["_self"]);return f!=null&&m(n,["tunedModel"],grt(f)),n}function f0(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["state"]);s!=null&&m(n,["state"],SV(s));const o=g(e,["createTime"]);o!=null&&m(n,["createTime"],o);const a=g(e,["startTime"]);a!=null&&m(n,["startTime"],a);const c=g(e,["endTime"]);c!=null&&m(n,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(n,["updateTime"],h);const u=g(e,["error"]);u!=null&&m(n,["error"],u);const d=g(e,["description"]);d!=null&&m(n,["description"],d);const f=g(e,["baseModel"]);f!=null&&m(n,["baseModel"],f);const v=g(e,["tunedModel"]);v!=null&&m(n,["tunedModel"],v);const y=g(e,["preTunedModel"]);y!=null&&m(n,["preTunedModel"],y);const w=g(e,["supervisedTuningSpec"]);w!=null&&m(n,["supervisedTuningSpec"],w);const _=g(e,["preferenceOptimizationSpec"]);_!=null&&m(n,["preferenceOptimizationSpec"],_);const x=g(e,["tuningDataStats"]);x!=null&&m(n,["tuningDataStats"],x);const C=g(e,["encryptionSpec"]);C!=null&&m(n,["encryptionSpec"],C);const k=g(e,["partnerModelTuningSpec"]);k!=null&&m(n,["partnerModelTuningSpec"],k);const P=g(e,["customBaseModel"]);P!=null&&m(n,["customBaseModel"],P);const A=g(e,["experiment"]);A!=null&&m(n,["experiment"],A);const M=g(e,["labels"]);M!=null&&m(n,["labels"],M);const N=g(e,["outputUri"]);N!=null&&m(n,["outputUri"],N);const T=g(e,["pipelineJob"]);T!=null&&m(n,["pipelineJob"],T);const E=g(e,["serviceAccount"]);E!=null&&m(n,["serviceAccount"],E);const R=g(e,["tunedModelDisplayName"]);R!=null&&m(n,["tunedModelDisplayName"],R);const D=g(e,["veoTuningSpec"]);return D!=null&&m(n,["veoTuningSpec"],D),n}function prt(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["metadata"]);s!=null&&m(n,["metadata"],s);const o=g(e,["done"]);o!=null&&m(n,["done"],o);const a=g(e,["error"]);return a!=null&&m(n,["error"],a),n}function mS(e,t){const n={},i=g(e,["gcsUri"]);i!=null&&m(n,["validationDatasetUri"],i);const r=g(e,["vertexDatasetResource"]);return r!=null&&m(n,["validationDatasetUri"],r),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vrt extends qs{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ga(As.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const r={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:r});return s.baseModel=void 0,await this.tuneInternal(s)}else{const r=Object.assign({},n);return await this.tuneInternal(r)}else{const r=Object.assign({},n),s=await this.tuneMldevInternal(r);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:n0.JOB_STATE_QUEUED}}}}async getInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=ort(t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>f0(u))}else{const h=srt(t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>dq(u))}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=hrt(t);return a=gt("tuningJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=drt(u),f=new O1;return Object.assign(f,d),f})}else{const h=lrt(t);return a=gt("tunedModels",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=urt(u),f=new O1;return Object.assign(f,d),f})}}async cancel(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Jit(t);return a=gt("{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=trt(u),f=new B1;return Object.assign(f,d),f})}else{const h=Xit(t);return a=gt("{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Zit(u),f=new B1;return Object.assign(f,d),f})}}async tuneInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=rrt(t,t);return s=gt("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>f0(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=irt(t);return s=gt("tunedModels",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>prt(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yrt{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const xrt=1024*1024*8,_rt=3,wrt=1e3,brt=2,Zf="x-goog-upload-status";async function Trt(e,t,n){var i;const r=await gq(e,t,n),s=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Zf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function Crt(e,t,n){var i;const r=await gq(e,t,n),s=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Zf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=bV(s),a=new hb;return Object.assign(a,o),a}async function gq(e,t,n){var i,r;let s=0,o=0,a=new i0(new Response),c="upload";for(s=e.size;o<s;){const h=Math.min(xrt,s-o),u=e.slice(o,o+h);o+h>=s&&(c+=", finalize");let d=0,f=wrt;for(;d<_rt&&(a=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(o),"Content-Length":String(h)}}}),!(!((i=a==null?void 0:a.headers)===null||i===void 0)&&i[Zf]));)d++,await Nrt(f),f=f*brt;if(o+=h,((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[Zf])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function krt(e){return{size:e.size,type:e.type}}function Nrt(e){return new Promise(t=>setTimeout(t,e))}class Ert{async upload(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Trt(t,n,i)}async uploadToFileSearchStore(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Crt(t,n,i)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await krt(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Srt{create(t,n,i){return new Irt(t,n,i)}}class Irt{constructor(t,n,i){this.url=t,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pS="x-goog-api-key";class Art{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(pS)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(pS,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rrt="gl-node/";class Prt{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new mn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=n.interactions,this._interactions}constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const i=TX(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const r=new Art(this.apiKey);this.apiClient=new knt({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Rrt+"web",uploader:new Ert,downloader:new yrt}),this.models=new Hnt(this.apiClient),this.live=new jnt(this.apiClient,r,new Srt),this.batches=new JJ(this.apiClient),this.chats=new MZ(this.models,this.apiClient),this.caches=new AZ(this.apiClient),this.files=new GZ(this.apiClient),this.operations=new $nt(this.apiClient),this.authTokens=new ait(this.apiClient),this.tunings=new vrt(this.apiClient),this.fileSearchStores=new mit(this.apiClient)}}const vS=[{id:1,name:"Chng 1: TNG QUAN V QUN L D N",shortName:"TNG QUAN V QUN L D N",content:`Chng 1. TNG QUAN V QUN L D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. Hiu c khi nim v d n, d n CNTT l g.
2. M t v qui trnh qun l d n.
3. Bit c cc nhim v trong cc hot ng QLDA.
4. Bit cch phn loi d n.
5. Phn loi c d n. Xc nh c cng vic qun l d n.
6. Xc nh c cc bn lin quan n d n.

1.1 Khi nim v d n, d n CNTT.
1.1.1 Khi nim d n
D n l mt hot ng to ra mt cch c phng php, vi cc phng tin v ngun lc  cho  to ra mt sn phm mi hoc mt thc t mi.
V th, d n phi c tnh c th v mc tiu xc nh, nhm p ng mt nhu cu chuyn bit (ca ngi dng). D n cng khng phi l mt nghin cu tru tng m phi cu trc nn mt thc t mi cha tn ti trc . Mc d vic nghin cu, th nghim v pht trin c th l mt phn nht nh trong d n, nhng cng ch ng vai tr h tr trong qu trnh thc hin mc tiu cui cng ca d n m thi. Do vy, chng ta cn phn bit r s khc nhau gia d n v cc  ti nghin cu trin khai m cc c quan, n v nghin cu vn thng lm.

[Hnh nh: Hnh 1.1 Cc lnh vc trong QLDA]

1.1.2 D n Cng ngh thng tin
Qun l d n CNTT l tp hp cc cng vic c thc hin bi mt tp th (c th c chuyn mn khc nhau, thc hin cng vic khc nhau, thi gian tham gia d n khc nhau) nhm t c mt kt qu nh d kin, trong thi gian d kin, vi mt kinh ph d kin. Trong thut ng ca chuyn ngnh Cng ngh phn mm, Qun l d n phn mm l cc hot ng trong lp k hoch, gim st v iu khin ti nguyn d n (v d nh kinh ph, con ngi), thi gian thc hin, cc ri ro v quy trnh thc hin d n nhm m bo thnh cng cho d n.
Qun l d n phn mm cn m bo cn bng gia ba yu t: thi gian, ti nguyn v cht lng. Ba yu t ny c gi l tam gic d n.

1.1.3 c trng ca mt d n
Mi d n thng b rng buc theo b ba nhiu cch, do:
- Mc tiu v phm vi (Scope): t c ci g?
- Mc tiu v thi gian (Time): Thi gian bao lu?
- Mc tiu v chi ph (Cost): S tn km bao nhiu?
Nhim v ca ngi qun l d n l phi cn i nhng mc tiu thng hay xung t ny.

[Hnh nh: Hnh 1.2. B 3 rng buc trong QLDA]

1.1.4 Mc tiu ca d n
Mi d n u bt u khi c mt vn  c t ra trong thc t. Km theo  phi l nhng yu cu cn c gii quyt. Mc tiu ca d n l gii quyt c vn  ny. Cc mc tiu ca d n nht thit phi c vit ra mt cch r rng ngay t u, nu khng kh c th hon thnh c.
Mi d n CNTT cn phi c th ho cc mc tiu ca mnh c v mt nh tnh v nh lng. Mun c mc tiu c th, chng ta phi xc nh c yu cu tht c th.

1.2 Quy trnh qun l d n
Quy trnh qun l d n phn mm l quy trnh vn dng nhng kin thc, k nng v k thut cng ngh vo hot ng ca d n  t c mc tiu ca d n t ra. Nhng ng dng ny c a vo phn mm theo mt tiu chun ha ca qun l d n.
 m bo d n thnh cng, cc thnh vin d n phi m bo:
 La chn quy trnh ph hp  t c mc tiu ca d n
 Tun theo cc yu cu  p ng c nhu cu v mong i ca cc bn lin quan.
 Cn bng c cc yu cu (nhn t) cnh tranh trong d n nh: phm vi cng vic, ngn sch, tin , cht lng, ri ro, thay i. Ty theo quy m ca tng d n m cc mi giai on li c th gm nhng quy trnh nh hn.
Ngoi cc li ch chin lc nu trn phn mm cn cung cp y  cc tnh nng h thng. Vic bo mt c tin hnh mt cch tuyt i nghim ngt. Vic phn quyn c c th n tng vai tr ca ngi s dng.

[Hnh nh: Hnh 1.3 Quy trnh kim tra v gim st QLDA phn mm.]

1.2.1 Khi to d n
Giai on ny thc hin vic nh ngha mt d n mi hoc mt pht sinh (hoc trn ln) mi ca mt d n c sn nh: Xc nh yu cu ca d n, mc  u tin ca d n, phn tch cc yu cu u t, phn cng trch nhim cho cc b phn trin khai.

1.2.2 Lp k hoch d n
Giao on ny yu cu thit lp phm vi cng vic ca d n, iu chnh li mc tiu v xc nh ng i ti mc tiu .

1.2.3 Trin khai
Giai on ny thc hin hon thnh cc cng vic c xc nh trong phn lp k hoch  m bo cc yu cu ca d n.

1.2.4 Gim st v kim sot
Giai on ny yu cu vic theo di, r sot v iu chnh li tin  v kh nng thc hin ca d n. Theo di cc ri ro, thay i, pht sinh trong qu trnh thc hin v c nhng  xut iu chnh kp thi.

1.2.5 Kt thc
Giai on ny thc hin  kt thc tt c cc hot ng ca d n  chnh thc ng li d n.

1.2.6 Cc hot ng chnh trong qun l d n phn mm
1.2.6.1 Xc nh cc bc thc hin d n phn mm
Xc nh yu cu chung
Trc tin, cn xc nh cc yu cu chc nng (cng vic phn mm thc hin) cng nh phi chc nng (cng ngh dng  pht trin phn mm, s dng trong h iu hnh) ca phn mm. Tip theo cn xc nh r ti nguyn cn thit  xy dng phn mm. Ti nguyn  y c th gm c nhn t con ngi, cc thnh phn, phn mm c th s dng li, cc phn cng hoc cng c c sn cn dng n; trong  nhn t con ngi l quan trng nht. iu cui cng l xc nh thi gian cn thit  thc hin d n. Trong qu trnh ny cn phi nm bt c bi ton thc t cn gii quyt cng nh cc hot ng mang tnh nghip v ca khch hng  c th xc nh r rng yu cu chung ca  n, xem xt d n c kh thi hay khng.

Vit  n
Vit  n l qu trnh xy dng ti liu m t  n  xc nh phm vi ca d n, trch nhim ca nhng ngi tham gia d n; l cam kt gia ngi qun l d n, ngi ti tr d n v khch hng. Ni dung ca ti liu m t  n thng c nhng ni dung:
- Bi cnh thc hin d n: Cn c php l  thc hin d n, hin trng cng ngh thng tin ca khch hng trc khi c d n, nhu cu ng dng phn mm ca khch hng, c im v phm vi ca phn mm s xy dng.
- Mc ch v mc tiu ca d n: xc nh mc ch tng th, tin hc ha hot ng no trong quy trnh nghip v ca khch hng, xc nh mc tiu ca phn mm gm lng d liu x l, li ch phn mm em li.
- Phm vi d n: Nhng ngi lin quan ti d n, cc hot ng nghip v cn tin hc ha.
- Ngun nhn lc tham gia d n: Cn b nghip v, ngi phn tch, ngi thit k, ngi lp trnh, ngi kim th, ngi ci t trin khai d n cho khch hng, ngi hng dn khch hng s dng phn mm, ngi bo tr d n phn mm.
- Rng buc thi gian thc hin d n: Ngy nghim thu d n, ngy bn giao d n.
- Rng buc kinh ph: Kinh ph trong tng giai on thc hin d n.
- Rng buc cng ngh pht trin: Cng ngh no c php s dng  thc hin d n.
- Ch k cc bn lin quan ti d n.

1.2.6.2 Lp k hoch thc hin d n
Lp k hoch thc hin d n l hot ng din ra trong sut qu trnh t khi bt u thc hin d n n khi bn giao sn phm vi nhiu loi k hoch khc nhau nhm h tr k hoch chnh ca d n phn mm v lch trnh v ngn sch.
Cc loi k hoch thc hin d n
- K hoch m bo cht lng: M t cc chun, cc qui trnh c s dng trong d n.
- K hoch thm nh: M t cc phng php, ngun lc, lch trnh thm nh h thng.
- K hoch qun l cu hnh: M t cc th tc, cu trc qun l cu hnh c s dng.
- K hoch bo tr: D tnh cc yu cu v h thng, chi ph, n lc cn thit cho bo tr.
- K hoch pht trin i ng: M t k nng v kinh nghim ca cc thnh vin trong nhm d n s pht trin nh th no.

1.2.6.3 Quy trnh lp k hoch thc hin d n
- Thit lp cc rng buc ca d n: thi gian, nhn lc, ngn sch
- nh gi bc u v cc "tham s" ca d n: quy m,  phc tp, ngun lc
- Xc nh cc mc thi gian trong thc hin d n v sn phm thu c ng vi mi mc thi gian
- Trong khi d n cha hon thnh hoc cha b hy b th thc hin lp i lp li cc cng vic sau:
1. Lp lch thc hin d n
2. Thc hin cc hot ng theo lch trnh
3. Theo di s tin trin ca d n, so snh vi lch trnh
4. nh gi li cc tham s ca d n
5. Lp li lch thc hin d n cho cc tham s mi
6. Tha thun li cc rng buc v sn phm bn giao ca mi mc thi gian
7. Nu c vn  ny sinh th xem xt li cc k thut khi u a ra cc bin php cn thit

1.2.6.4 Cu trc k hoch thc hin d n
1 T chc d n
2 Phn tch cc ri ro
3 Yu cu v ti nguyn phn cng, phn mm
4 Phn cng cng vic
5 Lp lch d n
6 C ch kim sot v bo co

1.2.7 Mc ch ca qun l d n
Mc ch cui cng ca vic qun l d n l nhm m bo cho d n c thc hin thnh cng. Mt d n c nh gi l thnh cng nu nh p ng c 4 vn  c bn sau:
 Sn phm cui cng ca d n thc s p ng cc yu cu ca ngi dng, m bo thi gian v kinh ph khng vt qu 10-20% d tnh ban u;
 Ngi dng hi lng vi qu trnh thc hin d n, thc s tham d v gp phn cng sc ca mnh trong cc hot ng ca d n. c bit i vi cc d n ng dng CNTT, vai tr ca nhng cn b nghip v trong vic xc nh yu cu, phn tch quy trnh, thng tin... ti chnh n v ca mnh l rt quan trng;
 Qun l cp trn ca d n cung cp y  thng tin v tnh hnh thc hin d n.
 Nhng ngi thc hin d n cng phn khi, khng b qu g b, tch lu c kinh nghim, tng thm thu nhp...

1.2.8 Phng php lun v k thut qun l d n
Tt c nhng vn  nu trn cho thy cn phi c thi  ht sc nghim tc khi xy dng v thc hin mt d n, nht l cc d n c nhng u t rt ln ca Nh nc. Do vy, vic qun l d n i hi phi c nhng phng php lun khoa hc v nhng cng c mnh  h tr cho vic lp k hoch v theo di d n.

1.2.9 Nguyn nhn khin d n tht bi
Theo thng k chung trn th gii:
 33% cc d n b hu bi v
- Vt qua gii hn v thi gian hoc kinh ph;
- Cng ngh  b thay i qu nhiu so vi hiu qu m d n s mang li;
- Ngi dng hoc khch hng khng cn ti n na;
- Nhng l do chnh tr.
 50 - 100% qu ti
- Mt d n m chi ph ca n vt qu 50% kinh ph cho php
- Hoc ko di qu 50% thi gian d nh th coi nh l  tht bi.
 Khng s dng c
Nhiu d n khng bao gi a vo s dng c. L do c th l:
- D n khng gii quyt c vn  t ra;
- Qu kh s dng,
- Khng c o to.
 Nguyn nhn su xa ca vic tht bi c th xut pht:
- Ngay t khi bt u d n, do thiu mt k hoch tt:
D n khng th trin khai c v khng xut pht t thc t c th. Ngi ta bt tay vo vic lp trnh m khng hiu r ti sao li c d n  v chnh xc l cn phi hon thnh ci g; lm vic khng c k hoch. Nu khng nh gi xem l s cn phi tn bao nhiu cng sc  lm vic , ta s khng th hnh dung c s nhn cng cn thit, m  chnh l chi ph chnh ca d n. Nu khng thng nht r rng trc vi ngi dng v nhng g h yu cu d n phi t c, th sau ny s rt kh khn  ngi dng chp nhn cc kt qu ca d n. Tt c nhng cam kt u phi c ghi nh li di dng cc vn bn. Ngoi ra, vic t ra nhng thi hn v kinh ph khng st thc t thng khin cho nhng nhm thc hin khng th no hon thnh c cng vic.
- Trong cc bc pht trin tip:
+ D n c th mc sai lm trong giai on phn tch v thit k.
+ Ngi qun l d n khng phn cng r nhim v ca tng ngi.
+ Thiu hoc khng hiu r cc cng c h tr cho vic pht trin h thng cng nh cho vic qun l - theo di d n, s lm nh hng n thi gian v kt qu ca d n.
+ Khng lm r lch iu phi nhn s v thng bo trc cho cc i tng lin quan, th s rt kh khn khi cn huy ng nhn lc cn thit  hon thnh cng vic.
+ Vic bt u vit chng trnh trc khi bn thit k c hon thnh s khin cho d n kh m thnh cng mt cch tt p, hoc s tn thm nhiu cng sc  m iu chnh v sau.
+ Khng kp thi pht hin ra cc vn  chnh ny sinh trc v sau giai on pht trin.  l do thiu s r sot chi tit v mt k thut (thit k, chng trnh, ti liu...) v xem xt li v mt qun l ( cng, kinh ph, lch trnh...) mt cch khch quan t bn ngoi.
+ S thay i cng tc ca cc thnh vin tham gia d n cng l mt nguyn nhn phi xem xt.
+ Thiu cc chun mc, qui nh trong qu trnh pht trin cng lm cho d n b tht bi  mt mc  no .
+ Nhiu ngi tham gia d n cha chc  y nhanh tc  m c khi cn lm cho d n chm i v phi thm vic o to, hun luyn, thm vic giao tip gia mi ngi... tc l thm thi gian v kinh ph.
- Trong giai on kt thc:
+ Khi  n thi hn cui cng, hoc khi  ht kinh ph m mi chuyn vn cha xong, th yu cu i vi d n thng b tho hip. Ngi ta ngh rng mt phn (ln) cng vic  hon thnh ri th l c. Th nhng, i vi nhiu ngi dng th phi hon tt ton b mi p ng yu cu ca h.
+ Mt s ng dng c to ra khng c s r li cn thn. iu  gy nn n tng ban u khng hay v gy kh khn cho vic a vo s dng.
+ Mt s h thng a ra khng p ng c ng cc ch tiu k thut   ra.
+ Nu chi ph cho vic bo tr qu ln th h thng cng c th b ngng hot ng.
Trong nhiu trng hp, nu  thi im no  m chng minh c rng khng c ch li g m tip tc d n na th cng nn mnh dng xem xt n vic phi ngng d n li.

1.3 Cc nhim v trong cc hot ng QLDA.
1.3.1 Qun l thi gian ca d n
i vi mi d n phi xc nh c mt thi hn ti a phi hon thnh, c th hn l phi c thi im bt u v thi im kt thc. Thi im bt u l khi vn  gii quyt c t ra. Thi im kt thc l hn cui cng m d n phi hon thnh. Thi im ny phi c xc nh r rng, nu khng d n c th s khng bao gi kt thc.

1.3.2 Qun l kinh ph ca d n
Mi d n u phi xc nh mt kinh ph ti a, hay ni khc i l mt khon tin ti a m d n c th s dng.
Mi d n CNTT u phi xc nh tng d ton kinh ph cho ton b qu trnh thc hin, phn b theo tng nm hoc tng giai thc hin.

1.3.3 Qun l ngun nhn lc ca d n
L tt c nhng ngi tham gia vo d n. Mi d n phi xc nh danh sch nhng ngi tham gia, t mc qun l d n n nhng ngi thc hin, trin khai.

1.3.4 Qun l cc kt qu chuyn giao ca d n
L kt qu ca d n hay ni khc i l sn phm cui cng ca d n. Mc tiu ca d n thng thng l gii quyt vn  bng vic to ra cc kt qu ny. Cc kt qu v cc mc tiu nht thit phi c vit ra r rng, nu khng mc ch ca d n s khng t c; s to ra nhng kt qu sai khc i v s khng ai hi lng c.

1.4 Phn loi d n
D n trong thc t rt a dng, c th phn loi theo nhiu cch khc nhau:
1.4.1 Theo tm c d n
D n ln: c c trng bi tng kinh ph huy ng ln, s lng cc bn tham gia ng, thi gian dn tri, qui m rng ln. Chng i hi phi thit lp cc cu trc t chc ring bit, vi mc phn cp trch nhim khc nhau,  ra quy ch hot ng v cc phng php kim tra cht ch.
D n trung bnh v nh: khng i hi kinh ph nhiu, thi gian n nh ngn, khng qu phc tp... Kinh nghim cc nc cho thy nhng d n trung bnh hoc nh l nhng d n c t hn 15 ngi trong mt nm.
V l thuyt, qun l d n ln hay nh cng u theo nhng phng php lun nh nhau. D n ln c th gi l chng trnh; chng trnh thng c phn thnh nhiu d n nh hn. Trong trng hp  s tn ti nhiu mc qun l d n khc nhau, v  phn bit c th gi nhng ngi qun l bng nhng tn khc nhau nh ngi qun l chng trnh, ngi qun l d n, ngi iu hnh d n, gim c d n, nhm trng,...Thm ch, mi mt ngi tham gia vo d n cng phi bit cch t chc v qun l cng vic m mnh c giao.

1.4.2 Theo ni dung ca d n
C th phn lm 3 loi chnh:
D n ng dng CNTT trong cng tc qun l v hot ng nghip v.
D n xy dng c s h tng v CNTT: d n Mng truyn thng d liu quc gia; d n xy dng CSDL quc gia;
Cc d n nhm thc hin nhim v  phn cng cho cc B ngnh nh pht trin Cng ngh thng tin; m bo  cn b tin hc cho t nc...

1.4.3 D n mt ngi hay d n nhiu ngi
Mt d n c th c thc hin bi mt ngi hoc nhiu ngi. Vic qun l d n s kh khn hn khi c t hai ngi tr ln.

1.4.4 Ni b hay bn ngoi
- D n ni b l d n ca mt n v t chc thc hin nhm phc v cho yu cu ca chnh t chc .
- D n bn ngoi l d n c thc hin  p ng yu cu cho mt n v khc.

1.5 Cc bn lin quan n d n

[Hnh nh: Hnh 1.4 Cc bn lin quan ca mt d n]

S  trn c th xem nh l mt v d  cp ti tt c cc n v v nhn s c lin quan n mt d n v tin hc. Tnh hnh tin  v kt qu thc hin ca d n l iu m nhng ni (ngi) ny cn phi quan tm n.
V t chc qun l, ta c th phn bit v phi bit r chc nng ca tng ngi:

| Gim c d n | T chc, phi hp, i ngoi |
| :--- | :--- |
| - Gim c iu hnh: | - Trc tip iu hnh, tch hp |
| - Nhm trng k thut: | - Chu trch nhim tng phn k thut |
| - Nhn vin k thut trong mi nhm: | - Thc hin cng vic k thut c th. |

H u l nhng ngi qun l d n, nhng  nhng mc  chi tit khc nhau. Mc qun l cui cng l cc nhm trng ph trch tng cng vic k thut.

 Cu hi (bi tp) cng c:
1. Th no l QLDA CNTT; B ba rng buc trong mt d n l g?  m bo c b ba ny theo anh ch phi lm nh th no? C my lai d n?
2. Nguyn nhn no dn n d n tht bi? L mt nh QLDA anh ch hy a ra nhng bin php nhm khc phc nhng nguyn nhn .`},{id:2,name:"Chng 2: K NNG GIAO TIP TRONG QUN L D N",shortName:"K NNG GIAO TIP TRONG QUN L D N",content:`Chng 2. K NNG GIAO TIP TRONG QUN L D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th bit c:
1. Cc khi nim v trao i
2. Cc khi nim v quan st, lng nghe, trnh by
3. Cc k thut trnh by trc quan
4. Khi nim quan h tng tc Cu hi  cu tr li thch hp

2.1.Khi nim giao tip, cc thuyt giao tip
Ngy nay d bn lm bt c vic g bn cng phi c k nng giao tip  qun l v trao i vi mi ngi v cng vic, nghe mi ngi phn hi v cc vn  X hi cng pht trin, vn minh th nhu cu v hnh thc giao tip cng cao v a dng. Giao tip cng tr nn mt k nng khng th thiu v cn phi c rn luyn. C rt nhiu khi nim v giao tip.
- Giao tip l vic trao i thng tin gia con ngi v thng dn ti hnh ng tip theo.
- Giao tip l s tip xc gia hai hay nhiu ngi thng qua phng tin ngn ng nhm trao i thng tin, tnh cm, hiu bit, tc ng qua li v iu chnh ln nhau,
- Giao tip l mt qu trnh trao i thng tin gia cc c nhn thng qua mt h thng bao gm cc k hiu, du hiu v hnh vi. Giao tip cng c th hiu l cc hnh thc biu l tnh cm, tr chuyn, din thuyt, trao i th tn, thng tin.
Nh vy giao tip xy ra rt nhiu hng ngy v di nhiu hnh thc, gin tip hoc trc tip. Giao tip qua li ni, ngn ng khng li (c ch, hnh vi, nt mt, trang phc), hi p, quan st, nghe, trnh by, ni chuyn, qua bo co, gi th, th in tGiao tip vi ngi cng nhm, c quan hay ngi ngoi, c chun b hay khng chun b trc. Giao tip l hin tng tm l ca con ngi rt phc tp. Mc d c nhiu nh ngha, quan nim khc nhau v giao tip nhng ni chung mi ngi u cho rng giao tip l phi c xy dng mt bn thng ip sau  gi i vi hy vng ngi nhn s hiu thng ip .

[Hnh nh: Hnh 2.1 Qu trnh giao tip (Ngi gi -> Ngi nhn)]

Theo quan nim truyn thng ny chng ta thy cp  giao tip hiu qu nht l trong tnh hung mt i mt, c hai bn c th tip nhn thng tin trc tip di cc dng ngn ng giao tip, trnh c mt s nhiu, c th iu chnh nhanh  tng hiu qu giao tip. Cp  ny c  hnh thc giao tip nh ni chuyn vi nhau, phng vn, hi m song phng, hi ngh quy m nh, hp nhmCp  giao tip cng c tin hnh song phng t hiu qu hn nhng tin li l giao tip khng gp mt qua in thoi.  cp  ny hai bn nghe ging ni ca nhau, thng tin qua li nhng thiu yu t phi ngn t. Cp  ba l cp  km hiu qu nht: ch gi thng tin dng vn bn nh th, cng vn, n, bo co, th in t. Cp  giao tip ny thiu h tr ca yu t phi ngn t v nhn s phn hi chm. Trong qu trnh lm vic chng ta, v nhng l do no  nh thi gian, khng gian, ti chnh, c th dng hnh thc giao tip no cho ph hp v hiu qu nht hoc dng ng thi ba hnh thc giao tip.

C 4 quy m giao tip.
- Th nht giao tip vi chnh bn thn: t a ra thng tin, t nhn thng tin (suy ngm) v ci thin bn thn.
- Th hai: giao tip nhn cch gia hai c nhn vi nhau trong cng vic cng nh trong tnh cm, i sng.
- Th ba: giao tip nhm gia cc c nhn trong mt nhm no .
- Th t: giao tip trong t chc, giao tip gia cc nhm vi nhau  hon thnh cng vic chung ca t chc. Giao tip trong t chc c cc lung giao tip t trn xung, t di ln v theo hng ngang.

[Hnh nh: Hnh 2.2 Cc dng giao tip trong nhm (a. Hnh nan qut, b. Hnh vng trn, d. Hnh sao, d. Hnh dy xch)]

2.1.1 Cc thuyt v giao tip.
- Thuyt hnh vi cho rng mi ng x ca c nhn trong x hi l qu trnh tip nhn kch thch ngoi gii v phn ng p li kch thch ca c th. Hnh vi c th hin bng cng thc kch thch -> phn ng, c kch thch th c phn ng. Hnh vi theo ngha chung l s tc ng qua li gia c th sng v mi trng c to bi kch thch bn ngoi v nhu cu bn trong. Giao tip l hnh thc c bn v tiu biu ca hnh vi.
Thuyt hnh vi quan tm nhiu hn ti phng din ng x, tc nhn kch thch ca mi trng quy nh tnh cht, c im ca hnh vi ng x. Hnh vi ng x l mt chui phn ng trc hay sau nhng thay i ca mi trng, iu kin bn ngoi.
- Thuyt lin h x hi cho rng con ngi nm trong mi lin h vi con ngi v nhng ngi khc trong x hi loi ngi. Cc mi lin h ny chnh l bn cht x hi ca c nhn. Giao tip c xem l phng tin thit lp cc mi quan h x hi. Cc c nhn thc hin cc hot ng giao tip thng qua cc hnh ng v thao tc  t mc ch tho mn nhu cu no . Thuyt x hi nhn mnh n yu t hon cnh trong giao tip. Khi giao tip chng ta tham gia vo mt hon cnh x hi vi nhng v tr khc nhau, quy tc chun mc v nn vn ho khc nhau. Cc yu t cu thnh trong giao tip gm ngi gi, ngi nhn, thng tin, mi trng x hi c th.
- Thuyt hot ng cho rng thng qua hot ng c s tip xc tm l, giao tip vi nhau, hnh thnh cc mi quan h x hi v quan h lin nhn cch. V d nh tm l hc Lnchiep a ra nh ngha: Giao tip l h thng nhng qu trnh c mc ch v ng c m bo s tng tc ca ngi ny vi ngi khc trong hot ng tp th, thc hin cc mi quan h x hi v nhn cch, cc quan h tm l v s dng phng tin c th m trc ht l ngn ng.
 thc hin cc hot ng hng ngy cho hiu qu, c 4 k nng giao tip c bn cn c hc tp v rn luyn: ni, nghe, vit, x giao ng x. Cng cn nhiu k nng khc b sung cho k nng giao tip c hon chnh hn nh k nng quan st, k nng t cu hi v tr li cu hi, k nng hp tc v chp nhn, k nng gii quyt vn ... rt cn thit cho mi con ngi  sng v lm vic.

2.1.2 Nguyn tc v phong cch giao tip
Nguyn tc trong giao tip l nhng h thng quan im ch o, nh hng thi  v hnh vi ng x, la chn cc phng php, phng tin giao tip ca c nhn. C th k ra y mt s nguyn tc giao tip c bn.
Nguyn tc bnh ng trong giao tip (tn trng nhn cch trong giao tip). Theo nguyn tc ny ngi giao tip phi tn trng nhn cch i tng giao tip tc l tn trng phm gi, tm t nguyn vng ca nhau, khng p buc nhau bng quyn lc. Tn trng nhn cch cng c ngha l coi i tng giao tip l mt con ngi, c y  cc quyn con ngi v c bnh ng trong cc mi quan h x hi.
Nguyn tc thin ch trong giao tip. Thin  trong giao tip l s tin tng  i tng giao tip, lun ngh tt v h. Ginh nhng tnh cm tt p v em li nim vui cho i tng giao tip, lun lun ng vin, khuyn khch h lm vic tt.
Nguyn tc tn trng cc gi tr vn ho trong giao tip. Giao tip trong mi trng a vn ha i hi mi c nhn phi c nhng hiu bit nht nh v cc gi tr vn ha ca i tc giao tip thuc cc quc gia, cc dn tc, gii  c ng x ph hp.
V phong cch giao tip c th c cch phn chia khc nhau.  y a ra mt s phong cch c trng da vo ng x.
Phong cch c on: Cc thnh vin tham gia giao tip khng quan tm n c im ring ca i tng giao tip dn ti thiu thin ch, hay va chm v gy cng thng. Ngi giao tip khng gy c thin cm, kh thit lp mi quan h hp tc, kh chim c cm tnh ca i tc. u im ca phong cch giao tip c on l c tc dng trong vic a ra nhng quyt nh nht thi, gii quyt c vn  mt cch nhanh chng. Nhc im l lm mt i s t do, dn ch trong giao tip, kim ch sc sng to ca con ngi, gim tnh gio dc v tnh thuyt phc.
Phong cch t do: Cc thnh vin tham gia giao tip linh hot qu mc, d thay i mc ch, chiu theo  i tc giao tip. Phong cch ny d dng thit lp cc quan h nhng cng d mt cc mi quan h, khng su sc, thiu lp trng, th no cng c. Phong cch t do l kiu phong cch linh hot, c ng, mm do, d thay i theo i tng v hon cnh giao tip. u im ca phong cch ny l pht huy c tnh tch cc ca con ngi, c kch thch t duy c lp v sng to. Nhc im l khng lm ch c cm xc ca bn thn, thng hay ph thuc hoc bt chc, d pht sinh t do qu mc.
Phong cch dn ch: Cc thnh vin tham gia giao tip biu hin s nhit tnh, thin , tn trng nhn cch ca i tng giao tip. Cc thnh vin bit lng nghe, bit quan tm, d dng thit lp mi quan h tt trn c s hiu bit tm t ca cc bn. u im ca phng php ny l lm tng kh nng sng to ca i tng giao tip, gip mi ngi thn thin, gn gi v hiu nhau hn, to mi quan h tt khi lm vic. Nhc im ca phng php ny l dn ch qu c th dn n vic ri xa cc li ch ca tp th. Chng ta c gng rn luyn  theo phong cch giao tip dn ch nhng trnh dn ch qu trn..

2.2 K nng lng nghe
2.2.1 Nghe v lng nghe, vai tr trong giao tip
Nghe l hot ng thng ngy ca con ngi nn chng ta thng b qua, t quan tm ti rn luyn k nng ny m cho rng  c sn. C kt qu nghin cu cho thy rng con ngi dng 45% thi gian giao tip hng ngy cho vic nghe, tuy nhin ngi ra li khng c luyn nghe m ch yu l luyn vit. Nghe v lng nghe khc nhau. Bi vy cn phi phn bit nghe v lng nghe.
- Nghe l th ng, l trng thi t ng mang tnh cht vt l.
- Lng nghe l ch tm, ch ng. Lng nghe i hi tp trung, tm kim tch cc  ngha ca i tng ni. Trong giao tip chng ta phi c gng to ra trng thi lng nghe  n nhn v hiu ng,  giao tip ci m,  chn lc thng tin.
Trong giao tip lng nghe s tip nhn y , trn vn thng tin, gip li th trong gii quyt vn  v m phn vi i tc. Lng nghe cn th hin s tn trng i tc v s hp tc lm vic v gii quyt vn . Lng nghe kt hp quan st cn c th nghe c nhng g m ngi ta khng ni bng li.
Lng nghe s lm tha mn ngi ni, th hin mnh tn trng ngi ni. Lng nghe s nhn nhiu thng tin dn ti vic ra quyt nh chnh xc hn. Lng nghe ngi khc s lm cho ngi khc c cm tnh vi mnh, thn thin vi mnh khi lm vic. lng nghe lm cho mnh nm bt chnh xc tnh cch, tnh nt v quan im ca ngi ni chuyn. Lng nghe gia hai bn to khng kh trao i thng thn, hiu nhau dn ti gii quyt mu thun, tm kim gii php nhanh hn.

2.2.2 Cc yu t nh hng
Tuy nhin c rt nhiu yu t nh hng n vic lng nghe ca chng ta. Chng ta trc ht cn trnh nhng thi quen c nh hng n vic lng nghe.
- Th nht: gi v lng nghe, t ra lng nghe lm hi lng ngi ni nhng li khng nghe.
- Th hai: nghe qua loa cc thng tin, nghe m khng c suy ngh, chn lc, nghe ht m khng hiu.
- Th ba: bung tri tng thi im, lc lng nghe, lc khng, dng thng tin khng lin tc.
- Th t: lun bnh lun v cch ni hoc tc phong, b ngoi ca ngi ni theo tiu chun ca bn thn.
- Th nm: khng nghe nhng vn  khng th v theo suy ngh ca bn thn.
Bn cht ca s khng lng nghe l t nhin ca con ngi nn mun lng nghe cng phi tp luyn. V tc  suy ngh ca con ngi nhanh hn rt nhiu so vi tc  ni, nn khi nghe xong con ngi cn nhiu thi gian  suy ngh chuyn khc m sao lng vic nghe.
T nh chng ta thng c luyn vit, ni ch khng ch  rn luyn cch lng nghe.  cng l mt tr ngi t nhin hnh thnh trong qu trnh ln ln ca con ngi. Vic thch nghe nhng ch  ny m khng thch nghe ch  khc, c th l ch  phc tp hoc nhy cm, mang tnh ch quan cng l mt yu t nh hng n vic lng nghe. Cc yu t nh hng khc nh s thiu kin nhn, thch d ght kh, khng kt hp cc k nng quan st c ch iu b ngi ni v nghe ging m iu li ni, thnh kin vi ngi ni cng nh hng nhiu n vic lng nghe.

2.2.3. Rn k nng lng nghe
Mun lng nghe tt, hiu qu th ngi nghe cn c tp luyn. Sau y l mt s li khuyn  c th ci thin k nng lng nghe ca chng ta.
- Chm ch khi nghe: nhn vo ngi ni, tp trung n nhn tng li.
- Nghe cho ht li ht  ngi ni: khng st rut, nn nng; khng ngt li ngi ni; gt u ng h, khng ngt li ngi ni.
- Tm hiu  ngha ca cc cu ni, li ni v cc c ch, hnh ng ngn ng khng li.
- Khch quan khi lng nghe, ng ch trng qu vo phong cch ngi ni, ch  ni dung, c on trc din gi mun ni g, ch no ngi ni nhn mnh.
- Trao i phn hi vi ngi ni khi h ni xong, c th tm tt ni dung  nghe c  khng nh thng tin vi ngi ni.
- Loi b cc nhiu vt l: ting n, ngi i li, phng tin, v tr ngi
- Tng hp v x l thng tin khi nghe ni: phn tch nhanh, i chiu vi thng tin  bit

Nn lm:
- By t mi quan tm
- Kin nhn
- C hiu vn 
- Th hin khch quan
- Biu l ng cm
- Tch cc tm hiu  ngha
- Gip ngi ni pht trin nng lc, ng c hnh thnh  ngh, quan im v  tng
- Gi im lng khi ang nghe

Khng nn:
- Thc gic ngi ni
- Tranh ci
- Ngt li
- Nhanh chng ch trch khi cha r
- Ln ging khuyn bo
- Vi vng kt lun
-  tm l ngi ni ln t tm l mnh

2.3 K nng vit
2.3.1 Khi nim
Vit theo ngha n gin l hnh ng t ch, biu tng, s, t,  ln giy theo quy lut, cu trc ca ngn ng. Vit thng l  nhn mnh hoc gii thch  tng. Mt bi vit tt l mt bi vit r rng, xc tch, ng ng php v c php, ng hnh thc trnh by, ngi c c th d dng hiu c ng v chnh xc  tng, mc ch ca ngi vit.

2.3.2 Tm quan trng ca vit
Vit l mt cng c tt  giao tip c hiu qu, mun rn luyn k nng vit tt cn phi luyn tp. Vit gip ngi gi thng tin c th xem xt tt c cc kha cnh chi tit ca thng tin m mnh gi di dng vn bn chnh xc v trau chut. Vit lm ngi nhn thng tin c th xem qua thng tin sau  nghin cu n chi tit hn, lu li thng tin lu di. Vit l  truyn ti thng tin. K nng vit tt m ra nhiu c hi cho chng ta trong cng vic v thng tin (c hi c nhn, c hi nhm ni bn lm vic).

2.3.2 Qu trnh vit mt vn bn
 vit mt vn bn no  ngi ta ch  n cc yu t:  cng, ni dung, vn phong, cu vn v  chnh xc. Lp  cng cho vn bn c th theo cch truyn thng, lit k cc  chnh cp mt, cp hai ri cp nh hn na. Hoc lp  cng theo s  t duy, t mt  chnh phn ra cc  chnh cp mt,  chnh cp hai v nh hn na lin h vi nhau nh cc dy thn kinh.
Cc bc son tho mt vn bn gm chun b, thc hin vit, v hon thin bi vit.
- Chun b:
u tin l vic xc nh i tng c: bi vit ca bn l ni cho ai  mt iu g , l ngi vit bn phi quyt nh vit ci g v vit nh th no  ni cho ngi c ca bn mt cch tt nht. V th bn phi xc nh ai l ngi c bi vit ca bn, h s thu c g khi c bi vit ca bn, ti sao h li phi c (y l vn  quan trng  xc nh mc ch vit ca bn) v cui cng l h c bi vit ca bn nh th no.
Th hai l xc nh ni dung bi vit, vit ci g, thng ip chnh l g. Phi xc nh ni dung bi vit chnh xc theo ch  ca bi vit, sau  phi sp xp cc  tng ca bi vit mt cch h thng, hi ha.
Th ba l xc nh vn phong ca bi vit. Vn phong bi vit ca bn l cch m bn giao tip vi ngi c ca bn. Vn phong tt gip cho ngi c d dng thu c thng tin trong bi vit ca bn nhanh nht v chnh xc nht. Vn phong th hin qua ngn ng s dng trong bi vit, cu trc ca bi vit v nhng minh ha s dng trong bi vit.
Th t l xc nh hnh thc trnh by. Ty theo cc loi vn bn khc nhau th hnh thc trnh by khc nhau. Hnh thc trnh by bao gm nh dng bi vit, cn l (trn, di, tri, phi), loi ch, c ch, tiu ... Mt s vn bn thng c quy nh hnh thc trnh by nht nh chng ta phi tun theo (bi bo, bo co khoa hc, lun vn)
-Thc hin vit:
u tin phi vit bn tho. Sau khi xc nh c cc vn  chng ta bt tay vo vit bn d tho u tin. Mt bi vit thng c phn gii thiu, phn trin khai  tng v phn kt lun.
Phn gii thiu: Mc ch ca phn gii thiu thng cho ngi c bit ch  bn vit l g, thng bo cho ngi c v quan im ca bn, gi c tr t m cho ngi c  tm hiu v bi vit ca bn. Phn gii thiu nn trnh by chung v ch  ca bi vit sau  kt thc vi  chnh ca ch  m bn vit.
Phn chnh: Phn ny bao gm cc on gii thch cc  ca bi vit. Phn chnh gm cc on vn. Mi on thng gii thch trn l mt  ca bi vit. Gia cc on s dng t chuyn tip  m bo s thng sut gia cc on.
Phn kt lun: y l phn cui cng tng kt li cc  chnh ca bi vit, nhn mnh mt ln na thng ip mun gi.
Sau khi vit xong bn tho th s l cng vic chnh sa bi vit. Chnh sa l qu trnh xem li bi vit ca bn. C th thc hin nhiu ln chnh sa. Mi ln chnh sa gip ngi vit n st hn mc ch d nh vit. Chng ta thng chnh sa v ni dung sao cho st vi ch , chnh xc, y . Chnh sa vn phong bi vit v ngn ng s dng, minh ha, cu trc. Chnh sa v hnh thc trnh by c ng vi loi vn bn m bn vit hay khng, ng php, chnh t...
- Hon thin bi vit:
Sau khi chnh sa bn thm vo hay bt i nhng phn cn thay i v hon chnh li bi vit bng cch thm vo hay bt i nhng lin t ni cc on vn, xem xt bi vit c theo logic hay khng, sau  sa theo ng hnh thc quy nh v mc nh.

2.4 K nng ni v thuyt trnh
2.4.1 Ni v s dng ngn t
Ngn t c hiu l h thng nhng t v cc nguyn tc kt hp chng m nhng ngi trong cng ng dng lm phng tin truyn t thng tin cho nhau.
K nng ni hiu qu l kh nng biu t bng li ni, l mt loi nng lc c th hin qua khu ng  truyn t thng tin, biu t t tng, tnh cm mt cch chnh xc, sinh ng, c sc thuyt phc.
K nng ni c quyt nh bi 3 yu t: s pht m (phonation), kh nng din t (articulation) v s pht m chnh xc (pronunciation). S pht m c cc c trng v cao  (ging cao, thp), trng  (di, ngn) v cng  (mnh, yu). Kh nng din t lin quan ti cch pht m, khuyt tt c quan lin quan n pht m, v s bt cn trong khi ni cng nh im mnh v yu ca ting a phng. Pht m chnh xc lin quan n cc t kh pht m, pht m ln ln mt s ch  mt s vng ly ting ph thng ca mt quc gia lm chun.
S dng ngn t tt gip truyn t thng tin v gii quyt cng vic nhanh chng, hiu qu. N to ra mi quan h tt p trong giao tip. N gip con ngi nng cao uy tn bn thn, t khng nh v l cng c to nh hng i vi ngi khc.

2.4.2 Chun b bi ni
Trc khi ni hoc trnh by vn , thng tin no  cn phi c bc chun b. Chun b bi ni l bc quan trng. Nh Richard Hal, mt nh thuyt trnh ngi M ni rng thnh cng bi thuyt trnh ca ng l chun b, chun b v chun b. Mt bi ni chuyn thng thng gm ba phn: m u, ni dung, v kt lun.
- M u/t vn :
M u l phn nu ra thng ip chnh mnh mun gi ti ngi nghe. Phn m u nu mc ch, tm quan trng ca bi ni.  m u cho linh hot c th dng mt hot ng gy hng th, mt cu chuyn c k, mt cu hi gi suy ngh c a ra hoc a ngay ni dung khi qut bui ni chuyn.
- Ni dung:
u tin la chn cc ni dung chnh, ni bt th nht, th hai th ba vit ra giy, sau  sp xp cc ni dung  theo th t ri vit thnh cc on vn. Sau  vit cc  lin kt gia cc ni dung ny. Ton phn vit  chun b s dng mt kiu hnh vn. Chun b cc s liu thng k  h tr, minh ha cho cc  kin a ra. Chun b mt s giai thoi hoc cu trch dn, mt s cu chuyn vui, li ni a  a vo trong lc ni nu thy ph hp. Chun b thm nhng hnh nh, v d minh ha cho bi ni.
- Kt lun:
Phn kt lun phi nhn mnh  tng ch o ca bi ni, thng ip chnh mt ln na. Dng bi ni  mt cu trch dn hay, chn lc, kch tnh lm p bui ni chuyn. Phi th hin v c thi  trn trng i vi ngi nghe ngay khi vit chun b.
Khi ni s dng ngn t theo nhng li khuyn sau: chnh xc, r rng, d hiu, sinh ng, c th, gn gi, nh nhn, lch s, ph hp bi cnh, ph hp i tng, hng vo i tng, kt hp yu t phi ngn t, phi hp kho lo vi cc yu t minh ha

2.4.3 Ngn ng c th
Khi ni trc mi ngi, ngn ng c th cng mang thng ip tt hoc xu gi ti ngi nghe. y l cc yu t phi ngn t.
Ngn ng khng li gm c: nh mt, nt mt, tip xc c th, t th ng ng, chuyn ng tay, di chuyn, khong cch, trang phc. Khi ni ngn ng khng li b sung cho li ni. Trong khi ni t th ng cn thoi mi, t nhin, hai chn ng trn khong cch bng vai Trnh t to ra cc trng thi ng g b nh nghing ngi, ng ngi v trc. Tay c cc c ng va phi, minh ha bng cc ngn tay v bn tay, trnh vung tay v c ng thi qu. Nu ng khng c bc th hai bn tay  trc bng, v tr ngang tht lng. Trnh chp tay ngang hng hoc khoanh tay trc ngc. Khi ni vi ai  nn nhn vo mt h. Khi ni vi m ng th nhn bao qut vi con mt thn thin, ming lun ti. Ngn ng khng li cng cn phi c rn luyn cho thnh thi quen v  t tin th phi chun b k.

2.4.4 K nng thuyt trnh, trnh by:
Thuyt trnh l trnh by trc mt s hoc nhiu ngi v mt vn  no . Thuyt trnh c th ch trong mt vi pht, nhng cng c th nhiu gi. Thuyt trnh c th vi mc ch thng bo (bo co vi mi ngi vic mnh  lm hoc v vn thuc mi quan tm ca mi ngi) hoc thuyt phc (bo co v li ch ca vn  no  v ku gi s ng tnh ca mi ngi, dn ti hnh ng sau thuyt trnh). Thuyt trnh tt cn c s chun b. Thng thng ngi ta chia ra 3 cng vic: chun b thuyt trnh, tin hnh thuyt trnh v nh gi kt qu thuyt trnh. Hai cng vic u bt buc phi c  mi bi thuyt trnh.
- Chun b thuyt trnh:
Trc khi thuyt trnh bn phi t t cc cu hi: bn c hng th vi ch   v c  kin thc  thuyt trnh hay khng? Mc tiu ca bi ni ca bn l thng tin, thng bo hay thuyt phc? Bn c bao nhiu thi gian cho chun b, cho thc hin? i tng ngi nghe bn thuyt trnh l ai (ngi lao ng nng thn, min ni, cc b, cng chc, thanh nin, sinh vin, hc sinh, nh khoa hc, hi ng xt duyt, tuyn chn)? Ngn ng no c s dng? Thng ip chnh ca bui thuyt trnh ca bn l g? Bn thuyt trnh  u v cc phng tin c s dng h tr khi thuyt trnh l cc phng tin no? Kim tra c s vt cht ni thuyt trnh xem tt c mi ngi c th nghe r khng, c thit b m thanh tt khng, nhn r khng? Liu nh sng trong phng c va ? Dn bi ca bi thuyt trnh chia lm 3 phn: m u, thn bi (ni dung) v kt lun.
- Thc hin thuyt trnh:
Thc hin thuyt trnh cng theo th t: vo  (m u), ni dung chnh, v kt lun (kt thc). Nn nh rng mc  ch  ca ngi nghe gim dn v cui bui thuyt trnh v gn cui c th tng ln cht t. Do  khong gia bui phi lm th no ko s tp trung ca ngi nghe, gim cng thng.
Khi thc hin thuyt trnh phn m u c th c nhiu cch tin hnh. C th vo bui thuyt trnh mt cch trc tip, c th dn nhp bng nhng s kin tng phn, c th dn nhp bng mt cu chuyn lin h vi vn  trnh by, c th bng cch t cu hi vi ngi nghe, c th dn nhp bng bng mt cu trch dn ca ngi ni ting, c th dn nhp bng s vic gy chn ng hoc sc M u thuyt trnh phi gy c s ch , xy dng lng tin ca ngi nghe v nu c khi qut vn  thuyt trnh.
Phn ni dung ch yu phi c lin kt cht ch cc  vi nhau. Trong khi thuyt trnh phi quan st, c bin php duy tr s ch  ca ngi nghe.  duy tr s ch  cn s dng cc bin php sau y cho ng lc: khng c nguyn vn hay thuc lng; khng dng nhiu li l hng hn; sp xp cc  theo trnh t hp l; a nhng v d, s liu minh ha; xy dng cch ni ty theo i tng ngi nghe; c th thm nhng cu ni, cu chuyn khi hi ng lc v lin h vi ni dung trnh by; lun bm st ch .
C th thuyt trnh c thc hin bng cch hc thuc lng, c bi  vit, da vo cc phiu ghi dn , v thuyt trnh t do. Mi kiu thuyt trnh c nhng u im v nhc im ca n. Thuyt trnh khi hc thuc lng c nhiu hn ch nht v s n iu, s dng ngn ng, c ch khng da vo phn hi ca ngi nghe m thay i, nu qun mt ch no  th lm hng c bui ni chuyn, n ch hiu qu khi li thuyt trnh ngn, lc khai mc bui hp no . Thuyt trnh bng cch c thch hp vi nhng bui ni chuyn, bo co s liu phc tp, khng c php ni sai s liu, bo co khoa hc, thi gian hn ch so vi ni dung. Cch trnh by c nh vy to khong cch ngi ni v ngi nghe, d gy bun ng, phn tn, sao lng vic nghe. Cch thuyt trnh t do hoc ghi dn  l hp dn ngi nghe hn c v ty theo i tng ngi nghe, phn ng, phn hi ca ngi nghe khi quan st m thay i cch ni, ngn ng khng li, thm chuyn vui, cu ni a. Cch ny ngi thuyt trnh phi chun b k, c kinh nghim nhiu, l cch m cc thy gio v nh thuyt trnh chuyn nghip s dng.
Phn kt thc bi thuyt trnh nn nhc li, tm tt cc  chnh  trnh by, m t, khuyn co cc hot ng tip theo, kt thc bng nhn xt tch cc. Yu cu khuyn co ngi nghe hnh ng hoc xem xt vn  theo quan im mi. Nn kt thc thuyt trnh ng thi gian  ghi trong chng trnh hoc sm hn t giy. Sau  nn dnh mt thi gian  cho ngi nghe hi v tr li cc cu hi, thc mc . Cm n ngi nghe trc khi dng ni. Nu c nh gi th cn thit k cc phiu nh gi bui thuyt trnh, hoc nghe nhng phn hi  ci thin thuyt trnh ln sau v c dnh thi gian cho vic nh gi ny.

2.4.5 K nng i ph vi hi hp khi thuyt trnh:
Ni, thuyt trnh trc m ng vi a s mi ngi u l cng vic kh, gy ra hi hp, run, nht l nhng ln u. S hi trong trng hp ny l bn cht t nhin ca con ngi v nhu cu b e da (theo Maslow). Vic s hi s biu hin v mt sinh l nh v mi hi, tay chn run, ni lp hoc ni nhu.
 i ph vi hi hp v run th trc tin phi chun b k ni dung bi ni v tp ni mt mnh trc khi ni trc m ng. Khi tp ni c th nh mt s ngi nghe v nhn xt  sa v ni dung, ging ni, t th, dng c h tr. Ni chung vic chun b k gp phn rt quan trng vo chng hi hp. Trc khi thuyt trnh nn c chun b c v mt sc khe, ngh ngi thoi mi mt bui trc thuyt trnh. Cn dnh thi gian lm quen v s dng thnh tho cc dng c h tr, lm quen vi cn phng ni thuyt trnh.
Bui thuyt trnh nn n sm trc ngi nghe, c th lm quen vi vi ngi nghe i sm  tranh th s cm tnh ca h. Khi c gii thiu i thong th t di ln bc Trong khi thuyt trnh phi tin tng rng ngi nghe c thin ch v quan tm ti vn  mnh trnh by. Khi ni lun nhn xung ngi nghe, bao qut thnh phng  lun c mi lin h vi ngi nghe  iu chnh. Hy coi bui thuyt trnh nh l cuc ni chuyn, i thoi gia hai ngi vi nhau. Thnh thong ht th su hoc ung mt hp nc lnh nh khi c cm gic hi hp. Phi hp cc cng c h tr, chiu ln bng hnh nh no . C th cm cht ci g  (cy bt, mnh giy, hay micro) trong tay.

 Cu hi (bi tp) cng c:
1. Th no l trao i, quan st, lng nghe v trnh by?
2. Cc k thut trnh by trc quan? Cho v d.
3. Quan h tng tc Cu hi  cu tr li thch hp l g?
4. Thc hnh vit mt bi bo co, chun b mt bi thuyt trnh.`},{id:3,name:"Chng 3: C LNG CA D N",shortName:"C LNG CA D N",content:`Chng 3. C LNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c th no l c lng.
2. Bit c mt s phng php c lng

3.1 Khi nim
c lng l mt qu trnh mang tnh cht lp. Ngay trong giai on xc nh,  c th vit k hoch d n ban u, chng ta  phi tin hnh c lng ln th nht. Tuy nhin, c lng  giai on ny thng sai s t 50% n 100%. Sau khi lp k hoch  giai on phn tch, chng ta phi xem li cc c lng ny v chnh li k hoch d n ban u thnh k hoch d n cui cng. Giai on ny, c lng chnh xc ln gp i: sai s ch cn t 25% n 50%. Sau khi hon thnh thit k mc trung gian, chng ta xt li ln na cc c lng. Sai s lc ny gim xung cn 10%.

3.2 K thut c lng
C ba k thut chnh c dng  c lng: nh gi chuyn gia, qui trnh lch s v cng thc.

3.2.1 S dng nh gi chuyn gia
L phng php da vo kinh nghim ca cc nh lp trnh chuyn gia
- u im: l rt nhanh v nu chng ta tm ng c mt chuyn gia ng ngha, th vic c lng c th rt chnh xc.
- Nhc im: nu chng ta cn tm mt chuyn gia c kinh nghim trong lnh vc tng ng, m nhng chuyn gia nh vy li thng kh tm. Hn na,  chnh xc ph thuc vo thi gian chuyn gia b ra  nh gi. c lng s khng th tin cy c, nu chuyn gia  li giao cho mt ngi khc thc hin. Ngoi ra, vic ch da vo  kin ch quan ca s t chuyn gia, cng l mt iu nguy him.

3.2.2 Da vo quy trnh lch s
 khng phi ph thuc vo mt vi ngi v lm cho c lng ca chng ta c c s khoa hc hn, chng ta nn lu gi quy trnh lch s. Chng ta hy vit ra mi cng vic cn bao lu  hon thnh v ai l ngi chu trch nhim. Sau , chng ta c th so snh cng vic cn nh gi vi nhng cng vic tng t  c thc hin trong qu kh v i ti mt c lng. Nh vy, chng ta cn chia d n thnh nhng cng vic thng hay lp li  d so snh.

3.2.3 S dng cng thc
C nhiu cng thc  c cng b v c lng phn mm. Cng thc ni ting nht c tn l COCOMO (COnstructive COst MOdel). Cng thc ny c th c dng  c lng gi thnh d n, ngy cng (ngi thng), lch biu (thng), v bin ch (s nhn vin) cho tng giai on sau:
- Thit k s b (PD) - Ca chng ta l giai on Phn tch
- Thit k chi tit (DD) - Ca chng ta l giai on Thit k
- Lp trnh v kim th (CUT) - Nh ca chng ta
- Kim th h thng (ST) - Ca chng ta l giai on Chp nhn
- Kim th H thng

C ba kiu u vo cho COCOMO: trc ht l chi ph hng thng cho i ng nhn vin. Cc kiu nhn vin c th l ngi lp trnh, nh phn tch, ngi kim th, nhn vin hnh chnh, ngi vit ti liu k thut

Nhn chung, COCOMO thc hin c lng tuyt vi v cc khon mc  y l nhng yu t xc nh  di d n. Nhng c mt kh khn: mc cui cng ca COCOMO yu cu bit s dng chng trnh gc (LOSC). C  kin cho rng n lc chng ta c  hiu bit v h thng  tin on chnh xc LOSC, th chng ta cng chng cn cng thc no na - c l lc y chng ta  c th c lng c ton b d n.

3.3 Cng thc im chc nng
Cch tip cn COCOMO c ci tin kh nhiu bng nhng sn phm tnh cc hm cho LOSC nu trn, ri lp kt qu vo cng thc ca COCOMO. Mt trong nhng sn phm nh vy l Before You Leap (BYL) ca Nhm Gordon.

Mt sn phm khc cng nn xt  y l estimac ca Hip hi My tnh (Computer associatess). CA-estimac cho php chng ta tm gi thnh, ngy cng, lch biu, v bin ch nh trong COCOMO, nhng c thm cc yu cu phn cng (hng IBM), phn tch chia theo s kin ti chnh, phn tch ri ro v gi bo hnh cho c cc mi trng mt v nhiu d n. CA-estimac c th tnh ti c cc cng c pht trin h thng hin i nh b sinh chng trnh hay b to bn mu. Thm ch n cn c th c lng cc l trnh c mua hay pht trin theo yu cu.

3.3.1 c lng vic lp trnh
Mt cch tip cn cng thc t ra rt thnh cng cho vic c lng giai on lp trnh l cch tip cn im chc nng n gin. Ta hy xt chi tit cch tip cn ny l  hiu tc dng ca cc cng thc. V c bn ch c hai nhn t nh hng ti thi gian  thc hin mt cng vic:  phc tp ca cng vic (C) v hiu nng ca ngi thc hin. Hiu nng ca ngi ph thuc vo s nm kinh nghim ni chung (G) v tri thc v mt cng vic  cho (J). Di dng cng thc iu ny c th c din t l:
D = C x (G + J) [cng thc 1] vi
- D l  di thi gian thc hin cng vic
- C l nhn t  phc tp
- G l nhn t kinh nghim ni chung
- J l nhn t tri thc v cng vic ang xt

3.3.2  phc tp
 suy ra nhn t  phc tp cho mt cng vic chng ta phi chia n ra thnh cc chc nng nh nht lp li c v b sung thm  phc tp ca tng chc nng. i vi mt cng vic lp trnh, chng c gi l cc im chc nng. Cc im chc nng c th l ngi dng a vo, ngi dng hin th, thit b ngoi vi vo/ra, cu trc li d liu, kim tra iu kin, tnh ton, nhy v gi.  phc tp ca chng trnh tt nhin ph thuc vo ngn ng c dng v  phc tp ca tng thi im chc nng.

3.3.3 Cc nhn t  phc tp c lng cho vic lp trnh
Cc nhn t ny c suy ra bng cch dng cch o hin thi ri iu chnh sao cho cng thc D = C x (G + J) cho kt qu tnh bng ngi - ngy.  phc tp tng cng (C) i vi mt chng trnh s l tng cc nhn t cho cc im chc nng.

3.3.4 Hiu nng
Chng ta cn thit lp cc nhn t cho tnh hiu nng ca i ng nhn vin ca mnh. iu ny cn kh hn nhiu vi vic tnh cc nhn t  phc tp cng vic, v hiu nng ca con ngi c th thay i tu theo mc  quan tm ca h, thi ,... Hiu nng chu nh hng bi nhng nm kinh nghim ni chung v hiu bit v cng vic. Sau y l mt danh sch cc nhn t da trn kinh nghim chung ca mt c nhn:

Nhn t hiu nng da trn nm kinh nghim ni chung (G):
| Kiu ngi lp trnh | Nm kinh nghim | Phm vi nhn t |
| :--- | :--- | :--- |
| Cp cao | 5 + | 0.5 - 0.75 |
| Trung bnh | 1.5  5 | 1.0 - 1.5 |
| Tp s | 0.5 - 1.5 | 2.0 - 3.0 |
| Hc ngh | 0.0 - 0.5 | 3.5 - 4.0 |

Tc  m mt nh chuyn mn s to ra sn phm ph thuc khng ch vo kinh nghim chung (G) c tnh  trn, m cn ph thuc khng ch vo kinh nghim i vi mt cng vic hin ang lm v vi cc cng vic c lin quan. Bn cnh , khi lng tri thc thc t cn ti nn c a thnh mt nhn t. C th dng bng sau y  nh tnh cho tri thc ny (J).

Tri thc v cng vic:
| Tri thc v cng vic | Tri thc cn c: Nhiu | Tri thc cn c: Va | Tri thc cn c: Khng cn |
| :--- | :--- | :--- | :--- |
| Tri thc chi tit v vic ny v tri thc v nhng vic lin quan | 0.75 | 0.25 | 0.0 |
| Tri thc tt v vic ny v kh v vic lin quan | 1.25 | 0.50 | 0.0 |
| Tri thc kh v vic ny v khng bit v cc vic lin quan | 1.50 | 0.75 | 0.0 |
| Khng bit v vic ny v bit chi tit v cc vic lin quan | 2.00 | 1.25 | 0.25 |
| Khng bit v vic ny v khng bit v cc vic lin quan | | | |

3.3.5 Kt lun v phng php cng thc.
Phng php ny dng c nu chng ta xy dng cc nhn t chnh xc. Ci hay ca cch tip cn ny l  ch ta c th dng n cho bt k cng vic no, d  l lp trnh hay xy dng. Lu  rng phng php ny, nh bt k phng php c lng no khc, u tu thuc vo vic phn chia nh cng vic nh th no.

3.4 Qui tc c lng theo DEC (v cc cng ty ln khc)
- Khng bao gi yu cu mt ngi khng c kinh nghim lm c lng. c lng ch yu ph thuc vo kinh nghim. C th  mt ngi tp s hc lm c lng bng cch hoc  anh ta cng lm vic vi mt ngi c kinh nghim, hoc ngi c kinh nghim a ra cc cng thc chi tit ri trao cho ngi tp s kim chng.
- Lp cc nhm lm c lng nu chng ta c  nhn lc. Hiu qu ca vic kt hp nhiu tr tu tun theo quy tc bnh thng: hai tr tu gp li hiu qu gp bn ln mt tr tu n l; ba tr tu gp chn ln,...
- Khng bao gi p buc mt nh chuyn mn nh cn b lp trnh lm c lng. Ngi gim st trc ht nn hi ngi lp trnh anh ta d kin cng vic mt bao lu. Nu ngi gim st khng ng , th c th thng lng vi nhau.
- Khng bao gi ly trung bnh ca cc c lng. Vi mt sn phm chnh, nn c t nht hai nhm hay hai ngi lm c lng c lp vi nhau. Nu c sai khc ln, hy mi mi ngi ngi li vi nhau v i ti tho thun. L do duy nht  hai ngi cng kinh nghim nh nhau cho c lng khc nhau (v cng mt vic) ch l ch mt ngi c tnh n iu g  m ngi kia khng tnh.
- Chia nh xung mc mt tun hay t hn. Mt cng vic phn mm thc hin trong mt tun dng nh l iu mi ngi u hnh dung v c lng c.
- Lun lun cng thm (nhn thm?) phn ngu nhin.
- i vi cc nh qun l hay khch hng, hy lun lun a ra c lng trong khong t ... n ... y l vn  tm l. Nu chng ta ni vi nh qun l l cng vic cn 12 thng ng ta s ngh chng ta c mt con s chnh xc; nhng nu chng ta ni cng vic ny i hi t 10 n 14 thng, th ngi ta s hiu y l c lng.
- Hy dng "cm gic" ca mnh. Sau khi chng ta xy dng xong c lng, hy t hi, "c lng ny  n cha?" Cm gic li c th tr nn rt chnh xc mt khi chng ta  c kinh nghim, t ra th chng ta cng cm nhn c l c lng nh vy c vt ra ngoi phm vi "c lng" hay khng.

3.5 Tin trnh c lng
Nu nh c mt chng trnh phn mm qun l d n tt, chng ta c th s dng n  pht trin WBS ca ring mnh v a vo cc c lng cho tt c cc cng vic tng ng. Nu chng ta khng c, hy xy dng v dng cc mu sau:

Tm tt c lng d n
D n: ..................................................... Ngy thng: ...........................................
Khch hng: ............................................ Tc gi: ..................................................
n v: ....................................................
Xc nh
Phn tch
Thit k h thng
Chun b ATP
(ATP - kim th chp nhn)
Lp trnh (ti liu, chng trnh, kim th)
Chun b ti liu s dng
Kim th h thng
Chp nhn
Hun luyn khch hng
Vn hnh (bo tr)
Qun l d n
Hp d n
Ngu nhin
Cc vn  khc
Tng cng ---------------------------------------------

3.5.1 Chi tit c lng cng vic cho d n
Khon mc: ............................................ Tc gi: ..................................................
Ngy thng: ............................................ Tham kho WBS: ..................................
-----------------------------------------------------------------------------
-----------------------------------------------------------------------------
Nhim v | M t LX | CMP DYS | c lng | Ch thch
-----------------------------------------------------------------------------
Tng cng
-----------------------------------------------------------------------------
Trng c tn CMPLX l  phc tp cng vic: Thp, Trung bnh hay Cao. iu ny v sau s c dng  phn vic cho ngi c kinh nghim thp, trung bnh hay cao. Trong lp trnh, phn chia bao gi cng l Thit k, Lm ti liu, Lp trnh v Kim th.

3.5.2 Chi tit c lng lp trnh cho d n
Khon mc: ............................................ Tc gi: ..................................................
Ngy thng: ............................................ Tham kho WBS: ..................................
-----------------------------------------------------------------------------
Nhim v | M t LX | CMP DYS | c lng | Ch thch
| | | | Thit k, Ti liu, Ch/trnh, Kim th
-----------------------------------------------------------------------------
Tng cng
-----------------------------------------------------------------------------
Mt trang tnh chi tit c th tri trn cc trang tnh chi tit khc. Khng c gii hn nhng chng ta khng nn chia nh qu na ngy.

3.6 Kt lun v c lng
c lng, l kh nng yu nht ca chng ta, nhng tt c mi k hoch v kim sot u ph thuc vo k nng c lng.
c lng l mt qu trnh lp - n cn phi c hiu chnh dn.  l l do v sao cn phi c cc s kin mc trong qu trnh xy dng mt sn phm. S kin mc cho php ta dng li, tnh ton xem cn bao lu  t ti  v c lng li ngy thng cho cc s kin mc tip theo da trn kinh nghim  c.
c lng vn cn l mt ngh thut. Khng tn ti phn mm hay cng c no c sn  gip chng ta lm vic ny.

 Cu hi (bi tp) cng c:
1. Vo nhng lc no trong vng i d n chng ta cn c lng (v c lng li) v  chnh xc ca cc c lng  nh th no?
2. Hy m t phng php c lng nh gi theo chuyn gia. u l u nhc im ca phng php ny?
3. Ti sao phng php lch s li tt hn nh gi chuyn gia?`},{id:4,name:"Chng 4: LP LCH D N",shortName:"LP LCH D N",content:`Chng 4. LP LCH D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c cc khi nim v cng vic  lp lch cho d n.
2. Bit c cch nh x t k hoch vo lch biu.

Vic c lng c nu  phn trn l c lng v s ngi - ngy n lc cn  thc hin d n. iu ny cn c gi l thi gian trc tip. Vic lp lch nh x thi gian trc tip vo mt lch biu tht  cho thi hn theo lch, hay thi gian tri qua.

Chng ta bit rng cc bc thc t trong vic lp k hoch d n l:
Ngi lp k hoch (thng l Trng hay ph Ban qun l d n) lm chi tit Cu trc phn chia cng vic (WBS). Mt ngi hay mt nhm ngi c giao trch nhim thc hin cc hot ng mc thp nht.
Nhm c trch nhim ny c lng cc hot ng mc thp nht theo s ngi cn thc hin hay theo ngy trc tip.
Nhm c trch nhim cng ch ra cc hot ng trc  cn cho mi nhim v v gi  ngun ti nguyn cn cho nhim v .
Ngi lp k hoch v ra mng cc hot ng, thng di dng s  PERT.
Trng ban qun l d n ln lch cc hot ng
Phn ny m t chi tit cc bc 4,5 v 6, mng v lch cng vic.

4.1 S  PERT

PERT, ch vit tt cho k thut nh gi v xem xt chng trnh Program Evaluation and Review Technique, c Hi qun M pht minh ra nm 1958 khi pht trin tn la Polaris  mt d n bao gm 300.000 hot ng! Ban u PERT ch c dng  m t mt dy cc hot ng qua mt tp cc mi tn, nh trong hnh di

[Hnh nh: Hnh 4.1 S  PERT cho cc hot ng]

Mi mi tn biu th cho mt hot ng v c gn nhn theo tn hot ng , chng hn A, B, C... Nu mt hot ng khng th bt u trc khi mt hot ng trc n c hon tt th ui ca mi tn ca hot ng ny c t vo u ca hot ng trc . Trong hnh trn chng hn E khng th bt u trc khi D hon tt, G khng th bt u trc khi c C v F c hon tt. Cc im u v im cui mi tn  c gi l cc nt v c nh s. S  trong hnh trn dng nh c v tm thng nhng n c gi tr  v s  PERT cho bt k d n no, v n buc chng ta phi phn tch dy cc hot ng.

PERT cng ch ra hot ng no c tin hnh ng thi. Mt dy cc hot ng, nh A-B-C-G c gi l mt ng dn. Nu c cc thi dn hay cc phn ng dn song song nh ng B-C v ng D-E-F th hot ng B v C c th c thc hin ng thi vi cc hot ng D, E v F.

4.2 ng gng

C th t ti s ci tin kh ln cho s  PERT trn bng cch t thi hn cho mi nhim v trn PERT, nh trong/sau. Ta s thy cch xc nh thi hn khi ti nguyn (con ngi) c cp pht cho nhim v.

Trc ht, cn phi tnh ng gng. y l ng di nht trong mng c tnh bng cch cng dn thi hn theo ng ny. Chng hn, trong hnh sau ng nh l 26 ngy (ng gng) cn ng y l 25 ngy, vy nn ng trn l ng gng. ng kp ch ra mt ng gng hon chnh. Vic hiu bit v ng gng l iu ch cht vi ngi qun tr d n. N ch ra chiu di ca ton b d n: 26 ngy trong trng hp ca ta. N cng ch ra cc hot ng cn theo di. Nu bt k hot ng no trn ng gng b trt i (ko di hn k hoch) th ngy bn giao ca d n cng b ko trt theo.

[Hnh nh: Hnh 4.2 S  PERT c gn ti nguyn]

4.3 Th ni hay  chng

Cc hot ng khng trn ng gng c th c th ni hay  chng - tc l mt khong thi gian m cc hot ng  c th trt m vn khng nh hng ti ng gng v do  khng nh hng ti ngy bn giao. Trong hnh trn chng hn, cc hot ng D, E v F c 1 ngy th ni. (Tnh ton: cc hot ng trn ng gng B v C mt 11 ngy; ng thi cc hot ng khng trn ng gng D, E v F mt 10 ngy tt c; do  11 - 10 = 1 ngy th ni). Bt k hot ng D, E hay F hay c ba u c th ko di thm mt ngy m khng nh hng ti ng gng.

4.3.1 ng gng c th thay i

iu g xy ra nu hot ng D ko di 5 ngy thay v 3 ngy? ng gng  thay i cho ng D-E-F.  l l do ti sao ngi qun l d n phi thng xuyn cp nht mng theo mi thay i.

4.3.2 Th ni t do v th ni ton b

Trong s  PERT  di y, pha di cc hot ng ng gng n th Chng trnh A v n th Kim th A do ngi lp trnh 1 thc hin. Cc hot ng trn ng trung tm, n th chng trnh B v n th kim th B do ngi lp trnh 2 thc hin c 5 ngy th ni. Cc hot ng trn ng y, n th chng trnh C, n th kim th C v Tch hp c ngi lp trnh 3 v ngi ph trch d n thc hin. ng y c 5 ngy th ni tt c.

Th ni ton b l qung thi gian th ni m mt hot ng c trc khi nh hng ti ng gng. Th ni t do l khong thi gian th ni m mt hot ng c trc khi n nh hng ti bt k hot ng no khc (khng gng).

[Hnh nh: Hnh 4.3 Th ni hay  chng]

Th ni d n (th ni bt k theo bt k hot ng no) l mt cng vic ca ngi qun tr d n, c s dng tu theo cn nhc ca ngi ny.

4.4 Cp pht ti nguyn

Nu chng ta ang lm k hoch th cng th s  PERT l s  tt nht dng  cp pht ti nguyn. Trc ht hy v PERT b qua mi ngun ti nguyn. S  cho d n phn mm c th ta Hnh sau.

[Hnh nh: Hnh 4.4 S  PERT b qua ti nguyn]
X - Xc nh, PT - Phn tch, TK - Thit k, TH&KT - Tch hp v kim th h thng, HL - hun luyn ngi dng, VH - Vn hnh, ch/tr - chng trnh

Bc tip l v li PERT c tnh ti ti nguyn

4.4.1 Cp pht ti nguyn nhn lc

Mng trong Hnh trn c 10 hot ng ng thi tin hnh ti mt thi im v cng kt thc ng hn nu chng ta c 10 ngi lp trnh. (Hoc nu mt ngi lp trnh th phi dnh mt phn mi thi gian cho tng cng vic!) Hin nhin c cch tt hn  s dng ngi. Vic cp pht ti nguyn nhn lc mang tnh ch quan v tu thuc ch yu vo ngi sn c, nhng sau y l nhng iu phi xem ti:

- Giao nhim v cho tng c nhn c mc  k nng thch hp vi cng vic. ng trao cho mt chuyn gia mt cng vic khng  ngha g my cng ng trao mt vic rt phc tp cho ngi mi tp s.
- Giao nhim v tng t cho cng mt ngi. iu ny s lm gim thi gian hc vic hay nghin cu cng vic mi.
- Giao nhim v ch cht cho ngi chng ta tin cn nht. Ngi tin cy khng phi l ngi c th thc hin nhim v  trong ba ngy m i khi c th mt n nm hay mi ngy; ngi tin cy l ngi qu quyt cn nm ngy thc hin v  chnh l thi gian cn  thc hin nhim v.
- Giao cc nhim v cn lin lc ln nhau cho cng mt c nhn  gim thiu vic tng tc gia cc thnh vin.
- Ngi qun l d n s cn dnh thi gian  gim st, c bit vo lc bt u d n.

Hy phn mc ti nguyn nhn lc tht chi tit. Tt hn l nn  ba ngi lp trnh bn bu trong nm tun hn l s dng nm ngi trong tun u, khng cn ai c trong tun tip, ba ngi trong tun tip na v li vi ti nguyn nhn lc  c b tr. Thi gian trc tip cho tng nhim v s c rt bt nu c thm ngun nhn lc c s dng.

Quyt nh b tr nhn lc c thc hin da trn nhng iu sau: Lt1 (ngi lp trnh 1) dnh 100% thi gian cho d n, cn Lt2 v Lt3 ch lm vic cho d n trong thi k ngn. Cc n th A, B v C l kh nht nhng tng t nhau cho nn Ph ban qun l d n (PQlda) s gip Lt2 lp trnh trong tt c cc khu. Vi ph ban qun l d n nn gim st trn ng gng s lm gim s cng thng cho Trng ban qun l d n. Lt1 l mt chuyn gia cao cp lm vic mt mnh. Lt3 l ngi tp s cho nn c giao nhim v lm t liu. Lu  rng mi ngi u lm vic lin tc trong phn cng vic ca mnh.

4.4.2 Gim thi hn nhim v bng cch b sung nhn lc

Vic thm ngi vo mt nhm khng nht thit lm gim thi hn nhim v. Mt quy tc cng nghip l "Hy b sung thm t nht 10% s c lng thi gian trc tip cho tng thnh vin b sung vo mt nhm chuyn nghip". iu ny ko theo rng nu mt nhim v  mt ngi thc hin mt 10 ngy th vi 2 ngi s tn 11 ngy. Thm 10% cho mi ngi mt cch tch lu khi c nhiu ngi.

Thi hn nhim v c chuyn t hai hnh trn  c ly theo qui tc trn, cng vi mt s nh gi chuyn mn da theo vic phn chia cng vic tt n u, mi ngi trao i vi nhau nh th no...

4.4.3 Cp pht ti nguyn "Phi con ngi"

Ti nguyn phi con ngi cn cho mt d n phn mm c th l phn cng my tnh, phn mm, h iu hnh, thng tin, ti liu, hun luyn, bo hnh my tnh, cc dch v Cc khon mc ny c th c lit k ra bi ngi c trch nhim c lng. Thng thng chng ta khng bn tm ti vic t cc khon mc ny vo PERT nhng phi m bo chng c lit k ra.

4.5 Rng buc b ba

Nh ta  trnh by trc y, Chng ta c th mun cng vic c tt, r v nhanh: hy chn ly hai iu thi! Thm nhiu ti nguyn nhn lc s rt ngn thi gian nhng chi ph li cao. Chuyn mt ngi tin cy t mt hot ng phc tp nhng ngn hn sang mt hot ng di hn c th lm gim thi gian tng th nhng li c th gy kh khn cho ton b d n nu cht lng ca nhim v ngn hn b gim bt.

Nhiu cch chn la c th c khi chng ta phn phi ti nguyn. Bao gi cng hy chn nhiu cch tip cn, nhn vo hiu qu s dng ti nguyn v chi ph, chiu di ca ng gng v s n gin chung ca PERT. Ngi qun l d n phi nh gi b ba rng buc ny v i ti s cn bng tt nht tu theo cc u tin p t ln ba rng buc  do ngi dng hay qun l cp trn n nh.

Kt lun v vic rt ngn d n
Ta c nhiu gi thit  y: trc ht, cc nhim v ny u c th rt ngn c. Vic thm ngi hay lm thm gi khng tng tc thm c bao nhiu. Th hai l cc nhim v ny c th c rt ngn theo bt k th t no. Th ba l cc nhim v ny c th c rt ngn c lp nhau. Vic rt ngn mt nhim v c th nh hng ti cc nhim v khc

4.6 Lch biu hay s  Gantt

S  Gantt ch l mt s  theo thi gian. N mang tn ngi pht minh ra n, Henry Gantt.

4.6.1 Cc bc  v mt s  Gantt l

Bc 1: v cc n v thi gian trn nh. Chn n v thi gian sao cho chng ta ch cn mt s  thi. Chng ta s thy rng s  Gantt chnh l kinh thnh ca ngi qun tr d n. Tt c thng tin ph thuc lch u c th c t vo s  Gannt, v 99% cuc i ca ngi qun tr d n l tu thuc vo lch ny.

Bc 2: nh du tt c cc s kin lch  bit vo y.  l ngy l, ngh h, ngh php, hi hp, hun luyn, cam kt trc... Mi s kin m chng ta phi ln lch.

Bc 3: T s  PERT, hy lp lch cho tng hot ng. Bt u t giai on u tin. Xc nh, hy v ra mt thanh bng vi chiu di ngy theo lch trn PERT. Hy nh du nhng ngi c trch nhim v phn trm thi gian chng ta d kin cho mi ngi mt vic trong d n nu khng l 100%.

Bc 4: Lp lch cho iu bt ng theo tng nhim v. Vi mi nhim v hy t hi chng ta, "Liu c th c iu g lm ko di thi hn ca nhim v ny khng?" Chng hn, "iu g c th lm cho giai on xc nh d n ko di hn su ngy theo lch biu?" Hy ch  rng nn b sung thm hai ngy bt ng cho giai on xc nh, c th bi v ngi s dng bit qu t. Bng di y lit k mt s khon mc ri ro chung cho cc d n v cc nhim v c th ko di bi ri ro .

Bc 5: Nhn li cc bc 3 v 4, lp lch li cho tt c cc nhim v trn PERT, t tri qua phi v t trn xung di cho cc nhim v song song. Mt nhim v bt u khi s bt ng ca nhim v trc n chm dt. Hy b sung tht nhiu s bt ng vo nhim v ring cui cng, nhim v Kim th H thng, Xem nh mt bin php an ton.

D n: ABC
Tc gi: B. qun tr
Ngy: 5/9/1996
Cng ty: XYZ phn mm
Ngy bt u: 2/2/2012

Bc 6: nh du tt c cc s kin quan trng. nh u cc ct mc chnh c ch ra bi vic hon thnh cc s kin v sn phm quan trng. Phi chc chn cc ct mc  kh thng xuyn  cho thi gian gia mi ct mc l  ngn khng gy ra mt kim sot. C hai ti ba thng trong mt d n mi hai thng thng thng nn c mt ct mc. iu ny ko theo rng c th phi ba thm cc ct mc "gi", nh ct mc 3, duyt gia k lp trnh trong Hnh trn. Hy nh du cc cuc duyt xt v hp quan trng. Nhng ngi tham d vo tt c cc s kin ny s nh gi s tin trin ca d n. nh du ngy thng khi cn c cc thit b phn cng. Thi gian  cho nh sn xut cng di th chng ta cng c c hi nhn c hng ng hn.

4.6.2 Tp trung vo ng gng

Tnh ng gng
Nu chng ta ang dng my tnh  v ng gng th ng ny s c chiu sng bng  ho hay mu c bit. Nu chng ta v th cng th cn lm ni bt ng gng bng cch dng cc k t nh =.  xc nh ng gng, hy tun theo iu sau:
Nu chng ta  v s  PERT th hy tnh n   v lm ni bt cc khon mc gng tng ng trn s  Gantt, Vic tm ng gng trn s  Gantt cng n gin. Chng ta hy ly khon mc cui cng (bn phi nht) ri lm ni bt n - n bao gi cng nm trn ng gng. (Vn hnh trn hnh trn) Hy tm hot ng trc n (Chp nhn v Hun luyn) ri lm ni bt mt hot ng vi ngy chm nht (Chp nhn). Hy tm phn t ng trc ca hot ng cui cng ri lm tip nh vy cho ti khi t ti ngy khi u d n.
Tt c nhng nhim v gng hay khng c lm ni bt u c th th ni. Vic th ni xut hin t cui ca hot ng ny n u ca hot ng tip. Nu c nhiu vic k tip th phi i t ngy bt u ca vic sm nht. Vic th ni c v bng ng chm chm.

Gim ri ro trn cc khon mc ng gng
Mc du tt c cc nhim v trn d n u cn c   nhng chng ta trc ht vn phi xem xt cc khon mc trn ng gng. T hi mnh, "Nhim v ny cn nhng g, khi no v u l nh hng ca n nu n b mun hoc khng c sn?" Hy t k hoch phng bt ng vo ng ch. c bit hy ch  ti cc khon mc do ngi bn ngoi s kim sot ca chng ta cung cp. Hy xem liu chng ta c th c quyn g i vi nhng ngi cung cp ti nguyn . Vi nhn vin ni b, cch tt nht thc thi quyn lc l a u vo cuc hp xem xt vic hon thnh ca h. Vi nhng ngi hp ng bn ngoi hy c gng thng lng cc ct mc, tho lun v iu khon pht v bn giao mun. Hy tm ngun th hai cho khon mc m h cung cp.
Cc nhim v cng v sau th  ri ro cng cao. Cc nhim v sm hn dng ht cc ngy th ni ca d n lm cho cc nhim v sau tr nn cng thng. Bao gi cng phi thm  th ni cho cc nhim v cui. Nhim v cng ngn,  ri ro cng cao, v c hi cho nhim v ngn vt qu mc c lng th ln hn c hi cho nhim v di hn. Hy thm  ni ph cho nhng nhim v rt ngn, gng.

 Cu hi (bi tp) cng c:
1. ng gng trong d n l g?
2. Th no l th ni hay  chng, th ni t do v th ni ton b?
3. Rng buc b ba l g?
4. Hy cho bit cc bc  v mt s  Gantt
5. Ti sao Ban qun l d n cn tp trung vo ng Gantt?`},{id:5,name:"Chng 5: KIM SOT D N",shortName:"KIM SOT D N",content:`Chng 5. KIM SOT D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c th no l kim sot d n.
2. Bit c mt s phng php kim sot d n.

5.1 Kim sot d n
Gm ba mng cng vic chnh:
- Gim st tin  d n so vi k hoch  ra;
- Pht hin v gii quyt cc vn  ny sinh;
- Trong trng hp gp vn  khng gii quyt c, iu chnh li k hoch v thng bo tt c cc bn lin quan.

5.2 Gim st d n
 mi cp qun l khc nhau, vic gim st d n i hi nhng yu cu ring v c th tin hnh theo nhiu cch khc nhau. Di y, ta s xt t pha Ban ch o (Ban gim c) d n v t pha khch hng (ngi s dng).

5.2.1 Gim st d n t pha Ban ch o d n
PG iu hnh theo di tng ngy tin  cc cng on thit k, lp trnh v th nghim h thng. Cn trc tip gim st cc cn b chuyn mn tham gia thc hin d n ch khng phi thng qua cc bo co.

PG iu hnh cn tin hnh gim st n mc no? iu ny ph thuc vo trnh  ca cc lp trnh vin. Cn tng cng gim st trong trng hp c s trao i gia cc chng trnh. i vi mi cng on hoc mi cng vic, lc bt u l lc i hi phi theo di nhiu.

PG iu hnh lm th no  gim st c nhn vin m khng gy "nhiu", khng cn tr cng vic ca h?
- C th tin hnh gim st mt cch khng chnh thc nh gh thm, v tr chuyn.
- Gim st chnh thc, thng qua cc cuc hp hay hi  thng k hng tun.

PG iu hnh cn quan tm theo di  lm sao:
- Cc cn b lp trnh to ra sn phm hay tng cng vic c hon thnh ng thi hn, cc chc nng ph hp vi cc yu cu k thut  t ra.
- Cc cn b lp trnh tun th ng cc chun  c m t i vi cc thit k modun, lp trnh cu trc v hng dn s dng.
- Cc cng vic tin trin theo k hoch. Mi vn  c th gy ra chm gii quyt.

Ban ch o cng cn theo di tin  d n, nhng l nhng nt chnh nh thi gian v kinh ph s dng, cht lng, tnh hnh cn b cng nhn vin. G d n c th i thm  nm tnh hnh v  c c cc thng tin khng chnh thc t pha PG v cn b lp trnh. Tuy nhin, phn ln thng tin d n cho G l do cc nhm lm vic cung cp, thng qua cc cuc hp chnh thc v cc bo co.

G d n cn gim st nht l trong cc trng hp sau:
- D n pht trin chm hn so vi k hoch
- Chi ph s dng vt qu ngn sch.
- Vn  con ngi.
- Cc vn  v giao tip vi lnh o cp trn vi khch hng.

5.2.2 Gim st d n t pha cc cp qun l cao hn
Cp qun l cao hn (so vi ban ch o) ca d n gim st trn nhng phng tin sau:
- Cc kt qu cui cng ca d n; D n s hon thnh ng thi hn hay khng? D n s em li li ch nh d tnh hay khng?
- Khch hng (ngi s dng) hon ton tho mn. C quan (cng ty) qun l d n cng mt lc c th c nhiu d n ang trong giai on trin khai vi cng mt khch hng. Cc cp qun l cao nht ca hai bn cn phi gp g nhau  sao cho cc yu cu a ra u c p ng mt cch tho ng.
- Cc vn  v con ngi trong - kp ca chnh G d n. Cc cp lnh o pha trn cn phi gip  trong nhng vn  m G d n khng th t mnh gii quyt c. V nu bn thn G d n c vn 

5.2.3 Gim st d n t pha khch hng
Mc d c quan qun l d n c th khng ng , khch hng c quyn c bit tin  d n, v nu d n tht bi, khch hng l ngi b nh hng nhiu nht. Khch hng mun kim tra ngay t trc xem sn phm liu s c c giao np ng thi hn hay khng, gi cui cng phi tr c gi ng nh  quy nh hay khng v cht lng sn phm c m bo nh  ha hay khng.

Khch hng cng c th gim st d n theo ng chnh thc; yu cu cung cp cc bo co nh k  nm c tin  d n cng nh cc khuynh hng d bo, tham d phin hp ca ban ch o d n hoc nhn dp kt thc cc giai on ln. Tin  d n cn c th hin qua cc bin bn kim tra k thut  tng cng on trong qu trnh trin khai thc hin d n, vi c ch k i din khch hng. Ngoi ra, khch hng c th thng xuyn gp g Ban ch o d n  nm tnh hnh.

5.3 Pht hin v gii quyt cc vn 
Cc vn  sau y thng hay gp nht trong qun l d n:
- Cc vn  v nhn s 1-5% (nhng c u tin cao nht)
- Cc vn  v kinh ph 10-20%
- Cc vn  v lch biu 90-95%

Tuy nhin,  mt s d n kinh ph c coi l quan trng hn, thi hn c th linh hot t nhiu, trong khi  mt s d n khc thi hn li l quan trng hn.

Cc vn  v lch biu
Vn  hay gp nht i vi ngi lm qun l d n l vn  ko di thi hn. Trong s cc nguyn nhn thng dn n ko di thi hn d n c th l:
- Th t u tin thay i (c ch th, yu cu ngng d n  lm vic khc)
- Hng t c a n khng ng thi hn
- c lng sai nhiu

Khi thy mt cng vic phi ko di, trc ht cn xem cng vic  nm trn ng gng hay khng. Nu  khng phi l mt cng vic gng v thi gian ko di khng nhiu hn so vi khong thi gian th ni, th s khng c vn  g. Tri li nu thi gian ko di nhiu so vi khong thi gian th ni hoc cng vic  cho nm trn ng gng, th thi hn hon thnh d n cng s phi ko di theo.

- Nu  l cng vic ang thc hin d dang, chng ta c th th khc phc bng cch tng cng cc bin php qun l. Nu nguyn nhn ca s chm tr l cc vn  thuc v k thut, hy huy ng s gip  ca cc chuyn gia. Nu l do c nhn lp trnh vin k thut gy ra, hy tm hiu xem hon cnh, cuc sng ring t ca ngi . Ngi lm qun l d n cn c gng gii quyt cc vn  nhn s bng cch gp g, ni chuyn trc tip vi nhn vin, ch khng ch thng qua cc nhm trng.

- Nu cc n lc v qun l khng em li kt qu, hy xem xt phng n b sung ngun lc, phng tin  thc y nhanh cng vic. C th huy ng lm thm gi, song cn thn; trong lp trnh b sung thm nhn lc khng c ngha l thc y nhanh cng vic, thm ch c khi ngc li. Nn tham kho trc  kin ca nhng ngi trong nhm v ch quyt nh b sung thm ngi nu h ng .

- Xt xem cc cng vic cn phi lm, nhng cng vic no chng ta c th thc hin song song, nhng khi lp lch biu ta   ni tip ch v thiu ngun lc, phng tin ny. C th tnh hnh    thay i ngi ta c th tng cng thm cho chng ta.

- Nu c mt cng vic cha lm nhng chc l s phi ko di, v khng lin quan n s chm tr c th xy ra  cc cng vic ang tin hnh, th thng l do khng c cung cp ngun lc, phng tin theo ng yu cu v thi hn. Hy dng bin php qun l, ni kho hoc ngc li, lm gng, thm ch e do nu cn thit.

- Nu tt c cc gii php trn u khng c hiu qu, hy dng cm chp nhn v tuyn b y li thi hn d n. y l cch ph bin nht v trong chng mc no  l tt nht v nh vy t ri ro nht.

Cc vn  v kinh ph
Vn  th hai thng gp trong qun l d n l kinh ph s dng vt qu ngn sch d kin.  xc nh xem trong trng hp ny thc s c vn  hay khng, v trn c s  d bo tng chi ph cho d n cng nh thi hn kt thc, ta cn xc nh c gi tr phn vic  thc hin.

D bo Thi hn kt thc v tng chi ph bng cch tnh gi tr phn vic  thc hin (EV)
Ta xt v d 1 d n sau y. Ngn sch d tnh v kinh ph s dng c m t trn bng sau. k hoch  ra mi thng hon thnh mt modun, vi gi tr 100$ mi modun, tc l ngn sch d chi 100$ mi thng.  thi im hin ti, tc 30/4,  chi ht 450$ thay v 400$ nh d kin. Thot nhn tng nh vy l c vn , nhng thc t ta  hon thnh c 5 modun, ch khng phi 4 nh trong k hoch. Hn th na ta li ch tiu ht 450 $ cho 5 modun. Lm th no m thc hin bo co c tt c cc im tt ?

Mun vy, cn phi ch ra Gi tr ca phn vic  thc hin. Trong v d trn, EV l phn kinh ph theo ngn sch d tnh  hon thnh 5 modun, tc bng 500$

Ngy 30-4

| Cng vic | Thi hn hon thnh theo k hoch | Thi hn hon thnh thc t | Chi ph d tnh | Chi ph thc t tng t | Chi ph thc t cng dn |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 30/1 | 30/1 | 100 | 100 | 100 |
| 2 | 28/2 | 15/2 | 100 | 100 | 200 |
| 3 | 31/3 | 28/2 | 100 | 100 | 300 |
| 4 | 30/4 | 31/3 | 100 | 75 | 375 |
| 5 | 31/5 | 30/4 | 100 | 75 | 450 |
| .. | | | | | |
| 8 | 31/8 | | | | |

[Hnh nh:  th 5.1  th biu din Gi tr phn vic  thc hin (EV)]

 th ny cho thy mc d chi ph thc t vt chi ph d tnh, gi tr phn vic  thc hin li cao hn chi ph thc t. Ngi lm qun l d n c th s dng dng  th ny  d bo khuynh hng tin trin ca d n v thi hn kt thc cng nh tng chi ph.

Tht vy, gi s cc ng chi ph thc t v EV c th pht trin bng cch tip tc ko di ra. Khi  ta c th thy:

[Hnh nh:  th 5.2  th d bo]

D n kt thc khi hon thnh c 8 modun, hay khi EV bng ngn sch d tnh, tc l 800$. Ko di ng EV cho n khi gp im 800$ trn trc tung. T giao im nhn c, v mt ng thng ng. ng ny gp trc honh  u, th  l thi hn d bo s kt thc d n. Trong v d ca ta, d n d bo s kt thc vo thng by

Tt nhin, chng ta s ngng ch khi d n kt thc. V vy cn ko di ng Chi ph thc t cho n khi gp ng thng ng va v trn mt im. Qua im ny v mt ng nm ngang. Giao ca ng ny vi trc tung s cho ta d bo v tng chi ph ca d n  trong v d ang xt l 750$

Pht hin v gii quyt cc vn  ngay t trc khi chng xy ra
Di y l mt s du hiu "bo ng d n c vn :
- Lm vic khng c k hoch. D cho d n ln hay nh phi lp k hoch thc hin. Khng c d n no qu nh  khng cn phi lp k hoch c, v nu khng xy dng k hoch ngay t u, th sau  vi t cch l ngi qun l d n, chng ta s rt bn, khng c thi gian  lm vic  na.
- Cc yu cu v chc nng khng r rng hoc hon ton khng c xc nh. Nu thy ai  khng nh ngi s dng khng bit anh ta mun g", hoc "yu cu cn s thay i, hoc nu chng ta thy qu nhiu gi nh t ra, hy xem li phn c t chc nng. Hy  ngi s dng tham gia cho  kin, to mu th giao din, hoc tin hnh  cng hai giai on  xc nh r cc c t chc nng.
- c lng i khi hoc tu tin, hoc b p t. Nu nhiu  kin cho rng, s khng th hon thnh d n ng thi hn v /hoc ch vi ngn y kinh ph, chc l  c mt s i khi, tu tin hoc p t no  trong khi c tnh. Hy kim tra v c tnh li cho chnh xc, khch quan hn v bo v cc c tnh .

Pht hin v gii quyt cc vn  trong khi trin khai
Trong qu trnh trin khai cc d n thng gp cc vn  sau y:
-  xut hoc  ngh thay i hoc c t chc nng. Qua mt thi gian lm vic, trong s cc thnh vin d n c th s c  ngh thay i hoc c t chc nng, v thy nu gi nh vy th s khng th hon thnh v giao np sn phm ng thi hn c. Cu tr li  y khng phi l khng, tr khi c s ng  ca ngi s dng. Hy gc cc  ngh  li v chp nhn ko di thm thi hn. Ngay c khi khch hng  ngh thay i c t chc nng, nu trong giai on trin khai th cu tr li vn khng. Cn m phn  dnh nhng yu cu mi cho giai on tip theo
- Ti liu cha bin son xong. Ti liu, bao gm c hng dn s dng, l sn phm quan trng nht trong mt d n CNTT, hy m bo hon tt cc ti liu cn thit, thm ch nu c v th m phi y li cng vic khc.
- Th nghim khi thit k cha kt thc. Nh ta  thy trc, cc chng trnh vit trc khi c thit k bao gi cng phi vit li.
- Cc bo co nh k. Ban ch o d n cn phi ra bo co hng tun v tnh hnh trin khai thc hin d n. Nu cc bo co mi tun li thy ra mun hn, hoc ngng bt, hoc bo co sau khng c g mi so vi bo co trc, th chc chn d n c vn . Hy i tm hiu xem vn    u v th p dng cc bin php nu trn  gii quyt.
- n cc thay i v lch biu bo co trong nh k. C th  ra k hoch chnh xc cho tt c mi hot ng ca mt d n ln.
- Ngi c trch nhim lu khng thy xut hin. Nu khng thy ngi c trch nhim tr li in thoi, thoi thc hoc lng trnh mi khi nhn thy chng ta t xa, th chc c vn . Kin quyt yu cu tip xc v xc nh xem vn   u.
- (ngi s dng khng tho mn). Thng tin ny c th t khch hng phn nh, hoc t pha cc thnh vin d n. Trng ban d n, vi t cch l ngi chu trch nhim chnh giao cho khch hng, phi p dng ngay cc bin php cn thit  khch hng c tho mn.

Pht hin v gii quyt cc vn   giai on cui
Giai on kt thc ca d n l rt quan trng, v mi cng vic u nm trn ng gng. Hy c bit ch  n cc vn  sau y:
- Thiu gi my. Nguyn nhn  y thng l do khu th nghim mt nhiu thi gian hn d tnh (nhiu li k thut). Tuy nhin, th phi ko thi gian d n cn hn l bn giao mt sn phm km cht lng
- Lm ngoi gi qu nhiu. Hin tng thng xuyn phi lm ngoi gi l du hiu chc chn dn n s mt mi, kit sc. Cc cn b lp trnh thng c khuynh hng mun-thm ch ham m- li c quan lm vic sau gi hnh chnh. Trong mt gii hn no , lm ngoi gi c th c nng sut, nhng nu vt qu, chng ta s thy hiu qu rt thp, thm ch hon ton khng c. Trong mt tun, ni chung khng nn  nhn vin  li lm ngoi gi qu hai bui.
- Cc cp qun l pha trn "quan tm". Cng v cui d n (nht l nu d n kt thc mun), cc cp trn cng t ra lo lng.

* Kt lun:
Ngi lm qun l d n cn lun gi tay theo di mch p ca d n, phn ng kp thi vi mi vn  pht hin ra, v bt k trong tnh hung no cng vn phi bnh tnh, vng vng. Cui cng, nu khng c nhng vn  xy ra nh vy, th ngi ta  chng cn n nh qun l d n lm g.

5.4 Kim sot thng qua hp nh k, hp tng quan k thut v cc bo co
T d n cn phi giao tip vi nhau v th gii bn ngoi. Cc cuc hp v cc bo co chnh l nhm mc ch ny.

Trong mt d n CNTT, cc cuc hp c th c phn ra lm ba loi: Loi th nht l cc cuc hp nh k  tho lun tnh hnh trin khai d n. Loi th hai bao gm cc cuc hp nhm xem xt tng quan sn phm, pht hin v chnh sa cc vn  thuc v k thut. V loi th ba l cc cuc hp v qun l, bo co vi cc cp c lin quan v tin  d n. Cc cuc hp qun l ny cng c th l cc cuc hp nh k, nh phin hp ca Ban ch o, hoc mi t s kt sau mi cng on chnh.

Hnh thc giao tip th hai l qua cc bo co. Chng hn nhng ngi t c dp gp g trc tip vi t d n c th nm tnh hnh thng qua cc bo co nh k hng tun hoc hng thng.

Cc cuc hp nh k
Mc ch v thnh phn
i vi cc d n CNTT va v nh, cn phi c cc cuc hp nh k hng tun vi s tham gia ca tt c cc thnh vin t d n. Cc cuc hp ny l dp  cc b phn bo co vi Ban ch o v tin  d n v nhng vn  ny sinh. i vi cc d n ln, bao gm nhiu n v, nhiu nhm lm vic, cc cuc hp nh k nn chia thnh hai hay ba phn (hai hay ba cuc hp nh). Trong phn u tin ngn gn qung 30 pht n 60 pht, nht l trong tun nhm trng  theo st cc khu. Cui cng c th phn th ba, cc nhm trng li hp vi Ban ch o. Thng thng cc nhm trng ch cn bo co ming, nhng Ban ch o c th yu cu bo co bng vn bn.

Nn b tr hp nh k vo ngy no trong tun?
Cc chuyn gia v qun l d n cho rng nn b tr hp nh k vo cui tun- tt nht vo chiu th 6 hay sng th 7. Nh th, mi ngi s tp trung c gng lm vic trong tun, gt sang bn nhng g khng lin quan n d n,  cui tun c kt qu bo co. Nu b tr hp vo th hai, mi ngi s ch bt u lo vo cui tun v s lm vic cng thng c th by-ch nht  th hai kp bo co. Nh vy s khng cn thi gian ngh ngi v  b mt mi.

Cc bo co nh k
Mc ch v s trang
Hnh thc giao tip ch yu ca d n vi bn ngoi l cc bo co nh k, ngn gn v theo mu quy nh sn, do Ban ch o ra. Bo co nh k l vn  cn phi bn ti khng ch vi cc d n cng ngh phn mm, m cn vi c cc d n trong lnh vc khc na; bo co thng qu di v i hi qu nhiu thi gian  chun b. Ai cng bit rng, khi nhn c mt ti liu no , trc ht ngi ta thng lt qua my dng u tin xem c g ng gi hay khng. Nu thy hay, c th ngi ta mi c tip trang u,  ri sau  chuyn ngay xung on kt ca ti liu. Mt bo co tun ch nn di khng qu hai ba trang giy A4: phn tng thut ti a mt trang u, tip n mt hoc hai trang do my tnh in ra. Mi bo co nh vy G d n ch cn khng qu 30 pht l c th chun b xong. Khng nn k l nhiu v cc vic  qua, l gii di dng hoc thuyt gio trn lan v cc vn  sp ti. Hy dnh chuyn  cho cc cuc bn lun khng chnh thc.

nh k ra bo co
 c c nhng bc tin ng k, vic quyt nh ra bo co hng tun, hai tun hay hng thng... l tu thuc vo thi gian cn thit  hon thnh mt khi lng cng vic trung bnh trong d n. i vi nhng d n va v nh, c th phn ra thnh nhng cng vic vi thi gian thc hin khng qu mt tun, bo co tun l thch hp hn c. Nu phn ln cc cng vic phi cn mt thng mi hon thnh xong, c th ra bo co thng, cng c th ra cc bo co ngn ngy hn, nu khch hng yu cu nh vy cho h thng xuyn nm c tin , hoc trong trng hp d n ph thuc nhiu vo cc ngun lc  bn ngoi.

Ni dung bo co nh k
Bo co nh k cn bao gm nhng phn sau y:
1. Cc hot ng v kt qu thu c t bo co trc
K khai cc cng vic ang thc hin, tin  ca tng cng vic, cc cng vic hon thnh.
2. Cc vn  ny sinh
Gii thch cc tr ngi mi xut hin, do ai hoc ci g gy ra, ai chu trch nhim theo di v hin ang x l n u. Quan trng nht l xc nh nh hng ca n ti d n.
3. Cc vn   gii quyt
Gii thch tm tt (hoc dn chiu n bo co k trc), vn   c gii quyt nh th no, do ai gii quyt v tc ng ca n ln d n
4. Cc vn  cn tn ti
Nhc li  cc b phn nh l chng ta, vi t cch l ngi qun l d n, khng h qun nhng vn  cn cha c gii quyt. Ch cn mt hay hai cu l . Khng cn m t li nhng vn   cc bo co trc.
5. Lch biu mi i chiu vi k hoch
Trang hai ca bo co tt nht nn dnh cho s  Gantt do my tnh in ra. ng vi mi cng vic s c hai ng: i vi cc cng vic  hon thnh-thi gian d tnh theo k hoch v thi gian thc t s dng  lm cng vic , i vi cc cng vic cn phi lm-thi gian d tnh theo k hoch v thi gian theo lch biu mi. Gii thch tt c cc thay i so vi s  Gantt tun trc, c bit nu thi hn giao hng  khc. Gch di  nhn mnh cc thng bo ko di thi hn.
6. i chiu chi ph thc t vi d tnh ngn sch
C th s dng MS Project  c ngay s  chiu gia chi ph thc t, d tnh ngn sch (k hoch) v Gi tr phn vic  thc hin. Tm tt nhng khon mi phi chi k t ln bo co trc.
7. K hoch tun sau
Lit k cc cng vic theo k hoch v cc s kin mc ca tun ti

Cc cuc hp tng quan k thut
Mt s cc cuc hp tng quan l tn km v mt thi gian. V vy, cn bit t chc sao cho c hiu qu.
- Ln lch hp, phn chia r thi gian  tho lun tng phn
- Gi sm lch hp v cc ti liu cn thit cho cc thnh vin tham d c thi gian nghin cu trc.
- B tr a im hp sao cho khng b quy nhiu. iu khin phin hp theo chng trnh   ra, khng ch thi gian  phn cho tng mc, nhng khng qu cng nhc, nht l khi gp mt vn  quan trng cn tho lun lu hn.
- Dnh  thi gian  bn cc cng vic  k kt; kin quyt yu cu gi ng tin 

Hp xt duyt k thut (K hoch, Thit k, M ha, Th nghim, Ti liu)
Ni dung cc cuc hp ny  c nu chi tit khi trnh by cc giai on tng ng ca d n. Mc ch hp xt duyt l xem xt mt chng trnh, mt ti liu, mt k hoch th nghim l kim tra li cc sn phm , tm li v  ra cc gii php ci tin tt hn. Thnh phn tham gia c th ch bao gm tc gi sn phm a ra xt v mt hoc hai ngi na, v Ph ban ch o ph trch iu hnh. Ngoi l duy nht l hp xt duyt thit k h thng c th mi thm ba hoc bn chuyn gia ngoi.

Hp v qun l
- Hp ban ch o.  mi d n quan trng thng c mt Ban ch o, thnh phn Ban ch o bao gm Trng-Ph ban, ngi ph trch d n ca bn khch hng, mt hoc hai i din ca cc b phn (Vin, Phng, Ban...) chuyn mn c ngi tham gia d n, v t nht mt th trng cp trn, c  thm quyn i vi tt c cc b phn lin quan theo ngha l nhng n v cung cp ngun lc cho d n.
Ban ch o hp thng k vo nhng thi gian nh sn-trung bnh t 6 n 8 tun mt ln i vi mt d n t 6 n 24 thng. Mc ch hp l  thu nhn thng tin v tnh hnh trin khai d n v xc nh cc vn . Cc cuc hp ny cng gip cho cc cp qun l nm st hn tin  d n, tr nn gn gi hn vi t d n, v iu  c tc dng ng vin tt c mi ngi.

- Hp nhn dp cc s kin mc. Mi khi kt thc cc cng vic chnh nn c hp. Cc cuc hp ny cn c hai phn: Phn th nht  cc nhm k thut trao i v nhng g  lm c, cc vn  ny sinh  giai on va qua, v lp k hoch lm vic cho giai on ti. Phn th hai dnh cho tt c cc thnh vin tham gia d n bao gm c khch hng v cc cp qun l c lin quan. Trng ban ch o ch tr phin hp v sau  c th c (tic ng)  mi ngi c th trao i v hiu nhau hn. Trc khi vo tic cn bn xong cc kt qu  t c, nhng vn  t ra v ngun lc cn thit cho giai on tip theo. Cc cuc hp ny tng cng s gn b v hng hi ca mi ngi. Di y ta s  cp mt s s kin mc trong d n

Cc cuc hp c bit nhn cc dp c bit
Nhng s kin mu cht trong chu trnh d n i hi s tham gia  kin khng ch ca mt ngi. i vi mi s kin nh vy, c th b tr mt cuc hp ring  tho lun.

- Hp nh gi ri ro v quyt nh c theo ui d n hay khng.
 nh gi ri ro, nn mi nhng ngi  c kinh nghim vi cc d n cng loi. Cuc hp ny phi tin hnh trc khi a ra  xut d n,  bo m l tt c cc ri ro  c nh gi v tnh vo gi thnh d n, trn c s  quyt nh c nn b cng sc vit d n hay khng. Thnh phn hp l Trng-Ph ban ch o d n (tng lai) v cc chuyn gia.

- Khai trng d n.
Ban ch o d n t chc hp khai trng ngay sau khi d n c k kt. Cuc hp ny nn chia lm hai phn: phn long trng, hp chung, v phn hp ring, gia cc nhm k thut. Mi tham d phn u tt c nhng ai lin quan n d n; Khch hng, ngi cung cp thit b, thnh vin Ban ch o, cc cp qun l, i ng k thut vin... Mc ch  gii thiu cc bn vi nhau, t quan h giao tip, nu r ngun gc v mc tiu d n. Phin hp ny cng nhm to ra bu khng kh phn khi v hng hi bc vo d n. Phn th hai ch dnh cho cc cn b k thut, nhm  ra cc hng ch o, quy nh cc th tc,... Phi nm c chnh xc trnh  ca mi ngi v ln k hoch o to nu cn.

- Hp lp k hoch (c lng) d n.
Nh ta  thy, s rt tt nu  mt nhm nh, ba hoc bn ngi, tin hnh cc c lng cn thit. Nhm ny c th m nhim lun khu phn r cng vic, xc nh cc ngun lc, phng tin cn c v sp xp cng vic theo th t trc sau.

- Thng qua cc c t chc nng. Trc ht hp i ng k thut vin xem xt cc vn  ca giai on cui, c lng v lch biu, nht l nu c s thay i v c t chc nng. Sau  tin hnh hp chung vi ng  cc bn nh  m t  trn. Thng bo v mi thay i trong k hoch nh li thi hn giao sn phm hoc nng gi. Cn c s cam kt t pha cc b phn thit k v lp trnh.

- Tho lun chi tit thit k mc cao nht.
Ph ban ch o iu hnh phin hp. Nhiu nht ch nn khng qu 5 ngi tham d bao gm cc cn b thit k, chuyn gia ngoi hoc lp trnh vin c kinh nghim. Tc gi thit k trnh by cc phng n khc nhau, ni r u im v nhc im ca tng phng n. Nhng ngi tham d b xung  kin v  ngh cc phng n khc ca h. Cuc tho lun chi tit ny ko di t 2 n 4 gi.

- Tho lun chi tit thit k mc trung.
i vi cc d n ln, cn tin hnh tho lun chi tit v la chn thit k tng mc, v tt nhin l cho thit k hon chnh. Mc ch cc bui tho lun ny nhm pht hin tt c cc vn  cn cn phi lm r trong thit k. Tu thuc vo s lng modun trong thit k, c th phn ra mt s bui, nhng khng nn qu 5 ngi tham gia v mi bui ko di khng qu t 3 n 5 gi

- Thng qua thit k h thng.
Mc ch v cch tin hnh ging nh hp thng qua cc c t chc nng. Xem xt li mt ln na cc c lng,  ngh cam kt v cc iu khon khc nhau nh bn giao phn cng, i ng cn b lp trnh, khu chp nhn, ti liu hng dn s dng..

- Tho lun chi tit v thit k modun, ti liu v k hoch th nghim.
Ba  mc ny c th tho lun chung. Ch c Ph ban ch o ph trch iu hnh, cn b ph trch nhm lp trnh v c th thm mt cn b lp trnh tham gia. Cuc hp phi khng nh thit k  chn l tt nht, v xem cn vn  g na khng. C th tho lun lin my modun, nhng mi modun khng qu t 1 n 2 gi, v mi bui khng qu 4 gi. Tc gi modun trnh by, ghi li cc  kin  xut,  suy ngh, tm cch gii quyt v s bo li vi Ban ch o sau

- Tho lun m ti liu cho ngi dng.
Tt c nhng iu trnh by  phn tho lun modun cng s ng  y. Tuy nhin cuc tho lun ny chi tit c th c nhiu ngi tham d.

- Hp kt thc chp nhn th nghim (s kin mc).
y khng tht s l s kin mc nh mt s s kin mc khc. Ch xem nh cuc gp mt gia khch hng v Trng ban ch o d n.

- Hp kt thc giai on vn hnh (s kin mc)
y thc ra khng phi l mt cuc hp, m l mt ba tic v tt c mi ngi u c mi, mt dp  x hi v chuyn sang giai on hu d n

- Hp rt kinh nghim sau d n.
y l mt vic thng hay b b qua, mc d rt quan trng. Cn phi c hai phin hp- phin hp vi khch hng v hp ni b. Hp vi khch hng c th mi c t d n v cc cp qun l cao hn. Khng  phin hp ny tr thnh qua loa. Mc ch l phn tch cc trc trc xy ra vi ngi s dng v bn cch khc phc nhng s kin  trong tng lai. Trong trng hp khch hng khng tho mn, y c th l dp  chng t vi h rng vn  khng nm trong tm kim sot ca chng ta. Trong trng hp khch hng tho mn, c th  ngh h gii thiu vi cc khch hng khc.

Phin hp th hai l gia t d n vi cc cp qun l c lin quan. Phi lm sao y tht s l phin hp ph bnh xy dng. Phn tch nhng thiu st sai lm, lm th no  trnh c nhng thiu st sai lm  trong tng lai, ghi li cc  xut tng ng.

- Bo co sau d n.
Kt qu cuc hp rt kinh nghim sau d n c ban ch o trnh by trong mt bo co chnh thc. Bo co ny s l mt ti liu tng kt s c lu hnh cho nhiu d n khc cng nh c th s c nhiu ngi ngoi d n xem. Bo co sau d n cn bao gm nhng phn sau y:
- D n  c hnh thnh nh th no, mc tiu ban u, cc gii php  xut
- Phng php v t chc d n, cc kin ngh ci tin nu c
- So snh k hoch  ra vi kt qu t c trn thc t. Nu c s khc nhau ng k  gii thch v sao
- Cp nht cc cng thc v t s dng  c lng
- Cc im thnh cng ca d n
- Cc ri ro  gp phi,  xut  trnh nhng ri ro  trong tng li. Cp nht ti liu lu v ri ro.
- Cc phn ca sn phm c th ti s dng

Hp tho lun cc vn  gay cn. C trng hp Trng ban ch o mt mnh khng th gii quyt c kh khn t ra. V d nh tnh trng nhiu cn b lm cho d n xin thi vic v do  phi tm ngi thay th, cc ngun lc, phng tin quan trng khng c cung cp, nhiu cn b qu mt mi hoc mu thun ln nhau, lin h gia d n v ngi s dng b gin on Trng ban ch o d n cn mi hp  tham kho  kin tt c cc bn lin quan. Thng thng cn c cp i din qun l cao ca hai bn, bn d n v bn ngi s dng, tham gia.

Kt lun: Cc cuc hp xem xt tng quan v k thut l khng th thiu c, nu mun d n t kt qu tt. Cc cuc hp chung khc nhm m bo lin h gia d n vi bn ngoi. Nhng khng phi bt k trng hp no cng phi hp. Ch t chc hp khi cn trao i trc din gia cc bn. Ngoi ra c th s dng cc phng tin khc nhau nh th, cng vn, gi in, fax, Email...

 Cu hi (bi tp) cng c:
1. Kim sot d n l g? Kim sot d n gm nhng mng cng vic no?
2. Hy cho bit cc cp  gim st?
3. Ch ra cc phng php gim st hiu qu?`},{id:6,name:"Chng 6: QUN L PHM VI CA D N",shortName:"QUN L PHM VI CA D N",content:`Chng 6. QUN L PHM VI CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca qun l phm vi.
2. Hiu c qui trnh qun l phm vi.
3. M t s h tr ca phn mm trong qun l phm vi d n.

6.1 Qun l phm vi l g?
Phm vi (Scope) l mt danh sch tt c nhng g d n phi lm (v cng c th l mt danh sch tt c nhng iu m d n khng phi lm). D n phi c mt phm vi c vit ra r rng, nu khng d n s khng bao gi kt thc.
- Cc Kt qu chuyn giao (Deliverables) l nhng kt qu ca d n m s chuyn giao: nh l Phn cng, phn mm (mua hoc t lm), bo hnh, ti liu, o to v phng thc chuyn giao.
- Nhm d n v cc bn lin quan (Stakeholders) phi cng hiu nhng sn phm no c to ra nh l kt qu ca d n v chng c to ra nh th no.

6.2 Cc qui trnh qun l phm vi d n
- Khi ng: Bt u mt d n hoc chuyn tip sang giai on tip theo.
Xy dng k hoch chin lc
Bc u tin trong khi ng d n l nhn vo bc tranh tng th hay l k hoch chin lc ca cng ty. K hoch chin lc i hi xc nh cc mc tiu nghip v lu di. Cc d n CNTT cn h tr cc mc tiu chin lc v ti chnh.
+ Xc nh cc d n tim nng.
+ Sau  chn cc d n CNTT v phn b ti nguyn.
Cc phng php chn d n.
Tp trung vo nhu cu chung ca d n, phn loi d n v phn tch ti chnh. Dng WSM (m hnh tnh im c trng s) hoc thc hin BC (Bng im cn i)

6.2.1 Tn ch d n

[Hnh nh: Tn ch D n (Project Charter)]

6.2.2 Lp k hoch phm vi
L qu trnh xy dng cc ti liu nhm cung cp nn tng v phm vi ca d n. Tuyn b v phm vi (scope statement) gm:
 Kim chng v d n (project justification)
 M t ngn v sn phm ca d n
 Tng kt v tt c cc sn phm trung gian ca d n
 Tuyn b v nhng yu t xc nh thnh cng ca d n

[Hnh nh: PHT BIU V PHM VI - Scope Statement]

6.2.3 Xc nh phm vi
Sau khi hon tt k hoch v phm vi, bc tip theo l xc nh chi tit cng vic bng cch chia thnh cc cng vic nh hn c th qun l c.
- Lp k hoch phm vi: pht trin cc ti liu nhm cung cp nn tng cho cc quyt nh v d n trong tng lai.
L qu trnh xy dng cc ti liu nhm cung cp nn tng v phm vi ca d n. Tuyn b v phm vi (scope statement) gm:
+ Kim chng v d n (project justification)
+ M t ngn v sn phm ca d n.
+ Tng kt v tt c cc sn phm trung gian ca d n.
+ Tuyn b v nhng yu t xc nh thnh cng ca d n.
- Xc nh phm vi: chia nh cc sn phm trung gian ca d n thnh cc thnh phn nh hn, d qun l hn.
Xc nh ng phm vi: Gip ci tin s chnh xc v thi gian, chi ph, v ti nguyn; Xc nh nn tng  o hiu sut vn hnh v iu khin d n; Gip truyn t r rng cc trch nhim ca mi cng vic.
Cu trc phn r cng vic (WBS).
+ Chia nh cng vic theo s  phn cp.

[Hnh nh: WBS cho D n]

6.2.4 Cc nguyn l c bn to WBS
1. Mt n v cng vic ch xut hin mt ni trong WBS.
2. Ni dung cng vic trong mt mc WBS bng tng cc cng vic di n.
3. Mt mc WBS l nhim v ca ch mt ngi, ngay c khi c nhiu ngi thc hin cng vic ny
4. WBS phi nht qun vi cch thc hin cng vic; trc ht n phi phc v nhm d n v cc mc ch khc nu thc t cho php.
5. Cc thnh vin nhm d n phi tham gia pht trin WBS  bo m tnh nht qun.
6. Mi mc WBS phi c ti liu i km  bo m hiu c chnh xc phm vi cng vic.
7. WBS phi l cng c linh hot  p ng nhng thay i khng trnh c, iu khin ni dung cng vic theo ng tuyn b v phm vi.
- Kim tra phm vi v iu khin thay i phm vi: hp thc ha vic chp nhn phm vi ca d n, iu khin nhng thay i ca phm vi d n.
Rt kh to c tuyn b phm vi tt v WBS tt cho mt d n. Kim tra phm vi d n v gim thiu thay i phm vi l iu kh hn. Nhiu d n CNTT chu phi tnh trng phm vi phnh ra (scope creep) v kim tra phm vi khng tt.

* Cu hi (bi tp) cng c.
1. Qun l phm vi d n gm nhng g? Tm quan trng ca n i vi cc d n CNTT.
2. Cc phng php chn d n. Dng v d  minh ha.
3. Cc thnh phn chnh ca bn tuyn b phm vi (scope statement). Ti sao phi c bn tuyn b phm vi nu  c tuyn b d n v WBS.
4. Trnh by cc phng php xy dng WBS, gii thch ti sao cng vic ny thng rt kh.
5. M t mt d n b vt phm vi  (scope creep). C th trnh tnh hung ny c khng?
6. Ti sao  s dng phn mm qun l d n phi c WBS tt? Gii thiu cc loi phn mm khc dng trong qun tr phm vi d n.`},{id:7,name:"Chng 7: QUN L THI GIAN CA D N",shortName:"QUN L THI GIAN CA D N",content:`Chng 7. QUN L THI GIAN CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l thi gian d n.
2. Hiu c cc qui trnh qun l thi gian.
3. Hiu c cc phng php dng  qun l thi gian: CPM (Critical Path Method), PERT (Program Evaluation and Review Technique).
4. M t cch dng phn mm trong qun l thi gian d n.

7.1 Tm quan trng ca vic qun l thi gian
Kt thc d n ng hn l mt trong nhng thch thc ln nht.
Thi gian qu hn trung bnh l 222% (theo bo co ca CHAOS nm 1995; c ci tin ln 163% vo nm 2001).
Thi gian c  linh hot b nht; n tri qua bt k iu g xy ra.
Cc vn  lch biu l l do chnh dn n xung t trong d n, c bit l trong na sau ca d n.

7.2 Cc Qui trnh qun l thi gian d n
Qun l thi gian d n gm nhng qui trnh bo m hon tt d n ng hn. Nhng qui trnh ny gm:
- Xc nh cc hot ng
- Sp th t cc hot ng
- c lng thi gian cho mi hot ng
- Pht trin lch biu
- iu khin lch biu

7.3 Xc nh cc hot ng.
Lch biu d n bt ngun t ti liu khi ng d n
- Bn tuyn b d n c cha ngy bt u v kt thc, cng vi thng tin v ngn sch.
- Tuyn b phm vi v WBS gip xc nh cn phi lm nhng g.
- Xc nh hot ng i hi pht trin WBS chi tit hn cng vi nhng li gii thch  hiu c tt c nhng vic cn lm, nhm c c cc c lng ph hp vi thc t

7.4 Sp th t cc hot ng.
- Xem xt cc hot ng v xc nh quan h ph thuc
+ Ph thuc bt buc: c hu do bn cht cng vic.
+ Ph thuc xc nh bi nhm d n.
+ Ph thuc lin quan gia cc hot ng bn trong d n v bn ngoi d n.
Dng Phng php CPM (Critical Path Method)  xc nh cc quan h ph thuc.

7.5 c lng thi gian cho mi hot ng.
c lng thi gian cho mi hot ng, ty theo hng tip cn s c cc c lng khc nhau.
+ CPM: thi gian mi cng vic l thi gian xc nh, cho php thc hin c cng vic .
+ PERT: tnh thi gian mong mun (k vng) ca thi gian thun li (lc quan), thi gian khng thun li (bi quan) v thi gian trung bnh thc hin c cng vic .
+ Lp Bng phn tch CPM (PERT) v xc nh ng ti hn (biu din bng s  GANTT) v xc nh thi gian hon thnh c d n.

7.6 iu khin lch biu.
- Kim tra lch biu so vi thc t
- S dng k hoch phng h bt trc
- Khng lp k hoch cho mi ngi lm vic 100% kh nng vo mi thi im.
- T chc cc bui hp tin  vi cc bn lin quan, v tht r rng, trung tht khi bn v cc vn  lin quan n lch biu.

* Cu hi (bi tp) cng c:
1. Gii thch ti sao lch biu (schedule) thng gy nhiu xung t (conflict) trong cc d n.
2. Ti sao vic xc nh cc hot ng l bc u tin trong qun l thi gian d n?
3. Ti sao phi xc nh tun t cc cng vic trong d n?
4. Gii thch s khc bit gia c lng thi gian cho cng vic v c lng n lc  thc hin cng vic.
5. Gii thch cc khi nim biu  Gantt.`},{id:8,name:"Chng 8: QUN L CHI PH",shortName:"QUN L CHI PH",content:`Chng 8. QUN L CHI PH

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l chi ph d n
2. Hiu c mt s khi nim v thut ng v qun l chi ph.
3. Hiu c cc qui trnh qun l chi ph
4. M t cch dng phn mm trong qun l chi ph d n

8.1. Khi nim qun l chi ph d n.
Chi ph l ti nguyn c hy sinh hay tnh trc  t c mt mc tiu r rng hay  trao i ci g . Chi ph thng c o bng n v tin t.
Qun l chi ph d n bao gm nhng quy trnh yu cu m bo cho d n c hon tt trong s cho php ca ngn sch.

8.2 Qui trnh qun l chi ph d n.
Qun l chi ph d n gm nhng qui trnh bo m cho d n c hon tt trong s cho php ca ngn sch. Nhng qui trnh ny gm:
 Lp k hoch cho ngun ti nguyn: xc nh ngun ti nguyn cn thit v s lng  thc hin d n.
 c lng chi ph: c tnh chi ph v cc ngun ti nguyn  hon tt mt d n.
 D tan chi ph: phn b ton b chi ph c tnh vo tng hng mc cng vic  thit lp mt ng mc (Base line) cho vic o lng vic thc hin.
 Kim sot  iu chnh chi ph: iu chnh thay i chi ph d n.

8.3 Lp k hoch ngn sch (Chi ph).
 Lp k hoch cho ngn sch ph thuc vo bn cht ca d n v t chc. Khi thc hin lp k hoch cho ngn sch cn cn nhc mt s vn  sau:
- Cc kh khn no s gp khi thc hin cc cng vic c th trong d n?
- C phm vi nht nh no nh hng n ngun ti nguyn?
- T chc  thc hin nhng cng vic no tng t nh d n?
- T chc  c  ngi, trang thit b v vt t  thc hin d n?

8.4 c lng chi ph
 u ra quan trng ca qun l chi ph d n l c tnh chi ph. C nhiu loi c tnh chi ph v nhng cng c cng vi k thut gip to ra chng. iu quan trng l chng ta pht trin mt k hoch qun l chi ph trong  m t s dao ng chi ph s c qun l trong d n ra sao
 Cc lai c tnh chi ph:

| Loi c tnh | Khi no lm? | Ti sao lm? |  chnh xc |
| :--- | :--- | :--- | :--- |
|  ln th (ROM) | Rt sm trong chu trnh 3- 5 nm trc | Cho bit chi ph th  quyt nh la chn | -25%, +75% |
| Ngn sch | sm 1-2 nm xong | a $ vo cc K hoch Ngn sch | - 10%, +25% |
| Xc nh | Mun hn trong d n < 1 nm xong | Cung cp chi tit  mua, c lng chi ph tht s. | -5%, +10% |

Cc phng php c tnh chi ph:
o Tng t hay Trn - xung (top-down): s dng chi ph thc t trc , cc d n tng t lm nn tng c bn  lm c tnh mi
o Di ln (Bottom-up): c tnh ring tng nhm lm vic v tnh ton con s tng cng.
o M hnh im chc nng.
o Dng thng s: s dng cc c im ring bit trong d n p dng phng thc ton hc  c tnh chi ph. M hnh COCOMO (Constructive Cost Model) l m hnh thng dng.

8.5 D tan chi ph.
8.5.1. Kim sat - iu chnh chi ph.
Kim sat - iu chnh ph bao gm :
 Gim st hot ng chi ph.
 Bo m rng ch c s thay i hp l u c ghi nhn trong ng mc (Base line).
 Thng bo nhng thay i n nhng ngi c thm quyn.
EMV (Earned value management): l mt cng c quan trng h tr kim tra chi ph.
 EVM l mt k thut o lng s thc hin d n thng qua tch hp cc d liu v phm vi, thi gian, v chi ph;
 a ra mc chi ph (Cost Base line) (d tnh ban u cng vi s thay i cho php), ngi QL cn phi xc nh cch tt nht m d n t c mc tiu.
 Cn phi c thng tin nh k  s dng EVM.

8.5.2 Thut ng trong EMV
 Gi tr tr tnh (PV=Planned Value), cn gi l ngn sch chi ph cng vic  ln lch (BCWS=Bugedted Cost of Work Scheduled), cng l ngn sch d tr cho tng cho tng chi ph s chi tiu cho mt cng vic trong sut mt giai on nh trc.
 Chi ph thc s (AC=Actual Cost), cn gi l chi ph thc s ca cng vic c thc hin (ACWP= Actual Cost of Work Performed), l tng cng cc chi ph trc tip hay gin tip trong vic hon tt cng vic trong mt giai on nh trc.
 Gi tr thu c (EV= Earned Value), cn gi l chi ph ngn sch cho vic tin hnh cng vic (BCWP= Budgeted Cost of Work ), l d tr gi tr ca cng vic tht s hon thnh

8.5.3 Cc cng thc tnh trong EMV

| Khi nim | Cng thc |
| :--- | :--- |
| Gi tr thu c (EV) | EV=PV * (%Thi gian hon thnh) |
| Chi ph pht sinh (CV= Cost Variance) | CV = EV - AC |
| Bin ng Lch (SV= Schedule Variance) | SV = EV  PV |
| Ch s thc hin chi ph (CPI=Cost Performance Index) | CPI = EV/AC |
| Ch s thc hin lch (SPI=Schedele performance index) | SPI = EV/PV |
| c tnh ti thi im hon tt (EAC=Estimate at completion) | EAC = BAC/CPI |
| c tnh thi gian hon tt (Estimate time to complete) | c tnh thi gian ban u/SPI |

Nhn xt:
- CV cho bit s sai bit gia chi ph tht s v gi tr thu c.
- SV cho bit s sai bit gia han thnh theo lch v gi tr thu c.
- CPI l t s gia gi tr thu c v chi ph tht s. Nu bng 1 th ph hp, <1 vt ngn sch.
- SPI l t s thc hin theo lch. Nu bng >1 th han thnh trc lch v <1 ngc li.

V d:

| Hot ng | Tun 1. |
| :--- | :--- |
| Gi tr thu c (EV) | 7 500 |
| Gi tr tr tnh (PV) | 10 000 |
| Chi ph tht s (AC) | 15 000 |
| Chi ph pht sinh (CV= Cost Variance) | CV = EV - AC = -7 500 |
| Bin ng Lch (SV= Schedule Variance) | SV = EV  PV = - 2 500 |
| Ch s thc hin chi ph CPI | CPI = EV/AC *100%= 50% |
| Ch s thc hin lch SPI | SPI = EV/PV*100% = 75% |

*Cu hi (bi tp) cng c:
1. Cc khi nim c bn trong qun tr chi ph, nh li nhun, chi ph chu trnh sng, chi ph v li ch hu hnh v v hnh, chi ph trc tip v gin tip
2. Gii thch nhng iu xy ra trong qu trnh d tho ngn sch?
3. M t cc loi phn mm h tr qun tr chi ph d n?`},{id:9,name:"Chng 9: QUN L CHT LNG CA D N",shortName:"QUN L CHT LNG CA D N",content:`Chng 9. QUN L CHT LNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l cht lng d n.
2. Hiu c cc qui trnh qun l cht lng.
3. M t cch dng phn mm trong qun l cht lng d n.

9.1 Cht lng l g ?
T chc quc t v tiu chun ho (ISO=International Standart Organisation) xc nh cht lng nh tng th cc chi tit nh ca mt sn phm m n phi tho mn nhng quy nh  c  ra.
Mt s chuyn gia khc li nh ngha theo nguyn tc c bn:
- Yu cu ph hp: tho mn cc yu cu i hi
- Tin li cho s dng: chc chn rng mt sn phm c th c s dng ngay t khi c  nh sn xut n.

9.2 Qui trnh qun l cht lng
Qui trnh qun l cht lng bao gm ba giai an:
1) Lp k hoch cht lng: nhn bit c tiu chun cht lng no c lin quan ti d n v nhn bit nh th no v lm th no tha mn chng.
2) m bo cht lng: nh gi ton b vic thc hin d n  chc chn d n s tho mn nhng vn  lin quan ti tiu chun cht lng.
3) Kim tra cht lng: kim tra chi tit nhng kt qu d n  chc chn rng chng  tun th nhng tiu chun cht lng c lin quan trong khi  tm ra nhng cch  ci tin cht lng tng th.

9.2.1 Lp k hoch cht lng
- iu quan trng  thit k trong tiu chun cht lng v truyn t nhng yu t quan trng gp phn trc tip p ng nhng i hi ca khch hng.
- Nhng th nghim trong thit k gip nhn ra tc ng c th thay i trong ton b kt qu ca mt quy trnh.
- Nhiu kha cnh phm vi ca cc d n cng ngh thng tin nh hng cht lng nh cc chc nng, c im, u ra ca h thng, tnh hot ng,  tin cy, v kh nng duy tr.

9.2.2 m bo cht lng
- Bo m cht lng bao gm tt c cc hot ng lin quan ti vic nhn bit nhng vn  ca mt d n.
- Mt mc tiu ca vic bo m cht lng na l lin tc ci tin cht lng.
- Qui trnh nh gi (Benchmarking) c th s dng  pht minh nhng sng kin ci tin cht lng.
- Kim nh cht lng gip ta rt ra nhng bi hc  ci tin vic thc hin  hin ti hay nhng d n trong tng lai.

9.2.3 Kim tra cht lng
u ra cho vic qun l cht lng l:
- Tn thnh nhng s quyt nh.
- Lm li
- Sa i Qui trnh
Mt s k tht v cng c bao gm:
- Phn tch Pareto
- Mu thng k
-  lch chun.

Phn tch Pareto.
- Phn tch Pareto xc nh cc nguyn nhn gy ra vn  v cht lng. N cn c gi l qui tc 80 -20, c ngha l 80% c vn  l do 20% nguyn nhn ca cc vn  cn li. S  Pareto l nhng s  gip nhn bit v xc nh u tin cho cc loi vn 

9.3 Ci tin cht lng d n cng ngh thng tin.
Mt vi  xut ci tin cht lng cho d n l:
- Lnh o thc y cht lng. y l thnh phn ht sc quan trng trn cng ca tm qun l cht lng. Trong trng hp thiu s th hin quan tm lnh o, nhng vic nh nht s xy ra sau ny.
- a s vn  cht lng u lin quan vi qun l, khng phi l vn  k thut.
- Hiu bit r v chi ph cht lng. Chi ph m bo cht lng l:
+ Chi ph hp l hoc cung cp nhng mt hng m p ng yu cu cn thit v thun tin cho vic s dng.
+ Chi ph khng hp l hay lm sai bn phn hay khng thc hin ng yu cu  ra.

9.4 Nm loi chi ph lin quan n vn  qun l cht lng:
- Chi ph ngn nga: chi ph d tnh v thc thi d n c th l khng li hay li c th chp nhn c.
- Chi ph cho s nh gi: chi ph nh gi qu trnh v sn phm a ra t cht lng.
- Chi ph cho sai st trong cng ty: chi ph dng  ch nh chnh xc thiu xt c nh ra trc khi khch hng nhn c sn phm.
- Chi ph sai st bn ngoi cng ty: chi ph lin quan n tt c li khng c nhn ra trc khi a n cho khch hng.
- Chi ph cho cng c th nghim v o lng: vn cho cng c dng  phng trnh v nhng hot ng nh gi.

Ch tm vo nhng vic nh hng ti cng ty v mi trng c th nh hng ti cht lng.
- Nhng vn  thuc v t chc c nh hng ln n nng sut lm vic ca cc nhn vin lp trnh hn l mi trng k thut cng nh ngn ng lp trnh.
- Nng sut ca nhn vin lp trnh thay i theo t l 1/10 gia cc t chc, nhng ch 21% trong cng mt t chc. Khng c s lin quan no gia nng sut v ngn ng lp trnh, s nm lm vic hay mc lng.
- Mt khng gian lm vic tn tm, mt mi trng lm vic yn tnh l yu t chnh cho vic ci thin nng sut ca cc lp trnh vin.

* Cu hi (bi tp) cng c:
1. Qun l cht lng d n gm nhng qui trnh chnh no?
2. Cc loi thng tin trong k hoch bo m cht lng
3. Ba u ra chnh ca kim sot cht lng
4. Lch s ca qui trnh cht lng hin i.
5. M t 3 loi phn mm h tr qun l cht lng d n`},{id:10,name:"Chng 10: QUN L NGUN NHN LC CA D N",shortName:"QUN L NGUN NHN LC CA D N",content:`Chng 10. QUN L NGUN NHN LC CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l nhn s ca d n.
2. Hiu c cc qun l nhn s.
3. Dng phn mm trong qun l nhn s d n.

10.1 Nhn s d n
Trong thc t c rt nhiu cuc hp bn v cc vic khc nhau, nhng li khng phn r trch nhim ai lm vic g. L d nhin l sau  chng ai lm vic g c-v ngi no cng ngh l  c ngi khc lm, khng phi vic ca mnh. Nhn s d n trc ht l t chc d n- cn bit chnh xc ai lm vic g,  u, khi no?

10.2 T chc d n
T d n
i vi cc d n quy m va v nh, hnh thc t chc bn di t ra thch hp

[Hnh nh: Hnh 10.1 T chc cc d n va v nh]

Mi ngi trong t c cng vic ring ca mnh. Cng vic ca cc cn b lp trnh, nh tn  gi, l vit chng trnh phn mm. PG k thut gim st, ch o tt c cc cng vic thuc v k thut, gii quyt cc vn  lin quan n h thng, ng thi chu trch nhim v cht lng sn phm. Trn cng l G Ban qun l d n lnh o v mt qun l, m bo lin h gia d n vi bn ngoi, ng thi chu trch nhim v k hoch v kim sot.

Ngi ta nhn thy rng, mi trng nhm k thut thng theo di tt c 5 cn b lp trnh.
D n c th c phn thnh cc t, sao cho mi t c th coi nh l mt d n c lp tng i.

T chc theo chuyn mn
Rt nhiu hng, cng ty p dng hnh thc t chc theo chuyn mn. V d nu hng chuyn sn xut mt s loi phn mm, th c th phn chia thnh cc b phn, mi b phn chu trch nhim v mt loi phn mm nht nh.
Hnh thc t chc theo chuyn mn nh trn c c u im ln nhc im. u im l cc cn b trong cng mt chuyn mn d hiu nhau hn, v ngi lm qun l ng thi l trng phng chuyn mn nn cng d lm vic hn. Nhc im l trong trng hp d n cn n nhiu lnh vc chuyn mn khc nhau, th s phi mi chuyn gia ngoi. Cc chuyn gia ny cng lc lm vic cho nhiu d n, nn thng h khng c  thi gian  hon thnh phn vic c giao mt cch c cht lng. Ngoi ra, i vi mt cn b c nng lc v thch ci mi, lm vic mi cho nhng d n ging nhau, c th dn n km ho hng v nhm chn.

10.3 Vai tr ca G d n
Vai tr quan trng nht ca G (Trng ban qun l) vi t cch l ngi qun l d n l lin h gia d n vi bn ngoi, G c trch nhim bo co k hoch v tin  d n cho khch hng, cho cp qun l cao hn v cho tt c cc bn lin quan. Mi thng tin t bn ngoi c nh hng n d n, kinh ph, lch biu, nhn s, cc thay i v t chc cng u qua G d n xem xt, sau  mi thng bo li ti cc b phn c nhn lin quan.
Qun l nhn s d n cng thuc v trch nhim ca G. G d n l th trng, l ngi ng vin, khuyn khch l ngi gii quyt mi vn  v con ngi t ra trong d n.
Ngoi ra G d n phi bit bo v d n v bit bo v chnh mnh khi b chi phi bi v vn nhng th tc lin quan, cng nh nhng cng vic s v hng ngy, tp trung thi gian v ngun lc vo thc hin cc mc tiu ca d n.
Di y ta s bn v trch nhim ca G trong tng giai on ca d n:

1. Giai on xc nh.
G c th l mt trong nhng ngi tham gia quyt nh c theo ui d n hay khng, ch tr cc cuc trao i v gip ngi s dng tho ra cc yu cu. G d n c khi chnh l tc gi ca  cng d n. PG k thut s m nhn phn trnh by v k thut trong  cng, ng thi phc tho s b k hoch d n. Phn ri ro cng c vit vi s h tr ca cc chuyn vin. G d n lp k hoch phn b  mc tng th, sau  giao b phn ph trch k thut phn chia tip v cho cc c lng. Sau khi cc cng vic c phn ra mt cch chi tit, G s tnh ton tng chi ph, vch ra lch thc hin v lin h vi cc bn cung cp ngun lc.
G d n ch tr tt c cc cuc hp vi khch hng, m phn bng vn bn, thng nht vi i ng k thut vin v tt c nhng thay i trong vn bn d n, v cng vi khch hng k kt.
Sau khi vn bn d n c k kt, G s lp ra Vn phng D n, ni sau ny tp trung tt c cc ti liu d n, bao gm cc bo co nh k, chng trnh v bin bn cc phin hp, cc vn bn ghi nh.

2. Giai on phn tch.
G d n phi vit cc phn sau y trong h s c t chc nng: Cc ti liu bn giao, thay i c t, Chp nhn, Giao din ngi s dng, Trch nhim ca pha ngi s dng (chi tit do PG k thut cung cp), Cch thc v iu kin, Bo hnh cng nh v cc hiu ng m h thng mi c th gy ra do tc ng ln mi trng ngi s dng.
G d n m bo xy dng c t Chc nng xong ng hn (pha khch hng cung cp m t u vo ng hn), m phn c t chc nng vi khch hng v  khch hng k xc nhn ng . Giai on ny l lc G d n tp trung vo lp k hoch d n. Phi c c s cam kt ca cc bn cung cp ngun lc, nht l ca cc phng chuyn mn v vic c cn b thit k v lp trnh tham gia d n. Nu thy c nhu cu cn t chc ngay cc lp o to.
Kim sot d n cng bt u t giai on ny. Gim c d n gim st tin trnh, triu tp cc cuc hp nh k v hp tng quan, vit bo co nh k gi cc bn lin quan v x l mi vn  ny sinh.

3. Giai on thit k.
V y l giai on nng v k thut, nn cng vic ca G d n c phn nh hn. Vn  l phi c cc th tc kim sot chnh thc. G d n n nh cc cuc hp v in cc bo co thng k hng tun kim tra tin  v mt thi gian v kinh ph so vi k hoch, d bo tng kinh ph ngy giao hng v cp nht cc sa i cn thit. G d n phi pht hin vn , nu c th th gii quyt cc vn  , nu khng th xem xt li k hoch. G d n ch tr cc cuc hp v qun l nu c (hp Ban qun l d n, Ban ch o, hp nhn cc s kin mc) c bit, G d n phi m bo sao cho khch hng tho mn vi tin  sn phm.
Khch hng thng thay i yu cu ngay t giai on thit k. V vy G d n cn a ra mt qui trnh x l cc yu cu , ng thi tnh v a cc chi ph pht sinh vo gi thnh.

4. Giai on lp trnh.
Giai on ny thu ht nhiu ngi nht v do  c th c nhiu vn  v nhn s. G d n phi theo di st v can thip ngay nu thy c g khng n PG v cc nhm trng cung cp cho G v tnh hnh lm vic ca cc nhn vin thuc mnh qun l.
y c th xem l giai on di nht v khng r mc kt thc. G d n cn c tm nhn xa v m bo tin  d n, thng xuyn gp g, trao i vi cc cn b lp trnh  pht hin cc vn  ngay trc khi chng xy ra.

5. Giai on Tch hp h thng v Th nghim. iu tt nht m G d n c th lm cho giai on ny l gi cho cc cn b chuyn mn trong d n khi b quy nhiu. V khi  khch hng, cp trn... chc hn s lo lng, lin tc gi in, triu tp hp v yu cu bo co tin  hng ngy. G d n s phi ng u vi tt c cc v vic , to iu kin cho t tp trung hon thnh giai on cui.

6. Giai on chp nhn. G d n  xut thi gian, b tr cc cn b v phng tin  ngi s dng c th n v k chp nhn.

7. Giai on vn hnh. G d n m bo cung cp h tr k thut nh  ha v sao cho h iu hnh p ng cc yu cu ca ngi s dng. y cng l giai on thch hp, nu G c  nh a ra mt d n mi.
Cui cng G d n t chc hp tng kt nh gi d n v vit bo co tng kt.

10.4 Vai tr ca PG k thut
Chc nng ch yu ca PG k thut l m bo lm ra sn phm cht lng cao. Khc vi G thin v i ngoi. PG thin v cc hot ng bn trong d n. PG cn ch o, kim sot sao cho sn phm to ra ph hp vi c t chc nng v khng b li. PG lnh o phn ln cc cng vic k thut, ch tr cc cuc hp tng quan k thut, xc nh v giao vic cho cc cn b thit k v lp trnh, gii quyt nhng vn  ln lin quan n vn  k thut, v t mnh m nhn nhng phn vic phc tp nht.
i vi mi giai on trong d n, trch nhim ca PG c nhng c th ring.

1. Giai on xc nh. PG tho phn ln k hoch s b ca d n: phn r cng vic  mc chi tit v tin hnh c lng. Trong trng hp pha khch hng phi cung cp cc chi tit k thut  giai on ny hoc nguyn mu, PG k thut l u mi lin h chnh.

2. Giai on phn tch. Trong d n quy m va v nh, PG l ngi phn tch chnh v son tho tt c phn k thut ca h s c t chc nng: Tng quan, Mc tiu, Yu cu h thng, M t cc b phn. Nu cn PG h tr G v phng din k thut trong m phn v c t chc nng, tnh ton chi ph pht sinh khi khch hng c  ngh thay i. PG cng ng thi gip G tuyn chn ngi vo lm vic cho d n.

3. Giai on thit k. PG l ngi ng u nhm thit k, ch tr cc cuc trao i v hp tng quan v thit k, giao vic cho cc cn b thit k, ng thi t mnh m nhn thit k nhng khu quan trng, nht l  mc tng th.
 giai on ny cng nh  giai on Lp trnh v Th nghim H thng, PG cn gp G hng tun  bo co tnh hnh d n. V PG l ngi tip xc hng ngy vi cc nhn vin, nn phi thng tin cho G v tnh hnh lm vic ca mi ngi.

4. Giai on lp trnh. y l giai on i hi PG phi lm vic cng nht. PG phi phn b cng vic lp trnh, gii quyt bt c vn  g m cc cn b lp trnh khng gii quyt c. PG duyt thit k chng trnh, k hoch th nghim, ti liu ngi s dng, m bo s lin kt cn thit gia cc cn b lp trnh. Mi chng di v phc tp c th giao ring cho mt cn b lp trnh lm vic di s h tr ca PG. Nh vy, PG c th nh du c cc khi chng trnh trong khi cn b lp trnh vit chng trnh chi tit. PG cng c th m nhn vit trn vn mt chng trnh, nhng khng phi l chng trnh nm trn ng gng.

5. Giai on Tch hp h thng v Th nghim. Tch hp v th nghim ln cui cng sn phm hon ton thuc phm v trch nhim ca PG. PG ln k hoch tch hp kim tra vic thc hin k hoch , xc nhn cc kt qu t c v thng xuyn bo co vi G v tin  thc hin.

6. Giai on chp nhn. PG m bo ton b phn k thut, v c th l ngi tho ra k hoch th nghim chp nhn, ng thi cng l ngi thc hin k hoch .

7. Giai on vn hnh. Mc d c th ch cn c mt cn b lp trnh tr, PG phi l ngi bo hnh thng trc, sn sng gii p cc cu hi qua in thoi, hoc thm ch m nhn phn ln khu hun luyn ngi s dng.

10.5 Vai tr ca cn b lp trnh
Cn b lp trnh nhn c thit k mc trung  trn c s  tin hnh thit k chi tit, lp k hoch th nghim modun. Cn b lp trnh cng c th chu trch nhim v ti liu cho ngi s dng v hun luyn, mc d tt hn ht vn l thu cc chuyn gia son ti liu v ging dy m nhn cc khu ny. Mt cn b lp trnh phi bo co tin  vi PG, c mt khi th nghim h thng cc phn lin quan n chng trnh do bn thn mnh vit.

10.6 Vai tr ca pha khch hng
Pha khch hng c th c mt s trch nhim nh son tho ti liu hoc cung cp d liu  th nghim. Trong mi trng hp pha khch hng phi c ra mt i din, chu trch nhim lin h v lm vic vi d n v cc vn  qun l. Pha khch hng phi c t nht mt ngi  hiu bit  tr li cu hi ca t d n.
Ngi s dng cng phi tm hiu v qun l d n, t ra l  bit vai tr ca mnh n u, khi no th phi tham gia hp hoc k. Ngi s dng phi bit c v ph duyt cc ti liu do pha d n a sang. Mc d khng can thip vo cc cng vic k thut, ngi s dng gi lin h vi G d n, a ra cc  ngh thay i theo ng quy trnh, v qua  bit c sn phm giao np c p ng yu cu cam kt khng.
Tm li  hon thnh tt d n, khng c cch no khc l phi phn cng cng vic r rng, sao cho mi ngi u bit phn vic ca mnh. i vi cc cng vic pht sinh ngoi d kin, c th p dng phng cch phn trch nhim chung nh va trnh by  trn: G d n m nhn tt c cc hot ng i hi tip xc vi bn ngoi, cng nh mi vn  thuc v nhn s. PG d n chu trch nhim v tt c cc vn  v k thut. Nh vy khi c mt vn  mi ny sinh, s c th xc nh ngay  thuc trch nhim ca ai, m khng cn mt thi gian bn ci.

10.7 Tuyn chn nhn s d n
G d n.
G d n thng l do cp trn b nhim. Cng v ny thc ra  c b tr sn ngay t khi d n mi hnh thnh, v c th chnh G l ngi cho  kin xem c nn xy dng d n hay khng.
G D n trc ht phi l ngi c ngh thut giao tip. Tip  l k nng qun l d n, ti t chc, v cui cng l trnh  chuyn mn. Nu G d n hiu c ngn ng ca cc nh k thut, th s rt thun li trong cng vic.
Cng v G d n i khi c nhng i hi khc v cc chnh sch v th tc ca bn c quan khch hng cng nh ca c quan mnh. Nhng cng vic nh th i hi cc k nng v lnh o, m phn v ngoi giao.
Vic la chn ai vo cng v G d n nhiu khi cn tu thuc c ch lm vic, chnh sch s dng ngi ca c quan, doanh nghip. Kinh nghim cho thy  mt d n CNTT c nhiu phng, ban tham gia, G nn l mt cn b lnh o c  thm quyn i vi tt c cc phng ban ny, mc d c th khng phi l mt chuyn gia tin hc.

PG k thut.
y l cng v th hai trong d n. Tt nht l  G d n chn PG. Cng vic ca PG nng v chuyn mn, v th nn chn trong s cc chuyn gia gii. PG ng thi phi l ngi bao qut c chi tit ton b d n, khng b xa  vo nhng vic vn vt. G phi chn PG trc khi vit  cng d n, v c rt nhiu chi tit trong  cng d n s do PG iu tra cung cp.
PG cng phi c k nng giao tip tt. Chnh PG l ngi tin hnh phng vn ngi s dng v l ngi hng ngy gim st cng vic ca cc lp trnh vin. Hy chn vo cng v ny chuyn gia no bit t chc, phn cng cng vic, bit gi tin . PG phi c  uy tn v mt chuyn mn  c th lnh o, gip  cc cn b thit k cng nh lp trnh.

Cn b lp trnh.
Hy chn cn b lp trnh trc ht theo nng lc lp trnh ca h. Sau  xt n kinh nghim lp trnh m h  c trong lnh vc ng dng phn mm tng ng, nhng trnh tnh trng  mt ngi lm i lm li mt vic.

10.8 Tnh cch ca ngi lm qun l d n
iu d thy l tnh cch ca ngi qun l c th c tc ng n d n. Sau y l mt s nt v tnh cch c coi l cn thit i vi ngi lm qun l d n:
Ngi lm qun l d n bit giao tip.  l mt thnh vin t, sn sng chia s cc  tng v hiu bit c gi tr. Ngi  khng ch bit trnh by cc t tng, m phi c quyt tm tranh u cho nhng t tng .
Ngi lm qun l d n phi bit lng nghe  kin ngi khc, v sn sng tha nhn nu  l nhng  kin tt hn.
Ngi lm qun l d n c u c t chc. D n c rt nhiu vic, mi vic phi c hon thnh vo mt thi gian tng ng. Hy cn thn vi nhng ngi lm vic khng n ni n chn, sn sng b d vic ny nhy sang vic khc. Nh vy th chng bao lu trong d n s c nhiu vic b b d dang.
Ngi lm d n khng nn cu ton. Quan trng l bit bo m thi hn. Kt qu d n bao gi cn c th lm tt ln. Nhng phi bit dng li  u v dnh cc  xut ci tin cho ln sau.
Ngi lm qun l d n c kh nng phn tch, logic v c kinh nghim tng ng

10.9 Giao vic cho tng c nhn
Trong cun tm l hc lp trnh (The Psychology or Computer Progamming, New-York: Van Nostrand, Reinhold, 1971), G.Weinberg cho rng ng c thc y mnh nht i vi mt ngi lm lp trnh l hc ci mi. Cn giao cho lp trnh vin cng vic kh hn so vi trc y. Tuy nhin khng nn phn nhim v phc tp cho mt lp trnh vin mi ra trng, cng nh khng nn  cc chuyn gia gii lm nhng vic tm thng.
Nhng phn vic hoc chng trnh lin quan n nhau nn giao cho mt ngi, hoc ti a hai ngi, vi iu kin hai ngi ny kt hp c tt vi nhau.
Trong khi phn vic khng nn  ra tnh trng tt c ph thuc vo mt ngi, theo ngha nu ngi  i vng th tt c phi ngng ht. Hng IBM  tng kt thy rng phng php t chc hm lp trnh theo ch  km cp" l rt hiu qu. Theo phng php ny ph trch nhm l mt chuyn gia lp trnh bc thy, m nhn tt c cc m phc tp "80%" v gip vic l cc lp trnh vin hc tr, vi 20% m d hn. c bit c mt lp trnh vin hc tr lun lm vic cng vi thy, c thy km cp hng dn cho y ,  c th thay th thy mi khi thy i vng. Nh vy cng vic ca c nhm s khng b gin on.

* ng c thc y
ng c thc y lm cho ngi ta lm vic hng hi hn, hiu xut cao hn v t kt qu tt hn.
F. Herzberg  tin hnh mt cuc iu tra v cc ng c thc y i vi cng nhn  M. ng  ngh mi ngi hy nh trong u mnh nhng trng hp lm vic c hiu qu nht v nhng trng hp lm vic km hiu qu nht. Kt qu cho thy nhng trng hp sau y dn n hiu qu lm vic km nht:

Chnh sch v cch qun l hnh chnh ca cng ty | 38%
S theo di, gim st | 20%
iu kin lm vic | 18%
Lng | 8%

Ngoi ra cn l quan h cp trn v / hay vi ng nghip, cc ch  i ng x hi v bo him
Nhng trng hp sau y dn n hiu qu lm vic cao nht:
Thnh qu: 50%
(Thy mnh hon thnh xong mt cng vic, t c mc tiu  ra. Cng vic l mt c hi  hc hi, nng cao trnh , tay ngh)
Tnh cht cng vic:
- i vi ngi lm chuyn mn: 48%
- i vi nhng ngi lm khng chuyn: 13%
(Cng vic th v, thch thc, khng qu n gin, d dng, m i hi phi vn ng tr tu, trnh  chuyn mn, kinh nghim... Mi trng lm vic d chu, iu kin v phng tin tt)
c ng nghip ng h v cng nhn: 25%
(Ngi lm nhn c thng tin phn hi v kt qu v hiu qu cng vic, thy rng vic mnh lm c, ngi khc v nht l cc ng nghip quan tm v nh gi tt )
Thng tin: 23%
(c ct nhc ln cp quyn lc cao hn)
Trch nhim
( thc v trch nhim ca mnh, v vai tr v li ch ca cng vic mnh lm trong s nghip chung)

* Cu hi (bi tp) cng c:
1. Th trng cng vic v tnh hnh kinh t nh hng n qun tr ngun nhn lc nh th no?
2. Cc qui trnh trong qun tr ngun nhn lc
3. Trnh by s khc bit gia hai k thut resource loading v resource leveling. Cho v d i vi mi k thut.
4. Trnh by 2 loi hot ng xy dng nhm.
5. C th dng MS. Project 2003  h tr qun tr ngun nhn lc nh th no?`},{id:11,name:"Chng 11: QUN L TRUYN THNG CA D N",shortName:"QUN L TRUYN THNG CA D N",content:`Chng 11. QUN L TRUYN THNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca truyn thng tt khi lm vic vi d n v m t cc thnh phn chnh ca mt k hoch qun l giao tip.
2. Hiu c qui trnh qun l truyn thng.
3. Cung cp mt s phng php ci tin truyn thng.
4. M t cch s dng phn mm  h tr qun l truyn thng.

11.1 Tm quan trng ca truyn thng tt
Ni s hi ln nht i vi d n l tht bi (km) truyn thng. Cc nh chuyn mn v CNTT thng khng phi l ngi truyn thng tt Cc nghin cu cho thy nh chuyn mn CNTT phi c kh nng truyn thng hiu qu  c th thng tin trong ngh nghip. K nng ni l yu t ch yu  thng tin ngh nghip i vi cc nh chuyn mn CNTT.

11.2 Qui trnh qun l truyn thng
Cc qu trnh bao gm:
- Lp k hoch truyn thng: xc nh thng tin v nhu cu giao tip ca cc bn lin quan.
- Phn phi thng tin: c th dng thng tin cn thit ng lc.
- Bo co hiu sut: thu thp v ph bin thng tin v hiu sut.
- Kt thc hnh chnh: to, thu thp, v thng tin  hp thc ha kt thc d n / giai on

11.3 Lp k hoch truyn thng
Mi d n cn c k hoch qun l truyn thng, l ti liu hng dn truyn thng trong d n. Phn tch cc bn lin quan trong truyn thng d n cng h tr qui trnh lp k hoch truyn thng.
Ni dung ca k hoch qun l truyn thng:
- M t vic thu thp cc loi thng tin khc nhau.
- Cu trc phn phi m t thng tin n vi ai, khi no v bng cch no.
- nh dng thng tin  truyn thng.
- Lch biu to thng tin.
- Cc phng php truy cp  nhn thng tin.
- Phng php cp nht k hoch qun l truyn thng theo tin  ca d n.
- Phn tch truyn thng vi cc bn lin quan.

11.4 Phn phi thng tin
- Cung cp thng tin cho ng ngi vo ng thi im v ng nh dng cng quan trng nh to thng tin.
- Cc yu t quan trng cn xt:
- Dng cng ngh  ci tin phn b thng tin.
- Cc phng php hnh thc v khng hnh thc  phn b thng tin.

11.5 Bo co hiu sut
Bo co hiu sut gip cc bn tham gia bit thng tin v s dng ti nguyn  t cc mc tiu ca d n
- Bo co tnh trng m t d n ang  giai on no.
- Bo co tin  m t nhm d n  t nhng g trong mt khong thi gian.
- D bo d n tin on trng thi tng lai ca d n da trn thng tin qu kh v xu hng pht trin.
- Cc bui hp nh gi tnh trng thng c bo co hiu sut.

11.6 Kt thc hnh chnh
D n i hi phi c giai on kt thc. Kt thc hnh chnh (Administrative closure) to ra:
- Ti liu lu tr v d n.
- Chp nhn chnh thc.
- Cc bi hc rt ra.

11.7 Ci tin Truyn thng
- Qun l xung t hiu qu.
Gii quyt vn : trc tip i mt vi xung t. Xung t c th l iu tt. Xung t thng dn n nhng kt qu quan trng, nh  tng mi, nhng gii php tt hn, v ng c lm vic kin tr v hp tc hn. Suy ngh theo nhm c th pht trin nu khng c xung t v quan im. Xung t lin quan n cng vic thng ci tin hiu sut lm vic ca nhm, nhng xung t v tnh cm thng lm gim hiu sut lm vic. Sau y l mt s phng thc gii quyt xung t:
- Tha hip: dng tip cn cho v nhn.
- Lm trn (Smoothing): nhn mnh nhng im ng tnh v b qua nhng khc bit.
- p t (Forcing): dng tip cn thng-thua.
- Rt lui: rt lui do khng ng tnh.
- Pht trin k nng truyn thng tt hn.
- Hp hiu qu hn.
Xc nh c nn trnh c bui hp no khng. Xc nh mc ch v kt qu t c ca bui hp. Xc nh nhng ngi tham gia cuc hp. Cung cp chng trnh hp cho ngi tham gia trc bui hp, chun b ti liu v cc h tr trc quan, tin hnh cuc hp mt cch chuyn nghip.
- Dng email hiu qu. Bo m email l phng tin truyn thng chung ca d n, e-mail n ng ngi, ch  trong email phi ph hp, gii hn s lng v kch thc cc tp tin nh km, xa cc email khng cn thit. Tr li nhanh cc email khi c th.
- Dng cc mu trong truyn thng d n.

11.8 Pht trin h tng truyn thng
H tng truyn thng l tp cc cng c, k thut, v cc nguyn l cung cp nn tng  truyn t thng tin hiu qu:
- Cc cng c gm e-mail, phn mm qun l d n, phn mm lm vic theo nhm, my fax, in thoi, h hi ngh t xa (teleconferencing), h qun l ti liu, v cc phn mm son tho vn bn.
- Cc k thut gm hng dn v cc mu bo co, cc quy nh v th tc hi hp, qui trnh ra quyt nh, cc tip cn gii quyt vn , gii quyt xung t v k thut m phn.

* Cu hi cng c:
1. Cc thnh phn chnh ca k hoch giao tip trong d n.
2. u im v nhc im ca cc phng php phn b thng tin v d n.
3. Trnh by mt vi cch to v phn b thng tin v hiu sut vn hnh d n.
4. Phn mm c th h tr giao tip nh th no?`},{id:12,name:"Chng 12: QUN L RI RO CA D N",shortName:"QUN L RI RO CA D N",content:`Chng 12. QUN L RI RO CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l ri ro d n.
2. Bit c cch d on cc ri ro c th xy ra.
3. Bit cch lp danh sch ri ro, a ra cch khc phc.

12.1 Qun l ri ro
Qun l ri ro. Qun l ri ro bao gm bn bc:
Bc 1: D on ri ro
Bc 2: Kh b ri ro  mt ni c th
Bc 3: Gim bt tc ng ca ri ro
Bc 4: Vn trong kim sot khi c iu trc trc

12.2 D on ri ro (bc 1)
Cng vic u tin v quan trng nht trong qun l ri ro l nhn bit iu g c th dn n sai st. Phng php tt nht  xc nh cc khon mc c th ri ro l nhn vo lch s v rt ra mt danh sch nhng g c th a ti sai st. Nu chng ta khng ghi chp lch s  xem li th cn hiu r khi no chng ta ang trong tnh hung ri ro.

Mt s tnh hung c th xy ra ri ro trong d n:

Cc tnh hung ri ro chung
- Nhn vin k thut khng thch hp. Thiu hun luyn v kinh nghim v phn cng, h iu hnh, phn mm hay lnh vc ng dng. Thiu kinh nghim trong cng vic nhm gy ra vn  v trao i. Nhng yu cu ca khch hng v an ton, php l, quy tc thanh ton...
- Mi trng lm vic khng st hp. Mi trng lp trnh cn yn tnh v khng b quy ri. Cn c bit lu  nu vic lp trnh phi thc hin ti c quan khch. Ni chung cn c my tnh  mnh, trnh bin dch thch hp v phn mm pht trin tt.
- Ti nguyn do bn th ba cung cp. Nu c vic g  do mt bn cung cp m chng ta khng kim sot c h, th chng ta ang  cnh mt ri ro. Chng ta c gng thu c quyn kim sot i vi cc bn .
- Rt ngn d n. chng ta c th lm cho d n c hon thnh sm hn hoc nu chng ta c nhiu ngi, mi ngi u lm thm gi v c my tnh ln. Nhng chi ph  cng phi ln gp i!
- Ngun vn t ngn sch. Nu khch hng s dng ngn qu theo tng qu th chng ta ng trc kh nng thiu kinh ph, nu chng ta c lng cho mi qu khng st hp.

Tnh hung ri ro ti chnh
Vic qun l d n kiu phn b khng c hiu qu. Tt nht l mi thnh vin ca nhm d n, cng nh khch hng u trong cng min a l, nu khng s rt tn km cho chi ph i li.
Qun l qu st sng c th li "khng qun l k" c d n. Hy gi cc ti liu  mc ti thiu. Mi ngi c th ngh cch tt hn  bo co li hot ng ca mnh. Hy xc nh mt tp nh cc ti liu chun ri dng chng. Gi cc cuc hp  mc ti thiu. Chng ta hy dng in thoi v bn ghi nh  lin lc mi lc c th. ng lm nh hng ti cc nhn vin.
Ri ro cn xy ra khi c ngi dng khng th v khng c quyn tr li cc cu hi nhanh chng.

Tnh hung ri ro k thut
- Gii php sai. Chn ngn ng lp trnh, phn cng khng ph hp. Cn phi m bo my tnh pht trin v my tnh vn hnh tng thch nhau v u c sn khi cn n, c phn cng ln phn mm u c sn xut bo m. Phi c bit cn thn trong mi trng c nhiu nh cung cp.
- Yu cu/c t khng tt. Nu c iu g cn cha r hay m h, hay nu ngi dng khng th trao cho chng ta cc yu cu chc chn th nhng thay i nht nh s xut hin trong hoc sau khi pht trin. Thay i c th rt tn km cho vic thc hin v chng ta khng th c thanh ton  lm vic . Cn phi lm vic phn tch d n k trong trng hp ny.
- Khng hiu bit v ngi dng. Chng ta phi bit cch thc, quy trnh m ngi dng ang lm.
-  ng sai mt mt d liu Phi xc nh ra cc th tc sao lu, ghi li cc giao dch hay sao chp cc tp cn phi c thit k cho h thng.

Thch  ri ro. Hy t hi chng ta cc cu hi v ri ro sau tr li c hay thm ch c phn no , cho bt k cu hi no th tc nhn ri ro. Danh sch c chia thnh 3 phn: ri ro thp, ri ro trung bnh, ri ro cao.

Ri ro thp
Lnh vc: Kch c nhm
Cu hi: Nhm d n c t 3 n 5 ngi? (ch  iu ny ko theo rng nhm mt hay hai ngi khng ri ro!)

Lnh vc: Phn mm/ phn cng
Cu hi: Chng ta c ang dng mt ngn ng khng thch ng vi ng dng khng?

Lnh vc: Ngi s dng
Cu hi: Liu ngi s dng c l ngi bit my vi tnh khng? (iu  s lm tn thi gian hun luyn, ri khi h bit hn th h s i c s thay i)

Lnh vc: Hun luyn
Cu hi: Chng ta c tht s cn hun luyn v phn cng my khch, phn mm h thng, ngn ng khng?

Lnh vc: Thnh vin nhm
Cu hi: Chng ta c lm vic c vi nhau khng? (Sc kho, hiu nng, vn  c nhn)

Ri ro va
Lnh vc: Kch c nhm
Cu hi: Nhm d n c trn 5 ngi

Lnh vc: Phn mm/ phn cng
Cu hi: Liu c yu cu no v thi gian p ng/ hiu xut hay tnh sn c l qu ng khng? Liu ta c a vo mt phn cng qu yu khng? Liu c dnh dng g n hp ng/ ngn ng macro khng (Macro kh hc, kh g li v cng kh tm c ngi lp trnh). Ta c phi sa i h iu hnh khng? C lin quan ti mng hay khng? C sn phm phn cng hay phn mm mi no khng?

Lnh vc: Ngi s dng
Cu hi: C vn  kh khn trong trao i vi ngi dng khng? (Ngi dng bt hp tc hay  xa)

Lnh vc: Thnh vin nhm
Cu hi: Liu c ai trong nhm m ngi dng khng c quyn tc ng ti khng?

Ri ro cao
Lnh vc: Phn mm/phn cng
Cu hi: Trong mi trng nhiu nh cung cp, liu c nh cung cp no a ra cc sn phm khng ph hp khng? Chng ta c ang dng phn cng, phn mm cc phng php thit k hay lp trnh cha tng c sa trc hay khng?

Lnh vc: Thnh vin nhm
Cu hi: Chng ta c lm vic c vi nhau khng? Liu c vn  c nhn no khng? (Sc kho, hiu nng, vn  c nhn)

Lnh vc: Cc bn th ba
Cu hi: Liu c ti nng no ph thuc vo cc bn ngoi s kim sot ca chng ta khng?

Lnh vc: Hn cht
Cu hi: Liu d n c phi rt ngn khng? C c cng b khng?

Lnh vc: Yu cu
Cu hi: Ti liu yu cu c chc c khng, hay mt trong chng ta (ngi dng, nhm d n ) khng hiu n?

Chng ta c th d tnh cc ri ro bng cch to ra cc danh sch nh trn  nhc nh mnh v nhng ri ro c th c. Chng ta hy dng lch s cc d n trong cng ty chng ta  to ra cc danh sch ring ca mnh. Hy nh danh sch ri ro l ng phi thay i chng khi mi trng thay i.

12.3 Kh b ri ro  mi ni c th (bc 2)
Ti im ny mt  tng tt l lp mc u tin cho cc khon mc ri ro. Chng ta hy lp mt bng nh bn di:

Bng ri ro
Khon mc ri ro | Xc sut (1-10) | Tc ng (1-10) | u tin (XxT)
--- | --- | --- | ---
Ngi s dng khng trao i  Yu cu s trt | 8 | 8 | 64
Trng nhm lp trnh ngh php/vic lp trnh trt | 2 | 8 | 16

Chng ta hy a vo trong bng tng khon mc trong bn cu hi ri ro m chng ta  tr li c hay thm ch c th. Hy dch cc khon mc ri ro ny thnh nh hng thc t ln d n, thng l tng chi ph hay thi hn. Chng ta hy quyt nh v xc sut ca vic xut hin khon mc ny v gn cho n mt s t 1 ti 10, 10 l xc sut cao nht. Ri quyt nh v tc ng ln d n. Hy gn cho Tc ng mt s trong khon t 1 ti 10, 1 l khon mc c th xoay s c, 10 l khon mc s lm dng d n. Cc khon mc tc ng cao l cc khon mc ri ro Va hay Cao trong phn cu hi ri ro, cng nh cc khon mc nm trn ng gng. Hy nhn Xc sut vi Tc ng cho tng khon mc  thu c u tin.

Bng ri ro trn s cho chng ta mt th t, theo  gii quyt kh b cc ri ro. Hin nhin, s u tin cng cao trong Bng ri ro th khon mc  cng phi ch . Trong thc t cn gii quyt cho cc khon mc theo th t gim dn ca s u tin.

i vi mi khon mc ri ro, u tin hy th loi b nguyn nhn ri ro. Hy xem xt n quyn kim sot, thay i nhn vin, tm phn cng/ phn mm tt hn, o to chnh chng ta v ngi dng. Mi khon mc u i hi phi c mt gii php.

12.4 Gim bt tc ng ca ri ro bng lp k hoch (bc 3)
Vi nhng khon mc chng ta khng th kh b c ri ro, th hy xc nh k hoch i ph vi iu bt ng. Vi mi khon mc ri ro c lin quan n ti nguyn, chng ta hy th s dng ti nguyn d phng.
Nu c xc sut cao v mt khon mc ri ro c th xut hin, th chng ta phi iu chnh ca gi tng ng.

Bng tm tt k hoch cho iu bt ng:
Khon mc ri ro | Hnh ng | Ai | Chi ph (%)
--- | --- | --- | ---
C trao i vi ngi dng | Hp theo tun; Lm bn mu | Trng QLDA; Ph QLDA | 5000$; 25000 $,3th
Ngi lp trnh ngh php | Ngi d phng | Tp s | 20.000$

t k hoch cho iu bt ng vo ct hnh ng ca bng bt ng. Trong ct Ai t tn ca ngi s chu trch nhim thc hin k hoch cho iu bt ng. Vi nhng khon mc ca chng ta cn c cnh bo sm, hy t vo ct Ai tn ca c nhn chu trch nhim vic ny v bo cho ton nhm khi s vic xy ra. Trong ct chi ph, t chi ph tng ln hoc thi gian m khon mc ri ro gy ra.

12.5 Kim sot khi c iu trc trc (bc 4)
Cui cng, mc cho tt c mi n lc ca chng ta, vi iu no  vn c trc trc. Hy tnh n vic mi th c th trc trc hy c gng gi quyn kim sot nhiu nht c th c. Hy lm ht sc mnh, cng b vic trt d n nu cn, v bo co cho mi ngi bit nguyn nhn vn , c bit nu h  bn ngoi quyn hn php l ca chng ta.

* Cu hi cng c:
1. Khi  cp n k hoch qun l ri ro cn phi xt n cc yu t no?
2. Cc ngun ri ro ph bin trong cc d n CNTT.
3. Tm hiu s khc bit gia k thut brainstorm v Delphi trong vic xc nh cc ri ro. u im v nhc im ca mi k thut.
4. Trnh by cch s dng cy quyt nh (decision tree) v phng php Monte Carlo i vi cc ri ro nh lng. Cho v d v cch s dng mi k thut cho d n CNTT.
5. Lit k cc cng c v k thut theo di v kim sot ri ro.
6. Cch s dng Microsoft Project v Excel  h tr qun l ri ro d n.`},{id:13,name:"Chng 13: QUN L TCH HP D N",shortName:"QUN L TCH HP D N",content:`Chng 13. QUN L TCH HP D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. M t khung lm vic ca qun l s tch hp d n trong mi quan h vi cc lnh vc kin thc v chu trnh sng ca d n.
2. M t vic pht trin k hoch d n, gm ni dung k hoch d n, dng cc hng dn v cc ti liu mu  pht trin k hoch, v phn tch stakeholder  qun l cc mi quan h.
3. Gii thch vic thc thi d n, quan h ca n vi hot ng lp k hoch, cc yu t dn n thnh cng, cc cng c v k thut h tr thc thi d n.

13.1 Tm quan trng ca qun l tch hp
Qun l ri ro d n l mt ngh thut v nhng nhn bit khoa hc, l nhim v, v s i ph vi ri ro thng qua hot ng ca mt d n v nhng mc tiu i hi quan trong nht ca d n.
Qun l ri ro thng khng c ch  trong cc d n, nhng n li gip ci thin c s thnh cng ca d n trong vic gip chn la nhng d n tt, xc nh phm vi d n, v pht trin nhng c tnh c tnh thc t.
Cha kha thnh cng: Qun l tch hp tt.
- Ngi qun l d n phi iu phi tt c cc lnh vc kin thc trong sut chu trnh sng ca d n.
- Nhiu ngi qun l d n mi gp kh khn khi nhn vo bc tranh tng th v mun tp trung vo qu nhiu chi tit.
- Qun l tch hp d n khng ging nh tch hp phn mm.

13.2 Qui trnh qun l tch hp
Nhng tin trnh chnh bao gm:
- Pht trin k hoch d n: ly kt qu ca cc qui trnh lp k hoch khc v a vo thnh mt ti liu nht qun v kt dnh  k hoch d n.
- Thc thi k hoch d n: thc hin k hoch d n
- iu khin thay i tch hp: iu phi nhng thay i trong ton b d n.

13.2.1 Pht trin k hoch d n
- K hoch d n l ti liu dng  iu phi tt c cc ti liu v hot ng ca d n. Mc ch chnh l hng dn thc thi d n. K hoch d n gip ngi QLDA lnh o nhm d n v nh gi tnh trng d n. Cn phi o vic thc hin d n so vi k hoch
Cc thuc tnh ca k hoch d n.
- K hoch d n mang tnh duy nht
- K hoch phi ng (dynamic)
- K hoch phi linh hot (flexible)
- K hoch phi c cp nht khi c thay i
- K hoch phi ng vai tr l ti liu hng dn thc thi d n
Cc thnh phn ph bin ca k hoch d n
- Tng quan v d n
- M t v cch t chc d n
- Cc qui trnh qun l v k thut dng trong d n
- Thng tin v cc vic phi lm, lch biu, v ngn sch
Phn tch cc bn tham gia
Phn tch cc bn tham gia cung cp thng tin quan trng (thng nhy cm) v cc cc bn tham gia nh:
Tn tui cc cng ty ca cc bn tham gia
- Vai tr ca h trong d n
- Cc s liu thc v cc bn tham gia
- Mc nh hng v quan tm n d n
-  xut cho qun l cc mi quan h

13.2.2. Thc thi k hoch d n
Thc thi k hoch d n i hi qun l v thc hin cc cng vic m t trong k hoch d n. Hu ht thi gian v tin bc c dng trong qu trnh thc thi d n. Lnh vc ng dng ca d n tc ng n vic thc thi d n v sn phm ca d n c to ra trong qu trnh ny.
Cc k nng quan trng  thc thi k hoch d n:
- Cc k nng qun l tng qut nh k nng lnh o, giao tip, v chnh tr
- K nng v sn phm v kin thc.
Cc cng c v k thut thc thi d n:
- H giao vic (Work Authorization System): mt phng php bo m con ngi  iu kin lm vic ng lc v ng trnh t.
- Hp nh gi tnh trng (Status Review Meetings): cc bui hp thng k  trao i thng tin v d n.
- Phn mm qun l d n (Project Management Software): phn mm c bit h tr qun l cc d n.

13.2.3 iu khin thay i tch hp
iu khin thay i tch hp gm nhn din, nh gi, v qun l nhng thay i trong sut chu trnh sng ca d n. Ba mc tiu ca iu khin thay i:
- Tc ng n cc yu t to ra s thay i  bo m c li.
- Xc nh nhng thay i  xy ra.
- Qun l nhng thay i thc t khi xy ra.
iu khin thay i i vi cc d n CNTT
- Cch nhn trc y: Nhm d n cn n lc lm ng theo k hoch, ng thi hn v trong phm vi ngn sch.
- Vn : cc bn tham gia him khi ng  ngay t u v phm vi ca d n, cho rng thi gian v chi ph d n l khng chnh xc.
- Cch nhn hin i: Qun l d n l mt qu trnh giao tip v tha thun lin tc.
- Gii php: Thay i thng c li, v nhm d n cn lp k hoch cho iu ny.
H iu khin thay i
- Mt qui trnh mang tnh hnh thc m t cc ti liu d n c th c thay i khi no v nh th no.
- M t ai c php thay i v thay i nh th no?
- Thng gm bng iu khin thay i (CCB), qun tr cu hnh, v mt qui trnh truyn t s thay i.
- Ban iu khin thay i (CCB=Change Controlling Board)
- Mt nhm ngi chu trch nhim v ph duyt hoc t chi thay i ca d n.
- CCB cung cp nhng hng dn  chun b yu cu thay i, nh gi yu cu thay i, v qun l vic thc hin nhng thay i c duyt.
- Gm cc bn tham gia ca ton cng ty.
Thay i ng lc
- Mt s CCB ch thnh thong mi gp nhau, v th nhng thay i c th xy ra qu lu.
- Mt s cng ty c chnh sch cho nhng thay i nhy cm v thi gian  chnh sch 48-gi cho php cc thnh vin nhm d n quyt nh, sau  h c 48 gi  ch ph duyt ca lnh o cp cao  a nhng thay i xung mc thp nht c th c, nhng phi thng bo cho mi ngi.
Qun tr cu hnh
- Bo m sn phm v m t v sn phm l ng v y .
- Tp trung vo qun l cng ngh bng cch xc nh v iu khin cc c trng chc nng v vt l ca sn phm.
- Cc chuyn gia qun tr cu hnh xc nh v vit ti liu v cc yu cu cu hnh, iu khin thay i, lu v bo co nhng thay i, kim tra sn phm xem c ph hp vi yu cu hay khng.

* Cu hi cng c:
1. Gii thiu khi nim qun tr tch hp dng t ng ring ca bn. Qun tr tch hp c quan h vi chu trnh sng d n, v cc lnh vc qun tr khc nh th no?
2. Cc thnh phn quan trng ca mt k hoch tt.
3. Cc yu t quan trng  thc thi d n thnh cng. Trnh by mt v d v d n c thc thi thnh cng, mt v d v d n tht bi. Xc nh nhng khc bit gia hai d n ny.
4. Tm quan trng ca qui trnh iu khin thay i tch hp (integrated change control process) i vi cc d n CNTT.
5. Trnh by ng dng ca cc cng c phn mm sau y trong qun tr tch hp d n: phn mm son tho vn bn (v d Winword), phn mm trnh by (v d Power Point), bng tnh (v d Excel), CSDL (v d Access), email, Web v phn mm qun tr d n.`},{id:14,name:"Chng 14: MICROSOFT PROJECT",shortName:"MICROSOFT PROJECT",content:`Chng 14. MICROSOFT PROJECT

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. Bit cch xc nh cc quy trnh lp d n
2. p dng Microsoft Project  to d n, t chc cc cng vic, qun l thi gian, qun l ti nguyn, chi ph ca d n
3. Xc nh c quy trnh theo di v qun l d n
4. Theo di chi ph hin ti v kh nng ti chnh
5. Xem v in bo biu

Phn mm h tr cho vic qun  d n c nhiu, t n gin nh bng tnh, son tho vn bn.. n cc phn mm c trng h tr cho tng cng vic lin qua n qun l d n nh lp lch, theo di, lu tr thng tin Trong phn ny ch tp trung gii thiu cc chc nng chnh ca MicroSoft Project- mt trong nhng cng c phn mm c th h tr cho chng ta trong vic phn chia cc cng vic, lp lch, theo di tin , iu phi nhn lc..

14.1 Khi nim chung v cc yu cu ca Microsoft Project

Microsoft Project l mt chng trnh chuyn dng  qun l cc d n, l chng trnh c nhng cng c mnh v thun tin. Microsoft Project c th lm vic vi nhiu ch , nhiu cng c, chc nng  thc hin cc thao tc to lp v hiu chnh trn d n ng thi tit kim thi gian v tin bc.

Mc ch ca Microsoft Project 2003 gm:
- T chc lp k hoch v qun l d n.
- Ln lch cng tc.
- Ch nh cc ti nguyn v chi ph cho cc cng vic trong d n.
- iu chnh k hoch  thch ng vi cc iu kin rng buc.
- Chun b cc bo biu cn thit cho d n.
- D tr cc tc ng n tin  ca d n khi xy ra nhng thay i c nh hng ln n d n.
- Xem xt li d n  i ph vi cc tnh hung ngu nhin.
- nh gi ti chnh chung ca d n.
- In n cc bo biu phc v d n.
- Lm vic v qun l theo nhm.
- Rt kinh nghim trong khi thc hin d n.

14.2 C s d liu ca Microsoft Project 2003

L mt nh qun l d n, s c rt nhiu cng vic  lm. Vy th Microsoft Project c th gip g cho cng vic ny? Trc ht, n lu tr thng tin chi tit v d n trong c s d liu v s dng cc thng tin ny  tnh ton, theo di tin trnh, chi ph ca d n v cc thnh phn khc ng thi to ra mt k hoch cho d n. Cng nhiu thng tin v d n cung cp, d n cng c thc hin chnh xc by nhiu.

Ging nh mt bng tnh, Microsoft Project th hin kt qu ngay sau cc tnh ton.

Tuy nhin k hoch ca d n s khng c lp cho n khi hon thnh cc thng tin quan trng ca cc cng vic.

Microsoft Project lu gi thng tin nhp vo v thng tin n tnh ton trong cc trng nh tn cng vic hay khong thi gian thc hin. Trong Microsoft Project, mi trng c th hin trn mt ct.

14.3 Xem xt d liu cn thit

Ngi s dng (NSD) c th xem xt thi gian kt thc ca cc cng vic trong hm nay, ngy mai NSD li mun xem xt chi ph cng vic. C s d liu d n cha ng rt nhiu thng tin nhng ti mt thi im NSD c th ch cn mt phn thng tin.  lm c iu  Microsoft Project cung cp mt s dng th hin sau:
- Cc khung nhn: Th hin mt tp con ca cc thng tin  c nh dng. V d s  Gantt th hin thng tin v cc cng vic.
- Cc bng: Gm cc thng tin c nh ngha ngay ban u.
- Cc thng tin chn lc: cho php chn lc cc thng tin v cng vic hay ti nguyn.

14.4 H thng lch lm vic ca Microsoft Project

Cch thc Microsoft Project s dng h thng thi gian bt u v kt thc cc cng vic nh th no? iu ny c tnh ton theo cc nhn t nh mc  c lp ca cng vic, cc rng buc lin quan, cc khong thi gian t on cng nh cc ngy ngh, ngy l.

Mt s t kho trong Microsoft Project 2003
- Task: Cng vic, nhim v
- Duration: Thi gian thc hin cng vic
- Start: Ngy bt u
- Finish: Ngy kt thc
- Predecessors: Cng vic lm trc
- Successors: Cng vic k tip
- Task list: Danh sch cc cng vic
- Resource: Ti nguyn/nhn lc, my mc thc hin cc cng vic ca d n
- Work: S gi cng c gn  thc hin cng vic
- Unit: Kh nng lao ng ca ti nguyn
- Milestone: Loi cng vic c bit (im mc) c Duration=0, dng  kt thc cc giai on trong d n
- Recurring Task: Cng vic nh k, lp i lp li nhiu ln theo chu k trong thi gian thc hin d n. V d cc bui hp giao ban u tun
- Shedule: Lch trnh ca d n
- Baseline: Theo k hoch
- Summary Task (Cng vic tm lc): Cng vic m chc nng duy nht ca n l cha ng v tm lc thi khong, cng vic v chi ph ca cc cng vic khc.

14.5 To mt d n

Thi gian NSD xc inh c r mc ch ca d n v vch ra c cc giai on chnh ca d n cng chnh l lc NSD cn to ra mt k hoch cho d n.

Trc ht, nhp v t chc cc cng vic v khong thi gian  thc hin chng. Sau  khi to nhn lc, thit b, nguyn vt liu v chi ph cho cc cng vic. Vi nhng thng tin ny, Microsoft Project s to ra mt k hoch lm vic, ch cn kim tra li k hoch v iu chnh khi cn thit. Phn ny s hng dn to lp k hoch d n.

Phn ny s bao gm cc giai on sau:
Giai on 1: Thit lp mt d n mi.
Giai on 2: Cch thc nhp v t chc cc cng vic.
Giai on 3: Thi gian bt u v thi gian kt thc cng vic.
Giai on 4: Khi to ti nguyn, nhn lc cho cng vic.
Giai on 5: Xem xt h thng cng vic
Giai on 6: Xem v in bo co

14.5.1 Giai on 1 - Thit lp mt d n mi

Bc u tin  to k hoch lm vic l to ra mt file d liu mi, thit lp thi gian bt u, thi gian kt thc v nhp cc thng tin chung v d n. Sau khi nghin cu xong giai on ny, NSD s c mt file d liu Microsoft Project cha ng tn d n, ngy d kin bt u, ngy d kin kt thc, k hoch d n cng nh cc thng tin khc v d n.

Giai on ny gm c 3 im chnh sau:
- To mi mt d n
- Nhp cc thng tin quan trng v d n
- Thit lp h thng thi gian trong d n

1. To mi 1 d n

Khi bt u vi 1 d n mi vi Microsoft Project, ch c th nhp thi gian bt u hay thi gian kt thc ca d n. Microsoft cng khuyn rng chng ta ch nhp thi gian bt u ca d n v  t chng trnh tnh thi im kt thc sau khi  nhp cc thng tin v thi gian ca tng cng vic.

B1 Kch nt New trn thanh cng c hay trong menu File, chn New.
B2 Trong hp thoi Project Information, nhp thi gian bt u hay kt thc ti mc Start date hay Finish date cho d n, v sau  kch nt OK.

[Hnh nh: Hp thoi Project Information]

B3 Kch nt Save hay trong menu File, chn mc Save  lu gi thng tin d n.
B4 Trong mc File name, nhp tn d n, v sau  nhn nt Save.

[Hnh nh: Hp thoi Save As]

Ch  C th thay i thng tin v d n bt c thi im no bng cch chn mc Project Information trn menu Project

[Hnh nh: Menu Project Information]

2. Nhp cc thng tin quan trng cho d n

Mi mt d n u c mt s thnh phn c trng nh cc cng vic c lin quan, mt s vng mc s gp phi khi thc hin, ngi thc hin chng v mc ch ca d n.  c th nh v theo di c cc thng tin ny khi cn thit hy thc hin theo cc bc sau:

B1 Trn menu File, kch Properties, v sau  kch tab Summary.

[Hnh nh: Menu File Properties]

B2 Trong Tab Summary, nhp nhng thng tin lin quan n d n, nh ngi lp v qun l file d n, mc ch ca d n, hay bt c iu g c th gy kh khn trong qu trnh thc hin d n.

[Hnh nh: Hp thoi Properties]

B3 Kch nt OK.

3. Thit lp h thng lch lm vic cho d n

C th thay i thi gian lm vic ca d n  phn nh s ngy cng nh s gi lm vic ca mi ngi trong d n. Microsoft Project thit lp mc nh thi gian lm vic cho d n t th 2 n th 6, bt u t 8 gi sng n 5 gi chiu.

C th xc nh thi gian ngh nh cui tun v cc bui ti cng nh ngy l hay thi gian i ngh.

B1 Trn menu View, kch Gantt Chart.

[Hnh nh: Menu View Gantt Chart]

B2 Trn menu Tools, kch Change Working Time.

[Hnh nh: Menu Tools Change Working Time]

B3 Trn hp thoi Chage Working Time, chn lch lm vic.

[Hnh nh: Hp thoi Change Working Time]

 thay i thi gian lm vic ca mt ngy trong tun trong ton b d n, chn ngy cn thay i, sau  chn la chn Default Working Time v chnh li thi gian lm vic ca ngy . V d mun ngy th 6 hng tun u kt thc vo 4 gi chng hn.

 thay i thi gian lm vic ca mt s ngy, v d nh t th 3 n th 6 u lm vic lc 9 gi, ch cn kch chut vo ngy th 3, sau  gi phm Shift v kch chut n th 6. Cng vic tip theo l thay i thi gian lm vic ca nhng ngy ny.

B4 Kch Nonworking time i vi nhng ngy ngh, hay Nondefault working time  thay i thi gian lm vic ca mt ngy no .
B5 Kch OK.

14.5.2 Giai on 2 - Cch thc nhp v t chc cc cng vic

u tin hy lit k cc bc  hon thnh d n, bt u vi tng khi cng vic v chia nh nhng khi cng vic thnh nhng khi nh hn. C nh vy cho ti khi n c chia thnh nhng cng vic nh c th phn giao c th c. Cui cng nhp cc khong thi gian thit lp cho tng cng vic.

Sau khi hon thnh giai on ny, s c mt tp hp cc cng vic c t chc mt cch h thng v thng tin chi tit v nhng cng vic ny.

Giai on ny c 5 im chnh sau:
- Nhp cng vic v thi gian thc hin.
- To nhng mc nh du.
- To nhng cng vic nh k.
- Phn cp cng vic.
- Hiu chnh h thng cng vic.

1. Nhp cc cng vic v thi gian thc hin

Mt d n l mt chui nhng cng vic c lin quan ti nhau. Mt cng vic s chim gi mt khong thi gian v chng s c theo di tin trnh thc hin. Mt cng vic c th c thc hin trong mt ngy hay nhiu tun.

Hy nhp cc cng vic theo th t m chng xy ra, sau  c tnh s thi gian  thc hin cng vic .

Ch : Khng nn nhp ngy bt u v kt thc trong cc trng Start v Finish i vi mi cng vic. Microsoft Project tnh ton thi gian bt u v kt thc da trn mi quan h gia cc cng vic, da trn cc thng tin nhp vo. Phn ny s c ni r trong giai on sau:

B1 Trn menu View, kch Gantt Chart.

[Hnh nh: Menu Gantt Chart]

B2 Trong ct Task Name, nh tn cng vic, v sau  nhn phm TAB.

[Hnh nh: Nhp tn cng vic trn bng]

Microsoft Project t ng nhp thi gian c tnh cho cng vic l mt ngy cng vi du ?

B3 Trong ct Duration, nhp thi gian thc hin cng vic theo thng, tun, ngy, gi hay pht. C th s dng cc du tt sau:
thng = mo
tun = w
ngy = d
gi = h
pht = m

Ch :  ch ra y l thi gian c tnh, nh thm du hi sau khong thi gian thc hin.

B4 Nhn phm ENTER.

Ch : C th thm mt ch thch cho mi cng vic. Trong ct Task Name, chn tn cng vic cn thm ch thch, sau  kch nt Task Notes. Nhp thng tin ch thch trong hp thoi Notes, sau  kch nt OK.

2. To mc d n (milstones)

To mc d n l mt vic rt c  ngha trong k hoch thc hin d n, v d nh vic hon thnh mt pha chnh ca d n, bo co thnh qu hoc mt s kin nh du kt thc 1 cng vic. Khi nhp khong thi gian cho 1 cng vic l 0 ngy Microsoft Project th hin 1 biu tng mc d n trn biu  Gantt ti thi gian bt u cng vic.

B1 Trong ct Duration ca cng vic cn to mc nhp 0.
B2 Nhn phm ENTER.

Ch :  hin th tt c cc im mc trong khung nhn, chn kiu hin th trong danh sch l Milestones.  hin th li ton b cc cng vic trong d n, chn All task trong danh sch kiu hin th.

[Hnh nh: Danh sch cc cng vic v im mc trn mn hnh]

3. To cc cng vic nh k

Cng vic nh k l nhng cng vic thng xuyn lp i lp li, v d nh 1 bui hp giao ban th hai hng tun. Cng vic nh k c th xy ra hng ngy, hng tun, hng thng hay hng nm. C th xc nh khong thi gian thc hin i vi mi ln cng vic xut hin hay thi gian no n s xy ra.

B1 Trong ct Task Name, chn ni mun cng vic nh k xy ra
B2 Trong menu Insert, chn Recurring Task.

[Hnh nh: Menu Insert Recurring Task]

B3 Trong hp thoi Recurring Task Information, nh tn cng vic

[Hnh nh: Hp thoi Recurring Task Information]

B4 Trong phn Duration, nhp thi gian thc hin cng vic mi khi cng vic xy ra.
B5 Di Recurrence pattern, kch Daily, Weekly, Monthly, hay Yearly  chn kiu xut hin ca cng vic theo hng ngy, hng tun, hng thng hay hng nm.
B6 Pha bn phi Daily, Weekly, Monthly, hay Yearly, xc nh tn xut cng vic xy ra. V d nu nh mt cng vic nh k xut hin vo th hai hng tun.
B7 Di Range of recurrence, nhp ngy bt u v sau  chn ngy kt thc sau mt s ln xy ra (mc End After) hay cng vic s c kt thc vo thi gian no (End By).
 Nu chn End after, chn s ln cng vic xy ra.
 Nu chn End by, nhp ngy mun cng vic ny kt thc.
B8 Nhp OK  ng .

Ch :  xem tt c cc phn ca cng vic nh k, kch vo du + gn cng vic inh k.

4. Phn cp cc cng vic

Vic phn cp gip t chc cc cng vic thnh nhng khi d dng qun l, cc cng vic c to thnh mt h thng phn cp, cng vic ny c th l cp con ca cng vic khc nhng cng c th l cp cha ca mt s cng vic. Thi gian bt u v kt thc mt cng vic cha c tnh theo thi gian bt u sm nht v thi gian kt thc mun nht ca cc cng vic con ca n.

 t chc theo ch  phn cp, s dng cc nt sau:
[Hnh nh: Nt mi tn phi] Cp thp hn
[Hnh nh: Nt mi tn tri] Cp cao hn
[Hnh nh: Nt du cng] Hin th cc cng vic con
[Hnh nh: Nt du tr] Khng hin th cc cng vic con
[Hnh nh: Nt Show All] Hin th tt c cc cng vic con

B1 Trn menu View, chn s  Gantt.
B2 Chn cng vic m NSD mun n tr thnh cng vic con ca cng vic pha trn n.
B3 Kch nt [Hnh nh: Nt Indent]. Cng vic ny s tr thnh cng vic con.

Ch : C th chuyn i cp ca cng vic bng cch t chut vo phn u tn cng vic mun chuyn, khi con tr chuyn sang hnh mi tn hai chiu c th ko ra ngoi hay vo trong tu theo cp ca cng vic.

5. Hiu chnh danh sch cc cng vic

Ngay khi to danh sch cng vic, c th chia nhng cng vic ln thnh nhiu cng vic con v sp xp li. NSD c th mun sao chp, xo hay di chuyn cc cng vic trong d n.

B1 Trong ct ID, chn cng vic mun sao chp, xo hay di chuyn
  chn mt hng, kch vo s ID.
  chn mt s cng vic lin k nhau, t chut vo cng vic u, gi phm Shift v sau  ko chut n cng vic cui.
  chn nhng cng vic khng lin k nhau, t chut vo mt cng vic no , sau  gi phm Ctrl v kch chut vo cc cng vic cn thay i.

B2 Sao chp, di chuyn, hay xo cng vic.
  sao chp cng vic, kch nt Copy trn thanh cng c hoc c th vo menu Edit, chn Copy Cell.

[Hnh nh: Menu Edit Copy Cell]

 di chuyn cng vic, kch nt Cut trn thanh cng c hoc c th vo menu Edit, chn Cut Cell.

[Hnh nh: Menu Edit Cut Cell]

  xo cng vic, trong menu Edit, chn Delete.

[Hnh nh: Menu Edit Delete Task]

B3  di chuyn nhng cng vic  la chn, chn ni mun di chuyn ti.
B4 Kch nt Paste. Trn thanh cng c hay trong menu Edit, chn Paste.

[Hnh nh: Menu Edit Paste]

Ch :  thm mi mt cng vic vo gia nhng cng vic  tn ti, kch vo mt s ID no  v nhn phm INSERT. Ct ID ca cc cng vic pha sau s t ng cp nhp li sau khi thm mi mt cng vic.

14.5.3 Giai on 3 - Thi gian bt u v thi gian kt thc cng vic

Ngay sau khi to v phn cp danh sch cc cng vic l thi im xc nh mi quan h gia cc cng vic v thi gian thc hin chng. Cc mi lin h gia cc cng vic c th hin bng cc ng kt ni. Microsoft Project t ng quyt nh thi im bt u v thi im kt thc cho mi cng vic nu chng c lin quan ti cng vic khc. i vi nhng cng vic thc hin mt cch c lp, phi t xc nh thi im bt u v kt thc cng vic .

Mt c im thun li ca nhng cng vic c lin kt vi cng vic khc l bt c khi thi gian thc hin 1 cng vic thay i, thi gian thc hin ca cc cng vic c lin quan cng thay i theo. C th thay i h thng k hoch cc cng vic bng cch s dng cc rng buc, cc cng vic gi ln nhau hay cc cng vic b ngt qung.

Giai on ny gm 5 im chnh sau:
- Thit lp mi quan h gia cc cng vic.
- Cc cng vic gi chng ln nhau v cc cng vic ngt qung.
- Thi gian bt u v kt thc ca mt cng vic.
- Xc nh hn cui cng cho 1 cng vic.
- Chia mt cng vic thnh nhiu phn.

1. Thit lp mi quan h gia cc cng vic

 thit lp mi quan h gia cc cng vic, chng ta s dng cc ng kt ni. Trc ht, chn nhng cng vic c lin quan, kt ni chng v sau  c th thay i kiu kt ni. Cng vic c ngy bt u v kt thc ph thuc vo cng vic khc gi l cng vic k tip. Cng vic m cng vic k tip ph thuc vo gi l cng vic lm trc. V d sau s ch r cho thy mi quan h gia cc cng vic, nu thit lp mi quan h gia 2 cng vic l treo ng h v sn tng th cng vic sn tng s l cng vic lm trc, cng vic treo ng h s l cng vic k tip.

Sau khi cc cng vic c thit lp mi quan h, vic thay i thi gian bt u cng nh kt thc ca cc cng vic lm trc s nh hng n thi gian thc hin ca cc cng vic k tip. Microsoft Project mc nh  quan h kt thc- bt u (Finish- to- Start) khi to cc lin kt gia cc cng vic. Trong nhiu trng hp, mi quan h gia cc cng vic khng phi nh vy, c th thay i kiu lin kt ny theo cc dng sau  ph hp vi m hnh d n: bt u - bt u (Start- to- Start), kt thc- kt thc (Finish- to-Finish), bt u - kt thc (Start- to Finish)

B1 Trn menu View, chn s  Gantt.
B2 Trong ct Task Name, chn hai hay nhiu cng vic mun lin kt vi nhau.
 lin kt cc cng vic lin tip nhau, gi phm Shift, v sau  kch chut vo cng vic u tin v cng vic cui.
 lin kt cc cng vic cch xa nhau, gi phm CTRL,v sau  chn nhng cng vic mun lin kt vi nhau theo th t cng vic no chn trc s l cng vic lm trc, cng vic no chn sau s l cng vic k tip.

B3 Kch nt Link Tasks.
B4  thay i kiu lin kt, kch p vo ng li kt gia 2 cng vic ang mun thay i.

[Hnh nh: Minh ha click p vo ng lin kt]

Mt hp thoi Task Dependency xut hin

[Hnh nh: Hp thoi Task Dependency]

B5 Trong hp lit k Type, chn kiu lin kt, sau  kch OK.

Ch :  hu b lin kt gia cc cng vic, chn cc cng vic mun hu trong ct Task Name, v kch nt Unlink Tasks. Cc cng vic ny s c sp xp li da trn nhng lin kt v cc rng buc cn tn ti .

2. Cc cng vic gi chng ln nhau

Sau khi cc cng vic  c lin kt vi nhau, c th gi chng hay thm mt khong tr thi gian gia 2 cng vic. Trong Microsoft Project, c th nhp khong thi gian gi chng hay thi gian ngt qung i vi cc cng vic c lin kt.

B1 Trong ct Task Name, chn cng vic mun thm thi gian gi chng hay thi gian tr (y l nhng cng vic k tip), v sau  kch nt Task Information. C th thc hin thao tc trn bng cch chn cng vic v trong menu Project, chn mc Task Information.

[Hnh nh: Menu Project Task Information]

B2 Hp thoi Task Information hin ln, Kch Tab Predecessors.

[Hnh nh: Hp thoi Task Information - Tab Predecessors]

B3 Trong ct Lag, nhp thi gian gi chng hay thi gian tr.
 Nhp thi gian gi chng theo s m (v d, 2d cho 2 ngy gi chng)
 Nhp thi gian tr theo s dng.
B4 Kch nt OK.

Ch :  nhanh chng a thi gian xp chng hay thi gian tr cho mt cng vic k tip, kch p vo ng kt ni gia cng vic  v cng vic lm trc Gantt Chart, v sau  nhp thi gian gi chng hay thi gian tr trong hp thoi Task Dependency.

3. Thit lp thi gian bt u v thi gian kt thc ca cng vic

C th lp k hoch thc hin cc cng vic hiu qu bng cch nhp khong thi gian, to cc lin kt gia cc cng vic v sau   Microsoft Project tnh ton thi gian bt u v kt thc cho cc cng vic c lin quan. Tuy nhin phi xc nh thi gian bt u v thi gian kt thc cho mt s cng vic.

Nhng rng buc v thi gian bt u hay kt thc i vi mt cng vic c gi l nhng rng buc cng. Do Microsoft Project tnh ton h thng k hoch da c trn nhng rng buc ny do  ch s dng khi cng vic b rng buc v thi gian bt u hay kt thc.

B1 Trong ct Task Name, chn cng vic mun xc nh thi im bt u v kt thc, sau  kch Task Information.
B2 Chn Tab Advanced.
B3 Trong hp thoi Task Information, mc Constraint type, chn kiu rng buc.

[Hnh nh: Hp thoi Task Information - Tab Advanced]

B4 Chn ngy trong Constraint date, v kch OK.

Ch : Sau y l bng lit k cc kiu rng buc:

* Kiu rng buc | *  ngha
--- | ---
As soon as possible | Cng vic khng b rng buc
As Late as possible | Cng vic ny phi b tr hon cng lu cng tt
Finish No Earlier than | Cng vic phi kt thc sau ngy thng ch nh.
Finish No Later than | Cng vic phi kt thc vo ngy hoc sm hn ngy thng ch nh.
Must Finish On | Cng vic phi kt thc chnh xc vo ngy thng  nh.
Must Start On | Cng vic phi bt u vo ngy thng  nh
Start No Earlier than | Cng vic bt u vo ngy thng hoc mun hn ngy thng ch nh.
Start No Later than | Cng vic phi bt u trc ngy thng ch nh.

4. Xc nh hn cui cho 1 cng vic

Khi thit lp mt hn cui cho 1 cng vic, Microssoft Project s th hin mt du hiu thng bo nu cng vic trong k hoch l kt thc sau thi hn cui.

[Hnh nh: Minh ha cnh bo hn cht trn biu  Gantt]

Vic thit lp mt hn nh cho 1 cng vic khng nh hng nhiu n k hoch cng vic.  l cch Microsoft Project thng bo cho bit rng cng vic  s kt thc m vt qu thi gian hn nh  c th iu chnh k hoch hp l hn.

B1 Trn menu View, chn khung nhn Gantt.
B2 Trong ct Task Name, chn cng vic mun thit lp hn nh thi gian.
B3 Chn nt Task Information v sau  chn Tab Advanced.
B4 Trong phn Deadline, chn ngy hn nh v kch OK.

5. Chia mt cng vic thnh nhng phn nh

C th chia nh mt cng vic nu thi gian cho cng vic b ngt qung. iu ny rt c ch, v d s c thi gian tm thi dng cng vic ang lm  chuyn sang mt cng vic khc. C th chia mt cng vic thnh nhiu phn nu cn thit.

Cng phi ch  thm rng vic chia nh 1 cng vic thnh nhiu phn khng ging nh nhng cng vic nh k  c bit trong nhng bi trc.

B1 Trn menu View, chn khung nhn Gantt.
B2 Kch nt Split Task hay trong menu Edit chn mc Split Task.

[Hnh nh: Menu Edit Split Task]

B3 Trn thanh ngang biu din cng vic, kch vo ngy mun chia cng vic, sau  ko phn cn li ti ngy mun cng vic li bt u tip tc.

Ch  C th ghp li cc phn bng cch ko cc phn cng vic chm vo nhau.

14.5.4 Giai on 4 - Khi to ti nguyn, nhn lc cho cng vic

Khi to ti nguyn cho cc cng vic trong d n :
- Theo di mc  s dng ti nguyn trong d n
- Theo di c chi ph cho ti nguyn.

Giai on ny bao gm cc im chnh sau:
- To danh sch cc ti nguyn.
- Thay i thi gian lm vic cho nhn vin hay my mc.
- Khi to cc ti nguyn cho cng vic.
- Sa i khong thi gian thc hin cng vic.
- Kim tra hiu chnh vic khi to ti nguyn.

1. To danh sch ti nguyn

C th s dng khung nhn Resource Sheet trong Microsoft Project  to mt danh sch cc ti nguyn s dng trong d n nh nhn cng, thit b, nguyn vt liu. Cc ti nguyn bao gm ti nguyn cng vic v ti nguyn vt liu.

B1 Trn menu View, chn khung nhn Resource Sheet.

[Hnh nh: Menu View Resource Sheet]

B2 Trn menu View, ch ti Table, v sau  kch Entry.

[Hnh nh: Menu View Table Entry]

B3 Trong ct Resource Name, nh tn ti nguyn.

[Hnh nh: Bng danh sch ti nguyn Resource Sheet]

B4  ch nh nhm ti nguyn, trong ct Group, nh tn nhm.
B5 Trong ct Type, xc nh kiu ti nguyn
B6 Vi mi mt kiu ti nguyn cng vic (ngi v my mc, thit b), nhp n v ti ct Max. Vi kiu ti nguyn ny n v s dng c tnh theo t l phn trm ca gi tr max. V d, nhp 100% c ngha l thi gian s dng ton b thi gian lm vic i vi mi ti nguyn no .

Ch :
 Nhm ti nguyn c dng  sp xp, lc hay nhm cc cng vic, v d nh c th xem danh sch cc cn b ca mt nhm chuyn  no .
 Khng th khi to nhm ti nguyn cho 1 cng vic no 

2. Thay i thi gian lm vic cho nhn vin

C th nh ngha thi gian lm vic cho mt nhn vin no   thch ng vi d n. Ly mt v d rt n gin nh sau, mt nhn vin A c thi gian ngh ti thng 6 nhng nhn vin B li l thng 7 v vy cn phi c nhng thi gian biu khc nhau i vi tng nhn vin.

B1 Trn menu View, chn Resource Sheet, v sau  chn ti nguyn mun thay i thi gian lm vic.
B2 Trong menu Project, chn Resource Information, v chn tab Working Time.

[Hnh nh: Menu Project Resource Information]

[Hnh nh: Hp thoi Resource Information - Tab General]

B3 Trong Tab Resource Information, ti h thng lch lm vic, chn ngy mun thay i.

[Hnh nh: Hp thoi Resource Information - Tab Working Time]

B4 Chn kiu Use default, Nonworking time, hay Nondefault.
Khi chn Use default, thi gian lm vic ca ngy chn s ly theo thi gian mc nh ca h thng Microsoft Project.
B5 Nu chn Nondefault ti bc 4, nhp thi gian bt u vo mc From v thi gian kt thc vo mc To.
B6 Chn OK.

Ch : Nu 1 nhm ti nguyn c cng thi gian lm vic v ngh ging nhau, c th to mt lch lm vic mi cho chng. Trn menu Tools, chn Change Working Time. Kch New v nhp tn cho h thng lch lm vic mi.

3. Khi to cc ti nguyn cho cng vic

C th khi to bt c mt ti nguyn no cho bt k cng vic no, c th khi to nhiu hn 1 ti nguyn cho mt cng vic v xc nh ti nguyn  c s dng ton thi gian hay bn thi gian. Nu s khi to thi gian s dng ti nguyn vt qu thi gian cho php ( c thit lp trong h thng lch s dng ti nguyn), Microsoft Project th hin mc  s dng qu ti ti nguyn  bng mu  trong khung nhn Resouce View.

B1 Trong menu View, chn Gantt Chart.
B2 Trong ct Task Name, chn cng vic mun khi to ti nguyn, v sau  kch Assign Resources hay trong menu Tools, mc Resources, chn Assign Resources.

[Hnh nh: Menu Tools Assign Resources]

B3 Trong ct Name, chn ti nguyn mun khi to cho cng vic.
B4 Nu ch s dng ti nguyn bn thi gian, nhp s phn trm s dng
  khi to mt s ti nguyn, gi phm CTRL v sau  kch vo tn ca cc ti nguyn.
B5 Kch Assign.
B6 Kch Close.

Ch : C th thay th ti nguyn ny bng ti nguyn khc. Chn cng vic c ngun ti nguyn mun thay th. Trong hp thoi Assign Resources, chn tn ti nguyn v kch Replace.

4. Sa i khong thi gian thc hin cng vic

Khi khi to nhiu ti nguyn cho mt cng vic, Microsoft Project t ng gim khong thi gian thc hin cng vic. V d mt cng vic do 1 nhn vin thc hin trong mt ngy th s ch mt na ngy  thc hin nu hai nhn vin cng thc hin. Nu mun gi khong thi gian thc hin cho cng vic  l nh c trong khi vn c thm ti nguyn s dng cho cng vic , thc hin nh sau.

B1 Trn menu View, kch khung nhn Gantt.

[Hnh nh: Menu View Gantt Chart]

B2 Trong ct Task Name, chn tn cng vic.
B3 Kch nt Task Information trn thanh cng c hay trong menu Project chn mc Task Information. V sau  chuyn sang Tab Advanced.

[Hnh nh: Menu Project Task Information]

B4 Trong hp thoi Task Information xo b du kim trong mc Effort driven, v sau  kch OK.

[Hnh nh: Hp thoi Task Information - Tab Advanced]

By gi khi khi to thm ti nguyn cho cng vic, khong thi gian thc hin s khng thay i.

Ch : C th lm cho tt c cc cng vic mi s to ra khi thm ti nguyn th thi gian thc hin s khng gim bng cch trong menu Tools, chn mc Options, kch tab Schedule v sau  b du kim ti mc New tasks are effort driven.

[Hnh nh: Hp thoi Options - Tab Schedule]

5. Kim tra hiu chnh vic khi to ti nguyn

Khung nhn Resource Usage th hin tt c cc ti nguyn s dng trong d n. Vi khung nhn ny, c th thy rng ngun ti nguyn c s dng nh th no, nhng ngun ti nguyn no c th s dng c tip, ngun ti nguyn no ang b qu ti.

B1 Trong menu View, chn Resource Usage.

[Hnh nh: Menu View Resource Usage]

 c nhiu thng tin hn v vic s dng ti nguyn, trong menu View, mc Table, kch vo bng mun hin th trong khung nhn Resource Usage.

[Hnh nh: Menu View Table]

B2 Trong ct Resource Name, xem li cc cng vic s dng ngun ti nguyn ny.
B3  chuyn i ngun ti nguyn cho mt cng vic, chn hng cha cng vic  v sau  ko ln phn ti nguyn cn chuyn i.

Ch :
 Vic thm cc bng thng tin hin th trn khng lm thay i thng tin v d liu m ch l thay i cch th hin.
 Nu mt ti nguyn mu  v m, ti nguyn  ang b s dng qu ti.

14.5.5 Giai on 5 - Xem xt h thng cng vic

Sau khi nhp ht nhng thng tin v d n, hy xem xt li xem chng c ph hp vi d tnh hay khng. Nu khng hy kim tra li qu trnh thc hin cc cng vic. Giai on ny bao gm cc im chnh sau:
- Xem xt ton b d n
- Kim tra ngy bt u v kt thc ca d n
- Chuyn i gia cc khung nhn
- Xem xt cc ct khc nhau trong mt khung nhn
- Th hin thng tin c chn lc
- Sp xp thng tin trong mt khung nhn
- Nhm thng tin trong mt khung nhn

1. Xem xt ton b d n

C th quan st thi gian bt u, kt thc d n v thi gian nhng pha chnh xy ra trn khung nhn Gantt.

B1 Trn menu View, chn Gantt Chart.
B2 On the View menu, click Zoom, click Entire project, and then click OK.

[Hnh nh: Hp thoi Zoom]

2. Kim tra ngy bt u v kt thc ca d n

C th xem li thng tin v ngy kt thc d n xem c ng mong i hay khng.

Trong menu Project, chn Project Information v kch Statistics, ngy bt u v kt thc d n s c hin th.

3. Chuyn i gia cc khung nhn

C th thy c d n qua cc khung nhn khc nhau nh: Calendar, Network Diagram, Task Usage, Resource Usage, Resource Graph...

Trn menu View, chn khung nhn mun quan st.
Nu khung nhn mun quan st hin thi khng c trong menu View, kch vo mc More Views  c nhiu la chn. Chn 1 kiu khung nhn trong bng lit k Views, sau  chn Apply.

Ch : Thay i khung nhn khng lm nh hng n d liu thng tin d n, n ch thay i cch nhn v d n.

Di y l 8 khung nhn thng dng nht:

Tn khung nhn | Ni dung
--- | ---
Calendar | Lch hng thng ch ra cc cng vic v kh nng hon thnh n.
Gantt Chart | Din t cc cng vic v cc thng tin c lin quan, mt biu  (biu  ngang) th hin cc cng vic v thi gian hon thnh chng.
Network Diagram | Th hin di dng li cc cng tc (s  mng) v s ph thuc gia chng. Dng khung nhn ny  c mt ci nhn bao qut v cc cng vic.
Task Usage | Th hin danh sch cc cng vic  c gn ti nguyn. Dng khung nhn ny  thy ngun ti nguyn no  c gn cho mt cng vic c th
Tracking Gantt | Th hin danh sch ca cng vic v thng tin c lin quan. Dng khung nhn ny  theo di tin trnh ca d n.
Resource Graph | Th hin biu  phn phi ti nguyn. Dng khung nhn ny  th hin thng tin v mt ti nguyn di cc tiu ch khc nhau.
Resource Sheet | Danh sch ti nguyn v thng tin lin quan. Dng khung nhn ny  nhp v hiu chnh cc thng tin v ti nguyn.
Resource Usage | Th hin danh sch gn ti nguyn cho cng vic c nhm di mi ngun ti nguyn. Dng khung nhn ny  th hin chi ph hoc phn phi gi cng ngoi gi.
More View | Cho php la chn cc khung nhn khc ca chng trnh.

4. Xem xt cc ct khc nhau trong mt khung nhn

Trong khi lp v theo di d n, rt hu ch nu chng ta c th xem xt thm nhiu t hp cc thng tin trong mt khung nhn. Microsoft Project cung cp mt tp hp cc t hp thng tin i vi mi khung nhn:

B1 Trong menu View, chn khung nhn mun quan st.
B2 Trn menu View, mc Table, chn bng mun xut hin trong khung nhn.

 thm nhng bng khng nm trong mc Table, chn More Tables, chn bng mun thm, v sau  chn Apply.

5. Th hin thng tin c chn lc

i khi, ch cn theo di ch mt s cng vic xc nh no , Microsoft Project cho php lc thng tin trong ton d n  c c nhng thng tin cn thit.

B1 Trn menu Project, mc Filtered for, sau  chn kiu lc.
 nhp kiu lc hin thi khng nm trong mc Filtered for, chn mc More Filters.
B2 Chn Apply  xc nh kiu lc.
B3  th hin tt c cc cng vic tr li, trn menu Project v sau  chn All Tasks hay All Resources.

Ch : Khng th lc cc cng vic trong khung nhn Resource hay lc cc ti nguyn trong khung nhn Task.

6. Sp xp thng tin trong mt khung nhn

C th sp xp cc cng vic hay ti nguyn theo mt iu kin no  nh tn cng vic, ngy kt thc, tn ti nguyn. Vic sp xp s l rt hu ch khi mun theo di cc cng vic theo th t. V d c th xem xt cng vic no nn bt u hay kt thc sm hn.

Vic sp xp vn c duy tr khi chuyn i gia cc khung nhn cng nh ng hay lu d n.

B1 Trn menu View, chn Gantt Chart.
B2 Trn menu Project, mc Sort, v chn kiu sp xp theo  mun.

[Hnh nh: Menu Project Sort]

B3  tin li trong qu trnh sp xp, Microsoft Project cung cp mt chc nng tu bin khi sp xp. Trong menu Project, mc Sort, v chn Sort by.
B4 Trong hp thoi Sort by, chn nhng ct mun sp xp, v chn Ascending hay Descending  xc nh kiu sp xp l tng dn hay gim dn.

[Hnh nh: Hp thoi Sort]

7. Nhm thng tin trong mt khung nhn

Trong mt s khung nhn, c th nhm cc cng vic hay ti nguyn theo mt iu kin no . V d, c th xem xt tt c nhng cng vic c cng mt khong thi gian thc hin.

B1  nhm thng tin v cng vic, trn menu View, chn mc More Views, v sau  chn Task Sheet.
 nhm thng tin v ti nguyn, trn menu View, chn Resource Sheet.
B2 Trong menu Project, mc Group by, v chn nhm.
 chn mt nhm khng nm trong mc Group by, kch More Groups.

[Hnh nh: Menu Project Group by]

B3  tr li trng thi ban u, trn menu Project, mc Group by v chn No Group.

14.5.6 Giai on 6- Xem v in bo co

Vic in n cc bo co c th theo cc dng sau:
- Cc bo co chun ca Microsoft Project 2003.
- Tin  chung ca d n.
- Bo co lch trnh cc cng vic.
- Bo co v vic s dng ti nguyn v cc cng vic.
- Bo co v lch lm vic theo tun, qu, thng.
- Cc bo co chun ca Microsoft Project
- Thit lp cu hnh trang in.
- In cc biu  ca d n.

1. Cc bo biu chun ca Microsoft Project

Trong menu View chn mc Reports

[Hnh nh: Menu View Reports]

Hp thoi Reports hin ln:

[Hnh nh: Hp thoi Reports]

 ngha ca cc bng la chn:

Mc |  ngha
--- | ---
Overview | Cc biu tng quan v d n
Current Activities | Bo co v cc cng vic
Cost | Cc bo biu v ti chnh ca d n
Assignment | Bo biu v phn b ti nguyn
Workload | Bo biu v vic thc hin cng vic v s dng ti nguyn
Custom | Bo biu c thit lp bi ngi s dng

2. In cc biu  ca d n

Biu  tin  ca d n thng c in di 2 dng chnh:
- Biu  Gantt
- S  mng Network Diagram

Trong menu File chn Print Preview

[Hnh nh: Menu File Print Preview]

Khung nhn Print Preview hin th:

[Hnh nh: Mn hnh Print Preview]

3. Thit lp cu hnh trang In

Trong menu File, chn Page Setup

[Hnh nh: Menu File Page Setup]

Hp thoi Page Setup xut hin

[Hnh nh: Hp thoi Page Setup]

Trong hp thoi Page Setup ny cho php thit lp cc tham s
Page: t cch nhn kh giy cho trang in.
Margins: Cn l trang in.
Header: Cc tiu  bn trn trang in ca d n.
Footer: Cc tiu  bn di trang in ca d n.
Legend: Cc hnh minh ha cho trang in.
View: Thit lp cc cu hnh cho trang in.

 Cu hi (bi tp) cng c:
1. Anh, ch hy chn 1 d n, sau  vit:
-  cng cho d n
- Ti liu nghin cu kh thi
- Lp k hoch cho d n
- c lng
2. Dng Microsoft Project  lp lch cho d n`}],Mrt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDgAQpq-gbHeYVJen_cMMgepsxf0TzUopI",VITE_FIREBASE_APP_ID:"1:252346768980:web:16f1f4b9d365d6e1ad57c1",VITE_FIREBASE_AUTH_DOMAIN:"quiz-cd4c1.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-8JDJSZR9X9",VITE_FIREBASE_MESSAGING_SENDER_ID:"252346768980",VITE_FIREBASE_PROJECT_ID:"quiz-cd4c1",VITE_FIREBASE_STORAGE_BUCKET:"quiz-cd4c1.firebasestorage.app",VITE_GEMINI_API_KEY_1:"AIzaSyBqU01Szjk302UkMazAMBnpFCmZtv4Z7wc",VITE_GEMINI_API_KEY_10:"AIzaSyDq9LOnDsSM20PZfwPwtltLOL0qK5xkOj8",VITE_GEMINI_API_KEY_11:"AIzaSyC9XnRcl9fCxmBP2Msy75JPKv40gEQgO2U",VITE_GEMINI_API_KEY_12:"AIzaSyBlvjVhGrLbQ3FNArKaeehs2LfKscUIr2I",VITE_GEMINI_API_KEY_13:"AIzaSyAyTWIjKM_t-KuiReCglKU5UptDJ2fp2zI",VITE_GEMINI_API_KEY_14:"AIzaSyASqKRdRJ-MZlMa_zi50C9g8w6w5Oh2qqQ",VITE_GEMINI_API_KEY_15:"AIzaSyC33wiKgi-a7HAd7FQ0me0ID2q7_UtSiHs",VITE_GEMINI_API_KEY_16:"AIzaSyBjDB_XU2324NaVn2keCnYfL4-PukfYEGI",VITE_GEMINI_API_KEY_17:"AIzaSyDIfpeydLsUN_bVcR_gTFsd0KlyceDcW04",VITE_GEMINI_API_KEY_18:"AIzaSyCO0gQn9WFNgZkYSkB-cTHdgsBTWDyuyWw",VITE_GEMINI_API_KEY_19:"AIzaSyBnd-ZDcoQ5g55CXfPj-iUt_EHNhFbQdfw",VITE_GEMINI_API_KEY_2:"AIzaSyAvyJYON4Rqv5dedNaVvuxNxeBaCQq5Qs8",VITE_GEMINI_API_KEY_20:"AIzaSyCpSeQaFx_V0qV4YzYPPMMAzCAHYoqOPeQ",VITE_GEMINI_API_KEY_21:"AIzaSyBRz_hVsdCsz4b5hV7lazkwrT9B8iVXgww",VITE_GEMINI_API_KEY_22:"AIzaSyAklKYmEcjNSDGzOJy5b2EdAgUHkOunL7o",VITE_GEMINI_API_KEY_23:"AIzaSyD_W_R_ZQbjvRyr-6ZTmismld9dHIcGPVo",VITE_GEMINI_API_KEY_24:"AIzaSyB55WMCndclBEwwtfcr_u26FWLgwgB7SAk",VITE_GEMINI_API_KEY_25:"AIzaSyAJ7ayYRFDUqgwr39O-m7VRSBcn5O3nic0",VITE_GEMINI_API_KEY_26:"AIzaSyCrW8VvnC00mfzqqks-LCpDbnrLJCGGqmM",VITE_GEMINI_API_KEY_27:"AIzaSyAhUx3NxsHZPRc9mtjCFXUeZYK2hAAVS58",VITE_GEMINI_API_KEY_28:"AIzaSyAFd4MMvolUjRIGF00uKKsof7xm18F7XkY",VITE_GEMINI_API_KEY_29:"AIzaSyAW9A5RqeaXVIp_naEHKrfOQKeGrwqJLnU",VITE_GEMINI_API_KEY_3:"AIzaSyA52UzPIoYlxmyF8fJzxSlY4DwSVJAnR8g",VITE_GEMINI_API_KEY_30:"AIzaSyAyedibmuGw5RO2LAmDD7a0SEryoF9HeKo",VITE_GEMINI_API_KEY_4:"AIzaSyCOCX9LYp9Ldh4XjCZN6lgfPj99aBTPeuk",VITE_GEMINI_API_KEY_5:"AIzaSyD0GY2HEJW8a3xpiSgRpAciPlSvpo44vuI",VITE_GEMINI_API_KEY_6:"AIzaSyAZvBZhT_VBawQOEzsrcm5KDVrPzF5fFiw",VITE_GEMINI_API_KEY_7:"AIzaSyBo_r_c-T1fE1Kpn4NScelsD8OjNEGpW1A",VITE_GEMINI_API_KEY_8:"AIzaSyCsB1_vO8f48gnAjtTVtD5Gxr-nGdJILmE",VITE_GEMINI_API_KEY_9:"AIzaSyA0d9Rv3UAABXAP50hw-85t5oibRXQhwMc"},je=[{id:"wood",name:"G",shortName:"G",tiers:7,minScore:0,difficulty:1,folder:"Wood"},{id:"stone",name:"",shortName:"",tiers:7,minScore:100,difficulty:2,folder:"Stone"},{id:"bronze",name:"ng",shortName:"ng",tiers:7,minScore:300,difficulty:3,folder:"Bronze"},{id:"silver",name:"Bc",shortName:"Bc",tiers:7,minScore:600,difficulty:4,folder:"Silver"},{id:"gold",name:"Vng",shortName:"Vng",tiers:7,minScore:1e3,difficulty:5,folder:"Gold"},{id:"platinum",name:"Bch Kim",shortName:"B.Kim",tiers:7,minScore:1500,difficulty:6,folder:"Platinum"},{id:"amethyst",name:"Thch Anh",shortName:"T.Anh",tiers:7,minScore:2200,difficulty:7,folder:"Amethyst"},{id:"onyx",name:"Hc Ngc",shortName:"H.Ngc",tiers:7,minScore:3e3,difficulty:8,folder:"Onyx"},{id:"master",name:"Huyn Thoi",shortName:"H.Thoi",tiers:0,minScore:4e3,difficulty:10,folder:"Master",isMaster:!0}];function Drt(){const e=Math.floor(Math.random()*vS.length);return vS[e]}function Lrt(e){return`Bn l AI chuyn gia v Qun Tr D n CNTT. Di y l ni dung kin thc bn cn da vo  to cu hi:

=== ${e.name} ===
${e.content}

 QUY TC QUAN TRNG:
1. CH to cu hi da trn ni dung kin thc ca chng ny
2. KHNG to cu hi v ni dung khng c trong ti liu
3. m bo p n ng phi chnh xc theo ni dung ti liu
4. Gii thch phi trch dn hoc tham chiu n ni dung trong ti liu`}const Vrt={type:le.OBJECT,properties:{questions:{type:le.ARRAY,items:{type:le.OBJECT,properties:{id:{type:le.STRING,description:"ID duy nht ca cu hi"},type:{type:le.STRING,enum:["multiple_choice","true_false","fill_blank","matching","ordering","multi_select","scenario"],description:"Loi cu hi"},question:{type:le.STRING,description:"Ni dung cu hi"},options:{type:le.ARRAY,items:{type:le.STRING},description:"Cc la chn cho cu hi multiple_choice, true_false, multi_select, scenario"},correctAnswer:{type:le.STRING,description:"p n ng (string cho single answer, JSON array string cho multi answer)"},explanation:{type:le.STRING,description:"Gii thch p n"},pairs:{type:le.ARRAY,items:{type:le.OBJECT,properties:{left:{type:le.STRING},right:{type:le.STRING}},required:["left","right"]},description:"Cc cp ghp cho cu hi matching"},items:{type:le.ARRAY,items:{type:le.STRING},description:"Cc mc cn sp xp cho cu hi ordering"},distractors:{type:le.ARRAY,items:{type:le.STRING},description:"3 t gy nhiu cho cu hi fill_blank"},scenario:{type:le.STRING,description:"M t tnh hung thc t cho cu hi scenario"}},required:["id","type","question","correctAnswer","explanation"],propertyOrdering:["id","type","question","options","correctAnswer","explanation","pairs","items","distractors","scenario"]},description:"Danh sch cu hi"}},required:["questions"],propertyOrdering:["questions"]};function ps(e){let t=je[0];for(const a of je)if(e>=a.minScore)t=a;else break;if(t.id==="master")return{rankId:t.id,tier:0,points:e,rankName:t.name};const n=je.find(a=>a.minScore>t.minScore),i=e-t.minScore,r=n?(n.minScore-t.minScore)/t.tiers:200,s=Math.min(Math.floor(i/r),t.tiers-1),o=t.tiers-s;return{rankId:t.id,tier:o,points:e,rankName:`${t.name} ${o}`}}function Pa(e){const t=je.find(i=>i.id===e.rankId);if(!t)return"/Rank/Wood/rank-wood-1_NoOL_large.png";if(e.rankId==="master")return"/Rank/master.png";const n=8-e.tier;return`/Rank/${t.folder}/rank-${e.rankId}-${n}_NoOL_large.png`}function qrt(e,t,n){var u;const r=(((u=je.find(d=>d.id===e.rankId))==null?void 0:u.difficulty)||1)+(8-e.tier)*.5;let s="",o="",a="";r<=3?(s="D - Cu hi trc tip t ti liu, d nhn bit p n",o="multiple_choice, true_false",a="Hi trc tip nh ngha, khi nim c bn. p n sai r rng khc bit vi p n ng."):r<=5?(s="TRUNG BNH D - Cu hi bm st ti liu, cn nh chi tit",o="multiple_choice, true_false, fill_blank",a="Hi v chi tit trong ti liu, cc p n sai c th gn ging p n ng."):r<=7?(s="TRUNG BNH - Cu hi cn hiu ni dung, khng ch nh",o="multiple_choice, true_false, fill_blank, matching",a="Din t li cu hi theo cch khc, hi v mi quan h gia cc khi nim trong ti liu."):r<=9?(s="KH - Cu hi i hi hiu su v lin kt kin thc",o="multiple_choice, fill_blank, matching, ordering, multi_select",a="Hi v quy trnh, th t cc bc, kt hp nhiu khi nim trong cng chng. p n sai rt gn vi p n ng."):r<=11?(s="RT KH - Cu hi phn tch, vn dng kin thc",o="multiple_choice, fill_blank, matching, ordering, multi_select, scenario",a="t cu hi trong tnh hung c th, yu cu phn tch v p dng kin thc t ti liu. Cc p n u c v hp l."):(s="HUYN THOI - Cu hi tng hp, phn tch chuyn su",o="multiple_choice, fill_blank, matching, ordering, multi_select, scenario",a="To tnh hung phc tp i hi hiu su ton b ni dung chng. Cc p n u rt gn ng, ch khc  chi tit nh.");const c=Math.floor(Math.random()*1e6),h=Date.now();return`Bn l AI to cu hi trc nghim v Qun Tr D n CNTT.

 BT BUC: TT C CU HI, P N, GII THCH PHI BNG TING VIT. KHNG DNG TING ANH HAY NGN NG KHC.

 SESSION ID: ${c}-${h}
(Dng session ID ny  to b cu hi HON TON MI, KHC vi cc ln trc)

RANK HIN TI: ${e.rankName} ( kh: ${r.toFixed(1)}/12)
MC : ${s}
SNG TO: ${a}

 TO CU HI T CHNG: ${n.name}
(Ni dung chng  c cung cp trong system prompt)

To ${t} cu hi vi cc loi C TH DNG: ${o}

 YU CU QUAN TRNG:
- BM ST NI DUNG TI LIU: Tt c cu hi v p n PHI da trn ni dung chng  cung cp
- KHNG ba thng tin khng c trong ti liu
- PHI to cu hi KHC NHAU mi ln gi, KHNG lp li cu hi c
- Mi cu hi phi c ID duy nht (dng format: q_${c}_1, q_${c}_2, ...)

 V  KH:
-  kh KHNG phi l hi ngoi ti liu, m l CCH HI phc tp hn
- Rank thp: Hi trc tip, p n sai d loi
- Rank cao: Hi gin tip, p n sai rt gn ng, cn hiu su mi phn bit c

 V LOI CU HI:
- T DO chn loi cu hi ph hp vi ni dung, KHNG cn theo th t
- C th to nhiu cu cng loi, hoc a dng cc loi - ty ni dung ph hp
- u tin loi cu hi PH HP vi kin thc trong chng

QUY TC:
- NGN NG: Ch dng ting Vit cho tt c ni dung
- multiple_choice: 4 options, correctAnswer l 1 trong cc options
- true_false: options l ["ng", "Sai"], correctAnswer l "ng" hoc "Sai"
- fill_blank: question c ch trng ___, correctAnswer l t cn in, distractors l mng 3 t gy nhiu (t lin quan nhng SAI, phi khc correctAnswer)
- matching: pairs l mng {left, right}, correctAnswer l mng ["0-0", "1-1"...] 
- ordering: items l mng cn sp xp, correctAnswer l mng ng th t
- multi_select: 5-6 options, correctAnswer l MNG cc p n ng (2-3 p n), cu hi phi ghi r "Chn TT C p n ng"
- scenario: scenario l m t tnh hung thc t (2-3 cu), question l cu hi v tnh hung , 4 options, correctAnswer l 1 p n`}function jrt(){const e=[];for(let t=1;t<=30;t++){const n=Mrt[`VITE_GEMINI_API_KEY_${t}`];n&&n.trim()&&e.push(n.trim())}return e}const yS=jrt();let hh=0;function Frt(e){return e instanceof Error?e.message.includes("429")||e.message.includes("rate limit")||e.message.includes("RESOURCE_EXHAUSTED")||e.message.includes("quota")||e.status===429:!1}async function Urt(e,t){const n=yS.length;let i=0;for(;i<n;){const r=yS[hh],s=new Prt({apiKey:r});console.log(` Using Gemini key ${hh+1}/${n}`);try{const a=(await s.models.generateContent({model:"models/gemini-flash-latest",contents:t,config:{systemInstruction:e,temperature:.9,thinkingConfig:{thinkingBudget:24576},responseMimeType:"application/json",responseSchema:Vrt}})).text||"";return JSON.parse(a).questions||[]}catch(o){if(Frt(o))console.warn(` Gemini key ${hh+1} rate limited, trying next key...`),hh=(hh+1)%n,i++;else throw o}}throw new Error("ALL_GEMINI_KEYS_RATE_LIMITED")}async function Ort(e,t=5){const n=Drt();console.log(" Chng c chn:",n.shortName);const i=Lrt(n),r=qrt(e,t,n);try{return await Urt(i,r)}catch(s){return s instanceof Error&&s.message==="ALL_GEMINI_KEYS_RATE_LIMITED"?(console.warn(" All Gemini keys rate limited, using fallback questions..."),xS(t)):(console.error("Error generating AI questions:",s),xS(t))}}function xS(e){return[{id:"fb1",type:"multiple_choice",question:"D n l g?",options:["L hot ng nghin cu mang tnh l thuyt","L cng vic lp li nhiu ln theo chu k","L hot ng c phng php, s dng ngun lc  to sn phm mi","L k hoch sn xut c p dng lu di"],correctAnswer:"L hot ng c phng php, s dng ngun lc  to sn phm mi",explanation:"D n l hot ng c phng php, s dng ngun lc  to sn phm mi."},{id:"fb2",type:"true_false",question:"Qun l d n CNTT l vic t chc cc hot ng nhm t c mc tiu trong gii hn v thi gian, kinh ph v cht lng.",options:["ng","Sai"],correctAnswer:"ng",explanation:"y l nh ngha chnh xc v qun l d n CNTT."},{id:"fb3",type:"fill_blank",question:"Giao tip hiu qu nht din ra khi giao tip ___, mt i mt gia hai bn.",correctAnswer:"trc tip",explanation:"Giao tip trc tip, mt i mt l hnh thc hiu qu nht."},{id:"fb4",type:"multiple_choice",question:"Mc tiu ca d n l g?",options:["Gii quyt vn  thc t v p ng nhu cu ngi dng","a ra m hnh khoa hc v phng php nghin cu","Xy dng chin lc ti chnh cho t chc","Pht trin h thng phn mm phc v nghin cu"],correctAnswer:"Gii quyt vn  thc t v p ng nhu cu ngi dng",explanation:"Mc tiu ca d n l gii quyt vn  thc t v p ng nhu cu ngi dng."},{id:"fb5",type:"true_false",question:"ng gng (Critical Path) l chui hot ng di nht quyt nh thi gian hon thnh d n.",options:["ng","Sai"],correctAnswer:"ng",explanation:"ng gng l chui hot ng di nht, quyt nh thi gian ti thiu  hon thnh d n."}].slice(0,e)}function Brt(e,t,n=0){const i=je.find(o=>o.id===t.rankId),r=(i==null?void 0:i.difficulty)||1,s=(8-t.tier)*.2;if(e)return Math.round(10*(1+r*.1+s)+n);{const o=Math.min(3+r*1.5,15);return-Math.round(o)}}function Grt(e){const t=je.find(n=>n.id===e.rankId);return(t==null?void 0:t.minScore)||0}const Hrt={stone:{gems:50,title:"t rank "},bronze:{gems:100,title:"t rank ng"},silver:{gems:200,title:"t rank Bc"},gold:{gems:400,title:"t rank Vng"},platinum:{gems:600,title:"t rank Bch Kim"},amethyst:{gems:1e3,title:"t rank Thch Anh"},onyx:{gems:1500,title:"t rank Hc Ngc"},master:{gems:3e3,title:"t rank Huyn Thoi"}};function $rt(e,t){switch(e.type){case"multiple_choice":case"true_false":case"fill_blank":case"scenario":{const n=String(e.correctAnswer).toLowerCase().trim(),i=String(t).toLowerCase().trim();return n===i||n.includes(i)||i.includes(n)}case"matching":return!Array.isArray(t)||!Array.isArray(e.correctAnswer)?!1:JSON.stringify([...t].sort())===JSON.stringify([...e.correctAnswer].sort());case"ordering":return!Array.isArray(t)||!Array.isArray(e.correctAnswer)?!1:JSON.stringify(t)===JSON.stringify(e.correctAnswer);case"multi_select":{if(!Array.isArray(t)||!Array.isArray(e.correctAnswer))return!1;const n=[...t].sort(),i=[...e.correctAnswer].sort();return JSON.stringify(n)===JSON.stringify(i)}default:return!1}}const zrt=3e4,xp="https://workers.vrp.moe";async function _p(e,t={},n=zrt){const i=new AbortController,r=setTimeout(()=>i.abort(),n);try{const s=await fetch(e,{...t,signal:i.signal});return clearTimeout(r),s}catch(s){throw clearTimeout(r),s}}function gr(e){switch(e){case 40:return"UR";case 30:return"SR";case 20:return"R";case 10:return"N";default:return"Unknown"}}function pt(e){switch(e){case 40:return"#FFD700";case 30:return"#9B59B6";case 20:return"#3498DB";case 10:return"#95A5A6";default:return"#7F8C8D"}}function To(e,t=400){return e?e.includes("hdslb.com")?`${e}@${t}w_${t}h_1c.webp`:e:""}function ke(e,t=600){return e?e.includes("hdslb.com")?`${e}@${t}w.webp`:e:""}function Ma(e){return!!(e&&e.length>1&&e[1])}const Krt=5*60*1e3,m0=new Map;function wp(e){const t=m0.get(e);return t&&t.expiry>Date.now()?t.data:(m0.delete(e),null)}function bp(e,t,n=Krt){m0.set(e,{data:t,expiry:Date.now()+n})}const _S=new Set;function fq(e){e.forEach(t=>{if(!t||_S.has(t))return;const n=new Image;n.referrerPolicy="no-referrer",n.src=t,_S.add(t)})}function wS(e){if(!(e!=null&&e.item_list))return;const t=e.item_list.map(n=>ke(n.card_img,400));fq(t)}function bS(e){const t=e.map(n=>ke(n.act_square_img,400));fq(t)}async function mq(){const e="collections",t=wp(e);if(t)return bS(t),t;try{console.log("[Gacha] Fetching collections directly from API...");const n=await _p(`${xp}/laplace/collections`);if(!n.ok)throw new Error(`API error: ${n.status}`);const i=await n.json();return i.sort((r,s)=>s.startTime-r.startTime),bp(e,i),bS(i),console.log("[Gacha] Got",i.length,"collections"),i}catch(n){throw console.error("[getGachaCollections] Error:",n),n}}async function pq(e){const t=`collection-${e}`,n=wp(t);if(n)return n;try{const i=await _p(`${xp}/bilibili/collection/${e}`);if(!i.ok)throw new Error(`API error: ${i.status}`);const s=(await i.json()).data;return s&&bp(t,s),s||null}catch(i){throw console.error("[getGachaCollectionDetail] Error:",i),i}}async function ku(e){var i;const t=await pq(e);if(!((i=t==null?void 0:t.lottery_list)!=null&&i.length))return[];const n=[];for(const r of t.lottery_list){const s=await Wrt(e,r.lottery_id);s&&n.push(s)}return n}async function Wrt(e,t){var r,s;const n=`lottery-${e}-${t}`,i=wp(n);if(i)return wS(i),i;try{const o=await _p(`${xp}/bilibili/collection-info/${e}/${t}`);if(!o.ok)throw new Error(`API error: ${o.status}`);const c=(await o.json()).data;if(!c)return null;const h={lottery_id:t,lottery_name:c.lottery_name||"",price:c.price||0,lottery_image:c.lottery_image||"",item_list:(c.item_list||[]).map(u=>{var d,f,v,y,w,_,x,C,k,P;return{item_type:u.item_type,card_info:u.card_info,card_name:((d=u.card_info)==null?void 0:d.card_name)||"",card_img:((f=u.card_info)==null?void 0:f.card_img)||"",card_scarcity:((v=u.card_info)==null?void 0:v.card_scarcity)||0,card_type:(y=u.card_info)==null?void 0:y.card_type,card_id:(w=u.card_info)==null?void 0:w.card_id,width:((_=u.card_info)==null?void 0:_.width)||0,height:((x=u.card_info)==null?void 0:x.height)||0,video_list:((C=u.card_info)==null?void 0:C.video_list)||[],card_img_download:((k=u.card_info)==null?void 0:k.card_img_download)||"",is_physical_orientation:(P=u.card_info)==null?void 0:P.is_physical_orientation}}),collect_list:c.collect_list||{},collect_infos:((r=c.collect_list)==null?void 0:r.collect_infos)||[],collect_chain:((s=c.collect_list)==null?void 0:s.collect_chain)||[]};return bp(n,h,30*60*1e3),wS(h),h}catch(o){throw console.error("[getLotteryDetail] Error:",o),o}}async function Qrt(e,t,n){var s,o,a;const i=`video-${e}-${t}-${n}`,r=wp(i);if(r)return r;try{const c=await _p(`${xp}/bilibili/collection-info/${e}/${t}`);if(!c.ok)throw new Error(`API error: ${c.status}`);const d=(((s=(await c.json()).data)==null?void 0:s.item_list)||[]).find(v=>{var y;return((y=v.card_info)==null?void 0:y.card_img)===n});if(!((a=(o=d==null?void 0:d.card_info)==null?void 0:o.video_list)!=null&&a.length))return null;const f=d.card_info.video_list[1]||d.card_info.video_list[0];return bp(i,f,25*60*1e3),f}catch(c){return console.error("[getFreshVideoUrl] Error:",c),null}}const yb={conquest:{name:"Chinh Chin",rewards:[{rank:1,gems:1500,title:"Top 1 Chinh Chin",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 Chinh Chin",icon:"medal"},{rank:3,gems:750,title:"Top 3 Chinh Chin",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 Chinh Chin",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 Chinh Chin",icon:"star"}]},score:{name:"im Tng",rewards:[{rank:1,gems:1500,title:"Top 1 im Tng",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 im Tng",icon:"medal"},{rank:3,gems:750,title:"Top 3 im Tng",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 im Tng",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 im Tng",icon:"star"}]},urCards:{name:"Th UR",rewards:[{rank:1,gems:1500,title:"Top 1 Th UR",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 Th UR",icon:"medal"},{rank:3,gems:750,title:"Top 3 Th UR",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 Th UR",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 Th UR",icon:"star"}]}},Yrt=(e,t)=>{const n=yb[e].rewards;for(const i of n){if(typeof i.rank=="number"&&i.rank===t)return i;if(Array.isArray(i.rank)){const[r,s]=i.rank;if(t>=r&&t<=s)return i}}return null},Xrt=async e=>{const t=new Date().toDateString(),n=Mt(kt,"leaderboardRewardLogs",`${e}_${t}`);if((await Qr(n)).exists())return{sent:!1,reason:"already_sent"};const r=[{key:"conquest",orderField:"conquestStats.rankPoints"},{key:"score",orderField:"totalScore"},{key:"urCards",orderField:"gachaInventory.gachaStats.totalURCards"}],s=[];for(const{key:o,orderField:a}of r)try{const c=rl(Wr(kt,"users"),bw(a,"desc"),Tw(20)),d=(await ka(c)).docs.map(f=>f.data()).findIndex(f=>f.oderId===e)+1;if(d>0&&d<=20){const f=Yrt(o,d);f&&s.push({category:yb[o].name,rank:d,gems:f.gems,title:f.title})}}catch(c){console.error(`Error checking ${o} leaderboard:`,c)}if(s.length===0)return{sent:!1,reason:"no_rewards"};for(const o of s)await tp(Wr(kt,"mails"),{title:o.title,content:`Chc mng bn  t hng ${o.rank} trong BXH ${o.category}! y l phn thng xng ng cho n lc ca bn.`,reward:o.gems,active:!0,createdAt:new Date().toISOString(),targetUserId:e,type:"leaderboard_reward"});return await Cw(n,{userId:e,date:t,rewards:s,sentAt:new Date().toISOString()}),{sent:!0,rewards:s}};function Jrt(){const e=we(),{user:t}=Zt(),[n,i]=I.useState("conquest"),[r,s]=I.useState([]),[o,a]=I.useState(!0),[c,h]=I.useState(!1);I.useEffect(()=>{t!=null&&t.oderId&&Xrt(t.oderId).catch(console.error)},[t==null?void 0:t.oderId]),I.useEffect(()=>{(async()=>{a(!0);try{let w="exp";n==="conquest"?w="conquestStats.rankPoints":n==="urCards"&&(w="gachaInventory.gachaStats.totalURCards");const _=rl(Wr(kt,"users"),bw(w,"desc"),Tw(100));let C=(await ka(_)).docs.map(k=>k.data());n==="score"?C=C.map(k=>({...k,_calculatedScore:ff(k,0).totalScore})).sort((k,P)=>P._calculatedScore-k._calculatedScore).slice(0,50):C=C.slice(0,50),s(C)}catch(w){console.error("Error fetching leaderboard:",w),s([])}finally{a(!1)}})()},[n]);const u=y=>y===1?{bg:"bg-[var(--duo-yellow)]",icon:hf}:y===2?{bg:"bg-gray-400",icon:Rc}:y===3?{bg:"bg-amber-600",icon:Rc}:{bg:"bg-[var(--secondary)]",icon:null},d=()=>{switch(n){case"conquest":return"from-[var(--duo-purple)] to-[var(--duo-blue)]";case"score":return"from-[var(--duo-yellow)] to-[var(--duo-orange)]";case"urCards":return"from-[var(--duo-orange)] to-[var(--duo-yellow)]"}},f=y=>{e(`/profile/${y}`)},v=(y,w)=>{var N;const _=w+1,x=(t==null?void 0:t.oderId)===y.oderId,C=u(_),k=C.icon,P=()=>{var T,E,R;switch(n){case"conquest":return((T=y.conquestStats)==null?void 0:T.rankPoints)??0;case"score":return ff(y,0).totalScore;case"urCards":return((R=(E=y.gachaInventory)==null?void 0:E.gachaStats)==null?void 0:R.totalURCards)??0}},A=()=>{const T=P();switch(n){case"conquest":const E=ps(T);return l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:Pa(E),alt:E.rankName,className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-bold text-[var(--duo-purple)]",children:Mn(T)})]});case"score":return l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-yellow)]",children:[l.jsx(Le,{className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-lg",children:Mn(T)})]});case"urCards":return l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-orange)]",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-lg",children:T})]})}},M=()=>{var T;switch(n){case"conquest":return ps(((T=y.conquestStats)==null?void 0:T.rankPoints)??0).rankName;case"score":return"im";case"urCards":return"Th UR"}};return l.jsx("button",{onClick:()=>f(y.oderId),className:`card-3d p-3 w-full text-left ${x?"border-[var(--duo-green)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl ${C.bg} flex items-center justify-center`,children:k?l.jsx(k,{className:"w-5 h-5 text-white"}):l.jsx("span",{className:"font-bold text-[var(--muted-foreground)]",children:_})}),l.jsxs("div",{className:"relative w-[60px] h-[60px] flex items-center justify-center shrink-0",children:[y.equippedFrame&&l.jsx("img",{src:ke(y.equippedFrame,80),alt:"Frame",className:"absolute inset-0 w-[60px] h-[60px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-xs overflow-hidden",children:y.equippedAvatar||y.avatar?l.jsx("img",{src:y.equippedAvatar?ke(y.equippedAvatar,80):y.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((N=y.odername)==null?void 0:N.charAt(0).toUpperCase())||"?"})]}),y.equippedBadge&&l.jsx("div",{className:"w-8 h-8 shrink-0",children:l.jsx("img",{src:ke(y.equippedBadge,60),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("p",{className:"font-bold text-foreground truncate",children:[y.odername||"Ngi chi",x&&l.jsx("span",{className:"text-[var(--duo-green)] ml-1",children:"(Bn)"})]}),l.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[l.jsxs("span",{className:"flex items-center gap-1 text-[var(--duo-orange)]",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-4 h-4"}),y.streak??0]}),l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Lv.",y.level??1]})]})]}),l.jsxs("div",{className:"text-right",children:[A(),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:M()})]})]})},y.oderId)};return l.jsxs(re,{className:"bg-background min-h-screen",children:[c&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:()=>h(!1),children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:y=>y.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)] flex items-center justify-center",children:l.jsx(Ue,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"font-bold text-lg text-[var(--duo-orange)]",children:"Phn thng BXH"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhn thng mi ngy theo th hng"})]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsx("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)] text-center",children:["Phn thng c gi vo"," ",l.jsx("span",{className:"text-[var(--duo-orange)] font-bold",children:"Hm th"})," ","mi ngy da trn th hng ca bn."]})})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:l.jsx("div",{className:"space-y-4",children:Object.entries(yb).map(([y,w])=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h3",{className:"font-bold text-foreground flex items-center gap-2 text-sm",children:[y==="conquest"&&l.jsx(wi,{className:"w-4 h-4 text-[var(--duo-purple)]"}),y==="score"&&l.jsx(Le,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),y==="urCards"&&l.jsx(Xt,{className:"w-4 h-4 text-[var(--duo-orange)]"}),w.name]}),l.jsx("div",{className:"space-y-1.5",children:w.rewards.map((_,x)=>{const C=()=>_.icon==="crown"?l.jsx(hf,{className:"w-4 h-4 text-[var(--duo-yellow)]"}):_.icon==="medal"?l.jsx(Rc,{className:"w-4 h-4 text-gray-400"}):_.icon==="trophy"?l.jsx(Le,{className:"w-4 h-4 text-amber-600"}):l.jsx(Xt,{className:"w-4 h-4 text-[var(--duo-blue)]"});return l.jsxs("div",{className:"flex items-center justify-between bg-[var(--secondary)] rounded-xl px-3 py-2.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[C(),l.jsx("span",{className:"text-sm text-foreground font-medium",children:typeof _.rank=="number"?`Top ${_.rank}`:`Top ${_.rank[0]}-${_.rank[1]}`})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold text-[var(--duo-blue)]",children:["+",_.gems]})]})]},x)})})]},y))})}),l.jsx("div",{className:"px-5 pb-6",children:l.jsx("button",{onClick:()=>h(!1),className:"btn-3d btn-3d-orange w-full py-3",children:" hiu!"})})]})}),l.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r ${d()}`,children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Le,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Bng xp hng"})]})}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("p",{className:"text-white/80 text-sm flex items-center gap-1",children:["Top ngi chi  Nhn ",l.jsx(ux,{className:"w-3 h-3 inline"})," xem phn thng"]}),l.jsx("button",{onClick:()=>h(!0),className:"w-9 h-9 rounded-full bg-white/20 flex items-center justify-center",children:l.jsx(ux,{className:"w-5 h-5 text-white"})})]})]}),l.jsx("div",{className:"fixed top-[124px] left-0 right-0 z-40 px-4 py-3 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>i("conquest"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="conquest"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(wi,{className:"w-4 h-4"}),"Chinh Chin"]}),l.jsxs("button",{onClick:()=>i("score"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="score"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Le,{className:"w-4 h-4"}),"im Tng"]}),l.jsxs("button",{onClick:()=>i("urCards"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="urCards"?"bg-[var(--duo-orange)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Xt,{className:"w-4 h-4"}),"Th UR"]})]})}),l.jsx("div",{className:"px-4 pt-[188px] pb-28",children:o?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-[var(--duo-green)] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"ang ti..."})]}):r.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Le,{className:"w-16 h-16 text-[var(--muted-foreground)] mx-auto mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Cha c d liu"})]}):l.jsx("div",{className:"space-y-3",children:r.map((y,w)=>v(y,w))})})]})}function Zrt(e,t){let n;try{n=e()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),a=(s=n.getItem(r))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,s)=>n.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>n.removeItem(r)}}const p0=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(i){return p0(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return p0(i)(n)}}}},tst=(e,t)=>(n,i,r)=>{let s={storage:Zrt(()=>localStorage),partialize:_=>_,version:0,merge:(_,x)=>({...x,..._}),...t},o=!1,a=0;const c=new Set,h=new Set;let u=s.storage;if(!u)return e((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(..._)},i,r);const d=()=>{const _=s.partialize({...i()});return u.setItem(s.name,{state:_,version:s.version})},f=r.setState;r.setState=(_,x)=>(f(_,x),d());const v=e((..._)=>(n(..._),d()),i,r);r.getInitialState=()=>v;let y;const w=()=>{var _,x;if(!u)return;const C=++a;o=!1,c.forEach(P=>{var A;return P((A=i())!=null?A:v)});const k=((x=s.onRehydrateStorage)==null?void 0:x.call(s,(_=i())!=null?_:v))||void 0;return p0(u.getItem.bind(u))(s.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate){const A=s.migrate(P.state,P.version);return A instanceof Promise?A.then(M=>[!0,M]):[!0,A]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var A;if(C!==a)return;const[M,N]=P;if(y=s.merge(N,(A=i())!=null?A:v),n(y,!0),M)return d()}).then(()=>{C===a&&(k==null||k(y,void 0),y=i(),o=!0,h.forEach(P=>P(y)))}).catch(P=>{C===a&&(k==null||k(void 0,P))})};return r.persist={setOptions:_=>{s={...s,..._},_.storage&&(u=_.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:_=>(c.add(_),()=>{c.delete(_)}),onFinishHydration:_=>(h.add(_),()=>{h.delete(_)})},s.skipHydration||w(),y||v},vq=tst;function est(){const e=new Date,t=e.getDay(),n=t===0?1:8-t,i=new Date(e);return i.setDate(e.getDate()+n),i.setHours(0,0,0,0),i.getTime()}function nst(e){if(!e)return!1;const t=new Date,n=new Date(e),i=new Date(t),r=t.getDay(),s=r===0?6:r-1;return i.setDate(t.getDate()-s),i.setHours(0,0,0,0),n.getTime()<i.getTime()}function Bh(e){return e*25}const xb=Bu()(vq((e,t)=>({currentFloor:1,highestFloor:0,claimedFloors:[],totalGemsEarned:0,lastResetTime:null,allQuestions:[],totalFloors:0,normalFloorsCount:0,exFloorsCount:0,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null,initTower:()=>{const{lastResetTime:n}=t(),i=fx,r=i.questions.filter(c=>!c.isEx),s=i.questions.filter(c=>c.isEx),o=r.length,a=s.length;nst(n)?e({currentFloor:1,highestFloor:0,claimedFloors:[],lastResetTime:Date.now(),allQuestions:i.questions,totalFloors:i.questions.length,normalFloorsCount:o,exFloorsCount:a}):e(n?{allQuestions:i.questions,totalFloors:i.questions.length,normalFloorsCount:o,exFloorsCount:a}:{lastResetTime:Date.now(),allQuestions:i.questions,totalFloors:i.questions.length,normalFloorsCount:o,exFloorsCount:a})},startFloor:n=>{const{allQuestions:i,currentFloor:r}=t();if(n>r||n<1)return;const s=i[n-1];s&&e({activeFloor:n,currentQuestion:s,selectedAnswer:null,isAnswered:!1,isCorrect:null})},selectAnswer:n=>{const{isAnswered:i,currentQuestion:r}=t();if(i||!r)return;const s=n===r.correctAnswer;e({selectedAnswer:n,isAnswered:!0,isCorrect:s})},completeFloor:()=>{const{activeFloor:n,highestFloor:i,totalFloors:r}=t();if(!n)return{gems:0,isNewRecord:!1};const s=n>i,o=Math.min(n+1,r);return e({currentFloor:o,highestFloor:s?n:i}),{gems:Bh(n),isNewRecord:s}},failFloor:()=>{e({currentFloor:1,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},claimReward:n=>{const{claimedFloors:i,totalGemsEarned:r,highestFloor:s}=t();if(n>s||i.includes(n))return 0;const o=Bh(n);return e({claimedFloors:[...i,n],totalGemsEarned:r+o}),o},exitQuiz:()=>{e({activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},resetTower:()=>{const n=fx;e({currentFloor:1,highestFloor:0,claimedFloors:[],totalGemsEarned:0,lastResetTime:Date.now(),allQuestions:n.questions,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},getNextResetTime:()=>est()}),{name:"tower-storage",partialize:e=>({currentFloor:e.currentFloor,highestFloor:e.highestFloor,claimedFloors:e.claimedFloors,totalGemsEarned:e.totalGemsEarned,lastResetTime:e.lastResetTime})})),ist={Target:Vi,Flame:zr,Zap:Lr,Crown:hf,BookOpen:Yc,Trophy:Le,GraduationCap:DP,Gem:MP,Star:ge,Sparkles:Xt,Medal:Rc,Coins:PP,Swords:wi,Shield:VP,Award:pr,Package:Ts,Image:Nm,Building:Fu,Brain:IP},$v={first_quiz:30,streak_3:50,streak_7:100,streak_30:300,correct_50:75,correct_100:150,correct_500:400,correct_1000:800,perfect_5:100,perfect_20:250,perfect_50:600,level_5:75,level_10:150,level_20:300,gems_100:50,gems_500:150,gems_1000:300,conquest_first:60,conquest_10:150,conquest_50:400,conquest_wins_5:120,conquest_wins_10:300,rank_100:100,rank_500:200,rank_1000:400,rank_2000:800,gacha_first:60,gacha_pulls_50:150,gacha_pulls_100:300,gacha_pulls_500:800,gacha_ur_1:100,gacha_ur_5:250,gacha_ur_10:450,gacha_ur_25:1e3,gacha_sr_10:120,gacha_sr_50:350,gacha_cards_25:150,gacha_cards_100:400,gacha_cards_250:1e3,gacha_collection_1:300,gacha_collection_3:700,gacha_collection_5:1500,tower_floor_10:100,tower_floor_50:300,tower_floor_100:700,tower_floor_200:1500,tower_complete:3e3,quizzes_10:60,quizzes_50:180,quizzes_100:400,quizzes_500:1e3,correct_2000:1500,correct_5000:3e3,correct_10000:6e3,streak_60:600,streak_100:1500,streak_365:1e4,level_30:500,level_50:1e3,level_100:3e3,conquest_100:800,conquest_500:3e3,rank_3000:1200,rank_4000:2e3,rank_5000:4e3,gacha_pulls_1000:2e3,gacha_ur_50:2e3,gacha_ur_100:5e3,gacha_cards_500:3e3,quizzes_1000:2e3,quizzes_5000:8e3,perfect_100:1500,perfect_500:5e3,gems_5000:1e3,gems_10000:3e3};function rst(){const e=we(),{user:t,addGems:n,claimAchievementReward:i}=Zt(),{highestFloor:r,totalFloors:s,initTower:o}=xb(),[a,c]=I.useState(!1),[h,u]=I.useState(null);I.useEffect(()=>{o()},[]);const d=(t==null?void 0:t.claimedAchievementRewards)||[],f=M=>{if(!t)return 0;const N=v(M);return Math.min(N/M.requirement*100,100)},v=M=>{var E,R,D,F,L;if(!t)return 0;const N=(E=t.gachaInventory)==null?void 0:E.gachaStats,T=((N==null?void 0:N.totalURCards)??0)+((N==null?void 0:N.totalSRCards)??0)+((N==null?void 0:N.totalRCards)??0)+((N==null?void 0:N.totalNCards)??0);switch(M.type){case"streak":return t.streak;case"correct":return t.totalCorrect;case"perfect":return t.perfectLessons??0;case"level":return t.level??1;case"gems":return t.gems??0;case"conquest":return((R=t.conquestStats)==null?void 0:R.totalConquests)??0;case"conquest_wins":return((D=t.conquestStats)==null?void 0:D.bestWinStreak)??0;case"rank_points":return((F=t.conquestStats)==null?void 0:F.rankPoints)??0;case"gacha_pulls":return((L=t.gachaInventory)==null?void 0:L.totalPulls)??0;case"gacha_ur":return(N==null?void 0:N.totalURCards)??0;case"gacha_sr":return(N==null?void 0:N.totalSRCards)??0;case"gacha_total_cards":return T;case"gacha_collections":return(N==null?void 0:N.completedCollections)??0;case"tower_floor":return r;case"tower_complete":return r>=s&&s>0?1:0;case"quizzes":return t.totalQuizzes??0;default:return 0}},y=M=>v(M)>=M.requirement,w=M=>{const N=cr.find(R=>R.id===M);if(!N)return!1;const T=y(N),E=d.includes(M);return T&&!E},_=async M=>{const N=$v[M.id]||10;await i(M.id),await n(N),u({achievement:M,gems:N}),c(!0),Ee({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})},x=cr.filter(M=>y(M)).length,C=cr.filter(M=>w(M.id)).length,[k,P]=I.useState(!1),A=async()=>{if(k)return;const M=cr.filter(N=>w(N.id));if(M.length!==0){P(!0);try{const N=M.reduce((T,E)=>T+($v[E.id]||10),0);for(const T of M)await i(T.id);await n(N),u({achievement:{name:`${M.length} thnh tu`},gems:N}),c(!0),Ee({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(N){console.error("Error claiming all achievements:",N)}finally{P(!1)}}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a&&!!h,onClose:()=>c(!1),title:"Nhn qu thnh cng!",subtitle:`Thnh tu: ${h==null?void 0:h.achievement.name}`,rewards:h?[{type:"gems",amount:h.gems}]:[],gradientFrom:"var(--duo-yellow)",gradientTo:"var(--duo-orange)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-3 pb-3 px-3 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Xi,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(pr,{className:"w-5 h-5 text-white shrink-0"}),l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Thnh tu"})]}),l.jsxs("p",{className:"text-white/80 text-xs truncate",children:[x,"/",cr.length,"  t"]})]}),C>0&&l.jsxs("button",{onClick:A,disabled:k,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Ue,{className:"w-3.5 h-3.5"}),"Nhn (",C,")"]})]})}),l.jsx("div",{className:"px-4 pt-28 pb-28 space-y-3",children:cr.map(M=>{const N=y(M),T=d.includes(M.id),E=N&&!T,R=f(M),D=v(M),F=ist[M.icon],L=$v[M.id]||10;return l.jsx("div",{className:`card-3d p-4 ${E?"border-[var(--duo-green)] border-2":N?"border-[var(--duo-yellow)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center ${N?"bg-[var(--duo-yellow)]/20":"bg-[var(--secondary)]"}`,children:N?l.jsx(F,{className:"w-7 h-7 text-[var(--duo-yellow)]"}):l.jsx(Ou,{className:"w-6 h-6 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:`font-bold ${N?"text-[var(--duo-yellow)]":"text-foreground"}`,children:M.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mb-1",children:M.description}),l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx(Ue,{className:"w-3 h-3 text-[var(--duo-blue)]"}),l.jsxs("span",{className:"text-[var(--duo-blue)] font-semibold",children:[L," Gems"]})]}),!N&&l.jsxs("div",{className:"mt-2",children:[l.jsx("div",{className:"progress-duo h-2",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:[D,"/",M.requirement]})]})]}),E?l.jsx("button",{onClick:()=>_(M),className:"btn-3d btn-3d-green px-4 py-2.5 text-sm min-w-[70px]",children:"Nhn"}):N&&T?l.jsx(ai,{className:"w-6 h-6 text-[var(--duo-green)]"}):null]})},M.id)})})]})}const zv=[{id:"daily_xp_50",name:"Mc tiu XP",description:"Kim 50 XP hm nay",icon:Vi,type:"daily",requirement:50,reward:30,getValue:e=>(e==null?void 0:e.dailyProgress)??0},{id:"daily_correct_10",name:"Tr li ng",description:"Tr li ng 10 cu",icon:ai,type:"daily",requirement:10,reward:40,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyCorrect)??0}},{id:"daily_quiz_3",name:"Hon thnh quiz",description:"Hon thnh 3 bi quiz",icon:Yc,type:"daily",requirement:3,reward:50,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyQuizzes)??0}},{id:"daily_conquest_1",name:"Chinh chin",description:"Hon thnh 1 trn chinh chin",icon:wi,type:"daily",requirement:1,reward:60,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyConquests)??0}},{id:"daily_gacha_1",name:"Quay gacha",description:"Quay gacha 1 ln",icon:Xt,type:"daily",requirement:1,reward:40,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyGachaPulls)??0}},{id:"daily_tower_3",name:"Leo thp",description:"Vt qua 3 tng thp luyn ngc",icon:Fu,type:"daily",requirement:3,reward:50,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyTowerFloors)??0}},{id:"daily_avatar_1",name:"i avatar",description:"Thay i avatar 1 ln",icon:fl,type:"daily",requirement:1,reward:25,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyAvatarChanged)??0}},{id:"daily_card_view_3",name:"Xem th",description:"Xem chi tit 3 th bt k",icon:Nm,type:"daily",requirement:3,reward:25,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyCardViewed)??0}}],Kv=[{id:"weekly_streak_7",name:"Streak tun",description:"Duy tr streak 7 ngy",icon:zr,type:"weekly",requirement:7,reward:150,getValue:e=>(e==null?void 0:e.streak)??0},{id:"weekly_xp_500",name:"XP tun",description:"Kim 500 XP trong tun",icon:Lr,type:"weekly",requirement:500,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyXP)??0}},{id:"weekly_perfect_3",name:"Hon ho",description:"3 bi quiz 100% trong tun",icon:ge,type:"weekly",requirement:3,reward:250,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyPerfect)??0}},{id:"weekly_conquest_5",name:"Chin binh tun",description:"Hon thnh 5 trn chinh chin",icon:wi,type:"weekly",requirement:5,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyConquests)??0}},{id:"weekly_conquest_wins_3",name:"Chui chin thng",description:"Thng 3 trn chinh chin",icon:pr,type:"weekly",requirement:3,reward:300,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyConquestWins)??0}},{id:"weekly_gacha_10",name:"Nh su tp",description:"Quay gacha 10 ln trong tun",icon:Xt,type:"weekly",requirement:10,reward:250,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyGachaPulls)??0}},{id:"weekly_tower_20",name:"Chinh phc thp",description:"Vt qua 20 tng thp trong tun",icon:Fu,type:"weekly",requirement:20,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyTowerFloors)??0}},{id:"weekly_card_view_15",name:"Khm ph th",description:"Xem chi tit 15 th trong tun",icon:Nm,type:"weekly",requirement:15,reward:150,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyCardViewed)??0}}];function sst(){var k,P;const e=we(),{user:t,addGems:n,claimDailyQuest:i,claimWeeklyQuest:r}=Zt(),[s,o]=I.useState(!1),[a,c]=I.useState(null),h=[...((k=t==null?void 0:t.questProgress)==null?void 0:k.claimedDailyQuests)||[],...((P=t==null?void 0:t.questProgress)==null?void 0:P.claimedWeeklyQuests)||[]],u=A=>{const N=A.getValue(t)>=A.requirement,T=h.includes(A.id);return N&&!T},d=A=>{const M=A.getValue(t);return Math.min(M/A.requirement*100,100)},f=async A=>{await n(A.reward),A.type==="daily"?await i(A.id):await r(A.id),c({quest:A,gems:A.reward}),o(!0),Ee({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]})},v=zv.filter(A=>u(A)).length,y=Kv.filter(A=>u(A)).length,w=v+y,[_,x]=I.useState(!1),C=async()=>{if(_)return;const A=zv.filter(T=>u(T)),M=Kv.filter(T=>u(T)),N=[...A,...M];if(N.length!==0){x(!0);try{const T=N.reduce((E,R)=>E+R.reward,0);for(const E of A)await i(E.id);for(const E of M)await r(E.id);await n(T),c({quest:{name:`${N.length} nhim v`},gems:T}),o(!0),Ee({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(T){console.error("Error claiming all quests:",T)}finally{x(!1)}}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:s&&!!a,onClose:()=>o(!1),title:"Nhim v hon thnh!",subtitle:a==null?void 0:a.quest.name,rewards:a?[{type:"gems",amount:a.gems}]:[],gradientFrom:"var(--duo-green)",gradientTo:"var(--duo-blue)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-3 pb-3 px-3 bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Xi,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(Le,{className:"w-5 h-5 text-white shrink-0"}),l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Nhim v"})]}),l.jsx("p",{className:"text-white/80 text-xs truncate",children:"Hon thnh  nhn gems"})]}),w>0&&l.jsxs("button",{onClick:C,disabled:_,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Ue,{className:"w-3.5 h-3.5"}),"Nhn (",w,")"]})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-28 space-y-5",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(uu,{className:"w-5 h-5 text-[var(--duo-orange)]"}),l.jsx("h2",{className:"font-bold text-foreground",children:"Nhim v ngy"}),v>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:v})]}),l.jsx("div",{className:"space-y-2.5",children:zv.map(A=>{const M=A.icon,N=d(A),T=A.getValue(t),E=T>=A.requirement,R=h.includes(A.id),D=E&&!R;return l.jsx("div",{className:`card-3d p-3 ${D?"border-[var(--duo-green)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${E?"bg-[var(--duo-green)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(M,{className:`w-5 h-5 ${E?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground",children:A.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:A.description}),!E&&l.jsxs("div",{className:"mt-1.5",children:[l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${N}%`}})}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-0.5",children:[T,"/",A.requirement]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-sm",children:A.reward})]}),D?l.jsx("button",{onClick:()=>f(A),className:"btn-3d btn-3d-green px-4 py-2 text-sm min-w-[56px]",children:"Nhn"}):R?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):null]})]})},A.id)})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(vO,{className:"w-5 h-5 text-[var(--duo-purple)]"}),l.jsx("h2",{className:"font-bold text-foreground",children:"Nhim v tun"}),y>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:y})]}),l.jsx("div",{className:"space-y-2.5",children:Kv.map(A=>{const M=A.icon,N=d(A),T=A.getValue(t),E=T>=A.requirement,R=h.includes(A.id),D=E&&!R;return l.jsx("div",{className:`card-3d p-3 ${D?"border-[var(--duo-purple)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${E?"bg-[var(--duo-purple)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(M,{className:`w-5 h-5 ${E?"text-[var(--duo-purple)]":"text-[var(--muted-foreground)]"}`})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground",children:A.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:A.description}),!E&&l.jsxs("div",{className:"mt-1.5",children:[l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${N}%`}})}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-0.5",children:[T,"/",A.requirement]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-sm",children:A.reward})]}),D?l.jsx("button",{onClick:()=>f(A),className:"btn-3d btn-3d-purple px-4 py-2 text-sm min-w-[56px]",children:"Nhn"}):R?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):null]})]})},A.id)})})]})]})]})}const yq=Bu()(vq((e,t)=>({theme:"dark",toggleTheme:()=>{const n=t().theme==="dark"?"light":"dark";e({theme:n}),Wv(n)},setTheme:n=>{e({theme:n}),Wv(n)}}),{name:"quiz-theme",onRehydrateStorage:()=>e=>{e&&Wv(e.theme)}}));function Wv(e){const t=document.documentElement;e==="light"?(t.classList.add("light"),t.classList.remove("dark")):(t.classList.add("dark"),t.classList.remove("light"))}function ost(){var Q,Z;const e=we(),{theme:t,toggleTheme:n}=yq(),{user:i,addGems:r,useRedeemCode:s,updateUsername:o}=Zt(),[a,c]=I.useState(!1),[h,u]=I.useState(""),[d,f]=I.useState("idle"),[v,y]=I.useState(0),[w,_]=I.useState(!1),[x,C]=I.useState(0),[k,P]=I.useState(!1),[A,M]=I.useState(""),[N,T]=I.useState("idle"),[E,R]=I.useState(!1),D=(i==null?void 0:i.claimedAchievementRewards)??[],F=[{id:"daily_xp_50",requirement:50,getValue:O=>(O==null?void 0:O.dailyProgress)??0},{id:"daily_correct_10",requirement:10,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyCorrect)??0}},{id:"daily_quiz_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyQuizzes)??0}},{id:"daily_conquest_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyConquests)??0}},{id:"daily_gacha_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyGachaPulls)??0}},{id:"daily_tower_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyTowerFloors)??0}},{id:"daily_avatar_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyAvatarChanged)??0}},{id:"daily_card_view_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyCardViewed)??0}}],L=[{id:"weekly_streak_7",requirement:7,getValue:O=>(O==null?void 0:O.streak)??0},{id:"weekly_xp_500",requirement:500,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyXP)??0}},{id:"weekly_perfect_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyPerfect)??0}},{id:"weekly_conquest_5",requirement:5,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyConquests)??0}},{id:"weekly_conquest_wins_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyConquestWins)??0}},{id:"weekly_gacha_10",requirement:10,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyGachaPulls)??0}},{id:"weekly_tower_20",requirement:20,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyTowerFloors)??0}},{id:"weekly_card_view_15",requirement:15,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyCardViewed)??0}}],lt=[...((Q=i==null?void 0:i.questProgress)==null?void 0:Q.claimedDailyQuests)||[],...((Z=i==null?void 0:i.questProgress)==null?void 0:Z.claimedWeeklyQuests)||[]],ht=[...F,...L].filter(O=>O.getValue(i)>=O.requirement&&!lt.includes(O.id)).length,Y=[...F,...L].filter(O=>O.getValue(i)>=O.requirement).length,K=F.length+L.length,U=O=>{var z,et,nt,mt,Nt;if(!i)return 0;const B=(z=i.gachaInventory)==null?void 0:z.gachaStats,rt=((B==null?void 0:B.totalURCards)??0)+((B==null?void 0:B.totalSRCards)??0)+((B==null?void 0:B.totalRCards)??0)+((B==null?void 0:B.totalNCards)??0);switch(O){case"streak":return i.streak;case"correct":return i.totalCorrect;case"perfect":return i.perfectLessons??0;case"level":return i.level??1;case"gems":return i.gems??0;case"conquest":return((et=i.conquestStats)==null?void 0:et.totalConquests)??0;case"conquest_wins":return((nt=i.conquestStats)==null?void 0:nt.bestWinStreak)??0;case"rank_points":return((mt=i.conquestStats)==null?void 0:mt.rankPoints)??0;case"gacha_pulls":return((Nt=i.gachaInventory)==null?void 0:Nt.totalPulls)??0;case"gacha_ur":return(B==null?void 0:B.totalURCards)??0;case"gacha_sr":return(B==null?void 0:B.totalSRCards)??0;case"gacha_total_cards":return rt;case"gacha_collections":return(B==null?void 0:B.completedCollections)??0;case"quizzes":return i.totalQuizzes??0;case"tower_floor":case"tower_complete":return 0;default:return 0}},W=O=>U(O.type)>=O.requirement,j=cr.filter(O=>W(O)).length,q=cr.filter(O=>W(O)&&!D.includes(O.id)).length;I.useEffect(()=>{(async()=>{if(i!=null&&i.oderId)try{const B=i.claimedMails||[],rt=i.deletedMails||[],z=Wr(kt,"mails"),et=rl(z,Af("active","==",!0)),Nt=(await ka(et)).docs.filter(ct=>{const ot=ct.data(),Tt=ot.targetUserId;return ot.type==="leaderboard_reward"?Tt===i.oderId:!Tt||Tt===i.oderId}).filter(ct=>!B.includes(ct.id)&&!rt.includes(ct.id)).length;C(Nt)}catch(B){console.error("Error checking mail:",B)}})()},[i==null?void 0:i.oderId,i==null?void 0:i.claimedMails,i==null?void 0:i.deletedMails]);const J=async()=>{if(!A.trim())return;await o(A)?(T("success"),setTimeout(()=>{P(!1),M(""),T("idle")},1e3)):T("error")},G=async()=>{if(!(!h.trim()||!i))try{const O=Wr(kt,"redeemCodes"),B=rl(O,Af("code","==",h.toUpperCase())),rt=await ka(B);if(rt.empty){f("error");return}const z=rt.docs[0],et=z.data();if((i.usedRedeemCodes||[]).includes(z.id)){f("error");return}if(et.usageLimit&&et.usedCount>=et.usageLimit){f("error");return}await r(et.reward),await s(z.id),await Gt(Mt(kt,"redeemCodes",z.id),{usedCount:(et.usedCount||0)+1}),y(et.reward),c(!1),_(!0),u(""),f("idle"),Ee({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(O){console.error("Redeem error:",O),f("error")}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:w,onClose:()=>_(!1),title:"i m thnh cng!",subtitle:"Bn  nhn c phn thng",rewards:[{type:"gems",amount:v}],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-blue)"}),k&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(dx,{className:"w-8 h-8 text-[var(--duo-blue)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"i tn hin th"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Tn t 2-20 k t"}),l.jsx("input",{type:"text",value:A,onChange:O=>{M(O.target.value),T("idle")},placeholder:(i==null?void 0:i.odername)||"Nhp tn mi",maxLength:20,className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg mb-3"}),N==="success"&&l.jsx("p",{className:"text-[var(--duo-green)] text-center text-sm mb-3",children:"i tn thnh cng!"}),N==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"Khng th i tn. Vui lng th li."}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{P(!1),M(""),T("idle")},className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"Hy"}),l.jsx("button",{onClick:J,disabled:!A.trim()||A.trim().length<2,className:"flex-1 btn-3d btn-3d-blue py-3 disabled:opacity-50",children:"Lu"})]})]})}),E&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(EB,{className:"w-8 h-8 text-[var(--duo-red)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Xa cache?"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"D liu tm s b xa v trang s c ti li. D liu ti khon vn c gi nguyn."}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"Hy"}),l.jsx("button",{onClick:()=>{localStorage.clear(),window.location.href=window.location.origin},className:"flex-1 btn-3d btn-3d-red py-3",children:"Xa"})]})]})}),a&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Ue,{className:"w-8 h-8 text-[var(--duo-purple)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Nhp m i thng"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Nhp m  nhn gems min ph"}),l.jsx("input",{type:"text",value:h,onChange:O=>{u(O.target.value.toUpperCase()),f("idle")},placeholder:"VD: QTDA2024",className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg uppercase mb-3"}),d==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"M khng hp l hoc  s dng"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{c(!1),u(""),f("idle")},className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"ng"}),l.jsx("button",{onClick:G,className:"flex-1 btn-3d btn-3d-green py-3",children:"i thng"})]})]})}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsx("h1",{className:"font-bold text-xl text-white",children:"Ti"})}),l.jsxs("div",{className:"px-4 pt-24 pb-32",children:[i&&l.jsxs("div",{className:"card-3d p-4 mb-5",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center shrink-0",children:[i.equippedFrame&&l.jsx("img",{src:ke(i.equippedFrame,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden border-2 border-[var(--border)] shadow-lg",children:i.equippedAvatar||i.avatar?l.jsx("img",{src:i.equippedAvatar?ke(i.equippedAvatar,100):i.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):i.odername.charAt(0).toUpperCase()})]}),i.equippedBadge&&l.jsx("div",{className:"w-12 h-12 shrink-0",children:l.jsx("img",{src:ke(i.equippedBadge,80),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"font-bold text-lg text-foreground truncate",children:i.odername}),l.jsx("button",{onClick:()=>{M(i.odername),P(!0)},className:"p-1.5 rounded-lg bg-[var(--secondary)] border-2 border-[var(--border)] shadow-[0_2px_0_var(--border)] active:translate-y-0.5 active:shadow-none shrink-0",children:l.jsx(dx,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:["Level ",i.level,"  ",Mn(i.exp)," XP"]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>e(`/profile/${i.oderId}`),className:"flex-1 py-3 px-4 rounded-xl bg-[var(--secondary)] text-foreground font-bold flex items-center justify-center gap-2 border-2 border-[var(--border)] shadow-[0_4px_0_var(--border)] active:translate-y-1 active:shadow-none",children:[l.jsx(fl,{className:"w-5 h-5"}),l.jsx("span",{children:"H s"})]}),l.jsxs("button",{onClick:()=>e("/customize"),className:"flex-1 btn-3d btn-3d-purple py-3 px-4 flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Trang b"})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>e("/mailbox"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-orange)]/20 flex items-center justify-center",children:l.jsx(LP,{className:"w-5 h-5 text-[var(--duo-orange)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Hm th"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhn qu t h thng"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[x>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:x}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/quests"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx(Vi,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Nhim v"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[Y,"/",K," hon thnh"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[ht>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:ht}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/achievements"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx(pr,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Thnh tu"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[j,"/",cr.length,"  t"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[q>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:q}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/stats"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(RP,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Thng k"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phn tch chi tit"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>e("/card-inventory"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Kho th"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Xem th  su tp"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>e("/shop"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[var(--duo-purple)]/20 to-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Ue,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Ca hng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Mua tim, XP boost, streak freeze"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>c(!0),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Ue,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"M i thng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhp m nhn gems"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsx("h3",{className:"text-sm font-semibold text-[var(--muted-foreground)] mt-4 mb-2",children:"Ci t"}),l.jsxs("button",{onClick:n,className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:t==="dark"?l.jsx(eB,{className:"w-5 h-5 text-[var(--duo-yellow)]"}):l.jsx(xB,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Ch  ti"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:t==="dark"?"ang bt":"ang tt"})]})]}),l.jsx("div",{className:`w-14 h-8 rounded-full p-1 ${t==="dark"?"bg-[var(--duo-green)]":"bg-[var(--secondary)]"}`,children:l.jsx("div",{className:"w-6 h-6 rounded-full bg-white shadow-md",style:{transform:t==="dark"?"translateX(24px)":"translateX(0)"}})})]}),l.jsxs("button",{onClick:()=>R(!0),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(qP,{className:"w-5 h-5 text-[var(--duo-red)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Xa cache"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Xa d liu tm & reload"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsx("div",{className:"card-3d p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(ux,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Quiz QTDA"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phin bn 1.0.0"})]})]})})]})]})]})}function ast(){var N,T,E,R,D,F,L,lt,ht,Y,K,U,W,j,q,J,G,Q,Z,O,B,rt,z,et,nt,mt,Nt,ct,ot,Tt,Et,Yt,St,Ut,pn,oe;const e=we(),{user:t}=Zt(),{chapters:n}=ds(),[i,r]=I.useState("overview");I.useEffect(()=>{ds.getState().loadQuiz()},[]);const s=((t==null?void 0:t.totalCorrect)??0)+((t==null?void 0:t.totalWrong)??0),o=s>0?Math.round(((t==null?void 0:t.totalCorrect)??0)/s*100):0,a=t==null?void 0:t.conquestStats,c=(a==null?void 0:a.rankPoints)??0,h=ps(c),u=((a==null?void 0:a.totalConquestCorrect)??0)+((a==null?void 0:a.totalConquestWrong)??0),d=u>0?Math.round(((a==null?void 0:a.totalConquestCorrect)??0)/u*100):0,f=["T2","T3","T4","T5","T6","T7","CN"],v=new Date,y=v.getDay()===0?6:v.getDay()-1,w=(t==null?void 0:t.streak)??0,_=f.map((ft,It)=>{const ae=y-It;return ae>=0&&ae<w?Math.floor(Math.random()*50)+20:0}),x=Math.max(..._,1),C=n.map(ft=>{var ae;const It=(ae=t==null?void 0:t.chapterProgress)==null?void 0:ae[ft.id];return{...ft,completed:(It==null?void 0:It.completed)??0,correct:(It==null?void 0:It.correct)??0,stars:(It==null?void 0:It.stars)??0,bestScore:(It==null?void 0:It.bestScore)??0,isCompleted:(It==null?void 0:It.isCompleted)??!1}}),k=C.filter(ft=>ft.isCompleted).length,[P,A]=I.useState(0);I.useEffect(()=>{try{const ft=localStorage.getItem("tower_progress");if(ft){const It=JSON.parse(ft);A(It.currentFloor||0)}}catch(ft){console.error("Error loading tower progress:",ft)}},[]);const M=ff(t,P);return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-blue)] to-[var(--duo-purple)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(RP,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Thng k"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Phn tch chi tit qu trnh hc"})]})]})}),l.jsx("div",{className:"fixed top-[108px] left-0 right-0 z-40 px-4 py-2 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsx("div",{className:"flex gap-1.5 overflow-x-auto no-scrollbar",children:[{id:"overview",label:"Tng quan",icon:jP},{id:"chapters",label:"Chng",icon:Yc},{id:"history",label:"Lch s",icon:uu},{id:"gacha",label:"Gacha",icon:Xt}].map(ft=>l.jsxs("button",{onClick:()=>r(ft.id),className:`flex items-center justify-center gap-1 py-2 px-3 rounded-xl text-xs font-semibold whitespace-nowrap shrink-0 ${i===ft.id?"bg-[var(--duo-green)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(ft.icon,{className:"w-3.5 h-3.5"}),ft.label]},ft.id))})}),l.jsxs("div",{className:"px-4 pt-44 pb-28",children:[i==="overview"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(ai,{className:"w-6 h-6 text-[var(--duo-green)]"})}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:(t==null?void 0:t.totalCorrect)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu ng"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx($r,{className:"w-6 h-6 text-[var(--duo-red)]"})}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.totalWrong)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu sai"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Rc,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"im theo lnh vc"]}),l.jsx("div",{className:"bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] rounded-2xl p-4 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-white/80 text-sm",children:"Tng im"}),l.jsx("p",{className:"text-3xl font-bold text-white",children:Mn(M.totalScore)})]}),l.jsx("div",{className:"w-14 h-14 rounded-full bg-white/20 flex items-center justify-center",children:l.jsx(Le,{className:"w-7 h-7 text-white"})})]})}),l.jsx("div",{className:"space-y-3",children:[{label:"Luyn tp",score:M.quizScore,icon:Yc,color:"var(--duo-green)",bgColor:"var(--duo-green)"},{label:"Chinh Chin",score:M.conquestScore,icon:wi,color:"var(--duo-purple)",bgColor:"var(--duo-purple)"},{label:"B su tp",score:M.gachaScore,icon:Xt,color:"var(--duo-yellow)",bgColor:"var(--duo-yellow)"},{label:"Thp Luyn Ngc",score:M.towerScore,icon:Fu,color:"var(--duo-orange)",bgColor:"var(--duo-orange)"},{label:"Thnh tu",score:M.achievementScore,icon:pr,color:"var(--duo-blue)",bgColor:"var(--duo-blue)"}].map(ft=>{const It=M.totalScore>0?ft.score/M.totalScore*100:0;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center shrink-0",style:{backgroundColor:`${ft.bgColor}20`},children:l.jsx(ft.icon,{className:"w-4.5 h-4.5",style:{color:ft.color}})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-foreground",children:ft.label}),l.jsx("span",{className:"text-sm font-bold",style:{color:ft.color},children:Mn(ft.score)})]}),l.jsx("div",{className:"h-1.5 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.min(It,100)}%`,backgroundColor:ft.color}})})]})]},ft.label)})})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Vi,{className:"w-5 h-5 text-[var(--duo-blue)]"})," chnh xc tng"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"relative w-24 h-24",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",children:[l.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"var(--secondary)",strokeWidth:"8"}),l.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:o>=70?"var(--duo-green)":o>=50?"var(--duo-yellow)":"var(--duo-red)",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${o/100*251} 251`})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[o,"%"]})})]}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tng cu"}),l.jsx("span",{className:"font-bold text-foreground",children:s})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"ng"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:(t==null?void 0:t.totalCorrect)??0})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Sai"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.totalWrong)??0})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5 mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:(t==null?void 0:t.exp)??0}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"XP"})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx(Le,{className:"w-5 h-5 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsxs("p",{className:"text-sm font-bold text-foreground",children:["Lv.",(t==null?void 0:t.level)??1]}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"Cp "})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx(ge,{className:"w-5 h-5 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:(t==null?void 0:t.perfectLessons)??0}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"100%"})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5 mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:Mn((t==null?void 0:t.gems)??0)}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"Gems"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(uu,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Hot ng tun ny"]}),l.jsx("div",{className:"flex items-end justify-between h-24 gap-1",children:f.map((ft,It)=>l.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[l.jsx("div",{className:"w-full flex-1 flex items-end",children:l.jsx("div",{className:`w-full rounded-t-lg ${_[It]>0?"bg-[var(--duo-green)]":"bg-[var(--secondary)]"}`,style:{height:`${_[It]/x*100}%`,minHeight:"4px"}})}),l.jsx("span",{className:"text-[10px] text-[var(--muted-foreground)]",children:ft})]},ft))}),l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3 pt-3 border-t border-[var(--border)]",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-6 h-6"}),l.jsxs("span",{className:"font-bold text-[var(--duo-orange)]",children:[(t==null?void 0:t.streak)??0," ngy streak"]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(wi,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Chinh Chin"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:Pa(h),alt:h.rankName,className:"w-16 h-16 mx-auto object-contain"}),l.jsx("p",{className:"text-sm font-bold text-foreground mt-1",children:h.rankName}),l.jsxs("p",{className:"text-xs text-[var(--duo-purple)] font-bold",children:[c," RP"]})]}),l.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-foreground",children:(a==null?void 0:a.totalConquests)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng trn"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsxs("p",{className:"text-lg font-bold text-foreground",children:[d,"%"]}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:" chnh xc"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-[var(--duo-green)]",children:(a==null?void 0:a.totalConquestCorrect)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Cu ng"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-[var(--duo-orange)]",children:(a==null?void 0:a.bestWinStreak)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Win streak"})]})]})]})]})]}),i==="chapters"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-bold text-foreground",children:"Tin  chng"}),l.jsxs("span",{className:"text-sm text-[var(--duo-green)] font-bold",children:[k,"/",n.length]})]}),l.jsx("div",{className:"progress-duo h-3",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${k/Math.max(n.length,1)*100}%`}})})]}),l.jsx("div",{className:"space-y-2",children:C.map((ft,It)=>{const ae=["#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b"],vn=ae[It%ae.length],Xn=ft.completed>0?Math.round(ft.completed/ft.totalQuestions*100):0;return l.jsx("div",{className:"card-3d p-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold shrink-0",style:{background:vn},children:ft.id}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h4",{className:"font-bold text-sm text-foreground truncate",children:ft.name}),ft.isCompleted&&l.jsx(ai,{className:"w-4 h-4 text-[var(--duo-green)] shrink-0"})]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("div",{className:"flex-1 progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${Xn}%`}})}),l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:[Xn,"%"]})]})]}),l.jsxs("div",{className:"text-right shrink-0",children:[ft.stars>0&&l.jsx("div",{className:"flex items-center gap-0.5 mb-1",children:[...Array(3)].map((Ei,Jn)=>l.jsx(ge,{className:`w-3 h-3 ${Jn<ft.stars?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},Jn))}),ft.bestScore>0&&l.jsxs("p",{className:"text-xs text-[var(--duo-green)] font-bold",children:[ft.bestScore," XP"]})]})]})},ft.id)})})]}),i==="history"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Uu,{className:"w-5 h-5 text-[var(--duo-blue)]"}),"Streak"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-8 h-8 mx-auto mb-1"}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-orange)]",children:(t==null?void 0:t.streak)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hin ti"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(zr,{className:"w-8 h-8 text-[var(--duo-red)] mx-auto mb-1"}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.longestStreak)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Di nht"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Vi,{className:"w-5 h-5 text-[var(--duo-green)]"}),"Mc tiu hm nay"]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tin "}),l.jsxs("span",{className:"font-bold text-foreground",children:[(t==null?void 0:t.dailyProgress)??0,"/",(t==null?void 0:t.dailyGoal)??50," XP"]})]}),l.jsx("div",{className:"progress-duo h-3",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${Math.min(((t==null?void 0:t.dailyProgress)??0)/((t==null?void 0:t.dailyGoal)??50)*100,100)}%`,background:((t==null?void 0:t.dailyProgress)??0)>=((t==null?void 0:t.dailyGoal)??50)?"var(--duo-yellow)":void 0}})})]}),((t==null?void 0:t.dailyProgress)??0)>=((t==null?void 0:t.dailyGoal)??50)&&l.jsx(ai,{className:"w-8 h-8 text-[var(--duo-green)]"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Le,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Ct mc"]}),l.jsx("div",{className:"space-y-3",children:[{label:"Cu ng u tin",value:1,current:(t==null?void 0:t.totalCorrect)??0,icon:ai},{label:"50 cu ng",value:50,current:(t==null?void 0:t.totalCorrect)??0,icon:Vi},{label:"100 cu ng",value:100,current:(t==null?void 0:t.totalCorrect)??0,icon:ge},{label:"Level 5",value:5,current:(t==null?void 0:t.level)??1,icon:Le},{label:"7 ngy streak",value:7,current:(t==null?void 0:t.streak)??0,icon:zr},{label:"100 Rank Points",value:100,current:(a==null?void 0:a.rankPoints)??0,icon:wi}].map((ft,It)=>{const ae=ft.current>=ft.value;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${ae?"bg-[var(--duo-green)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(ft.icon,{className:`w-4 h-4 ${ae?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`})}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:`text-sm font-semibold ${ae?"text-foreground":"text-[var(--muted-foreground)]"}`,children:ft.label})}),ae?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:[ft.current,"/",ft.value]})]},It)})})]})]}),i==="gacha"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Tng quan Gacha"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(Ts,{className:"w-6 h-6 text-[var(--duo-purple)] mx-auto mb-1"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((N=t==null?void 0:t.gachaInventory)==null?void 0:N.totalPulls)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng ln quay"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",alt:"shard",className:"w-6 h-6 mx-auto mb-1"}),l.jsx("p",{className:"text-xl font-bold text-[var(--duo-blue)]",children:Mn(((T=t==null?void 0:t.gachaInventory)==null?void 0:T.shards)??0)}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Mnh ghp"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(ge,{className:"w-5 h-5 text-[var(--duo-orange)]"}),"Th theo  him"]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[l.jsxs("div",{className:"bg-gradient-to-b from-[#FFD700]/20 to-[#FFD700]/5 rounded-xl p-3 text-center border border-[#FFD700]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#FFD700] mb-1",children:"UR"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((R=(E=t==null?void 0:t.gachaInventory)==null?void 0:E.gachaStats)==null?void 0:R.totalURCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#9B59B6]/20 to-[#9B59B6]/5 rounded-xl p-3 text-center border border-[#9B59B6]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#9B59B6] mb-1",children:"SR"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((F=(D=t==null?void 0:t.gachaInventory)==null?void 0:D.gachaStats)==null?void 0:F.totalSRCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#3498DB]/20 to-[#3498DB]/5 rounded-xl p-3 text-center border border-[#3498DB]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#3498DB] mb-1",children:"R"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((lt=(L=t==null?void 0:t.gachaInventory)==null?void 0:L.gachaStats)==null?void 0:lt.totalRCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#95A5A6]/20 to-[#95A5A6]/5 rounded-xl p-3 text-center border border-[#95A5A6]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#95A5A6] mb-1",children:"N"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((Y=(ht=t==null?void 0:t.gachaInventory)==null?void 0:ht.gachaStats)==null?void 0:Y.totalNCards)??0})]})]}),l.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--border)]",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Tng th unique"}),l.jsx("span",{className:"font-bold text-foreground",children:(((U=(K=t==null?void 0:t.gachaInventory)==null?void 0:K.gachaStats)==null?void 0:U.totalURCards)??0)+(((j=(W=t==null?void 0:t.gachaInventory)==null?void 0:W.gachaStats)==null?void 0:j.totalSRCards)??0)+(((J=(q=t==null?void 0:t.gachaInventory)==null?void 0:q.gachaStats)==null?void 0:J.totalRCards)??0)+(((Q=(G=t==null?void 0:t.gachaInventory)==null?void 0:G.gachaStats)==null?void 0:Q.totalNCards)??0)})]})})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(pr,{className:"w-5 h-5 text-[var(--duo-green)]"}),"Phn thng su tp"]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(fl,{className:"w-6 h-6 text-[var(--duo-blue)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((O=(Z=t==null?void 0:t.gachaInventory)==null?void 0:Z.gachaStats)==null?void 0:O.totalAvatars)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Avatar"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(uf,{className:"w-6 h-6 text-[var(--duo-purple)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((rt=(B=t==null?void 0:t.gachaInventory)==null?void 0:B.gachaStats)==null?void 0:rt.totalFrames)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Khung"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(pr,{className:"w-6 h-6 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((et=(z=t==null?void 0:t.gachaInventory)==null?void 0:z.gachaStats)==null?void 0:et.totalBadges)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Huy hiu"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"B su tp"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-blue)] flex items-center justify-center",children:l.jsx("span",{className:"text-3xl font-bold text-white",children:((mt=(nt=t==null?void 0:t.gachaInventory)==null?void 0:nt.gachaStats)==null?void 0:mt.completedCollections)??0})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-lg font-bold text-foreground",children:"Gi hon thnh"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"S b su tp  thu thp  th"}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsx("span",{className:"text-xs text-[var(--muted-foreground)]",children:"ang tham gia:"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:Object.keys(((Nt=t==null?void 0:t.gachaInventory)==null?void 0:Nt.cards)??{}).length})]})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Vi,{className:"w-5 h-5 text-[var(--duo-red)]"}),"T l may mn"]}),(((ct=t==null?void 0:t.gachaInventory)==null?void 0:ct.totalPulls)??0)>0?l.jsx("div",{className:"space-y-2",children:[{label:"UR",count:((Tt=(ot=t==null?void 0:t.gachaInventory)==null?void 0:ot.gachaStats)==null?void 0:Tt.totalURCards)??0,color:"#FFD700",rate:3},{label:"SR",count:((Yt=(Et=t==null?void 0:t.gachaInventory)==null?void 0:Et.gachaStats)==null?void 0:Yt.totalSRCards)??0,color:"#9B59B6",rate:18},{label:"R",count:((Ut=(St=t==null?void 0:t.gachaInventory)==null?void 0:St.gachaStats)==null?void 0:Ut.totalRCards)??0,color:"#3498DB",rate:39},{label:"N",count:((oe=(pn=t==null?void 0:t.gachaInventory)==null?void 0:pn.gachaStats)==null?void 0:oe.totalNCards)??0,color:"#95A5A6",rate:40}].map(ft=>{var vn,Xn,Ei,Jn,Zn,Si,ti,Ii;const It=(((Xn=(vn=t==null?void 0:t.gachaInventory)==null?void 0:vn.gachaStats)==null?void 0:Xn.totalURCards)??0)+(((Jn=(Ei=t==null?void 0:t.gachaInventory)==null?void 0:Ei.gachaStats)==null?void 0:Jn.totalSRCards)??0)+(((Si=(Zn=t==null?void 0:t.gachaInventory)==null?void 0:Zn.gachaStats)==null?void 0:Si.totalRCards)??0)+(((Ii=(ti=t==null?void 0:t.gachaInventory)==null?void 0:ti.gachaStats)==null?void 0:Ii.totalNCards)??0),ae=It>0?(ft.count/It*100).toFixed(1):"0";return l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-xs font-bold w-6",style:{color:ft.color},children:ft.label}),l.jsx("div",{className:"flex-1 h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(ft.count/Math.max(It,1)*100,100)}%`,background:ft.color}})}),l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)] w-16 text-right",children:[ae,"% (",ft.rate,"%)"]})]},ft.label)})}):l.jsx("p",{className:"text-center text-[var(--muted-foreground)] py-4",children:"Cha c d liu quay gacha"})]})]})]})]})}function cst(){const e=we(),{user:t,addGems:n,claimMail:i,deleteMail:r}=Zt(),[s,o]=I.useState([]),[a,c]=I.useState(!0),[h,u]=I.useState(!1),[d,f]=I.useState(null),v=(t==null?void 0:t.claimedMails)||[];I.useEffect(()=>{(async()=>{if(t)try{const A=Wr(kt,"mails"),M=rl(A,Af("active","==",!0)),T=(await ka(M)).docs.map(D=>({id:D.id,...D.data()})).filter(D=>{const F=D,L=F.targetUserId;return F.type==="leaderboard_reward"?L===t.oderId:!L||L===t.oderId});T.sort((D,F)=>new Date(F.createdAt).getTime()-new Date(D.createdAt).getTime());const E=t.deletedMails||[],R=T.filter(D=>!E.includes(D.id));o(R)}catch(A){console.error("Error loading mails:",A)}finally{c(!1)}})()},[t]);const y=async P=>{v.includes(P.id)||(await n(P.reward),await i(P.id),f({title:P.title,gems:P.reward}),u(!0),Ee({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]}))},w=async P=>{v.includes(P.id)&&(await r(P.id),o(A=>A.filter(M=>M.id!==P.id)))},_=s.filter(P=>!v.includes(P.id)).length,[x,C]=I.useState(!1),k=async()=>{if(x)return;const P=s.filter(A=>!v.includes(A.id));if(P.length!==0){C(!0);try{const A=P.reduce((M,N)=>M+N.reward,0);for(const M of P)await i(M.id);await n(A),f({title:`${P.length} th`,gems:A}),u(!0),Ee({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(A){console.error("Error claiming all mails:",A)}finally{C(!1)}}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:h&&!!d,onClose:()=>u(!1),title:"Nhn qu thnh cng!",subtitle:d==null?void 0:d.title,rewards:d?[{type:"gems",amount:d.gems}]:[],gradientFrom:"var(--duo-orange)",gradientTo:"var(--duo-yellow)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-3 pb-3 px-3 bg-gradient-to-r from-[var(--duo-orange)] to-[var(--duo-yellow)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Xi,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Hm th"}),l.jsx("p",{className:"text-white/80 text-xs truncate",children:_>0?`${_} th cha nhn`:"Khng c th mi"})]}),_>0&&l.jsxs("button",{onClick:k,disabled:x,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Ue,{className:"w-3.5 h-3.5"}),"Nhn (",_,")"]})]})}),l.jsx("div",{className:"px-4 pt-24 pb-28",children:a?l.jsx("div",{className:"text-center py-10",children:l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"ang ti..."})}):s.length===0?l.jsxs("div",{className:"text-center py-10",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(KO,{className:"w-10 h-10 text-[var(--muted-foreground)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Hm th trng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Qu t h thng s xut hin  y"})]}):l.jsx("div",{className:"space-y-3",children:s.map(P=>{const A=v.includes(P.id);return l.jsx("div",{className:`card-3d p-4 ${A?"":"border-[var(--duo-orange)] border-2"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 ${A?"bg-[var(--secondary)]":"bg-[var(--duo-orange)]/20"}`,children:l.jsx(LP,{className:`w-6 h-6 ${A?"text-[var(--muted-foreground)]":"text-[var(--duo-orange)]"}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-bold text-foreground",children:P.title}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1 line-clamp-2",children:P.content}),l.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsxs("span",{className:"text-sm font-bold text-[var(--duo-blue)]",children:[P.reward," Gems"]})]})]}),A?l.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("button",{onClick:()=>w(P),className:"w-9 h-9 rounded-lg bg-red-500/10 flex items-center justify-center hover:bg-red-500/20 transition-colors",children:l.jsx(qP,{className:"w-4 h-4 text-red-500"})})]}):l.jsx("button",{onClick:()=>y(P),className:"btn-3d btn-3d-green px-4 py-2.5 text-sm shrink-0 min-w-[60px]",children:"Nhn"})]})},P.id)})})})]})}function lst(){const e=we(),{user:t,spendGems:n,refillHearts:i,buyUnlimitedHearts:r,hasUnlimitedHearts:s,getUnlimitedHeartsTimeLeft:o,buyXPBoost:a,hasXPBoost:c,getXPBoostTimeLeft:h,buyStreakFreeze:u,getStreakFreezeCount:d}=Zt(),[f,v]=I.useState(null),[y,w]=I.useState(null),[_,x]=I.useState(null),[C,k]=I.useState(!1),[P,A]=I.useState(!1),[M,N]=I.useState(!1),[T,E]=I.useState(!1),[R,D]=I.useState(!1),[F,L]=I.useState(0);I.useEffect(()=>{const U=()=>{const j=o();w(j);const q=h();if(x(q),!(t!=null&&t.lastHeartRefill)){v(null);return}if((t.hearts??5)>=(t.maxHearts??5)){v(null);return}const J=new Date(t.lastHeartRefill).getTime(),G=Date.now(),Q=J+30*60*1e3,Z=Math.max(0,Q-G);if(Z<=0){v("Sp c!");return}const O=Math.floor(Z/6e4),B=Math.floor(Z%6e4/1e3);v(`${O}:${B.toString().padStart(2,"0")}`)};U();const W=setInterval(U,1e3);return()=>clearInterval(W)},[t==null?void 0:t.lastHeartRefill,t==null?void 0:t.hearts,t==null?void 0:t.maxHearts,o,h]);const lt=async()=>{if(!t)return;if(t.gems<500){alert("Khng  gems!");return}await n(500)&&(await i(),N(!0),Ee({particleCount:60,spread:50,origin:{y:.6},colors:["#ff4b4b","#ff6b6b","#ffc800"]}))},ht=async()=>{if(((t==null?void 0:t.gems)??0)<3e3){alert("Khng  gems! Cn 3000 gems.");return}k(!0);const U=await r();k(!1),U?(A(!0),Ee({particleCount:100,spread:70,origin:{y:.6},colors:["#ffc800","#ff9600","#ce82ff"]})):alert("C li xy ra!")},Y=async U=>{const j={1:500,3:1200,8:2500}[U];if(((t==null?void 0:t.gems)??0)<j){alert(`Khng  gems! Cn ${j} gems.`);return}k(!0);const q=await a(U);k(!1),q?(L(U),E(!0),Ee({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#89e219","#ffc800"]})):alert("C li xy ra!")},K=async()=>{if(((t==null?void 0:t.gems)??0)<1e3){alert("Khng  gems! Cn 1000 gems.");return}if(d()>=5){alert("Bn  c ti a 5 Streak Freeze!");return}k(!0);const U=await u();k(!1),U?(D(!0),Ee({particleCount:60,spread:50,origin:{y:.6},colors:["#1cb0f6","#84d8ff","#ffffff"]})):alert("C li xy ra!")};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ue,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Ca hng"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Mua vt phm h tr hc tp"})]})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-28 space-y-4",children:[t&&l.jsx("div",{className:"card-3d p-4",children:l.jsxs("div",{className:"flex items-center justify-around",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-lg text-[var(--duo-blue)]",children:Mn(t.gems??0)}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Gems"})]})]}),l.jsx("div",{className:"w-px h-10 bg-[var(--border)]"}),s()?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-lg text-[var(--duo-red)]",children:""}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tim v hn"})]})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsxs("p",{className:"font-bold text-lg text-[var(--duo-red)]",children:[t.hearts??5,"/",t.maxHearts??5]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tim"})]})]})]})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),"Tim"]}),t&&(t.hearts??5)<(t.maxHearts??5)&&l.jsxs("div",{className:"card-3d p-3 mb-3 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Uu,{className:"w-5 h-5 text-[var(--duo-blue)]"}),l.jsx("span",{className:"text-sm text-foreground",children:"Tim tip theo"})]}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:f})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t&&(t.hearts??5)<(t.maxHearts??5)&&(t.gems??0)>=500&&l.jsxs("button",{onClick:lt,className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"500"})]})]}),t&&(t.hearts??5)<(t.maxHearts??5)&&(t.gems??0)<500&&l.jsxs("div",{className:"card-3d p-4 text-center opacity-50",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-red)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4 grayscale"}),l.jsx("span",{className:"font-bold",children:"Thiu gems"})]})]}),t&&(t.hearts??5)>=(t.maxHearts??5)&&l.jsxs("div",{className:"card-3d p-4 text-center opacity-50",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Tim  y"}),l.jsx("p",{className:"text-xs text-[var(--duo-green)]",children:"5/5"})]}),s()?l.jsxs("div",{className:"card-3d p-4 text-center border-2 border-[var(--duo-yellow)]",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-2",children:l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)] animate-pulse"})}),l.jsx("p",{className:"font-bold text-[var(--duo-yellow)] mb-1",children:"Tim v hn"}),l.jsxs("p",{className:"text-xs text-[var(--duo-green)] font-bold",children:["Cn ",y]})]}):l.jsxs("button",{onClick:ht,disabled:C||((t==null?void 0:t.gems)??0)<3e3,className:`card-3d p-4 text-center ${((t==null?void 0:t.gems)??0)<3e3?"opacity-50":""}`,children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-2",children:l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Tim v hn 24h"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"3000"})]})]})]})]}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx(Lr,{className:"w-4 h-4 text-[var(--duo-green)]"}),"XP Boost (x2)"]}),c()&&l.jsxs("div",{className:"card-3d p-3 mb-3 flex items-center justify-between border-2 border-[var(--duo-green)]",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Lr,{className:"w-5 h-5 text-[var(--duo-green)] animate-pulse"}),l.jsx("span",{className:"text-sm font-bold text-[var(--duo-green)]",children:"XP x2 ang hot ng!"})]}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:_})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("button",{onClick:()=>Y(1),disabled:C||((t==null?void 0:t.gems)??0)<500,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<500?"opacity-50":""}`,children:[l.jsx("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(Lr,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"1 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"500"})]})]}),l.jsxs("button",{onClick:()=>Y(3),disabled:C||((t==null?void 0:t.gems)??0)<1200,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<1200?"opacity-50":""}`,children:[l.jsx("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(Lr,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"3 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"1200"})]})]}),l.jsxs("button",{onClick:()=>Y(8),disabled:C||((t==null?void 0:t.gems)??0)<2500,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<2500?"opacity-50":""}`,children:[l.jsxs("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2 relative",children:[l.jsx(Lr,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("span",{className:"absolute -top-1 -right-1 bg-[var(--duo-orange)] text-white text-[8px] px-1 rounded-full font-bold",children:"HOT"})]}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"8 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"2500"})]})]})]})]}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx(vv,{className:"w-4 h-4 text-[var(--duo-blue)]"}),"Streak Freeze"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-blue)]/20 flex items-center justify-center mb-2",children:l.jsx(vv,{className:"w-6 h-6 text-[var(--duo-blue)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"ang c"}),l.jsxs("p",{className:"text-lg font-bold text-[var(--duo-blue)]",children:[d(),"/5"]})]}),l.jsxs("button",{onClick:K,disabled:C||((t==null?void 0:t.gems)??0)<1e3||d()>=5,className:`card-3d p-4 text-center ${((t==null?void 0:t.gems)??0)<1e3||d()>=5?"opacity-50":""}`,children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-blue)]/20 flex items-center justify-center mb-2",children:l.jsx(vv,{className:"w-6 h-6 text-[var(--duo-blue)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Mua thm"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"1000"})]})]})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-2 text-center",children:"Streak Freeze t ng bo v streak khi bn qun hc 1 ngy"})]})]}),l.jsx(Gn,{isOpen:P,onClose:()=>A(!1),title:"Tim v hn  kch hot!",subtitle:"Bn c th hc khng gii hn trong 24 gi",rewards:[{type:"custom",amount:24,icon:"/AppAssets/Heart.png",label:"gi tim v hn "}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-yellow)",gradientTo:"var(--duo-orange)"}),l.jsx(Gn,{isOpen:M,onClose:()=>N(!1),title:"Hi tim thnh cng!",subtitle:"Tim ca bn  c hi y",rewards:[{type:"hearts",amount:5,label:"Tim"}],buttonText:"Tip tc hc!",gradientFrom:"var(--duo-red)",gradientTo:"var(--duo-pink)"}),l.jsx(Gn,{isOpen:T,onClose:()=>E(!1),title:"XP Boost  kch hot!",subtitle:`Nhn x2 XP trong ${F} gi ti`,rewards:[{type:"custom",amount:2,icon:"/AppAssets/Lighting.png",label:`x XP trong ${F}h`}],buttonText:"Hc ngay!",gradientFrom:"var(--duo-green)",gradientTo:"#89e219"}),l.jsx(Gn,{isOpen:R,onClose:()=>D(!1),title:"Mua Streak Freeze thnh cng!",subtitle:"Streak ca bn s c bo v khi qun hc",rewards:[{type:"custom",amount:d(),icon:"/AppAssets/Fire.png",label:"Streak Freeze"}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-blue)",gradientTo:"#84d8ff"})]})}const hst=[5,10,15,20,25,30,40,50],ust=[{id:"login-7days",title:"ng nhp 7 ngy",description:"Nhn thng mi ngy ng nhp",icon:AP,color:"var(--duo-green)",bgColor:"var(--duo-green)",route:"/event-login-7days",badge:"Hng ngy"},{id:"level-rewards",title:"Thng cp ",description:"Nhn qu khi t cp  mi",icon:Le,color:"var(--duo-purple)",bgColor:"var(--duo-purple)",route:"/event-level-rewards",badge:"Vnh vin"},{id:"tower",title:"Thp Luyn Ngc",description:"Leo thp, sai 1 cu l ri xung y!",icon:zr,color:"#8B5CF6",bgColor:"#8B5CF6",route:"/event-tower",badge:"Th thch"}];function dst(){const e=we(),{user:t}=Zt(),[n,i]=I.useState({});return I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const s=Mt(kt,"users",t.oderId),o=await Qr(s);if(!o.exists())return;const a=o.data(),c={},h=a.loginEvent||{claimedDays:[],lastClaimDate:""},u=new Date().toDateString();h.lastClaimDate!==u&&h.claimedDays.length<7&&(c["login-7days"]=1);const f=a.claimedLevelRewards||[],v=t.level||1,y=hst.filter(w=>v>=w&&!f.includes(w)).length;y>0&&(c["level-rewards"]=y),i(c)}catch(s){console.error("Error checking rewards:",s)}})()},[t==null?void 0:t.oderId,t==null?void 0:t.level]),l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-orange)] to-[var(--duo-yellow)]",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(uu,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"S kin"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Cc s kin c bit"})]}),l.jsxs("div",{className:"px-4 pt-24 pb-28",children:[l.jsx("div",{className:"space-y-3",children:ust.map(r=>{const s=r.icon,o=n[r.id]||0;return l.jsxs("button",{onClick:()=>e(r.route),className:`w-full card-3d p-4 flex items-center gap-4 ${o>0?"border-2 border-[var(--duo-green)]":""}`,children:[l.jsxs("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center relative",style:{backgroundColor:`${r.bgColor}20`},children:[l.jsx(s,{className:"w-7 h-7",style:{color:r.color}}),o>0&&l.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full bg-[var(--duo-red)] flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:o})})]}),l.jsxs("div",{className:"flex-1 text-left min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("p",{className:"font-bold text-foreground whitespace-nowrap",children:r.title}),l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full text-white whitespace-nowrap",style:{backgroundColor:r.color},children:r.badge}),o>0&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-green)] text-white whitespace-nowrap flex items-center gap-1",children:[l.jsx(Ue,{className:"w-3 h-3"}),"C qu!"]})]}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mt-1",children:r.description})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]},r.id)})}),l.jsx("div",{className:"mt-6 p-4 rounded-2xl bg-[var(--secondary)] border-2 border-dashed border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ue,{className:"w-6 h-6 text-[var(--muted-foreground)]"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Sp c thm s kin!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Hy quay li sau nh"})]})]})})]})]})}const TS=[{day:1,gems:50,label:"Ngy 1"},{day:2,gems:75,label:"Ngy 2"},{day:3,gems:100,label:"Ngy 3"},{day:4,gems:125,label:"Ngy 4"},{day:5,gems:150,label:"Ngy 5"},{day:6,gems:200,label:"Ngy 6"},{day:7,gems:500,label:"Ngy 7",special:!0}];function gst(){const e=we(),{user:t,addGems:n}=Zt(),[i,r]=I.useState({currentDay:1,claimedDays:[],lastClaimDate:""}),[s,o]=I.useState(!1),[a,c]=I.useState(!1),[h,u]=I.useState(0);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const w=Mt(kt,"users",t.oderId),_=await Qr(w);if(_.exists()){const C=_.data().loginEvent||{currentDay:1,claimedDays:[],lastClaimDate:""},k=new Date().toDateString(),P=C.lastClaimDate;if(P){const A=new Date(P),M=new Date(k);if(Math.floor((M.getTime()-A.getTime())/(1e3*60*60*24))>1||C.claimedDays.length>=7){r({currentDay:1,claimedDays:[],lastClaimDate:""});return}if(A.toDateString()===k){r(C);return}r({...C,currentDay:C.claimedDays.length+1})}else r(C)}}catch(w){console.error("Error loading login data:",w)}})()},[t==null?void 0:t.oderId]);const d=()=>{const y=new Date().toDateString();return i.lastClaimDate!==y&&i.currentDay<=7},f=async y=>{if(!(t!=null&&t.oderId)||s||y!==i.currentDay||!d())return;o(!0);const w=TS.find(_=>_.day===y);if(w)try{const _=new Date().toDateString(),x=[...i.claimedDays,y],C={currentDay:y+1,claimedDays:x,lastClaimDate:_},k=Mt(kt,"users",t.oderId);await Gt(k,{loginEvent:C}),await n(w.gems),r(C),u(w.gems),c(!0),Ee({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]})}catch(_){console.error("Error claiming reward:",_)}finally{o(!1)}},v=y=>i.claimedDays.includes(y)?"claimed":y===i.currentDay&&d()?"available":y<i.currentDay?"missed":"locked";return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a,onClose:()=>c(!1),title:"im danh thnh cng!",subtitle:"Phn thng ng nhp hng ngy",rewards:[{type:"gems",amount:h}],gradientFrom:"var(--duo-green)",gradientTo:"var(--duo-teal)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-teal)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-white",children:"ng nhp 7 ngy"}),l.jsx("p",{className:"text-white/80 text-sm",children:"Nhn thng mi ngy!"})]})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(AP,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("span",{className:"font-semibold text-foreground",children:"Tin "})]}),l.jsxs("span",{className:"text-sm text-[var(--muted-foreground)]",children:[i.claimedDays.length,"/7 ngy"]})]}),l.jsx("div",{className:"h-3 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-teal)] transition-all duration-500",style:{width:`${i.claimedDays.length/7*100}%`}})})]}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:TS.map(y=>{const w=v(y.day),_=y.special;return l.jsxs("button",{onClick:()=>f(y.day),disabled:w!=="available"||s,className:`card-3d relative p-4 ${_?"col-span-2":""} ${w==="available"||w==="claimed"?"border-2 border-[var(--duo-green)]":""}`,children:[w==="claimed"&&l.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-4 h-4 text-white"})}),w==="locked"&&l.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Ou,{className:"w-3 h-3 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:`flex ${_?"items-center gap-4":"flex-col items-center"}`,children:[l.jsx("div",{className:`${_?"w-16 h-16 flex-shrink-0":"w-12 h-12 mb-2"} rounded-xl flex items-center justify-center ${_?"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]":"bg-[var(--duo-blue)]/20"}`,children:_?l.jsx(Ue,{className:"w-8 h-8 text-white"}):l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"})}),l.jsxs("div",{className:_?"flex-1 text-left":"text-center",children:[l.jsx("p",{className:`font-bold ${_?"text-lg":"text-sm"} ${w==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:y.label}),l.jsxs("div",{className:`flex items-center gap-1 ${_?"":"justify-center"}`,children:[l.jsxs("span",{className:`font-bold ${_?"text-2xl":"text-lg"} ${_?"text-[var(--duo-orange)]":"text-[var(--duo-blue)]"}`,children:["+",y.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:_?"w-6 h-6":"w-4 h-4"})]}),_&&l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phn thng c bit!"})]})]}),w==="available"&&l.jsx("div",{className:`btn-3d btn-3d-green py-2 text-sm ${_?"mt-3":"mt-2"}`,children:"Nhn ngay!"})]},y.day)})}),l.jsx("div",{className:"mt-4 card-3d p-4",children:l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"ng nhp mi ngy  nhn thng. Nu b l 1 ngy, tin  s b reset!"})})]})]})}const ng=[{level:5,gems:500,label:"Cp 5"},{level:10,gems:1e3,label:"Cp 10",special:!0},{level:15,gems:1200,label:"Cp 15"},{level:20,gems:1500,label:"Cp 20",special:!0},{level:25,gems:1800,label:"Cp 25"},{level:30,gems:2500,label:"Cp 30",special:!0},{level:35,gems:2e3,label:"Cp 35"},{level:40,gems:3e3,label:"Cp 40",special:!0},{level:45,gems:2500,label:"Cp 45"},{level:50,gems:5e3,label:"Cp 50",special:!0,legendary:!0},{level:55,gems:3e3,label:"Cp 55"},{level:60,gems:4e3,label:"Cp 60",special:!0},{level:65,gems:3500,label:"Cp 65"},{level:70,gems:5e3,label:"Cp 70",special:!0},{level:75,gems:4500,label:"Cp 75"},{level:80,gems:6e3,label:"Cp 80",special:!0},{level:85,gems:5500,label:"Cp 85"},{level:90,gems:8e3,label:"Cp 90",special:!0},{level:95,gems:7e3,label:"Cp 95"},{level:100,gems:15e3,label:"Cp 100",special:!0,legendary:!0}];function fst(){const e=we(),{user:t,addGems:n}=Zt(),[i,r]=I.useState([]),[s,o]=I.useState(!1),[a,c]=I.useState(!1),[h,u]=I.useState(0);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const _=Mt(kt,"users",t.oderId),x=await Qr(_);if(x.exists()){const C=x.data();r(C.claimedLevelRewards||[])}}catch(_){console.error("Error loading claimed levels:",_)}})()},[t==null?void 0:t.oderId]);const d=w=>i.includes(w)?"claimed":((t==null?void 0:t.level)||1)>=w?"available":"locked",f=async w=>{if(!(t!=null&&t.oderId)||s||d(w)!=="available")return;o(!0);const _=ng.find(x=>x.level===w);if(_)try{const x=[...i,w],C=Mt(kt,"users",t.oderId);await Gt(C,{claimedLevelRewards:x}),await n(_.gems),r(x),u(_.gems),c(!0),Ee({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#ce82ff"]})}catch(x){console.error("Error claiming reward:",x)}finally{o(!1)}},v=i.length,y=ng.filter(w=>((t==null?void 0:t.level)||1)>=w.level&&!i.includes(w.level)).length;return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a,onClose:()=>c(!1),title:"Nhn thng thnh cng!",subtitle:"Phn thng cp ",rewards:[{type:"gems",amount:h}],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-pink)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h1",{className:"font-bold text-xl text-white",children:"Thng cp "}),l.jsx("p",{className:"text-white/80 text-sm",children:"Nhn qu khi ln cp!"})]}),y>0&&l.jsx("div",{className:"bg-[var(--duo-red)] px-3 py-1.5 rounded-full",children:l.jsx("span",{className:"text-white text-sm font-bold",children:y})})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-pink)] flex items-center justify-center",children:l.jsx(ge,{className:"w-7 h-7 text-white"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Cp  hin ti"}),l.jsx("p",{className:"font-bold text-2xl text-foreground",children:(t==null?void 0:t.level)||1})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:(t==null?void 0:t.gems)||0})]})]}),(()=>{const w=dX((t==null?void 0:t.exp)||0),_=w.current/w.required*100;return l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"EXP"}),l.jsxs("span",{className:"text-foreground font-medium",children:[w.current,"/",w.required]})]}),l.jsx("div",{className:"h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",style:{width:`${_}%`}})})]})})()]}),l.jsxs("div",{className:"flex gap-3 mb-4",children:[l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:v}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"})]}),l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-orange)]",children:y}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"C th nhn"})]}),l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--muted-foreground)]",children:ng.length-v-y}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cha m"})]})]}),l.jsx("div",{className:"space-y-3",children:ng.map(w=>{const _=d(w.level),x=w.special,C=w.legendary;return l.jsxs("button",{onClick:()=>f(w.level),disabled:_!=="available"||s,className:`card-3d w-full p-4 flex items-center gap-4 ${C?"border-2 border-[var(--duo-yellow)]":_==="available"||_==="claimed"?"border-2 border-[var(--duo-green)]":"opacity-60"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center ${C?"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]":x?"bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-pink)]":"bg-[var(--duo-blue)]/20"}`,children:C?l.jsx(Le,{className:"w-7 h-7 text-white"}):x?l.jsx(Ue,{className:"w-6 h-6 text-white"}):l.jsx("span",{className:"font-bold text-lg text-[var(--duo-blue)]",children:w.level})}),l.jsxs("div",{className:"flex-1 text-left",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:`font-bold ${_==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:w.label}),C&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-yellow)] text-black font-bold",children:"LEGENDARY"}),x&&!C&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-purple)] text-white",children:"c bit"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("span",{className:`font-bold text-lg ${C?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"}`,children:["+",w.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]})]}),_==="claimed"?l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-5 h-5 text-white"})}):_==="available"?l.jsx("div",{className:"btn-3d btn-3d-green px-4 py-2 text-sm",children:"Nhn"}):l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Ou,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]},w.level)})}),l.jsx("div",{className:"mt-4 card-3d p-4",children:l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Hon thnh quiz  nhn EXP v ln cp. EXP cn tng dn theo level!"})})]})]})}function mst(e){if(e<=0)return"ang reset...";const t=Math.floor(e/1e3),n=Math.floor(t/60),i=Math.floor(n/60),s=Math.floor(i/24),o=i%24,a=n%60,c=t%60;return s>0?`${s}n ${o}g ${a}p`:`${o}g ${a}p ${c}s`}function pst(){const e=we(),t=xb(),{currentFloor:n,highestFloor:i,claimedFloors:r,totalFloors:s,normalFloorsCount:o,activeFloor:a,currentQuestion:c,selectedAnswer:h,isAnswered:u,isCorrect:d,initTower:f,startFloor:v,selectAnswer:y,completeFloor:w,failFloor:_,claimReward:x,exitQuiz:C,resetTower:k,getNextResetTime:P}=t,{addGems:A,incrementDailyTowerFloors:M}=Zt(),[N,T]=I.useState(!1),[E,R]=I.useState(!1),[D,F]=I.useState(0),[L,lt]=I.useState(null),ht=I.useRef(null),[Y,K]=I.useState("");I.useEffect(()=>{f()},[]),I.useEffect(()=>{const G=()=>{const O=P()-Date.now();K(mst(O)),O<=0&&f()};G();const Q=setInterval(G,1e3);return()=>clearInterval(Q)},[P,f]),I.useEffect(()=>{s>0&&!a&&ht.current&&setTimeout(()=>{var G;(G=ht.current)==null||G.scrollIntoView({behavior:"smooth",block:"center"})},300)},[s,a]),I.useEffect(()=>{lt(null)},[a]);const U=()=>{!L||u||y(L)};I.useEffect(()=>{u&&a&&d&&Ee({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]})},[u,d,a]);const W=async()=>{if(d){const G=r.includes(a);w();const Q=x(a);Q>0&&await A(Q),G||await M(),!G&&Q>0?(F(Q),T(!0)):C()}else R(!0)},j=()=>{T(!1),F(0),C()},q=()=>{_(),R(!1)};if(a&&c)return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-4 pb-4 px-4 bg-background",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:()=>C(),className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(zr,{className:"w-5 h-5 text-[#8B5CF6]"}),l.jsxs("span",{className:"font-bold text-foreground",children:["Tng ",a,"/",s]})]}),r.includes(a)?l.jsx("div",{className:"w-10"}):l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold",children:["+",Bh(a)]})]})]})}),l.jsxs("div",{className:"px-4 pt-20 pb-24",children:[l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:c.question}),l.jsx("div",{className:"space-y-2.5",children:c.options.map(G=>{const Q=L===G.id,Z=h===G.id,O=G.id===c.correctAnswer,B=u&&O&&d,rt=u&&Z&&!O;return l.jsxs("button",{onClick:()=>!u&&lt(G.id),disabled:u,className:Vt("option-btn w-full p-3 text-left flex items-center gap-3",Q&&!u&&"selected",B&&"correct",rt&&"wrong"),children:[l.jsx("div",{className:Vt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",B&&"bg-[var(--duo-green)] text-white",rt&&"bg-[var(--duo-red)] text-white",!u&&!Q&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",Q&&!u&&"bg-[var(--duo-blue)] text-white"),children:B?l.jsx(Tr,{className:"w-4 h-4"}):rt?l.jsx($r,{className:"w-4 h-4"}):G.id}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:G.text})]},G.id)})})]}),l.jsx("div",{className:Vt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",u?d?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:u?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d?l.jsx(Tr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:Vt("font-bold text-xl",d?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:d?"Chnh xc!":"Sai mt ri!"})})]}),l.jsx("button",{onClick:W,className:Vt("btn-3d w-full py-3.5 text-base flex items-center justify-center gap-2",d?"btn-3d-green":"btn-3d-orange"),children:d?r.includes(a)?"TIP TC":l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),"NHN +",Bh(a)]}):"RT THP"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:U,disabled:!L,className:Vt("btn-3d w-full py-3.5 text-base",L?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})}),l.jsx(Gn,{isOpen:N,onClose:j,title:`Vt qua tng ${a}!`,subtitle:"Tip tc leo thp no!",rewards:[{type:"gems",amount:D}],gradientFrom:"#8B5CF6",gradientTo:"#A855F7"}),E&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsx("div",{className:"w-20 h-20 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(U_,{className:"w-10 h-10 text-[var(--duo-red)]"})})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Rt xung y thp!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Bn phi leo li t tng 1. Qu  nhn vn gi nguyn!"}),l.jsxs("button",{onClick:q,className:"w-full btn-3d btn-3d-purple py-3 font-bold",children:[l.jsx(du,{className:"w-4 h-4 mr-2 inline"}),"Leo li t u"]})]})})]});const J=r.length;return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-3 pb-3 px-4 bg-gradient-to-r from-[#8B5CF6] to-[#A855F7]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center shrink-0",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Thp Luyn Ngc"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("p",{className:"text-white/80 text-xs whitespace-nowrap",children:[s," tng"]}),l.jsxs("div",{className:"flex items-center gap-1 bg-white/20 rounded-lg px-2 py-0.5 shrink-0",children:[l.jsx(Uu,{className:"w-3 h-3 text-white shrink-0"}),l.jsx("span",{className:"text-white text-[10px] font-medium whitespace-nowrap",children:Y})]})]})]})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[#8B5CF6] to-[#A855F7] flex items-center justify-center",children:l.jsx(zr,{className:"w-7 h-7 text-white"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Tng hin ti"}),l.jsxs("p",{className:"font-bold text-2xl text-foreground",children:[n,"/",s]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Cao nht"}),l.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[l.jsx(ge,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-lg text-foreground",children:i})]})]})]}),l.jsx("div",{className:"mt-3 h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[#8B5CF6] to-[#A855F7] transition-all",style:{width:`${i/s*100}%`}})})]}),l.jsxs("div",{className:"flex gap-3 mb-4",children:[l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:J}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"})]}),l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[#8B5CF6]",children:i}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" vt"})]}),l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--muted-foreground)]",children:s-i}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cn li"})]})]}),l.jsx("div",{className:"space-y-2",children:Array.from({length:s},(G,Q)=>s-Q).map(G=>{const Q=G<=n,Z=G<=i,O=r.includes(G),B=G===n,rt=Bh(G),z=G%100===0||G%50===0||G%10===0,et=G===s,nt=G>o,mt=nt?G-o:0,Nt=nt&&mt%10===0;return l.jsxs("div",{ref:B?ht:null,className:Vt("card-3d p-3 flex items-center gap-3",et&&"border-2 border-[var(--duo-yellow)]",nt&&!et&&B&&"border-2 border-[#F97316]",nt&&!et&&!B&&Z&&"border-2 border-[#FB923C]",!nt&&B&&!et&&"border-2 border-[#8B5CF6]",!nt&&Z&&!B&&!et&&"border-2 border-[var(--duo-green)]",!Q&&"opacity-50"),children:[l.jsx("div",{className:Vt("w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",et&&"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]",nt&&!et&&(Nt||z)&&"bg-gradient-to-br from-[#F97316] to-[#FBBF24]",nt&&!et&&!Nt&&!z&&Z&&"bg-[#FB923C]",nt&&!et&&!Nt&&!z&&!Z&&"bg-[var(--secondary)]",!nt&&z&&!et&&"bg-gradient-to-br from-[#8B5CF6] to-[#A855F7]",!nt&&Z&&!z&&!et&&"bg-[var(--duo-green)]",!nt&&!Z&&!z&&!et&&"bg-[var(--secondary)]"),children:Z?l.jsx(In,{className:"w-6 h-6 text-white"}):l.jsx("span",{className:Vt("font-bold",z||et?"text-white":"text-foreground"),children:G})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:Vt("font-bold",nt&&B?"text-[#F97316]":"",!nt&&B?"text-[#8B5CF6]":"",B?"":"text-foreground"),children:nt?`EX ${mt}`:`Tng ${G}`}),et&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-yellow)] text-black font-bold",children:"NH"}),nt&&!et&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gradient-to-r from-[#F97316] to-[#FBBF24] text-white font-bold",children:"EX"}),!nt&&z&&!et&&G%50===0&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[#8B5CF6] text-white",children:"Mc"})]}),l.jsx("div",{className:"flex items-center gap-1",children:O?l.jsx("span",{className:"text-xs text-[var(--duo-green)]",children:" nhn thng"}):l.jsxs(l.Fragment,{children:[l.jsxs("span",{className:Vt("font-bold",et?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"),children:["+",rt]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]})})]}),Q&&B?l.jsxs("button",{onClick:()=>v(G),className:"btn-3d btn-3d-purple px-4 py-2 text-sm flex items-center gap-1",children:[l.jsx(sB,{className:"w-4 h-4"}),"Vo"]}):O?l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-5 h-5 text-white"})}):Q?null:l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Ou,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]},G)})}),l.jsx("div",{className:"mt-6 card-3d p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Ue,{className:"w-5 h-5 text-[var(--duo-yellow)] flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-[var(--muted-foreground)]",children:[l.jsx("p",{className:"font-semibold text-foreground mb-1",children:"Lut chi:"}),l.jsxs("ul",{className:"space-y-1",children:[l.jsx("li",{children:" Mi tng 1 cu hi, tr li ng  ln tng tip"}),l.jsx("li",{children:" Phn thng: Tng N = N x 10 gems"}),l.jsx("li",{children:" Sai 1 cu = Rt xung tng 1, leo li t u"}),l.jsx("li",{children:" Qu  nhn vn gi nguyn khi rt"}),l.jsx("li",{className:"text-[#8B5CF6] font-medium",children:" Reset v tng 1 mi th 2 hng tun"})]})]})]})}),i>0&&l.jsxs("button",{onClick:()=>{confirm("Bn c chc mun reset thp? Tin trnh s mt nhng qu  nhn vn gi!")&&k()},className:"w-full mt-4 py-3 text-[var(--muted-foreground)] text-sm",children:[l.jsx(du,{className:"w-4 h-4 mr-1 inline"}),"Reset thp (gi qu  nhn)"]})]})]})}const on={COST_PER_PULL:150,PULLS_SINGLE:1,PULLS_MULTI:10,PITY_UR:200,DUPLICATE_SHARDS:{40:50,30:10,20:1,10:1},RATES:{40:3,30:18,20:39,10:40},UR_EXCHANGE_COST:145},Tp={totalNCards:0,totalRCards:0,totalSRCards:0,totalURCards:0,totalAvatars:0,totalFrames:0,totalBadges:0,completedCollections:0},Qv={cards:{},rewards:[],shards:0,totalPulls:0,pityCounters:{},gachaStats:Tp};async function Ha(e){try{const t=Mt(kt,"users",e),n=await Qr(t);return n.exists()&&n.data().gachaInventory||Qv}catch(t){return console.error("Error getting gacha inventory:",t),Qv}}async function vst(e,t){try{const n=Mt(kt,"users",e);return await Gt(n,{gachaInventory:t}),!0}catch(n){return console.error("Error updating gacha inventory:",n),!1}}function yst(e,t){if(t>=on.PITY_UR-1){const a=e.filter(c=>c.card_scarcity===40);if(a.length>0)return{card:a[Math.floor(Math.random()*a.length)],resetPity:!0}}const n=Math.random()*100;let i=0,r=10;for(const[a,c]of Object.entries(on.RATES))if(i+=c,n<i){r=parseInt(a);break}let s=e.filter(a=>a.card_scarcity===r);s.length===0&&(s=e);const o=s[Math.floor(Math.random()*s.length)];return{card:o,resetPity:o.card_scarcity===40}}async function xst(e,t,n,i,r){const s=on.COST_PER_PULL*i;if(r<s)return{success:!1,results:[],newGems:r,newShards:0,error:"Khng  Gems!"};try{const o=await Ha(e),a=[];let c=0;o.cards[t]||(o.cards[t]={});const h=0;o.pityCounters[h]===void 0&&(o.pityCounters[h]=0);for(let y=0;y<i;y++){const{card:w,resetPity:_}=yst(n.item_list,o.pityCounters[h]),x=w.card_img,C=!o.cards[t][x];let k=0;if(C)switch(o.cards[t][x]=1,o.gachaStats||(o.gachaStats={...Tp}),w.card_scarcity){case 10:o.gachaStats.totalNCards++;break;case 20:o.gachaStats.totalRCards++;break;case 30:o.gachaStats.totalSRCards++;break;case 40:o.gachaStats.totalURCards++;break}else o.cards[t][x]++,k=on.DUPLICATE_SHARDS[w.card_scarcity]||5,c+=k;_?o.pityCounters[h]=0:o.pityCounters[h]++,a.push({cardImg:w.card_img,cardScarcity:w.card_scarcity,isNew:C,shardsGained:k,videoList:w.video_list,width:w.width,height:w.height})}o.shards+=c,o.totalPulls+=i;const u=Mt(kt,"users",e),d=r-s;await Gt(u,{gems:d,gachaInventory:o});const f=Zt.getState(),v=f.user;v&&Zt.setState({user:{...v,gems:d,gachaInventory:o}});try{await f.incrementDailyGachaPulls(i),await f.checkAchievements()}catch(y){console.warn("Failed to update gacha quest progress:",y)}return{success:!0,results:a,newGems:d,newShards:o.shards}}catch(o){return console.error("Error pulling gacha:",o),{success:!1,results:[],newGems:r,newShards:0,error:"C li xy ra!"}}}function _st(e,t,n){var i;return!!((i=e.cards[t])!=null&&i[n])}async function wst(e,t,n){try{const i=await Ha(e);i.gachaStats||(i.gachaStats={...Tp});for(const o of n){if(i.rewards.some(h=>h.collectionId===t&&h.image===o.redeem_item_image))continue;let c="badge";switch(o.redeem_item_type===1e3?c="avatar":o.redeem_item_type===3?c="frame":o.redeem_item_type===1001&&(c="badge"),i.rewards.push({type:c,image:o.redeem_item_image||"",name:o.redeem_item_name||"",obtainedAt:new Date().toISOString(),collectionId:t}),c){case"avatar":i.gachaStats.totalAvatars++;break;case"frame":i.gachaStats.totalFrames++;break;case"badge":i.gachaStats.totalBadges++;break}}const r=Mt(kt,"users",e);await Gt(r,{gachaInventory:i});const s=Zt.getState().user;return s&&Zt.setState({user:{...s,gachaInventory:i}}),!0}catch(i){return console.error("Error claiming all rewards:",i),!1}}function bst(e,t){return e.rewards.some(n=>n.collectionId===t)}async function Tst(e,t,n){var i;try{const r=await Ha(e),s=on.UR_EXCHANGE_COST;if((i=r.cards[t])!=null&&i[n])return{success:!1,error:"Bn  s hu th ny!"};if(r.shards<s)return{success:!1,error:`Khng  mnh! Cn ${s} mnh.`};r.shards-=s,r.cards[t]||(r.cards[t]={}),r.cards[t][n]=1,r.gachaStats||(r.gachaStats={...Tp}),r.gachaStats.totalURCards++;const o=Mt(kt,"users",e);await Gt(o,{gachaInventory:r});const a=Zt.getState().user;return a&&Zt.setState({user:{...a,gachaInventory:r}}),{success:!0,newShards:r.shards}}catch(r){return console.error("Error exchanging shards:",r),{success:!1,error:"C li xy ra!"}}}const Yv=6;function Cst(){const e=we(),[t]=EP(),{user:n}=Zt(),[i,r]=I.useState([]),[s,o]=I.useState(!0),[a,c]=I.useState(null),[h,u]=I.useState(null),[d,f]=I.useState({}),v=t.get("tab")||"all",y=parseInt(t.get("page")||"1",10),[w,_]=I.useState(v),[x,C]=I.useState(y),k="gacha_card_counts",P=24*60*60*1e3;I.useEffect(()=>{const K=localStorage.getItem(k);if(K)try{const U=JSON.parse(K);Date.now()-U.timestamp<P&&f(U.data)}catch{}},[]);const A=async()=>{try{o(!0),c(null);const K=await mq();r(K)}catch(K){console.error("Fetch error:",K),c("Khng th ti d liu")}finally{o(!1)}};I.useEffect(()=>{A()},[]),I.useEffect(()=>{n!=null&&n.oderId&&Ha(n.oderId).then(u)},[n==null?void 0:n.oderId]);const[M,N]=I.useState(!1);I.useEffect(()=>{M&&(C(1),N(!1))},[w,M]);const T=K=>{N(!0),_(K)},E=K=>{if(!h)return!1;const U=d[K]||0,W=h.cards[K]?Object.keys(h.cards[K]).length:0;return W>0&&W<U},R=K=>{if(!h)return!1;const U=d[K]||0,W=h.cards[K]?Object.keys(h.cards[K]).length:0;return U>0&&W>=U},D=I.useMemo(()=>{if(!h)return w==="all"?i:[];const K=h.bookmarked||[];switch(w){case"bookmarked":return i.filter(U=>K.includes(U.id));case"spinning":return i.filter(U=>E(U.id));case"completed":return i.filter(U=>R(U.id));case"all":default:return i.filter(U=>!K.includes(U.id)&&!E(U.id)&&!R(U.id))}},[i,h,w,d]),F=Math.ceil(D.length/Yv),L=(x-1)*Yv,lt=D.slice(L,L+Yv);I.useEffect(()=>{if(lt.length===0)return;(async()=>{const U=lt.filter(j=>d[j.id]===void 0).map(j=>j.id);if(U.length===0)return;const W={...d};await Promise.all(U.map(async j=>{try{const q=await ku(j);W[j]=q.reduce((J,G)=>{var Q;return J+(((Q=G.item_list)==null?void 0:Q.length)||0)},0)}catch{W[j]=0}})),f(W),localStorage.setItem(k,JSON.stringify({data:W,timestamp:Date.now()}))})()},[lt.map(K=>K.id).join(",")]);const ht=async(K,U)=>{if(U.stopPropagation(),!(n!=null&&n.oderId)||!h)return;const W=h.bookmarked||[];let j;W.includes(K)?j=W.filter(J=>J!==K):j=[...W,K];const q={...h,bookmarked:j};u(q),await vst(n.oderId,q)},Y=()=>{switch(w){case"bookmarked":return"from-[var(--duo-yellow)] to-[var(--duo-orange)]";case"spinning":return"from-[var(--duo-blue)] to-[var(--duo-purple)]";case"completed":return"from-[var(--duo-green)] to-[#10b981]";default:return"from-[#8b5cf6] to-[#ec4899]"}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r ${Y()}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xt,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Gacha"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"B su tp th s"})]}),l.jsx("div",{className:"fixed top-[116px] left-0 right-0 z-40 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>T("all"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${w==="all"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(nk,{className:"w-4 h-4"}),"Tt c"]}),l.jsxs("button",{onClick:()=>T("bookmarked"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${w==="bookmarked"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(pv,{className:"w-4 h-4"})," lu"]}),l.jsxs("button",{onClick:()=>T("spinning"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${w==="spinning"?"bg-[var(--duo-blue)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(ik,{className:"w-4 h-4"}),"ang quay"]}),l.jsxs("button",{onClick:()=>T("completed"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${w==="completed"?"bg-[var(--duo-green)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Tr,{className:"w-4 h-4"}),"Hon thnh"]})]})}),l.jsx("div",{className:"px-4 pt-[180px] pb-28",children:s?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(Li,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]}):a?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:a}),l.jsx("button",{onClick:A,className:"btn-3d btn-3d-purple px-4 py-2",children:"Th li"})]}):D.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[w==="all"?l.jsx(nk,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):w==="bookmarked"?l.jsx(pv,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):w==="spinning"?l.jsx(ik,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):l.jsx(Tr,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:w==="all"?"Tt c gi  c phn loi":w==="bookmarked"?"Cha c gi no c lu":w==="spinning"?"Cha c gi no ang quay":"Cha c gi no hon thnh"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-2 gap-3",children:lt.map(K=>{var J;const U=d[K.id]||0,W=h!=null&&h.cards[K.id]?Object.keys(h.cards[K.id]).length:0,j=U>0&&W>=U,q=(J=h==null?void 0:h.bookmarked)==null?void 0:J.includes(K.id);return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>e(`/gacha/${K.id}?tab=${w}&page=${x}`),className:"w-full rounded-xl overflow-hidden bg-[var(--secondary)] transition-transform hover:scale-105 active:scale-95 shadow-lg",children:[l.jsx("img",{src:ke(K.act_square_img,400),alt:"",className:"w-full h-auto",referrerPolicy:"no-referrer",loading:"lazy"}),W>0&&l.jsx("div",{className:`absolute top-2 left-2 px-2 py-1 rounded-lg text-xs font-bold ${j?"bg-[var(--duo-green)] text-white":"bg-black/60 text-white"}`,children:j?l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(In,{className:"w-3 h-3"}),"Xong"]}):`${W}/${U}`})]}),l.jsx("button",{onClick:G=>ht(K.id,G),className:`absolute top-2 right-2 p-1.5 rounded-lg transition-all ${q?"bg-[var(--duo-yellow)] text-white":"bg-black/60 text-white hover:bg-black/80"}`,children:q?l.jsx(uO,{className:"w-4 h-4"}):l.jsx(pv,{className:"w-4 h-4"})})]},K.id)})}),F>1&&l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[l.jsx("button",{onClick:()=>C(1),disabled:x===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(CO,{className:"w-4 h-4 text-foreground"})}),l.jsx("button",{onClick:()=>C(K=>Math.max(1,K-1)),disabled:x===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(j_,{className:"w-4 h-4 text-foreground"})}),l.jsxs("div",{className:"px-4 py-2 rounded-xl bg-[var(--duo-purple)] text-white font-bold text-sm",children:[x," / ",F]}),l.jsx("button",{onClick:()=>C(K=>Math.min(F,K+1)),disabled:x===F,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(sr,{className:"w-4 h-4 text-foreground"})}),l.jsx("button",{onClick:()=>C(F),disabled:x===F,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(NO,{className:"w-4 h-4 text-foreground"})})]})]})})]})}function _b({videoList:e,imageUrl:t,className:n="w-full h-full object-contain",imageSize:i=600,timeout:r=8e3,collectionId:s,lotteryId:o}){const[a,c]=I.useState("loading"),[h,u]=I.useState(null),d=I.useRef(null),f=I.useRef(null),v=e&&e.length>1&&e[1],y=h||(v?e[1]:null),w=ke(t,i),_=I.useCallback(async()=>{if(!s||!o||!t)return null;console.log("[VideoCard] Fetching fresh URL via proxy...");const A=await Qrt(s,o,t);return A&&(console.log("[VideoCard] Got fresh URL:",A.substring(0,60)+"..."),u(A)),A},[s,o,t]),x=I.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);I.useEffect(()=>{if(console.log("[VideoCard] Card changed, resetting state"),c("loading"),u(null),x(),!v){console.log("[VideoCard] No video, showing image:",t),c("error");return}console.log("[VideoCard] Loading video:",y);const A=setTimeout(()=>{c(M=>M==="loading"?(console.warn("[VideoCard] Timeout after",r,"ms:",y),"error"):M)},r);return()=>{clearTimeout(A),x()}},[y,t,v,r,x]);const C=I.useCallback(()=>{var A;x(),console.log("[VideoCard] Video can play:",y),c("playing"),(A=d.current)==null||A.play().catch(M=>{console.error("[VideoCard] Autoplay blocked:",M.message,y),c("error")})},[x,y]),k=I.useCallback(async A=>{const M=A.currentTarget,N=M.error;if((N==null?void 0:N.code)===1){console.log("[VideoCard] Load aborted (normal when switching cards):",y);return}console.error("[VideoCard] Video error:",{url:y,code:N==null?void 0:N.code,message:N==null?void 0:N.message,networkState:M.networkState,readyState:M.readyState}),!(!h&&s&&o&&(console.log("[VideoCard] Trying to fetch fresh URL..."),await _()))&&(x(),c("error"))},[x,y,h,s,o,_]),P=I.useCallback(()=>{console.log("[VideoCard] Data loaded, buffering:",y),x(),f.current=setTimeout(()=>{c(A=>A==="loading"?(console.warn("[VideoCard] Buffering timeout:",y),"error"):A)},3e3)},[x,y]);return!v||a==="error"?l.jsx("img",{src:w,alt:"",className:n,referrerPolicy:"no-referrer"}):l.jsx("video",{ref:d,className:n,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,poster:w,onCanPlay:C,onError:k,onLoadedData:P,children:l.jsx("source",{src:y,type:"video/mp4"})},y)}const wb=I.createContext({});function bb(e){const t=I.useRef(null);return t.current===null&&(t.current=e()),t.current}const xq=typeof window<"u",_q=xq?I.useLayoutEffect:I.useEffect,Cp=I.createContext(null);function Tb(e,t){e.indexOf(t)===-1&&e.push(t)}function Cb(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Xr=(e,t,n)=>n>t?t:n<e?e:n;let kb=()=>{};const Rs={},wq=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function bq(e){return typeof e=="object"&&e!==null}const Tq=e=>/^0[^.\s]+$/u.test(e);function Nb(e){let t;return()=>(t===void 0&&(t=e()),t)}const Gi=e=>e,kst=(e,t)=>n=>t(e(n)),od=(...e)=>e.reduce(kst),Nu=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i};class Eb{constructor(){this.subscriptions=[]}add(t){return Tb(this.subscriptions,t),()=>Cb(this.subscriptions,t)}notify(t,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,n,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vs=e=>e*1e3,ji=e=>e/1e3;function Cq(e,t){return t?e*(1e3/t):0}const kq=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Nst=1e-7,Est=12;function Sst(e,t,n,i,r){let s,o,a=0;do o=t+(n-t)/2,s=kq(o,i,r)-e,s>0?n=o:t=o;while(Math.abs(s)>Nst&&++a<Est);return o}function ad(e,t,n,i){if(e===t&&n===i)return Gi;const r=s=>Sst(s,0,1,e,n);return s=>s===0||s===1?s:kq(r(s),t,i)}const Nq=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Eq=e=>t=>1-e(1-t),Sq=ad(.33,1.53,.69,.99),Sb=Eq(Sq),Iq=Nq(Sb),Aq=e=>(e*=2)<1?.5*Sb(e):.5*(2-Math.pow(2,-10*(e-1))),Ib=e=>1-Math.sin(Math.acos(e)),Rq=Eq(Ib),Pq=Nq(Ib),Ist=ad(.42,0,1,1),Ast=ad(0,0,.58,1),Mq=ad(.42,0,.58,1),Rst=e=>Array.isArray(e)&&typeof e[0]!="number",Dq=e=>Array.isArray(e)&&typeof e[0]=="number",Pst={linear:Gi,easeIn:Ist,easeInOut:Mq,easeOut:Ast,circIn:Ib,circInOut:Pq,circOut:Rq,backIn:Sb,backInOut:Iq,backOut:Sq,anticipate:Aq},Mst=e=>typeof e=="string",CS=e=>{if(Dq(e)){kb(e.length===4);const[t,n,i,r]=e;return ad(t,n,i,r)}else if(Mst(e))return Pst[e];return e},ig=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Dst(e,t){let n=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(h.schedule(u),e()),u(a)}const h={schedule:(u,d=!1,f=!1)=>{const y=f&&r?n:i;return d&&o.add(u),y.has(u)||y.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(a=u,r){s=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,s&&(s=!1,h.process(u))}};return h}const Lst=40;function Lq(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=ig.reduce((k,P)=>(k[P]=Dst(s),k),{}),{setup:a,read:c,resolveKeyframes:h,preUpdate:u,update:d,preRender:f,render:v,postRender:y}=o,w=()=>{const k=Rs.useManualTiming?r.timestamp:performance.now();n=!1,Rs.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(k-r.timestamp,Lst),1)),r.timestamp=k,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),u.process(r),d.process(r),f.process(r),v.process(r),y.process(r),r.isProcessing=!1,n&&t&&(i=!1,e(w))},_=()=>{n=!0,i=!0,r.isProcessing||e(w)};return{schedule:ig.reduce((k,P)=>{const A=o[P];return k[P]=(M,N=!1,T=!1)=>(n||_(),A.schedule(M,N,T)),k},{}),cancel:k=>{for(let P=0;P<ig.length;P++)o[ig[P]].cancel(k)},state:r,steps:o}}const{schedule:xe,cancel:Do,state:xn,steps:Xv}=Lq(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gi,!0);let Dg;function Vst(){Dg=void 0}const Hn={now:()=>(Dg===void 0&&Hn.set(xn.isProcessing||Rs.useManualTiming?xn.timestamp:performance.now()),Dg),set:e=>{Dg=e,queueMicrotask(Vst)}},Vq=e=>t=>typeof t=="string"&&t.startsWith(e),qq=Vq("--"),qst=Vq("var(--"),Ab=e=>qst(e)?jst.test(e.split("/*")[0].trim()):!1,jst=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function kS(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Rl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Eu={...Rl,transform:e=>Xr(0,1,e)},rg={...Rl,default:1},Gh=e=>Math.round(e*1e5)/1e5,Rb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Fst(e){return e==null}const Ust=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Pb=(e,t)=>n=>!!(typeof n=="string"&&Ust.test(n)&&n.startsWith(e)||t&&!Fst(n)&&Object.prototype.hasOwnProperty.call(n,t)),jq=(e,t,n)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(Rb);return{[e]:parseFloat(r),[t]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Ost=e=>Xr(0,255,e),Jv={...Rl,transform:e=>Math.round(Ost(e))},la={test:Pb("rgb","red"),parse:jq("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+Jv.transform(e)+", "+Jv.transform(t)+", "+Jv.transform(n)+", "+Gh(Eu.transform(i))+")"};function Bst(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const v0={test:Pb("#"),parse:Bst,transform:la.transform},cd=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Qs=cd("deg"),Hr=cd("%"),yt=cd("px"),Gst=cd("vh"),Hst=cd("vw"),NS={...Hr,parse:e=>Hr.parse(e)/100,transform:e=>Hr.transform(e*100)},wc={test:Pb("hsl","hue"),parse:jq("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+Hr.transform(Gh(t))+", "+Hr.transform(Gh(n))+", "+Gh(Eu.transform(i))+")"},Ge={test:e=>la.test(e)||v0.test(e)||wc.test(e),parse:e=>la.test(e)?la.parse(e):wc.test(e)?wc.parse(e):v0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?la.transform(e):wc.transform(e),getAnimatableNone:e=>{const t=Ge.parse(e);return t.alpha=0,Ge.transform(t)}},$st=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function zst(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Rb))==null?void 0:t.length)||0)+(((n=e.match($st))==null?void 0:n.length)||0)>0}const Fq="number",Uq="color",Kst="var",Wst="var(",ES="${}",Qst=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Su(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=t.replace(Qst,c=>(Ge.test(c)?(i.color.push(s),r.push(Uq),n.push(Ge.parse(c))):c.startsWith(Wst)?(i.var.push(s),r.push(Kst),n.push(c)):(i.number.push(s),r.push(Fq),n.push(parseFloat(c))),++s,ES)).split(ES);return{values:n,split:a,indexes:i,types:r}}function Oq(e){return Su(e).values}function Bq(e){const{split:t,types:n}=Su(e),i=t.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=t[o],r[o]!==void 0){const a=n[o];a===Fq?s+=Gh(r[o]):a===Uq?s+=Ge.transform(r[o]):s+=r[o]}return s}}const Yst=e=>typeof e=="number"?0:Ge.test(e)?Ge.getAnimatableNone(e):e;function Xst(e){const t=Oq(e);return Bq(e)(t.map(Yst))}const Lo={test:zst,parse:Oq,createTransformer:Bq,getAnimatableNone:Xst};function Zv(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Jst({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let r=0,s=0,o=0;if(!t)r=s=o=n;else{const a=n<.5?n*(1+t):n+t-n*t,c=2*n-a;r=Zv(c,a,e+1/3),s=Zv(c,a,e),o=Zv(c,a,e-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function tm(e,t){return n=>n>0?t:e}const Ne=(e,t,n)=>e+(t-e)*n,ty=(e,t,n)=>{const i=e*e,r=n*(t*t-i)+i;return r<0?0:Math.sqrt(r)},Zst=[v0,la,wc],tot=e=>Zst.find(t=>t.test(e));function SS(e){const t=tot(e);if(!t)return!1;let n=t.parse(e);return t===wc&&(n=Jst(n)),n}const IS=(e,t)=>{const n=SS(e),i=SS(t);if(!n||!i)return tm(e,t);const r={...n};return s=>(r.red=ty(n.red,i.red,s),r.green=ty(n.green,i.green,s),r.blue=ty(n.blue,i.blue,s),r.alpha=Ne(n.alpha,i.alpha,s),la.transform(r))},y0=new Set(["none","hidden"]);function eot(e,t){return y0.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function not(e,t){return n=>Ne(e,t,n)}function Mb(e){return typeof e=="number"?not:typeof e=="string"?Ab(e)?tm:Ge.test(e)?IS:sot:Array.isArray(e)?Gq:typeof e=="object"?Ge.test(e)?IS:iot:tm}function Gq(e,t){const n=[...e],i=n.length,r=e.map((s,o)=>Mb(s)(s,t[o]));return s=>{for(let o=0;o<i;o++)n[o]=r[o](s);return n}}function iot(e,t){const n={...e,...t},i={};for(const r in n)e[r]!==void 0&&t[r]!==void 0&&(i[r]=Mb(e[r])(e[r],t[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}}function rot(e,t){const n=[],i={color:0,var:0,number:0};for(let r=0;r<t.values.length;r++){const s=t.types[r],o=e.indexes[s][i[s]],a=e.values[o]??0;n[r]=a,i[s]++}return n}const sot=(e,t)=>{const n=Lo.createTransformer(t),i=Su(e),r=Su(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?y0.has(e)&&!r.values.length||y0.has(t)&&!i.values.length?eot(e,t):od(Gq(rot(i,r),r.values),n):tm(e,t)};function Hq(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Ne(e,t,n):Mb(e)(e,t)}const oot=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>xe.update(t,n),stop:()=>Do(t),now:()=>xn.isProcessing?xn.timestamp:Hn.now()}},$q=(e,t,n=10)=>{let i="";const r=Math.max(Math.round(t/n),2);for(let s=0;s<r;s++)i+=Math.round(e(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},em=2e4;function Db(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<em;)t+=n,i=e.next(t);return t>=em?1/0:t}function aot(e,t=100,n){const i=n({...e,keyframes:[0,t]}),r=Math.min(Db(i),em);return{type:"keyframes",ease:s=>i.next(r*s).value/t,duration:ji(r)}}const cot=5;function zq(e,t,n){const i=Math.max(t-cot,0);return Cq(n-e(i),t-i)}const Me={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ey=.001;function lot({duration:e=Me.duration,bounce:t=Me.bounce,velocity:n=Me.velocity,mass:i=Me.mass}){let r,s,o=1-t;o=Xr(Me.minDamping,Me.maxDamping,o),e=Xr(Me.minDuration,Me.maxDuration,ji(e)),o<1?(r=h=>{const u=h*o,d=u*e,f=u-n,v=x0(h,o),y=Math.exp(-d);return ey-f/v*y},s=h=>{const d=h*o*e,f=d*n+n,v=Math.pow(o,2)*Math.pow(h,2)*e,y=Math.exp(-d),w=x0(Math.pow(h,2),o);return(-r(h)+ey>0?-1:1)*((f-v)*y)/w}):(r=h=>{const u=Math.exp(-h*e),d=(h-n)*e+1;return-ey+u*d},s=h=>{const u=Math.exp(-h*e),d=(n-h)*(e*e);return u*d});const a=5/e,c=uot(r,s,a);if(e=vs(e),isNaN(c))return{stiffness:Me.stiffness,damping:Me.damping,duration:e};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:e}}}const hot=12;function uot(e,t,n){let i=n;for(let r=1;r<hot;r++)i=i-e(i)/t(i);return i}function x0(e,t){return e*Math.sqrt(1-t*t)}const dot=["duration","bounce"],got=["stiffness","damping","mass"];function AS(e,t){return t.some(n=>e[n]!==void 0)}function fot(e){let t={velocity:Me.velocity,stiffness:Me.stiffness,damping:Me.damping,mass:Me.mass,isResolvedFromDuration:!1,...e};if(!AS(e,got)&&AS(e,dot))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,s=2*Xr(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:Me.mass,stiffness:r,damping:s}}else{const n=lot(e);t={...t,...n,mass:Me.mass},t.isResolvedFromDuration=!0}return t}function nm(e=Me.visualDuration,t=Me.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:u,duration:d,velocity:f,isResolvedFromDuration:v}=fot({...n,velocity:-ji(n.velocity||0)}),y=f||0,w=h/(2*Math.sqrt(c*u)),_=o-s,x=ji(Math.sqrt(c/u)),C=Math.abs(_)<5;i||(i=C?Me.restSpeed.granular:Me.restSpeed.default),r||(r=C?Me.restDelta.granular:Me.restDelta.default);let k;if(w<1){const A=x0(x,w);k=M=>{const N=Math.exp(-w*x*M);return o-N*((y+w*x*_)/A*Math.sin(A*M)+_*Math.cos(A*M))}}else if(w===1)k=A=>o-Math.exp(-x*A)*(_+(y+x*_)*A);else{const A=x*Math.sqrt(w*w-1);k=M=>{const N=Math.exp(-w*x*M),T=Math.min(A*M,300);return o-N*((y+w*x*_)*Math.sinh(T)+A*_*Math.cosh(T))/A}}const P={calculatedDuration:v&&d||null,next:A=>{const M=k(A);if(v)a.done=A>=d;else{let N=A===0?y:0;w<1&&(N=A===0?vs(y):zq(k,A,M));const T=Math.abs(N)<=i,E=Math.abs(o-M)<=r;a.done=T&&E}return a.value=a.done?o:M,a},toString:()=>{const A=Math.min(Db(P),em),M=$q(N=>P.next(A*N).value,A,30);return A+"ms "+M},toTransition:()=>{}};return P}nm.applyToOptions=e=>{const t=aot(e,100,nm);return e.ease=t.ease,e.duration=vs(t.duration),e.type="keyframes",e};function _0({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:u}){const d=e[0],f={done:!1,value:d},v=T=>a!==void 0&&T<a||c!==void 0&&T>c,y=T=>a===void 0?c:c===void 0||Math.abs(a-T)<Math.abs(c-T)?a:c;let w=n*t;const _=d+w,x=o===void 0?_:o(_);x!==_&&(w=x-d);const C=T=>-w*Math.exp(-T/i),k=T=>x+C(T),P=T=>{const E=C(T),R=k(T);f.done=Math.abs(E)<=h,f.value=f.done?x:R};let A,M;const N=T=>{v(f.value)&&(A=T,M=nm({keyframes:[f.value,y(f.value)],velocity:zq(k,T,f.value),damping:r,stiffness:s,restDelta:h,restSpeed:u}))};return N(0),{calculatedDuration:null,next:T=>{let E=!1;return!M&&A===void 0&&(E=!0,P(T),N(T)),A!==void 0&&T>=A?M.next(T-A):(!E&&P(T),f)}}}function mot(e,t,n){const i=[],r=n||Rs.mix||Hq,s=e.length-1;for(let o=0;o<s;o++){let a=r(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||Gi:t;a=od(c,a)}i.push(a)}return i}function pot(e,t,{clamp:n=!0,ease:i,mixer:r}={}){const s=e.length;if(kb(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=mot(t,i,r),c=a.length,h=u=>{if(o&&u<e[0])return t[0];let d=0;if(c>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=Nu(e[d],e[d+1],u);return a[d](f)};return n?u=>h(Xr(e[0],e[s-1],u)):h}function vot(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=Nu(0,t,i);e.push(Ne(n,1,r))}}function yot(e){const t=[0];return vot(t,e.length-1),t}function xot(e,t){return e.map(n=>n*t)}function _ot(e,t){return e.map(()=>t||Mq).splice(0,e.length-1)}function Hh({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const r=Rst(i)?i.map(CS):CS(i),s={done:!1,value:t[0]},o=xot(n&&n.length===t.length?n:yot(t),e),a=pot(o,t,{ease:Array.isArray(r)?r:_ot(t,r)});return{calculatedDuration:e,next:c=>(s.value=a(c),s.done=c>=e,s)}}const wot=e=>e!==null;function Lb(e,{repeat:t,repeatType:n="loop"},i,r=1){const s=e.filter(wot),a=r<0||t&&n!=="loop"&&t%2===1?0:s.length-1;return!a||i===void 0?s[a]:i}const bot={decay:_0,inertia:_0,tween:Hh,keyframes:Hh,spring:nm};function Kq(e){typeof e.type=="string"&&(e.type=bot[e.type])}class Vb{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const Tot=e=>e/100;class qb extends Vb{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:n}=this.options;n&&n.updatedAt!==Hn.now()&&this.tick(Hn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Kq(t);const{type:n=Hh,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=t;let{keyframes:a}=t;const c=n||Hh;c!==Hh&&typeof a[0]!="number"&&(this.mixKeyframes=od(Tot,Hq(a[0],a[1])),a=[0,100]);const h=c({...t,keyframes:a});s==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...a].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=Db(h));const{calculatedDuration:u}=h;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=h}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:h=0,keyframes:u,repeat:d,repeatType:f,repeatDelay:v,type:y,onUpdate:w,finalKeyframe:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-r/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-h*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?x<0:x>r;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let k=this.currentTime,P=i;if(d){const T=Math.min(this.currentTime,r)/a;let E=Math.floor(T),R=T%1;!R&&T>=1&&(R=1),R===1&&E--,E=Math.min(E,d+1),!!(E%2)&&(f==="reverse"?(R=1-R,v&&(R-=v/a)):f==="mirror"&&(P=o)),k=Xr(0,1,R)*a}const A=C?{done:!1,value:u[0]}:P.next(k);s&&(A.value=s(A.value));let{done:M}=A;!C&&c!==null&&(M=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return N&&y!==_0&&(A.value=Lb(u,this.options,_,this.speed)),w&&w(A.value),N&&this.finish(),A}then(t,n){return this.finished.then(t,n)}get duration(){return ji(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+ji(t)}get time(){return ji(this.currentTime)}set time(t){var n;t=vs(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Hn.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=ji(this.currentTime))}play(){var r,s;if(this.isStopped)return;const{driver:t=oot,startTime:n}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(s=(r=this.options).onPlay)==null||s.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Hn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function Cot(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const ha=e=>e*180/Math.PI,w0=e=>{const t=ha(Math.atan2(e[1],e[0]));return b0(t)},kot={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:w0,rotateZ:w0,skewX:e=>ha(Math.atan(e[1])),skewY:e=>ha(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},b0=e=>(e=e%360,e<0&&(e+=360),e),RS=w0,PS=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),MS=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Not={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:PS,scaleY:MS,scale:e=>(PS(e)+MS(e))/2,rotateX:e=>b0(ha(Math.atan2(e[6],e[5]))),rotateY:e=>b0(ha(Math.atan2(-e[2],e[0]))),rotateZ:RS,rotate:RS,skewX:e=>ha(Math.atan(e[4])),skewY:e=>ha(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function T0(e){return e.includes("scale")?1:0}function C0(e,t){if(!e||e==="none")return T0(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=Not,r=n;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=kot,r=a}if(!r)return T0(t);const s=i[t],o=r[1].split(",").map(Sot);return typeof s=="function"?s(o):o[s]}const Eot=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return C0(n,t)};function Sot(e){return parseFloat(e.trim())}const Pl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ml=new Set(Pl),DS=e=>e===Rl||e===yt,Iot=new Set(["x","y","z"]),Aot=Pl.filter(e=>!Iot.has(e));function Rot(e){const t=[];return Aot.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const ao={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>C0(t,"x"),y:(e,{transform:t})=>C0(t,"y")};ao.translateX=ao.x;ao.translateY=ao.y;const ma=new Set;let k0=!1,N0=!1,E0=!1;function Wq(){if(N0){const e=Array.from(ma).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const r=Rot(i);r.length&&(n.set(i,r),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))==null||a.set(o)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}N0=!1,k0=!1,ma.forEach(e=>e.complete(E0)),ma.clear()}function Qq(){ma.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(N0=!0)})}function Pot(){E0=!0,Qq(),Wq(),E0=!1}class jb{constructor(t,n,i,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ma.add(this),k0||(k0=!0,xe.read(Qq),xe.resolveKeyframes(Wq))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:r}=this;if(t[0]===null){const s=r==null?void 0:r.get(),o=t[t.length-1];if(s!==void 0)t[0]=s;else if(i&&n){const a=i.readValue(n,o);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=o),r&&s===void 0&&r.set(t[0])}Cot(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ma.delete(this)}cancel(){this.state==="scheduled"&&(ma.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Mot=e=>e.startsWith("--");function Dot(e,t,n){Mot(t)?e.style.setProperty(t,n):e.style[t]=n}const Lot=Nb(()=>window.ScrollTimeline!==void 0),Vot={};function qot(e,t){const n=Nb(e);return()=>Vot[t]??n()}const Yq=qot(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_h=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,LS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_h([0,.65,.55,1]),circOut:_h([.55,0,1,.45]),backIn:_h([.31,.01,.66,-.59]),backOut:_h([.33,1.53,.69,.99])};function Xq(e,t){if(e)return typeof e=="function"?Yq()?$q(e,t):"ease-out":Dq(e)?_h(e):Array.isArray(e)?e.map(n=>Xq(n,t)||LS.easeOut):LS[e]}function jot(e,t,n,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:c}={},h=void 0){const u={[t]:n};c&&(u.offset=c);const d=Xq(a,r);Array.isArray(d)&&(u.easing=d);const f={delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(f.pseudoElement=h),e.animate(u,f)}function Jq(e){return typeof e=="function"&&"applyToOptions"in e}function Fot({type:e,...t}){return Jq(e)&&Yq()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Uot extends Vb{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:n,name:i,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:c}=t;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=t,kb(typeof t.type!="string");const h=Fot(t);this.animation=jot(n,i,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=Lb(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):Dot(n,i,u),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,i;const t=((i=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:i.call(n).duration)||0;return ji(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+ji(t)}get time(){return ji(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=vs(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Lot()?(this.animation.timeline=t,Gi):n(this)}}const Zq={anticipate:Aq,backInOut:Iq,circInOut:Pq};function Oot(e){return e in Zq}function Bot(e){typeof e.ease=="string"&&Oot(e.ease)&&(e.ease=Zq[e.ease])}const ny=10;class Got extends Uot{constructor(t){Bot(t),Kq(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:i,onComplete:r,element:s,...o}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const a=new qb({...o,autoplay:!1}),c=Math.max(ny,Hn.now()-this.startTime),h=Xr(0,ny,c-ny);n.setWithVelocity(a.sample(Math.max(0,c-h)).value,a.sample(c).value,h),a.stop()}}const VS=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Lo.test(e)||e==="0")&&!e.startsWith("url("));function Hot(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function $ot(e,t,n,i){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],o=VS(r,t),a=VS(s,t);return!o||!a?!1:Hot(e)||(n==="spring"||Jq(n))&&i}function S0(e){e.duration=0,e.type="keyframes"}const zot=new Set(["opacity","clipPath","filter","transform"]),Kot=Nb(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Wot(e){var u;const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:s,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return Kot()&&n&&zot.has(n)&&(n!=="transform"||!h)&&!c&&!i&&r!=="mirror"&&s!==0&&o!=="inertia"}const Qot=40;class Yot extends Vb{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:c,motionValue:h,element:u,...d}){var y;super(),this.stop=()=>{var w,_;this._animation&&(this._animation.stop(),(w=this.stopTimeline)==null||w.call(this)),(_=this.keyframeResolver)==null||_.cancel()},this.createdAt=Hn.now();const f={autoplay:t,delay:n,type:i,repeat:r,repeatDelay:s,repeatType:o,name:c,motionValue:h,element:u,...d},v=(u==null?void 0:u.KeyframeResolver)||jb;this.keyframeResolver=new v(a,(w,_,x)=>this.onKeyframesResolved(w,_,f,!x),c,h,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,i,r){var _,x;this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:c,isHandoff:h,onUpdate:u}=i;this.resolvedAt=Hn.now(),$ot(t,s,o,a)||((Rs.instantAnimations||!c)&&(u==null||u(Lb(t,i,n))),t[0]=t[t.length-1],S0(i),i.repeat=0);const f={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Qot?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:t},v=!h&&Wot(f),y=(x=(_=f.motionValue)==null?void 0:_.owner)==null?void 0:x.current,w=v?new Got({...f,element:y}):new qb(f);w.finished.then(()=>{this.notifyFinished()}).catch(Gi),this.pendingTimeline&&(this.stopTimeline=w.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=w}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),Pot()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function t4(e,t,n,i=0,r=1){const s=Array.from(e).sort((h,u)=>h.sortNodePosition(u)).indexOf(t),o=e.size,a=(o-1)*i;return typeof n=="function"?n(s,o):r===1?s*i:a-s*i}const Xot=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Jot(e){const t=Xot.exec(e);if(!t)return[,];const[,n,i,r]=t;return[`--${n??i}`,r]}function e4(e,t,n=1){const[i,r]=Jot(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const o=s.trim();return wq(o)?parseFloat(o):o}return Ab(r)?e4(r,t,n+1):r}const Zot={type:"spring",stiffness:500,damping:25,restSpeed:10},tat=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),eat={type:"keyframes",duration:.8},nat={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},iat=(e,{keyframes:t})=>t.length>2?eat:Ml.has(e)?e.startsWith("scale")?tat(t[1]):Zot:nat,rat=e=>e!==null;function sat(e,{repeat:t,repeatType:n="loop"},i){const r=e.filter(rat),s=t&&n!=="loop"&&t%2===1?0:r.length-1;return r[s]}function Fb(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}function oat({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...u}){return!!Object.keys(u).length}const Ub=(e,t,n,i={},r,s)=>o=>{const a=Fb(i,e)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-vs(c);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-h,onUpdate:f=>{t.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:s?void 0:r};oat(a)||Object.assign(u,iat(e,u)),u.duration&&(u.duration=vs(u.duration)),u.repeatDelay&&(u.repeatDelay=vs(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(S0(u),u.delay===0&&(d=!0)),(Rs.instantAnimations||Rs.skipAnimations)&&(d=!0,S0(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&t.get()!==void 0){const f=sat(u.keyframes,a);if(f!==void 0){xe.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new qb(u):new Yot(u)};function qS(e){const t=[{},{}];return e==null||e.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function Ob(e,t,n,i){if(typeof t=="function"){const[r,s]=qS(i);t=t(n!==void 0?n:e.custom,r,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,s]=qS(i);t=t(n!==void 0?n:e.custom,r,s)}return t}function Bc(e,t,n){const i=e.getProps();return Ob(i,t,n!==void 0?n:i.custom,e)}const n4=new Set(["width","height","top","left","right","bottom",...Pl]),jS=30,aat=e=>!isNaN(parseFloat(e));class cat{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var s;const r=Hn.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Hn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=aat(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new Eb);const i=this.events[t].add(n);return t==="change"?()=>{i(),xe.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Hn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>jS)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,jS);return Cq(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cl(e,t){return new cat(e,t)}const I0=e=>Array.isArray(e);function lat(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,cl(n))}function hat(e){return I0(e)?e[e.length-1]||0:e}function uat(e,t){const n=Bc(e,t);let{transitionEnd:i={},transition:r={},...s}=n||{};s={...s,...i};for(const o in s){const a=hat(s[o]);lat(e,o,a)}}const Vn=e=>!!(e&&e.getVelocity);function dat(e){return!!(Vn(e)&&e.add)}function A0(e,t){const n=e.getValue("willChange");if(dat(n))return n.add(t);if(!n&&Rs.WillChange){const i=new Rs.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function Bb(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const gat="framerAppearId",i4="data-"+Bb(gat);function r4(e){return e.props[i4]}function fat({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function s4(e,t,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:o,...a}=t;i&&(s=i);const c=[],h=r&&e.animationState&&e.animationState.getState()[r];for(const u in a){const d=e.getValue(u,e.latestValues[u]??null),f=a[u];if(f===void 0||h&&fat(h,u))continue;const v={delay:n,...Fb(s||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(f)&&f===y&&!v.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const x=r4(e);if(x){const C=window.MotionHandoffAnimation(x,u,xe);C!==null&&(v.startTime=C,w=!0)}}A0(e,u),d.start(Ub(u,d,f,e.shouldReduceMotion&&n4.has(u)?{type:!1}:v,e,w));const _=d.animation;_&&c.push(_)}return o&&Promise.all(c).then(()=>{xe.update(()=>{o&&uat(e,o)})}),c}function R0(e,t,n={}){var c;const i=Bc(e,t,n.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(s4(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=r;return mat(e,t,h,u,d,f,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[h,u]=a==="beforeChildren"?[s,o]:[o,s];return h().then(()=>u())}else return Promise.all([s(),o(n.delay)])}function mat(e,t,n=0,i=0,r=0,s=1,o){const a=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),a.push(R0(c,t,{...o,delay:n+(typeof i=="function"?0:i)+t4(e.variantChildren,c,i,r,s)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(a)}function pat(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const r=t.map(s=>R0(e,s,n));i=Promise.all(r)}else if(typeof t=="string")i=R0(e,t,n);else{const r=typeof t=="function"?Bc(e,t,n.custom):t;i=Promise.all(s4(e,r,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}const vat={test:e=>e==="auto",parse:e=>e},o4=e=>t=>t.test(e),a4=[Rl,yt,Hr,Qs,Hst,Gst,vat],FS=e=>a4.find(o4(e));function yat(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Tq(e):!0}const xat=new Set(["brightness","contrast","saturate","opacity"]);function _at(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(Rb)||[];if(!i)return e;const r=n.replace(i,"");let s=xat.has(t)?1:0;return i!==n&&(s*=100),t+"("+s+r+")"}const wat=/\b([a-z-]*)\(.*?\)/gu,P0={...Lo,getAnimatableNone:e=>{const t=e.match(wat);return t?t.map(_at).join(" "):e}},US={...Rl,transform:Math.round},bat={rotate:Qs,rotateX:Qs,rotateY:Qs,rotateZ:Qs,scale:rg,scaleX:rg,scaleY:rg,scaleZ:rg,skew:Qs,skewX:Qs,skewY:Qs,distance:yt,translateX:yt,translateY:yt,translateZ:yt,x:yt,y:yt,z:yt,perspective:yt,transformPerspective:yt,opacity:Eu,originX:NS,originY:NS,originZ:yt},Gb={borderWidth:yt,borderTopWidth:yt,borderRightWidth:yt,borderBottomWidth:yt,borderLeftWidth:yt,borderRadius:yt,radius:yt,borderTopLeftRadius:yt,borderTopRightRadius:yt,borderBottomRightRadius:yt,borderBottomLeftRadius:yt,width:yt,maxWidth:yt,height:yt,maxHeight:yt,top:yt,right:yt,bottom:yt,left:yt,inset:yt,insetBlock:yt,insetBlockStart:yt,insetBlockEnd:yt,insetInline:yt,insetInlineStart:yt,insetInlineEnd:yt,padding:yt,paddingTop:yt,paddingRight:yt,paddingBottom:yt,paddingLeft:yt,paddingBlock:yt,paddingBlockStart:yt,paddingBlockEnd:yt,paddingInline:yt,paddingInlineStart:yt,paddingInlineEnd:yt,margin:yt,marginTop:yt,marginRight:yt,marginBottom:yt,marginLeft:yt,marginBlock:yt,marginBlockStart:yt,marginBlockEnd:yt,marginInline:yt,marginInlineStart:yt,marginInlineEnd:yt,backgroundPositionX:yt,backgroundPositionY:yt,...bat,zIndex:US,fillOpacity:Eu,strokeOpacity:Eu,numOctaves:US},Tat={...Gb,color:Ge,backgroundColor:Ge,outlineColor:Ge,fill:Ge,stroke:Ge,borderColor:Ge,borderTopColor:Ge,borderRightColor:Ge,borderBottomColor:Ge,borderLeftColor:Ge,filter:P0,WebkitFilter:P0},c4=e=>Tat[e];function l4(e,t){let n=c4(e);return n!==P0&&(n=Lo),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Cat=new Set(["auto","none","0"]);function kat(e,t,n){let i=0,r;for(;i<e.length&&!r;){const s=e[i];typeof s=="string"&&!Cat.has(s)&&Su(s).values.length&&(r=e[i]),i++}if(r&&n)for(const s of t)e[s]=l4(n,r)}class Nat extends jb{constructor(t,n,i,r,s){super(t,n,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let d=t[u];if(typeof d=="string"&&(d=d.trim(),Ab(d))){const f=e4(d,n.current);f!==void 0&&(t[u]=f),u===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!n4.has(i)||t.length!==2)return;const[r,s]=t,o=FS(r),a=FS(s),c=kS(r),h=kS(s);if(c!==h&&ao[i]){this.needsMeasurement=!0;return}if(o!==a)if(DS(o)&&DS(a))for(let u=0;u<t.length;u++){const d=t[u];typeof d=="string"&&(t[u]=parseFloat(d))}else ao[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let r=0;r<t.length;r++)(t[r]===null||yat(t[r]))&&i.push(r);i.length&&kat(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ao[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&t.getValue(i,r).jump(r,!1)}measureEndState(){var a;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=ao[n](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}function Eat(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const r=(n==null?void 0:n[e])??i.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}const h4=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function u4(e){return bq(e)&&"offsetHeight"in e}const{schedule:Hb}=Lq(queueMicrotask,!1),ir={x:!1,y:!1};function d4(){return ir.x||ir.y}function Sat(e){return e==="x"||e==="y"?ir[e]?null:(ir[e]=!0,()=>{ir[e]=!1}):ir.x||ir.y?null:(ir.x=ir.y=!0,()=>{ir.x=ir.y=!1})}function g4(e,t){const n=Eat(e),i=new AbortController,r={passive:!0,...t,signal:i.signal};return[n,r,()=>i.abort()]}function OS(e){return!(e.pointerType==="touch"||d4())}function Iat(e,t,n={}){const[i,r,s]=g4(e,n),o=a=>{if(!OS(a))return;const{target:c}=a,h=t(c,a);if(typeof h!="function"||!c)return;const u=d=>{OS(d)&&(h(d),c.removeEventListener("pointerleave",u))};c.addEventListener("pointerleave",u,r)};return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const f4=(e,t)=>t?e===t?!0:f4(e,t.parentElement):!1,$b=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Aat=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function m4(e){return Aat.has(e.tagName)||e.isContentEditable===!0}const Lg=new WeakSet;function BS(e){return t=>{t.key==="Enter"&&e(t)}}function iy(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Rat=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=BS(()=>{if(Lg.has(n))return;iy(n,"down");const r=BS(()=>{iy(n,"up")}),s=()=>iy(n,"cancel");n.addEventListener("keyup",r,t),n.addEventListener("blur",s,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function GS(e){return $b(e)&&!d4()}function Pat(e,t,n={}){const[i,r,s]=g4(e,n),o=a=>{const c=a.currentTarget;if(!GS(a))return;Lg.add(c);const h=t(c,a),u=(v,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",f),Lg.has(c)&&Lg.delete(c),GS(v)&&typeof h=="function"&&h(v,{success:y})},d=v=>{u(v,c===window||c===document||n.useGlobalTarget||f4(c,v.target))},f=v=>{u(v,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",f,r)};return i.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),u4(a)&&(a.addEventListener("focus",h=>Rat(h,r)),!m4(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function p4(e){return bq(e)&&"ownerSVGElement"in e}function Mat(e){return p4(e)&&e.tagName==="svg"}const Dat=[...a4,Ge,Lo],Lat=e=>Dat.find(o4(e)),HS=()=>({translate:0,scale:1,origin:0,originPoint:0}),bc=()=>({x:HS(),y:HS()}),$S=()=>({min:0,max:0}),Je=()=>({x:$S(),y:$S()}),M0={current:null},v4={current:!1},Vat=typeof window<"u";function qat(){if(v4.current=!0,!!Vat)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>M0.current=e.matches;e.addEventListener("change",t),t()}else M0.current=!1}const jat=new WeakMap;function kp(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Iu(e){return typeof e=="string"||Array.isArray(e)}const zb=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Kb=["initial",...zb];function Np(e){return kp(e.animate)||Kb.some(t=>Iu(e[t]))}function y4(e){return!!(Np(e)||e.variants)}function Fat(e,t,n){for(const i in t){const r=t[i],s=n[i];if(Vn(r))e.addValue(i,r);else if(Vn(s))e.addValue(i,cl(r,{owner:e}));else if(s!==r)if(e.hasValue(i)){const o=e.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(i);e.addValue(i,cl(o!==void 0?o:r,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const zS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let im={};function x4(e){im=e}function Uat(){return im}class Oat{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=jb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Hn.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,xe.render(this.render,!1,!0))};const{latestValues:c,renderState:h}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=h,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=Np(n),this.isVariantNode=y4(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const v=d[f];c[f]!==void 0&&Vn(v)&&v.set(c[f])}}mount(t){var n;this.current=t,jat.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(v4.current||qat(),this.shouldReduceMotion=M0.current),(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Do(this.notifyUpdate),Do(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const i=this.features[n];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=Ml.has(t);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&xe.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;typeof window<"u"&&window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{r(),s&&s(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in im){const n=im[t];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[t]&&r&&i(this.props)&&(this.features[t]=new r(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Je()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<zS.length;i++){const r=zS[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=t[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Fat(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=cl(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(wq(i)||Tq(i))?i=parseFloat(i):!Lat(i)&&Lo.test(n)&&(i=l4(t,n)),this.setBaseTarget(t,Vn(i)?i.get():i)),Vn(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const o=Ob(this.props,n,(s=this.presenceContext)==null?void 0:s.custom);o&&(i=o[t])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,t);return r!==void 0&&!Vn(r)?r:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new Eb),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){Hb.render(this.render)}}class _4 extends Oat{constructor(){super(...arguments),this.KeyframeResolver=Nat}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){const i=t.style;return i?i[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Vn(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class Go{constructor(t){this.isMounted=!1,this.node=t}update(){}}function w4({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function Bat({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Gat(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function ry(e){return e===void 0||e===1}function D0({scale:e,scaleX:t,scaleY:n}){return!ry(e)||!ry(t)||!ry(n)}function na(e){return D0(e)||b4(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function b4(e){return KS(e.x)||KS(e.y)}function KS(e){return e&&e!=="0%"}function rm(e,t,n){const i=e-n,r=t*i;return n+r}function WS(e,t,n,i,r){return r!==void 0&&(e=rm(e,r,i)),rm(e,n,i)+t}function L0(e,t=0,n=1,i,r){e.min=WS(e.min,t,n,i,r),e.max=WS(e.max,t,n,i,r)}function T4(e,{x:t,y:n}){L0(e.x,t.translate,t.scale,t.originPoint),L0(e.y,n.translate,n.scale,n.originPoint)}const QS=.999999999999,YS=1.0000000000001;function Hat(e,t,n,i=!1){const r=n.length;if(!r)return;t.x=t.y=1;let s,o;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Cc(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,T4(e,o)),i&&na(s.latestValues)&&Cc(e,s.latestValues))}t.x<YS&&t.x>QS&&(t.x=1),t.y<YS&&t.y>QS&&(t.y=1)}function Tc(e,t){e.min=e.min+t,e.max=e.max+t}function XS(e,t,n,i,r=.5){const s=Ne(e.min,e.max,r);L0(e,t,n,s,i)}function Cc(e,t){XS(e.x,t.x,t.scaleX,t.scale,t.originX),XS(e.y,t.y,t.scaleY,t.scale,t.originY)}function C4(e,t){return w4(Gat(e.getBoundingClientRect(),t))}function $at(e,t,n){const i=C4(e,n),{scroll:r}=t;return r&&(Tc(i.x,r.offset.x),Tc(i.y,r.offset.y)),i}const zat={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Kat=Pl.length;function Wat(e,t,n){let i="",r=!0;for(let s=0;s<Kat;s++){const o=Pl[s],a=e[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||n){const h=h4(a,Gb[o]);if(!c){r=!1;const u=zat[o]||o;i+=`${u}(${h}) `}n&&(t[o]=h)}}return i=i.trim(),n?i=n(t,r?"":i):r&&(i="none"),i}function Wb(e,t,n){const{style:i,vars:r,transformOrigin:s}=e;let o=!1,a=!1;for(const c in t){const h=t[c];if(Ml.has(c)){o=!0;continue}else if(qq(c)){r[c]=h;continue}else{const u=h4(h,Gb[c]);c.startsWith("origin")?(a=!0,s[c]=u):i[c]=u}}if(t.transform||(o||n?i.transform=Wat(t,e.transform,n):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:u=0}=s;i.transformOrigin=`${c} ${h} ${u}`}}function k4(e,{style:t,vars:n},i,r){const s=e.style;let o;for(o in t)s[o]=t[o];r==null||r.applyProjectionStyles(s,i);for(o in n)s.setProperty(o,n[o])}function JS(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const uh={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(yt.test(e))e=parseFloat(e);else return e;const n=JS(e,t.target.x),i=JS(e,t.target.y);return`${n}% ${i}%`}},Qat={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,r=Lo.parse(e);if(r.length>5)return i;const s=Lo.createTransformer(e),o=typeof r[0]!="number"?1:0,a=n.x.scale*t.x,c=n.y.scale*t.y;r[0+o]/=a,r[1+o]/=c;const h=Ne(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}},V0={borderRadius:{...uh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:uh,borderTopRightRadius:uh,borderBottomLeftRadius:uh,borderBottomRightRadius:uh,boxShadow:Qat};function N4(e,{layout:t,layoutId:n}){return Ml.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!V0[e]||e==="opacity")}function Qb(e,t,n){var o;const i=e.style,r=t==null?void 0:t.style,s={};if(!i)return s;for(const a in i)(Vn(i[a])||r&&Vn(r[a])||N4(a,e)||((o=n==null?void 0:n.getValue(a))==null?void 0:o.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function Yat(e){return window.getComputedStyle(e)}class Xat extends _4{constructor(){super(...arguments),this.type="html",this.renderInstance=k4}readValueFromInstance(t,n){var i;if(Ml.has(n))return(i=this.projection)!=null&&i.isProjecting?T0(n):Eot(t,n);{const r=Yat(t),s=(qq(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return C4(t,n)}build(t,n,i){Wb(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return Qb(t,n,i)}}const Jat={offset:"stroke-dashoffset",array:"stroke-dasharray"},Zat={offset:"strokeDashoffset",array:"strokeDasharray"};function tct(e,t,n=1,i=0,r=!0){e.pathLength=1;const s=r?Jat:Zat;e[s.offset]=yt.transform(-i);const o=yt.transform(t),a=yt.transform(n);e[s.array]=`${o} ${a}`}const ect=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function E4(e,{attrX:t,attrY:n,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},c,h,u){if(Wb(e,a,h),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f}=e;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox);for(const v of ect)d[v]!==void 0&&(f[v]=d[v],delete d[v]);t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),i!==void 0&&(d.scale=i),r!==void 0&&tct(d,r,s,o,!1)}const S4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),I4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function nct(e,t,n,i){k4(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(S4.has(r)?r:Bb(r),t.attrs[r])}function A4(e,t,n){const i=Qb(e,t,n);for(const r in e)if(Vn(e[r])||Vn(t[r])){const s=Pl.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=e[r]}return i}class ict extends _4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Je}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Ml.has(n)){const i=c4(n);return i&&i.default||0}return n=S4.has(n)?n:Bb(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return A4(t,n,i)}build(t,n,i){E4(t,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,n,i,r){nct(t,n,i,r)}mount(t){this.isSVGTag=I4(t.tagName),super.mount(t)}}const rct=Kb.length;function R4(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?R4(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<rct;n++){const i=Kb[n],r=e.props[i];(Iu(r)||r===!1)&&(t[i]=r)}return t}function P4(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}const sct=[...zb].reverse(),oct=zb.length;function act(e){return t=>Promise.all(t.map(({animation:n,options:i})=>pat(e,n,i)))}function cct(e){let t=act(e),n=ZS(),i=!0;const r=c=>(h,u)=>{var f;const d=Bc(e,u,c==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(d){const{transition:v,transitionEnd:y,...w}=d;h={...h,...w,...y}}return h};function s(c){t=c(e)}function o(c){const{props:h}=e,u=R4(e.parent)||{},d=[],f=new Set;let v={},y=1/0;for(let _=0;_<oct;_++){const x=sct[_],C=n[x],k=h[x]!==void 0?h[x]:u[x],P=Iu(k),A=x===c?C.isActive:null;A===!1&&(y=_);let M=k===u[x]&&k!==h[x]&&P;if(M&&i&&e.manuallyAnimateOnMount&&(M=!1),C.protectedKeys={...v},!C.isActive&&A===null||!k&&!C.prevProp||kp(k)||typeof k=="boolean")continue;const N=lct(C.prevProp,k);let T=N||x===c&&C.isActive&&!M&&P||_>y&&P,E=!1;const R=Array.isArray(k)?k:[k];let D=R.reduce(r(x),{});A===!1&&(D={});const{prevResolvedValues:F={}}=C,L={...F,...D},lt=K=>{T=!0,f.has(K)&&(E=!0,f.delete(K)),C.needsAnimating[K]=!0;const U=e.getValue(K);U&&(U.liveStyle=!1)};for(const K in L){const U=D[K],W=F[K];if(v.hasOwnProperty(K))continue;let j=!1;I0(U)&&I0(W)?j=!P4(U,W):j=U!==W,j?U!=null?lt(K):f.add(K):U!==void 0&&f.has(K)?lt(K):C.protectedKeys[K]=!0}C.prevProp=k,C.prevResolvedValues=D,C.isActive&&(v={...v,...D}),i&&e.blockInitialAnimation&&(T=!1);const ht=M&&N;T&&(!ht||E)&&d.push(...R.map(K=>{const U={type:x};if(typeof K=="string"&&i&&!ht&&e.manuallyAnimateOnMount&&e.parent){const{parent:W}=e,j=Bc(W,K);if(W.enteringChildren&&j){const{delayChildren:q}=j.transition||{};U.delay=t4(W.enteringChildren,e,q)}}return{animation:K,options:U}}))}if(f.size){const _={};if(typeof h.initial!="boolean"){const x=Bc(e,Array.isArray(h.initial)?h.initial[0]:h.initial);x&&x.transition&&(_.transition=x.transition)}f.forEach(x=>{const C=e.getBaseTarget(x),k=e.getValue(x);k&&(k.liveStyle=!0),_[x]=C??null}),d.push({animation:_})}let w=!!d.length;return i&&(h.initial===!1||h.initial===h.animate)&&!e.manuallyAnimateOnMount&&(w=!1),i=!1,w?t(d):Promise.resolve()}function a(c,h){var d;if(n[c].isActive===h)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(f=>{var v;return(v=f.animationState)==null?void 0:v.setActive(c,h)}),n[c].isActive=h;const u=o(c);for(const f in n)n[f].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=ZS()}}}function lct(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!P4(t,e):!1}function Yo(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ZS(){return{animate:Yo(!0),whileInView:Yo(),whileHover:Yo(),whileTap:Yo(),whileDrag:Yo(),whileFocus:Yo(),exit:Yo()}}function tI(e,t){e.min=t.min,e.max=t.max}function nr(e,t){tI(e.x,t.x),tI(e.y,t.y)}function eI(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const M4=1e-4,hct=1-M4,uct=1+M4,D4=.01,dct=0-D4,gct=0+D4;function $n(e){return e.max-e.min}function fct(e,t,n){return Math.abs(e-t)<=n}function nI(e,t,n,i=.5){e.origin=i,e.originPoint=Ne(t.min,t.max,e.origin),e.scale=$n(n)/$n(t),e.translate=Ne(n.min,n.max,e.origin)-e.originPoint,(e.scale>=hct&&e.scale<=uct||isNaN(e.scale))&&(e.scale=1),(e.translate>=dct&&e.translate<=gct||isNaN(e.translate))&&(e.translate=0)}function $h(e,t,n,i){nI(e.x,t.x,n.x,i?i.originX:void 0),nI(e.y,t.y,n.y,i?i.originY:void 0)}function iI(e,t,n){e.min=n.min+t.min,e.max=e.min+$n(t)}function mct(e,t,n){iI(e.x,t.x,n.x),iI(e.y,t.y,n.y)}function rI(e,t,n){e.min=t.min-n.min,e.max=e.min+$n(t)}function sm(e,t,n){rI(e.x,t.x,n.x),rI(e.y,t.y,n.y)}function sI(e,t,n,i,r){return e-=t,e=rm(e,1/n,i),r!==void 0&&(e=rm(e,1/r,i)),e}function pct(e,t=0,n=1,i=.5,r,s=e,o=e){if(Hr.test(t)&&(t=parseFloat(t),t=Ne(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=Ne(s.min,s.max,i);e===s&&(a-=t),e.min=sI(e.min,t,n,a,r),e.max=sI(e.max,t,n,a,r)}function oI(e,t,[n,i,r],s,o){pct(e,t[n],t[i],t[r],t.scale,s,o)}const vct=["x","scaleX","originX"],yct=["y","scaleY","originY"];function aI(e,t,n,i){oI(e.x,t,vct,n?n.x:void 0,i?i.x:void 0),oI(e.y,t,yct,n?n.y:void 0,i?i.y:void 0)}function cI(e){return e.translate===0&&e.scale===1}function L4(e){return cI(e.x)&&cI(e.y)}function lI(e,t){return e.min===t.min&&e.max===t.max}function xct(e,t){return lI(e.x,t.x)&&lI(e.y,t.y)}function hI(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function V4(e,t){return hI(e.x,t.x)&&hI(e.y,t.y)}function uI(e){return $n(e.x)/$n(e.y)}function dI(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Ai(e){return[e("x"),e("y")]}function _ct(e,t,n){let i="";const r=e.x.translate/t.x,s=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:h,rotate:u,rotateX:d,rotateY:f,skewX:v,skewY:y}=n;h&&(i=`perspective(${h}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),f&&(i+=`rotateY(${f}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=e.x.scale*t.x,c=e.y.scale*t.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const q4=["TopLeft","TopRight","BottomLeft","BottomRight"],wct=q4.length,gI=e=>typeof e=="string"?parseFloat(e):e,fI=e=>typeof e=="number"||yt.test(e);function bct(e,t,n,i,r,s){r?(e.opacity=Ne(0,n.opacity??1,Tct(i)),e.opacityExit=Ne(t.opacity??1,0,Cct(i))):s&&(e.opacity=Ne(t.opacity??1,n.opacity??1,i));for(let o=0;o<wct;o++){const a=`border${q4[o]}Radius`;let c=mI(t,a),h=mI(n,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||fI(c)===fI(h)?(e[a]=Math.max(Ne(gI(c),gI(h),i),0),(Hr.test(h)||Hr.test(c))&&(e[a]+="%")):e[a]=h}(t.rotate||n.rotate)&&(e.rotate=Ne(t.rotate||0,n.rotate||0,i))}function mI(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Tct=j4(0,.5,Rq),Cct=j4(.5,.95,Gi);function j4(e,t,n){return i=>i<e?0:i>t?1:n(Nu(e,t,i))}function kct(e,t,n){const i=Vn(e)?e:cl(e);return i.start(Ub("",i,t,n)),i.animation}function Au(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}const Nct=(e,t)=>e.depth-t.depth;class Ect{constructor(){this.children=[],this.isDirty=!1}add(t){Tb(this.children,t),this.isDirty=!0}remove(t){Cb(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Nct),this.isDirty=!1,this.children.forEach(t)}}function Sct(e,t){const n=Hn.now(),i=({timestamp:r})=>{const s=r-n;s>=t&&(Do(i),e(s-t))};return xe.setup(i,!0),()=>Do(i)}function Vg(e){return Vn(e)?e.get():e}class Ict{constructor(){this.members=[]}add(t){Tb(this.members,t),t.scheduleRender()}remove(t){if(Cb(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(r=>t===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const qg={hasAnimatedSinceResize:!0,hasEverUpdated:!1},sy=["","X","Y","Z"],Act=1e3;let Rct=0;function oy(e,t,n,i){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),i&&(i[e]=0))}function F4(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=r4(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",xe,!(r||s))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&F4(i)}function U4({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=t==null?void 0:t()){this.id=Rct++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Dct),this.nodes.forEach(jct),this.nodes.forEach(Fct),this.nodes.forEach(Lct)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Ect)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Eb),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=p4(o)&&!Mat(o),this.instance=o;const{layoutId:a,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||a)&&(this.isLayoutDirty=!0),e){let u,d=0;const f=()=>this.root.updateBlockedByResize=!1;xe.read(()=>{d=window.innerWidth}),e(o,()=>{const v=window.innerWidth;v!==d&&(d=v,this.root.updateBlockedByResize=!0,u&&u(),u=Sct(f,250),qg.hasAnimatedSinceResize&&(qg.hasAnimatedSinceResize=!1,this.nodes.forEach(yI)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&h&&(a||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:f,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||h.getDefaultTransition()||Hct,{onLayoutAnimationStart:w,onLayoutAnimationComplete:_}=h.getProps(),x=!this.targetLayout||!V4(this.targetLayout,v),C=!d&&f;if(this.options.layoutRoot||this.resumeFrom||C||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...Fb(y,"layout"),onPlay:w,onComplete:_};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(u,C)}else d||yI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Do(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Uct),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&F4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(vI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(qct),this.nodes.forEach(Pct),this.nodes.forEach(Mct)):this.nodes.forEach(vI),this.clearAllSnapshots();const a=Hn.now();xn.delta=Xr(0,1e3/60,a-xn.timestamp),xn.timestamp=a,xn.isProcessing=!0,Xv.update.process(xn),Xv.preRender.process(xn),Xv.render.process(xn),xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Hb.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Vct),this.sharedNodes.forEach(Oct)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!$n(this.snapshot.measuredBox.x)&&!$n(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Je(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!L4(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,u=h!==this.prevTransformTemplateValue;o&&this.instance&&(a||na(this.latestValues)||u)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),$ct(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return Je();const a=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(zct))){const{scroll:u}=this.root;u&&(Tc(a.x,u.offset.x),Tc(a.y,u.offset.y))}return a}removeElementScroll(o){var c;const a=Je();if(nr(a,o),(c=this.scroll)!=null&&c.wasRoot)return a;for(let h=0;h<this.path.length;h++){const u=this.path[h],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&nr(a,o),Tc(a.x,d.offset.x),Tc(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const c=Je();nr(c,o);for(let h=0;h<this.path.length;h++){const u=this.path[h];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Cc(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),na(u.latestValues)&&Cc(c,u.latestValues)}return na(this.latestValues)&&Cc(c,this.latestValues),c}removeTransform(o){const a=Je();nr(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!na(h.latestValues))continue;D0(h.latestValues)&&h.updateSnapshot();const u=Je(),d=h.measurePageBox();nr(u,d),aI(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,u)}return na(this.latestValues)&&aI(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var v;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==a;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!this.layout||!(u||d))return;this.resolvedRelativeTargetAt=xn.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Je(),this.targetWithTransforms=Je()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),mct(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nr(this.target,this.layout.layoutBox),T4(this.target,this.targetDelta)):nr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||D0(this.parent.latestValues)||b4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Je(),this.relativeTargetOrigin=Je(),sm(this.relativeTargetOrigin,a,c),nr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var y;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(c=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===xn.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;nr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Hat(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Je());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(eI(this.prevProjectionDelta.x,this.projectionDelta.x),eI(this.prevProjectionDelta.y,this.projectionDelta.y)),$h(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!dI(this.projectionDelta.x,this.prevProjectionDelta.x)||!dI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=bc(),this.projectionDelta=bc(),this.projectionDeltaWithTransform=bc()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},u={...this.latestValues},d=bc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=Je(),v=c?c.source:void 0,y=this.layout?this.layout.source:void 0,w=v!==y,_=this.getStack(),x=!_||_.members.length<=1,C=!!(w&&!x&&this.options.crossfade===!0&&!this.path.some(Gct));this.animationProgress=0;let k;this.mixTargetDelta=P=>{const A=P/1e3;xI(d.x,o.x,A),xI(d.y,o.y,A),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sm(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Bct(this.relativeTarget,this.relativeTargetOrigin,f,A),k&&xct(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Je()),nr(k,this.relativeTarget)),w&&(this.animationValues=u,bct(u,h,this.latestValues,A,C,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,c,h;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(h=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||h.stop(),this.pendingAnimation&&(Do(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xe.update(()=>{qg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=cl(0)),this.currentAnimation=kct(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Act),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:u}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&O4(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||Je();const d=$n(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+d;const f=$n(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}nr(a,c),Cc(a,u),$h(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Ict),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&oy("z",o,h,this.animationValues);for(let u=0;u<sy.length;u++)oy(`rotate${sy[u]}`,o,h,this.animationValues),oy(`skew${sy[u]}`,o,h,this.animationValues);o.render();for(const u in h)o.setStaticValue(u,h[u]),this.animationValues&&(this.animationValues[u]=h[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Vg(a==null?void 0:a.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Vg(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!na(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=h.animationValues||h.latestValues;this.applyTransformsToTarget();let d=_ct(this.projectionDeltaWithTransform,this.treeScale,u);c&&(d=c(u,d)),o.transform=d;const{x:f,y:v}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${v.origin*100}% 0`,h.animationValues?o.opacity=h===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=h===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const y in V0){if(u[y]===void 0)continue;const{correct:w,applyTo:_,isCSSVariable:x}=V0[y],C=d==="none"?u[y]:w(u[y],h);if(_){const k=_.length;for(let P=0;P<k;P++)o[_[P]]=C}else x?this.options.visualElement.renderState.vars[y]=C:o[y]=C}this.options.layoutId&&(o.pointerEvents=h===this?Vg(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(pI),this.root.sharedNodes.clear()}}}function Pct(e){e.updateLayout()}function Mct(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=e.layout,{animationType:s}=e.options,o=t.source!==e.layout.source;s==="size"?Ai(d=>{const f=o?t.measuredBox[d]:t.layoutBox[d],v=$n(f);f.min=i[d].min,f.max=f.min+v}):O4(s,t.layoutBox,i)&&Ai(d=>{const f=o?t.measuredBox[d]:t.layoutBox[d],v=$n(i[d]);f.max=f.min+v,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+v)});const a=bc();$h(a,i,t.layoutBox);const c=bc();o?$h(c,e.applyTransform(r,!0),t.measuredBox):$h(c,i,t.layoutBox);const h=!L4(a);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:v}=d;if(f&&v){const y=Je();sm(y,t.layoutBox,f.layoutBox);const w=Je();sm(w,i,v.layoutBox),V4(y,w)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=w,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function Dct(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Lct(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Vct(e){e.clearSnapshot()}function pI(e){e.clearMeasurements()}function vI(e){e.isLayoutDirty=!1}function qct(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function yI(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function jct(e){e.resolveTargetDelta()}function Fct(e){e.calcProjection()}function Uct(e){e.resetSkewAndRotation()}function Oct(e){e.removeLeadSnapshot()}function xI(e,t,n){e.translate=Ne(t.translate,0,n),e.scale=Ne(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function _I(e,t,n,i){e.min=Ne(t.min,n.min,i),e.max=Ne(t.max,n.max,i)}function Bct(e,t,n,i){_I(e.x,t.x,n.x,i),_I(e.y,t.y,n.y,i)}function Gct(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Hct={duration:.45,ease:[.4,0,.1,1]},wI=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),bI=wI("applewebkit/")&&!wI("chrome/")?Math.round:Gi;function TI(e){e.min=bI(e.min),e.max=bI(e.max)}function $ct(e){TI(e.x),TI(e.y)}function O4(e,t,n){return e==="position"||e==="preserve-aspect"&&!fct(uI(t),uI(n),.2)}function zct(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const Kct=U4({attachResizeListener:(e,t)=>Au(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ay={current:void 0},B4=U4({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!ay.current){const e=new Kct({});e.mount(window),e.setOptions({layoutScroll:!0}),ay.current=e}return ay.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Yb=I.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function CI(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Wct(...e){return t=>{let n=!1;const i=e.map(r=>{const s=CI(r,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():CI(e[r],null)}}}}function Qct(...e){return I.useCallback(Wct(...e),e)}class Yct extends I.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const i=n.offsetParent,r=u4(i)&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Xct({children:e,isPresent:t,anchorX:n,root:i}){var u;const r=I.useId(),s=I.useRef(null),o=I.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=I.useContext(Yb),c=((u=e.props)==null?void 0:u.ref)??(e==null?void 0:e.ref),h=Qct(s,c);return I.useInsertionEffect(()=>{const{width:d,height:f,top:v,left:y,right:w}=o.current;if(t||!s.current||!d||!f)return;const _=n==="left"?`left: ${y}`:`right: ${w}`;s.current.dataset.motionPopId=r;const x=document.createElement("style");a&&(x.nonce=a);const C=i??document.head;return C.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${f}px !important;
            ${_}px !important;
            top: ${v}px !important;
          }
        `),()=>{C.contains(x)&&C.removeChild(x)}},[t]),l.jsx(Yct,{isPresent:t,childRef:s,sizeRef:o,children:I.cloneElement(e,{ref:h})})}const Jct=({children:e,initial:t,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o,anchorX:a,root:c})=>{const h=bb(Zct),u=I.useId();let d=!0,f=I.useMemo(()=>(d=!1,{id:u,initial:t,isPresent:n,custom:r,onExitComplete:v=>{h.set(v,!0);for(const y of h.values())if(!y)return;i&&i()},register:v=>(h.set(v,!1),()=>h.delete(v))}),[n,h,i]);return s&&d&&(f={...f}),I.useMemo(()=>{h.forEach((v,y)=>h.set(y,!1))},[n]),I.useEffect(()=>{!n&&!h.size&&i&&i()},[n]),o==="popLayout"&&(e=l.jsx(Xct,{isPresent:n,anchorX:a,root:c,children:e})),l.jsx(Cp.Provider,{value:f,children:e})};function Zct(){return new Map}function G4(e=!0){const t=I.useContext(Cp);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=t,s=I.useId();I.useEffect(()=>{if(e)return r(s)},[e]);const o=I.useCallback(()=>e&&i&&i(s),[s,i,e]);return!n&&i?[!1,o]:[!0]}const sg=e=>e.key||"";function kI(e){const t=[];return I.Children.forEach(e,n=>{I.isValidElement(n)&&t.push(n)}),t}const tlt=({children:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1,anchorX:a="left",root:c})=>{const[h,u]=G4(o),d=I.useMemo(()=>kI(e),[e]),f=o&&!h?[]:d.map(sg),v=I.useRef(!0),y=I.useRef(d),w=bb(()=>new Map),_=I.useRef(new Set),[x,C]=I.useState(d),[k,P]=I.useState(d);_q(()=>{v.current=!1,y.current=d;for(let N=0;N<k.length;N++){const T=sg(k[N]);f.includes(T)?(w.delete(T),_.current.delete(T)):w.get(T)!==!0&&w.set(T,!1)}},[k,f.length,f.join("-")]);const A=[];if(d!==x){let N=[...d];for(let T=0;T<k.length;T++){const E=k[T],R=sg(E);f.includes(R)||(N.splice(T,0,E),A.push(E))}return s==="wait"&&A.length&&(N=A),P(kI(N)),C(d),null}const{forceRender:M}=I.useContext(wb);return l.jsx(l.Fragment,{children:k.map(N=>{const T=sg(N),E=o&&!h?!1:d===k||f.includes(T),R=()=>{if(_.current.has(T))return;if(_.current.add(T),w.has(T))w.set(T,!0);else return;let D=!0;w.forEach(F=>{F||(D=!1)}),D&&(M==null||M(),P(y.current),o&&(u==null||u()),i&&i())};return l.jsx(Jct,{isPresent:E,initial:!v.current||n?void 0:!1,custom:t,presenceAffectsLayout:r,mode:s,root:c,onExitComplete:E?void 0:R,anchorX:a,children:N},T)})})},H4=I.createContext({strict:!1}),NI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let EI=!1;function elt(){if(EI)return;const e={};for(const t in NI)e[t]={isEnabled:n=>NI[t].some(i=>!!n[i])};x4(e),EI=!0}function $4(){return elt(),Uat()}function nlt(e){const t=$4();for(const n in e)t[n]={...t[n],...e[n]};x4(t)}const ilt=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function om(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ilt.has(e)}let z4=e=>!om(e);function rlt(e){typeof e=="function"&&(z4=t=>t.startsWith("on")?!om(t):e(t))}try{rlt(require("@emotion/is-prop-valid").default)}catch{}function slt(e,t,n){const i={};for(const r in e)r==="values"&&typeof e.values=="object"||(z4(r)||n===!0&&om(r)||!t&&!om(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}const Ep=I.createContext({});function olt(e,t){if(Np(e)){const{initial:n,animate:i}=e;return{initial:n===!1||Iu(n)?n:void 0,animate:Iu(i)?i:void 0}}return e.inherit!==!1?t:{}}function alt(e){const{initial:t,animate:n}=olt(e,I.useContext(Ep));return I.useMemo(()=>({initial:t,animate:n}),[SI(t),SI(n)])}function SI(e){return Array.isArray(e)?e.join(" "):e}const Xb=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function K4(e,t,n){for(const i in t)!Vn(t[i])&&!N4(i,n)&&(e[i]=t[i])}function clt({transformTemplate:e},t){return I.useMemo(()=>{const n=Xb();return Wb(n,t,e),Object.assign({},n.vars,n.style)},[t])}function llt(e,t){const n=e.style||{},i={};return K4(i,n,e),Object.assign(i,clt(e,t)),i}function hlt(e,t){const n={},i=llt(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const W4=()=>({...Xb(),attrs:{}});function ult(e,t,n,i){const r=I.useMemo(()=>{const s=W4();return E4(s,t,I4(i),e.transformTemplate,e.style),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};K4(s,e.style,e),r.style={...s,...r.style}}return r}const dlt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Jb(e){return typeof e!="string"||e.includes("-")?!1:!!(dlt.indexOf(e)>-1||/[A-Z]/u.test(e))}function glt(e,t,n,{latestValues:i},r,s=!1,o){const c=(o??Jb(e)?ult:hlt)(t,i,r,e),h=slt(t,typeof e=="string",s),u=e!==I.Fragment?{...h,...c,ref:n}:{},{children:d}=t,f=I.useMemo(()=>Vn(d)?d.get():d,[d]);return I.createElement(e,{...u,children:f})}function flt({scrapeMotionValuesFromProps:e,createRenderState:t},n,i,r){return{latestValues:mlt(n,i,r,e),renderState:t()}}function mlt(e,t,n,i){const r={},s=i(e,{});for(const f in s)r[f]=Vg(s[f]);let{initial:o,animate:a}=e;const c=Np(e),h=y4(e);t&&h&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!kp(d)){const f=Array.isArray(d)?d:[d];for(let v=0;v<f.length;v++){const y=Ob(e,f[v]);if(y){const{transitionEnd:w,transition:_,...x}=y;for(const C in x){let k=x[C];if(Array.isArray(k)){const P=u?k.length-1:0;k=k[P]}k!==null&&(r[C]=k)}for(const C in w)r[C]=w[C]}}}return r}const Q4=e=>(t,n)=>{const i=I.useContext(Ep),r=I.useContext(Cp),s=()=>flt(e,t,i,r);return n?s():bb(s)},plt=Q4({scrapeMotionValuesFromProps:Qb,createRenderState:Xb}),vlt=Q4({scrapeMotionValuesFromProps:A4,createRenderState:W4}),ylt=Symbol.for("motionComponentSymbol");function xlt(e,t,n){const i=I.useRef(n);I.useInsertionEffect(()=>{i.current=n});const r=I.useRef(null);return I.useCallback(s=>{var a;s&&((a=e.onMount)==null||a.call(e,s)),t&&(s?t.mount(s):t.unmount());const o=i.current;if(typeof o=="function")if(s){const c=o(s);typeof c=="function"&&(r.current=c)}else r.current?(r.current(),r.current=null):o(s);else o&&(o.current=s)},[t])}const Y4=I.createContext({});function wh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function _lt(e,t,n,i,r,s){var _,x;const{visualElement:o}=I.useContext(Ep),a=I.useContext(H4),c=I.useContext(Cp),h=I.useContext(Yb).reducedMotion,u=I.useRef(null);i=i||a.renderer,!u.current&&i&&(u.current=i(e,{visualState:t,parent:o,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h,isSVG:s}));const d=u.current,f=I.useContext(Y4);d&&!d.projection&&r&&(d.type==="html"||d.type==="svg")&&wlt(u.current,n,r,f);const v=I.useRef(!1);I.useInsertionEffect(()=>{d&&v.current&&d.update(n,c)});const y=n[i4],w=I.useRef(!!y&&!((_=window.MotionHandoffIsComplete)!=null&&_.call(window,y))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,y)));return _q(()=>{d&&(v.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),w.current&&d.animationState&&d.animationState.animateChanges())}),I.useEffect(()=>{d&&(!w.current&&d.animationState&&d.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,y)}),w.current=!1),d.enteringChildren=void 0)}),d}function wlt(e,t,n,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:X4(e.parent)),e.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&wh(a),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:c,layoutRoot:h})}function X4(e){if(e)return e.options.allowProjection!==!1?e.projection:X4(e.parent)}function cy(e,{forwardMotionProps:t=!1,type:n}={},i,r){i&&nlt(i);const s=n?n==="svg":Jb(e),o=s?vlt:plt;function a(h,u){let d;const f={...I.useContext(Yb),...h,layoutId:blt(h)},{isStatic:v}=f,y=alt(h),w=o(h,v);if(!v&&xq){Tlt();const _=Clt(f);d=_.MeasureLayout,y.visualElement=_lt(e,w,f,r,_.ProjectionNode,s)}return l.jsxs(Ep.Provider,{value:y,children:[d&&y.visualElement?l.jsx(d,{visualElement:y.visualElement,...f}):null,glt(e,h,xlt(w,y.visualElement,u),w,v,t,s)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=I.forwardRef(a);return c[ylt]=e,c}function blt({layoutId:e}){const t=I.useContext(wb).id;return t&&e!==void 0?t+"-"+e:e}function Tlt(e,t){I.useContext(H4).strict}function Clt(e){const t=$4(),{drag:n,layout:i}=t;if(!n&&!i)return{};const r={...n,...i};return{MeasureLayout:n!=null&&n.isEnabled(e)||i!=null&&i.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function klt(e,t){if(typeof Proxy>"u")return cy;const n=new Map,i=(s,o)=>cy(s,o,e,t),r=(s,o)=>i(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?i:(n.has(o)||n.set(o,cy(o,void 0,e,t)),n.get(o))})}const Nlt=(e,t)=>t.isSVG??Jb(e)?new ict(t):new Xat(t,{allowProjection:e!==I.Fragment});class Elt extends Go{constructor(t){super(t),t.animationState||(t.animationState=cct(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();kp(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Slt=0;class Ilt extends Go{constructor(){super(...arguments),this.id=Slt++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const r=this.node.animationState.setActive("exit",!t);n&&!t&&r.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Alt={animation:{Feature:Elt},exit:{Feature:Ilt}};function ld(e){return{point:{x:e.pageX,y:e.pageY}}}const Rlt=e=>t=>$b(t)&&e(t,ld(t));function zh(e,t,n,i){return Au(e,t,Rlt(n),i)}const J4=({current:e})=>e?e.ownerDocument.defaultView:null,II=(e,t)=>Math.abs(e-t);function Plt(e,t){const n=II(e.x,t.x),i=II(e.y,t.y);return Math.sqrt(n**2+i**2)}const AI=new Set(["auto","scroll"]);class Z4{constructor(t,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=v=>{this.handleScroll(v.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=hy(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,w=Plt(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!w)return;const{point:_}=v,{timestamp:x}=xn;this.history.push({..._,timestamp:x});const{onStart:C,onMove:k}=this.handlers;y||(C&&C(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,v)},this.handlePointerMove=(v,y)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=ly(y,this.transformPagePoint),xe.update(this.updatePoint,!0)},this.handlePointerUp=(v,y)=>{this.end();const{onEnd:w,onSessionEnd:_,resumeAnimation:x}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=hy(v.type==="pointercancel"?this.lastMoveEventInfo:ly(y,this.transformPagePoint),this.history);this.startEvent&&w&&w(v,C),_&&_(v,C)},!$b(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const c=ld(t),h=ly(c,this.transformPagePoint),{point:u}=h,{timestamp:d}=xn;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=n;f&&f(t,hy(h,this.history)),this.removeListeners=od(zh(this.contextWindow,"pointermove",this.handlePointerMove),zh(this.contextWindow,"pointerup",this.handlePointerUp),zh(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(t){let n=t.parentElement;for(;n;){const i=getComputedStyle(n);(AI.has(i.overflowX)||AI.has(i.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const n=this.scrollPositions.get(t);if(!n)return;const i=t===window,r=i?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s={x:r.x-n.x,y:r.y-n.y};s.x===0&&s.y===0||(i?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s.x,this.lastMoveEventInfo.point.y+=s.y):this.history.length>0&&(this.history[0].x-=s.x,this.history[0].y-=s.y),this.scrollPositions.set(t,r),xe.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Do(this.updatePoint)}}function ly(e,t){return t?{point:t(e.point)}:e}function RI(e,t){return{x:e.x-t.x,y:e.y-t.y}}function hy({point:e},t){return{point:e,delta:RI(e,tj(t)),offset:RI(e,Mlt(t)),velocity:Dlt(t,.1)}}function Mlt(e){return e[0]}function tj(e){return e[e.length-1]}function Dlt(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=tj(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>vs(t)));)n--;if(!i)return{x:0,y:0};const s=ji(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Llt(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?Ne(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?Ne(n,e,i.max):Math.min(e,n)),e}function PI(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function Vlt(e,{top:t,left:n,bottom:i,right:r}){return{x:PI(e.x,n,r),y:PI(e.y,t,i)}}function MI(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function qlt(e,t){return{x:MI(e.x,t.x),y:MI(e.y,t.y)}}function jlt(e,t){let n=.5;const i=$n(e),r=$n(t);return r>i?n=Nu(t.min,t.max-i,e.min):i>r&&(n=Nu(e.min,e.max-r,t.min)),Xr(0,1,n)}function Flt(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const q0=.35;function Ult(e=q0){return e===!1?e=0:e===!0&&(e=q0),{x:DI(e,"left","right"),y:DI(e,"top","bottom")}}function DI(e,t,n){return{min:LI(e,t),max:LI(e,n)}}function LI(e,t){return typeof e=="number"?e:e[t]||0}const Olt=new WeakMap;class Blt{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Je(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{n?(this.stopAnimation(),this.snapToCursor(ld(d).point)):this.pauseAnimation()},o=(d,f)=>{this.stopAnimation();const{drag:v,dragPropagation:y,onDragStart:w}=this.getProps();if(v&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Sat(v),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ai(x=>{let C=this.getAxisMotionValue(x).get()||0;if(Hr.test(C)){const{projection:k}=this.visualElement;if(k&&k.layout){const P=k.layout.layoutBox[x];P&&(C=$n(P)*(parseFloat(C)/100))}}this.originPoint[x]=C}),w&&xe.postRender(()=>w(d,f)),A0(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},a=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f;const{dragPropagation:v,dragDirectionLock:y,onDirectionLock:w,onDrag:_}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:x}=f;if(y&&this.currentDirection===null){this.currentDirection=Glt(x),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",f.point,x),this.updateAxis("y",f.point,x),this.visualElement.render(),_&&_(d,f)},c=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f,this.stop(d,f),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>Ai(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Z4(t,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:J4(this.visualElement),element:this.visualElement.current})}stop(t,n){const i=t||this.latestPointerEvent,r=n||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&xe.postRender(()=>a(i,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,i){const{drag:r}=this.getProps();if(!i||!og(t,r,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(o=Llt(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,r=this.constraints;t&&wh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Vlt(i.layoutBox,t):this.constraints=!1,this.elastic=Ult(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ai(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Flt(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!wh(t))return!1;const i=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=$at(i,r.root,this.visualElement.getTransformPagePoint());let o=qlt(r.layout.layoutBox,s);if(n){const a=n(Bat(o));this.hasMutatedConstraints=!!a,a&&(o=w4(a))}return o}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=Ai(u=>{if(!og(u,n,this.currentDirection))return;let d=c&&c[u]||{};o&&(d={min:0,max:0});const f=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?t[u]:0,bounceStiffness:f,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(h).then(a)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return A0(this.visualElement,t),i.start(Ub(t,i,0,n,this.visualElement,!1))}stopAnimation(){Ai(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ai(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Ai(n=>{const{drag:i}=this.getProps();if(!og(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n],c=s.get()||0;s.set(t[n]-Ne(o,a,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!wh(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ai(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=jlt({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Ai(o=>{if(!og(o,t,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(Ne(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;Olt.set(this.visualElement,this);const t=this.visualElement.current,n=zh(t,"pointerdown",c=>{const{drag:h,dragListener:u=!0}=this.getProps();h&&u&&!m4(c.target)&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();wh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),xe.read(i);const o=Au(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Ai(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=c[u].translate,d.set(d.get()+c[u].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=q0,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function og(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function Glt(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class Hlt extends Go{constructor(t){super(t),this.removeGroupControls=Gi,this.removeListeners=Gi,this.controls=new Blt(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gi}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const VI=e=>(t,n)=>{e&&xe.postRender(()=>e(t,n))};class $lt extends Go{constructor(){super(...arguments),this.removePointerDownListener=Gi}onPointerDown(t){this.session=new Z4(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:J4(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:VI(t),onStart:VI(n),onMove:i,onEnd:(s,o)=>{delete this.session,r&&xe.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=zh(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let uy=!1;class zlt extends I.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=t;s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),uy&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),qg.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,{projection:o}=i;return o&&(o.isPresent=s,uy=!0,r||t.layoutDependency!==n||n===void 0||t.isPresent!==s?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||xe.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Hb.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=t;uy=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function ej(e){const[t,n]=G4(),i=I.useContext(wb);return l.jsx(zlt,{...e,layoutGroup:i,switchLayoutGroup:I.useContext(Y4),isPresent:t,safeToRemove:n})}const Klt={pan:{Feature:$lt},drag:{Feature:Hlt,ProjectionNode:B4,MeasureLayout:ej}};function qI(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,s=i[r];s&&xe.postRender(()=>s(t,ld(t)))}class Wlt extends Go{mount(){const{current:t}=this.node;t&&(this.unmount=Iat(t,(n,i)=>(qI(this.node,i,"Start"),r=>qI(this.node,r,"End"))))}unmount(){}}class Qlt extends Go{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=od(Au(this.node.current,"focus",()=>this.onFocus()),Au(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function jI(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),s=i[r];s&&xe.postRender(()=>s(t,ld(t)))}class Ylt extends Go{mount(){const{current:t}=this.node;t&&(this.unmount=Pat(t,(n,i)=>(jI(this.node,i,"Start"),(r,{success:s})=>jI(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const j0=new WeakMap,dy=new WeakMap,Xlt=e=>{const t=j0.get(e.target);t&&t(e)},Jlt=e=>{e.forEach(Xlt)};function Zlt({root:e,...t}){const n=e||document;dy.has(n)||dy.set(n,{});const i=dy.get(n),r=JSON.stringify(t);return i[r]||(i[r]=new IntersectionObserver(Jlt,{root:e,...t})),i[r]}function tht(e,t,n){const i=Zlt(t);return j0.set(e,n),i.observe(e),()=>{j0.delete(e),i.unobserve(e)}}const eht={some:0,all:1};class nht extends Go{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=t,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:eht[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=h?u:d;f&&f(c)};return tht(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(iht(t,n))&&this.startObserver()}unmount(){}}function iht({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const rht={inView:{Feature:nht},tap:{Feature:Ylt},focus:{Feature:Qlt},hover:{Feature:Wlt}},sht={layout:{ProjectionNode:B4,MeasureLayout:ej}},oht={...Alt,...rht,...Klt,...sht},Oe=klt(oht,Nlt);function aht(e){return Math.max(...e.map(t=>t.cardScarcity))}function cht({isOpen:e,onClose:t,results:n,isLoading:i,skipLoading:r=!1}){const[s,o]=I.useState(0),[a,c]=I.useState(!1),[h,u]=I.useState("loading"),[d,f]=I.useState({}),[v,y]=I.useState(!1),[w,_]=I.useState(!1),[x,C]=I.useState(!1);I.useEffect(()=>{e&&i&&(u("loading"),_(!1),y(!1),C(!0),c(!1),o(0),f({})),e&&r&&n.length>0&&!i&&(u("reveal"),c(!1),o(0),f({}))},[e,i]),I.useEffect(()=>{e||(u("loading"),_(!1),y(!1),C(!1),c(!1),o(0),f({}))},[e]),I.useEffect(()=>{if(x&&h==="loading"){const E=setTimeout(()=>y(!0),1e3),R=setTimeout(()=>_(!0),2e3);return()=>{clearTimeout(E),clearTimeout(R)}}},[x,h]),I.useEffect(()=>{e&&n.length>0&&!i&&w&&h==="loading"&&u("reveal")},[e,n,i,w,h]);const k=()=>{_(!0)},P=()=>{s<n.length-1?o(s+1):(c(!0),u("done"))},A=()=>{const E=n.findIndex((R,D)=>D>s&&R.cardScarcity===40&&R.isNew);E!==-1?o(E):(c(!0),u("done"))};if(!e)return null;const M=n[s],N=(M==null?void 0:M.cardScarcity)===40,T=n.length>0?aht(n):10;return l.jsx(tlt,{children:l.jsxs(Oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-black/90 flex items-center justify-center",onClick:E=>E.stopPropagation(),children:[h==="loading"&&v&&!i&&l.jsx("button",{onClick:k,className:"absolute top-20 right-4 px-4 py-2 rounded-xl bg-white/10 z-10 text-white text-sm font-medium",children:"B qua"}),h==="reveal"&&n.length>1&&l.jsx("button",{onClick:A,className:"absolute top-20 right-4 px-4 py-2 rounded-xl bg-white/10 z-10 text-white text-sm font-medium",children:"B qua"}),h==="loading"&&l.jsxs(Oe.div,{initial:{opacity:1},animate:{opacity:1},className:"absolute inset-0 flex flex-col items-center justify-center",children:[l.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${pt(T)}30 0%, transparent 70%)`}}),l.jsx(Oe.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"w-32 h-32 rounded-full border-4",style:{borderColor:`${pt(T)}`,borderTopColor:"transparent",borderRightColor:`${pt(T)}60`}}),l.jsx(Oe.div,{animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 flex items-center justify-center",children:l.jsx(ge,{className:"w-10 h-10",style:{color:pt(T)},fill:pt(T)})})]}),l.jsx("p",{className:"text-white mt-6 text-lg",children:"ang quay..."}),(T===40||T===30)&&l.jsxs(Oe.p,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"mt-2 text-sm font-bold",style:{color:pt(T)},children:[T===40&&"C th UR!",T===30&&"C th SR!"]})]}),h==="reveal"&&M&&!a&&l.jsxs(Oe.div,{className:"flex flex-col items-center px-4 perspective-1000",onClick:P,children:[l.jsx(Oe.div,{initial:{opacity:0,scale:.5},animate:{opacity:N?.9:M.cardScarcity===30?.7:.5,scale:1},transition:{duration:.5},className:`absolute rounded-full blur-3xl ${N?"w-[400px] h-[400px]":M.cardScarcity===30?"w-[350px] h-[350px]":"w-72 h-72"}`,style:{backgroundColor:pt(M.cardScarcity)+(N?"70":M.cardScarcity===30?"60":"40")}}),l.jsxs("div",{className:"relative",children:[N&&l.jsx(Oe.div,{animate:{opacity:[.4,.8,.4],scale:[1,1.02,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"absolute -inset-2 rounded-2xl pointer-events-none",style:{background:`linear-gradient(45deg, ${pt(40)}60, ${pt(40)}30, ${pt(40)}60)`,filter:"blur(8px)"}}),M.cardScarcity===30&&l.jsx(Oe.div,{animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute -inset-1.5 rounded-2xl pointer-events-none",style:{background:`linear-gradient(45deg, ${pt(30)}50, ${pt(30)}20, ${pt(30)}50)`,filter:"blur(6px)"}}),l.jsxs(Oe.div,{initial:{rotateY:180,scale:.8},animate:{rotateY:0,scale:1},transition:{type:"spring",stiffness:100,damping:15,duration:.8},className:"relative rounded-2xl overflow-hidden border-4 shadow-2xl max-w-[280px] min-h-[300px] bg-gradient-to-b from-gray-800 to-gray-900",style:{borderColor:pt(M.cardScarcity),aspectRatio:M.width&&M.height?M.width/M.height:2/3,transformStyle:"preserve-3d",boxShadow:`0 0 ${N?"60px":"30px"} ${pt(M.cardScarcity)}${N?"80":"50"}`},children:[l.jsx(Oe.div,{className:"absolute inset-0 z-20 pointer-events-none",initial:{x:"-100%",opacity:0},animate:{x:"200%",opacity:[0,.5,0]},transition:{duration:1,delay:.3},style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)",transform:"skewX(-20deg)"}}),Ma(M.videoList)&&!d[s]?l.jsx("video",{className:"w-full h-full object-contain",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,poster:ke(M.cardImg,400),onError:()=>f(E=>({...E,[s]:!0})),children:l.jsx("source",{src:M.videoList[1],type:"video/mp4"})},M.videoList[1]):l.jsx("img",{src:ke(M.cardImg,400),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer",loading:"eager",decoding:"sync",onError:E=>{const R=E.target;R.src.includes("@")&&(R.src=M.cardImg)}}),M.isNew&&l.jsx(Oe.div,{initial:{scale:0,rotate:-15},animate:{scale:1,rotate:0},transition:{type:"spring",delay:.5},className:"absolute top-2 left-2 px-3 py-1 bg-[var(--duo-green)] text-white text-xs font-bold rounded-full shadow-lg",children:"MI!"}),M.shardsGained>0&&l.jsxs(Oe.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"absolute top-2 right-2 px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded-full flex items-center gap-1 shadow-lg",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-4 h-4"}),"+",M.shardsGained]})]})]}),l.jsxs(Oe.div,{initial:{y:30,opacity:0,scale:.8},animate:{y:0,opacity:1,scale:1},transition:{delay:.4,type:"spring",stiffness:200},className:"mt-5 flex items-center gap-2",children:[l.jsx(Oe.div,{animate:N?{rotate:[0,360]}:{},transition:{duration:3,repeat:1/0,ease:"linear"},children:l.jsx(ge,{className:N?"w-8 h-8":"w-6 h-6",style:{color:pt(M.cardScarcity)},fill:pt(M.cardScarcity)})}),l.jsx(Oe.span,{animate:N?{scale:[1,1.05,1]}:{},transition:{duration:1,repeat:1/0},className:`font-bold ${N?"text-3xl":"text-2xl"}`,style:{color:pt(M.cardScarcity)},children:gr(M.cardScarcity)}),N&&l.jsx(Oe.div,{animate:{rotate:[0,-360]},transition:{duration:3,repeat:1/0,ease:"linear"},children:l.jsx(ge,{className:"w-8 h-8",style:{color:pt(M.cardScarcity)},fill:pt(M.cardScarcity)})})]}),l.jsxs(Oe.p,{initial:{opacity:0},animate:{opacity:[.3,.8,.3]},transition:{duration:1.5,repeat:1/0},className:"text-white/70 mt-4 text-sm",children:["Chm  tip tc (",s+1,"/",n.length,")"]})]},s),a&&l.jsxs(Oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full h-full flex flex-col",children:[l.jsxs("h2",{className:"text-white text-xl font-bold text-center pt-16 pb-4 flex items-center justify-center gap-2 flex-shrink-0",children:[l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)]"}),"Kt qu (",n.length," th)"]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-2 max-w-md mx-auto",children:n.map((E,R)=>l.jsxs(Oe.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:R*.05},className:`relative aspect-[2/3] rounded-xl overflow-hidden border-2 ${E.cardScarcity===40?"ring-2 ring-yellow-400/50":""}`,style:{borderColor:pt(E.cardScarcity)},children:[l.jsx("img",{src:ke(E.cardImg,200),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer",crossOrigin:"anonymous",onError:D=>{const F=D.target;F.src.includes("@")&&(F.src=E.cardImg)}}),E.isNew&&l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 bg-[var(--duo-green)] text-white text-[10px] font-bold rounded",children:"MI"}),E.shardsGained>0&&l.jsxs("div",{className:"absolute top-1 right-1 px-1.5 py-0.5 bg-purple-500 text-white text-[10px] font-bold rounded flex items-center gap-0.5",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-3 h-3"}),"+",E.shardsGained]})]},R))})}),l.jsx("div",{className:"flex-shrink-0 p-4 bg-black/50",children:l.jsx("button",{onClick:t,className:"w-full max-w-md mx-auto block btn-3d btn-3d-purple py-3",children:"ng"})})]})]})})}function lht({isOpen:e,onClose:t,collectionId:n,urCards:i,inventory:r,userId:s,onExchangeSuccess:o}){const[a,c]=I.useState(null),[h,u]=I.useState(!1);if(!e)return null;const d=(r==null?void 0:r.shards)||0,f=on.UR_EXCHANGE_COST,v=d>=f,y=i.filter(_=>{var x;return!((x=r==null?void 0:r.cards[n])!=null&&x[_.card_img])}),w=async()=>{if(!a||!v||h)return;u(!0);const _=await Tst(s,n,a.card_img);if(_.success){const x=a;c(null),t(),o(x)}else alert(_.error||"C li xy ra!");u(!1)};return l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:t,children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:_=>_.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"text-center",children:[l.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"i mnh ly th UR"]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn th UR bn mun s hu"})]}),l.jsxs("button",{onClick:w,disabled:!a||!v||h,className:`btn-3d px-4 py-2 rounded-xl text-sm font-bold text-white flex items-center gap-1.5 ${a&&v?"btn-3d-yellow":"btn-3d-gray opacity-60"}`,children:[l.jsx(In,{className:"w-4 h-4"}),"i"]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-8 h-8"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Mnh hin c"}),l.jsx("p",{className:"font-bold text-lg",children:Mn(d)})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chi ph i"}),l.jsx("p",{className:"font-bold text-lg text-[var(--duo-yellow)]",children:Mn(f)})]})]}),!v&&a&&l.jsxs("p",{className:"text-center text-xs text-[var(--duo-red)] mt-2 pt-2 border-t border-[var(--border)]",children:["Khng  mnh! Cn thm ",Mn(f-d)," ","mnh"]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:y.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(ge,{className:"w-10 h-10 text-[var(--duo-yellow)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)] font-medium",children:"Bn  s hu tt c th UR!"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Hy th b su tp khc nh"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-3",children:y.map((_,x)=>{const C=(a==null?void 0:a.card_img)===_.card_img,k=Ma(_.video_list);return l.jsxs("button",{onClick:()=>c(C?null:_),className:`relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all shadow-md hover:shadow-lg ${C?"ring-2 ring-[var(--duo-yellow)] shadow-[var(--duo-yellow)]/30":""}`,style:{borderColor:pt(_.card_scarcity)},children:[l.jsx("img",{src:To(_.card_img,200),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),k&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 py-1 text-center text-[10px] font-bold text-white",style:{backgroundColor:pt(_.card_scarcity)},children:gr(_.card_scarcity)}),C&&l.jsx("div",{className:"absolute inset-0 bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-yellow)] flex items-center justify-center shadow-lg",children:l.jsx(In,{className:"w-6 h-6 text-white"})})})]},x)})})})]})})}function hht(){var nt,mt,Nt,ct;const{id:e}=yP(),t=we(),[n]=EP(),{user:i}=Zt(),r=n.get("tab")||"all",s=n.get("page")||"1",o=()=>t(`/gacha?tab=${r}&page=${s}`),[a,c]=I.useState(null),[h,u]=I.useState([]),[d,f]=I.useState(!0),[v,y]=I.useState(null),[w,_]=I.useState(0),[x,C]=I.useState(null),[k,P]=I.useState(null),[A,M]=I.useState(!1),[N,T]=I.useState([]),[E,R]=I.useState(!1),[D,F]=I.useState(!1),[L,lt]=I.useState(!1),[ht,Y]=I.useState(!1),[K,U]=I.useState(!1),W=e?parseInt(e):0;I.useEffect(()=>{if(k){const ot=bst(k,W);lt(ot)}},[k,W]),I.useEffect(()=>{e&&q(parseInt(e))},[e]),I.useEffect(()=>{i!=null&&i.oderId&&j()},[i==null?void 0:i.oderId]);const j=async()=>{if(!(i!=null&&i.oderId))return;const ot=await Ha(i.oderId);P(ot)},q=async ot=>{try{f(!0),y(null);const[Tt,Et]=await Promise.all([pq(ot),ku(ot)]);if(!Tt){y("Khng tm thy b su tp");return}c(Tt),u(Et)}catch(Tt){console.error("Fetch error:",Tt),y("Khng th ti d liu")}finally{f(!1)}},J=async ot=>{if(!i||!G)return;const Tt=on.COST_PER_PULL*ot;if(i.gems<Tt){alert("Khng  Gems!");return}M(!0),R(!0),T([]);const Et=await xst(i.oderId,W,G,ot,i.gems);Et.success?(T(Et.results),await j(),Zt.setState(Yt=>({user:Yt.user?{...Yt.user,gems:Et.newGems}:null}))):(alert(Et.error||"C li xy ra!"),R(!1)),M(!1)},G=h[w],Q=(nt=G==null?void 0:G.item_list)==null?void 0:nt.reduce((ot,Tt)=>{const Et=Tt.card_scarcity;return ot[Et]||(ot[Et]=[]),ot[Et].push(Tt),ot},{}),Z=Q?Object.keys(Q).map(Number).sort((ot,Tt)=>Tt-ot):[],O=k!=null&&k.cards[W]?Object.keys(k.cards[W]).length:0,B=((mt=G==null?void 0:G.item_list)==null?void 0:mt.length)||0,rt=B>0&&O>=B,z=()=>{var Yt,St,Ut,pn;if(!G)return[];const ot=[3,1001,1e3],Tt=((St=(Yt=G.collect_list)==null?void 0:Yt.collect_infos)==null?void 0:St.filter(oe=>ot.includes(oe.redeem_item_type||0)))||[],Et=((pn=(Ut=G.collect_list)==null?void 0:Ut.collect_chain)==null?void 0:pn.filter(oe=>ot.includes(oe.redeem_item_type||0)))||[];return[...Tt,...Et]},et=async()=>{if(!(i!=null&&i.oderId))return;const ot=z();if(await wst(i.oderId,W,ot)){lt(!0);const Yt=Date.now()+3e3,St=()=>{Ee({particleCount:7,angle:60,spread:55,origin:{x:0},colors:["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#DDA0DD"]}),Ee({particleCount:7,angle:120,spread:55,origin:{x:1},colors:["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#DDA0DD"]}),Date.now()<Yt&&requestAnimationFrame(St)};St(),F(!0),await j()}};return d?l.jsx(re,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[l.jsx(Li,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]})}):v||!a?l.jsx(re,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen px-4",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:v}),l.jsx("button",{onClick:o,className:"btn-3d btn-3d-purple px-4 py-2",children:"Quay li"})]})}):l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Chi tit b su tp"})]})}),l.jsxs("div",{className:"pt-24 pb-32 px-4",children:[l.jsx("div",{className:"card-3d overflow-hidden mb-4",children:l.jsx("img",{src:ke(a.act_square_img,800),alt:"Banner",className:"w-full h-auto",referrerPolicy:"no-referrer"})}),l.jsx("div",{className:"card-3d p-3 mb-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:Mn((i==null?void 0:i.gems)||0)}),l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Gems"})]})}),l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium",children:"Tin  su tp"}),l.jsxs("span",{className:"text-sm font-bold text-[var(--duo-purple)]",children:[O,"/",B]})]}),l.jsx("div",{className:"h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] transition-all",style:{width:`${B>0?O/B*100:0}%`}})})]}),l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"text-sm font-medium",children:"T l ri"}),k&&l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Bo him:"}),l.jsxs("span",{className:"font-bold text-[var(--duo-yellow)]",children:[k.pityCounters[0]||0,"/",on.PITY_UR]})]})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(ge,{className:"w-4 h-4 mx-auto mb-1",style:{color:pt(40)},fill:pt(40)}),l.jsx("div",{className:"font-bold",style:{color:pt(40)},children:"UR"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[on.RATES[40],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(ge,{className:"w-4 h-4 mx-auto mb-1",style:{color:pt(30)},fill:pt(30)}),l.jsx("div",{className:"font-bold",style:{color:pt(30)},children:"SR"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[on.RATES[30],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(ge,{className:"w-4 h-4 mx-auto mb-1",style:{color:pt(20)},fill:pt(20)}),l.jsx("div",{className:"font-bold",style:{color:pt(20)},children:"R"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[on.RATES[20],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(ge,{className:"w-4 h-4 mx-auto mb-1",style:{color:pt(10)},fill:pt(10)}),l.jsx("div",{className:"font-bold",style:{color:pt(10)},children:"N"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[on.RATES[10],"%"]})]})]}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-2 text-center",children:["m bo UR sau ",on.PITY_UR," ln quay khng trng (tch ly chung tt c gi)"]})]}),k&&l.jsx("div",{className:"card-3d p-3 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-bold",children:[Mn(k.shards)," mnh"]}),l.jsxs("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:["i ",on.UR_EXCHANGE_COST," mnh = 1 th UR"]})]})]}),l.jsx("button",{onClick:()=>Y(!0),className:"btn-3d btn-3d-purple px-3 py-2 text-sm",children:"i th"})]})}),h.length>1&&l.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:h.map((ot,Tt)=>l.jsxs("button",{onClick:()=>_(Tt),className:`px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap ${w===Tt?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-foreground"}`,children:["Pool ",Tt+1]},Tt))}),G&&l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsx("h3",{className:"font-bold mb-3",children:"Danh sch th"}),Z.map(ot=>l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(ge,{className:"w-4 h-4",style:{color:pt(ot)},fill:pt(ot)}),l.jsxs("span",{className:"font-bold text-sm",style:{color:pt(ot)},children:[gr(ot)," (",Q[ot].length,")"]})]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:Q[ot].map((Tt,Et)=>{const Yt=Ma(Tt.video_list),St=k?_st(k,W,Tt.card_img):!1;return l.jsxs("button",{onClick:()=>St&&C(Tt),disabled:!St,className:`relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all ${St?"bg-[var(--secondary)] hover:scale-105":"bg-black/30 brightness-50 cursor-not-allowed"}`,style:{borderColor:St?pt(Tt.card_scarcity):"var(--border)"},children:[l.jsx("img",{src:To(Tt.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer",loading:"lazy"}),Yt&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})})]},Et)})})]},ot)),(()=>{var Ut,pn,oe,ft;const ot=[3,1001,1e3],Tt=((pn=(Ut=G.collect_list)==null?void 0:Ut.collect_infos)==null?void 0:pn.filter(It=>ot.includes(It.redeem_item_type||0)))||[],Et=((ft=(oe=G.collect_list)==null?void 0:oe.collect_chain)==null?void 0:ft.filter(It=>ot.includes(It.redeem_item_type||0)))||[],Yt=[...Tt,...Et];if(Yt.length===0)return null;const St=It=>{switch(It){case 3:return{icon:uf,label:"Khung"};case 1001:return{icon:Xt,label:"Huy hiu"};case 1e3:return{icon:fl,label:"Avatar"};default:return{icon:Ue,label:"Thng"}}};return l.jsxs("div",{className:"mt-4 pt-4 border-t border-[var(--border)]",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Ue,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-sm",children:"Phn thng"})]}),l.jsx("div",{className:"flex gap-3 flex-wrap",children:Yt.map((It,ae)=>{const{icon:vn,label:Xn}=St(It.redeem_item_type||0);return l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[It.redeem_item_image&&l.jsx("img",{src:To(It.redeem_item_image,100),alt:"",className:"w-12 h-12 rounded-lg object-cover",referrerPolicy:"no-referrer"}),l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-[var(--muted-foreground)]",children:[l.jsx(vn,{className:"w-3 h-3"}),l.jsx("span",{children:Xn})]})]},ae)})})]})})()]})]}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-background/95 backdrop-blur-sm border-t border-[var(--border)]",children:rt?l.jsx("button",{onClick:()=>!L&&et(),disabled:L,className:`w-full btn-3d py-3 ${L?"btn-3d-gray opacity-60":"btn-3d-yellow"}`,children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Ue,{className:"w-5 h-5"}),l.jsx("span",{children:L?" nhn phn thng":"Nhn phn thng"})]})}):l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>J(1),disabled:A||!i||i.gems<on.COST_PER_PULL,className:"flex-1 btn-3d btn-3d-purple py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Quay x1"})]}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs opacity-80 mt-0.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{children:on.COST_PER_PULL})]})]}),l.jsxs("button",{onClick:()=>J(10),disabled:A||!i||i.gems<on.COST_PER_PULL*10,className:"flex-1 btn-3d btn-3d-red py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Quay x10"})]}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs opacity-80 mt-0.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{children:on.COST_PER_PULL*10})]})]})]})}),x&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>C(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:ot=>ot.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:x.width>0&&x.height>0?x.width/x.height:2/3},children:l.jsx(_b,{videoList:x.video_list,imageUrl:x.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:W,lotteryId:(Nt=h[w])==null?void 0:Nt.lottery_id})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:pt(x.card_scarcity)},children:gr(x.card_scarcity)}),Ma(x.video_list)&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]})]}),l.jsx("button",{onClick:()=>C(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})}),l.jsx(cht,{isOpen:E,onClose:()=>{R(!1),T([]),U(!1)},results:N,isLoading:A,skipLoading:K}),D&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>F(!1),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full",onClick:ot=>ot.stopPropagation(),children:[l.jsxs("div",{className:"p-4 border-b border-[var(--border)] text-center",children:[l.jsxs("h2",{className:"font-bold text-lg flex items-center justify-center gap-2",children:[l.jsx(Ue,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Phn thng su tp"]}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mt-1",children:"Chc mng bn  hon thnh b su tp!"})]}),l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"flex justify-center gap-4 mb-4",children:z().map((ot,Tt)=>{const Et=Yt=>{switch(Yt){case 3:return"Khung";case 1001:return"Huy hiu";case 1e3:return"Avatar";default:return"Thng"}};return l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[ot.redeem_item_image&&l.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden border-2 border-[var(--duo-yellow)] bg-[var(--secondary)]",children:l.jsx("img",{src:To(ot.redeem_item_image,100),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"})}),l.jsx("span",{className:"text-xs font-medium text-[var(--muted-foreground)]",children:Et(ot.redeem_item_type||0)})]},Tt)})}),l.jsx("button",{onClick:()=>F(!1),className:"w-full btn-3d btn-3d-purple py-3",children:"ng"})]})]})}),l.jsx(lht,{isOpen:ht,onClose:()=>Y(!1),collectionId:W,urCards:((ct=G==null?void 0:G.item_list)==null?void 0:ct.filter(ot=>ot.card_scarcity===40))||[],inventory:k,userId:(i==null?void 0:i.oderId)||"",onExchangeSuccess:ot=>{T([{cardImg:ot.card_img,cardScarcity:ot.card_scarcity,isNew:!0,shardsGained:0,videoList:ot.video_list,width:ot.width,height:ot.height}]),U(!0),R(!0),j()}})]})}function uht(){var k,P,A,M,N;const e=we(),{user:t,equipAvatar:n,equipFrame:i,equipBadge:r,incrementDailyAvatarChanged:s,incrementDailyFrameChanged:o,incrementDailyBadgeChanged:a}=Zt(),[c,h]=I.useState("avatar"),u=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="avatar"):[]},[(k=t==null?void 0:t.gachaInventory)==null?void 0:k.rewards]),d=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="frame"):[]},[(P=t==null?void 0:t.gachaInventory)==null?void 0:P.rewards]),f=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="badge"):[]},[(A=t==null?void 0:t.gachaInventory)==null?void 0:A.rewards]),v=(t==null?void 0:t.equippedAvatar)||(t==null?void 0:t.avatar),y=t==null?void 0:t.equippedFrame,w=t==null?void 0:t.equippedBadge,_=async T=>{await n(T),await s()},x=async T=>{await i(T),await o()},C=async T=>{await r(T),await a()};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(j_,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xt,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Trang b"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Ty chnh h s"})]})]})}),l.jsx("div",{className:"px-4 pt-24 pb-4",children:l.jsxs("div",{className:"card-3d p-6 flex flex-col items-center",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-3",children:"Xem trc"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center",children:[y&&l.jsx("img",{src:ke(y,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden border-2 border-[var(--border)]",children:v?l.jsx("img",{src:t!=null&&t.equippedAvatar?ke(v,100):v,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((M=t==null?void 0:t.odername)==null?void 0:M.charAt(0).toUpperCase())||"?"})]}),w&&l.jsx("div",{className:"w-12 h-12",children:l.jsx("img",{src:ke(w,100),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})})]}),l.jsx("p",{className:"font-bold text-foreground mt-3",children:t==null?void 0:t.odername}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:["Level ",(t==null?void 0:t.level)||1]})]})}),l.jsx("div",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>h("avatar"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="avatar"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(fl,{className:"w-4 h-4"}),"Avatar"]}),l.jsxs("button",{onClick:()=>h("frame"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="frame"?"bg-[var(--duo-blue)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(uf,{className:"w-4 h-4"}),"Khung"]}),l.jsxs("button",{onClick:()=>h("badge"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="badge"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(pr,{className:"w-4 h-4"}),"Huy hiu"]})]})}),l.jsxs("div",{className:"px-4 pb-28",children:[c==="avatar"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>_(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all ${t!=null&&t.equippedAvatar?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx("div",{className:"w-full h-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-xl",children:t!=null&&t.avatar?l.jsx("img",{src:t.avatar,alt:"",className:"w-full h-full object-cover"}):((N=t==null?void 0:t.odername)==null?void 0:N.charAt(0).toUpperCase())||"?"}),!(t!=null&&t.equippedAvatar)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]}),u.map((T,E)=>{const R=(t==null?void 0:t.equippedAvatar)===T.image;return l.jsxs("button",{onClick:()=>_(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:ke(T.image,150),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]},E)}),u.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]}),c==="frame"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>x(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] flex items-center justify-center ${t!=null&&t.equippedFrame?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx(uf,{className:"w-8 h-8 text-[var(--muted-foreground)]"}),!(t!=null&&t.equippedFrame)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]}),d.map((T,E)=>{const R=(t==null?void 0:t.equippedFrame)===T.image;return l.jsxs("button",{onClick:()=>x(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:ke(T.image,150),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]},E)}),d.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]}),c==="badge"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>C(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] flex items-center justify-center ${t!=null&&t.equippedBadge?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx(pr,{className:"w-8 h-8 text-[var(--muted-foreground)]"}),!(t!=null&&t.equippedBadge)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]}),f.map((T,E)=>{const R=(t==null?void 0:t.equippedBadge)===T.image;return l.jsxs("button",{onClick:()=>C(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:ke(T.image,150),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-3 h-3 text-white"})})]},E)}),f.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]})]})]})}const gy=12;function dht(){var P;const e=we(),{user:t,incrementDailyCardViewed:n}=Zt(),[i,r]=I.useState(!0),[s,o]=I.useState([]),[a,c]=I.useState("all"),[h,u]=I.useState(1),[d,f]=I.useState(null);I.useEffect(()=>{t!=null&&t.oderId&&v()},[t==null?void 0:t.oderId]),I.useEffect(()=>{u(1)},[a]);const v=async()=>{if(t!=null&&t.oderId){r(!0);try{const[A,M]=await Promise.all([Ha(t.oderId),mq()]),N=[],T=Object.keys(A.cards).map(Number);for(const E of T){const R=Object.keys(A.cards[E]);if(R.length===0)continue;const D=M.find(L=>L.id===E),F=(D==null?void 0:D.name)||(D==null?void 0:D.act_title)||`Collection ${E}`;try{const L=await ku(E);for(const lt of L)for(const ht of lt.item_list||[])R.includes(ht.card_img)&&N.push({card:ht,collectionId:E,collectionName:F,count:A.cards[E][ht.card_img]})}catch(L){console.warn(`Failed to load lotteries for collection ${E}:`,L)}}o(N)}catch(A){console.error("Error loading card inventory:",A)}finally{r(!1)}}},y=I.useMemo(()=>{switch(a){case"ur":return s.filter(A=>A.card.card_scarcity===40);case"sr":return s.filter(A=>A.card.card_scarcity===30);case"r":return s.filter(A=>A.card.card_scarcity===20);case"n":return s.filter(A=>A.card.card_scarcity===10);default:return s}},[s,a]),w=Math.ceil(y.length/gy),_=(h-1)*gy,x=y.slice(_,_+gy),C=I.useMemo(()=>({total:s.length,ur:s.filter(A=>A.card.card_scarcity===40).length,sr:s.filter(A=>A.card.card_scarcity===30).length,r:s.filter(A=>A.card.card_scarcity===20).length,n:s.filter(A=>A.card.card_scarcity===10).length}),[s]),k=A=>{switch(A){case"ur":return pt(40);case"sr":return pt(30);case"r":return pt(20);case"n":return pt(10);default:return"var(--duo-purple)"}};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-4 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ts,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Kho th"})]}),l.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[C.total," th  su tp"]})]})]})}),l.jsx("div",{className:"fixed top-[116px] left-0 right-0 z-40 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>c("all"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${a==="all"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:["Tt c (",C.total,")"]}),l.jsxs("button",{onClick:()=>c("ur"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="ur"?pt(40):"var(--secondary)",color:a==="ur"?"white":"var(--muted-foreground)"},children:[l.jsx(ge,{className:"w-4 h-4",fill:a==="ur"?"white":pt(40)}),"UR (",C.ur,")"]}),l.jsxs("button",{onClick:()=>c("sr"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="sr"?pt(30):"var(--secondary)",color:a==="sr"?"white":"var(--muted-foreground)"},children:[l.jsx(ge,{className:"w-4 h-4",fill:a==="sr"?"white":pt(30)}),"SR (",C.sr,")"]}),l.jsxs("button",{onClick:()=>c("r"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="r"?pt(20):"var(--secondary)",color:a==="r"?"white":"var(--muted-foreground)"},children:[l.jsx(ge,{className:"w-4 h-4",fill:a==="r"?"white":pt(20)}),"R (",C.r,")"]}),l.jsxs("button",{onClick:()=>c("n"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="n"?pt(10):"var(--secondary)",color:a==="n"?"white":"var(--muted-foreground)"},children:[l.jsx(ge,{className:"w-4 h-4",fill:a==="n"?"white":pt(10)}),"N (",C.n,")"]})]})}),l.jsx("div",{className:"px-4 pt-[180px] pb-24",children:i?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(Li,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]}):y.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(Ts,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:a==="all"?"Cha c th no":`Cha c th ${gr(a==="ur"?40:a==="sr"?30:a==="r"?20:10)}`})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-3 gap-2",children:x.map((A,M)=>{const N=Ma(A.card.video_list);return l.jsxs("button",{onClick:()=>{f(A),n()},className:"relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all hover:scale-105 active:scale-95",style:{borderColor:pt(A.card.card_scarcity)},children:[l.jsx("img",{src:To(A.card.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer",loading:"lazy"}),l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 rounded text-[10px] font-bold text-white",style:{backgroundColor:pt(A.card.card_scarcity)},children:gr(A.card.card_scarcity)}),N&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})}),A.count>1&&l.jsxs("div",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 rounded bg-black/70 text-[10px] font-bold text-white",children:["x",A.count]})]},`${A.collectionId}-${A.card.card_img}-${M}`)})}),w>1&&l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[l.jsx("button",{onClick:()=>u(A=>Math.max(1,A-1)),disabled:h===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(j_,{className:"w-4 h-4 text-foreground"})}),l.jsxs("div",{className:"px-4 py-2 rounded-xl text-white font-bold text-sm",style:{backgroundColor:k(a)},children:[h," / ",w]}),l.jsx("button",{onClick:()=>u(A=>Math.min(w,A+1)),disabled:h===w,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(sr,{className:"w-4 h-4 text-foreground"})})]})]})}),d&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>f(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:A=>A.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:d.card.width>0&&d.card.height>0?d.card.width/d.card.height:2/3},children:l.jsx(_b,{videoList:d.card.video_list,imageUrl:d.card.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:d.collectionId})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:pt(d.card.card_scarcity)},children:gr(d.card.card_scarcity)}),l.jsxs("div",{className:"flex items-center gap-2",children:[((P=d.card.video_list)==null?void 0:P.length)>0&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]}),d.count>1&&l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:["x",d.count]})]})]}),l.jsx("button",{onClick:()=>f(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})})]})}function ght(){var U,W,j,q,J,G,Q,Z,O,B,rt;const{id:e}=yP(),t=we(),{user:n}=Zt(),[i,r]=I.useState(null),[s,o]=I.useState(!0),[a,c]=I.useState(null),[h,u]=I.useState([]),[d,f]=I.useState(!1),[v,y]=I.useState(!1),[w,_]=I.useState([]),[x,C]=I.useState([]),[k,P]=I.useState(!1),[A,M]=I.useState(null),[N,T]=I.useState(null),E=(n==null?void 0:n.oderId)===e;I.useEffect(()=>{e&&R(e)},[e]);const R=async z=>{o(!0),c(null);try{const et=Mt(kt,"users",z),nt=await Qr(et);if(!nt.exists()){c("Khng tm thy ngi dng");return}const mt=nt.data();r(mt);const Nt=mt.showcase;Nt&&Nt.length>0&&await D(Nt)}catch(et){console.error("Error fetching profile:",et),c("Khng th ti h s")}finally{o(!1)}},D=async z=>{f(!0);try{const et=[],nt=[...new Set(z.map(mt=>mt.collectionId))];for(const mt of nt){const Nt=await ku(mt);for(const ct of Nt)for(const ot of ct.item_list||[])z.find(Et=>Et.cardImg===ot.card_img&&Et.collectionId===mt)&&et.push({...ot,collectionId:mt})}u(et)}catch(et){console.error("Error loading showcase cards:",et)}finally{f(!1)}},F=async()=>{if(!(n!=null&&n.oderId))return;y(!0),P(!0);const z=(i==null?void 0:i.showcase)||[];C(z);try{const et=await Ha(n.oderId),nt=[],mt=Object.keys(et.cards).map(Number);for(const Nt of mt){const ct=Object.keys(et.cards[Nt]);if(ct.length===0)continue;const ot=await ku(Nt);for(const Tt of ot)for(const Et of Tt.item_list||[])ct.includes(Et.card_img)&&nt.push({...Et,collectionId:Nt})}_(nt)}catch(et){console.error("Error loading owned cards:",et)}finally{P(!1)}},L=z=>{if(x.find(nt=>nt.cardImg===z.card_img&&nt.collectionId===z.collectionId))C(x.filter(nt=>!(nt.cardImg===z.card_img&&nt.collectionId===z.collectionId)));else{if(x.length>=6)return;C([...x,{cardImg:z.card_img,collectionId:z.collectionId}])}},lt=async()=>{if(n!=null&&n.oderId)try{const{updateDoc:z}=await df(async()=>{const{updateDoc:nt}=await Promise.resolve().then(()=>sD);return{updateDoc:nt}},void 0),et=Mt(kt,"users",n.oderId);await z(et,{showcase:x}),await D(x),y(!1),i&&r({...i,showcase:x})}catch(z){console.error("Error saving showcase:",z)}};if(s)return l.jsx(re,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[l.jsx(Li,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]})});if(a||!i)return l.jsx(re,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen px-4",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:a}),l.jsx("button",{onClick:()=>t(-1),className:"btn-3d btn-3d-purple px-4 py-2",children:"Quay li"})]})});const ht=ps(((U=i.conquestStats)==null?void 0:U.rankPoints)??0),Y=(W=i.gachaInventory)==null?void 0:W.gachaStats,K=((Y==null?void 0:Y.totalURCards)??0)+((Y==null?void 0:Y.totalSRCards)??0)+((Y==null?void 0:Y.totalRCards)??0)+((Y==null?void 0:Y.totalNCards)??0);return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] pt-4 pb-4 px-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>t(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"H s"})]})}),l.jsxs("div",{className:"pt-24 pb-24 px-4",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center shrink-0",children:[i.equippedFrame&&l.jsx("img",{src:ke(i.equippedFrame,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden",children:i.equippedAvatar||i.avatar?l.jsx("img",{src:i.equippedAvatar?ke(i.equippedAvatar,100):i.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((j=i.odername)==null?void 0:j.charAt(0).toUpperCase())||"?"})]}),i.equippedBadge&&l.jsx("div",{className:"w-12 h-12 shrink-0",children:l.jsx("img",{src:ke(i.equippedBadge,80),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h2",{className:"font-bold text-lg text-foreground truncate",children:i.odername||"Ngi chi"}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:["Level ",i.level??1]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:Pa(ht),alt:"",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:((q=i.conquestStats)==null?void 0:q.rankPoints)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Rank Points"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:i.streak??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Streak"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:i.exp??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"XP"})]})]}),l.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--border)]",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mb-2",children:"im theo lnh vc"}),l.jsxs("div",{className:"grid grid-cols-5 gap-1.5",children:[l.jsxs("div",{className:"bg-[var(--duo-green)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-green)]",children:((i.totalCorrect??0)*10+(i.perfectLessons??0)*50).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Quiz"})]}),l.jsxs("div",{className:"bg-[var(--duo-purple)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-purple)]",children:((((J=i.conquestStats)==null?void 0:J.rankPoints)??0)+(((G=i.conquestStats)==null?void 0:G.totalConquests)??0)*5).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Battle"})]}),l.jsxs("div",{className:"bg-[var(--duo-yellow)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-yellow)]",children:(((Y==null?void 0:Y.totalURCards)??0)*100+((Y==null?void 0:Y.totalSRCards)??0)*50+((Y==null?void 0:Y.totalRCards)??0)*20+((Y==null?void 0:Y.totalNCards)??0)*5).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Gacha"})]}),l.jsxs("div",{className:"bg-[var(--duo-orange)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-orange)]",children:"-"}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Tower"})]}),l.jsxs("div",{className:"bg-[var(--duo-blue)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-blue)]",children:((((Q=i.achievements)==null?void 0:Q.length)??0)*25).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Achieve"})]})]})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("h3",{className:"font-bold mb-3 flex items-center gap-2",children:[l.jsx(wi,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Chinh Chin"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tng trn:"}),l.jsx("span",{className:"font-bold",children:((Z=i.conquestStats)==null?void 0:Z.totalConquests)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Chui thng:"}),l.jsx("span",{className:"font-bold",children:((O=i.conquestStats)==null?void 0:O.bestWinStreak)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tr li ng:"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:((B=i.conquestStats)==null?void 0:B.totalConquestCorrect)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tr li sai:"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:((rt=i.conquestStats)==null?void 0:rt.totalConquestWrong)??0})]})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("h3",{className:"font-bold mb-3 flex items-center gap-2",children:[l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"B su tp"]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:pt(40)},children:(Y==null?void 0:Y.totalURCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"UR"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:pt(30)},children:(Y==null?void 0:Y.totalSRCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"SR"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:pt(20)},children:(Y==null?void 0:Y.totalRCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"R"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",children:K}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"T trng by"]}),E&&!v&&l.jsxs("button",{onClick:F,className:"btn-3d btn-3d-blue px-4 py-1.5 rounded-xl text-sm font-bold text-white flex items-center gap-1.5",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),"Chnh sa"]})]}),d?l.jsx("div",{className:"flex justify-center py-8",children:l.jsx(Li,{className:"w-6 h-6 animate-spin text-[var(--muted-foreground)]"})}):h.length===0&&!v?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Xt,{className:"w-12 h-12 text-[var(--muted-foreground)] mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:E?"Cha c th trng by. Bm chnh sa  thm!":"Cha c th trng by"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-2",children:h.map((z,et)=>l.jsxs("button",{onClick:()=>T(z),className:"relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-transform hover:scale-105 active:scale-95",style:{borderColor:pt(z.card_scarcity)},children:[l.jsx("img",{src:To(z.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 rounded text-[10px] font-bold text-white",style:{backgroundColor:pt(z.card_scarcity)},children:gr(z.card_scarcity)}),Ma(z.video_list)&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})})]},`${z.collectionId}-${z.card_img}-${et}`))})]})]}),N&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>T(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:z=>z.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:N.width>0&&N.height>0?N.width/N.height:2/3},children:l.jsx(_b,{videoList:N.video_list,imageUrl:N.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:N.collectionId})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:pt(N.card_scarcity)},children:gr(N.card_scarcity)}),Ma(N.video_list)&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]})]}),l.jsx("button",{onClick:()=>T(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})}),v&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:()=>y(!1),children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[90vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:z=>z.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("button",{onClick:()=>y(!1),className:"w-10 h-10 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"font-bold text-lg",children:"T trng by"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn th yu thch  khoe"})]}),l.jsxs("button",{onClick:lt,className:"btn-3d btn-3d-green px-4 py-2 rounded-xl text-sm font-bold text-white flex items-center gap-1.5",children:[l.jsx(In,{className:"w-4 h-4"}),"Lu"]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-semibold text-[var(--muted-foreground)]",children:" chn"}),l.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-[var(--duo-purple)]/20 text-[var(--duo-purple)]",children:[x.length,"/6"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex gap-2 overflow-x-auto flex-1 py-1 scrollbar-hide",children:x.length===0?l.jsxs("div",{className:"flex items-center gap-2 py-3",children:[l.jsx(Xt,{className:"w-4 h-4 text-[var(--muted-foreground)]"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chm vo th bn di  chn"})]}):x.map((z,et)=>{const nt=w.find(mt=>mt.card_img===z.cardImg&&mt.collectionId===z.collectionId);return nt?l.jsxs("button",{onClick:()=>L(nt),className:"relative w-14 h-[4.5rem] rounded-xl overflow-hidden border-2 shrink-0 group shadow-md hover:shadow-lg transition-all hover:scale-105",style:{borderColor:pt(nt.card_scarcity)},children:[l.jsx("img",{src:To(nt.card_img,100),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 group-active:opacity-100 transition-opacity",children:l.jsx(Fr,{className:"w-5 h-5 text-white"})})]},et):null})}),x.length>0&&l.jsx("button",{onClick:()=>C([]),className:"p-2 rounded-xl shrink-0 bg-[var(--duo-red)]/15 border-2 border-[var(--duo-red)]/30 active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--duo-red)]"})})]})]})}),l.jsx("div",{className:"px-5 pb-3",children:l.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>M(null),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-xs font-bold whitespace-nowrap transition-all ${A===null?"bg-gradient-to-r from-[var(--duo-purple)] to-purple-500 text-white shadow-lg shadow-[var(--duo-purple)]/30":"bg-[var(--secondary)] text-[var(--muted-foreground)] hover:bg-[var(--border)]"}`,children:[l.jsx(Xt,{className:"w-3.5 h-3.5"}),"Tt c"]}),[40,30,20,10].map(z=>l.jsxs("button",{onClick:()=>M(z),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-xs font-bold whitespace-nowrap transition-all",style:{background:A===z?`linear-gradient(135deg, ${pt(z)}, ${pt(z)}dd)`:"var(--secondary)",color:A===z?"white":"var(--muted-foreground)",boxShadow:A===z?`0 4px 12px ${pt(z)}40`:"none"},children:[l.jsx(ge,{className:"w-3.5 h-3.5",fill:A===z?"white":pt(z)}),gr(z)]},z))]})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:k?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[l.jsx(Li,{className:"w-10 h-10 animate-spin text-[var(--duo-purple)] mb-3"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"ang ti th..."})]}):w.length===0?l.jsxs("div",{className:"text-center py-16",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Ts,{className:"w-10 h-10 text-[var(--muted-foreground)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)] font-medium",children:"Cha c th no"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Hy quay gacha  su tm th nh!"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-3",children:w.filter(z=>A===null||z.card_scarcity===A).map((z,et)=>{const nt=x.some(mt=>mt.cardImg===z.card_img&&mt.collectionId===z.collectionId);return l.jsxs("button",{onClick:()=>L(z),className:`relative aspect-[3/4] rounded-2xl overflow-hidden border-2 transition-all duration-200 ${nt?"ring-3 ring-[var(--duo-green)] ring-offset-2 ring-offset-[var(--background)] scale-[0.98]":"hover:scale-[1.02] active:scale-[0.98]"}`,style:{borderColor:pt(z.card_scarcity),boxShadow:nt?`0 8px 24px ${pt(z.card_scarcity)}40`:`0 4px 12px ${pt(z.card_scarcity)}20`},children:[l.jsx("img",{src:To(z.card_img,200),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute top-1.5 left-1.5 px-2 py-0.5 rounded-full text-[10px] font-bold text-white shadow-sm",style:{backgroundColor:pt(z.card_scarcity)},children:gr(z.card_scarcity)}),nt&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[var(--duo-green)]/60 to-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-lg",children:l.jsx(In,{className:"w-6 h-6 text-[var(--duo-green)]"})})})]},`${z.collectionId}-${z.card_img}-${et}`)})})})]})})]})}const fht=[{id:"random",name:"Ngu nhin",desc:"10 cu hi ngu nhin",icon:hB,color:"#ff9600",shadow:"#ea7e00"},{id:"quick",name:"Nhanh",desc:"5 cu - Luyn nhanh",icon:Lr,color:"#58cc02",shadow:"#46a302"},{id:"timeattack",name:"Chy ua",desc:"10 cu trong 60 giy",icon:Uu,color:"#1cb0f6",shadow:"#1899d6"},{id:"survival",name:"Hardcore",desc:"10 cu - 1 sai = Thua",icon:U_,color:"#ff4b4b",shadow:"#ea2b2b"}];function mht(){const e=we(),{startRandomQuiz:t,startTimeAttack:n,startSurvival:i}=ds(),{user:r}=Zt(),s=a=>{switch(a){case"random":t(10);break;case"quick":t(5);break;case"timeattack":n(60);break;case"survival":i(1);break}e("/quiz")},o=a=>{s(a)};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-4 pb-4 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Xi,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-foreground",children:"Luyn Tp"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn ch  luyn"})]})]})}),r&&l.jsxs("div",{className:"px-4 py-3 flex items-center justify-center gap-6 bg-[var(--card)] border-b-2 border-[var(--border)]",children:[l.jsx("div",{className:"flex items-center gap-1.5 bg-[var(--duo-green)]/20 px-3 py-1 rounded-full",children:l.jsx("span",{className:"text-sm font-bold text-[var(--duo-green)]",children:"Khng gii hn tim"})}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold text-foreground",children:[Mn(r.exp)," XP"]})]})]}),l.jsx("div",{className:"px-4 py-6 space-y-4",children:fht.map(a=>{const c=a.icon;return l.jsxs("button",{onClick:()=>o(a.id),className:"btn-mode w-full p-4 rounded-2xl text-left flex items-center gap-4",style:{background:a.color,boxShadow:`0 5px 0 ${a.shadow}`,"--shadow-color":a.shadow},children:[l.jsx("div",{className:"w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center",children:l.jsx(c,{className:"w-8 h-8 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-lg text-white",children:a.name}),l.jsx("p",{className:"text-sm text-white/80",children:a.desc})]})]},a.id)})})]})}const pht=5,ag={rankPoints:0,highestRankId:"wood_1",totalConquests:0,totalConquestCorrect:0,totalConquestWrong:0,bestWinStreak:0,currentWinStreak:0,lastConquestDate:""},Zb=Bu((e,t)=>({isActive:!1,isLoading:!1,questions:[],currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:0,rank:ps(0),rankPoints:0,initialRankPoints:0,initialRankId:"wood_1",userId:"",results:[],loadConquestStats:async n=>{try{const i=Mt(kt,"users",n),r=await Qr(i);return r.exists()&&r.data().conquestStats||ag}catch(i){return console.error("Error loading conquest stats:",i),ag}},startConquest:async(n,i=0)=>{e({isLoading:!0});const r=await t().loadConquestStats(n),s=(r==null?void 0:r.rankPoints)||i,o=ps(s);try{const a=await Ort(o,pht);e({isActive:!0,isLoading:!1,questions:a,currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:Date.now(),rank:o,rankPoints:s,initialRankPoints:s,initialRankId:o.rankId,userId:n,results:[]})}catch(a){console.error("Error starting conquest:",a),e({isLoading:!1})}},submitAnswer:n=>{const{questions:i,currentIndex:r,rank:s,rankPoints:o,results:a,correctCount:c,wrongCount:h,score:u}=t(),d=i[r];if(!d)return{correct:!1,points:0};const f=$rt(d,n),y=Brt(f,s,0),w=Grt(s),_=o+y,x=Math.max(w,_),C=ps(x);return e({correctCount:f?c+1:c,wrongCount:f?h:h+1,score:u+(f?10:0),rankPoints:x,rank:C,results:[...a,{questionId:d.id,correct:f,points:y}]}),{correct:f,points:y}},nextQuestion:async()=>{const{currentIndex:n,questions:i}=t(),r=n+1;return r>=i.length?!1:(e({currentIndex:r}),!0)},endConquest:async()=>{const{score:n,correctCount:i,wrongCount:r,results:s,userId:o,rankPoints:a,rank:c,initialRankPoints:h,initialRankId:u,startTime:d}=t(),f=s.reduce((w,_)=>w+_.points,0),v=i+r,y=v>0?Math.round(i/v*100):0;if(e({isActive:!1}),o)try{const w=Mt(kt,"users",o),_=await Qr(w);if(_.exists()){const x=_.data(),C=x.conquestStats||ag,k=f>0,P=k?C.currentWinStreak+1:0,A=Math.max(C.bestWinStreak,P),M=C.highestRankId||"wood",N=c.rankId;let T=0;if(N!==M&&a>(C.rankPoints||0)){const ht=Hrt[N];ht&&(T=ht.gems)}const E={rankPoints:a,highestRankId:a>(C.rankPoints||0)?c.rankId:C.highestRankId,totalConquests:C.totalConquests+1,totalConquestCorrect:C.totalConquestCorrect+i,totalConquestWrong:C.totalConquestWrong+r,bestWinStreak:A,currentWinStreak:P,lastConquestDate:new Date().toISOString()};let R=Math.max(0,Math.floor(f/10));y>=90&&i>=3&&(R+=5);const D=Zt.getState(),F=D.getXPMultiplier(),L=i*10*F;await Gt(w,{conquestStats:E,totalCorrect:(x.totalCorrect||0)+i,totalWrong:(x.totalWrong||0)+r,exp:(x.exp||0)+L,gems:(x.gems||0)+R+T});const lt={oderId:o,startTime:new Date(d).toISOString(),endTime:new Date().toISOString(),rankBefore:u,rankAfter:c.rankId,pointsBefore:h,pointsAfter:a,pointsGained:f,correctCount:i,wrongCount:r,totalQuestions:v,accuracy:y};await tp(Wr(kt,"conquestSessions"),lt),await D.incrementDailyConquests(),k&&await D.incrementWeeklyConquestWins(),console.log("Conquest synced to Firebase:",E)}}catch(w){console.error("Error syncing conquest to Firebase:",w)}return{totalScore:n,correct:i,wrong:r,pointsGained:f}},resetConquest:()=>{e({isActive:!1,isLoading:!1,questions:[],currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:0,initialRankPoints:0,initialRankId:"wood_1",results:[]})}}));function vht({question:e,onAnswer:t,disabled:n}){const i=e.pairs||[],[r,s]=I.useState(null),[o,a]=I.useState({}),c=i.map((w,_)=>({text:w.left,index:_})),h=i.map((w,_)=>({text:w.right,index:_})),u=w=>{n||s(w)},d=w=>{if(n||r===null)return;const _={...o,[r]:w};a(_),s(null);const x=Object.entries(_).map(([C,k])=>`${C}-${k}`);t(x)},f=()=>{n||(a({}),s(null),t([]))},v=w=>o[w],y=w=>Object.values(o).includes(w);return l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Chn mt mc bn tri, sau  chn mc tng ng bn phi"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("div",{className:"space-y-2",children:c.map(w=>{const _=r===w.index,x=v(w.index)!==void 0;return l.jsx("button",{onClick:()=>u(w.index),disabled:n,className:Vt("option-btn w-full p-3 text-left text-sm",_&&"selected",x&&"correct"),children:w.text},`left-${w.index}`)})}),l.jsx("div",{className:"space-y-2",children:h.map(w=>{const _=y(w.index);return l.jsx("button",{onClick:()=>d(w.index),disabled:n||r===null||_,className:Vt("option-btn w-full p-3 text-left text-sm",_&&"correct",r!==null&&!_&&"border-[var(--duo-blue)]/50"),children:w.text},`right-${w.index}`)})})]}),Object.keys(o).length>0&&l.jsxs("div",{className:"card-3d p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" ni:"}),!n&&l.jsxs("button",{onClick:f,className:"flex items-center gap-1 px-2 py-1 rounded-lg bg-[var(--duo-orange)]/20 text-[var(--duo-orange)] text-xs font-bold",children:[l.jsx(du,{className:"w-3 h-3"}),"Lm li"]})]}),l.jsx("div",{className:"space-y-1",children:Object.entries(o).map(([w,_])=>{var x,C;return l.jsxs("p",{className:"text-sm text-foreground",children:[(x=c[Number(w)])==null?void 0:x.text," "," ",(C=h[_])==null?void 0:C.text]},w)})})]})]})}function yht({question:e,onAnswer:t,disabled:n}){const[i,r]=I.useState(()=>[...e.items||[]].sort(()=>Math.random()-.5)),s=(o,a)=>{if(n)return;const c=a==="up"?o-1:o+1;if(c<0||c>=i.length)return;const h=[...i];[h[o],h[c]]=[h[c],h[o]],r(h),t(h)};return l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Sp xp cc mc theo th t ng (dng nt mi tn  di chuyn)"}),l.jsx("div",{className:"space-y-2",children:i.map((o,a)=>l.jsxs("div",{className:"option-btn flex items-center gap-2 p-3",children:[l.jsx(GO,{className:"w-5 h-5 text-[var(--muted-foreground)]"}),l.jsx("span",{className:"w-7 h-7 rounded-lg bg-[var(--duo-blue)] text-white text-sm font-bold flex items-center justify-center",children:a+1}),l.jsx("span",{className:"flex-1 text-foreground text-sm",children:o}),!n&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>s(a,"up"),disabled:a===0,className:Vt("w-8 h-8 rounded-lg flex items-center justify-center",a===0?"bg-[var(--secondary)] opacity-30":"bg-[var(--duo-blue)] text-white"),children:l.jsx(aO,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>s(a,"down"),disabled:a===i.length-1,className:Vt("w-8 h-8 rounded-lg flex items-center justify-center",a===i.length-1?"bg-[var(--secondary)] opacity-30":"bg-[var(--duo-blue)] text-white"),children:l.jsx(rO,{className:"w-4 h-4"})})]})]},`${o}-${a}`))}),n&&e.correctAnswer&&l.jsxs("div",{className:"card-3d p-3",style:{background:"rgba(88, 204, 2, 0.15)",borderColor:"var(--duo-green)"},children:[l.jsx("p",{className:"text-xs text-[var(--duo-green)] mb-1 font-bold",children:"Th t ng:"}),l.jsx("ol",{className:"list-decimal list-inside text-sm text-[var(--duo-green)]",children:e.correctAnswer.map((o,a)=>l.jsx("li",{children:o},a))})]})]})}const xht=["d n","qun l","k hoch","tin ","chi ph","cht lng","ri ro","phm vi","ngun lc","thi gian","giao tip","truyn thng","kim sot","gim st","nh gi"];function _ht({question:e,onAnswer:t,disabled:n}){const[i,r]=I.useState(null),s=I.useMemo(()=>{const c=String(e.correctAnswer);let h=[];return e.distractors&&e.distractors.length>=3?h=e.distractors.slice(0,3):h=xht.filter(v=>v.toLowerCase()!==c.toLowerCase()).sort(()=>Math.random()-.5).slice(0,3),[...h,c].sort(()=>Math.random()-.5)},[e.correctAnswer,e.distractors]),o=c=>{n||(r(c),t(c))},a=e.question.split("___");return l.jsxs("div",{className:"space-y-5",children:[l.jsx("div",{className:"card-3d p-4",children:l.jsxs("p",{className:"text-base text-foreground leading-relaxed",children:[a[0],l.jsx("span",{className:Vt("inline-block min-w-[80px] mx-1 px-3 py-1 rounded-lg border-2 border-dashed text-center",i?"border-[var(--duo-blue)] bg-[var(--duo-blue)]/20 text-[var(--duo-blue)] font-bold":"border-[var(--muted-foreground)] text-[var(--muted-foreground)]"),children:i||"______"}),a[1]]})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-3",children:"Chn t ph hp:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((c,h)=>{const u=i===c,d=n&&c===e.correctAnswer,f=n&&u&&c!==e.correctAnswer;return l.jsx("button",{onClick:()=>o(c),disabled:n,className:Vt("px-4 py-2.5 rounded-xl font-bold text-sm border-2",d&&"bg-[var(--duo-green)]/20 border-[var(--duo-green)] text-[var(--duo-green)]",f&&"bg-[var(--duo-red)]/20 border-[var(--duo-red)] text-[var(--duo-red)]",u&&!n&&"bg-[var(--duo-blue)]/20 border-[var(--duo-blue)] text-[var(--duo-blue)]",!u&&!d&&!f&&"bg-[var(--card)] border-[var(--border)] text-foreground shadow-[0_4px_0_var(--border)]",!n&&"active:translate-y-1 active:shadow-none"),children:c},h)})})]}),n&&i!==e.correctAnswer&&l.jsx("div",{className:"p-3 rounded-xl bg-[var(--duo-green)]/20 border-2 border-[var(--duo-green)]",children:l.jsxs("p",{className:"text-sm text-[var(--duo-green)]",children:["p n ng: ",l.jsx("strong",{children:String(e.correctAnswer)})]})})]})}function wht({question:e,onAnswer:t,disabled:n}){var a;const[i,r]=I.useState([]),s=c=>{if(n)return;const h=i.includes(c)?i.filter(u=>u!==c):[...i,c];r(h),t(h)},o=Array.isArray(e.correctAnswer)?e.correctAnswer:[e.correctAnswer];return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl bg-[var(--duo-purple)]/20 border border-[var(--duo-purple)]/30",children:[l.jsx(rk,{className:"w-4 h-4 text-[var(--duo-purple)]"}),l.jsxs("p",{className:"text-xs text-[var(--duo-purple)] font-medium",children:["Chn TT C p n ng (",o.length," p n)"]})]}),l.jsx("div",{className:"space-y-2.5",children:(a=e.options)==null?void 0:a.map((c,h)=>{const u=i.includes(c),d=o.includes(c),f=n&&d,v=n&&u&&!d,y=n&&!u&&d;return l.jsxs("button",{onClick:()=>s(c),disabled:n,className:Vt("option-btn w-full p-3 text-left flex items-center gap-3",u&&!n&&"selected",f&&"correct",v&&"wrong",y&&"border-[var(--duo-yellow)] bg-[var(--duo-yellow)]/10"),children:[l.jsx("div",{className:Vt("w-7 h-7 rounded-lg flex items-center justify-center shrink-0",f&&"bg-[var(--duo-green)] text-white",v&&"bg-[var(--duo-red)] text-white",y&&"bg-[var(--duo-yellow)] text-white",!n&&u&&"bg-[var(--duo-blue)] text-white",!n&&!u&&"bg-[var(--secondary)] text-[var(--muted-foreground)]"),children:f?l.jsx(Tr,{className:"w-4 h-4"}):v?l.jsx($r,{className:"w-4 h-4"}):y?l.jsx(Tr,{className:"w-4 h-4"}):u?l.jsx(rk,{className:"w-4 h-4"}):l.jsx(pB,{className:"w-4 h-4"})}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:c})]},h)})}),n&&l.jsxs("div",{className:"text-xs text-[var(--muted-foreground)] mt-2",children:["Bn chn ng:"," ",i.filter(c=>o.includes(c)).length,"/",o.length]})]})}function bht({question:e,onAnswer:t,disabled:n}){var o;const[i,r]=I.useState(null),s=a=>{n||(r(a),t(a))};return l.jsxs("div",{className:"space-y-4",children:[e.scenario&&l.jsx("div",{className:"card-3d p-4 bg-gradient-to-br from-[var(--duo-purple)]/10 to-[var(--duo-blue)]/10 border-[var(--duo-purple)]/30",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center shrink-0",children:l.jsx(VO,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-purple)] mb-1",children:"TNH HUNG"}),l.jsx("p",{className:"text-sm text-foreground leading-relaxed",children:e.scenario})]})]})}),l.jsx("div",{className:"space-y-2.5",children:(o=e.options)==null?void 0:o.map((a,c)=>{const h=i===a,u=a===e.correctAnswer,d=n&&u,f=n&&h&&!u;return l.jsxs("button",{onClick:()=>s(a),disabled:n,className:Vt("option-btn w-full p-3 text-left flex items-center gap-3",h&&!n&&"selected",d&&"correct",f&&"wrong"),children:[l.jsx("div",{className:Vt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",d&&"bg-[var(--duo-green)] text-white",f&&"bg-[var(--duo-red)] text-white",!n&&!h&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",h&&!n&&"bg-[var(--duo-blue)] text-white"),children:d?l.jsx(Tr,{className:"w-4 h-4"}):f?l.jsx($r,{className:"w-4 h-4"}):String.fromCharCode(65+c)}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:a})]},c)})})]})}function Tht({question:e,onEnd:t}){const{submitAnswer:n,nextQuestion:i,isLoading:r,questions:s,currentIndex:o}=Zb(),[a,c]=I.useState(null),[h,u]=I.useState(!1),[d,f]=I.useState(null),[v,y]=I.useState(!1),w=(o+1)/s.length*100,_=o===s.length-1,x=()=>{if(!a)return;const A=n(a);f(A),u(!0),A.correct&&Ee({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]})},C=async()=>{if(y(!0),!await i()){t();return}c(null),u(!1),f(null),y(!1)},k=()=>{var A;return l.jsx("div",{className:"space-y-2.5",children:(A=e.options)==null?void 0:A.map((M,N)=>{const T=a===M,E=M===e.correctAnswer,R=h&&E,D=h&&T&&!E;return l.jsxs("button",{onClick:()=>!h&&c(M),disabled:h,className:Vt("option-btn w-full p-3 text-left flex items-center gap-3",T&&!h&&"selected",R&&"correct",D&&"wrong"),children:[l.jsx("div",{className:Vt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",R&&"bg-[var(--duo-green)] text-white",D&&"bg-[var(--duo-red)] text-white",!h&&!T&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",T&&!h&&"bg-[var(--duo-blue)] text-white"),children:R?l.jsx(Tr,{className:"w-4 h-4"}):D?l.jsx($r,{className:"w-4 h-4"}):String.fromCharCode(65+N)}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:M})]},N)})})},P=()=>{switch(e.type){case"matching":return l.jsx(vht,{question:e,onAnswer:c,disabled:h});case"ordering":return l.jsx(yht,{question:e,onAnswer:c,disabled:h});case"fill_blank":return l.jsx(_ht,{question:e,onAnswer:c,disabled:h});case"multi_select":return l.jsx(wht,{question:e,onAnswer:c,disabled:h});case"scenario":return l.jsx(bht,{question:e,onAnswer:c,disabled:h});case"multiple_choice":case"true_false":default:return k()}};return l.jsxs("div",{className:"flex flex-col h-full px-4 py-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${w}%`}})}),l.jsx("div",{className:"flex justify-between items-center mt-2 text-sm",children:l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Cu ",o+1,"/",s.length]})})]}),l.jsxs("div",{className:Vt("inline-block px-3 py-1 rounded-full text-xs mb-3 w-fit",e.type==="multi_select"&&"bg-[var(--duo-purple)]/20 text-[var(--duo-purple)]",e.type==="scenario"&&"bg-[var(--duo-orange)]/20 text-[var(--duo-orange)]",e.type!=="multi_select"&&e.type!=="scenario"&&"bg-[var(--secondary)] text-[var(--muted-foreground)]"),children:[e.type==="multiple_choice"&&"Trc nghim",e.type==="true_false"&&"ng/Sai",e.type==="fill_blank"&&"in t",e.type==="matching"&&"Ni cp",e.type==="ordering"&&"Sp xp",e.type==="multi_select"&&"Chn nhiu",e.type==="scenario"&&"Tnh hung"]}),l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:e.question}),l.jsx("div",{className:"flex-1",children:P()}),l.jsx("div",{className:"h-28"}),l.jsx("div",{className:Vt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",h&&d?d.correct?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:h&&d?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.correct?l.jsx(Tr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:Vt("font-bold text-xl",d.correct?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:d.correct?"Chnh xc!":"Sai mt ri!"}),l.jsxs("span",{className:Vt("font-bold text-lg",d.correct?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:[d.points>=0?"+":"",d.points," RP"]})]}),e.explanation&&l.jsx("p",{className:Vt("text-sm mt-1 line-clamp-2",d.correct?"text-[var(--duo-green)]/70":"text-[var(--duo-red)]/70"),children:e.explanation})]})]}),l.jsx("button",{onClick:C,disabled:v,className:Vt("btn-3d w-full py-3.5 text-base",d.correct?"btn-3d-green":"btn-3d-orange"),children:v?"ANG TI...":_?"XEM KT QU":"TIP TC"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:x,disabled:!a||r,className:Vt("btn-3d w-full py-3.5 text-base",a?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})})]})}function Cht({result:e,rank:t,onPlayAgain:n,onGoBack:i}){const[r,s]=I.useState(!1),[o,a]=I.useState([]),{addGems:c}=Zt(),h=e.correct+e.wrong>0?Math.round(e.correct/(e.correct+e.wrong)*100):0;I.useEffect(()=>{(async()=>{const f=[],v=e.correct*25;let y=0,w="";h>=90&&e.correct>=3?(y=100,w="Bonus chinh chin!"):h>=70&&e.correct>=3&&(y=60,w="Chin u tt!");const _=v+y;_>0&&(await c(_),f.push({type:"gems",amount:_,label:w||`${e.correct} cu ng`}));const x=e.correct*10;x>0&&f.push({type:"xp",amount:x}),f.length>0&&(a(f),s(!0)),h>=70&&Ee({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#89e219","#ffc800","#ce82ff"]})})()},[h,e.correct,c]);const u=e.pointsGained>0;return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:r,onClose:()=>s(!1),title:u?"Chin thng!":"Hon thnh!",subtitle:`${e.pointsGained>=0?"+":""}${e.pointsGained} RP`,rewards:o,gradientFrom:u?"var(--duo-purple)":"var(--duo-blue)",gradientTo:u?"#ec4899":"var(--duo-purple)"}),l.jsxs("div",{className:"pt-4 px-4 pb-28",children:[l.jsx("div",{className:"text-center mb-6",children:l.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Kt Qu Chinh Chin"})}),l.jsxs("div",{className:"card-3d p-6 text-center mb-6",style:{background:"linear-gradient(135deg, var(--duo-purple) 0%, #ec4899 100%)",border:"none"},children:[l.jsx("img",{src:Pa(t),alt:t.rankName,className:"w-24 h-24 mx-auto mb-3 object-contain"}),l.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:t.rankName}),l.jsxs("p",{className:"text-white/80 mb-3",children:[t.points," Rank Points"]}),l.jsxs("div",{className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-full ${e.pointsGained>=0?"bg-[var(--duo-green)]":"bg-[var(--duo-red)]"}`,children:[e.pointsGained>=0?l.jsx(jP,{className:"w-4 h-4 text-white"}):l.jsx(CB,{className:"w-4 h-4 text-white"}),l.jsxs("span",{className:"font-bold text-white",children:[e.pointsGained>=0?"+":"",e.pointsGained," RP"]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx(Le,{className:"w-6 h-6 mx-auto mb-2 text-[var(--duo-yellow)]"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:e.totalScore}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"im"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx(Vi,{className:"w-6 h-6 mx-auto mb-2 text-[var(--duo-blue)]"}),l.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[h,"%"]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chnh xc"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsxs("div",{className:"flex justify-center gap-2 mb-2",children:[l.jsx("span",{className:"text-[var(--duo-green)] font-bold text-lg",children:e.correct}),l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"/"}),l.jsx("span",{className:"text-[var(--duo-red)] font-bold text-lg",children:e.wrong})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"ng/Sai"})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-6",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:" chnh xc"}),l.jsxs("span",{className:"font-bold text-foreground",children:[h,"%"]})]}),l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${h}%`,background:h>=80?"var(--duo-green)":h>=60?"var(--duo-yellow)":h>=40?"var(--duo-orange)":"var(--duo-red)"}})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:n,className:"btn-3d btn-3d-purple w-full py-3.5 text-base flex items-center justify-center gap-2",children:[l.jsx(du,{className:"w-5 h-5"}),"Chi Li"]}),l.jsxs("button",{onClick:i,className:"card-3d w-full py-3.5 text-base font-bold text-foreground flex items-center justify-center gap-2",children:[l.jsx(F_,{className:"w-5 h-5"}),"V Trang Ch"]})]})]})]})}function kht(e,t){const n=je.find(r=>r.id===e);if(!n)return"/Rank/Wood/rank-wood-1_NoOL_large.png";if(e==="master")return"/Rank/master.png";const i=8-t;return`/Rank/${n.folder}/rank-${e}-${i}_NoOL_large.png`}function Nht(e,t){const n=je.findIndex(a=>a.id===e);if(n===-1)return 0;const i=je[n],r=je[n+1];if(!r||i.id==="master")return i.minScore;const s=(r.minScore-i.minScore)/i.tiers,o=i.tiers-t;return Math.floor(i.minScore+o*s)}function Eht(){const e=[],t=je.filter(r=>r.id!=="master"),n={wood:100,stone:150,bronze:250,silver:400,gold:600,platinum:900,amethyst:1300,onyx:2e3};if(t.forEach(r=>{const s=n[r.id]||100;for(let o=7;o>=1;o--){const a=Nht(r.id,o),c=1+(8-o)*.15,h=Math.round(s*c);e.push({id:`${r.id}_${o}`,rankId:r.id,rankName:r.name,tier:o,minPoints:a,gems:h,label:`${r.name} ${o}`,rankFolder:r.folder})}}),je.find(r=>r.id==="master"))for(let r=4e3;r<=1e4;r+=100){const s=r,o=5e3+Math.floor((r-4e3)/100)*100;e.push({id:`master_${s}`,rankId:"master",rankName:"Huyn Thoi",tier:0,minPoints:s,gems:o,label:`Huyn Thoi ${s} RP`,isMaster:!0,masterMilestone:s})}return e}const fy=Eht();function Sht({isOpen:e,onClose:t,userRankPoints:n}){const{user:i,addGems:r}=Zt(),[s,o]=I.useState([]),[a,c]=I.useState(!1),[h,u]=I.useState(!1),[d,f]=I.useState(null);if(I.useEffect(()=>{i!=null&&i.claimedRankRewards&&o(i.claimedRankRewards)},[i==null?void 0:i.claimedRankRewards]),!e)return null;const v=k=>s.includes(k.id)?"claimed":n>=k.minPoints?"available":"locked",y=async k=>{if(!(!(i!=null&&i.oderId)||a)&&v(k)==="available"){c(!0);try{const P=[...s,k.id],A=Mt(kt,"users",i.oderId);await Gt(A,{claimedRankRewards:P}),await r(k.gems),o(P),f({gems:k.gems,label:k.label}),u(!0),Ee({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#ce82ff"]})}catch(P){console.error("Error claiming rank reward:",P)}finally{c(!1)}}},w=async()=>{if(!(i!=null&&i.oderId)||a)return;const k=fy.filter(P=>v(P)==="available");if(k.length!==0){c(!0);try{const P=k.map(T=>T.id),A=k.reduce((T,E)=>T+E.gems,0),M=[...s,...P],N=Mt(kt,"users",i.oderId);await Gt(N,{claimedRankRewards:M}),await r(A),o(M),f({gems:A,label:`${k.length} phn thng`}),u(!0),Ee({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#ce82ff","#1cb0f6"]})}catch(P){console.error("Error claiming all rank rewards:",P)}finally{c(!1)}}},_=fy.filter(k=>v(k)==="available").length,x=s.length,C=ps(n);return l.jsxs(l.Fragment,{children:[l.jsx(Gn,{isOpen:h&&!!d,onClose:()=>u(!1),title:"Nhn qu thnh cng!",subtitle:(d==null?void 0:d.label)||"",rewards:d?[{type:"gems",amount:d.gems}]:[],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-blue)"}),l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:t,children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:k=>k.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-4 pb-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:t,className:"w-9 h-9 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform shrink-0",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-center",children:[l.jsxs("h2",{className:"font-bold text-base flex items-center justify-center gap-1.5",children:[l.jsx(Le,{className:"w-4 h-4 text-[var(--duo-yellow)] shrink-0"}),l.jsx("span",{className:"truncate",children:"Qu Rank"})]}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)] truncate",children:"Nhn qu khi t mc"})]}),_>0?l.jsxs("button",{onClick:w,disabled:a,className:"btn-3d btn-3d-green px-2 py-1 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Ue,{className:"w-3.5 h-3.5"}),"Nhn (",_,")"]}):l.jsx("div",{className:"w-9"})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsx("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:Pa(C),alt:C.rankName,className:"w-12 h-12 object-contain"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-bold text-foreground",children:C.rankName}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:[n," Rank Points"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"}),l.jsx("p",{className:"font-bold text-[var(--duo-green)]",children:x})]}),_>0&&l.jsx("div",{className:"bg-[var(--duo-red)] px-2 py-1 rounded-full",children:l.jsx("span",{className:"text-white text-xs font-bold",children:_})})]})})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:l.jsx("div",{className:"space-y-2",children:fy.map(k=>{const P=v(k),A=k.isMaster,M=kht(k.rankId,k.tier);return l.jsxs("div",{className:`card-3d p-3 flex items-center gap-3 ${P==="available"?"border-[var(--duo-green)] border-2":P==="claimed"?"opacity-70":"opacity-50"}`,children:[l.jsx("div",{className:"w-12 h-12 flex-shrink-0 flex items-center justify-center",children:l.jsx("img",{src:M,alt:k.label,className:`w-10 h-10 object-contain ${P==="locked"?"grayscale":""}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:`font-bold text-sm truncate ${P==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:k.label}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[k.minPoints," RP"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("span",{className:`font-bold ${A?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"}`,children:["+",k.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]}),P==="claimed"?l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(In,{className:"w-4 h-4 text-white"})}):P==="available"?l.jsx("button",{onClick:()=>y(k),disabled:a,className:"btn-3d btn-3d-green px-3 py-1.5 text-xs",children:"Nhn"}):l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Ou,{className:"w-3 h-3 text-[var(--muted-foreground)]"})})]},k.id)})})})]})})]})}function Iht(){var Y;const e=we(),{user:t,initUser:n}=Zt(),{isActive:i,isLoading:r,questions:s,currentIndex:o,rank:a,rankPoints:c,correctCount:h,wrongCount:u,startConquest:d,endConquest:f,resetConquest:v,loadConquestStats:y}=Zb(),[w,_]=I.useState(!1),[x,C]=I.useState(null),[k,P]=I.useState(null),[A,M]=I.useState(!0),[N,T]=I.useState(!1);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId){M(!0);const U=await y(t.oderId);P(U),M(!1)}})()},[t==null?void 0:t.oderId,y]);const E=(k==null?void 0:k.rankPoints)??((Y=t==null?void 0:t.conquestStats)==null?void 0:Y.rankPoints)??(t==null?void 0:t.totalScore)??0,R=ps(E),D=async()=>{t!=null&&t.oderId&&await d(t.oderId,E)},F=async()=>{_(!0);const K=await f();if(C(K),await n(),t!=null&&t.oderId){const U=await y(t.oderId);P(U)}},L=()=>{_(!1),C(null),v()};if(w)return x?l.jsx(Cht,{result:x,rank:a,onPlayAgain:L,onGoBack:()=>e("/")}):l.jsx(re,{className:"bg-background min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Li,{className:"w-12 h-12 animate-spin text-[var(--duo-purple)] mx-auto mb-4"}),l.jsx("p",{className:"text-foreground font-bold",children:"ang tnh kt qu..."})]})});if(i&&s.length>0)return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-4 pb-2 px-4 bg-background sticky top-0 z-10",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:F,className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--duo-green)]",children:[l.jsx("span",{className:"text-sm",children:""}),l.jsx("span",{className:"font-bold",children:h})]}),l.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--duo-red)]",children:[l.jsx("span",{className:"text-sm",children:""}),l.jsx("span",{className:"font-bold",children:u})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:Pa(a),alt:a.rankName,className:"w-8 h-8 object-contain"}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:"text-xs font-bold text-foreground",children:[c," RP"]})})]})]})}),l.jsx("div",{style:{minHeight:"calc(100vh - 100px)"},children:r?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-3",children:[l.jsx(Li,{className:"w-8 h-8 animate-spin text-[var(--duo-purple)]"}),l.jsx("span",{className:"text-foreground font-bold",children:"ang to cu hi..."})]}):l.jsx(Tht,{question:s[o],onEnd:F})})]});const lt=()=>{const K=je.findIndex(q=>q.id===R.rankId);if(K===-1||K>=je.length-1)return 100;const U=je[K].minScore,W=je[K+1].minScore,j=(E-U)/(W-U)*100;return Math.min(100,Math.max(0,j))},ht=()=>{const K=je.findIndex(U=>U.id===R.rankId);return K===-1||K>=je.length-1?"Max Rank":je[K+1].name};return l.jsxs(re,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-4 pb-3 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-foreground",children:"Chinh Chin"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"u tr vi AI - Leo rank"})]})]})}),l.jsx("div",{className:"px-4 py-4 pb-28 overflow-y-auto",style:{height:"calc(100vh - 100px)"},children:A?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-3",children:[l.jsx(Li,{className:"w-8 h-8 animate-spin text-[var(--duo-purple)]"}),l.jsx("span",{className:"text-foreground font-bold",children:"ang ti d liu..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"card-3d p-6 text-center mb-4",children:[l.jsx("img",{src:Pa(R),alt:R.rankName,className:"w-24 h-24 mx-auto mb-4 object-contain"}),l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-1",children:R.rankName}),l.jsxs("p",{className:"text-[var(--muted-foreground)] mb-4",children:[E," Rank Points"]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-xs text-[var(--muted-foreground)] mb-1",children:[l.jsx("span",{children:R.rankName}),l.jsx("span",{children:ht()})]}),l.jsx("div",{className:"progress-duo h-2.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${lt()}%`}})})]}),k&&k.totalConquests>0&&l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4 text-xs",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Tng trn"}),l.jsx("p",{className:"font-bold text-foreground",children:k.totalConquests})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Chui thng tt nht"}),l.jsx("p",{className:"font-bold text-foreground",children:k.bestWinStreak})]})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:je.slice(0,8).map(K=>l.jsx("div",{className:`h-11 rounded-xl flex items-center justify-center ${K.id===R.rankId?"bg-[var(--duo-purple)]/20 border-2 border-[var(--duo-purple)]":"bg-[var(--secondary)] border-2 border-transparent"}`,children:l.jsx("p",{className:"text-[11px] font-bold text-foreground",children:K.shortName})},K.id))}),l.jsxs("button",{onClick:()=>T(!0),className:"w-full btn-3d btn-3d-yellow py-3 flex items-center justify-center gap-2",children:[l.jsx(Ue,{className:"w-5 h-5"}),l.jsx("span",{children:"Xem Qu Rank"})]})]}),l.jsxs("div",{className:"space-y-2.5 mb-4",children:[l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(wi,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"AI To "}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu hi c AI to da trn rank ca bn"})]})]}),l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx(Le,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"Leo Rank"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tr li ng +RP, sai -RP. Rank cng cao cng kh!"})]})]}),l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Lr,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"a Dng Cu Hi"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Trc nghim, in t, ni cp, sp xp..."})]})]})]}),l.jsx("button",{onClick:D,disabled:r||!(t!=null&&t.oderId),className:`btn-3d w-full py-4 text-lg flex items-center justify-center gap-2 ${r?"bg-[var(--secondary)] text-[var(--muted-foreground)] shadow-[0_5px_0_var(--border)] cursor-not-allowed":"btn-3d-purple"}`,children:r?l.jsxs(l.Fragment,{children:[l.jsx(Li,{className:"w-5 h-5 animate-spin"}),"ang chun b..."]}):l.jsxs(l.Fragment,{children:[l.jsx(wi,{className:"w-5 h-5"}),"BT U CHINH CHIN"]})})]})}),l.jsx(Sht,{isOpen:N,onClose:()=>T(!1),userRankPoints:E})]})}function FI(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Aht(...e){return t=>{let n=!1;const i=e.map(r=>{const s=FI(r,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():FI(e[r],null)}}}}var Rht=Symbol.for("react.lazy"),am=Vj[" use ".trim().toString()];function Pht(e){return typeof e=="object"&&e!==null&&"then"in e}function nj(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===Rht&&"_payload"in e&&Pht(e._payload)}function Mht(e){const t=Lht(e),n=I.forwardRef((i,r)=>{let{children:s,...o}=i;nj(s)&&typeof am=="function"&&(s=am(s._payload));const a=I.Children.toArray(s),c=a.find(qht);if(c){const h=c.props.children,u=a.map(d=>d===c?I.Children.count(h)>1?I.Children.only(null):I.isValidElement(h)?h.props.children:null:d);return l.jsx(t,{...o,ref:r,children:I.isValidElement(h)?I.cloneElement(h,void 0,u):null})}return l.jsx(t,{...o,ref:r,children:s})});return n.displayName=`${e}.Slot`,n}var Dht=Mht("Slot");function Lht(e){const t=I.forwardRef((n,i)=>{let{children:r,...s}=n;if(nj(r)&&typeof am=="function"&&(r=am(r._payload)),I.isValidElement(r)){const o=Fht(r),a=jht(s,r.props);return r.type!==I.Fragment&&(a.ref=i?Aht(i,o):o),I.cloneElement(r,a)}return I.Children.count(r)>1?I.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Vht=Symbol("radix.slottable");function qht(e){return I.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Vht}function jht(e,t){const n={...t};for(const i in t){const r=e[i],s=t[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{const c=s(...a);return r(...a),c}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...e,...n}}function Fht(e){var i,r;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}const UI=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,OI=UP,Uht=(e,t)=>n=>{var i;if((t==null?void 0:t.variants)==null)return OI(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:s}=t,o=Object.keys(r).map(h=>{const u=n==null?void 0:n[h],d=s==null?void 0:s[h];if(u===null)return null;const f=UI(u)||UI(d);return r[h][f]}),a=n&&Object.entries(n).reduce((h,u)=>{let[d,f]=u;return f===void 0||(h[d]=f),h},{}),c=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((h,u)=>{let{class:d,className:f,...v}=u;return Object.entries(v).every(y=>{let[w,_]=y;return Array.isArray(_)?_.includes({...s,...a}[w]):{...s,...a}[w]===_})?[...h,d,f]:h},[]);return OI(e,o,c,n==null?void 0:n.class,n==null?void 0:n.className)},Oht=Uht("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function BI({className:e,variant:t,size:n,asChild:i=!1,...r}){const s=i?Dht:"button";return l.jsx(s,{"data-slot":"button",className:Vt(Oht({variant:t,size:n,className:e})),...r})}function Bht({className:e,...t}){return l.jsx("div",{"data-slot":"card",className:Vt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Ght({className:e,...t}){return l.jsx("div",{"data-slot":"card-header",className:Vt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Hht({className:e,...t}){return l.jsx("div",{"data-slot":"card-title",className:Vt("leading-none font-semibold",e),...t})}function $ht({className:e,...t}){return l.jsx("div",{"data-slot":"card-content",className:Vt("px-6",e),...t})}function zht(){const[e,t]=I.useState("idle"),[n,i]=I.useState(""),[r,s]=I.useState(null),o=async()=>{t("loading"),i("ang kt ni Firebase...");try{const h=(await ka(Wr(kt,"test"))).docs.map(u=>({id:u.id,...u.data()}));t("success"),i(`Kt ni thnh cng! Tm thy ${h.length} documents.`),s(h)}catch(c){t("error"),i(`Li: ${c.message}`),s(null)}},a=async()=>{t("loading"),i("ang thm d liu test...");try{const c=await tp(Wr(kt,"test"),{message:"Hello from Quiz App!",timestamp:eD(),random:Math.random()});t("success"),i(`Thm d liu thnh cng! ID: ${c.id}`),s({id:c.id})}catch(c){t("error"),i(`Li: ${c.message}`)}};return l.jsx(re,{className:"bg-background p-4",children:l.jsxs(Bht,{children:[l.jsx(Ght,{children:l.jsxs(Hht,{className:"flex items-center gap-2",children:[l.jsx(zr,{className:"h-5 w-5 text-orange-500"}),"Test Firebase Connection"]})}),l.jsxs($ht,{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(BI,{onClick:o,disabled:e==="loading",children:[e==="loading"&&l.jsx(Li,{className:"mr-2 h-4 w-4 animate-spin"}),"Test Connection"]}),l.jsx(BI,{variant:"outline",onClick:a,disabled:e==="loading",children:"Insert Test Data"})]}),e!=="idle"&&l.jsxs("div",{className:"rounded-lg border p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e==="loading"&&l.jsx(Li,{className:"h-5 w-5 animate-spin text-blue-500"}),e==="success"&&l.jsx(ai,{className:"h-5 w-5 text-green-500"}),e==="error"&&l.jsx($r,{className:"h-5 w-5 text-red-500"}),l.jsx("span",{className:e==="success"?"text-green-600":e==="error"?"text-red-600":"",children:n})]}),r!==null&&l.jsx("pre",{className:"mt-2 rounded bg-muted p-2 text-xs overflow-auto",children:JSON.stringify(r,null,2)})]}),l.jsxs("div",{className:"rounded-lg bg-orange-50 dark:bg-orange-950 p-4 text-sm",children:[l.jsx("p",{className:"font-medium text-orange-800 dark:text-orange-200 mb-2",children:" Firebase Firestore  c cu hnh!"}),l.jsx("p",{className:"text-orange-700 dark:text-orange-300",children:"Nh bt Firestore trong Firebase Console v set rules cho php read/write."})]})]})]})})}const Kht=[{path:"/",icon:F_,label:"Trang ch"},{path:"/leaderboard",icon:Le,label:"Xp hng"},{path:"/gacha",icon:Xt,label:"Gacha"},{path:"/events",icon:uu,label:"S kin"},{path:"/settings",icon:fl,label:"Ti"}];function Wht(){const e=Ms(),t=we(),{isActive:n}=Zb(),{activeFloor:i}=xb();return e.pathname==="/quiz"||e.pathname==="/conquest"&&n||e.pathname.startsWith("/gacha/")||e.pathname==="/event-tower"&&i?null:l.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:l.jsx("div",{className:"bg-[var(--card)] border-t-2 border-[var(--border)] pb-[env(safe-area-inset-bottom)]",children:l.jsx("div",{className:"flex items-center justify-around py-1 px-1",children:Kht.map(r=>{const s=e.pathname===r.path,o=r.icon;return l.jsxs("button",{onClick:()=>t(r.path),className:Vt("flex-1 flex flex-col items-center gap-0.5 py-2 rounded-xl min-w-0",s?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"),children:[l.jsx("div",{className:Vt("p-1.5 rounded-xl",s&&"bg-[var(--duo-green)]/20"),children:l.jsx(o,{className:"w-5 h-5"})}),l.jsx("span",{className:"text-[10px] font-semibold whitespace-nowrap truncate max-w-full px-1",children:r.label})]},r.path)})})})})}const Qht=()=>{const{theme:e,setTheme:t}=yq(),{user:n,updateUsername:i}=Zt(),[r,s]=I.useState(!1),[o,a]=I.useState(""),[c,h]=I.useState("idle");I.useEffect(()=>{if(!localStorage.getItem("quiz-theme")){const d=window.matchMedia("(prefers-color-scheme: dark)").matches;t(d?"dark":"light")}},[t]),I.useEffect(()=>{document.documentElement.setAttribute("data-theme",e),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e)},[e]),I.useEffect(()=>{if((n==null?void 0:n.odername)==="Ngi chi"){const d=setTimeout(()=>{s(!0)},500);return()=>clearTimeout(d)}},[n==null?void 0:n.odername]);const u=async()=>{if(!o.trim()||o.trim().length<2)return;await i(o.trim())?(h("success"),setTimeout(()=>{s(!1),a(""),h("idle")},1e3)):h("error")};return l.jsxs("div",{className:e,children:[r&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx(dx,{className:"w-8 h-8 text-[var(--duo-green)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Cho mng bn! "}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Hy t tn cho mnh  bt u nh!"}),l.jsx("input",{type:"text",value:o,onChange:d=>{a(d.target.value),h("idle")},placeholder:"Nhp tn ca bn",maxLength:20,autoFocus:!0,className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg mb-3"}),c==="success"&&l.jsx("p",{className:"text-[var(--duo-green)] text-center text-sm mb-3",children:"t tn thnh cng!"}),c==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"Khng th t tn. Vui lng th li."}),l.jsx("button",{onClick:u,disabled:!o.trim()||o.trim().length<2,className:"w-full btn-3d btn-3d-green py-3 disabled:opacity-50",children:"Bt u chi!"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] text-center mt-3",children:"Tn t 2-20 k t"})]})}),l.jsxs(HF,{children:[l.jsx(Pe,{path:"/",element:l.jsx(gX,{})}),l.jsx(Pe,{path:"/quiz",element:l.jsx(yX,{})}),l.jsx(Pe,{path:"/leaderboard",element:l.jsx(Jrt,{})}),l.jsx(Pe,{path:"/achievements",element:l.jsx(rst,{})}),l.jsx(Pe,{path:"/quests",element:l.jsx(sst,{})}),l.jsx(Pe,{path:"/settings",element:l.jsx(ost,{})}),l.jsx(Pe,{path:"/stats",element:l.jsx(ast,{})}),l.jsx(Pe,{path:"/mailbox",element:l.jsx(cst,{})}),l.jsx(Pe,{path:"/shop",element:l.jsx(lst,{})}),l.jsx(Pe,{path:"/events",element:l.jsx(dst,{})}),l.jsx(Pe,{path:"/event-login-7days",element:l.jsx(gst,{})}),l.jsx(Pe,{path:"/event-level-rewards",element:l.jsx(fst,{})}),l.jsx(Pe,{path:"/event-tower",element:l.jsx(pst,{})}),l.jsx(Pe,{path:"/gacha",element:l.jsx(Cst,{})}),l.jsx(Pe,{path:"/gacha/:id",element:l.jsx(hht,{})}),l.jsx(Pe,{path:"/customize",element:l.jsx(uht,{})}),l.jsx(Pe,{path:"/card-inventory",element:l.jsx(dht,{})}),l.jsx(Pe,{path:"/profile/:id",element:l.jsx(ght,{})}),l.jsx(Pe,{path:"/battle",element:l.jsx(mht,{})}),l.jsx(Pe,{path:"/conquest",element:l.jsx(Iht,{})}),l.jsx(Pe,{path:"/test-firebase",element:l.jsx(zht,{})})]}),l.jsx(Wht,{}),l.jsx(XU,{position:"top-center",richColors:!0})]})},GI=document.getElementById("root");GI&&rP(GI).render(l.jsx(st.StrictMode,{children:l.jsx(mU,{children:l.jsx(Qht,{})})}));
