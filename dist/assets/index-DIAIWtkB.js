function s3(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function TA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var CA={exports:{}},Cm={},kA={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bu=Symbol.for("react.element"),o3=Symbol.for("react.portal"),a3=Symbol.for("react.fragment"),c3=Symbol.for("react.strict_mode"),l3=Symbol.for("react.profiler"),h3=Symbol.for("react.provider"),u3=Symbol.for("react.context"),d3=Symbol.for("react.forward_ref"),g3=Symbol.for("react.suspense"),f3=Symbol.for("react.memo"),m3=Symbol.for("react.lazy"),pC=Symbol.iterator;function p3(e){return e===null||typeof e!="object"?null:(e=pC&&e[pC]||e["@@iterator"],typeof e=="function"?e:null)}var NA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EA=Object.assign,SA={};function fl(e,t,n){this.props=e,this.context=t,this.refs=SA,this.updater=n||NA}fl.prototype.isReactComponent={};fl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function IA(){}IA.prototype=fl.prototype;function s_(e,t,n){this.props=e,this.context=t,this.refs=SA,this.updater=n||NA}var o_=s_.prototype=new IA;o_.constructor=s_;EA(o_,fl.prototype);o_.isPureReactComponent=!0;var vC=Array.isArray,AA=Object.prototype.hasOwnProperty,a_={current:null},RA={key:!0,ref:!0,__self:!0,__source:!0};function PA(e,t,n){var i,r={},s=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)AA.call(t,i)&&!RA.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];r.children=c}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Bu,type:e,key:s,ref:o,props:r,_owner:a_.current}}function v3(e,t){return{$$typeof:Bu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function c_(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bu}function y3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var yC=/\/+/g;function ov(e,t){return typeof e=="object"&&e!==null&&e.key!=null?y3(""+e.key):t.toString(36)}function xg(e,t,n,i,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Bu:case o3:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+ov(o,0):i,vC(r)?(n="",e!=null&&(n=e.replace(yC,"$&/")+"/"),xg(r,t,n,"",function(h){return h})):r!=null&&(c_(r)&&(r=v3(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(yC,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",vC(e))for(var a=0;a<e.length;a++){s=e[a];var c=i+ov(s,a);o+=xg(s,t,n,c,r)}else if(c=p3(e),typeof c=="function")for(e=c.call(e),a=0;!(s=e.next()).done;)s=s.value,c=i+ov(s,a++),o+=xg(s,t,n,c,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Pd(e,t,n){if(e==null)return e;var i=[],r=0;return xg(e,i,"","",function(s){return t.call(n,s,r++)}),i}function x3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qn={current:null},_g={transition:null},_3={ReactCurrentDispatcher:Qn,ReactCurrentBatchConfig:_g,ReactCurrentOwner:a_};function MA(){throw Error("act(...) is not supported in production builds of React.")}zt.Children={map:Pd,forEach:function(e,t,n){Pd(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Pd(e,function(){t++}),t},toArray:function(e){return Pd(e,function(t){return t})||[]},only:function(e){if(!c_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};zt.Component=fl;zt.Fragment=a3;zt.Profiler=l3;zt.PureComponent=s_;zt.StrictMode=c3;zt.Suspense=g3;zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_3;zt.act=MA;zt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=EA({},e.props),r=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=a_.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)AA.call(t,c)&&!RA.hasOwnProperty(c)&&(i[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];i.children=a}return{$$typeof:Bu,type:e.type,key:r,ref:s,props:i,_owner:o}};zt.createContext=function(e){return e={$$typeof:u3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:h3,_context:e},e.Consumer=e};zt.createElement=PA;zt.createFactory=function(e){var t=PA.bind(null,e);return t.type=e,t};zt.createRef=function(){return{current:null}};zt.forwardRef=function(e){return{$$typeof:d3,render:e}};zt.isValidElement=c_;zt.lazy=function(e){return{$$typeof:m3,_payload:{_status:-1,_result:e},_init:x3}};zt.memo=function(e,t){return{$$typeof:f3,type:e,compare:t===void 0?null:t}};zt.startTransition=function(e){var t=_g.transition;_g.transition={};try{e()}finally{_g.transition=t}};zt.unstable_act=MA;zt.useCallback=function(e,t){return Qn.current.useCallback(e,t)};zt.useContext=function(e){return Qn.current.useContext(e)};zt.useDebugValue=function(){};zt.useDeferredValue=function(e){return Qn.current.useDeferredValue(e)};zt.useEffect=function(e,t){return Qn.current.useEffect(e,t)};zt.useId=function(){return Qn.current.useId()};zt.useImperativeHandle=function(e,t,n){return Qn.current.useImperativeHandle(e,t,n)};zt.useInsertionEffect=function(e,t){return Qn.current.useInsertionEffect(e,t)};zt.useLayoutEffect=function(e,t){return Qn.current.useLayoutEffect(e,t)};zt.useMemo=function(e,t){return Qn.current.useMemo(e,t)};zt.useReducer=function(e,t,n){return Qn.current.useReducer(e,t,n)};zt.useRef=function(e){return Qn.current.useRef(e)};zt.useState=function(e){return Qn.current.useState(e)};zt.useSyncExternalStore=function(e,t,n){return Qn.current.useSyncExternalStore(e,t,n)};zt.useTransition=function(){return Qn.current.useTransition()};zt.version="18.3.1";kA.exports=zt;var I=kA.exports;const it=TA(I),w3=s3({__proto__:null,default:it},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b3=I,T3=Symbol.for("react.element"),C3=Symbol.for("react.fragment"),k3=Object.prototype.hasOwnProperty,N3=b3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E3={key:!0,ref:!0,__self:!0,__source:!0};function DA(e,t,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)k3.call(t,i)&&!E3.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:T3,type:e,key:s,ref:o,props:r,_owner:N3.current}}Cm.Fragment=C3;Cm.jsx=DA;Cm.jsxs=DA;CA.exports=Cm;var l=CA.exports,LA={exports:{}},Ei={},VA={exports:{}},qA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,Q){var F=U.length;U.push(Q);t:for(;0<F;){var q=F-1>>>1,$=U[q];if(0<r($,Q))U[q]=Q,U[F]=$,F=q;else break t}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var Q=U[0],F=U.pop();if(F!==Q){U[0]=F;t:for(var q=0,$=U.length,H=$>>>1;q<H;){var X=2*(q+1)-1,tt=U[X],O=X+1,B=U[O];if(0>r(tt,F))O<$&&0>r(B,tt)?(U[q]=B,U[O]=F,q=O):(U[q]=tt,U[X]=F,q=X);else if(O<$&&0>r(B,F))U[q]=B,U[O]=F,q=O;else break t}}return Q}function r(U,Q){var F=U.sortIndex-Q.sortIndex;return F!==0?F:U.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],h=[],u=1,d=null,f=3,v=!1,y=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(U){for(var Q=n(h);Q!==null;){if(Q.callback===null)i(h);else if(Q.startTime<=U)i(h),Q.sortIndex=Q.expirationTime,t(c,Q);else break;Q=n(h)}}function P(U){if(_=!1,k(U),!y)if(n(c)!==null)y=!0,Y(A);else{var Q=n(h);Q!==null&&W(P,Q.startTime-U)}}function A(U,Q){y=!1,_&&(_=!1,x(T),T=-1),v=!0;var F=f;try{for(k(Q),d=n(c);d!==null&&(!(d.expirationTime>Q)||U&&!D());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var $=q(d.expirationTime<=Q);Q=e.unstable_now(),typeof $=="function"?d.callback=$:d===n(c)&&i(c),k(Q)}else i(c);d=n(c)}if(d!==null)var H=!0;else{var X=n(h);X!==null&&W(P,X.startTime-Q),H=!1}return H}finally{d=null,f=F,v=!1}}var M=!1,N=null,T=-1,E=5,R=-1;function D(){return!(e.unstable_now()-R<E)}function j(){if(N!==null){var U=e.unstable_now();R=U;var Q=!0;try{Q=N(!0,U)}finally{Q?L():(M=!1,N=null)}}else M=!1}var L;if(typeof C=="function")L=function(){C(j)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,dt=lt.port2;lt.port1.onmessage=j,L=function(){dt.postMessage(null)}}else L=function(){w(j,0)};function Y(U){N=U,M||(M=!0,L())}function W(U,Q){T=w(function(){U(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){y||v||(y=!0,Y(A))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(U){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var F=f;f=Q;try{return U()}finally{f=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,Q){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var F=f;f=U;try{return Q()}finally{f=F}},e.unstable_scheduleCallback=function(U,Q,F){var q=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?q+F:q):F=q,U){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=F+$,U={id:u++,callback:Q,priorityLevel:U,startTime:F,expirationTime:$,sortIndex:-1},F>q?(U.sortIndex=F,t(h,U),n(c)===null&&U===n(h)&&(_?(x(T),T=-1):_=!0,W(P,F-q))):(U.sortIndex=$,t(c,U),y||v||(y=!0,Y(A))),U},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(U){var Q=f;return function(){var F=f;f=Q;try{return U.apply(this,arguments)}finally{f=F}}}})(qA);VA.exports=qA;var S3=VA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I3=I,ki=S3;function et(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jA=new Set,Zh={};function Fa(e,t){Kc(e,t),Kc(e+"Capture",t)}function Kc(e,t){for(Zh[e]=t,e=0;e<t.length;e++)jA.add(t[e])}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ly=Object.prototype.hasOwnProperty,A3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xC={},_C={};function R3(e){return Ly.call(_C,e)?!0:Ly.call(xC,e)?!1:A3.test(e)?_C[e]=!0:(xC[e]=!0,!1)}function P3(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function M3(e,t,n,i){if(t===null||typeof t>"u"||P3(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yn(e,t,n,i,r,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Cn[e]=new Yn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Cn[t]=new Yn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Cn[e]=new Yn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Cn[e]=new Yn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Cn[e]=new Yn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Cn[e]=new Yn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Cn[e]=new Yn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Cn[e]=new Yn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Cn[e]=new Yn(e,5,!1,e.toLowerCase(),null,!1,!1)});var l_=/[\-:]([a-z])/g;function h_(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(l_,h_);Cn[t]=new Yn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(l_,h_);Cn[t]=new Yn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(l_,h_);Cn[t]=new Yn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Cn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!1,!1)});Cn.xlinkHref=new Yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Cn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!0,!0)});function u_(e,t,n,i){var r=Cn.hasOwnProperty(t)?Cn[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(M3(t,n,r,i)&&(n=null),i||r===null?R3(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,i=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Ms=I3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Md=Symbol.for("react.element"),ac=Symbol.for("react.portal"),cc=Symbol.for("react.fragment"),d_=Symbol.for("react.strict_mode"),Vy=Symbol.for("react.profiler"),FA=Symbol.for("react.provider"),UA=Symbol.for("react.context"),g_=Symbol.for("react.forward_ref"),qy=Symbol.for("react.suspense"),jy=Symbol.for("react.suspense_list"),f_=Symbol.for("react.memo"),Js=Symbol.for("react.lazy"),OA=Symbol.for("react.offscreen"),wC=Symbol.iterator;function Jl(e){return e===null||typeof e!="object"?null:(e=wC&&e[wC]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,av;function vh(e){if(av===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);av=t&&t[1]||""}return`
`+av+e}var cv=!1;function lv(e,t){if(!e||cv)return"";cv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var i=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){i=h}e.call(t.prototype)}else{try{throw Error()}catch(h){i=h}e()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{cv=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?vh(e):""}function D3(e){switch(e.tag){case 5:return vh(e.type);case 16:return vh("Lazy");case 13:return vh("Suspense");case 19:return vh("SuspenseList");case 0:case 2:case 15:return e=lv(e.type,!1),e;case 11:return e=lv(e.type.render,!1),e;case 1:return e=lv(e.type,!0),e;default:return""}}function Fy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case cc:return"Fragment";case ac:return"Portal";case Vy:return"Profiler";case d_:return"StrictMode";case qy:return"Suspense";case jy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case UA:return(e.displayName||"Context")+".Consumer";case FA:return(e._context.displayName||"Context")+".Provider";case g_:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case f_:return t=e.displayName||null,t!==null?t:Fy(e.type)||"Memo";case Js:t=e._payload,e=e._init;try{return Fy(e(t))}catch{}}return null}function L3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fy(t);case 8:return t===d_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ko(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function BA(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function V3(e){var t=BA(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Dd(e){e._valueTracker||(e._valueTracker=V3(e))}function GA(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=BA(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Qg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Uy(e,t){var n=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function bC(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=ko(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function HA(e,t){t=t.checked,t!=null&&u_(e,"checked",t,!1)}function Oy(e,t){HA(e,t);var n=ko(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?By(e,t.type,n):t.hasOwnProperty("defaultValue")&&By(e,t.type,ko(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function TC(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function By(e,t,n){(t!=="number"||Qg(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var yh=Array.isArray;function Sc(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ko(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Gy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(et(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function CC(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(et(92));if(yh(n)){if(1<n.length)throw Error(et(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ko(n)}}function $A(e,t){var n=ko(t.value),i=ko(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function kC(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zA(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zA(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ld,KA=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ld=Ld||document.createElement("div"),Ld.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ld.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function tu(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Eh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},q3=["Webkit","ms","Moz","O"];Object.keys(Eh).forEach(function(e){q3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Eh[t]=Eh[e]})});function WA(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Eh.hasOwnProperty(e)&&Eh[e]?(""+t).trim():t+"px"}function QA(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=WA(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}var j3=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $y(e,t){if(t){if(j3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(et(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(et(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(et(61))}if(t.style!=null&&typeof t.style!="object")throw Error(et(62))}}function zy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ky=null;function m_(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Wy=null,Ic=null,Ac=null;function NC(e){if(e=$u(e)){if(typeof Wy!="function")throw Error(et(280));var t=e.stateNode;t&&(t=Im(t),Wy(e.stateNode,e.type,t))}}function YA(e){Ic?Ac?Ac.push(e):Ac=[e]:Ic=e}function JA(){if(Ic){var e=Ic,t=Ac;if(Ac=Ic=null,NC(e),t)for(e=0;e<t.length;e++)NC(t[e])}}function XA(e,t){return e(t)}function ZA(){}var hv=!1;function tR(e,t,n){if(hv)return e(t,n);hv=!0;try{return XA(e,t,n)}finally{hv=!1,(Ic!==null||Ac!==null)&&(ZA(),JA())}}function eu(e,t){var n=e.stateNode;if(n===null)return null;var i=Im(n);if(i===null)return null;n=i[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break t;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(et(231,t,typeof n));return n}var Qy=!1;if(ys)try{var Xl={};Object.defineProperty(Xl,"passive",{get:function(){Qy=!0}}),window.addEventListener("test",Xl,Xl),window.removeEventListener("test",Xl,Xl)}catch{Qy=!1}function F3(e,t,n,i,r,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(u){this.onError(u)}}var Sh=!1,Yg=null,Jg=!1,Yy=null,U3={onError:function(e){Sh=!0,Yg=e}};function O3(e,t,n,i,r,s,o,a,c){Sh=!1,Yg=null,F3.apply(U3,arguments)}function B3(e,t,n,i,r,s,o,a,c){if(O3.apply(this,arguments),Sh){if(Sh){var h=Yg;Sh=!1,Yg=null}else throw Error(et(198));Jg||(Jg=!0,Yy=h)}}function Ua(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function eR(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function EC(e){if(Ua(e)!==e)throw Error(et(188))}function G3(e){var t=e.alternate;if(!t){if(t=Ua(e),t===null)throw Error(et(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return EC(r),e;if(s===i)return EC(r),t;s=s.sibling}throw Error(et(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(et(189))}}if(n.alternate!==i)throw Error(et(190))}if(n.tag!==3)throw Error(et(188));return n.stateNode.current===n?e:t}function nR(e){return e=G3(e),e!==null?iR(e):null}function iR(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=iR(e);if(t!==null)return t;e=e.sibling}return null}var rR=ki.unstable_scheduleCallback,SC=ki.unstable_cancelCallback,H3=ki.unstable_shouldYield,$3=ki.unstable_requestPaint,Oe=ki.unstable_now,z3=ki.unstable_getCurrentPriorityLevel,p_=ki.unstable_ImmediatePriority,sR=ki.unstable_UserBlockingPriority,Xg=ki.unstable_NormalPriority,K3=ki.unstable_LowPriority,oR=ki.unstable_IdlePriority,km=null,qr=null;function W3(e){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(km,e,void 0,(e.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:J3,Q3=Math.log,Y3=Math.LN2;function J3(e){return e>>>=0,e===0?32:31-(Q3(e)/Y3|0)|0}var Vd=64,qd=4194304;function xh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zg(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=xh(a):(s&=o,s!==0&&(i=xh(s)))}else o=n&~r,o!==0?i=xh(o):s!==0&&(i=xh(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-mr(t),r=1<<n,i|=e[n],t&=~r;return i}function X3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Z3(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-mr(s),a=1<<o,c=r[o];c===-1?(!(a&n)||a&i)&&(r[o]=X3(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}function Jy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function aR(){var e=Vd;return Vd<<=1,!(Vd&4194240)&&(Vd=64),e}function uv(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-mr(t),e[t]=n}function t5(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-mr(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}function v_(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-mr(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var re=0;function cR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var lR,y_,hR,uR,dR,Xy=!1,jd=[],lo=null,ho=null,uo=null,nu=new Map,iu=new Map,Zs=[],e5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function IC(e,t){switch(e){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":ho=null;break;case"mouseover":case"mouseout":uo=null;break;case"pointerover":case"pointerout":nu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":iu.delete(t.pointerId)}}function Zl(e,t,n,i,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},t!==null&&(t=$u(t),t!==null&&y_(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function n5(e,t,n,i,r){switch(t){case"focusin":return lo=Zl(lo,e,t,n,i,r),!0;case"dragenter":return ho=Zl(ho,e,t,n,i,r),!0;case"mouseover":return uo=Zl(uo,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return nu.set(s,Zl(nu.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,iu.set(s,Zl(iu.get(s)||null,e,t,n,i,r)),!0}return!1}function gR(e){var t=oa(e.target);if(t!==null){var n=Ua(t);if(n!==null){if(t=n.tag,t===13){if(t=eR(n),t!==null){e.blockedOn=t,dR(e.priority,function(){hR(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function wg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Ky=i,n.target.dispatchEvent(i),Ky=null}else return t=$u(n),t!==null&&y_(t),e.blockedOn=n,!1;t.shift()}return!0}function AC(e,t,n){wg(e)&&n.delete(t)}function i5(){Xy=!1,lo!==null&&wg(lo)&&(lo=null),ho!==null&&wg(ho)&&(ho=null),uo!==null&&wg(uo)&&(uo=null),nu.forEach(AC),iu.forEach(AC)}function th(e,t){e.blockedOn===t&&(e.blockedOn=null,Xy||(Xy=!0,ki.unstable_scheduleCallback(ki.unstable_NormalPriority,i5)))}function ru(e){function t(r){return th(r,e)}if(0<jd.length){th(jd[0],e);for(var n=1;n<jd.length;n++){var i=jd[n];i.blockedOn===e&&(i.blockedOn=null)}}for(lo!==null&&th(lo,e),ho!==null&&th(ho,e),uo!==null&&th(uo,e),nu.forEach(t),iu.forEach(t),n=0;n<Zs.length;n++)i=Zs[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Zs.length&&(n=Zs[0],n.blockedOn===null);)gR(n),n.blockedOn===null&&Zs.shift()}var Rc=Ms.ReactCurrentBatchConfig,tf=!0;function r5(e,t,n,i){var r=re,s=Rc.transition;Rc.transition=null;try{re=1,x_(e,t,n,i)}finally{re=r,Rc.transition=s}}function s5(e,t,n,i){var r=re,s=Rc.transition;Rc.transition=null;try{re=4,x_(e,t,n,i)}finally{re=r,Rc.transition=s}}function x_(e,t,n,i){if(tf){var r=Zy(e,t,n,i);if(r===null)wv(e,t,i,ef,n),IC(e,i);else if(n5(r,e,t,n,i))i.stopPropagation();else if(IC(e,i),t&4&&-1<e5.indexOf(e)){for(;r!==null;){var s=$u(r);if(s!==null&&lR(s),s=Zy(e,t,n,i),s===null&&wv(e,t,i,ef,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else wv(e,t,i,null,n)}}var ef=null;function Zy(e,t,n,i){if(ef=null,e=m_(i),e=oa(e),e!==null)if(t=Ua(e),t===null)e=null;else if(n=t.tag,n===13){if(e=eR(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ef=e,null}function fR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(z3()){case p_:return 1;case sR:return 4;case Xg:case K3:return 16;case oR:return 536870912;default:return 16}default:return 16}}var so=null,__=null,bg=null;function mR(){if(bg)return bg;var e,t=__,n=t.length,i,r="value"in so?so.value:so.textContent,s=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===r[s-i];i++);return bg=r.slice(e,1<i?1-i:void 0)}function Tg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fd(){return!0}function RC(){return!1}function Si(e){function t(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Fd:RC,this.isPropagationStopped=RC,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fd)},persist:function(){},isPersistent:Fd}),t}var ml={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w_=Si(ml),Hu=Re({},ml,{view:0,detail:0}),o5=Si(Hu),dv,gv,eh,Nm=Re({},Hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:b_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==eh&&(eh&&e.type==="mousemove"?(dv=e.screenX-eh.screenX,gv=e.screenY-eh.screenY):gv=dv=0,eh=e),dv)},movementY:function(e){return"movementY"in e?e.movementY:gv}}),PC=Si(Nm),a5=Re({},Nm,{dataTransfer:0}),c5=Si(a5),l5=Re({},Hu,{relatedTarget:0}),fv=Si(l5),h5=Re({},ml,{animationName:0,elapsedTime:0,pseudoElement:0}),u5=Si(h5),d5=Re({},ml,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),g5=Si(d5),f5=Re({},ml,{data:0}),MC=Si(f5),m5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=v5[e])?!!t[e]:!1}function b_(){return y5}var x5=Re({},Hu,{key:function(e){if(e.key){var t=m5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?p5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:b_,charCode:function(e){return e.type==="keypress"?Tg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_5=Si(x5),w5=Re({},Nm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),DC=Si(w5),b5=Re({},Hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:b_}),T5=Si(b5),C5=Re({},ml,{propertyName:0,elapsedTime:0,pseudoElement:0}),k5=Si(C5),N5=Re({},Nm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),E5=Si(N5),S5=[9,13,27,32],T_=ys&&"CompositionEvent"in window,Ih=null;ys&&"documentMode"in document&&(Ih=document.documentMode);var I5=ys&&"TextEvent"in window&&!Ih,pR=ys&&(!T_||Ih&&8<Ih&&11>=Ih),LC=" ",VC=!1;function vR(e,t){switch(e){case"keyup":return S5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var lc=!1;function A5(e,t){switch(e){case"compositionend":return yR(t);case"keypress":return t.which!==32?null:(VC=!0,LC);case"textInput":return e=t.data,e===LC&&VC?null:e;default:return null}}function R5(e,t){if(lc)return e==="compositionend"||!T_&&vR(e,t)?(e=mR(),bg=__=so=null,lc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pR&&t.locale!=="ko"?null:t.data;default:return null}}var P5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!P5[e.type]:t==="textarea"}function xR(e,t,n,i){YA(i),t=nf(t,"onChange"),0<t.length&&(n=new w_("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Ah=null,su=null;function M5(e){AR(e,0)}function Em(e){var t=dc(e);if(GA(t))return e}function D5(e,t){if(e==="change")return t}var _R=!1;if(ys){var mv;if(ys){var pv="oninput"in document;if(!pv){var jC=document.createElement("div");jC.setAttribute("oninput","return;"),pv=typeof jC.oninput=="function"}mv=pv}else mv=!1;_R=mv&&(!document.documentMode||9<document.documentMode)}function FC(){Ah&&(Ah.detachEvent("onpropertychange",wR),su=Ah=null)}function wR(e){if(e.propertyName==="value"&&Em(su)){var t=[];xR(t,su,e,m_(e)),tR(M5,t)}}function L5(e,t,n){e==="focusin"?(FC(),Ah=t,su=n,Ah.attachEvent("onpropertychange",wR)):e==="focusout"&&FC()}function V5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Em(su)}function q5(e,t){if(e==="click")return Em(t)}function j5(e,t){if(e==="input"||e==="change")return Em(t)}function F5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tr=typeof Object.is=="function"?Object.is:F5;function ou(e,t){if(Tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Ly.call(t,r)||!Tr(e[r],t[r]))return!1}return!0}function UC(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function OC(e,t){var n=UC(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=UC(n)}}function bR(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bR(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function TR(){for(var e=window,t=Qg();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Qg(e.document)}return t}function C_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function U5(e){var t=TR(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&bR(n.ownerDocument.documentElement,n)){if(i!==null&&C_(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=OC(n,s);var o=OC(n,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var O5=ys&&"documentMode"in document&&11>=document.documentMode,hc=null,tx=null,Rh=null,ex=!1;function BC(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ex||hc==null||hc!==Qg(i)||(i=hc,"selectionStart"in i&&C_(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Rh&&ou(Rh,i)||(Rh=i,i=nf(tx,"onSelect"),0<i.length&&(t=new w_("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=hc)))}function Ud(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var uc={animationend:Ud("Animation","AnimationEnd"),animationiteration:Ud("Animation","AnimationIteration"),animationstart:Ud("Animation","AnimationStart"),transitionend:Ud("Transition","TransitionEnd")},vv={},CR={};ys&&(CR=document.createElement("div").style,"AnimationEvent"in window||(delete uc.animationend.animation,delete uc.animationiteration.animation,delete uc.animationstart.animation),"TransitionEvent"in window||delete uc.transitionend.transition);function Sm(e){if(vv[e])return vv[e];if(!uc[e])return e;var t=uc[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in CR)return vv[e]=t[n];return e}var kR=Sm("animationend"),NR=Sm("animationiteration"),ER=Sm("animationstart"),SR=Sm("transitionend"),IR=new Map,GC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jo(e,t){IR.set(e,t),Fa(t,[e])}for(var yv=0;yv<GC.length;yv++){var xv=GC[yv],B5=xv.toLowerCase(),G5=xv[0].toUpperCase()+xv.slice(1);jo(B5,"on"+G5)}jo(kR,"onAnimationEnd");jo(NR,"onAnimationIteration");jo(ER,"onAnimationStart");jo("dblclick","onDoubleClick");jo("focusin","onFocus");jo("focusout","onBlur");jo(SR,"onTransitionEnd");Kc("onMouseEnter",["mouseout","mouseover"]);Kc("onMouseLeave",["mouseout","mouseover"]);Kc("onPointerEnter",["pointerout","pointerover"]);Kc("onPointerLeave",["pointerout","pointerover"]);Fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _h="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H5=new Set("cancel close invalid load scroll toggle".split(" ").concat(_h));function HC(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,B3(i,t,void 0,e),e.currentTarget=null}function AR(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;t:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break t;HC(r,a,h),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break t;HC(r,a,h),s=c}}}if(Jg)throw e=Yy,Jg=!1,Yy=null,e}function ve(e,t){var n=t[ox];n===void 0&&(n=t[ox]=new Set);var i=e+"__bubble";n.has(i)||(RR(t,e,2,!1),n.add(i))}function _v(e,t,n){var i=0;t&&(i|=4),RR(n,e,i,t)}var Od="_reactListening"+Math.random().toString(36).slice(2);function au(e){if(!e[Od]){e[Od]=!0,jA.forEach(function(n){n!=="selectionchange"&&(H5.has(n)||_v(n,!1,e),_v(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Od]||(t[Od]=!0,_v("selectionchange",!1,t))}}function RR(e,t,n,i){switch(fR(t)){case 1:var r=r5;break;case 4:r=s5;break;default:r=x_}n=r.bind(null,t,n,e),r=void 0,!Qy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function wv(e,t,n,i,r){var s=i;if(!(t&1)&&!(t&2)&&i!==null)t:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=oa(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue t}a=a.parentNode}}i=i.return}tR(function(){var h=s,u=m_(n),d=[];t:{var f=IR.get(e);if(f!==void 0){var v=w_,y=e;switch(e){case"keypress":if(Tg(n)===0)break t;case"keydown":case"keyup":v=_5;break;case"focusin":y="focus",v=fv;break;case"focusout":y="blur",v=fv;break;case"beforeblur":case"afterblur":v=fv;break;case"click":if(n.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=PC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=c5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=T5;break;case kR:case NR:case ER:v=u5;break;case SR:v=k5;break;case"scroll":v=o5;break;case"wheel":v=E5;break;case"copy":case"cut":case"paste":v=g5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=DC}var _=(t&4)!==0,w=!_&&e==="scroll",x=_?f!==null?f+"Capture":null:f;_=[];for(var C=h,k;C!==null;){k=C;var P=k.stateNode;if(k.tag===5&&P!==null&&(k=P,x!==null&&(P=eu(C,x),P!=null&&_.push(cu(C,P,k)))),w)break;C=C.return}0<_.length&&(f=new v(f,y,null,n,u),d.push({event:f,listeners:_}))}}if(!(t&7)){t:{if(f=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",f&&n!==Ky&&(y=n.relatedTarget||n.fromElement)&&(oa(y)||y[xs]))break t;if((v||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=h,y=y?oa(y):null,y!==null&&(w=Ua(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=h),v!==y)){if(_=PC,P="onMouseLeave",x="onMouseEnter",C="mouse",(e==="pointerout"||e==="pointerover")&&(_=DC,P="onPointerLeave",x="onPointerEnter",C="pointer"),w=v==null?f:dc(v),k=y==null?f:dc(y),f=new _(P,C+"leave",v,n,u),f.target=w,f.relatedTarget=k,P=null,oa(u)===h&&(_=new _(x,C+"enter",y,n,u),_.target=k,_.relatedTarget=w,P=_),w=P,v&&y)e:{for(_=v,x=y,C=0,k=_;k;k=Za(k))C++;for(k=0,P=x;P;P=Za(P))k++;for(;0<C-k;)_=Za(_),C--;for(;0<k-C;)x=Za(x),k--;for(;C--;){if(_===x||x!==null&&_===x.alternate)break e;_=Za(_),x=Za(x)}_=null}else _=null;v!==null&&$C(d,f,v,_,!1),y!==null&&w!==null&&$C(d,w,y,_,!0)}}t:{if(f=h?dc(h):window,v=f.nodeName&&f.nodeName.toLowerCase(),v==="select"||v==="input"&&f.type==="file")var A=D5;else if(qC(f))if(_R)A=j5;else{A=V5;var M=L5}else(v=f.nodeName)&&v.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(A=q5);if(A&&(A=A(e,h))){xR(d,A,n,u);break t}M&&M(e,f,h),e==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&By(f,"number",f.value)}switch(M=h?dc(h):window,e){case"focusin":(qC(M)||M.contentEditable==="true")&&(hc=M,tx=h,Rh=null);break;case"focusout":Rh=tx=hc=null;break;case"mousedown":ex=!0;break;case"contextmenu":case"mouseup":case"dragend":ex=!1,BC(d,n,u);break;case"selectionchange":if(O5)break;case"keydown":case"keyup":BC(d,n,u)}var N;if(T_)t:{switch(e){case"compositionstart":var T="onCompositionStart";break t;case"compositionend":T="onCompositionEnd";break t;case"compositionupdate":T="onCompositionUpdate";break t}T=void 0}else lc?vR(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(pR&&n.locale!=="ko"&&(lc||T!=="onCompositionStart"?T==="onCompositionEnd"&&lc&&(N=mR()):(so=u,__="value"in so?so.value:so.textContent,lc=!0)),M=nf(h,T),0<M.length&&(T=new MC(T,e,null,n,u),d.push({event:T,listeners:M}),N?T.data=N:(N=yR(n),N!==null&&(T.data=N)))),(N=I5?A5(e,n):R5(e,n))&&(h=nf(h,"onBeforeInput"),0<h.length&&(u=new MC("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:h}),u.data=N))}AR(d,t)})}function cu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function nf(e,t){for(var n=t+"Capture",i=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=eu(e,n),s!=null&&i.unshift(cu(e,s,r)),s=eu(e,t),s!=null&&i.push(cu(e,s,r))),e=e.return}return i}function Za(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $C(e,t,n,i,r){for(var s=t._reactName,o=[];n!==null&&n!==i;){var a=n,c=a.alternate,h=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&h!==null&&(a=h,r?(c=eu(n,s),c!=null&&o.unshift(cu(n,c,a))):r||(c=eu(n,s),c!=null&&o.push(cu(n,c,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var $5=/\r\n?/g,z5=/\u0000|\uFFFD/g;function zC(e){return(typeof e=="string"?e:""+e).replace($5,`
`).replace(z5,"")}function Bd(e,t,n){if(t=zC(t),zC(e)!==t&&n)throw Error(et(425))}function rf(){}var nx=null,ix=null;function rx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sx=typeof setTimeout=="function"?setTimeout:void 0,K5=typeof clearTimeout=="function"?clearTimeout:void 0,KC=typeof Promise=="function"?Promise:void 0,W5=typeof queueMicrotask=="function"?queueMicrotask:typeof KC<"u"?function(e){return KC.resolve(null).then(e).catch(Q5)}:sx;function Q5(e){setTimeout(function(){throw e})}function bv(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){e.removeChild(r),ru(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);ru(t)}function go(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function WC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var pl=Math.random().toString(36).slice(2),Lr="__reactFiber$"+pl,lu="__reactProps$"+pl,xs="__reactContainer$"+pl,ox="__reactEvents$"+pl,Y5="__reactListeners$"+pl,J5="__reactHandles$"+pl;function oa(e){var t=e[Lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[xs]||n[Lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=WC(e);e!==null;){if(n=e[Lr])return n;e=WC(e)}return t}e=n,n=e.parentNode}return null}function $u(e){return e=e[Lr]||e[xs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function dc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(et(33))}function Im(e){return e[lu]||null}var ax=[],gc=-1;function Fo(e){return{current:e}}function xe(e){0>gc||(e.current=ax[gc],ax[gc]=null,gc--)}function fe(e,t){gc++,ax[gc]=e.current,e.current=t}var No={},jn=Fo(No),di=Fo(!1),_a=No;function Wc(e,t){var n=e.type.contextTypes;if(!n)return No;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function gi(e){return e=e.childContextTypes,e!=null}function sf(){xe(di),xe(jn)}function QC(e,t,n){if(jn.current!==No)throw Error(et(168));fe(jn,t),fe(di,n)}function PR(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(et(108,L3(e)||"Unknown",r));return Re({},n,i)}function of(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||No,_a=jn.current,fe(jn,e),fe(di,di.current),!0}function YC(e,t,n){var i=e.stateNode;if(!i)throw Error(et(169));n?(e=PR(e,t,_a),i.__reactInternalMemoizedMergedChildContext=e,xe(di),xe(jn),fe(jn,e)):xe(di),fe(di,n)}var rs=null,Am=!1,Tv=!1;function MR(e){rs===null?rs=[e]:rs.push(e)}function X5(e){Am=!0,MR(e)}function Uo(){if(!Tv&&rs!==null){Tv=!0;var e=0,t=re;try{var n=rs;for(re=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}rs=null,Am=!1}catch(r){throw rs!==null&&(rs=rs.slice(e+1)),rR(p_,Uo),r}finally{re=t,Tv=!1}}return null}var fc=[],mc=0,af=null,cf=0,Mi=[],Di=0,wa=null,ss=1,os="";function ta(e,t){fc[mc++]=cf,fc[mc++]=af,af=e,cf=t}function DR(e,t,n){Mi[Di++]=ss,Mi[Di++]=os,Mi[Di++]=wa,wa=e;var i=ss;e=os;var r=32-mr(i)-1;i&=~(1<<r),n+=1;var s=32-mr(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,ss=1<<32-mr(t)+r|n<<r|i,os=s+e}else ss=1<<s|n<<r|i,os=e}function k_(e){e.return!==null&&(ta(e,1),DR(e,1,0))}function N_(e){for(;e===af;)af=fc[--mc],fc[mc]=null,cf=fc[--mc],fc[mc]=null;for(;e===wa;)wa=Mi[--Di],Mi[Di]=null,os=Mi[--Di],Mi[Di]=null,ss=Mi[--Di],Mi[Di]=null}var Ti=null,wi=null,Te=!1,ar=null;function LR(e,t){var n=Vi(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function JC(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ti=e,wi=go(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ti=e,wi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=wa!==null?{id:ss,overflow:os}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Vi(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ti=e,wi=null,!0):!1;default:return!1}}function cx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function lx(e){if(Te){var t=wi;if(t){var n=t;if(!JC(e,t)){if(cx(e))throw Error(et(418));t=go(n.nextSibling);var i=Ti;t&&JC(e,t)?LR(i,n):(e.flags=e.flags&-4097|2,Te=!1,Ti=e)}}else{if(cx(e))throw Error(et(418));e.flags=e.flags&-4097|2,Te=!1,Ti=e}}}function XC(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ti=e}function Gd(e){if(e!==Ti)return!1;if(!Te)return XC(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rx(e.type,e.memoizedProps)),t&&(t=wi)){if(cx(e))throw VR(),Error(et(418));for(;t;)LR(e,t),t=go(t.nextSibling)}if(XC(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(et(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wi=go(e.nextSibling);break t}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wi=null}}else wi=Ti?go(e.stateNode.nextSibling):null;return!0}function VR(){for(var e=wi;e;)e=go(e.nextSibling)}function Qc(){wi=Ti=null,Te=!1}function E_(e){ar===null?ar=[e]:ar.push(e)}var Z5=Ms.ReactCurrentBatchConfig;function nh(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(et(309));var i=n.stateNode}if(!i)throw Error(et(147,e));var r=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(et(284));if(!n._owner)throw Error(et(290,e))}return e}function Hd(e,t){throw e=Object.prototype.toString.call(t),Error(et(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ZC(e){var t=e._init;return t(e._payload)}function qR(e){function t(x,C){if(e){var k=x.deletions;k===null?(x.deletions=[C],x.flags|=16):k.push(C)}}function n(x,C){if(!e)return null;for(;C!==null;)t(x,C),C=C.sibling;return null}function i(x,C){for(x=new Map;C!==null;)C.key!==null?x.set(C.key,C):x.set(C.index,C),C=C.sibling;return x}function r(x,C){return x=vo(x,C),x.index=0,x.sibling=null,x}function s(x,C,k){return x.index=k,e?(k=x.alternate,k!==null?(k=k.index,k<C?(x.flags|=2,C):k):(x.flags|=2,C)):(x.flags|=1048576,C)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,C,k,P){return C===null||C.tag!==6?(C=Av(k,x.mode,P),C.return=x,C):(C=r(C,k),C.return=x,C)}function c(x,C,k,P){var A=k.type;return A===cc?u(x,C,k.props.children,P,k.key):C!==null&&(C.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Js&&ZC(A)===C.type)?(P=r(C,k.props),P.ref=nh(x,C,k),P.return=x,P):(P=Ag(k.type,k.key,k.props,null,x.mode,P),P.ref=nh(x,C,k),P.return=x,P)}function h(x,C,k,P){return C===null||C.tag!==4||C.stateNode.containerInfo!==k.containerInfo||C.stateNode.implementation!==k.implementation?(C=Rv(k,x.mode,P),C.return=x,C):(C=r(C,k.children||[]),C.return=x,C)}function u(x,C,k,P,A){return C===null||C.tag!==7?(C=pa(k,x.mode,P,A),C.return=x,C):(C=r(C,k),C.return=x,C)}function d(x,C,k){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Av(""+C,x.mode,k),C.return=x,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Md:return k=Ag(C.type,C.key,C.props,null,x.mode,k),k.ref=nh(x,null,C),k.return=x,k;case ac:return C=Rv(C,x.mode,k),C.return=x,C;case Js:var P=C._init;return d(x,P(C._payload),k)}if(yh(C)||Jl(C))return C=pa(C,x.mode,k,null),C.return=x,C;Hd(x,C)}return null}function f(x,C,k,P){var A=C!==null?C.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return A!==null?null:a(x,C,""+k,P);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Md:return k.key===A?c(x,C,k,P):null;case ac:return k.key===A?h(x,C,k,P):null;case Js:return A=k._init,f(x,C,A(k._payload),P)}if(yh(k)||Jl(k))return A!==null?null:u(x,C,k,P,null);Hd(x,k)}return null}function v(x,C,k,P,A){if(typeof P=="string"&&P!==""||typeof P=="number")return x=x.get(k)||null,a(C,x,""+P,A);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Md:return x=x.get(P.key===null?k:P.key)||null,c(C,x,P,A);case ac:return x=x.get(P.key===null?k:P.key)||null,h(C,x,P,A);case Js:var M=P._init;return v(x,C,k,M(P._payload),A)}if(yh(P)||Jl(P))return x=x.get(k)||null,u(C,x,P,A,null);Hd(C,P)}return null}function y(x,C,k,P){for(var A=null,M=null,N=C,T=C=0,E=null;N!==null&&T<k.length;T++){N.index>T?(E=N,N=null):E=N.sibling;var R=f(x,N,k[T],P);if(R===null){N===null&&(N=E);break}e&&N&&R.alternate===null&&t(x,N),C=s(R,C,T),M===null?A=R:M.sibling=R,M=R,N=E}if(T===k.length)return n(x,N),Te&&ta(x,T),A;if(N===null){for(;T<k.length;T++)N=d(x,k[T],P),N!==null&&(C=s(N,C,T),M===null?A=N:M.sibling=N,M=N);return Te&&ta(x,T),A}for(N=i(x,N);T<k.length;T++)E=v(N,x,T,k[T],P),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?T:E.key),C=s(E,C,T),M===null?A=E:M.sibling=E,M=E);return e&&N.forEach(function(D){return t(x,D)}),Te&&ta(x,T),A}function _(x,C,k,P){var A=Jl(k);if(typeof A!="function")throw Error(et(150));if(k=A.call(k),k==null)throw Error(et(151));for(var M=A=null,N=C,T=C=0,E=null,R=k.next();N!==null&&!R.done;T++,R=k.next()){N.index>T?(E=N,N=null):E=N.sibling;var D=f(x,N,R.value,P);if(D===null){N===null&&(N=E);break}e&&N&&D.alternate===null&&t(x,N),C=s(D,C,T),M===null?A=D:M.sibling=D,M=D,N=E}if(R.done)return n(x,N),Te&&ta(x,T),A;if(N===null){for(;!R.done;T++,R=k.next())R=d(x,R.value,P),R!==null&&(C=s(R,C,T),M===null?A=R:M.sibling=R,M=R);return Te&&ta(x,T),A}for(N=i(x,N);!R.done;T++,R=k.next())R=v(N,x,T,R.value,P),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?T:R.key),C=s(R,C,T),M===null?A=R:M.sibling=R,M=R);return e&&N.forEach(function(j){return t(x,j)}),Te&&ta(x,T),A}function w(x,C,k,P){if(typeof k=="object"&&k!==null&&k.type===cc&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Md:t:{for(var A=k.key,M=C;M!==null;){if(M.key===A){if(A=k.type,A===cc){if(M.tag===7){n(x,M.sibling),C=r(M,k.props.children),C.return=x,x=C;break t}}else if(M.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Js&&ZC(A)===M.type){n(x,M.sibling),C=r(M,k.props),C.ref=nh(x,M,k),C.return=x,x=C;break t}n(x,M);break}else t(x,M);M=M.sibling}k.type===cc?(C=pa(k.props.children,x.mode,P,k.key),C.return=x,x=C):(P=Ag(k.type,k.key,k.props,null,x.mode,P),P.ref=nh(x,C,k),P.return=x,x=P)}return o(x);case ac:t:{for(M=k.key;C!==null;){if(C.key===M)if(C.tag===4&&C.stateNode.containerInfo===k.containerInfo&&C.stateNode.implementation===k.implementation){n(x,C.sibling),C=r(C,k.children||[]),C.return=x,x=C;break t}else{n(x,C);break}else t(x,C);C=C.sibling}C=Rv(k,x.mode,P),C.return=x,x=C}return o(x);case Js:return M=k._init,w(x,C,M(k._payload),P)}if(yh(k))return y(x,C,k,P);if(Jl(k))return _(x,C,k,P);Hd(x,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,C!==null&&C.tag===6?(n(x,C.sibling),C=r(C,k),C.return=x,x=C):(n(x,C),C=Av(k,x.mode,P),C.return=x,x=C),o(x)):n(x,C)}return w}var Yc=qR(!0),jR=qR(!1),lf=Fo(null),hf=null,pc=null,S_=null;function I_(){S_=pc=hf=null}function A_(e){var t=lf.current;xe(lf),e._currentValue=t}function hx(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Pc(e,t){hf=e,S_=pc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(li=!0),e.firstContext=null)}function $i(e){var t=e._currentValue;if(S_!==e)if(e={context:e,memoizedValue:t,next:null},pc===null){if(hf===null)throw Error(et(308));pc=e,hf.dependencies={lanes:0,firstContext:e}}else pc=pc.next=e;return t}var aa=null;function R_(e){aa===null?aa=[e]:aa.push(e)}function FR(e,t,n,i){var r=t.interleaved;return r===null?(n.next=n,R_(t)):(n.next=r.next,r.next=n),t.interleaved=n,_s(e,i)}function _s(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Xs=!1;function P_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fo(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Zt&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,_s(e,n)}return r=i.interleaved,r===null?(t.next=t,R_(i)):(t.next=r.next,r.next=t),i.interleaved=t,_s(e,n)}function Cg(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,v_(e,n)}}function tk(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=t:s=s.next=t}else r=s=t;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function uf(e,t,n,i){var r=e.updateQueue;Xs=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=c))}if(s!==null){var d=r.baseState;o=0,u=h=c=null,a=s;do{var f=a.lane,v=a.eventTime;if((i&f)===f){u!==null&&(u=u.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var y=e,_=a;switch(f=t,v=n,_.tag){case 1:if(y=_.payload,typeof y=="function"){d=y.call(v,d,f);break t}d=y;break t;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,f=typeof y=="function"?y.call(v,d,f):y,f==null)break t;d=Re({},d,f);break t;case 2:Xs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else v={eventTime:v,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(h=u=v,c=d):u=u.next=v,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(c=d),r.baseState=c,r.firstBaseUpdate=h,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);Ta|=o,e.lanes=o,e.memoizedState=d}}function ek(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(et(191,r));r.call(i)}}}var zu={},jr=Fo(zu),hu=Fo(zu),uu=Fo(zu);function ca(e){if(e===zu)throw Error(et(174));return e}function M_(e,t){switch(fe(uu,t),fe(hu,e),fe(jr,zu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Hy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Hy(t,e)}xe(jr),fe(jr,t)}function Jc(){xe(jr),xe(hu),xe(uu)}function OR(e){ca(uu.current);var t=ca(jr.current),n=Hy(t,e.type);t!==n&&(fe(hu,e),fe(jr,n))}function D_(e){hu.current===e&&(xe(jr),xe(hu))}var ke=Fo(0);function df(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cv=[];function L_(){for(var e=0;e<Cv.length;e++)Cv[e]._workInProgressVersionPrimary=null;Cv.length=0}var kg=Ms.ReactCurrentDispatcher,kv=Ms.ReactCurrentBatchConfig,ba=0,Ie=null,tn=null,un=null,gf=!1,Ph=!1,du=0,tF=0;function kn(){throw Error(et(321))}function V_(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Tr(e[n],t[n]))return!1;return!0}function q_(e,t,n,i,r,s){if(ba=s,Ie=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kg.current=e===null||e.memoizedState===null?rF:sF,e=n(i,r),Ph){s=0;do{if(Ph=!1,du=0,25<=s)throw Error(et(301));s+=1,un=tn=null,t.updateQueue=null,kg.current=oF,e=n(i,r)}while(Ph)}if(kg.current=ff,t=tn!==null&&tn.next!==null,ba=0,un=tn=Ie=null,gf=!1,t)throw Error(et(300));return e}function j_(){var e=du!==0;return du=0,e}function Mr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Ie.memoizedState=un=e:un=un.next=e,un}function zi(){if(tn===null){var e=Ie.alternate;e=e!==null?e.memoizedState:null}else e=tn.next;var t=un===null?Ie.memoizedState:un.next;if(t!==null)un=t,tn=e;else{if(e===null)throw Error(et(310));tn=e,e={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},un===null?Ie.memoizedState=un=e:un=un.next=e}return un}function gu(e,t){return typeof t=="function"?t(e):t}function Nv(e){var t=zi(),n=t.queue;if(n===null)throw Error(et(311));n.lastRenderedReducer=e;var i=tn,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,h=s;do{var u=h.lane;if((ba&u)===u)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:e(i,h.action);else{var d={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=d,o=i):c=c.next=d,Ie.lanes|=u,Ta|=u}h=h.next}while(h!==null&&h!==s);c===null?o=i:c.next=a,Tr(i,t.memoizedState)||(li=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(e=n.interleaved,e!==null){r=e;do s=r.lane,Ie.lanes|=s,Ta|=s,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ev(e){var t=zi(),n=t.queue;if(n===null)throw Error(et(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=e(s,o.action),o=o.next;while(o!==r);Tr(s,t.memoizedState)||(li=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function BR(){}function GR(e,t){var n=Ie,i=zi(),r=t(),s=!Tr(i.memoizedState,r);if(s&&(i.memoizedState=r,li=!0),i=i.queue,F_(zR.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||un!==null&&un.memoizedState.tag&1){if(n.flags|=2048,fu(9,$R.bind(null,n,i,r,t),void 0,null),mn===null)throw Error(et(349));ba&30||HR(n,t,r)}return r}function HR(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ie.updateQueue,t===null?(t={lastEffect:null,stores:null},Ie.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $R(e,t,n,i){t.value=n,t.getSnapshot=i,KR(t)&&WR(e)}function zR(e,t,n){return n(function(){KR(t)&&WR(e)})}function KR(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Tr(e,n)}catch{return!0}}function WR(e){var t=_s(e,1);t!==null&&pr(t,e,1,-1)}function nk(e){var t=Mr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gu,lastRenderedState:e},t.queue=e,e=e.dispatch=iF.bind(null,Ie,e),[t.memoizedState,e]}function fu(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Ie.updateQueue,t===null?(t={lastEffect:null,stores:null},Ie.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function QR(){return zi().memoizedState}function Ng(e,t,n,i){var r=Mr();Ie.flags|=e,r.memoizedState=fu(1|t,n,void 0,i===void 0?null:i)}function Rm(e,t,n,i){var r=zi();i=i===void 0?null:i;var s=void 0;if(tn!==null){var o=tn.memoizedState;if(s=o.destroy,i!==null&&V_(i,o.deps)){r.memoizedState=fu(t,n,s,i);return}}Ie.flags|=e,r.memoizedState=fu(1|t,n,s,i)}function ik(e,t){return Ng(8390656,8,e,t)}function F_(e,t){return Rm(2048,8,e,t)}function YR(e,t){return Rm(4,2,e,t)}function JR(e,t){return Rm(4,4,e,t)}function XR(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ZR(e,t,n){return n=n!=null?n.concat([e]):null,Rm(4,4,XR.bind(null,t,e),n)}function U_(){}function tP(e,t){var n=zi();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&V_(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function eP(e,t){var n=zi();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&V_(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function nP(e,t,n){return ba&21?(Tr(n,t)||(n=aR(),Ie.lanes|=n,Ta|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,li=!0),e.memoizedState=n)}function eF(e,t){var n=re;re=n!==0&&4>n?n:4,e(!0);var i=kv.transition;kv.transition={};try{e(!1),t()}finally{re=n,kv.transition=i}}function iP(){return zi().memoizedState}function nF(e,t,n){var i=po(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},rP(e))sP(t,n);else if(n=FR(e,t,n,i),n!==null){var r=zn();pr(n,e,i,r),oP(n,t,i)}}function iF(e,t,n){var i=po(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(rP(e))sP(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Tr(a,o)){var c=t.interleaved;c===null?(r.next=r,R_(t)):(r.next=c.next,c.next=r),t.interleaved=r;return}}catch{}finally{}n=FR(e,t,r,i),n!==null&&(r=zn(),pr(n,e,i,r),oP(n,t,i))}}function rP(e){var t=e.alternate;return e===Ie||t!==null&&t===Ie}function sP(e,t){Ph=gf=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oP(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,v_(e,n)}}var ff={readContext:$i,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},rF={readContext:$i,useCallback:function(e,t){return Mr().memoizedState=[e,t===void 0?null:t],e},useContext:$i,useEffect:ik,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ng(4194308,4,XR.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ng(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ng(4,2,e,t)},useMemo:function(e,t){var n=Mr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Mr();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=nF.bind(null,Ie,e),[i.memoizedState,e]},useRef:function(e){var t=Mr();return e={current:e},t.memoizedState=e},useState:nk,useDebugValue:U_,useDeferredValue:function(e){return Mr().memoizedState=e},useTransition:function(){var e=nk(!1),t=e[0];return e=eF.bind(null,e[1]),Mr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Ie,r=Mr();if(Te){if(n===void 0)throw Error(et(407));n=n()}else{if(n=t(),mn===null)throw Error(et(349));ba&30||HR(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,ik(zR.bind(null,i,s,e),[e]),i.flags|=2048,fu(9,$R.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Mr(),t=mn.identifierPrefix;if(Te){var n=os,i=ss;n=(i&~(1<<32-mr(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=du++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=tF++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sF={readContext:$i,useCallback:tP,useContext:$i,useEffect:F_,useImperativeHandle:ZR,useInsertionEffect:YR,useLayoutEffect:JR,useMemo:eP,useReducer:Nv,useRef:QR,useState:function(){return Nv(gu)},useDebugValue:U_,useDeferredValue:function(e){var t=zi();return nP(t,tn.memoizedState,e)},useTransition:function(){var e=Nv(gu)[0],t=zi().memoizedState;return[e,t]},useMutableSource:BR,useSyncExternalStore:GR,useId:iP,unstable_isNewReconciler:!1},oF={readContext:$i,useCallback:tP,useContext:$i,useEffect:F_,useImperativeHandle:ZR,useInsertionEffect:YR,useLayoutEffect:JR,useMemo:eP,useReducer:Ev,useRef:QR,useState:function(){return Ev(gu)},useDebugValue:U_,useDeferredValue:function(e){var t=zi();return tn===null?t.memoizedState=e:nP(t,tn.memoizedState,e)},useTransition:function(){var e=Ev(gu)[0],t=zi().memoizedState;return[e,t]},useMutableSource:BR,useSyncExternalStore:GR,useId:iP,unstable_isNewReconciler:!1};function rr(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ux(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Re({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Pm={isMounted:function(e){return(e=e._reactInternals)?Ua(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=zn(),r=po(e),s=hs(i,r);s.payload=t,n!=null&&(s.callback=n),t=fo(e,s,r),t!==null&&(pr(t,e,r,i),Cg(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=zn(),r=po(e),s=hs(i,r);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=fo(e,s,r),t!==null&&(pr(t,e,r,i),Cg(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zn(),i=po(e),r=hs(n,i);r.tag=2,t!=null&&(r.callback=t),t=fo(e,r,i),t!==null&&(pr(t,e,i,n),Cg(t,e,i))}};function rk(e,t,n,i,r,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,o):t.prototype&&t.prototype.isPureReactComponent?!ou(n,i)||!ou(r,s):!0}function aP(e,t,n){var i=!1,r=No,s=t.contextType;return typeof s=="object"&&s!==null?s=$i(s):(r=gi(t)?_a:jn.current,i=t.contextTypes,s=(i=i!=null)?Wc(e,r):No),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Pm,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function sk(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Pm.enqueueReplaceState(t,t.state,null)}function dx(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},P_(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=$i(s):(s=gi(t)?_a:jn.current,r.context=Wc(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(ux(e,t,s,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Pm.enqueueReplaceState(r,r.state,null),uf(e,n,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Xc(e,t){try{var n="",i=t;do n+=D3(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function Sv(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function gx(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var aF=typeof WeakMap=="function"?WeakMap:Map;function cP(e,t,n){n=hs(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){pf||(pf=!0,Tx=i),gx(e,t)},n}function lP(e,t,n){n=hs(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){gx(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){gx(e,t),typeof i!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function ok(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new aF;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=wF.bind(null,e,t,n),t.then(e,e))}function ak(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ck(e,t,n,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=hs(-1,1),t.tag=2,fo(n,t,1))),n.lanes|=1),e)}var cF=Ms.ReactCurrentOwner,li=!1;function Bn(e,t,n,i){t.child=e===null?jR(t,null,n,i):Yc(t,e.child,n,i)}function lk(e,t,n,i,r){n=n.render;var s=t.ref;return Pc(t,r),i=q_(e,t,n,i,s,r),n=j_(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ws(e,t,r)):(Te&&n&&k_(t),t.flags|=1,Bn(e,t,i,r),t.child)}function hk(e,t,n,i,r){if(e===null){var s=n.type;return typeof s=="function"&&!W_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,hP(e,t,s,i,r)):(e=Ag(n.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ou,n(o,i)&&e.ref===t.ref)return ws(e,t,r)}return t.flags|=1,e=vo(s,i),e.ref=t.ref,e.return=t,t.child=e}function hP(e,t,n,i,r){if(e!==null){var s=e.memoizedProps;if(ou(s,i)&&e.ref===t.ref)if(li=!1,t.pendingProps=i=s,(e.lanes&r)!==0)e.flags&131072&&(li=!0);else return t.lanes=e.lanes,ws(e,t,r)}return fx(e,t,n,i,r)}function uP(e,t,n){var i=t.pendingProps,r=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},fe(yc,xi),xi|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,fe(yc,xi),xi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,fe(yc,xi),xi|=i}else s!==null?(i=s.baseLanes|n,t.memoizedState=null):i=n,fe(yc,xi),xi|=i;return Bn(e,t,r,n),t.child}function dP(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function fx(e,t,n,i,r){var s=gi(n)?_a:jn.current;return s=Wc(t,s),Pc(t,r),n=q_(e,t,n,i,s,r),i=j_(),e!==null&&!li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ws(e,t,r)):(Te&&i&&k_(t),t.flags|=1,Bn(e,t,n,r),t.child)}function uk(e,t,n,i,r){if(gi(n)){var s=!0;of(t)}else s=!1;if(Pc(t,r),t.stateNode===null)Eg(e,t),aP(t,n,i),dx(t,n,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=$i(h):(h=gi(n)?_a:jn.current,h=Wc(t,h));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==h)&&sk(t,o,i,h),Xs=!1;var f=t.memoizedState;o.state=f,uf(t,i,o,r),c=t.memoizedState,a!==i||f!==c||di.current||Xs?(typeof u=="function"&&(ux(t,n,u,i),c=t.memoizedState),(a=Xs||rk(t,n,a,i,f,c,h))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=h,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,UR(e,t),a=t.memoizedProps,h=t.type===t.elementType?a:rr(t.type,a),o.props=h,d=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=$i(c):(c=gi(n)?_a:jn.current,c=Wc(t,c));var v=n.getDerivedStateFromProps;(u=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==c)&&sk(t,o,i,c),Xs=!1,f=t.memoizedState,o.state=f,uf(t,i,o,r);var y=t.memoizedState;a!==d||f!==y||di.current||Xs?(typeof v=="function"&&(ux(t,n,v,i),y=t.memoizedState),(h=Xs||rk(t,n,h,i,f,y,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=y),o.props=i,o.state=y,o.context=c,i=h):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return mx(e,t,n,i,s,r)}function mx(e,t,n,i,r,s){dP(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&YC(t,n,!1),ws(e,t,s);i=t.stateNode,cF.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=Yc(t,e.child,null,s),t.child=Yc(t,null,a,s)):Bn(e,t,a,s),t.memoizedState=i.state,r&&YC(t,n,!0),t.child}function gP(e){var t=e.stateNode;t.pendingContext?QC(e,t.pendingContext,t.pendingContext!==t.context):t.context&&QC(e,t.context,!1),M_(e,t.containerInfo)}function dk(e,t,n,i,r){return Qc(),E_(r),t.flags|=256,Bn(e,t,n,i),t.child}var px={dehydrated:null,treeContext:null,retryLane:0};function vx(e){return{baseLanes:e,cachePool:null,transitions:null}}function fP(e,t,n){var i=t.pendingProps,r=ke.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),fe(ke,r&1),e===null)return lx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,s?(i=t.mode,s=t.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Lm(o,i,0,null),e=pa(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=vx(n),t.memoizedState=px,e):O_(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return lF(e,t,o,i,a,r,n);if(s){s=i.fallback,o=t.mode,r=e.child,a=r.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=c,t.deletions=null):(i=vo(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=vo(a,s):(s=pa(s,o,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,o=e.child.memoizedState,o=o===null?vx(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=px,i}return s=e.child,e=s.sibling,i=vo(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function O_(e,t){return t=Lm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $d(e,t,n,i){return i!==null&&E_(i),Yc(t,e.child,null,n),e=O_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lF(e,t,n,i,r,s,o){if(n)return t.flags&256?(t.flags&=-257,i=Sv(Error(et(422))),$d(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=Lm({mode:"visible",children:i.children},r,0,null),s=pa(s,r,o,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&Yc(t,e.child,null,o),t.child.memoizedState=vx(o),t.memoizedState=px,s);if(!(t.mode&1))return $d(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(et(419)),i=Sv(s,i,void 0),$d(e,t,o,i)}if(a=(o&e.childLanes)!==0,li||a){if(i=mn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,_s(e,r),pr(i,e,r,-1))}return K_(),i=Sv(Error(et(421))),$d(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=bF.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,wi=go(r.nextSibling),Ti=t,Te=!0,ar=null,e!==null&&(Mi[Di++]=ss,Mi[Di++]=os,Mi[Di++]=wa,ss=e.id,os=e.overflow,wa=t),t=O_(t,i.children),t.flags|=4096,t)}function gk(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),hx(e.return,t,n)}function Iv(e,t,n,i,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function mP(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Bn(e,t,i.children,n),i=ke.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gk(e,n,t);else if(e.tag===19)gk(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(fe(ke,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&df(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Iv(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&df(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Iv(t,!0,n,null,s);break;case"together":Iv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Eg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ws(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ta|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(et(153));if(t.child!==null){for(e=t.child,n=vo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=vo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function hF(e,t,n){switch(t.tag){case 3:gP(t),Qc();break;case 5:OR(t);break;case 1:gi(t.type)&&of(t);break;case 4:M_(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;fe(lf,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(fe(ke,ke.current&1),t.flags|=128,null):n&t.child.childLanes?fP(e,t,n):(fe(ke,ke.current&1),e=ws(e,t,n),e!==null?e.sibling:null);fe(ke,ke.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return mP(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),fe(ke,ke.current),i)break;return null;case 22:case 23:return t.lanes=0,uP(e,t,n)}return ws(e,t,n)}var pP,yx,vP,yP;pP=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yx=function(){};vP=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,ca(jr.current);var s=null;switch(n){case"input":r=Uy(e,r),i=Uy(e,i),s=[];break;case"select":r=Re({},r,{value:void 0}),i=Re({},i,{value:void 0}),s=[];break;case"textarea":r=Gy(e,r),i=Gy(e,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=rf)}$y(n,i);var o;n=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var a=r[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Zh.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(a=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Zh.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&ve("scroll",e),s||a===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};yP=function(e,t,n,i){n!==i&&(t.flags|=4)};function ih(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uF(e,t,n){var i=t.pendingProps;switch(N_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(t),null;case 1:return gi(t.type)&&sf(),Nn(t),null;case 3:return i=t.stateNode,Jc(),xe(di),xe(jn),L_(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Gd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ar!==null&&(Nx(ar),ar=null))),yx(e,t),Nn(t),null;case 5:D_(t);var r=ca(uu.current);if(n=t.type,e!==null&&t.stateNode!=null)vP(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(et(166));return Nn(t),null}if(e=ca(jr.current),Gd(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[Lr]=t,i[lu]=s,e=(t.mode&1)!==0,n){case"dialog":ve("cancel",i),ve("close",i);break;case"iframe":case"object":case"embed":ve("load",i);break;case"video":case"audio":for(r=0;r<_h.length;r++)ve(_h[r],i);break;case"source":ve("error",i);break;case"img":case"image":case"link":ve("error",i),ve("load",i);break;case"details":ve("toggle",i);break;case"input":bC(i,s),ve("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ve("invalid",i);break;case"textarea":CC(i,s),ve("invalid",i)}$y(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bd(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bd(i.textContent,a,e),r=["children",""+a]):Zh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ve("scroll",i)}switch(n){case"input":Dd(i),TC(i,s,!0);break;case"textarea":Dd(i),kC(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=rf)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zA(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(n,{is:i.is}):(e=o.createElement(n),n==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,n),e[Lr]=t,e[lu]=i,pP(e,t,!1,!1),t.stateNode=e;t:{switch(o=zy(n,i),n){case"dialog":ve("cancel",e),ve("close",e),r=i;break;case"iframe":case"object":case"embed":ve("load",e),r=i;break;case"video":case"audio":for(r=0;r<_h.length;r++)ve(_h[r],e);r=i;break;case"source":ve("error",e),r=i;break;case"img":case"image":case"link":ve("error",e),ve("load",e),r=i;break;case"details":ve("toggle",e),r=i;break;case"input":bC(e,i),r=Uy(e,i),ve("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=Re({},i,{value:void 0}),ve("invalid",e);break;case"textarea":CC(e,i),r=Gy(e,i),ve("invalid",e);break;default:r=i}$y(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?QA(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&KA(e,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&tu(e,c):typeof c=="number"&&tu(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Zh.hasOwnProperty(s)?c!=null&&s==="onScroll"&&ve("scroll",e):c!=null&&u_(e,s,c,o))}switch(n){case"input":Dd(e),TC(e,i,!1);break;case"textarea":Dd(e),kC(e);break;case"option":i.value!=null&&e.setAttribute("value",""+ko(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?Sc(e,!!i.multiple,s,!1):i.defaultValue!=null&&Sc(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=rf)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nn(t),null;case 6:if(e&&t.stateNode!=null)yP(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(et(166));if(n=ca(uu.current),ca(jr.current),Gd(t)){if(i=t.stateNode,n=t.memoizedProps,i[Lr]=t,(s=i.nodeValue!==n)&&(e=Ti,e!==null))switch(e.tag){case 3:Bd(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bd(i.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Lr]=t,t.stateNode=i}return Nn(t),null;case 13:if(xe(ke),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&wi!==null&&t.mode&1&&!(t.flags&128))VR(),Qc(),t.flags|=98560,s=!1;else if(s=Gd(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(et(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(et(317));s[Lr]=t}else Qc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nn(t),s=!1}else ar!==null&&(Nx(ar),ar=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||ke.current&1?nn===0&&(nn=3):K_())),t.updateQueue!==null&&(t.flags|=4),Nn(t),null);case 4:return Jc(),yx(e,t),e===null&&au(t.stateNode.containerInfo),Nn(t),null;case 10:return A_(t.type._context),Nn(t),null;case 17:return gi(t.type)&&sf(),Nn(t),null;case 19:if(xe(ke),s=t.memoizedState,s===null)return Nn(t),null;if(i=(t.flags&128)!==0,o=s.rendering,o===null)if(i)ih(s,!1);else{if(nn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=df(e),o!==null){for(t.flags|=128,ih(s,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)s=n,e=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return fe(ke,ke.current&1|2),t.child}e=e.sibling}s.tail!==null&&Oe()>Zc&&(t.flags|=128,i=!0,ih(s,!1),t.lanes=4194304)}else{if(!i)if(e=df(o),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ih(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Te)return Nn(t),null}else 2*Oe()-s.renderingStartTime>Zc&&n!==1073741824&&(t.flags|=128,i=!0,ih(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Oe(),t.sibling=null,n=ke.current,fe(ke,i?n&1|2:n&1),t):(Nn(t),null);case 22:case 23:return z_(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?xi&1073741824&&(Nn(t),t.subtreeFlags&6&&(t.flags|=8192)):Nn(t),null;case 24:return null;case 25:return null}throw Error(et(156,t.tag))}function dF(e,t){switch(N_(t),t.tag){case 1:return gi(t.type)&&sf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jc(),xe(di),xe(jn),L_(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return D_(t),null;case 13:if(xe(ke),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(et(340));Qc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xe(ke),null;case 4:return Jc(),null;case 10:return A_(t.type._context),null;case 22:case 23:return z_(),null;case 24:return null;default:return null}}var zd=!1,An=!1,gF=typeof WeakSet=="function"?WeakSet:Set,xt=null;function vc(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Le(e,t,i)}else n.current=null}function xx(e,t,n){try{n()}catch(i){Le(e,t,i)}}var fk=!1;function fF(e,t){if(nx=tf,e=TR(),C_(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else t:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break t}var o=0,a=-1,c=-1,h=0,u=0,d=e,f=null;e:for(;;){for(var v;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(c=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(v=d.firstChild)!==null;)f=d,d=v;for(;;){if(d===e)break e;if(f===n&&++h===r&&(a=o),f===s&&++u===i&&(c=o),(v=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=v}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ix={focusedElem:e,selectionRange:n},tf=!1,xt=t;xt!==null;)if(t=xt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xt=e;else for(;xt!==null;){t=xt;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,w=y.memoizedState,x=t.stateNode,C=x.getSnapshotBeforeUpdate(t.elementType===t.type?_:rr(t.type,_),w);x.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(et(163))}}catch(P){Le(t,t.return,P)}if(e=t.sibling,e!==null){e.return=t.return,xt=e;break}xt=t.return}return y=fk,fk=!1,y}function Mh(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&xx(t,n,s)}r=r.next}while(r!==i)}}function Mm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function _x(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function xP(e){var t=e.alternate;t!==null&&(e.alternate=null,xP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Lr],delete t[lu],delete t[ox],delete t[Y5],delete t[J5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _P(e){return e.tag===5||e.tag===3||e.tag===4}function mk(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||_P(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wx(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=rf));else if(i!==4&&(e=e.child,e!==null))for(wx(e,t,n),e=e.sibling;e!==null;)wx(e,t,n),e=e.sibling}function bx(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(bx(e,t,n),e=e.sibling;e!==null;)bx(e,t,n),e=e.sibling}var _n=null,or=!1;function Ks(e,t,n){for(n=n.child;n!==null;)wP(e,t,n),n=n.sibling}function wP(e,t,n){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(km,n)}catch{}switch(n.tag){case 5:An||vc(n,t);case 6:var i=_n,r=or;_n=null,Ks(e,t,n),_n=i,or=r,_n!==null&&(or?(e=_n,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):_n.removeChild(n.stateNode));break;case 18:_n!==null&&(or?(e=_n,n=n.stateNode,e.nodeType===8?bv(e.parentNode,n):e.nodeType===1&&bv(e,n),ru(e)):bv(_n,n.stateNode));break;case 4:i=_n,r=or,_n=n.stateNode.containerInfo,or=!0,Ks(e,t,n),_n=i,or=r;break;case 0:case 11:case 14:case 15:if(!An&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&xx(n,t,o),r=r.next}while(r!==i)}Ks(e,t,n);break;case 1:if(!An&&(vc(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Le(n,t,a)}Ks(e,t,n);break;case 21:Ks(e,t,n);break;case 22:n.mode&1?(An=(i=An)||n.memoizedState!==null,Ks(e,t,n),An=i):Ks(e,t,n);break;default:Ks(e,t,n)}}function pk(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new gF),t.forEach(function(i){var r=TF.bind(null,e,i);n.has(i)||(n.add(i),i.then(r,r))})}}function er(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,o=t,a=o;t:for(;a!==null;){switch(a.tag){case 5:_n=a.stateNode,or=!1;break t;case 3:_n=a.stateNode.containerInfo,or=!0;break t;case 4:_n=a.stateNode.containerInfo,or=!0;break t}a=a.return}if(_n===null)throw Error(et(160));wP(s,o,r),_n=null,or=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(h){Le(r,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bP(t,e),t=t.sibling}function bP(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(er(t,e),Rr(e),i&4){try{Mh(3,e,e.return),Mm(3,e)}catch(_){Le(e,e.return,_)}try{Mh(5,e,e.return)}catch(_){Le(e,e.return,_)}}break;case 1:er(t,e),Rr(e),i&512&&n!==null&&vc(n,n.return);break;case 5:if(er(t,e),Rr(e),i&512&&n!==null&&vc(n,n.return),e.flags&32){var r=e.stateNode;try{tu(r,"")}catch(_){Le(e,e.return,_)}}if(i&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&HA(r,s),zy(a,o);var h=zy(a,s);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?QA(r,d):u==="dangerouslySetInnerHTML"?KA(r,d):u==="children"?tu(r,d):u_(r,u,d,h)}switch(a){case"input":Oy(r,s);break;case"textarea":$A(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Sc(r,!!s.multiple,v,!1):f!==!!s.multiple&&(s.defaultValue!=null?Sc(r,!!s.multiple,s.defaultValue,!0):Sc(r,!!s.multiple,s.multiple?[]:"",!1))}r[lu]=s}catch(_){Le(e,e.return,_)}}break;case 6:if(er(t,e),Rr(e),i&4){if(e.stateNode===null)throw Error(et(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(_){Le(e,e.return,_)}}break;case 3:if(er(t,e),Rr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ru(t.containerInfo)}catch(_){Le(e,e.return,_)}break;case 4:er(t,e),Rr(e);break;case 13:er(t,e),Rr(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(H_=Oe())),i&4&&pk(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(An=(h=An)||u,er(t,e),An=h):er(t,e),Rr(e),i&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!u&&e.mode&1)for(xt=e,u=e.child;u!==null;){for(d=xt=u;xt!==null;){switch(f=xt,v=f.child,f.tag){case 0:case 11:case 14:case 15:Mh(4,f,f.return);break;case 1:vc(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){i=f,n=f.return;try{t=i,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(_){Le(i,n,_)}}break;case 5:vc(f,f.return);break;case 22:if(f.memoizedState!==null){yk(d);continue}}v!==null?(v.return=f,xt=v):yk(d)}u=u.sibling}t:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=WA("display",o))}catch(_){Le(e,e.return,_)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(_){Le(e,e.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break t;for(;d.sibling===null;){if(d.return===null||d.return===e)break t;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:er(t,e),Rr(e),i&4&&pk(e);break;case 21:break;default:er(t,e),Rr(e)}}function Rr(e){var t=e.flags;if(t&2){try{t:{for(var n=e.return;n!==null;){if(_P(n)){var i=n;break t}n=n.return}throw Error(et(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(tu(r,""),i.flags&=-33);var s=mk(e);bx(e,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=mk(e);wx(e,a,o);break;default:throw Error(et(161))}}catch(c){Le(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mF(e,t,n){xt=e,TP(e)}function TP(e,t,n){for(var i=(e.mode&1)!==0;xt!==null;){var r=xt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||zd;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||An;a=zd;var h=An;if(zd=o,(An=c)&&!h)for(xt=r;xt!==null;)o=xt,c=o.child,o.tag===22&&o.memoizedState!==null?xk(r):c!==null?(c.return=o,xt=c):xk(r);for(;s!==null;)xt=s,TP(s),s=s.sibling;xt=r,zd=a,An=h}vk(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,xt=s):vk(e)}}function vk(e){for(;xt!==null;){var t=xt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:An||Mm(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!An)if(n===null)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:rr(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ek(t,s,i);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ek(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ru(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(et(163))}An||t.flags&512&&_x(t)}catch(f){Le(t,t.return,f)}}if(t===e){xt=null;break}if(n=t.sibling,n!==null){n.return=t.return,xt=n;break}xt=t.return}}function yk(e){for(;xt!==null;){var t=xt;if(t===e){xt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xt=n;break}xt=t.return}}function xk(e){for(;xt!==null;){var t=xt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Mm(4,t)}catch(c){Le(t,n,c)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(c){Le(t,r,c)}}var s=t.return;try{_x(t)}catch(c){Le(t,s,c)}break;case 5:var o=t.return;try{_x(t)}catch(c){Le(t,o,c)}}}catch(c){Le(t,t.return,c)}if(t===e){xt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,xt=a;break}xt=t.return}}var pF=Math.ceil,mf=Ms.ReactCurrentDispatcher,B_=Ms.ReactCurrentOwner,Ui=Ms.ReactCurrentBatchConfig,Zt=0,mn=null,ze=null,Tn=0,xi=0,yc=Fo(0),nn=0,mu=null,Ta=0,Dm=0,G_=0,Dh=null,oi=null,H_=0,Zc=1/0,is=null,pf=!1,Tx=null,mo=null,Kd=!1,oo=null,vf=0,Lh=0,Cx=null,Sg=-1,Ig=0;function zn(){return Zt&6?Oe():Sg!==-1?Sg:Sg=Oe()}function po(e){return e.mode&1?Zt&2&&Tn!==0?Tn&-Tn:Z5.transition!==null?(Ig===0&&(Ig=aR()),Ig):(e=re,e!==0||(e=window.event,e=e===void 0?16:fR(e.type)),e):1}function pr(e,t,n,i){if(50<Lh)throw Lh=0,Cx=null,Error(et(185));Gu(e,n,i),(!(Zt&2)||e!==mn)&&(e===mn&&(!(Zt&2)&&(Dm|=n),nn===4&&to(e,Tn)),fi(e,i),n===1&&Zt===0&&!(t.mode&1)&&(Zc=Oe()+500,Am&&Uo()))}function fi(e,t){var n=e.callbackNode;Z3(e,t);var i=Zg(e,e===mn?Tn:0);if(i===0)n!==null&&SC(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&SC(n),t===1)e.tag===0?X5(_k.bind(null,e)):MR(_k.bind(null,e)),W5(function(){!(Zt&6)&&Uo()}),n=null;else{switch(cR(i)){case 1:n=p_;break;case 4:n=sR;break;case 16:n=Xg;break;case 536870912:n=oR;break;default:n=Xg}n=RP(n,CP.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function CP(e,t){if(Sg=-1,Ig=0,Zt&6)throw Error(et(327));var n=e.callbackNode;if(Mc()&&e.callbackNode!==n)return null;var i=Zg(e,e===mn?Tn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=yf(e,i);else{t=i;var r=Zt;Zt|=2;var s=NP();(mn!==e||Tn!==t)&&(is=null,Zc=Oe()+500,ma(e,t));do try{xF();break}catch(a){kP(e,a)}while(!0);I_(),mf.current=s,Zt=r,ze!==null?t=0:(mn=null,Tn=0,t=nn)}if(t!==0){if(t===2&&(r=Jy(e),r!==0&&(i=r,t=kx(e,r))),t===1)throw n=mu,ma(e,0),to(e,i),fi(e,Oe()),n;if(t===6)to(e,i);else{if(r=e.current.alternate,!(i&30)&&!vF(r)&&(t=yf(e,i),t===2&&(s=Jy(e),s!==0&&(i=s,t=kx(e,s))),t===1))throw n=mu,ma(e,0),to(e,i),fi(e,Oe()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(et(345));case 2:ea(e,oi,is);break;case 3:if(to(e,i),(i&130023424)===i&&(t=H_+500-Oe(),10<t)){if(Zg(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){zn(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=sx(ea.bind(null,e,oi,is),t);break}ea(e,oi,is);break;case 4:if(to(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-mr(i);s=1<<o,o=t[o],o>r&&(r=o),i&=~s}if(i=r,i=Oe()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*pF(i/1960))-i,10<i){e.timeoutHandle=sx(ea.bind(null,e,oi,is),i);break}ea(e,oi,is);break;case 5:ea(e,oi,is);break;default:throw Error(et(329))}}}return fi(e,Oe()),e.callbackNode===n?CP.bind(null,e):null}function kx(e,t){var n=Dh;return e.current.memoizedState.isDehydrated&&(ma(e,t).flags|=256),e=yf(e,t),e!==2&&(t=oi,oi=n,t!==null&&Nx(t)),e}function Nx(e){oi===null?oi=e:oi.push.apply(oi,e)}function vF(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Tr(s(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function to(e,t){for(t&=~G_,t&=~Dm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-mr(t),i=1<<n;e[n]=-1,t&=~i}}function _k(e){if(Zt&6)throw Error(et(327));Mc();var t=Zg(e,0);if(!(t&1))return fi(e,Oe()),null;var n=yf(e,t);if(e.tag!==0&&n===2){var i=Jy(e);i!==0&&(t=i,n=kx(e,i))}if(n===1)throw n=mu,ma(e,0),to(e,t),fi(e,Oe()),n;if(n===6)throw Error(et(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ea(e,oi,is),fi(e,Oe()),null}function $_(e,t){var n=Zt;Zt|=1;try{return e(t)}finally{Zt=n,Zt===0&&(Zc=Oe()+500,Am&&Uo())}}function Ca(e){oo!==null&&oo.tag===0&&!(Zt&6)&&Mc();var t=Zt;Zt|=1;var n=Ui.transition,i=re;try{if(Ui.transition=null,re=1,e)return e()}finally{re=i,Ui.transition=n,Zt=t,!(Zt&6)&&Uo()}}function z_(){xi=yc.current,xe(yc)}function ma(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,K5(n)),ze!==null)for(n=ze.return;n!==null;){var i=n;switch(N_(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&sf();break;case 3:Jc(),xe(di),xe(jn),L_();break;case 5:D_(i);break;case 4:Jc();break;case 13:xe(ke);break;case 19:xe(ke);break;case 10:A_(i.type._context);break;case 22:case 23:z_()}n=n.return}if(mn=e,ze=e=vo(e.current,null),Tn=xi=t,nn=0,mu=null,G_=Dm=Ta=0,oi=Dh=null,aa!==null){for(t=0;t<aa.length;t++)if(n=aa[t],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}aa=null}return e}function kP(e,t){do{var n=ze;try{if(I_(),kg.current=ff,gf){for(var i=Ie.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}gf=!1}if(ba=0,un=tn=Ie=null,Ph=!1,du=0,B_.current=null,n===null||n.return===null){nn=1,mu=t,ze=null;break}t:{var s=e,o=n.return,a=n,c=t;if(t=Tn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var v=ak(o);if(v!==null){v.flags&=-257,ck(v,o,a,s,t),v.mode&1&&ok(s,h,t),t=v,c=h;var y=t.updateQueue;if(y===null){var _=new Set;_.add(c),t.updateQueue=_}else y.add(c);break t}else{if(!(t&1)){ok(s,h,t),K_();break t}c=Error(et(426))}}else if(Te&&a.mode&1){var w=ak(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),ck(w,o,a,s,t),E_(Xc(c,a));break t}}s=c=Xc(c,a),nn!==4&&(nn=2),Dh===null?Dh=[s]:Dh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=cP(s,c,t);tk(s,x);break t;case 1:a=c;var C=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(mo===null||!mo.has(k)))){s.flags|=65536,t&=-t,s.lanes|=t;var P=lP(s,a,t);tk(s,P);break t}}s=s.return}while(s!==null)}SP(n)}catch(A){t=A,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(!0)}function NP(){var e=mf.current;return mf.current=ff,e===null?ff:e}function K_(){(nn===0||nn===3||nn===2)&&(nn=4),mn===null||!(Ta&268435455)&&!(Dm&268435455)||to(mn,Tn)}function yf(e,t){var n=Zt;Zt|=2;var i=NP();(mn!==e||Tn!==t)&&(is=null,ma(e,t));do try{yF();break}catch(r){kP(e,r)}while(!0);if(I_(),Zt=n,mf.current=i,ze!==null)throw Error(et(261));return mn=null,Tn=0,nn}function yF(){for(;ze!==null;)EP(ze)}function xF(){for(;ze!==null&&!H3();)EP(ze)}function EP(e){var t=AP(e.alternate,e,xi);e.memoizedProps=e.pendingProps,t===null?SP(e):ze=t,B_.current=null}function SP(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=dF(n,t),n!==null){n.flags&=32767,ze=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nn=6,ze=null;return}}else if(n=uF(n,t,xi),n!==null){ze=n;return}if(t=t.sibling,t!==null){ze=t;return}ze=t=e}while(t!==null);nn===0&&(nn=5)}function ea(e,t,n){var i=re,r=Ui.transition;try{Ui.transition=null,re=1,_F(e,t,n,i)}finally{Ui.transition=r,re=i}return null}function _F(e,t,n,i){do Mc();while(oo!==null);if(Zt&6)throw Error(et(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(et(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(t5(e,s),e===mn&&(ze=mn=null,Tn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kd||(Kd=!0,RP(Xg,function(){return Mc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ui.transition,Ui.transition=null;var o=re;re=1;var a=Zt;Zt|=4,B_.current=null,fF(e,n),bP(n,e),U5(ix),tf=!!nx,ix=nx=null,e.current=n,mF(n),$3(),Zt=a,re=o,Ui.transition=s}else e.current=n;if(Kd&&(Kd=!1,oo=e,vf=r),s=e.pendingLanes,s===0&&(mo=null),W3(n.stateNode),fi(e,Oe()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(pf)throw pf=!1,e=Tx,Tx=null,e;return vf&1&&e.tag!==0&&Mc(),s=e.pendingLanes,s&1?e===Cx?Lh++:(Lh=0,Cx=e):Lh=0,Uo(),null}function Mc(){if(oo!==null){var e=cR(vf),t=Ui.transition,n=re;try{if(Ui.transition=null,re=16>e?16:e,oo===null)var i=!1;else{if(e=oo,oo=null,vf=0,Zt&6)throw Error(et(331));var r=Zt;for(Zt|=4,xt=e.current;xt!==null;){var s=xt,o=s.child;if(xt.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(xt=h;xt!==null;){var u=xt;switch(u.tag){case 0:case 11:case 15:Mh(8,u,s)}var d=u.child;if(d!==null)d.return=u,xt=d;else for(;xt!==null;){u=xt;var f=u.sibling,v=u.return;if(xP(u),u===h){xt=null;break}if(f!==null){f.return=v,xt=f;break}xt=v}}}var y=s.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var w=_.sibling;_.sibling=null,_=w}while(_!==null)}}xt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,xt=o;else t:for(;xt!==null;){if(s=xt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Mh(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,xt=x;break t}xt=s.return}}var C=e.current;for(xt=C;xt!==null;){o=xt;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,xt=k;else t:for(o=C;xt!==null;){if(a=xt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Mm(9,a)}}catch(A){Le(a,a.return,A)}if(a===o){xt=null;break t}var P=a.sibling;if(P!==null){P.return=a.return,xt=P;break t}xt=a.return}}if(Zt=r,Uo(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(km,e)}catch{}i=!0}return i}finally{re=n,Ui.transition=t}}return!1}function wk(e,t,n){t=Xc(n,t),t=cP(e,t,1),e=fo(e,t,1),t=zn(),e!==null&&(Gu(e,1,t),fi(e,t))}function Le(e,t,n){if(e.tag===3)wk(e,e,n);else for(;t!==null;){if(t.tag===3){wk(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(mo===null||!mo.has(i))){e=Xc(n,e),e=lP(t,e,1),t=fo(t,e,1),e=zn(),t!==null&&(Gu(t,1,e),fi(t,e));break}}t=t.return}}function wF(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=zn(),e.pingedLanes|=e.suspendedLanes&n,mn===e&&(Tn&n)===n&&(nn===4||nn===3&&(Tn&130023424)===Tn&&500>Oe()-H_?ma(e,0):G_|=n),fi(e,t)}function IP(e,t){t===0&&(e.mode&1?(t=qd,qd<<=1,!(qd&130023424)&&(qd=4194304)):t=1);var n=zn();e=_s(e,t),e!==null&&(Gu(e,t,n),fi(e,n))}function bF(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),IP(e,n)}function TF(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(et(314))}i!==null&&i.delete(t),IP(e,n)}var AP;AP=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||di.current)li=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return li=!1,hF(e,t,n);li=!!(e.flags&131072)}else li=!1,Te&&t.flags&1048576&&DR(t,cf,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Eg(e,t),e=t.pendingProps;var r=Wc(t,jn.current);Pc(t,n),r=q_(null,t,i,e,r,n);var s=j_();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gi(i)?(s=!0,of(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,P_(t),r.updater=Pm,t.stateNode=r,r._reactInternals=t,dx(t,i,e,n),t=mx(null,t,i,!0,s,n)):(t.tag=0,Te&&s&&k_(t),Bn(null,t,r,n),t=t.child),t;case 16:i=t.elementType;t:{switch(Eg(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=kF(i),e=rr(i,e),r){case 0:t=fx(null,t,i,e,n);break t;case 1:t=uk(null,t,i,e,n);break t;case 11:t=lk(null,t,i,e,n);break t;case 14:t=hk(null,t,i,rr(i.type,e),n);break t}throw Error(et(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),fx(e,t,i,r,n);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),uk(e,t,i,r,n);case 3:t:{if(gP(t),e===null)throw Error(et(387));i=t.pendingProps,s=t.memoizedState,r=s.element,UR(e,t),uf(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=Xc(Error(et(423)),t),t=dk(e,t,i,n,r);break t}else if(i!==r){r=Xc(Error(et(424)),t),t=dk(e,t,i,n,r);break t}else for(wi=go(t.stateNode.containerInfo.firstChild),Ti=t,Te=!0,ar=null,n=jR(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qc(),i===r){t=ws(e,t,n);break t}Bn(e,t,i,n)}t=t.child}return t;case 5:return OR(t),e===null&&lx(t),i=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,o=r.children,rx(i,r)?o=null:s!==null&&rx(i,s)&&(t.flags|=32),dP(e,t),Bn(e,t,o,n),t.child;case 6:return e===null&&lx(t),null;case 13:return fP(e,t,n);case 4:return M_(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Yc(t,null,i,n):Bn(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),lk(e,t,i,r,n);case 7:return Bn(e,t,t.pendingProps,n),t.child;case 8:return Bn(e,t,t.pendingProps.children,n),t.child;case 12:return Bn(e,t,t.pendingProps.children,n),t.child;case 10:t:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,fe(lf,i._currentValue),i._currentValue=o,s!==null)if(Tr(s.value,o)){if(s.children===r.children&&!di.current){t=ws(e,t,n);break t}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=hs(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?c.next=c:(c.next=u.next,u.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),hx(s.return,n,t),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(et(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),hx(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Bn(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Pc(t,n),r=$i(r),i=i(r),t.flags|=1,Bn(e,t,i,n),t.child;case 14:return i=t.type,r=rr(i,t.pendingProps),r=rr(i.type,r),hk(e,t,i,r,n);case 15:return hP(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:rr(i,r),Eg(e,t),t.tag=1,gi(i)?(e=!0,of(t)):e=!1,Pc(t,n),aP(t,i,r),dx(t,i,r,n),mx(null,t,i,!0,e,n);case 19:return mP(e,t,n);case 22:return uP(e,t,n)}throw Error(et(156,t.tag))};function RP(e,t){return rR(e,t)}function CF(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vi(e,t,n,i){return new CF(e,t,n,i)}function W_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kF(e){if(typeof e=="function")return W_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===g_)return 11;if(e===f_)return 14}return 2}function vo(e,t){var n=e.alternate;return n===null?(n=Vi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ag(e,t,n,i,r,s){var o=2;if(i=e,typeof e=="function")W_(e)&&(o=1);else if(typeof e=="string")o=5;else t:switch(e){case cc:return pa(n.children,r,s,t);case d_:o=8,r|=8;break;case Vy:return e=Vi(12,n,t,r|2),e.elementType=Vy,e.lanes=s,e;case qy:return e=Vi(13,n,t,r),e.elementType=qy,e.lanes=s,e;case jy:return e=Vi(19,n,t,r),e.elementType=jy,e.lanes=s,e;case OA:return Lm(n,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case FA:o=10;break t;case UA:o=9;break t;case g_:o=11;break t;case f_:o=14;break t;case Js:o=16,i=null;break t}throw Error(et(130,e==null?e:typeof e,""))}return t=Vi(o,n,t,r),t.elementType=e,t.type=i,t.lanes=s,t}function pa(e,t,n,i){return e=Vi(7,e,i,t),e.lanes=n,e}function Lm(e,t,n,i){return e=Vi(22,e,i,t),e.elementType=OA,e.lanes=n,e.stateNode={isHidden:!1},e}function Av(e,t,n){return e=Vi(6,e,null,t),e.lanes=n,e}function Rv(e,t,n){return t=Vi(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function NF(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uv(0),this.expirationTimes=uv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uv(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Q_(e,t,n,i,r,s,o,a,c){return e=new NF(e,t,n,a,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Vi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},P_(s),e}function EF(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ac,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function PP(e){if(!e)return No;e=e._reactInternals;t:{if(Ua(e)!==e||e.tag!==1)throw Error(et(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(gi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(et(171))}if(e.tag===1){var n=e.type;if(gi(n))return PR(e,n,t)}return t}function MP(e,t,n,i,r,s,o,a,c){return e=Q_(n,i,!0,e,r,s,o,a,c),e.context=PP(null),n=e.current,i=zn(),r=po(n),s=hs(i,r),s.callback=t??null,fo(n,s,r),e.current.lanes=r,Gu(e,r,i),fi(e,i),e}function Vm(e,t,n,i){var r=t.current,s=zn(),o=po(r);return n=PP(n),t.context===null?t.context=n:t.pendingContext=n,t=hs(s,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=fo(r,t,o),e!==null&&(pr(e,r,o,s),Cg(e,r,o)),o}function xf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function bk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Y_(e,t){bk(e,t),(e=e.alternate)&&bk(e,t)}function SF(){return null}var DP=typeof reportError=="function"?reportError:function(e){console.error(e)};function J_(e){this._internalRoot=e}qm.prototype.render=J_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(et(409));Vm(e,t,null,null)};qm.prototype.unmount=J_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ca(function(){Vm(null,e,null,null)}),t[xs]=null}};function qm(e){this._internalRoot=e}qm.prototype.unstable_scheduleHydration=function(e){if(e){var t=uR();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Zs.length&&t!==0&&t<Zs[n].priority;n++);Zs.splice(n,0,e),n===0&&gR(e)}};function X_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function jm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tk(){}function IF(e,t,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var h=xf(o);s.call(h)}}var o=MP(t,i,e,0,null,!1,!1,"",Tk);return e._reactRootContainer=o,e[xs]=o.current,au(e.nodeType===8?e.parentNode:e),Ca(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var h=xf(c);a.call(h)}}var c=Q_(e,0,!1,null,null,!1,!1,"",Tk);return e._reactRootContainer=c,e[xs]=c.current,au(e.nodeType===8?e.parentNode:e),Ca(function(){Vm(t,c,n,i)}),c}function Fm(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=xf(o);a.call(c)}}Vm(t,o,e,r)}else o=IF(n,t,e,r,i);return xf(o)}lR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=xh(t.pendingLanes);n!==0&&(v_(t,n|1),fi(t,Oe()),!(Zt&6)&&(Zc=Oe()+500,Uo()))}break;case 13:Ca(function(){var i=_s(e,1);if(i!==null){var r=zn();pr(i,e,1,r)}}),Y_(e,1)}};y_=function(e){if(e.tag===13){var t=_s(e,134217728);if(t!==null){var n=zn();pr(t,e,134217728,n)}Y_(e,134217728)}};hR=function(e){if(e.tag===13){var t=po(e),n=_s(e,t);if(n!==null){var i=zn();pr(n,e,t,i)}Y_(e,t)}};uR=function(){return re};dR=function(e,t){var n=re;try{return re=e,t()}finally{re=n}};Wy=function(e,t,n){switch(t){case"input":if(Oy(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Im(i);if(!r)throw Error(et(90));GA(i),Oy(i,r)}}}break;case"textarea":$A(e,n);break;case"select":t=n.value,t!=null&&Sc(e,!!n.multiple,t,!1)}};XA=$_;ZA=Ca;var AF={usingClientEntryPoint:!1,Events:[$u,dc,Im,YA,JA,$_]},rh={findFiberByHostInstance:oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RF={bundleType:rh.bundleType,version:rh.version,rendererPackageName:rh.rendererPackageName,rendererConfig:rh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=nR(e),e===null?null:e.stateNode},findFiberByHostInstance:rh.findFiberByHostInstance||SF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wd.isDisabled&&Wd.supportsFiber)try{km=Wd.inject(RF),qr=Wd}catch{}}Ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AF;Ei.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X_(t))throw Error(et(200));return EF(e,t,null,n)};Ei.createRoot=function(e,t){if(!X_(e))throw Error(et(299));var n=!1,i="",r=DP;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=Q_(e,1,!1,null,null,n,!1,i,r),e[xs]=t.current,au(e.nodeType===8?e.parentNode:e),new J_(t)};Ei.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(et(188)):(e=Object.keys(e).join(","),Error(et(268,e)));return e=nR(t),e=e===null?null:e.stateNode,e};Ei.flushSync=function(e){return Ca(e)};Ei.hydrate=function(e,t,n){if(!jm(t))throw Error(et(200));return Fm(null,e,t,!0,n)};Ei.hydrateRoot=function(e,t,n){if(!X_(e))throw Error(et(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=DP;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=MP(t,null,e,1,n??null,r,!1,s,o),e[xs]=t.current,au(e),i)for(e=0;e<i.length;e++)n=i[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new qm(t)};Ei.render=function(e,t,n){if(!jm(t))throw Error(et(200));return Fm(null,e,t,!1,n)};Ei.unmountComponentAtNode=function(e){if(!jm(e))throw Error(et(40));return e._reactRootContainer?(Ca(function(){Fm(null,null,e,!1,function(){e._reactRootContainer=null,e[xs]=null})}),!0):!1};Ei.unstable_batchedUpdates=$_;Ei.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!jm(n))throw Error(et(200));if(e==null||e._reactInternals===void 0)throw Error(et(38));return Fm(e,t,n,!1,i)};Ei.version="18.3.1-next-f1338f8080-20240426";function LP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(LP)}catch(e){console.error(e)}}LP(),LA.exports=Ei;var VP=LA.exports;const PF=TA(VP);var qP,Ck=VP;qP=Ck.createRoot,Ck.hydrateRoot;/**
 * react-router v7.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var kk="popstate";function MF(e={}){function t(i,r){let{pathname:s,search:o,hash:a}=i.location;return Ex("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:pu(r)}return LF(t,n,null,e)}function Ae(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ki(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function DF(){return Math.random().toString(36).substring(2,10)}function Nk(e,t){return{usr:e.state,key:e.key,idx:t}}function Ex(e,t,n=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?vl(t):t,state:n,key:t&&t.key||i||DF()}}function pu({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function vl(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function LF(e,t,n,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a="POP",c=null,h=u();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let w=u(),x=w==null?null:w-h;h=w,c&&c({action:a,location:_.location,delta:x})}function f(w,x){a="PUSH";let C=Ex(_.location,w,x);h=u()+1;let k=Nk(C,h),P=_.createHref(C);try{o.pushState(k,"",P)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(P)}s&&c&&c({action:a,location:_.location,delta:1})}function v(w,x){a="REPLACE";let C=Ex(_.location,w,x);h=u();let k=Nk(C,h),P=_.createHref(C);o.replaceState(k,"",P),s&&c&&c({action:a,location:_.location,delta:0})}function y(w){return VF(w)}let _={get action(){return a},get location(){return e(r,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(kk,d),c=w,()=>{r.removeEventListener(kk,d),c=null}},createHref(w){return t(r,w)},createURL:y,encodeLocation(w){let x=y(w);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:v,go(w){return o.go(w)}};return _}function VF(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ae(n,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:pu(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function jP(e,t,n="/"){return qF(e,t,n,!1)}function qF(e,t,n,i){let r=typeof t=="string"?vl(t):t,s=bs(r.pathname||"/",n);if(s==null)return null;let o=FP(e);jF(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let h=QF(s);a=KF(o[c],h,i)}return a}function FP(e,t=[],n=[],i="",r=!1){let s=(o,a,c=r,h)=>{let u={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(i)&&c)return;Ae(u.relativePath.startsWith(i),`Absolute route path "${u.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(i.length)}let d=us([i,u.relativePath]),f=n.concat(u);o.children&&o.children.length>0&&(Ae(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),FP(o.children,t,f,d,c)),!(o.path==null&&!o.index)&&t.push({path:d,score:$F(d,o.index),routesMeta:f})};return e.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,a);else for(let h of UP(o.path))s(o,a,!0,h)}),t}function UP(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=UP(i.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),r&&a.push(...o),a.map(c=>e.startsWith("/")&&c===""?"/":c)}function jF(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:zF(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var FF=/^:[\w-]+$/,UF=3,OF=2,BF=1,GF=10,HF=-2,Ek=e=>e==="*";function $F(e,t){let n=e.split("/"),i=n.length;return n.some(Ek)&&(i+=HF),t&&(i+=OF),n.filter(r=>!Ek(r)).reduce((r,s)=>r+(FF.test(s)?UF:s===""?BF:GF),i)}function zF(e,t){return e.length===t.length&&e.slice(0,-1).every((i,r)=>i===t[r])?e[e.length-1]-t[t.length-1]:0}function KF(e,t,n=!1){let{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let c=i[a],h=a===i.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=_f({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},u),f=c.route;if(!d&&h&&n&&!i[i.length-1].route.index&&(d=_f({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:us([s,d.pathname]),pathnameBase:ZF(us([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=us([s,d.pathnameBase]))}return o}function _f(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=WF(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((h,{paramName:u,isOptional:d},f)=>{if(u==="*"){let y=a[f]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const v=a[f];return d&&!v?h[u]=void 0:h[u]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:e}}function WF(e,t=!1,n=!0){Ki(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(i.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function QF(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ki(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function bs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}var OP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,YF=e=>OP.test(e);function JF(e,t="/"){let{pathname:n,search:i="",hash:r=""}=typeof e=="string"?vl(e):e,s;if(n)if(YF(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Ki(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=Sk(n.substring(1),"/"):s=Sk(n,t)}else s=t;return{pathname:s,search:tU(i),hash:eU(r)}}function Sk(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Pv(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XF(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function BP(e){let t=XF(e);return t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase)}function GP(e,t,n,i=!1){let r;typeof e=="string"?r=vl(e):(r={...e},Ae(!r.pathname||!r.pathname.includes("?"),Pv("?","pathname","search",r)),Ae(!r.pathname||!r.pathname.includes("#"),Pv("#","pathname","hash",r)),Ae(!r.search||!r.search.includes("#"),Pv("#","search","hash",r)));let s=e===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=n;else{let d=t.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;r.pathname=f.join("/")}a=d>=0?t[d]:"/"}let c=JF(r,a),h=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(h||u)&&(c.pathname+="/"),c}var us=e=>e.join("/").replace(/\/\/+/g,"/"),ZF=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),tU=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eU=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,nU=class{constructor(e,t,n,i=!1){this.status=e,this.statusText=t||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function iU(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function rU(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var HP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $P(e,t){let n=e;if(typeof n!="string"||!OP.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,r=!1;if(HP)try{let s=new URL(window.location.href),o=n.startsWith("//")?new URL(s.protocol+n):new URL(n),a=bs(o.pathname,t);o.origin===s.origin&&a!=null?n=a+o.search+o.hash:r=!0}catch{Ki(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var zP=["POST","PUT","PATCH","DELETE"];new Set(zP);var sU=["GET",...zP];new Set(sU);var yl=I.createContext(null);yl.displayName="DataRouter";var Um=I.createContext(null);Um.displayName="DataRouterState";var oU=I.createContext(!1),KP=I.createContext({isTransitioning:!1});KP.displayName="ViewTransition";var aU=I.createContext(new Map);aU.displayName="Fetchers";var cU=I.createContext(null);cU.displayName="Await";var Yi=I.createContext(null);Yi.displayName="Navigation";var Ku=I.createContext(null);Ku.displayName="Location";var Xr=I.createContext({outlet:null,matches:[],isDataRoute:!1});Xr.displayName="Route";var Z_=I.createContext(null);Z_.displayName="RouteError";var WP="REACT_ROUTER_ERROR",lU="REDIRECT",hU="ROUTE_ERROR_RESPONSE";function uU(e){if(e.startsWith(`${WP}:${lU}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function dU(e){if(e.startsWith(`${WP}:${hU}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new nU(t.status,t.statusText,t.data)}catch{}}function gU(e,{relative:t}={}){Ae(Wu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=I.useContext(Yi),{hash:r,pathname:s,search:o}=Qu(e,{relative:t}),a=s;return n!=="/"&&(a=s==="/"?n:us([n,s])),i.createHref({pathname:a,search:o,hash:r})}function Wu(){return I.useContext(Ku)!=null}function Ds(){return Ae(Wu(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Ku).location}var QP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function YP(e){I.useContext(Yi).static||I.useLayoutEffect(e)}function we(){let{isDataRoute:e}=I.useContext(Xr);return e?NU():fU()}function fU(){Ae(Wu(),"useNavigate() may be used only in the context of a <Router> component.");let e=I.useContext(yl),{basename:t,navigator:n}=I.useContext(Yi),{matches:i}=I.useContext(Xr),{pathname:r}=Ds(),s=JSON.stringify(BP(i)),o=I.useRef(!1);return YP(()=>{o.current=!0}),I.useCallback((c,h={})=>{if(Ki(o.current,QP),!o.current)return;if(typeof c=="number"){n.go(c);return}let u=GP(c,JSON.parse(s),r,h.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:us([t,u.pathname])),(h.replace?n.replace:n.push)(u,h.state,h)},[t,n,s,r,e])}I.createContext(null);function JP(){let{matches:e}=I.useContext(Xr),t=e[e.length-1];return t?t.params:{}}function Qu(e,{relative:t}={}){let{matches:n}=I.useContext(Xr),{pathname:i}=Ds(),r=JSON.stringify(BP(n));return I.useMemo(()=>GP(e,JSON.parse(r),i,t==="path"),[e,r,i,t])}function mU(e,t){return XP(e,t)}function XP(e,t,n,i,r){var C;Ae(Wu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=I.useContext(Yi),{matches:o}=I.useContext(Xr),a=o[o.length-1],c=a?a.params:{},h=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let k=d&&d.path||"";tM(h,!d||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let f=Ds(),v;if(t){let k=typeof t=="string"?vl(t):t;Ae(u==="/"||((C=k.pathname)==null?void 0:C.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${k.pathname}" was given in the \`location\` prop.`),v=k}else v=f;let y=v.pathname||"/",_=y;if(u!=="/"){let k=u.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(k.length).join("/")}let w=jP(e,{pathname:_});Ki(d||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ki(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=_U(w&&w.map(k=>Object.assign({},k,{params:Object.assign({},c,k.params),pathname:us([u,s.encodeLocation?s.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?u:us([u,s.encodeLocation?s.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),o,n,i,r);return t&&x?I.createElement(Ku.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function pU(){let e=kU(),t=iU(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:s},"ErrorBoundary")," or"," ",I.createElement("code",{style:s},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),n?I.createElement("pre",{style:r},n):null,o)}var vU=I.createElement(pU,null),ZP=class extends I.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=dU(e.digest);n&&(e=n)}let t=e!==void 0?I.createElement(Xr.Provider,{value:this.props.routeContext},I.createElement(Z_.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?I.createElement(yU,{error:e},t):t}};ZP.contextType=oU;var Mv=new WeakMap;function yU({children:e,error:t}){let{basename:n}=I.useContext(Yi);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=uU(t.digest);if(i){let r=Mv.get(t);if(r)throw r;let s=$P(i.location,n);if(HP&&!Mv.get(t))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw Mv.set(t,o),o}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return e}function xU({routeContext:e,match:t,children:n}){let i=I.useContext(yl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(Xr.Provider,{value:e},n)}function _U(e,t=[],n=null,i=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let s=e,o=n==null?void 0:n.errors;if(o!=null){let u=s.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Ae(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let a=!1,c=-1;if(n)for(let u=0;u<s.length;u++){let d=s[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:v}=n,y=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!v||v[d.route.id]===void 0);if(d.route.lazy||y){a=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}let h=n&&i?(u,d)=>{var f,v;i(u,{location:n.location,params:((v=(f=n.matches)==null?void 0:f[0])==null?void 0:v.params)??{},unstable_pattern:rU(n.matches),errorInfo:d})}:void 0;return s.reduceRight((u,d,f)=>{let v,y=!1,_=null,w=null;n&&(v=o&&d.route.id?o[d.route.id]:void 0,_=d.route.errorElement||vU,a&&(c<0&&f===0?(tM("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):c===f&&(y=!0,w=d.route.hydrateFallbackElement||null)));let x=t.concat(s.slice(0,f+1)),C=()=>{let k;return v?k=_:y?k=w:d.route.Component?k=I.createElement(d.route.Component,null):d.route.element?k=d.route.element:k=u,I.createElement(xU,{match:d,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:k})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?I.createElement(ZP,{location:n.location,revalidation:n.revalidation,component:_,error:v,children:C(),routeContext:{outlet:null,matches:x,isDataRoute:!0},onError:h}):C()},null)}function tw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wU(e){let t=I.useContext(yl);return Ae(t,tw(e)),t}function bU(e){let t=I.useContext(Um);return Ae(t,tw(e)),t}function TU(e){let t=I.useContext(Xr);return Ae(t,tw(e)),t}function ew(e){let t=TU(e),n=t.matches[t.matches.length-1];return Ae(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function CU(){return ew("useRouteId")}function kU(){var i;let e=I.useContext(Z_),t=bU("useRouteError"),n=ew("useRouteError");return e!==void 0?e:(i=t.errors)==null?void 0:i[n]}function NU(){let{router:e}=wU("useNavigate"),t=ew("useNavigate"),n=I.useRef(!1);return YP(()=>{n.current=!0}),I.useCallback(async(r,s={})=>{Ki(n.current,QP),n.current&&(typeof r=="number"?await e.navigate(r):await e.navigate(r,{fromRouteId:t,...s}))},[e,t])}var Ik={};function tM(e,t,n){!t&&!Ik[e]&&(Ik[e]=!0,Ki(!1,n))}I.memo(EU);function EU({routes:e,future:t,state:n,onError:i}){return XP(e,void 0,n,i,t)}function Me(e){Ae(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function SU({basename:e="/",children:t=null,location:n,navigationType:i="POP",navigator:r,static:s=!1,unstable_useTransitions:o}){Ae(!Wu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),c=I.useMemo(()=>({basename:a,navigator:r,static:s,unstable_useTransitions:o,future:{}}),[a,r,s,o]);typeof n=="string"&&(n=vl(n));let{pathname:h="/",search:u="",hash:d="",state:f=null,key:v="default"}=n,y=I.useMemo(()=>{let _=bs(h,a);return _==null?null:{location:{pathname:_,search:u,hash:d,state:f,key:v},navigationType:i}},[a,h,u,d,f,v,i]);return Ki(y!=null,`<Router basename="${a}"> is not able to match the URL "${h}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:I.createElement(Yi.Provider,{value:c},I.createElement(Ku.Provider,{children:t,value:y}))}function IU({children:e,location:t}){return mU(Sx(e),t)}function Sx(e,t=[]){let n=[];return I.Children.forEach(e,(i,r)=>{if(!I.isValidElement(i))return;let s=[...t,r];if(i.type===I.Fragment){n.push.apply(n,Sx(i.props.children,s));return}Ae(i.type===Me,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ae(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=Sx(i.props.children,s)),n.push(o)}),n}var Rg="get",Pg="application/x-www-form-urlencoded";function Om(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function AU(e){return Om(e)&&e.tagName.toLowerCase()==="button"}function RU(e){return Om(e)&&e.tagName.toLowerCase()==="form"}function PU(e){return Om(e)&&e.tagName.toLowerCase()==="input"}function MU(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function DU(e,t){return e.button===0&&(!t||t==="_self")&&!MU(e)}function Ix(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(r=>[n,r]):[[n,i]])},[]))}function LU(e,t){let n=Ix(e);return t&&t.forEach((i,r)=>{n.has(r)||t.getAll(r).forEach(s=>{n.append(r,s)})}),n}var Qd=null;function VU(){if(Qd===null)try{new FormData(document.createElement("form"),0),Qd=!1}catch{Qd=!0}return Qd}var qU=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dv(e){return e!=null&&!qU.has(e)?(Ki(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Pg}"`),null):e}function jU(e,t){let n,i,r,s,o;if(RU(e)){let a=e.getAttribute("action");i=a?bs(a,t):null,n=e.getAttribute("method")||Rg,r=Dv(e.getAttribute("enctype"))||Pg,s=new FormData(e)}else if(AU(e)||PU(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||a.getAttribute("action");if(i=c?bs(c,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Rg,r=Dv(e.getAttribute("formenctype"))||Dv(a.getAttribute("enctype"))||Pg,s=new FormData(a,e),!VU()){let{name:h,type:u,value:d}=e;if(u==="image"){let f=h?`${h}.`:"";s.append(`${f}x`,"0"),s.append(`${f}y`,"0")}else h&&s.append(h,d)}}else{if(Om(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Rg,i=null,r=Pg,o=e}return s&&r==="text/plain"&&(o=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function nw(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function FU(e,t,n,i){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${i}`:r.pathname=`${r.pathname}.${i}`:r.pathname==="/"?r.pathname=`_root.${i}`:t&&bs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${i}`,r}async function UU(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function OU(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function BU(e,t,n){let i=await Promise.all(e.map(async r=>{let s=t.routes[r.route.id];if(s){let o=await UU(s,n);return o.links?o.links():[]}return[]}));return zU(i.flat(1).filter(OU).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function Ak(e,t,n,i,r,s){let o=(c,h)=>n[h]?c.route.id!==n[h].route.id:!0,a=(c,h)=>{var u;return n[h].pathname!==c.pathname||((u=n[h].route.path)==null?void 0:u.endsWith("*"))&&n[h].params["*"]!==c.params["*"]};return s==="assets"?t.filter((c,h)=>o(c,h)||a(c,h)):s==="data"?t.filter((c,h)=>{var d;let u=i.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,h)||a(c,h))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function GU(e,t,{includeHydrateFallback:n}={}){return HU(e.map(i=>{let r=t.routes[i.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function HU(e){return[...new Set(e)]}function $U(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}function zU(e,t){let n=new Set;return new Set(t),e.reduce((i,r)=>{let s=JSON.stringify($U(r));return n.has(s)||(n.add(s),i.push({key:s,link:r})),i},[])}function eM(){let e=I.useContext(yl);return nw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function KU(){let e=I.useContext(Um);return nw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var iw=I.createContext(void 0);iw.displayName="FrameworkContext";function nM(){let e=I.useContext(iw);return nw(e,"You must render this element inside a <HydratedRouter> element"),e}function WU(e,t){let n=I.useContext(iw),[i,r]=I.useState(!1),[s,o]=I.useState(!1),{onFocus:a,onBlur:c,onMouseEnter:h,onMouseLeave:u,onTouchStart:d}=t,f=I.useRef(null);I.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let _=x=>{x.forEach(C=>{o(C.isIntersecting)})},w=new IntersectionObserver(_,{threshold:.5});return f.current&&w.observe(f.current),()=>{w.disconnect()}}},[e]),I.useEffect(()=>{if(i){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[i]);let v=()=>{r(!0)},y=()=>{r(!1),o(!1)};return n?e!=="intent"?[s,f,{}]:[s,f,{onFocus:sh(a,v),onBlur:sh(c,y),onMouseEnter:sh(h,v),onMouseLeave:sh(u,y),onTouchStart:sh(d,v)}]:[!1,f,{}]}function sh(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function QU({page:e,...t}){let{router:n}=eM(),i=I.useMemo(()=>jP(n.routes,e,n.basename),[n.routes,e,n.basename]);return i?I.createElement(JU,{page:e,matches:i,...t}):null}function YU(e){let{manifest:t,routeModules:n}=nM(),[i,r]=I.useState([]);return I.useEffect(()=>{let s=!1;return BU(e,t,n).then(o=>{s||r(o)}),()=>{s=!0}},[e,t,n]),i}function JU({page:e,matches:t,...n}){let i=Ds(),{future:r,manifest:s,routeModules:o}=nM(),{basename:a}=eM(),{loaderData:c,matches:h}=KU(),u=I.useMemo(()=>Ak(e,t,h,s,i,"data"),[e,t,h,s,i]),d=I.useMemo(()=>Ak(e,t,h,s,i,"assets"),[e,t,h,s,i]),f=I.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let _=new Set,w=!1;if(t.forEach(C=>{var P;let k=s.routes[C.route.id];!k||!k.hasLoader||(!u.some(A=>A.route.id===C.route.id)&&C.route.id in c&&((P=o[C.route.id])!=null&&P.shouldRevalidate)||k.hasClientLoader?w=!0:_.add(C.route.id))}),_.size===0)return[];let x=FU(e,a,r.unstable_trailingSlashAwareDataRequests,"data");return w&&_.size>0&&x.searchParams.set("_routes",t.filter(C=>_.has(C.route.id)).map(C=>C.route.id).join(",")),[x.pathname+x.search]},[a,r.unstable_trailingSlashAwareDataRequests,c,i,s,u,t,e,o]),v=I.useMemo(()=>GU(d,s),[d,s]),y=YU(d);return I.createElement(I.Fragment,null,f.map(_=>I.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),v.map(_=>I.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),y.map(({key:_,link:w})=>I.createElement("link",{key:_,nonce:n.nonce,...w})))}function XU(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var ZU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ZU&&(window.__reactRouterVersion="7.12.0")}catch{}function tO({basename:e,children:t,unstable_useTransitions:n,window:i}){let r=I.useRef();r.current==null&&(r.current=MF({window:i,v5Compat:!0}));let s=r.current,[o,a]=I.useState({action:s.action,location:s.location}),c=I.useCallback(h=>{n===!1?a(h):I.startTransition(()=>a(h))},[n]);return I.useLayoutEffect(()=>s.listen(c),[s,c]),I.createElement(SU,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:n})}var iM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rM=I.forwardRef(function({onClick:t,discover:n="render",prefetch:i="none",relative:r,reloadDocument:s,replace:o,state:a,target:c,to:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f,...v},y){let{basename:_,unstable_useTransitions:w}=I.useContext(Yi),x=typeof h=="string"&&iM.test(h),C=$P(h,_);h=C.to;let k=gU(h,{relative:r}),[P,A,M]=WU(i,v),N=rO(h,{replace:o,state:a,target:c,preventScrollReset:u,relative:r,viewTransition:d,unstable_defaultShouldRevalidate:f,unstable_useTransitions:w});function T(R){t&&t(R),R.defaultPrevented||N(R)}let E=I.createElement("a",{...v,...M,href:C.absoluteURL||k,onClick:C.isExternal||s?t:T,ref:XU(y,A),target:c,"data-discover":!x&&n==="render"?"true":void 0});return P&&!x?I.createElement(I.Fragment,null,E,I.createElement(QU,{page:k})):E});rM.displayName="Link";var eO=I.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:i="",end:r=!1,style:s,to:o,viewTransition:a,children:c,...h},u){let d=Qu(o,{relative:h.relative}),f=Ds(),v=I.useContext(Um),{navigator:y,basename:_}=I.useContext(Yi),w=v!=null&&lO(d)&&a===!0,x=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,C=f.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(C=C.toLowerCase(),k=k?k.toLowerCase():null,x=x.toLowerCase()),k&&_&&(k=bs(k,_)||k);const P=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let A=C===x||!r&&C.startsWith(x)&&C.charAt(P)==="/",M=k!=null&&(k===x||!r&&k.startsWith(x)&&k.charAt(x.length)==="/"),N={isActive:A,isPending:M,isTransitioning:w},T=A?t:void 0,E;typeof i=="function"?E=i(N):E=[i,A?"active":null,M?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let R=typeof s=="function"?s(N):s;return I.createElement(rM,{...h,"aria-current":T,className:E,ref:u,style:R,to:o,viewTransition:a},typeof c=="function"?c(N):c)});eO.displayName="NavLink";var nO=I.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:i,replace:r,state:s,method:o=Rg,action:a,onSubmit:c,relative:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f,...v},y)=>{let{unstable_useTransitions:_}=I.useContext(Yi),w=aO(),x=cO(a,{relative:h}),C=o.toLowerCase()==="get"?"get":"post",k=typeof a=="string"&&iM.test(a),P=A=>{if(c&&c(A),A.defaultPrevented)return;A.preventDefault();let M=A.nativeEvent.submitter,N=(M==null?void 0:M.getAttribute("formmethod"))||o,T=()=>w(M||A.currentTarget,{fetcherKey:t,method:N,navigate:n,replace:r,state:s,relative:h,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:f});_&&n!==!1?I.startTransition(()=>T()):T()};return I.createElement("form",{ref:y,method:C,action:x,onSubmit:i?c:P,...v,"data-discover":!k&&e==="render"?"true":void 0})});nO.displayName="Form";function iO(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sM(e){let t=I.useContext(yl);return Ae(t,iO(e)),t}function rO(e,{target:t,replace:n,state:i,preventScrollReset:r,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:c}={}){let h=we(),u=Ds(),d=Qu(e,{relative:s});return I.useCallback(f=>{if(DU(f,t)){f.preventDefault();let v=n!==void 0?n:pu(u)===pu(d),y=()=>h(e,{replace:v,state:i,preventScrollReset:r,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:a});c?I.startTransition(()=>y()):y()}},[u,h,d,n,i,t,e,r,s,o,a,c])}function oM(e){Ki(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=I.useRef(Ix(e)),n=I.useRef(!1),i=Ds(),r=I.useMemo(()=>LU(i.search,n.current?null:t.current),[i.search]),s=we(),o=I.useCallback((a,c)=>{const h=Ix(typeof a=="function"?a(new URLSearchParams(r)):a);n.current=!0,s("?"+h,c)},[s,r]);return[r,o]}var sO=0,oO=()=>`__${String(++sO)}__`;function aO(){let{router:e}=sM("useSubmit"),{basename:t}=I.useContext(Yi),n=CU(),i=e.fetch,r=e.navigate;return I.useCallback(async(s,o={})=>{let{action:a,method:c,encType:h,formData:u,body:d}=jU(s,t);if(o.navigate===!1){let f=o.fetcherKey||oO();await i(f,n,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||c,formEncType:o.encType||h,flushSync:o.flushSync})}else await r(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||c,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,r,t,n])}function cO(e,{relative:t}={}){let{basename:n}=I.useContext(Yi),i=I.useContext(Xr);Ae(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...Qu(e||".",{relative:t})},o=Ds();if(e==null){s.search=o.search;let a=new URLSearchParams(s.search),c=a.getAll("index");if(c.some(u=>u==="")){a.delete("index"),c.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:us([n,s.pathname])),pu(s)}function lO(e,{relative:t}={}){let n=I.useContext(KP);Ae(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=sM("useViewTransitionState"),r=Qu(e,{relative:t});if(!n.isTransitioning)return!1;let s=bs(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=bs(n.nextLocation.pathname,i)||n.nextLocation.pathname;return _f(r.pathname,o)!=null||_f(r.pathname,s)!=null}function hO(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const uO=e=>{switch(e){case"success":return fO;case"info":return pO;case"warning":return mO;case"error":return vO;default:return null}},dO=Array(12).fill(0),gO=({visible:e,className:t})=>it.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},it.createElement("div",{className:"sonner-spinner"},dO.map((n,i)=>it.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),fO=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),mO=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),pO=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),vO=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},it.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),yO=it.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},it.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),it.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xO=()=>{const[e,t]=it.useState(document.hidden);return it.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let Ax=1;class _O{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:i,...r}=t,s=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:Ax++,o=this.toasts.find(c=>c.id===s),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),o?this.toasts=this.toasts.map(c=>c.id===s?(this.publish({...c,...t,id:s,title:i}),{...c,...t,id:s,dismissible:a,title:i}):c):this.addToast({title:i,...r,dismissible:a,id:s}),s},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(i=>i({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let i;n.loading!==void 0&&(i=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const r=Promise.resolve(t instanceof Function?t():t);let s=i!==void 0,o;const a=r.then(async h=>{if(o=["resolve",h],it.isValidElement(h))s=!1,this.create({id:i,type:"default",message:h});else if(bO(h)&&!h.ok){s=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${h.status}`):n.error,f=typeof n.description=="function"?await n.description(`HTTP error! status: ${h.status}`):n.description,y=typeof d=="object"&&!it.isValidElement(d)?d:{message:d};this.create({id:i,type:"error",description:f,...y})}else if(h instanceof Error){s=!1;const d=typeof n.error=="function"?await n.error(h):n.error,f=typeof n.description=="function"?await n.description(h):n.description,y=typeof d=="object"&&!it.isValidElement(d)?d:{message:d};this.create({id:i,type:"error",description:f,...y})}else if(n.success!==void 0){s=!1;const d=typeof n.success=="function"?await n.success(h):n.success,f=typeof n.description=="function"?await n.description(h):n.description,y=typeof d=="object"&&!it.isValidElement(d)?d:{message:d};this.create({id:i,type:"success",description:f,...y})}}).catch(async h=>{if(o=["reject",h],n.error!==void 0){s=!1;const u=typeof n.error=="function"?await n.error(h):n.error,d=typeof n.description=="function"?await n.description(h):n.description,v=typeof u=="object"&&!it.isValidElement(u)?u:{message:u};this.create({id:i,type:"error",description:d,...v})}}).finally(()=>{s&&(this.dismiss(i),i=void 0),n.finally==null||n.finally.call(n)}),c=()=>new Promise((h,u)=>a.then(()=>o[0]==="reject"?u(o[1]):h(o[1])).catch(u));return typeof i!="string"&&typeof i!="number"?{unwrap:c}:Object.assign(i,{unwrap:c})},this.custom=(t,n)=>{const i=(n==null?void 0:n.id)||Ax++;return this.create({jsx:t(i),id:i,...n}),i},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ri=new _O,wO=(e,t)=>{const n=(t==null?void 0:t.id)||Ax++;return ri.addToast({title:e,...t,id:n}),n},bO=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",TO=wO,CO=()=>ri.toasts,kO=()=>ri.getActiveToasts();Object.assign(TO,{success:ri.success,info:ri.info,warning:ri.warning,error:ri.error,custom:ri.custom,message:ri.message,promise:ri.promise,dismiss:ri.dismiss,loading:ri.loading},{getHistory:CO,getToasts:kO});hO("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Yd(e){return e.label!==void 0}const NO=3,EO="24px",SO="16px",Rk=4e3,IO=356,AO=14,RO=45,PO=200;function Pr(...e){return e.filter(Boolean).join(" ")}function MO(e){const[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}const DO=e=>{var t,n,i,r,s,o,a,c,h;const{invert:u,toast:d,unstyled:f,interacting:v,setHeights:y,visibleToasts:_,heights:w,index:x,toasts:C,expanded:k,removeToast:P,defaultRichColors:A,closeButton:M,style:N,cancelButtonStyle:T,actionButtonStyle:E,className:R="",descriptionClassName:D="",duration:j,position:L,gap:lt,expandByDefault:dt,classNames:Y,icons:W,closeButtonAriaLabel:U="Close toast"}=e,[Q,F]=it.useState(null),[q,$]=it.useState(null),[H,X]=it.useState(!1),[tt,O]=it.useState(!1),[B,nt]=it.useState(!1),[K,at]=it.useState(!1),[ct,vt]=it.useState(!1),[Rt,ht]=it.useState(0),[st,Tt]=it.useState(0),Nt=it.useRef(d.duration||j||Rk),Jt=it.useRef(null),Et=it.useRef(null),Gt=x===0,yn=x+1<=_,oe=d.type,ft=d.dismissible!==!1,St=d.className||"",ae=d.descriptionClassName||"",xn=it.useMemo(()=>w.findIndex(Pt=>Pt.toastId===d.id)||0,[w,d.id]),Jn=it.useMemo(()=>{var Pt;return(Pt=d.closeButton)!=null?Pt:M},[d.closeButton,M]),Ii=it.useMemo(()=>d.duration||j||Rk,[d.duration,j]),Xn=it.useRef(0),Zn=it.useRef(0),Ai=it.useRef(0),ti=it.useRef(null),[Ri,Fl]=L.split("-"),Qa=it.useMemo(()=>w.reduce((Pt,be,on)=>on>=xn?Pt:Pt+be.height,0),[w,xn]),Sr=xO(),wd=d.invert||u,Us=oe==="loading";Zn.current=it.useMemo(()=>xn*lt+Qa,[xn,Qa]),it.useEffect(()=>{Nt.current=Ii},[Ii]),it.useEffect(()=>{X(!0)},[]),it.useEffect(()=>{const Pt=Et.current;if(Pt){const be=Pt.getBoundingClientRect().height;return Tt(be),y(on=>[{toastId:d.id,height:be,position:d.position},...on]),()=>y(on=>on.filter(Un=>Un.toastId!==d.id))}},[y,d.id]),it.useLayoutEffect(()=>{if(!H)return;const Pt=Et.current,be=Pt.style.height;Pt.style.height="auto";const on=Pt.getBoundingClientRect().height;Pt.style.height=be,Tt(on),y(Un=>Un.find(Ye=>Ye.toastId===d.id)?Un.map(Ye=>Ye.toastId===d.id?{...Ye,height:on}:Ye):[{toastId:d.id,height:on,position:d.position},...Un])},[H,d.title,d.description,y,d.id,d.jsx,d.action,d.cancel]);const Zi=it.useCallback(()=>{O(!0),ht(Zn.current),y(Pt=>Pt.filter(be=>be.toastId!==d.id)),setTimeout(()=>{P(d)},PO)},[d,P,y,Zn]);it.useEffect(()=>{if(d.promise&&oe==="loading"||d.duration===1/0||d.type==="loading")return;let Pt;return k||v||Sr?(()=>{if(Ai.current<Xn.current){const Un=new Date().getTime()-Xn.current;Nt.current=Nt.current-Un}Ai.current=new Date().getTime()})():(()=>{Nt.current!==1/0&&(Xn.current=new Date().getTime(),Pt=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),Zi()},Nt.current))})(),()=>clearTimeout(Pt)},[k,v,d,oe,Sr,Zi]),it.useEffect(()=>{d.delete&&(Zi(),d.onDismiss==null||d.onDismiss.call(d,d))},[Zi,d.delete]);function Ko(){var Pt;if(W!=null&&W.loading){var be;return it.createElement("div",{className:Pr(Y==null?void 0:Y.loader,d==null||(be=d.classNames)==null?void 0:be.loader,"sonner-loader"),"data-visible":oe==="loading"},W.loading)}return it.createElement(gO,{className:Pr(Y==null?void 0:Y.loader,d==null||(Pt=d.classNames)==null?void 0:Pt.loader),visible:oe==="loading"})}const bd=d.icon||(W==null?void 0:W[oe])||uO(oe);var sn,Ul;return it.createElement("li",{tabIndex:0,ref:Et,className:Pr(R,St,Y==null?void 0:Y.toast,d==null||(t=d.classNames)==null?void 0:t.toast,Y==null?void 0:Y.default,Y==null?void 0:Y[oe],d==null||(n=d.classNames)==null?void 0:n[oe]),"data-sonner-toast":"","data-rich-colors":(sn=d.richColors)!=null?sn:A,"data-styled":!(d.jsx||d.unstyled||f),"data-mounted":H,"data-promise":!!d.promise,"data-swiped":ct,"data-removed":tt,"data-visible":yn,"data-y-position":Ri,"data-x-position":Fl,"data-index":x,"data-front":Gt,"data-swiping":B,"data-dismissible":ft,"data-type":oe,"data-invert":wd,"data-swipe-out":K,"data-swipe-direction":q,"data-expanded":!!(k||dt&&H),"data-testid":d.testId,style:{"--index":x,"--toasts-before":x,"--z-index":C.length-x,"--offset":`${tt?Rt:Zn.current}px`,"--initial-height":dt?"auto":`${st}px`,...N,...d.style},onDragEnd:()=>{nt(!1),F(null),ti.current=null},onPointerDown:Pt=>{Pt.button!==2&&(Us||!ft||(Jt.current=new Date,ht(Zn.current),Pt.target.setPointerCapture(Pt.pointerId),Pt.target.tagName!=="BUTTON"&&(nt(!0),ti.current={x:Pt.clientX,y:Pt.clientY})))},onPointerUp:()=>{var Pt,be,on;if(K||!ft)return;ti.current=null;const Un=Number(((Pt=Et.current)==null?void 0:Pt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),tr=Number(((be=Et.current)==null?void 0:be.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ye=new Date().getTime()-((on=Jt.current)==null?void 0:on.getTime()),ei=Q==="x"?Un:tr,ts=Math.abs(ei)/Ye;if(Math.abs(ei)>=RO||ts>.11){ht(Zn.current),d.onDismiss==null||d.onDismiss.call(d,d),$(Q==="x"?Un>0?"right":"left":tr>0?"down":"up"),Zi(),at(!0);return}else{var ni,ii;(ni=Et.current)==null||ni.style.setProperty("--swipe-amount-x","0px"),(ii=Et.current)==null||ii.style.setProperty("--swipe-amount-y","0px")}vt(!1),nt(!1),F(null)},onPointerMove:Pt=>{var be,on,Un;if(!ti.current||!ft||((be=window.getSelection())==null?void 0:be.toString().length)>0)return;const Ye=Pt.clientY-ti.current.y,ei=Pt.clientX-ti.current.x;var ts;const ni=(ts=e.swipeDirections)!=null?ts:MO(L);!Q&&(Math.abs(ei)>1||Math.abs(Ye)>1)&&F(Math.abs(ei)>Math.abs(Ye)?"x":"y");let ii={x:0,y:0};const Ya=vi=>1/(1.5+Math.abs(vi)/20);if(Q==="y"){if(ni.includes("top")||ni.includes("bottom"))if(ni.includes("top")&&Ye<0||ni.includes("bottom")&&Ye>0)ii.y=Ye;else{const vi=Ye*Ya(Ye);ii.y=Math.abs(vi)<Math.abs(Ye)?vi:Ye}}else if(Q==="x"&&(ni.includes("left")||ni.includes("right")))if(ni.includes("left")&&ei<0||ni.includes("right")&&ei>0)ii.x=ei;else{const vi=ei*Ya(ei);ii.x=Math.abs(vi)<Math.abs(ei)?vi:ei}(Math.abs(ii.x)>0||Math.abs(ii.y)>0)&&vt(!0),(on=Et.current)==null||on.style.setProperty("--swipe-amount-x",`${ii.x}px`),(Un=Et.current)==null||Un.style.setProperty("--swipe-amount-y",`${ii.y}px`)}},Jn&&!d.jsx&&oe!=="loading"?it.createElement("button",{"aria-label":U,"data-disabled":Us,"data-close-button":!0,onClick:Us||!ft?()=>{}:()=>{Zi(),d.onDismiss==null||d.onDismiss.call(d,d)},className:Pr(Y==null?void 0:Y.closeButton,d==null||(i=d.classNames)==null?void 0:i.closeButton)},(Ul=W==null?void 0:W.close)!=null?Ul:yO):null,(oe||d.icon||d.promise)&&d.icon!==null&&((W==null?void 0:W[oe])!==null||d.icon)?it.createElement("div",{"data-icon":"",className:Pr(Y==null?void 0:Y.icon,d==null||(r=d.classNames)==null?void 0:r.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||Ko():null,d.type!=="loading"?bd:null):null,it.createElement("div",{"data-content":"",className:Pr(Y==null?void 0:Y.content,d==null||(s=d.classNames)==null?void 0:s.content)},it.createElement("div",{"data-title":"",className:Pr(Y==null?void 0:Y.title,d==null||(o=d.classNames)==null?void 0:o.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?it.createElement("div",{"data-description":"",className:Pr(D,ae,Y==null?void 0:Y.description,d==null||(a=d.classNames)==null?void 0:a.description)},typeof d.description=="function"?d.description():d.description):null),it.isValidElement(d.cancel)?d.cancel:d.cancel&&Yd(d.cancel)?it.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||T,onClick:Pt=>{Yd(d.cancel)&&ft&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,Pt),Zi())},className:Pr(Y==null?void 0:Y.cancelButton,d==null||(c=d.classNames)==null?void 0:c.cancelButton)},d.cancel.label):null,it.isValidElement(d.action)?d.action:d.action&&Yd(d.action)?it.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||E,onClick:Pt=>{Yd(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,Pt),!Pt.defaultPrevented&&Zi())},className:Pr(Y==null?void 0:Y.actionButton,d==null||(h=d.classNames)==null?void 0:h.actionButton)},d.action.label):null)};function Pk(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function LO(e,t){const n={};return[e,t].forEach((i,r)=>{const s=r===1,o=s?"--mobile-offset":"--offset",a=s?SO:EO;function c(h){["top","right","bottom","left"].forEach(u=>{n[`${o}-${u}`]=typeof h=="number"?`${h}px`:h})}typeof i=="number"||typeof i=="string"?c(i):typeof i=="object"?["top","right","bottom","left"].forEach(h=>{i[h]===void 0?n[`${o}-${h}`]=a:n[`${o}-${h}`]=typeof i[h]=="number"?`${i[h]}px`:i[h]}):c(a)}),n}const VO=it.forwardRef(function(t,n){const{id:i,invert:r,position:s="bottom-right",hotkey:o=["altKey","KeyT"],expand:a,closeButton:c,className:h,offset:u,mobileOffset:d,theme:f="light",richColors:v,duration:y,style:_,visibleToasts:w=NO,toastOptions:x,dir:C=Pk(),gap:k=AO,icons:P,containerAriaLabel:A="Notifications"}=t,[M,N]=it.useState([]),T=it.useMemo(()=>i?M.filter(H=>H.toasterId===i):M.filter(H=>!H.toasterId),[M,i]),E=it.useMemo(()=>Array.from(new Set([s].concat(T.filter(H=>H.position).map(H=>H.position)))),[T,s]),[R,D]=it.useState([]),[j,L]=it.useState(!1),[lt,dt]=it.useState(!1),[Y,W]=it.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=it.useRef(null),Q=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),F=it.useRef(null),q=it.useRef(!1),$=it.useCallback(H=>{N(X=>{var tt;return(tt=X.find(O=>O.id===H.id))!=null&&tt.delete||ri.dismiss(H.id),X.filter(({id:O})=>O!==H.id)})},[]);return it.useEffect(()=>ri.subscribe(H=>{if(H.dismiss){requestAnimationFrame(()=>{N(X=>X.map(tt=>tt.id===H.id?{...tt,delete:!0}:tt))});return}setTimeout(()=>{PF.flushSync(()=>{N(X=>{const tt=X.findIndex(O=>O.id===H.id);return tt!==-1?[...X.slice(0,tt),{...X[tt],...H},...X.slice(tt+1)]:[H,...X]})})})}),[M]),it.useEffect(()=>{if(f!=="system"){W(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?W("dark"):W("light")),typeof window>"u")return;const H=window.matchMedia("(prefers-color-scheme: dark)");try{H.addEventListener("change",({matches:X})=>{W(X?"dark":"light")})}catch{H.addListener(({matches:tt})=>{try{W(tt?"dark":"light")}catch(O){console.error(O)}})}},[f]),it.useEffect(()=>{M.length<=1&&L(!1)},[M]),it.useEffect(()=>{const H=X=>{var tt;if(o.every(nt=>X[nt]||X.code===nt)){var B;L(!0),(B=U.current)==null||B.focus()}X.code==="Escape"&&(document.activeElement===U.current||(tt=U.current)!=null&&tt.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",H),()=>document.removeEventListener("keydown",H)},[o]),it.useEffect(()=>{if(U.current)return()=>{F.current&&(F.current.focus({preventScroll:!0}),F.current=null,q.current=!1)}},[U.current]),it.createElement("section",{ref:n,"aria-label":`${A} ${Q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},E.map((H,X)=>{var tt;const[O,B]=H.split("-");return T.length?it.createElement("ol",{key:H,dir:C==="auto"?Pk():C,tabIndex:-1,ref:U,className:h,"data-sonner-toaster":!0,"data-sonner-theme":Y,"data-y-position":O,"data-x-position":B,style:{"--front-toast-height":`${((tt=R[0])==null?void 0:tt.height)||0}px`,"--width":`${IO}px`,"--gap":`${k}px`,..._,...LO(u,d)},onBlur:nt=>{q.current&&!nt.currentTarget.contains(nt.relatedTarget)&&(q.current=!1,F.current&&(F.current.focus({preventScroll:!0}),F.current=null))},onFocus:nt=>{nt.target instanceof HTMLElement&&nt.target.dataset.dismissible==="false"||q.current||(q.current=!0,F.current=nt.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{lt||L(!1)},onDragEnd:()=>L(!1),onPointerDown:nt=>{nt.target instanceof HTMLElement&&nt.target.dataset.dismissible==="false"||dt(!0)},onPointerUp:()=>dt(!1)},T.filter(nt=>!nt.position&&X===0||nt.position===H).map((nt,K)=>{var at,ct;return it.createElement(DO,{key:nt.id,icons:P,index:K,toast:nt,defaultRichColors:v,duration:(at=x==null?void 0:x.duration)!=null?at:y,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:r,visibleToasts:w,closeButton:(ct=x==null?void 0:x.closeButton)!=null?ct:c,interacting:lt,position:H,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:$,toasts:T.filter(vt=>vt.position==nt.position),heights:R.filter(vt=>vt.position==nt.position),setHeights:D,expandByDefault:a,gap:k,expanded:j,swipeDirections:t.swipeDirections})})):null}))});/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jO=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),Mk=e=>{const t=jO(e);return t.charAt(0).toUpperCase()+t.slice(1)},aM=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),FO=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=I.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>I.createElement("svg",{ref:c,...UO,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:aM("lucide",r),...!s&&!FO(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,u])=>I.createElement(h,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=(e,t)=>{const n=I.forwardRef(({className:i,...r},s)=>I.createElement(OO,{ref:s,iconNode:t,className:aM(`lucide-${qO(Mk(e))}`,`lucide-${e}`,i),...r}));return n.displayName=Mk(e),n};/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],GO=_t("arrow-down",BO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ji=_t("arrow-left",HO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],zO=_t("arrow-up",$O);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],vr=_t("award",KO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],tl=_t("book-open",WO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]],YO=_t("bookmark-check",QO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Lv=_t("bookmark",JO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],cM=_t("brain",XO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Yu=_t("building",ZO);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],lM=_t("calendar-check",tB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],nB=_t("calendar-days",eB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],vu=_t("calendar",iB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],hM=_t("chart-column",rB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Rn=_t("check",sB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],rw=_t("chevron-left",oB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],sr=_t("chevron-right",aB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],lB=_t("chevrons-left",cB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],uB=_t("chevrons-right",hB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ai=_t("circle-check-big",dB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Cr=_t("circle-check",gB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$r=_t("circle-x",fB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ju=_t("clock",mB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],uM=_t("coins",pB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],wf=_t("crown",vB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]],xB=_t("dumbbell",yB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],wB=_t("file-text",_B);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],zr=_t("flame",bB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["line",{x1:"22",x2:"2",y1:"6",y2:"6",key:"15w7dq"}],["line",{x1:"22",x2:"2",y1:"18",y2:"18",key:"1ip48p"}],["line",{x1:"6",x2:"6",y1:"2",y2:"22",key:"a2lnyx"}],["line",{x1:"18",x2:"18",y1:"2",y2:"22",key:"8vb6jd"}]],bf=_t("frame",TB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],dM=_t("gem",CB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],Be=_t("gift",kB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],gM=_t("graduation-cap",NB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],SB=_t("grip-vertical",EB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],sw=_t("house",IB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Bm=_t("image",AB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],PB=_t("inbox",RB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Rx=_t("info",MB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Dk=_t("list",DB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],qi=_t("loader-circle",LB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Xu=_t("lock",VB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],fM=_t("mail",qB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Dc=_t("medal",jB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],UB=_t("moon",FB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ts=_t("package",OB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Px=_t("pencil",BB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],HB=_t("play",GB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yu=_t("rotate-ccw",$B);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Lk=_t("rotate-cw",zB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],mM=_t("shield",KB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],QB=_t("shuffle",WB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],ow=_t("skull",YB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],Vv=_t("snowflake",JB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Xt=_t("sparkles",XB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vk=_t("square-check-big",ZB);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tG=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],eG=_t("square",tG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nG=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],me=_t("star",nG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iG=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],rG=_t("sun",iG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sG=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]],Ci=_t("swords",sG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ji=_t("target",oG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aG=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pM=_t("trash-2",aG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cG=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],lG=_t("trending-down",cG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hG=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],vM=_t("trending-up",hG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uG=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],dG=_t("triangle-alert",uG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gG=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Ve=_t("trophy",gG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fG=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xl=_t("user",fG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mG=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fr=_t("x",mG);/**
 * @license lucide-react v0.557.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pG=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Vr=_t("zap",pG),vG="modulepreload",yG=function(e){return"/"+e},qk={},Tf=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=yG(c),c in qk)return;qk[c]=!0;const h=c.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":vG,h||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),h)return new Promise((f,v)=>{d.addEventListener("load",f),d.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function yM(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=yM(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function xM(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=yM(e))&&(i&&(i+=" "),i+=t);return i}const xG=(e,t)=>{const n=new Array(e.length+t.length);for(let i=0;i<e.length;i++)n[i]=e[i];for(let i=0;i<t.length;i++)n[e.length+i]=t[i];return n},_G=(e,t)=>({classGroupId:e,validator:t}),_M=(e=new Map,t=null,n)=>({nextPart:e,validators:t,classGroupId:n}),Cf="-",jk=[],wG="arbitrary..",bG=e=>{const t=CG(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return TG(o);const a=o.split(Cf),c=a[0]===""&&a.length>1?1:0;return wM(a,c,t)},getConflictingClassGroupIds:(o,a)=>{if(a){const c=i[o],h=n[o];return c?h?xG(h,c):c:h||jk}return n[o]||jk}}},wM=(e,t,n)=>{if(e.length-t===0)return n.classGroupId;const r=e[t],s=n.nextPart.get(r);if(s){const h=wM(e,t+1,s);if(h)return h}const o=n.validators;if(o===null)return;const a=t===0?e.join(Cf):e.slice(t).join(Cf),c=o.length;for(let h=0;h<c;h++){const u=o[h];if(u.validator(a))return u.classGroupId}},TG=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),n=t.indexOf(":"),i=t.slice(0,n);return i?wG+i:void 0})(),CG=e=>{const{theme:t,classGroups:n}=e;return kG(n,t)},kG=(e,t)=>{const n=_M();for(const i in e){const r=e[i];aw(r,n,i,t)}return n},aw=(e,t,n,i)=>{const r=e.length;for(let s=0;s<r;s++){const o=e[s];NG(o,t,n,i)}},NG=(e,t,n,i)=>{if(typeof e=="string"){EG(e,t,n);return}if(typeof e=="function"){SG(e,t,n,i);return}IG(e,t,n,i)},EG=(e,t,n)=>{const i=e===""?t:bM(t,e);i.classGroupId=n},SG=(e,t,n,i)=>{if(AG(e)){aw(e(i),t,n,i);return}t.validators===null&&(t.validators=[]),t.validators.push(_G(n,e))},IG=(e,t,n,i)=>{const r=Object.entries(e),s=r.length;for(let o=0;o<s;o++){const[a,c]=r[o];aw(c,bM(t,a),n,i)}},bM=(e,t)=>{let n=e;const i=t.split(Cf),r=i.length;for(let s=0;s<r;s++){const o=i[s];let a=n.nextPart.get(o);a||(a=_M(),n.nextPart.set(o,a)),n=a}return n},AG=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,RG=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=Object.create(null),i=Object.create(null);const r=(s,o)=>{n[s]=o,t++,t>e&&(t=0,i=n,n=Object.create(null))};return{get(s){let o=n[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return r(s,o),o},set(s,o){s in n?n[s]=o:r(s,o)}}},Mx="!",Fk=":",PG=[],Uk=(e,t,n,i,r)=>({modifiers:e,hasImportantModifier:t,baseClassName:n,maybePostfixModifierPosition:i,isExternal:r}),MG=e=>{const{prefix:t,experimentalParseClassName:n}=e;let i=r=>{const s=[];let o=0,a=0,c=0,h;const u=r.length;for(let _=0;_<u;_++){const w=r[_];if(o===0&&a===0){if(w===Fk){s.push(r.slice(c,_)),c=_+1;continue}if(w==="/"){h=_;continue}}w==="["?o++:w==="]"?o--:w==="("?a++:w===")"&&a--}const d=s.length===0?r:r.slice(c);let f=d,v=!1;d.endsWith(Mx)?(f=d.slice(0,-1),v=!0):d.startsWith(Mx)&&(f=d.slice(1),v=!0);const y=h&&h>c?h-c:void 0;return Uk(s,v,f,y)};if(t){const r=t+Fk,s=i;i=o=>o.startsWith(r)?s(o.slice(r.length)):Uk(PG,!1,o,void 0,!0)}if(n){const r=i;i=s=>n({className:s,parseClassName:r})}return i},DG=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((n,i)=>{t.set(n,1e6+i)}),n=>{const i=[];let r=[];for(let s=0;s<n.length;s++){const o=n[s],a=o[0]==="[",c=t.has(o);a||c?(r.length>0&&(r.sort(),i.push(...r),r=[]),i.push(o)):r.push(o)}return r.length>0&&(r.sort(),i.push(...r)),i}},LG=e=>({cache:RG(e.cacheSize),parseClassName:MG(e),sortModifiers:DG(e),...bG(e)}),VG=/\s+/,qG=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:r,sortModifiers:s}=t,o=[],a=e.trim().split(VG);let c="";for(let h=a.length-1;h>=0;h-=1){const u=a[h],{isExternal:d,modifiers:f,hasImportantModifier:v,baseClassName:y,maybePostfixModifierPosition:_}=n(u);if(d){c=u+(c.length>0?" "+c:c);continue}let w=!!_,x=i(w?y.substring(0,_):y);if(!x){if(!w){c=u+(c.length>0?" "+c:c);continue}if(x=i(y),!x){c=u+(c.length>0?" "+c:c);continue}w=!1}const C=f.length===0?"":f.length===1?f[0]:s(f).join(":"),k=v?C+Mx:C,P=k+x;if(o.indexOf(P)>-1)continue;o.push(P);const A=r(x,w);for(let M=0;M<A.length;++M){const N=A[M];o.push(k+N)}c=u+(c.length>0?" "+c:c)}return c},jG=(...e)=>{let t=0,n,i,r="";for(;t<e.length;)(n=e[t++])&&(i=TM(n))&&(r&&(r+=" "),r+=i);return r},TM=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=TM(e[i]))&&(n&&(n+=" "),n+=t);return n},FG=(e,...t)=>{let n,i,r,s;const o=c=>{const h=t.reduce((u,d)=>d(u),e());return n=LG(h),i=n.cache.get,r=n.cache.set,s=a,a(c)},a=c=>{const h=i(c);if(h)return h;const u=qG(c,n);return r(c,u),u};return s=o,(...c)=>s(jG(...c))},UG=[],Xe=e=>{const t=n=>n[e]||UG;return t.isThemeGetter=!0,t},CM=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,kM=/^\((?:(\w[\w-]*):)?(.+)\)$/i,OG=/^\d+\/\d+$/,BG=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,GG=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,HG=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,$G=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zG=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,tc=e=>OG.test(e),Ut=e=>!!e&&!Number.isNaN(Number(e)),Ws=e=>!!e&&Number.isInteger(Number(e)),qv=e=>e.endsWith("%")&&Ut(e.slice(0,-1)),es=e=>BG.test(e),KG=()=>!0,WG=e=>GG.test(e)&&!HG.test(e),NM=()=>!1,QG=e=>$G.test(e),YG=e=>zG.test(e),JG=e=>!wt(e)&&!bt(e),XG=e=>_l(e,IM,NM),wt=e=>CM.test(e),Xo=e=>_l(e,AM,WG),jv=e=>_l(e,i6,Ut),Ok=e=>_l(e,EM,NM),ZG=e=>_l(e,SM,YG),Jd=e=>_l(e,RM,QG),bt=e=>kM.test(e),oh=e=>wl(e,AM),t6=e=>wl(e,r6),Bk=e=>wl(e,EM),e6=e=>wl(e,IM),n6=e=>wl(e,SM),Xd=e=>wl(e,RM,!0),_l=(e,t,n)=>{const i=CM.exec(e);return i?i[1]?t(i[1]):n(i[2]):!1},wl=(e,t,n=!1)=>{const i=kM.exec(e);return i?i[1]?t(i[1]):n:!1},EM=e=>e==="position"||e==="percentage",SM=e=>e==="image"||e==="url",IM=e=>e==="length"||e==="size"||e==="bg-size",AM=e=>e==="length",i6=e=>e==="number",r6=e=>e==="family-name",RM=e=>e==="shadow",s6=()=>{const e=Xe("color"),t=Xe("font"),n=Xe("text"),i=Xe("font-weight"),r=Xe("tracking"),s=Xe("leading"),o=Xe("breakpoint"),a=Xe("container"),c=Xe("spacing"),h=Xe("radius"),u=Xe("shadow"),d=Xe("inset-shadow"),f=Xe("text-shadow"),v=Xe("drop-shadow"),y=Xe("blur"),_=Xe("perspective"),w=Xe("aspect"),x=Xe("ease"),C=Xe("animate"),k=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[...P(),bt,wt],M=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],T=()=>[bt,wt,c],E=()=>[tc,"full","auto",...T()],R=()=>[Ws,"none","subgrid",bt,wt],D=()=>["auto",{span:["full",Ws,bt,wt]},Ws,bt,wt],j=()=>[Ws,"auto",bt,wt],L=()=>["auto","min","max","fr",bt,wt],lt=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],dt=()=>["start","end","center","stretch","center-safe","end-safe"],Y=()=>["auto",...T()],W=()=>[tc,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...T()],U=()=>[e,bt,wt],Q=()=>[...P(),Bk,Ok,{position:[bt,wt]}],F=()=>["no-repeat",{repeat:["","x","y","space","round"]}],q=()=>["auto","cover","contain",e6,XG,{size:[bt,wt]}],$=()=>[qv,oh,Xo],H=()=>["","none","full",h,bt,wt],X=()=>["",Ut,oh,Xo],tt=()=>["solid","dashed","dotted","double"],O=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>[Ut,qv,Bk,Ok],nt=()=>["","none",y,bt,wt],K=()=>["none",Ut,bt,wt],at=()=>["none",Ut,bt,wt],ct=()=>[Ut,bt,wt],vt=()=>[tc,"full",...T()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[es],breakpoint:[es],color:[KG],container:[es],"drop-shadow":[es],ease:["in","out","in-out"],font:[JG],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[es],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[es],shadow:[es],spacing:["px",Ut],text:[es],"text-shadow":[es],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",tc,wt,bt,w]}],container:["container"],columns:[{columns:[Ut,wt,bt,a]}],"break-after":[{"break-after":k()}],"break-before":[{"break-before":k()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:E()}],"inset-x":[{"inset-x":E()}],"inset-y":[{"inset-y":E()}],start:[{start:E()}],end:[{end:E()}],top:[{top:E()}],right:[{right:E()}],bottom:[{bottom:E()}],left:[{left:E()}],visibility:["visible","invisible","collapse"],z:[{z:[Ws,"auto",bt,wt]}],basis:[{basis:[tc,"full","auto",a,...T()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ut,tc,"auto","initial","none",wt]}],grow:[{grow:["",Ut,bt,wt]}],shrink:[{shrink:["",Ut,bt,wt]}],order:[{order:[Ws,"first","last","none",bt,wt]}],"grid-cols":[{"grid-cols":R()}],"col-start-end":[{col:D()}],"col-start":[{"col-start":j()}],"col-end":[{"col-end":j()}],"grid-rows":[{"grid-rows":R()}],"row-start-end":[{row:D()}],"row-start":[{"row-start":j()}],"row-end":[{"row-end":j()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:T()}],"gap-x":[{"gap-x":T()}],"gap-y":[{"gap-y":T()}],"justify-content":[{justify:[...lt(),"normal"]}],"justify-items":[{"justify-items":[...dt(),"normal"]}],"justify-self":[{"justify-self":["auto",...dt()]}],"align-content":[{content:["normal",...lt()]}],"align-items":[{items:[...dt(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...dt(),{baseline:["","last"]}]}],"place-content":[{"place-content":lt()}],"place-items":[{"place-items":[...dt(),"baseline"]}],"place-self":[{"place-self":["auto",...dt()]}],p:[{p:T()}],px:[{px:T()}],py:[{py:T()}],ps:[{ps:T()}],pe:[{pe:T()}],pt:[{pt:T()}],pr:[{pr:T()}],pb:[{pb:T()}],pl:[{pl:T()}],m:[{m:Y()}],mx:[{mx:Y()}],my:[{my:Y()}],ms:[{ms:Y()}],me:[{me:Y()}],mt:[{mt:Y()}],mr:[{mr:Y()}],mb:[{mb:Y()}],ml:[{ml:Y()}],"space-x":[{"space-x":T()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":T()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[a,"screen",...W()]}],"min-w":[{"min-w":[a,"screen","none",...W()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",n,oh,Xo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,bt,jv]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",qv,wt]}],"font-family":[{font:[t6,wt,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,bt,wt]}],"line-clamp":[{"line-clamp":[Ut,"none",bt,jv]}],leading:[{leading:[s,...T()]}],"list-image":[{"list-image":["none",bt,wt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",bt,wt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...tt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ut,"from-font","auto",bt,Xo]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Ut,"auto",bt,wt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",bt,wt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",bt,wt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Q()}],"bg-repeat":[{bg:F()}],"bg-size":[{bg:q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ws,bt,wt],radial:["",bt,wt],conic:[Ws,bt,wt]},n6,ZG]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:$()}],"gradient-via-pos":[{via:$()}],"gradient-to-pos":[{to:$()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:X()}],"border-w-x":[{"border-x":X()}],"border-w-y":[{"border-y":X()}],"border-w-s":[{"border-s":X()}],"border-w-e":[{"border-e":X()}],"border-w-t":[{"border-t":X()}],"border-w-r":[{"border-r":X()}],"border-w-b":[{"border-b":X()}],"border-w-l":[{"border-l":X()}],"divide-x":[{"divide-x":X()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":X()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...tt(),"hidden","none"]}],"divide-style":[{divide:[...tt(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...tt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ut,bt,wt]}],"outline-w":[{outline:["",Ut,oh,Xo]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",u,Xd,Jd]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",d,Xd,Jd]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Ut,Xo]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":X()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",f,Xd,Jd]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Ut,bt,wt]}],"mix-blend":[{"mix-blend":[...O(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":O()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ut]}],"mask-image-linear-from-pos":[{"mask-linear-from":B()}],"mask-image-linear-to-pos":[{"mask-linear-to":B()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":B()}],"mask-image-t-to-pos":[{"mask-t-to":B()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":B()}],"mask-image-r-to-pos":[{"mask-r-to":B()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":B()}],"mask-image-b-to-pos":[{"mask-b-to":B()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":B()}],"mask-image-l-to-pos":[{"mask-l-to":B()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":B()}],"mask-image-x-to-pos":[{"mask-x-to":B()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":B()}],"mask-image-y-to-pos":[{"mask-y-to":B()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[bt,wt]}],"mask-image-radial-from-pos":[{"mask-radial-from":B()}],"mask-image-radial-to-pos":[{"mask-radial-to":B()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Ut]}],"mask-image-conic-from-pos":[{"mask-conic-from":B()}],"mask-image-conic-to-pos":[{"mask-conic-to":B()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Q()}],"mask-repeat":[{mask:F()}],"mask-size":[{mask:q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",bt,wt]}],filter:[{filter:["","none",bt,wt]}],blur:[{blur:nt()}],brightness:[{brightness:[Ut,bt,wt]}],contrast:[{contrast:[Ut,bt,wt]}],"drop-shadow":[{"drop-shadow":["","none",v,Xd,Jd]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Ut,bt,wt]}],"hue-rotate":[{"hue-rotate":[Ut,bt,wt]}],invert:[{invert:["",Ut,bt,wt]}],saturate:[{saturate:[Ut,bt,wt]}],sepia:[{sepia:["",Ut,bt,wt]}],"backdrop-filter":[{"backdrop-filter":["","none",bt,wt]}],"backdrop-blur":[{"backdrop-blur":nt()}],"backdrop-brightness":[{"backdrop-brightness":[Ut,bt,wt]}],"backdrop-contrast":[{"backdrop-contrast":[Ut,bt,wt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ut,bt,wt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ut,bt,wt]}],"backdrop-invert":[{"backdrop-invert":["",Ut,bt,wt]}],"backdrop-opacity":[{"backdrop-opacity":[Ut,bt,wt]}],"backdrop-saturate":[{"backdrop-saturate":[Ut,bt,wt]}],"backdrop-sepia":[{"backdrop-sepia":["",Ut,bt,wt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":T()}],"border-spacing-x":[{"border-spacing-x":T()}],"border-spacing-y":[{"border-spacing-y":T()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",bt,wt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ut,"initial",bt,wt]}],ease:[{ease:["linear","initial",x,bt,wt]}],delay:[{delay:[Ut,bt,wt]}],animate:[{animate:["none",C,bt,wt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[_,bt,wt]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:K()}],"rotate-x":[{"rotate-x":K()}],"rotate-y":[{"rotate-y":K()}],"rotate-z":[{"rotate-z":K()}],scale:[{scale:at()}],"scale-x":[{"scale-x":at()}],"scale-y":[{"scale-y":at()}],"scale-z":[{"scale-z":at()}],"scale-3d":["scale-3d"],skew:[{skew:ct()}],"skew-x":[{"skew-x":ct()}],"skew-y":[{"skew-y":ct()}],transform:[{transform:[bt,wt,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:vt()}],"translate-x":[{"translate-x":vt()}],"translate-y":[{"translate-y":vt()}],"translate-z":[{"translate-z":vt()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",bt,wt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",bt,wt]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Ut,oh,Xo,jv]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},o6=FG(s6);function qt(...e){return o6(xM(e))}function kf(e,t=0){var u,d;if(!e)return{quizScore:0,conquestScore:0,gachaScore:0,towerScore:0,achievementScore:0,totalScore:0};const n=(e.totalCorrect??0)*10+(e.perfectLessons??0)*50,i=e.conquestStats,r=((i==null?void 0:i.rankPoints)??0)+((i==null?void 0:i.totalConquests)??0)*5+((i==null?void 0:i.bestWinStreak)??0)*20,s=(u=e.gachaInventory)==null?void 0:u.gachaStats,o=((s==null?void 0:s.totalURCards)??0)*100+((s==null?void 0:s.totalSRCards)??0)*50+((s==null?void 0:s.totalRCards)??0)*20+((s==null?void 0:s.totalNCards)??0)*5+((s==null?void 0:s.completedCollections)??0)*200,a=t*10,c=(((d=e.achievements)==null?void 0:d.length)??0)*25,h=n+r+o+a+c;return{quizScore:n,conquestScore:r,gachaScore:o,towerScore:a,achievementScore:c,totalScore:h}}function Dn(e,t=1){if(e<1e3)return e.toString();if(e<1e6){const i=e/1e3;return i%1===0?`${i}K`:`${i.toFixed(t)}K`}if(e<1e9){const i=e/1e6;return i%1===0?`${i}M`:`${i.toFixed(t)}M`}const n=e/1e9;return n%1===0?`${n}B`:`${n.toFixed(t)}B`}function se({children:e,className:t}){return l.jsx("div",{className:qt("min-h-screen",t),children:e})}const Gk=e=>{let t;const n=new Set,i=(h,u)=>{const d=typeof h=="function"?h(t):h;if(!Object.is(d,t)){const f=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(v=>v(t,f))}},r=()=>t,a={setState:i,getState:r,getInitialState:()=>c,subscribe:h=>(n.add(h),()=>n.delete(h))},c=t=e(i,r,a);return a},a6=e=>e?Gk(e):Gk,c6=e=>e;function l6(e,t=c6){const n=it.useSyncExternalStore(e.subscribe,it.useCallback(()=>t(e.getState()),[e,t]),it.useCallback(()=>t(e.getInitialState()),[e,t]));return it.useDebugValue(n),n}const Hk=e=>{const t=a6(e),n=i=>l6(t,i);return Object.assign(n,t),n},Zu=e=>e?Hk(e):Hk,h6=[{id:1,name:"TNG QUAN D N",totalQuestions:16,icon:"ClipboardList"},{id:2,name:"GIAO TIP V TRUYN THNG",totalQuestions:20,icon:"MessageCircle"},{id:3,name:"C LNG D N",totalQuestions:17,icon:"BarChart3"},{id:4,name:"LP LCH D N",totalQuestions:16,icon:"Calendar"},{id:5,name:"KIM SOT V GIM ST",totalQuestions:8,icon:"Search"},{id:6,name:"QUN L PHM VI",totalQuestions:8,icon:"Target"},{id:7,name:"QUN L THI GIAN",totalQuestions:8,icon:"Clock"},{id:8,name:"QUN L CHI PH",totalQuestions:9,icon:"DollarSign"},{id:9,name:"QUN L CHT LNG",totalQuestions:7,icon:"CheckCircle"},{id:10,name:"QUN L NHN LC",totalQuestions:8,icon:"Users"},{id:11,name:"TRUYN THNG V GIAO TIP",totalQuestions:9,icon:"Megaphone"},{id:12,name:"QUN L RI RO",totalQuestions:8,icon:"AlertTriangle"},{id:13,name:"QUN L TCH HP",totalQuestions:9,icon:"Link"}],u6=[{id:1,question:"D n l g?",options:[{id:"A",text:"L hot ng nghin cu mang tnh l thuyt."},{id:"B",text:"L cng vic lp li nhiu ln theo chu k nht nh."},{id:"C",text:"L hot ng c phng php, s dng ngun lc  to sn phm mi."},{id:"D",text:"L k hoch sn xut c p dng lu di."}],correctAnswer:"C",chapter:1,chapterName:"TNG QUAN D N"},{id:2,question:"Mc tiu ca d n l g?",options:[{id:"A",text:"Gii quyt vn  thc t v p ng nhu cu ngi dng."},{id:"B",text:"a ra m hnh khoa hc v phng php nghin cu."},{id:"C",text:"Xy dng chin lc ti chnh cho t chc."},{id:"D",text:"Pht trin h thng phn mm phc v nghin cu."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:3,question:"Qun l d n CNTT l g?",options:[{id:"A",text:"L vic t chc cc hot ng nhm t c mc tiu trong gii hn v thi gian, kinh ph v cht lng."},{id:"B",text:"L cng vic lp trnh v pht trin phn mm cho doanh nghip."},{id:"C",text:"L hot ng nghin cu cng ngh thng tin ng dng."},{id:"D",text:"L k hoch kim th v vn hnh phn mm."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:4,question:"Mt d n CNTT c nh gi l thnh cng khi:",options:[{id:"A",text:"Hon thnh ng thi gian v p ng yu cu ngi dng."},{id:"B",text:"c u t ngun vn ln v c nhiu nhn lc tham gia."},{id:"C",text:"C sn phm ng dng cng ngh mi."},{id:"D",text:"S dng phn mm qun l hin i."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:5,question:"Trong giai on khi to d n, ngi qun l cn thc hin vic no sau y?",options:[{id:"A",text:"nh gi hiu qu sau khi bn giao sn phm."},{id:"B",text:"Xc nh yu cu, mc u tin v phn cng trch nhim."},{id:"C",text:"Thc hin kim th v vit ti liu hng dn."},{id:"D",text:"Xy dng bo co ti chnh cui k."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:6,question:"Giai on lp k hoch d n c nhim v:",options:[{id:"A",text:"Hon thin sn phm v bn giao cho khch hng."},{id:"B",text:"Lp k hoch chi tit, xc nh phm vi v iu chnh mc tiu."},{id:"C",text:"Thc hin gim st tin  d n."},{id:"D",text:"nh gi ri ro v  xut kt thc d n."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:7,question:"Theo quy trnh qun l d n phn mm, giai on kt thc nhm:",options:[{id:"A",text:"Thc hin kim th h thng v vn hnh th."},{id:"B",text:"Chnh thc ng d n v hon tt cc hot ng cn li."},{id:"C",text:"Trin khai nng cp v bo tr phn mm."},{id:"D",text:"Lp k hoch cho d n tip theo."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:8,question:"Mt d n CNTT tht bi ch yu v:",options:[{id:"A",text:"Thiu k hoch chi tit v khng hiu r yu cu ngi dng."},{id:"B",text:"S dng cng ngh li thi hoc qu hin i."},{id:"C",text:"Thiu ngun vn t c quan nh nc."},{id:"D",text:"Thay i nhn s trong qu trnh bo tr."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:9,question:"Theo phn loi d n, d n ln thng c c im:",options:[{id:"A",text:"Ngun kinh ph t, nhn lc gn nh, thi gian ngn."},{id:"B",text:"Nhiu bn tham gia, phm vi rng v chi ph ln."},{id:"C",text:"Ch thc hin trong phm vi ni b."},{id:"D",text:"Khng cn c c cu t chc ring bit."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:10,question:"Cc nhim v trong hot ng qun l d n bao gm:",options:[{id:"A",text:"Qun l thi gian, kinh ph, nhn lc v kt qu chuyn giao."},{id:"B",text:"Qun l cng ngh, truyn thng, d liu v bo mt."},{id:"C",text:"Qun l ti chnh, k ton, nhn s v hnh chnh."},{id:"D",text:"Qun l phn cng, phn mm, mng v ti liu."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:11,question:"Mc ch ca qun l d n l:",options:[{id:"A",text:"m bo sn phm p ng yu cu, ng hn, trong gii hn chi ph."},{id:"B",text:"t li nhun cao nht v m rng quy m t chc."},{id:"C",text:"a ra gii php mi v ci tin quy trnh cng ngh."},{id:"D",text:"Gim thiu ri ro ti chnh v nng cao uy tn doanh nghip."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:12,question:"Trong quy trnh lp k hoch, yu t rng buc ca d n gm:",options:[{id:"A",text:"Thi gian, nhn lc v ngn sch."},{id:"B",text:"Khch hng, sn phm v th trng."},{id:"C",text:"Ti nguyn, k nng v k thut."},{id:"D",text:"Thi gian, a im v cng ngh."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:13,question:"D n bn ngoi l:",options:[{id:"A",text:"D n phc v chnh ni b t chc."},{id:"B",text:"D n c thc hin cho mt n v khc."},{id:"C",text:"D n khng c yu t khch hng tham gia."},{id:"D",text:"D n nghin cu pht trin ni b."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:14,question:"Khi mt d n ko di vt 50% thi gian d kin, c coi l:",options:[{id:"A",text:"D n chm tin ."},{id:"B",text:"D n tht bi."},{id:"C",text:"D n ang tm dng."},{id:"D",text:"D n cn ti cu trc."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:15,question:"Mt trong nhng nguyn nhn su xa khin d n tht bi l:",options:[{id:"A",text:"Bt u lp trnh khi cha hiu r yu cu thc t."},{id:"B",text:"Khng c  kinh ph v nhn lc."},{id:"C",text:"Khng c khch hng ph duyt yu cu."},{id:"D",text:"S dng phn mm khng tng thch."}],correctAnswer:"A",chapter:1,chapterName:"TNG QUAN D N"},{id:16,question:" cn bng b ba rng buc (phm vi  chi ph  thi gian), nh qun l cn:",options:[{id:"A",text:"Ct gim phm vi khi chi ph vt qu gii hn."},{id:"B",text:"Phn tch u tin, iu chnh linh hot gia ba yu t."},{id:"C",text:"Tng ngn sch  rt ngn tin  d n."},{id:"D",text:"Gi nguyn thi gian, gim cht lng sn phm."}],correctAnswer:"B",chapter:1,chapterName:"TNG QUAN D N"},{id:17,question:"Giao tip l g?",options:[{id:"A",text:"L qu trnh truyn t thng tin bng vn bn."},{id:"B",text:"L hnh ng truyn tin mt chiu t ngi ni n ngi nghe."},{id:"C",text:"L qu trnh trao i thng tin, tnh cm v hiu bit gia con ngi."},{id:"D",text:"L hot ng truyn thng qua cc phng tin k thut."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:18,question:"Giao tip hiu qu nht din ra trong tnh hung no?",options:[{id:"A",text:"Giao tip trc tip, mt i mt gia hai bn."},{id:"B",text:"Giao tip qua th in t v bo co."},{id:"C",text:"Giao tip qua in thoi v tin nhn."},{id:"D",text:"Giao tip bng cc vn bn hnh chnh."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:19,question:"Trong bn quy m giao tip, quy m no l c bn nht?",options:[{id:"A",text:"Giao tip vi chnh bn thn."},{id:"B",text:"Giao tip nhm."},{id:"C",text:"Giao tip gia cc t chc."},{id:"D",text:"Giao tip trong cng ng."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:20,question:"Nguyn tc quan trng nht trong giao tip l:",options:[{id:"A",text:"Cnh tranh v khng nh bn thn."},{id:"B",text:"Dng quyn lc  iu khin ngi khc."},{id:"C",text:"Tn trng nhn cch v i x bnh ng trong giao tip."},{id:"D",text:"Gi im lng  trnh xung t."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:21,question:"Theo thuyt hot ng, giao tip l:",options:[{id:"A",text:"Qu trnh biu t cm xc bng li ni."},{id:"B",text:"Phng tin  tha mn nhu cu tm l."},{id:"C",text:"H thng qu trnh c mc ch m bo s tng tc gia ngi vi ngi trong hot ng tp th."},{id:"D",text:"Phn ng tm l khi tip xc x hi."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:22,question:"Phong cch giao tip c on c u im l:",options:[{id:"A",text:"To mi trng dn ch v hp tc."},{id:"B",text:"Gip a ra quyt nh nhanh chng trong tnh hung khn cp."},{id:"C",text:"Tng s t tin v sng to ca cp di."},{id:"D",text:"Lm tng tnh dn ch trong t chc."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:23,question:"Phong cch giao tip dn ch c c trng bi:",options:[{id:"A",text:"Kim sot cht ch v p t  kin c nhn."},{id:"B",text:"Linh hot nhng d thay i mc tiu."},{id:"C",text:"Biu hin s tn trng, lng nghe v hp tc gia cc bn."},{id:"D",text:"Khng quan tm n cm xc ngi i thoi."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:24,question:"S khc bit gia nghe v lng nghe l g?",options:[{id:"A",text:"Nghe ch ng, cn lng nghe l th ng."},{id:"B",text:"Nghe l th ng, cn lng nghe l ch ng, c chn lc v tp trung."},{id:"C",text:"Nghe dng gic quan, cn lng nghe dng l tr."},{id:"D",text:"Nghe dnh cho cng vic, cn lng nghe dnh cho cm xc."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:25,question:"Mt trong nhng yu t lm gim hiu qu lng nghe l:",options:[{id:"A",text:"Gi im lng khi i phng ni."},{id:"B",text:"Ngt li hoc nh gi ngi ni khi cha hiu r."},{id:"C",text:"Gt u v phn hi tch cc."},{id:"D",text:"Ghi ch li cc  chnh trong khi nghe."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:26,question:"Mt trong cc k nng gip rn luyn lng nghe hiu qu l:",options:[{id:"A",text:"Tp trung vo phong cch ngi ni hn l ni dung."},{id:"B",text:"Phn bin lin tc  th hin hiu bit."},{id:"C",text:"Ch , tp trung, khng ngt li v phn hi ng lc."},{id:"D",text:"Gi khong cch  trnh b chi phi cm xc."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:27,question:"Vit trong giao tip c vai tr g?",options:[{id:"A",text:"Th hin cm xc v s quan tm c nhn."},{id:"B",text:"L cng c truyn ti thng tin chnh xc, lu tr v xem xt chi tit."},{id:"C",text:"L hnh thc giao tip khng chnh thc."},{id:"D",text:"L cch th hin uy quyn v kim sot thng tin."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:28,question:"Mt bi vit tt cn m bo yu t no?",options:[{id:"A",text:"Cm xc, hnh thc v b cc."},{id:"B",text:"R rng, sc tch, ng ng php v d hiu."},{id:"C",text:"Di dng, chi tit v dng nhiu v d."},{id:"D",text:"Phc tp, khoa trng v mang tnh hc thut."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:29,question:"Trong k nng ni, yu t quyt nh hiu qu l:",options:[{id:"A",text:"Ni dung bi ni di v c s liu."},{id:"B",text:"Cch din t, ging ni v s t tin khi trnh by."},{id:"C",text:"Vit sn ton b ni dung  c li."},{id:"D",text:"Dng ngn t phc tp v tru tng."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:30,question:"Trc khi thuyt trnh, bc chun b quan trng nht l:",options:[{id:"A",text:"Vit li ton b bi thuyt trnh t tr nh."},{id:"B",text:"Chun b trang phc ph hp v phn thng."},{id:"C",text:"Xc nh mc tiu, i tng ngi nghe v ni dung chnh."},{id:"D",text:"Hc thuc lng ton b ni dung bi ni."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:31,question:"Ngn ng c th trong khi ni gip:",options:[{id:"A",text:"Lm gim cng thng cho ngi ni."},{id:"B",text:"Tng tnh thuyt phc v th hin cm xc chn tht."},{id:"C",text:"Thay th hon ton li ni trong giao tip."},{id:"D",text:"Gim nhu cu s dng ngn ng."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:32,question:"Thuyt trnh bng cch c ton vn bi vit c hn ch g?",options:[{id:"A",text:"Gip m bo tnh chnh xc ca ni dung."},{id:"B",text:"Gy bun chn, thiu tng tc v kh thu ht ngi nghe."},{id:"C",text:"Tng kh nng ghi nh cho ngi ni."},{id:"D",text:"Th hin s chuyn nghip trong trnh by."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:33,question:"Theo Maslow, nguyn nhn khin ngi thuyt trnh hi hp l do:",options:[{id:"A",text:"Lo ngi phn ng tiu cc t khn gi."},{id:"B",text:"Nhu cu an ton b e da trong tnh hung cng khai."},{id:"C",text:"Thiu s chun b v kinh nghim."},{id:"D",text:"S mt v th x hi v uy tn c nhn."}],correctAnswer:"A",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:34,question:"Yu t phi ngn t trong giao tip gm:",options:[{id:"A",text:"Ging ni, t ng v cu trc cu."},{id:"B",text:"Ni dung, cch vit v thi ."},{id:"C",text:"nh mt, c ch, t th, trang phc v nt mt."},{id:"D",text:"Hnh thc trnh by vn bn."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:35,question:"Trong giao tip nhm,  t hiu qu cn:",options:[{id:"A",text:"Trnh bt ng v chp nhn mi  kin."},{id:"B",text:"Lng nghe, tn trng v phi hp hi ha gia cc thnh vin."},{id:"C",text:"Phn chia nhim v khng r rng  linh hot hn."},{id:"D",text:"Ch tp trung vo mc tiu c nhn."}],correctAnswer:"B",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:36,question:"Khi vit bo co hoc email cng vic, iu cn trnh nht l:",options:[{id:"A",text:"Vit ngn gn, r rng v ng chnh t."},{id:"B",text:"Ghi ch y  cc s liu quan trng."},{id:"C",text:"Dng t ng cm tnh, thiu trng tm v khng c cu trc."},{id:"D",text:"Trnh by ni dung theo th t logic."}],correctAnswer:"C",chapter:2,chapterName:"GIAO TIP V TRUYN THNG"},{id:37,question:"c lng trong qun l d n l g?",options:[{id:"A",text:"Qu trnh kim tra v iu chnh chi ph thc t ca d n."},{id:"B",text:"Qu trnh d on cng sc, chi ph v thi gian cn thit  hon thnh cng vic."},{id:"C",text:"Qu trnh so snh kt qu thc t vi k hoch ban u."},{id:"D",text:"Hot ng tng kt sau khi d n kt thc."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:38,question:"Khi d n tin trin v thng tin r hn, sai s c lng c xu hng:",options:[{id:"A",text:"Tng dn do ri ro cao hn."},{id:"B",text:"Gim dn nh d liu thc t c cp nht."},{id:"C",text:"Khng thay i v  c d bo ban u."},{id:"D",text:"Ph thuc vo  kin ca khch hng."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:39,question:"Phng php c lng nh gi chuyn gia da trn yu t no?",options:[{id:"A",text:"Kinh nghim v kin thc thc t ca cc chuyn gia trong lnh vc."},{id:"B",text:"S liu thng k t cc d n  hon thnh."},{id:"C",text:"Mc chi ph trung bnh ca ngnh."},{id:"D",text:"Quy nh k thut ca c quan qun l."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:40,question:"u im ca phng php nh gi chuyn gia l:",options:[{id:"A",text:"Nhanh chng, c th chnh xc nu chn ng chuyn gia."},{id:"B",text:"Tit kim chi ph v d t ng ha."},{id:"C",text:"Khng ph thuc vo con ngi."},{id:"D",text:"Ph hp vi cc d n cha c d liu lch s."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:41,question:"Nhc im ca phng php nh gi chuyn gia l:",options:[{id:"A",text:"Tn thi gian v chi ph cao."},{id:"B",text:"Ph thuc vo ch quan v kinh nghim c nhn."},{id:"C",text:"Khng p dng cho cc d n nh."},{id:"D",text:"Khng ph hp vi d n phn mm."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:42,question:"Phng php c lng quy trnh lch s da vo:",options:[{id:"A",text:"Cm nhn ca nhm d n v tin  cng vic."},{id:"B",text:"D liu v kt qu thc t t cc d n trc ."},{id:"C",text:"Bo co ti chnh v chi ph u t."},{id:"D",text:"Thi gian thc hin trung bnh ca d n mu."}],correctAnswer:"B",chapter:3,chapterName:"C LNG D N"},{id:43,question:"Khi s dng quy trnh lch s  c lng, yu t quan trng nht l:",options:[{id:"A",text:"C c s d liu y  v thi gian, chi ph v nhn lc d n trc."},{id:"B",text:"Tnh ton theo cm tnh v kinh nghim c nhn."},{id:"C",text:"p dng quy tc phn trm tng trng."},{id:"D",text:"Da vo m hnh d ton ti chnh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:44,question:"Cng thc COCOMO c dng  c lng:",options:[{id:"A",text:"Chi ph, thi gian, nhn lc v lch biu ca d n phn mm."},{id:"B",text:"Ri ro, cht lng v chi ph vn hnh."},{id:"C",text:"Ti nguyn phn cng v hiu nng h thng."},{id:"D",text:"K hoch o to v bo tr sn phm."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:45,question:"Trong m hnh COCOMO, thng tin u vo quan trng nht l:",options:[{id:"A",text:"S dng lnh m ngun (LOSC) d kin."},{id:"B",text:"S lng lp trnh vin tham gia."},{id:"C",text:"Mc lng bnh qun ca nhm k thut."},{id:"D",text:"Tc  x l ca h thng my tnh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:46,question:"Phng php im chc nng dng :",options:[{id:"A",text:"o  phc tp v khi lng cng vic ca phn mm."},{id:"B",text:"nh gi cht lng m ngun chng trnh."},{id:"C",text:"Kim th hiu nng h thng."},{id:"D",text:"o tc  x l ca phn mm."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:47,question:"Theo cng thc D=C(G+J), trong  D l thi gian thc hin, C l  phc tp, G l kinh nghim, J l tri thc chuyn mn, ta hiu rng:",options:[{id:"A",text:"Thi gian hon thnh ph thuc vo  phc tp v nng lc ngi thc hin."},{id:"B",text:"Hiu nng h thng quyt nh hon ton thi gian d n."},{id:"C",text:"Ch cn kinh nghim chung l   gim thi gian."},{id:"D",text:"Tri thc chuyn mn khng nh hng n tin ."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:48,question:"Mt nguyn tc quan trng ca quy tc c lng theo DEC l:",options:[{id:"A",text:"Nn  ngi mi c lng  c gc nhn khch quan."},{id:"B",text:"Khng cn tho lun khi c sai khc gia cc nhm."},{id:"C",text:"Nu c chnh lch ln gia cc nhm c lng, phi hp li  thng nht."},{id:"D",text:"Ly trung bnh cng ca mi kt qu c lng  tng  tin cy."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:49,question:"Yu t no l nguyn nhn chnh khin vic c lng sai lch ln?",options:[{id:"A",text:"Khng c d liu lch s hoc khng phn tch k yu cu d n."},{id:"B",text:"Thiu nhn lc c trnh  cao."},{id:"C",text:"Do khch hng thay i yu cu gia chng."},{id:"D",text:"Do thit b phn cng cha n nh."}],correctAnswer:"A",chapter:3,chapterName:"C LNG D N"},{id:50,question:"Theo quy tc DEC, v sao khng nn p buc lp trnh vin a ra c lng?",options:[{id:"A",text:"V h khng c kh nng tnh ton."},{id:"B",text:"V h thng nh gi qu thp cng vic."},{id:"C",text:"V vic p buc lm mt tnh khch quan v gim  tin cy ca kt qu."},{id:"D",text:"V h khng c trch nhim vi tin  d n."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:51,question:"Theo DEC, cch x l hp l nht khi c nhiu c lng khc nhau cho cng mt cng vic l:",options:[{id:"A",text:"Chn gi tr cao nht  trnh thiu ht thi gian."},{id:"B",text:"Ly trung bnh cng  m bo cn bng."},{id:"C",text:"T chc tho lun  tm nguyn nhn sai khc v thng nht li kt qu."},{id:"D",text:"Chn ngu nhin mt kt qu v iu chnh sau."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:52,question:"Theo tin trnh c lng, ngu nhin c thm vo nhm mc ch:",options:[{id:"A",text:"Tng  chnh xc cho kt qu tnh ton."},{id:"B",text:"m bo c lng ph hp vi thc t thng k."},{id:"C",text:"B tr cho nhng bin ng hoc ri ro khng lng trc."},{id:"D",text:"Gim s khc bit gia cc nhm thc hin."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:53,question:"Kt lun ca ti liu v k nng c lng trong d n l g?",options:[{id:"A",text:"L mt quy trnh nh lng chnh xc."},{id:"B",text:"C th t ng ha hon ton bng phn mm."},{id:"C",text:"L mt qu trnh va mang tnh ngh thut, va cn iu chnh lin tc."},{id:"D",text:"Khng cn thit nu d n  c k hoch c th."}],correctAnswer:"C",chapter:3,chapterName:"C LNG D N"},{id:54,question:"Mc ch chnh ca vic lp lch trong qun l d n l g?",options:[{id:"A",text:"D on chi ph v phn b ngn sch d n."},{id:"B",text:"Xc nh th t, thi gian v quan h gia cc cng vic."},{id:"C",text:"Xc nh ngi chu trch nhim trong tng giai on."},{id:"D",text:"nh gi hiu qu tng th ca kt qu thc hin."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:55,question:"T PERT trong qun l d n l vit tt ca cm t no sau y?",options:[{id:"A",text:"Program Evaluation and Review Technique."},{id:"B",text:"Project Execution and Reporting Template."},{id:"C",text:"Process Evaluation and Resource Tracking."},{id:"D",text:"Planning Estimation and Review Tool."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:56,question:"ng gng (Critical Path) trong s  PERT c  ngha g?",options:[{id:"A",text:"L ng c s lng hot ng ln nht trong d n."},{id:"B",text:"L chui hot ng di nht quyt nh thi gian hon thnh d n."},{id:"C",text:"L tuyn ng c mc chi ph thc hin thp nht."},{id:"D",text:"L chui hot ng c  th ni cao nht trong d n."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:57,question:"Mi quan h gia ng gng v thi hn hon thnh d n l g?",options:[{id:"A",text:"Mi thay i trn ng gng u lm thay i thi hn d n."},{id:"B",text:"ng gng ch nh hng n cc cng vic u tin."},{id:"C",text:"Cc cng vic trn ng gng c th di lch ty ."},{id:"D",text:"ng gng ch dng  theo di chi ph d kin."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:58,question:"Khi mt cng vic khng nm trn ng gng, iu  cho bit:",options:[{id:"A",text:"Cng vic  c vai tr trung tm ca d n."},{id:"B",text:"Cng vic  c th tr trong gii hn cho php m khng nh hng d n."},{id:"C",text:"Cng vic  phi hon thnh sm nht  t tin ."},{id:"D",text:"Cng vic  khng nh hng n sn phm cui cng."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:59,question:"Th ni ton b (Total Float) trong d n c hiu l g?",options:[{id:"A",text:"Thi gian cng vic c th tr m khng lm tr ton b d n."},{id:"B",text:"Thi gian d n c th ko di trc khi b hy b."},{id:"C",text:"Thi gian ch i gia hai hot ng lin tip nhau."},{id:"D",text:"Thi gian m ngi qun l d n c th phn b li nhn s."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:60,question:"Th ni t do (Free Float) c  ngha nh th no trong qun l d n?",options:[{id:"A",text:"Khong thi gian d n c th ko di ti a."},{id:"B",text:"Khong thi gian cng vic c th tr m khng nh hng n cng vic sau."},{id:"C",text:"Khong thi gian ngi qun l c th ngh gia chng."},{id:"D",text:"Khong thi gian dng  chun b bo co kt qu."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:61,question:"Khi mt hot ng b ko di v lm thay i ng gng, ngi qun l cn:",options:[{id:"A",text:"Cp nht s  PERT v iu chnh k hoch tng th."},{id:"B",text:"Gi nguyn tin  v ch nh gi sau."},{id:"C",text:"Gim yu cu cht lng  b thi gian."},{id:"D",text:"Di cc hot ng khc sang giai on sau."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:62,question:"Vic cp pht ti nguyn nhn lc cn da trn nguyn tc no?",options:[{id:"A",text:"Da trn thm nin cng tc v chc v ca mi ngi."},{id:"B",text:"Da trn k nng, mc  ph hp v s tin cy ca nhn s."},{id:"C",text:"Da trn  tui, gii tnh v kh nng lm vic nhm."},{id:"D",text:"Da trn s lng ngi c th huy ng trong giai on ."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:63,question:"Theo quy tc cng nghip, khi b sung thm ngi vo nhm, iu g xy ra?",options:[{id:"A",text:"Hiu sut gim v cn thm thi gian phi hp gia cc thnh vin."},{id:"B",text:"Hiu sut tng v nhiu ngi cng chia s cng vic."},{id:"C",text:"Chi ph gim v rt ngn c thi gian d n."},{id:"D",text:"Tin  c rt ngn t l thun vi s lng nhn vin."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:64,question:"Ti nguyn phi con ngi trong d n thng bao gm nhng g?",options:[{id:"A",text:"Phn cng, phn mm, ti liu, thit b v cc dch v h tr."},{id:"B",text:"Chi ph nhn s, phng tin i li v ph cp cng tc."},{id:"C",text:"Hp ng, giy t hnh chnh v ti liu o to."},{id:"D",text:"Thi gian ngh php v lch cng tc ca nhm d n."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:65,question:"Rng buc b ba (Triple Constraint) trong qun l d n gm nhng yu t no?",options:[{id:"A",text:"Thi gian  Chi ph  Phm vi (hoc Cht lng)."},{id:"B",text:"Nhn lc  Cng ngh  Kinh nghim."},{id:"C",text:"Thi gian  a im  Ngun lc."},{id:"D",text:"K hoch  Tin   nh gi."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:66,question:"S  Gantt c vai tr g trong qun l d n?",options:[{id:"A",text:"Th hin tin  cng vic theo trc thi gian  theo di thc hin."},{id:"B",text:"M t quan h nhn qu gia cc cng vic d n."},{id:"C",text:"nh gi nng sut ca tng thnh vin trong nhm."},{id:"D",text:"Biu din mc  ri ro v s ph thuc k thut."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:67,question:"Vic lp lch li cc hot ng trong d n c thc hin khi no?",options:[{id:"A",text:"Khi d n kt thc v cn rt kinh nghim."},{id:"B",text:"Khi c thay i trong tin , ngun lc hoc cc rng buc khc."},{id:"C",text:"Khi khch hng yu cu b sung thm chc nng mi."},{id:"D",text:"Khi nhm d n thay i ngi qun l hoc nh ti tr."}],correctAnswer:"B",chapter:4,chapterName:"LP LCH D N"},{id:68,question:"Ngi qun l d n cn c bit tp trung vo ng gng v l do no?",options:[{id:"A",text:"ng gng cha cc cng vic t quan trng nht."},{id:"B",text:"ng gng xc nh chi ph pht sinh ca tng cng on."},{id:"C",text:"Mi s chm tr trn ng gng u lm chm ton b tin  d n."},{id:"D",text:"ng gng ch nh hng n cc cng vic ph tr trong d n."}],correctAnswer:"C",chapter:4,chapterName:"LP LCH D N"},{id:69,question:"Khi rt ngn tin  d n, iu gi nh no cn c m bo?",options:[{id:"A",text:"Cc nhim v c th rt ngn c lp v khng nh hng ln nhau."},{id:"B",text:"Thm nhn lc lun gip tin  c rt ngn nhanh chng."},{id:"C",text:"C th gim thi gian m khng tng thm chi ph hoc ri ro."},{id:"D",text:"Mi hot ng c th c rt ngn m khng cn iu chnh k hoch."}],correctAnswer:"A",chapter:4,chapterName:"LP LCH D N"},{id:70,question:"Kim sot d n bao gm cc cng vic chnh no?",options:[{id:"A",text:"Phn tch yu cu, thit k v th nghim sn phm."},{id:"B",text:"Gim st tin , pht hin vn  v iu chnh k hoch."},{id:"C",text:"Lp k hoch ngn sch v phn cng nhn s."},{id:"D",text:"Tng kt d n v nh gi cht lng sn phm."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:71,question:"Mc tiu quan trng ca kim sot d n l:",options:[{id:"A",text:"m bo d n c thc hin ng k hoch, ng thi gian v ngn sch."},{id:"B",text:"Tng doanh thu, gim chi ph v m rng th trng."},{id:"C",text:"Gim bt cc bc trin khai v ti gin nhn s."},{id:"D",text:"m bo tt c yu cu k thut u c vit bng ti liu."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:72,question:"Gim st d n l qu trnh:",options:[{id:"A",text:"Pht trin cc tnh nng mi theo yu cu khch hng."},{id:"B",text:"Theo di, kim tra tin  v cht lng cng vic so vi k hoch."},{id:"C",text:"Kim th phn mm v sa li sau trin khai."},{id:"D",text:"nh gi tng kt khi d n  hon thnh."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:73,question:"Ai l ngi chu trch nhim gim st chi tit cc cng on k thut trong d n?",options:[{id:"A",text:"Ph gim c iu hnh (PG iu hnh)."},{id:"B",text:"Gim c d n (G d n)."},{id:"C",text:"Khch hng s dng phn mm."},{id:"D",text:"Ban ch o cp trn ca d n."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:74,question:"Theo ti liu, gim st d n t pha khch hng c  ngha g?",options:[{id:"A",text:"Gip khch hng nm tin , cht lng v chi ph  m bo quyn li."},{id:"B",text:"Gip nh ti tr kim sot ngun vn u t hiu qu hn."},{id:"C",text:"Gip ban ch o theo di hiu sut lm vic ca nhn vin."},{id:"D",text:"Gip nhm k thut pht trin thm cc chc nng b sung."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:75,question:"Khi d n b ko di thi hn, ngi qun l cn lm g trc tin?",options:[{id:"A",text:"B sung nhn lc v yu cu lm thm gi."},{id:"B",text:"Gim phm vi d n  rt ngn thi gian."},{id:"C",text:"Kim tra nguyn nhn, xc nh cng vic gng v iu chnh k hoch."},{id:"D",text:"Tm dng d n  nh gi li ton b k hoch."}],correctAnswer:"C",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:76,question:"Trong kim sot chi ph, gi tr phn vic  thc hin (EV) th hin iu g?",options:[{id:"A",text:"Tng chi ph  chi tr tnh n thi im hin ti."},{id:"B",text:"Gi tr cng vic hon thnh theo ngn sch d kin."},{id:"C",text:"Khon chi ph pht sinh vt ngoi k hoch."},{id:"D",text:"Li nhun d kin thu c sau khi bn giao d n."}],correctAnswer:"B",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:77,question:"Ngi qun l nn pht hin vn  ca d n vo giai on no?",options:[{id:"A",text:"Cng sm cng tt, trc khi vn  nh hng n tin  v chi ph."},{id:"B",text:"Sau khi d n kt thc  c s liu chnh xc."},{id:"C",text:"Khi khch hng yu cu bo co chnh thc."},{id:"D",text:"Khi nhm d n hon thnh 50% khi lng cng vic."}],correctAnswer:"A",chapter:5,chapterName:"KIM SOT V GIM ST"},{id:78,question:"Phm vi d n c hiu l g?",options:[{id:"A",text:"Tp hp cc ri ro c th xy ra trong qu trnh thc hin d n."},{id:"B",text:"Danh sch ton b nhng cng vic m d n phi thc hin."},{id:"C",text:"Tp hp cc ngun lc cn thit  hon thnh d n."},{id:"D",text:"Cc ch tiu ti chnh v li nhun ca d n."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:79,question:"Qun l phm vi d n nhm mc ch chnh l g?",options:[{id:"A",text:"Gim thiu ri ro v tng hiu qu vn hnh ca d n."},{id:"B",text:"m bo d n hon thnh ng nhng ni dung  c xc nh."},{id:"C",text:"Duy tr tin  v cn bng chi ph ca d n."},{id:"D",text:"Theo di kt qu v nh gi cht lng sn phm."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:80,question:"Cc kt qu chuyn giao (deliverables) ca d n l:",options:[{id:"A",text:"Cc chi ph  c chi tr cho cc hot ng."},{id:"B",text:"Nhng sn phm hoc kt qu c th m d n phi bn giao."},{id:"C",text:"Nhng cng vic ang trong qu trnh thc hin."},{id:"D",text:"Nhng ti liu hng dn k thut v bo co chi tit."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:81,question:"Tuyn b phm vi (Scope Statement) thng bao gm nhng ni dung no?",options:[{id:"A",text:"Mc tiu ti chnh, thi gian hon thnh v kt qu kim th."},{id:"B",text:"L do d n, m t sn phm, cc sn phm trung gian v tiu ch thnh cng."},{id:"C",text:"Danh sch nhn s, s  PERT v biu  Gantt."},{id:"D",text:"K hoch chi ph, ngun lc v tin  thc hin."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:82,question:"Xc nh phm vi d n l bc nhm:",options:[{id:"A",text:"Chia nh cng vic thnh cc phn chi tit d qun l v kim sot."},{id:"B",text:"Tng hp tt c kt qu ca cc giai on trin khai d n."},{id:"C",text:"Thit lp c ch theo di v nh gi tin ."},{id:"D",text:"Kim tra tnh kh thi ca cc phng n k thut."}],correctAnswer:"A",chapter:6,chapterName:"QUN L PHM VI"},{id:83,question:"Li ch ca vic xc nh phm vi ng n l:",options:[{id:"A",text:"Gip d n linh hot hn khi m rng quy m thc hin."},{id:"B",text:"Gip c lng chnh xc thi gian, chi ph v ti nguyn cn thit."},{id:"C",text:"Gip tit kim ngn sch v gim nhn s trong d n."},{id:"D",text:"Gip tp trung vo giai on cui m khng cn kim sot u vo."}],correctAnswer:"B",chapter:6,chapterName:"QUN L PHM VI"},{id:84,question:"Vn  ph bin khi qun l phm vi d n CNTT l g?",options:[{id:"A",text:"Phm vi b m rng lin tc do thay i yu cu (scope creep)."},{id:"B",text:"Khng xc nh c ngn sch v thi hn c th cho tng cng vic."},{id:"C",text:"Cc thnh vin nhm d n khng c k nng lp k hoch."},{id:"D",text:"Thiu d liu nh gi ri ro trong giai on u d n."}],correctAnswer:"A",chapter:6,chapterName:"QUN L PHM VI"},{id:85,question:" kim sot v hn ch phm vi phnh ra (scope creep), ngi qun l cn:",options:[{id:"A",text:"Cho php thay i ty   m bo s linh hot trong d n."},{id:"B",text:"Tr hon vic cp nht k hoch cho n khi hon thnh giai on chnh."},{id:"C",text:"Xc lp quy trnh kim sot thay i v c ph duyt trc khi thc hin."},{id:"D",text:"Tng thm nhn lc v kinh ph  p ng cc yu cu mi."}],correctAnswer:"C",chapter:6,chapterName:"QUN L PHM VI"},{id:86,question:"Ti sao qun l thi gian d n li quan trng?",options:[{id:"A",text:"V thi gian l yu t d thay i v t nh hng n chi ph."},{id:"B",text:"V tin  d n quyt nh s thnh cng ca sn phm cui cng."},{id:"C",text:"V vic hon thnh ng hn l thch thc ln nht i vi mi d n."},{id:"D",text:"V thi gian c th c iu chnh linh hot trong mi giai on."}],correctAnswer:"C",chapter:7,chapterName:"QUN L THI GIAN"},{id:87,question:"Qun l thi gian d n bao gm hot ng no sau y?",options:[{id:"A",text:"Xc nh hot ng, sp xp th t, c lng v pht trin lch biu."},{id:"B",text:"Ln k hoch chi ph, phn b ngun lc v theo di hiu sut."},{id:"C",text:"Xc nh ri ro, nh gi phm vi v iu chnh nhn s."},{id:"D",text:"Kim sot cht lng, lp bo co v phn tch nng sut."}],correctAnswer:"A",chapter:7,chapterName:"QUN L THI GIAN"},{id:88,question:"Sp xp th t cc hot ng trong d n nhm mc ch g?",options:[{id:"A",text:"Gip xc nh chi ph trung bnh ca tng hng mc."},{id:"B",text:"Gip xc nh quan h ph thuc gia cc hot ng  lp k hoch."},{id:"C",text:"Gip tng tnh linh hot trong qu trnh kim sot d n."},{id:"D",text:"Gip rt ngn thi gian thc hin thng qua lm song song cng vic."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:89,question:"Ph thuc bt buc gia cc hot ng l g?",options:[{id:"A",text:"L s ph thuc c nhm d n quyt nh."},{id:"B",text:"L mi quan h do bn cht k thut ca cng vic quy nh."},{id:"C",text:"L s ph thuc do khch hng hoc nh ti tr t ra."},{id:"D",text:"L mi quan h tm thi do thiu ngun lc thc hin."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:90,question:"Phng php CPM (Critical Path Method) c s dng :",options:[{id:"A",text:"Xc nh ng gng v thi gian hon thnh sm nht ca d n."},{id:"B",text:"Tnh ton chi ph d kin v ngn sch ca tng cng vic."},{id:"C",text:"c lng nhn lc v vt t cn thit cho mi giai on."},{id:"D",text:"nh gi mc  hi lng ca khch hng trong qu trnh thc hin."}],correctAnswer:"A",chapter:7,chapterName:"QUN L THI GIAN"},{id:91,question:"Khi lp lch, iu khin lch biu c ngha l g?",options:[{id:"A",text:"Tnh ton li chi ph d n da trn tin  thc t."},{id:"B",text:"Xy dng k hoch nhn s theo nng lc ca tng c nhn."},{id:"C",text:"Theo di tin , x l sai lch v cp nht li lch biu khi cn."},{id:"D",text:"Dng cc hot ng tr  bo m chi ph khng vt qu d kin."}],correctAnswer:"C",chapter:7,chapterName:"QUN L THI GIAN"},{id:92,question:"Trong phng php PERT, cng thc tnh thi gian k vng l g?",options:[{id:"A",text:"(Thi gian lc quan + 4  Thi gian trung bnh) / 6"},{id:"B",text:"(Thi gian lc quan + 4  Thi gian kh d + Thi gian bi quan) / 6"},{id:"C",text:"(Thi gian bi quan + Thi gian trung bnh) / 2"},{id:"D",text:"(Thi gian thc t + Thi gian d kin) / 2"}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:93,question:"Yu t no gy xung t nhiu nht trong cc d n l g?",options:[{id:"A",text:"Chi ph pht sinh v thay i yu cu khch hng."},{id:"B",text:"Lch biu v tin  cng vic, c bit  giai on cui d n."},{id:"C",text:"Phm vi cng vic khng r rng gia cc b phn."},{id:"D",text:"Thiu thng tin v truyn thng trong nhm d n."}],correctAnswer:"B",chapter:7,chapterName:"QUN L THI GIAN"},{id:94,question:"Qun l chi ph d n l g?",options:[{id:"A",text:"L qu trnh lp k hoch, gim st v phn b ngun lc cho nhn s."},{id:"B",text:"L qu trnh c lng, lp k hoch v kim sot chi ph ca d n."},{id:"C",text:"L hot ng gim st ri ro v kim sot tin  ca d n."},{id:"D",text:"L qu trnh nh gi hiu sut v cht lng ca cc hot ng."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:95,question:"Mc tiu chnh ca qun l chi ph d n l:",options:[{id:"A",text:"m bo d n hon thnh trong gii hn ngn sch  c ph duyt."},{id:"B",text:"Tng doanh thu v ti u ha li nhun cho t chc thc hin."},{id:"C",text:"Duy tr tin  thc hin v hn ch ri ro pht sinh trong d n."},{id:"D",text:"Ti a ha hiu sut s dng nhn lc v vt t ca d n."}],correctAnswer:"A",chapter:8,chapterName:"QUN L CHI PH"},{id:96,question:"Cc quy trnh chnh ca qun l chi ph bao gm:",options:[{id:"A",text:"Lp ngn sch, qun l ri ro v nh gi cht lng sn phm."},{id:"B",text:"c lng ngun lc, o to nhn s v xc nh mc tiu d n."},{id:"C",text:"Lp k hoch ti nguyn, c lng chi ph, d ton v kim sot chi ph."},{id:"D",text:"Tnh ton lng, chi tiu ni b v li nhun sau d n."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:97,question:"Trong qun l chi ph, c lng chi ph c ngha l g?",options:[{id:"A",text:"Xc nh gi bn sn phm cui cng ca d n."},{id:"B",text:"D on chi ph cn thit  hon thnh cc hot ng d n."},{id:"C",text:"Phn tch cc khon chi pht sinh trong giai on kt thc d n."},{id:"D",text:"nh gi mc  hiu qu ca vic s dng ngn sch."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:98,question:"Phng php c lng t di ln (Bottom-up Estimating) l:",options:[{id:"A",text:"c tnh chi ph tng th da trn phm vi cng vic chung."},{id:"B",text:"c lng chi ph chi tit cho tng hng mc ri tng hp li ton d n."},{id:"C",text:"c lng chi ph bng cch ly trung bnh chi ph ca cc nhm."},{id:"D",text:"c lng chi ph theo t l phn trm doanh thu ca d n."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:99,question:"Phng php thng s (Parametric Estimating) c hiu l:",options:[{id:"A",text:"c lng da vo d liu t cc d n khc c quy m tng ng."},{id:"B",text:"c lng da vo kinh nghim thc t ca ngi qun l d n."},{id:"C",text:"c lng da trn cc bin s ton hc phn nh mi quan h chi ph."},{id:"D",text:"c lng bng cch so snh cc bo co ti chnh ca nhiu d n."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:100,question:"Qun l chi ph s dng cng c EMV (Earned Value Management) nhm mc ch:",options:[{id:"A",text:"nh gi mc  hon thnh cng vic thng qua so snh chi ph v tin ."},{id:"B",text:"Theo di cc khon n v doanh thu t hp ng d n."},{id:"C",text:"Tnh ton cc ch tiu ti chnh  nh gi li nhun u t."},{id:"D",text:"Xc nh s lng nhn s cn thit trong tng giai on."}],correctAnswer:"A",chapter:8,chapterName:"QUN L CHI PH"},{id:101,question:"Trong EMV, ch s SPI = EV/PV phn nh iu g?",options:[{id:"A",text:"Hiu sut chi ph so vi gi tr thc t  chi tiu."},{id:"B",text:"Mc  tin   nu SPI < 1 ngha l d n b tr so vi k hoch."},{id:"C",text:"T l gia chi ph d kin v chi ph thc t ca d n."},{id:"D",text:"Hiu qu u t  nu SPI > 1 ngha l li nhun cao hn d kin."}],correctAnswer:"B",chapter:8,chapterName:"QUN L CHI PH"},{id:102,question:" kim sot chi ph hiu qu, ngi qun l d n cn:",options:[{id:"A",text:"Tng ngn sch d n khi chi ph vt k hoch."},{id:"B",text:"Ch iu chnh chi ph vo giai on cui d n."},{id:"C",text:"Gim st chi ph nh k, pht hin sai lch v iu chnh kp thi."},{id:"D",text:"Gim chi ph bng cch ct gim nhn s v trang thit b."}],correctAnswer:"C",chapter:8,chapterName:"QUN L CHI PH"},{id:103,question:"Theo ISO, cht lng c nh ngha l g?",options:[{id:"A",text:"L chi ph u t  m bo sn phm t tiu chun."},{id:"B",text:"L mc  m sn phm p ng cc yu cu  c xc nh."},{id:"C",text:"L kh nng sn phm to ra li nhun cho t chc thc hin."},{id:"D",text:"L mc  ph hp gia sn phm v nhu cu ca khch hng."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:104,question:"Mc tiu c bn ca qun l cht lng trong d n l g?",options:[{id:"A",text:"Tng doanh thu v m rng quy m hot ng ca t chc."},{id:"B",text:"m bo sn phm tho mn yu cu khch hng v tiu chun  ra."},{id:"C",text:"Gim chi ph sn xut  nng cao hiu qu kinh t tng th."},{id:"D",text:"Rt ngn thi gian thc hin m vn m bo hiu sut ti a."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:105,question:"Trong quy trnh qun l cht lng, lp k hoch cht lng l g?",options:[{id:"A",text:"Giai on kim tra cc kt qu u ra ca d n."},{id:"B",text:"Qu trnh xc nh tiu chun v cch thc  m bo sn phm t yu cu."},{id:"C",text:"Hot ng o lng hiu qu v chi ph ca tng cng vic."},{id:"D",text:"Giai on ph duyt kt qu trc khi bn giao cho khch hng."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:106,question:"m bo cht lng (Quality Assurance) tp trung vo:",options:[{id:"A",text:"nh gi quy trnh lm vic nhm m bo sn phm tun th tiu chun."},{id:"B",text:"Sa li k thut v khc phc s c phn mm pht sinh trong d n."},{id:"C",text:"Kim tra kt qu cui cng trc khi giao cho ngi s dng."},{id:"D",text:"Xc nh phm vi d n v o lng hiu qu qun l thi gian."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:107,question:"Kim tra cht lng (Quality Control) c hiu l:",options:[{id:"A",text:"Xem xt chi tit kt qu  xc nh mc  tun th cc tiu chun  t ra."},{id:"B",text:"nh gi kh nng nhn vin trong vic m bo tin  d n."},{id:"C",text:"Kim tra ngn sch v iu chnh chi ph thc hin tng phn vic."},{id:"D",text:"Kim nh mc  hi lng ca khch hng sau khi bn giao sn phm."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:108,question:"Chi ph ngn nga trong qun l cht lng l g?",options:[{id:"A",text:"L chi ph dng  phng trnh sai li trc khi sn phm c to ra."},{id:"B",text:"L chi ph cho vic sa li sau khi sn phm  c bn giao."},{id:"C",text:"L chi ph kim nh cht lng v kim tra ti liu hng dn."},{id:"D",text:"L chi ph pht sinh do khng tun th quy trnh  c ph duyt."}],correctAnswer:"A",chapter:9,chapterName:"QUN L CHT LNG"},{id:109,question:"Yu t quan trng nht  ci tin cht lng l g?",options:[{id:"A",text:"S dng phn mm kim th t ng v cc cng c qun l tin tin."},{id:"B",text:"S cam kt v h tr ca lnh o trong vic thc y vn ha cht lng."},{id:"C",text:"Gim thiu thi gian kim th  tit kim chi ph nhn s."},{id:"D",text:"Tng s lng nhn vin  kim sot tt hn qu trnh thc hin."}],correctAnswer:"B",chapter:9,chapterName:"QUN L CHT LNG"},{id:110,question:"Qun l ngun nhn lc d n l g?",options:[{id:"A",text:"L hot ng phn b ngn sch cho cc hot ng k thut ca d n."},{id:"B",text:"L qu trnh t chc, phn cng v gim st con ngi tham gia d n."},{id:"C",text:"L qu trnh xy dng chin lc pht trin sn phm phn mm."},{id:"D",text:"L hot ng lp k hoch chi ph v theo di tin  d n."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:111,question:"Mc tiu chnh ca qun l nhn lc trong d n l:",options:[{id:"A",text:"m bo cc cng vic c giao ng ngi, ng thi im v ng nng lc."},{id:"B",text:"Ti a ha li nhun v gim chi ph lao ng ca d n."},{id:"C",text:"m bo tin  bng cch phn chia khi lng ng u cho mi ngi."},{id:"D",text:"Duy tr tinh thn lm vic v vn ha t chc trong doanh nghip."}],correctAnswer:"A",chapter:10,chapterName:"QUN L NHN LC"},{id:112,question:"Nhn s ca d n bao gm:",options:[{id:"A",text:"Ch nhng ngi tham gia trc tip vo lp trnh v kim th."},{id:"B",text:"Nhng ngi h tr d n  cp qun l hoc hnh chnh."},{id:"C",text:"Tt c c nhn tham gia vo qu trnh thc hin, iu hnh v h tr d n."},{id:"D",text:"Cc nh ti tr v khch hng cung cp ngun vn cho d n."}],correctAnswer:"C",chapter:10,chapterName:"QUN L NHN LC"},{id:113,question:"Trong d n CNTT, G d n c trch nhim g?",options:[{id:"A",text:"Bo co k hoch, gim st tin  v duy tr lin h gia d n v bn ngoi."},{id:"B",text:"Thc hin kim th k thut v m bo cht lng ca phn mm."},{id:"C",text:"Ph trch lp trnh chi tit v x l li trong qu trnh pht trin."},{id:"D",text:"Gim st vic bo tr v vn hnh h thng sau khi bn giao."}],correctAnswer:"A",chapter:10,chapterName:"QUN L NHN LC"},{id:114,question:"Ph Gim c k thut (PG k thut) trong d n c vai tr chnh l:",options:[{id:"A",text:"Qun l ngn sch, hp ng v chi ph nhn cng cho ton d n."},{id:"B",text:"Ch o k thut, gim st tin  v m bo cht lng sn phm."},{id:"C",text:"Qun l khch hng v gii quyt cc vn  truyn thng."},{id:"D",text:"Phn tch yu cu v thit k chc nng ca h thng phn mm."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:115,question:"Theo ti liu, cn b lp trnh c trch nhim g trong d n?",options:[{id:"A",text:" xut yu cu v xc nhn phm vi cng vic ca d n."},{id:"B",text:"Thit k chi tit, lp trnh, kim th v bo co tin  thc hin."},{id:"C",text:"Xy dng ti liu qun l ri ro v nh gi chi ph thc t."},{id:"D",text:"Qun l ngn sch v phn cng cng vic cho cc nhm k thut."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:116,question:"Ngi i din pha khch hng trong d n c nhim v chnh l:",options:[{id:"A",text:"Theo di tin  ti chnh v ph duyt chi ph d n."},{id:"B",text:"Lin h, cung cp d liu v xc nhn cc ti liu k thut."},{id:"C",text:"Tham gia vit m ngun v kim th h thng phn mm."},{id:"D",text:"Gim st vic phn cng nhn s trong i ng pht trin."}],correctAnswer:"B",chapter:10,chapterName:"QUN L NHN LC"},{id:117,question:"Tnh cch quan trng ca ngi qun l d n l g?",options:[{id:"A",text:"Kin nhn, cn thn v ch o theo quy trnh chi tit."},{id:"B",text:"Tp trung tuyt i vo k thut v hn ch tng tc x hi."},{id:"C",text:"Bit giao tip, c t chc, bit lng nghe v c kh nng ra quyt nh."},{id:"D",text:"Cu ton, thch lm vic c lp v khng cn s h tr t ngi khc."}],correctAnswer:"C",chapter:10,chapterName:"QUN L NHN LC"},{id:118,question:"V sao truyn thng ng vai tr quan trng trong qun l d n?",options:[{id:"A",text:"V thng tin c chia s y  gip phi hp hiu qu v trnh sai lch."},{id:"B",text:"V truyn thng gip gim chi ph v rt ngn thi gian d n."},{id:"C",text:"V truyn thng gip kim sot cht lng k thut ca sn phm."},{id:"D",text:"V truyn thng gip xc nh vai tr ca cc thnh vin d n."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:119,question:"Qun l truyn thng trong d n bao gm cc qu trnh no?",options:[{id:"A",text:"Phn tch ri ro, iu phi ti nguyn v nh gi kt qu."},{id:"B",text:"Lp k hoch truyn thng, phn phi thng tin, bo co hiu sut v kt thc hnh chnh."},{id:"C",text:"Lp k hoch chi ph, bo co tin  v kim sot thay i."},{id:"D",text:"Phn cng nhn s, t chc hp v nh gi hiu qu cng vic."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:120,question:"K hoch qun l truyn thng l ti liu nhm:",options:[{id:"A",text:"M t yu cu k thut v quy trnh lp bo co ni b."},{id:"B",text:"Xc nh cch thc, ni dung v thi gian chia s thng tin trong d n."},{id:"C",text:"Ghi nhn ton b chi ph lin quan n truyn thng ni b."},{id:"D",text:"Tng hp kt qu d n v lp bo co sau khi hon thnh."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:121,question:"Phn tch cc bn lin quan trong k hoch truyn thng gip:",options:[{id:"A",text:"Xc nh chi ph lin lc v mc  tng tc gia cc b phn."},{id:"B",text:"Xy dng quy trnh gim st hot ng ca tng c nhn trong nhm."},{id:"C",text:"Xc nh nhu cu thng tin v hnh thc truyn t ph hp cho tng i tng."},{id:"D",text:"Xc nh ni dung o to v thi im hun luyn nhn vin mi."}],correctAnswer:"C",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:122,question:"Phn phi thng tin trong qun l truyn thng c ngha l:",options:[{id:"A",text:"Cung cp thng tin ng ngi, ng thi im v ng nh dng yu cu."},{id:"B",text:"Gi bo co nh k n lnh o cp cao  ph duyt ngn sch."},{id:"C",text:"To iu kin  cc bn tho lun v chnh sa yu cu d n."},{id:"D",text:"Tng hp d liu k thut v truyn t qua cc phng tin s."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:123,question:"Bo co hiu sut (Performance Reporting) c vai tr g trong d n?",options:[{id:"A",text:"Gip cc bn nm c tnh hnh s dng ti nguyn v tin  t c."},{id:"B",text:"Gip khch hng xem xt cc thay i trong thit k h thng phn mm."},{id:"C",text:"Gip i ng k thut kim tra li v iu chnh chng trnh."},{id:"D",text:"Gip nh qun l xc nh chi ph pht sinh trong tng giai on."}],correctAnswer:"A",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:124,question:"Giai on kt thc hnh chnh trong qun l truyn thng nhm mc ch:",options:[{id:"A",text:"Lu tr cc bo co ti chnh v h s k thut ca d n."},{id:"B",text:"To v lu h s chnh thc, chp nhn kt qu v rt ra bi hc kinh nghim."},{id:"C",text:"Gii quyt cc tranh chp hp ng v thanh ton cc khon chi ph."},{id:"D",text:"Cp nht d liu khch hng v thng tin phn mm sau trin khai."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:125,question:"Yu t no gip ci thin hiu qu truyn thng trong nhm d n?",options:[{id:"A",text:"Tng cng gim st  gim sai st khi truyn t thng tin."},{id:"B",text:"Lng nghe tch cc, phn hi kp thi v m bo thng tin hai chiu."},{id:"C",text:"Gii hn s lng knh lin lc  trnh trng lp d liu."},{id:"D",text:"Tp trung s dng vn bn thay v giao tip trc tip."}],correctAnswer:"B",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:126,question:" t chc cuc hp d n hiu qu, ngi ch tr cn:",options:[{id:"A",text:"M rng thi gian hp  mi ngi c pht biu  kin y ."},{id:"B",text:"Ch nh mt ngi ghi chp v mt ngi iu hnh  tit kim thi gian."},{id:"C",text:"Xc nh mc tiu, ni dung, ngi tham d v chun b ti liu trc khi hp."},{id:"D",text:"Tp trung tho lun chi tit k thut thay v cc vn  tng th."}],correctAnswer:"C",chapter:11,chapterName:"TRUYN THNG V GIAO TIP"},{id:127,question:"Qun l ri ro trong d n bao gm my bc c bn?",options:[{id:"A",text:"Bn bc: d on, kh b, gim tc ng v kim sot khi xy ra."},{id:"B",text:"Ba bc: phn tch, nh gi v x l ri ro."},{id:"C",text:"Hai bc: xc nh v loi tr ri ro."},{id:"D",text:"Nm bc: phn tch, lp k hoch, theo di, nh gi v bo co."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:128,question:"Trong qun l ri ro, bc u tin cn thc hin l g?",options:[{id:"A",text:"Nhn din v d on cc tnh hung ri ro c th xy ra."},{id:"B",text:"Tnh ton chi ph  khc phc khi ri ro xy ra."},{id:"C",text:"Ln k hoch ti chnh  phng nga ri ro."},{id:"D",text:"nh gi thit hi sau khi ri ro  pht sinh."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:129,question:"Ri ro v nhn s trong d n thng xut pht t nguyn nhn no?",options:[{id:"A",text:"Nhn vin c k nng cao nhng thiu kinh nghim thc t."},{id:"B",text:"Nhn vin khng ph hp, thiu kinh nghim hoc thiu o to."},{id:"C",text:"Nhn vin lm vic qu nng sut dn n mt cn bng tin ."},{id:"D",text:"Nhn vin khng ng  lm thm gi v thiu ng lc."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:130,question:"Ri ro k thut trong d n CNTT thng lin quan n:",options:[{id:"A",text:"S thay i trong t chc hoc m hnh lm vic ca nhm."},{id:"B",text:"Vic la chn sai cng ngh, ngn ng lp trnh hoc phn cng."},{id:"C",text:"S chm tr trong ph duyt ti chnh v k hp ng."},{id:"D",text:"Vic thiu d liu u vo v thng tin v khch hng."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:131,question:"Trong qu trnh nh gi ri ro, hai yu t quan trng cn xem xt l g?",options:[{id:"A",text:"Tc ng v phm vi nh hng ca ri ro."},{id:"B",text:"Xc sut xy ra v mc  tc ng ca ri ro."},{id:"C",text:"Nguyn nhn hnh thnh v chi ph khc phc ri ro."},{id:"D",text:"Mc  quan tm ca lnh o v nhm k thut."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:132,question:"Khi khng th loi b ri ro, ngi qun l nn lm g?",options:[{id:"A",text:"Chuyn giao ri ro cho cc i tc hoc nh ti tr."},{id:"B",text:"Lp k hoch d phng  gim thiu tc ng khi ri ro xy ra."},{id:"C",text:"B qua ri ro  tp trung vo mc tiu chnh ca d n."},{id:"D",text:"Ko di tin  nhm trnh ri ro trong giai on hin ti."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:133,question:"Kh b ri ro trong qun l d n c ngha l g?",options:[{id:"A",text:"Loi tr nguyn nhn gy ri ro hoc thay i iu kin  ri ro khng xy ra."},{id:"B",text:"Gim bt nh hng ca ri ro bng cch phn chia cng vic nh hn."},{id:"C",text:"Chuyn ton b trch nhim cho b phn kim sot ni b."},{id:"D",text:"Gim thi gian thc hin  ri ro khng kp pht sinh."}],correctAnswer:"A",chapter:12,chapterName:"QUN L RI RO"},{id:134,question:"Khi mt ri ro  xy ra, hnh ng u tin ca ngi qun l d n l g?",options:[{id:"A",text:"Bo co ngay cho cp trn v ch hng dn x l c th."},{id:"B",text:"nh gi mc  nh hng, kim sot tnh hnh v trin khai bin php ng ph."},{id:"C",text:"Tm dng ton b hot ng cho n khi c hng x l mi."},{id:"D",text:"Ct gim chi ph  b vo thit hi do ri ro gy ra."}],correctAnswer:"B",chapter:12,chapterName:"QUN L RI RO"},{id:135,question:"Qun l tch hp d n c hiu l g?",options:[{id:"A",text:"L qu trnh qun l ti chnh, nhn s v truyn thng trong d n."},{id:"B",text:"L vic phi hp tt c cc lnh vc kin thc  m bo d n thng nht."},{id:"C",text:"L hot ng tng hp d liu, bo co v lu tr ti liu ca d n."},{id:"D",text:"L cng tc kt ni gia cc nh ti tr v i ng k thut trong d n."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:136,question:"Qun l tch hp d n gip nh qun l t c iu g?",options:[{id:"A",text:"Ti u ha hiu qu ca tng b phn ring bit trong d n."},{id:"B",text:"m bo cc quy trnh d n phi hp nhp nhng v ng b vi nhau."},{id:"C",text:"Gim thiu chi ph vn hnh v s lng nhn s trong nhm d n."},{id:"D",text:"Gii hn phm vi cng vic  rt ngn tin  d n."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:137,question:"Cc quy trnh chnh ca qun l tch hp bao gm:",options:[{id:"A",text:"Phn b ti nguyn, kim sot ri ro v kt thc d n."},{id:"B",text:"Pht trin k hoch, thc thi k hoch v iu khin thay i tch hp."},{id:"C",text:"Lp ngn sch, qun l thi gian v theo di tin  cng vic."},{id:"D",text:"nh gi hiu sut, kim tra cht lng v bn giao sn phm."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:138,question:"K hoch d n l ti liu nhm mc ch g?",options:[{id:"A",text:"M t chi tit cc chi ph, li nhun v ri ro ca d n."},{id:"B",text:"Hng dn thc thi d n v nh gi tnh trng thc hin so vi mc tiu."},{id:"C",text:"Ghi li danh sch nhn s, c cu t chc v quy trnh kim th."},{id:"D",text:"Thng k ti nguyn v thi gian s dng trong sut qu trnh lm vic."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:139,question:"Mt k hoch d n hiu qu cn c c im no sau y?",options:[{id:"A",text:"C nh, khng thay i trong sut vng i d n."},{id:"B",text:"Ch tp trung vo cc yu t k thut ca d n."},{id:"C",text:"Mang tnh linh hot, c th cp nht v iu chnh khi c thay i."},{id:"D",text:"Ch do gim c d n bin son m khng cn s tham gia ca nhm."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"},{id:140,question:"Thc thi k hoch d n (Project Execution) l giai on nhm:",options:[{id:"A",text:"nh gi cc ri ro v tnh ton chi ph cho ton b d n."},{id:"B",text:"Qun l v thc hin cc cng vic c m t trong k hoch d n."},{id:"C",text:"Lu tr d liu v lp bo co tng hp kt qu thc hin."},{id:"D",text:"Kim tra v nghim thu sn phm trc khi bn giao cho khch hng."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:141,question:"iu khin thay i tch hp (Integrated Change Control) c mc tiu l:",options:[{id:"A",text:"nh gi nng sut ca nhn vin trong qu trnh thc hin d n."},{id:"B",text:"To iu kin cho cc nhm t do thay i quy trnh khi cn thit."},{id:"C",text:"Phi hp v qun l mi thay i trong phm vi v mc tiu ca d n."},{id:"D",text:"Hn ch s tham gia ca cc bn lin quan khi thay i d n."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"},{id:142,question:"V sao qun l thay i tch hp li quan trng trong d n CNTT?",options:[{id:"A",text:"V khch hng thng xuyn thay i yu cu k thut trong qu trnh thc hin."},{id:"B",text:"V cc yu t phm vi, chi ph v thi gian lun c th b tc ng ln nhau."},{id:"C",text:"V nhm d n thng khng tun th quy trnh khi thay i nhim v."},{id:"D",text:"V vic thay i lun gip d n t kt qu nhanh v hiu qu hn."}],correctAnswer:"B",chapter:13,chapterName:"QUN L TCH HP"},{id:143,question:"Yu t ct li gip vic qun l tch hp d n thnh cng l g?",options:[{id:"A",text:"Cu trc t chc phc tp v h thng bo co a tng."},{id:"B",text:"S dng cc cng c phn mm tin tin  kim sot tin ."},{id:"C",text:"Duy tr giao tip hiu qu v s phi hp cht ch gia cc bn lin quan."},{id:"D",text:"Tp trung vo cc ch tiu ti chnh v li nhun ca d n."}],correctAnswer:"C",chapter:13,chapterName:"QUN L TCH HP"}],Dx={chapters:h6,questions:u6};function ah(e){const t=[...e];for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t}const ds=Zu((e,t)=>({chapters:[],questions:[],currentChapter:null,currentQuestions:[],currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"chapter",timeLimit:null,maxWrong:null,loadQuiz:()=>{const n=Dx;e({chapters:n.chapters,questions:n.questions})},selectChapter:n=>{const{questions:i}=t(),r=ah(i.filter(s=>s.chapter===n));e({currentChapter:n,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"chapter",timeLimit:null,maxWrong:null})},startRandomQuiz:(n=20)=>{const{questions:i}=t(),r=ah(i).slice(0,n);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"random",timeLimit:null,maxWrong:null})},startAllQuiz:()=>{const{questions:n}=t();e({currentChapter:null,currentQuestions:ah(n),currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"all",timeLimit:null,maxWrong:null})},startTimeAttack:n=>{const{questions:i}=t(),r=ah(i).slice(0,10);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"timeattack",timeLimit:n,maxWrong:null})},startSurvival:n=>{const{questions:i}=t(),r=ah(i).slice(0,10);e({currentChapter:null,currentQuestions:r,currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0,quizMode:"survival",timeLimit:null,maxWrong:n})},selectAnswer:n=>{const{isAnswered:i,currentQuestions:r,currentIndex:s}=t();if(i)return;const o=r[s],a=n===o.correctAnswer;e(c=>({selectedAnswer:n,isAnswered:!0,score:c.score+(a?10:0),correctCount:c.correctCount+(a?1:0),wrongCount:c.wrongCount+(a?0:1)}))},nextQuestion:()=>{e(n=>({currentIndex:n.currentIndex+1,selectedAnswer:null,isAnswered:!1}))},resetQuiz:()=>{e({currentChapter:null,currentQuestions:[],currentIndex:0,selectedAnswer:null,isAnswered:!1,score:0,correctCount:0,wrongCount:0})},getChapterQuestions:n=>{const{questions:i}=t();return i.filter(r=>r.chapter===n)}})),d6=()=>{};var $k={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rt=function(e,t){if(!e)throw bl(t)},bl=function(e){return new Error("Firebase Database ("+PM.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},g6=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=e[n++],o=e[n++],a=e[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(c&1023))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},cw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const s=e[r],o=r+1<e.length,a=o?e[r+1]:0,c=r+2<e.length,h=c?e[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let f=(a&15)<<2|h>>6,v=h&63;c||(v=64,o||(f=64)),i.push(n[u],n[d],n[f],n[v])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(MM(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):g6(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const s=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const h=r<e.length?n[e.charAt(r)]:64;++r;const d=r<e.length?n[e.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new f6;const f=s<<2|a>>4;if(i.push(f),h!==64){const v=a<<4&240|h>>2;if(i.push(v),d!==64){const y=h<<6&192|d;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class f6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DM=function(e){const t=MM(e);return cw.encodeByteArray(t,!0)},Nf=function(e){return DM(e).replace(/\./g,"")},Ef=function(e){try{return cw.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(e){return LM(void 0,e)}function LM(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!p6(n)||(e[n]=LM(e[n],t[n]));return e}function p6(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6=()=>v6().__FIREBASE_DEFAULTS__,x6=()=>{if(typeof process>"u"||typeof $k>"u")return;const e=$k.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},_6=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Ef(e[1]);return t&&JSON.parse(t)},Gm=()=>{try{return d6()||y6()||x6()||_6()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},VM=e=>{var t,n;return(n=(t=Gm())==null?void 0:t.emulatorHosts)==null?void 0:n[e]},lw=e=>{const t=VM(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},qM=()=>{var e;return(e=Gm())==null?void 0:e.config},jM=e=>{var t;return(t=Gm())==null?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $m(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[Nf(JSON.stringify(n)),Nf(JSON.stringify(o)),""].join(".")}const Vh={};function w6(){const e={prod:[],emulator:[]};for(const t of Object.keys(Vh))Vh[t]?e.emulator.push(t):e.prod.push(t);return e}function b6(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let zk=!1;function zm(e,t){if(typeof window>"u"||typeof document>"u"||!Ls(window.location.host)||Vh[e]===t||Vh[e]||zk)return;Vh[e]=t;function n(f){return`__firebase__banner__${f}`}const i="__firebase__banner",s=w6().prod.length>0;function o(){const f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,v){f.setAttribute("width","24"),f.setAttribute("id",v),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function h(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{zk=!0,o()},f}function u(f,v){f.setAttribute("id",v),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=b6(i),v=n("text"),y=document.getElementById(v)||document.createElement("span"),_=n("learnmore"),w=document.getElementById(_)||document.createElement("a"),x=n("preprendIcon"),C=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const k=f.element;a(k),u(w,_);const P=h();c(C,x),k.append(C,y,w,P),document.body.appendChild(k)}s?(y.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fn())}function T6(){var t;const e=(t=Gm())==null?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function C6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FM(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function UM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function k6(){const e=Fn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function N6(){return PM.NODE_ADMIN===!0}function E6(){return!T6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OM(){try{return typeof indexedDB=="object"}catch{return!1}}function BM(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;t(((s=r.error)==null?void 0:s.message)||"")}}catch(n){t(n)}})}function S6(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I6="FirebaseError";class Xi extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=I6,Object.setPrototypeOf(this,Xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oa.prototype.create)}}class Oa{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?A6(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Xi(r,a,i)}}function A6(e,t){return e.replace(R6,(n,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const R6=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(e){return JSON.parse(e)}function gn(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=xu(Ef(s[0])||""),n=xu(Ef(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:i,signature:r}},P6=function(e){const t=GM(e),n=t.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},M6=function(e){const t=GM(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function el(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function Lx(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Sf(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function Eo(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const s=e[r],o=t[r];if(Kk(s)&&Kk(o)){if(!Eo(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function Kk(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(r=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const i=this.W_;if(typeof t=="string")for(let d=0;d<16;d++)i[d]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)i[d]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],h,u;for(let d=0;d<80;d++){d<40?d<20?(h=a^s&(o^a),u=1518500249):(h=s^o^a,u=1859775393):d<60?(h=s&o|a&(s|o),u=2400959708):(h=s^o^a,u=3395469782);const f=(r<<5|r>>>27)+h+c+u+i[d]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=f}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(t,n){if(t==null)return;n===void 0&&(n=t.length);const i=n-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(t,r),r+=this.blockSize;if(typeof t=="string"){for(;r<n;)if(s[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=t[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const t=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)t[i]=this.chain_[r]>>s&255,++i;return t}}function L6(e,t){const n=new V6(e,t);return n.subscribe.bind(n)}class V6{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,i){let r;if(t===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");q6(t,["next","error","complete"])?r=t:r={next:t,error:n,complete:i},r.next===void 0&&(r.next=Fv),r.error===void 0&&(r.error=Fv),r.complete===void 0&&(r.complete=Fv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{n(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function q6(e,t){if(typeof e!="object"||e===null)return!1;for(const n of t)if(n in e&&typeof e[n]=="function")return!0;return!1}function Fv(){}function dw(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,rt(i<e.length,"Surrogate pair missing trail surrogate.");const o=e.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=r&63|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=r&63|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=r&63|128)}return t},Km=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6=1e3,U6=2,O6=4*60*60*1e3,B6=.5;function Wk(e,t=F6,n=U6){const i=t*Math.pow(n,e),r=Math.round(B6*i*(Math.random()-.5)*2);return Math.min(O6,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(e){return e&&e._delegate?e._delegate:e}class Ni{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new Hm;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(t==null?void 0:t.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if($6(t))try{this.getOrInitializeService({instanceIdentifier:na})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=na){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=na){return this.instances.has(t)}getOptions(t=na){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,n){const i=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(i)??new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:H6(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=na){return this.component?this.component.multipleInstances?t:na:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function H6(e){return e===na?void 0:e}function $6(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z6{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new G6(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ht||(Ht={}));const K6={debug:Ht.DEBUG,verbose:Ht.VERBOSE,info:Ht.INFO,warn:Ht.WARN,error:Ht.ERROR,silent:Ht.SILENT},W6=Ht.INFO,Q6={[Ht.DEBUG]:"log",[Ht.VERBOSE]:"log",[Ht.INFO]:"info",[Ht.WARN]:"warn",[Ht.ERROR]:"error"},Y6=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=Q6[t];if(r)console[r](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class td{constructor(t){this.name=t,this._logLevel=W6,this._logHandler=Y6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ht))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?K6[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ht.DEBUG,...t),this._logHandler(this,Ht.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ht.VERBOSE,...t),this._logHandler(this,Ht.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ht.INFO,...t),this._logHandler(this,Ht.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ht.WARN,...t),this._logHandler(this,Ht.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ht.ERROR,...t),this._logHandler(this,Ht.ERROR,...t)}}const J6=(e,t)=>t.some(n=>e instanceof n);let Qk,Yk;function X6(){return Qk||(Qk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z6(){return Yk||(Yk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HM=new WeakMap,Vx=new WeakMap,$M=new WeakMap,Uv=new WeakMap,gw=new WeakMap;function tH(e){const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(yo(e.result)),r()},o=()=>{i(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&HM.set(n,e)}).catch(()=>{}),gw.set(t,e),t}function eH(e){if(Vx.has(e))return;const t=new Promise((n,i)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});Vx.set(e,t)}let qx={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Vx.get(e);if(t==="objectStoreNames")return e.objectStoreNames||$M.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return yo(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function nH(e){qx=e(qx)}function iH(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(Ov(this),t,...n);return $M.set(i,t.sort?t.sort():[t]),yo(i)}:Z6().includes(e)?function(...t){return e.apply(Ov(this),t),yo(HM.get(this))}:function(...t){return yo(e.apply(Ov(this),t))}}function rH(e){return typeof e=="function"?iH(e):(e instanceof IDBTransaction&&eH(e),J6(e,X6())?new Proxy(e,qx):e)}function yo(e){if(e instanceof IDBRequest)return tH(e);if(Uv.has(e))return Uv.get(e);const t=rH(e);return t!==e&&(Uv.set(e,t),gw.set(t,e)),t}const Ov=e=>gw.get(e);function zM(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=yo(o);return i&&o.addEventListener("upgradeneeded",c=>{i(yo(o.result),c.oldVersion,c.newVersion,yo(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const sH=["get","getKey","getAll","getAllKeys","count"],oH=["put","add","delete","clear"],Bv=new Map;function Jk(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Bv.get(t))return Bv.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=oH.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||sH.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[n](...a),r&&c.done]))[0]};return Bv.set(t,s),s}nH(e=>({...e,get:(t,n,i)=>Jk(t,n)||e.get(t,n,i),has:(t,n)=>!!Jk(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aH{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cH(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function cH(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const jx="@firebase/app",Xk="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new td("@firebase/app"),lH="@firebase/app-compat",hH="@firebase/analytics-compat",uH="@firebase/analytics",dH="@firebase/app-check-compat",gH="@firebase/app-check",fH="@firebase/auth",mH="@firebase/auth-compat",pH="@firebase/database",vH="@firebase/data-connect",yH="@firebase/database-compat",xH="@firebase/functions",_H="@firebase/functions-compat",wH="@firebase/installations",bH="@firebase/installations-compat",TH="@firebase/messaging",CH="@firebase/messaging-compat",kH="@firebase/performance",NH="@firebase/performance-compat",EH="@firebase/remote-config",SH="@firebase/remote-config-compat",IH="@firebase/storage",AH="@firebase/storage-compat",RH="@firebase/firestore",PH="@firebase/ai",MH="@firebase/firestore-compat",DH="firebase",LH="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="[DEFAULT]",VH={[jx]:"fire-core",[lH]:"fire-core-compat",[uH]:"fire-analytics",[hH]:"fire-analytics-compat",[gH]:"fire-app-check",[dH]:"fire-app-check-compat",[fH]:"fire-auth",[mH]:"fire-auth-compat",[pH]:"fire-rtdb",[vH]:"fire-data-connect",[yH]:"fire-rtdb-compat",[xH]:"fire-fn",[_H]:"fire-fn-compat",[wH]:"fire-iid",[bH]:"fire-iid-compat",[TH]:"fire-fcm",[CH]:"fire-fcm-compat",[kH]:"fire-perf",[NH]:"fire-perf-compat",[EH]:"fire-rc",[SH]:"fire-rc-compat",[IH]:"fire-gcs",[AH]:"fire-gcs-compat",[RH]:"fire-fst",[MH]:"fire-fst-compat",[PH]:"fire-vertex","fire-js":"fire-js",[DH]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=new Map,qH=new Map,Ux=new Map;function Zk(e,t){try{e.container.addComponent(t)}catch(n){Cs.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Wi(e){const t=e.name;if(Ux.has(t))return Cs.debug(`There were multiple attempts to register component ${t}.`),!1;Ux.set(t,e);for(const n of If.values())Zk(n,e);for(const n of qH.values())Zk(n,e);return!0}function Ba(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Li(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jH={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xo=new Oa("app","Firebase",jH);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{constructor(t,n,i){this._isDeleted=!1,this._options={...t},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw xo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=LH;function KM(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i={name:Fx,automaticDataCollectionEnabled:!0,...t},r=i.name;if(typeof r!="string"||!r)throw xo.create("bad-app-name",{appName:String(r)});if(n||(n=qM()),!n)throw xo.create("no-options");const s=If.get(r);if(s){if(Eo(n,s.options)&&Eo(i,s.config))return s;throw xo.create("duplicate-app",{appName:r})}const o=new z6(r);for(const c of Ux.values())o.addComponent(c);const a=new FH(n,i,o);return If.set(r,a),a}function Wm(e=Fx){const t=If.get(e);if(!t&&e===Fx&&qM())return KM();if(!t)throw xo.create("no-app",{appName:e});return t}function qn(e,t,n){let i=VH[e]??e;n&&(i+=`-${n}`);const r=i.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${t}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Cs.warn(o.join(" "));return}Wi(new Ni(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UH="firebase-heartbeat-database",OH=1,_u="firebase-heartbeat-store";let Gv=null;function WM(){return Gv||(Gv=zM(UH,OH,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(_u)}catch(n){console.warn(n)}}}}).catch(e=>{throw xo.create("idb-open",{originalErrorMessage:e.message})})),Gv}async function BH(e){try{const n=(await WM()).transaction(_u),i=await n.objectStore(_u).get(QM(e));return await n.done,i}catch(t){if(t instanceof Xi)Cs.warn(t.message);else{const n=xo.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(n.message)}}}async function tN(e,t){try{const i=(await WM()).transaction(_u,"readwrite");await i.objectStore(_u).put(t,QM(e)),await i.done}catch(n){if(n instanceof Xi)Cs.warn(n.message);else{const i=xo.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cs.warn(i.message)}}}function QM(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GH=1024,HH=30;class $H{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new KH(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=eN();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>HH){const o=WH(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Cs.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=eN(),{heartbeatsToSend:i,unsentEntries:r}=zH(this._heartbeatsCache.heartbeats),s=Nf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Cs.warn(n),""}}}function eN(){return new Date().toISOString().substring(0,10)}function zH(e,t=GH){const n=[];let i=e.slice();for(const r of e){const s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),nN(n)>t){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),nN(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class KH{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OM()?BM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await BH(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return tN(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return tN(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function nN(e){return Nf(JSON.stringify({version:2,heartbeats:e})).length}function WH(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QH(e){Wi(new Ni("platform-logger",t=>new aH(t),"PRIVATE")),Wi(new Ni("heartbeat",t=>new $H(t),"PRIVATE")),qn(jx,Xk,e),qn(jx,Xk,"esm2020"),qn("fire-js","")}QH("");var iN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _o,YM;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(N,T){function E(){}E.prototype=T.prototype,N.F=T.prototype,N.prototype=new E,N.prototype.constructor=N,N.D=function(R,D,j){for(var L=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)L[lt-2]=arguments[lt];return T.prototype[D].apply(R,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(N,T,E){E||(E=0);const R=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)R[D]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(D=0;D<16;++D)R[D]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=N.g[0],E=N.g[1],D=N.g[2];let j=N.g[3],L;L=T+(j^E&(D^j))+R[0]+3614090360&4294967295,T=E+(L<<7&4294967295|L>>>25),L=j+(D^T&(E^D))+R[1]+3905402710&4294967295,j=T+(L<<12&4294967295|L>>>20),L=D+(E^j&(T^E))+R[2]+606105819&4294967295,D=j+(L<<17&4294967295|L>>>15),L=E+(T^D&(j^T))+R[3]+3250441966&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(j^E&(D^j))+R[4]+4118548399&4294967295,T=E+(L<<7&4294967295|L>>>25),L=j+(D^T&(E^D))+R[5]+1200080426&4294967295,j=T+(L<<12&4294967295|L>>>20),L=D+(E^j&(T^E))+R[6]+2821735955&4294967295,D=j+(L<<17&4294967295|L>>>15),L=E+(T^D&(j^T))+R[7]+4249261313&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(j^E&(D^j))+R[8]+1770035416&4294967295,T=E+(L<<7&4294967295|L>>>25),L=j+(D^T&(E^D))+R[9]+2336552879&4294967295,j=T+(L<<12&4294967295|L>>>20),L=D+(E^j&(T^E))+R[10]+4294925233&4294967295,D=j+(L<<17&4294967295|L>>>15),L=E+(T^D&(j^T))+R[11]+2304563134&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(j^E&(D^j))+R[12]+1804603682&4294967295,T=E+(L<<7&4294967295|L>>>25),L=j+(D^T&(E^D))+R[13]+4254626195&4294967295,j=T+(L<<12&4294967295|L>>>20),L=D+(E^j&(T^E))+R[14]+2792965006&4294967295,D=j+(L<<17&4294967295|L>>>15),L=E+(T^D&(j^T))+R[15]+1236535329&4294967295,E=D+(L<<22&4294967295|L>>>10),L=T+(D^j&(E^D))+R[1]+4129170786&4294967295,T=E+(L<<5&4294967295|L>>>27),L=j+(E^D&(T^E))+R[6]+3225465664&4294967295,j=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(j^T))+R[11]+643717713&4294967295,D=j+(L<<14&4294967295|L>>>18),L=E+(j^T&(D^j))+R[0]+3921069994&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^j&(E^D))+R[5]+3593408605&4294967295,T=E+(L<<5&4294967295|L>>>27),L=j+(E^D&(T^E))+R[10]+38016083&4294967295,j=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(j^T))+R[15]+3634488961&4294967295,D=j+(L<<14&4294967295|L>>>18),L=E+(j^T&(D^j))+R[4]+3889429448&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^j&(E^D))+R[9]+568446438&4294967295,T=E+(L<<5&4294967295|L>>>27),L=j+(E^D&(T^E))+R[14]+3275163606&4294967295,j=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(j^T))+R[3]+4107603335&4294967295,D=j+(L<<14&4294967295|L>>>18),L=E+(j^T&(D^j))+R[8]+1163531501&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(D^j&(E^D))+R[13]+2850285829&4294967295,T=E+(L<<5&4294967295|L>>>27),L=j+(E^D&(T^E))+R[2]+4243563512&4294967295,j=T+(L<<9&4294967295|L>>>23),L=D+(T^E&(j^T))+R[7]+1735328473&4294967295,D=j+(L<<14&4294967295|L>>>18),L=E+(j^T&(D^j))+R[12]+2368359562&4294967295,E=D+(L<<20&4294967295|L>>>12),L=T+(E^D^j)+R[5]+4294588738&4294967295,T=E+(L<<4&4294967295|L>>>28),L=j+(T^E^D)+R[8]+2272392833&4294967295,j=T+(L<<11&4294967295|L>>>21),L=D+(j^T^E)+R[11]+1839030562&4294967295,D=j+(L<<16&4294967295|L>>>16),L=E+(D^j^T)+R[14]+4259657740&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^j)+R[1]+2763975236&4294967295,T=E+(L<<4&4294967295|L>>>28),L=j+(T^E^D)+R[4]+1272893353&4294967295,j=T+(L<<11&4294967295|L>>>21),L=D+(j^T^E)+R[7]+4139469664&4294967295,D=j+(L<<16&4294967295|L>>>16),L=E+(D^j^T)+R[10]+3200236656&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^j)+R[13]+681279174&4294967295,T=E+(L<<4&4294967295|L>>>28),L=j+(T^E^D)+R[0]+3936430074&4294967295,j=T+(L<<11&4294967295|L>>>21),L=D+(j^T^E)+R[3]+3572445317&4294967295,D=j+(L<<16&4294967295|L>>>16),L=E+(D^j^T)+R[6]+76029189&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(E^D^j)+R[9]+3654602809&4294967295,T=E+(L<<4&4294967295|L>>>28),L=j+(T^E^D)+R[12]+3873151461&4294967295,j=T+(L<<11&4294967295|L>>>21),L=D+(j^T^E)+R[15]+530742520&4294967295,D=j+(L<<16&4294967295|L>>>16),L=E+(D^j^T)+R[2]+3299628645&4294967295,E=D+(L<<23&4294967295|L>>>9),L=T+(D^(E|~j))+R[0]+4096336452&4294967295,T=E+(L<<6&4294967295|L>>>26),L=j+(E^(T|~D))+R[7]+1126891415&4294967295,j=T+(L<<10&4294967295|L>>>22),L=D+(T^(j|~E))+R[14]+2878612391&4294967295,D=j+(L<<15&4294967295|L>>>17),L=E+(j^(D|~T))+R[5]+4237533241&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~j))+R[12]+1700485571&4294967295,T=E+(L<<6&4294967295|L>>>26),L=j+(E^(T|~D))+R[3]+2399980690&4294967295,j=T+(L<<10&4294967295|L>>>22),L=D+(T^(j|~E))+R[10]+4293915773&4294967295,D=j+(L<<15&4294967295|L>>>17),L=E+(j^(D|~T))+R[1]+2240044497&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~j))+R[8]+1873313359&4294967295,T=E+(L<<6&4294967295|L>>>26),L=j+(E^(T|~D))+R[15]+4264355552&4294967295,j=T+(L<<10&4294967295|L>>>22),L=D+(T^(j|~E))+R[6]+2734768916&4294967295,D=j+(L<<15&4294967295|L>>>17),L=E+(j^(D|~T))+R[13]+1309151649&4294967295,E=D+(L<<21&4294967295|L>>>11),L=T+(D^(E|~j))+R[4]+4149444226&4294967295,T=E+(L<<6&4294967295|L>>>26),L=j+(E^(T|~D))+R[11]+3174756917&4294967295,j=T+(L<<10&4294967295|L>>>22),L=D+(T^(j|~E))+R[2]+718787259&4294967295,D=j+(L<<15&4294967295|L>>>17),L=E+(j^(D|~T))+R[9]+3951481745&4294967295,N.g[0]=N.g[0]+T&4294967295,N.g[1]=N.g[1]+(D+(L<<21&4294967295|L>>>11))&4294967295,N.g[2]=N.g[2]+D&4294967295,N.g[3]=N.g[3]+j&4294967295}i.prototype.v=function(N,T){T===void 0&&(T=N.length);const E=T-this.blockSize,R=this.C;let D=this.h,j=0;for(;j<T;){if(D==0)for(;j<=E;)r(this,N,j),j+=this.blockSize;if(typeof N=="string"){for(;j<T;)if(R[D++]=N.charCodeAt(j++),D==this.blockSize){r(this,R),D=0;break}}else for(;j<T;)if(R[D++]=N[j++],D==this.blockSize){r(this,R),D=0;break}}this.h=D,this.o+=T},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var T=1;T<N.length-8;++T)N[T]=0;T=this.o*8;for(var E=N.length-8;E<N.length;++E)N[E]=T&255,T/=256;for(this.v(N),N=Array(16),T=0,E=0;E<4;++E)for(let R=0;R<32;R+=8)N[T++]=this.g[E]>>>R&255;return N};function s(N,T){var E=a;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=T(N)}function o(N,T){this.h=T;const E=[];let R=!0;for(let D=N.length-1;D>=0;D--){const j=N[D]|0;R&&j==T||(E[D]=j,R=!1)}this.g=E}var a={};function c(N){return-128<=N&&N<128?s(N,function(T){return new o([T|0],T<0?-1:0)}):new o([N|0],N<0?-1:0)}function h(N){if(isNaN(N)||!isFinite(N))return d;if(N<0)return w(h(-N));const T=[];let E=1;for(let R=0;N>=E;R++)T[R]=N/E|0,E*=4294967296;return new o(T,0)}function u(N,T){if(N.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(N.charAt(0)=="-")return w(u(N.substring(1),T));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=h(Math.pow(T,8));let R=d;for(let j=0;j<N.length;j+=8){var D=Math.min(8,N.length-j);const L=parseInt(N.substring(j,j+D),T);D<8?(D=h(Math.pow(T,D)),R=R.j(D).add(h(L))):(R=R.j(E),R=R.add(h(L)))}return R}var d=c(0),f=c(1),v=c(16777216);e=o.prototype,e.m=function(){if(_(this))return-w(this).m();let N=0,T=1;for(let E=0;E<this.g.length;E++){const R=this.i(E);N+=(R>=0?R:4294967296+R)*T,T*=4294967296}return N},e.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(y(this))return"0";if(_(this))return"-"+w(this).toString(N);const T=h(Math.pow(N,6));var E=this;let R="";for(;;){const D=P(E,T).g;E=x(E,D.j(T));let j=((E.g.length>0?E.g[0]:E.h)>>>0).toString(N);if(E=D,y(E))return j+R;for(;j.length<6;)j="0"+j;R=j+R}},e.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function y(N){if(N.h!=0)return!1;for(let T=0;T<N.g.length;T++)if(N.g[T]!=0)return!1;return!0}function _(N){return N.h==-1}e.l=function(N){return N=x(this,N),_(N)?-1:y(N)?0:1};function w(N){const T=N.g.length,E=[];for(let R=0;R<T;R++)E[R]=~N.g[R];return new o(E,~N.h).add(f)}e.abs=function(){return _(this)?w(this):this},e.add=function(N){const T=Math.max(this.g.length,N.g.length),E=[];let R=0;for(let D=0;D<=T;D++){let j=R+(this.i(D)&65535)+(N.i(D)&65535),L=(j>>>16)+(this.i(D)>>>16)+(N.i(D)>>>16);R=L>>>16,j&=65535,L&=65535,E[D]=L<<16|j}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(N,T){return N.add(w(T))}e.j=function(N){if(y(this)||y(N))return d;if(_(this))return _(N)?w(this).j(w(N)):w(w(this).j(N));if(_(N))return w(this.j(w(N)));if(this.l(v)<0&&N.l(v)<0)return h(this.m()*N.m());const T=this.g.length+N.g.length,E=[];for(var R=0;R<2*T;R++)E[R]=0;for(R=0;R<this.g.length;R++)for(let D=0;D<N.g.length;D++){const j=this.i(R)>>>16,L=this.i(R)&65535,lt=N.i(D)>>>16,dt=N.i(D)&65535;E[2*R+2*D]+=L*dt,C(E,2*R+2*D),E[2*R+2*D+1]+=j*dt,C(E,2*R+2*D+1),E[2*R+2*D+1]+=L*lt,C(E,2*R+2*D+1),E[2*R+2*D+2]+=j*lt,C(E,2*R+2*D+2)}for(N=0;N<T;N++)E[N]=E[2*N+1]<<16|E[2*N];for(N=T;N<2*T;N++)E[N]=0;return new o(E,0)};function C(N,T){for(;(N[T]&65535)!=N[T];)N[T+1]+=N[T]>>>16,N[T]&=65535,T++}function k(N,T){this.g=N,this.h=T}function P(N,T){if(y(T))throw Error("division by zero");if(y(N))return new k(d,d);if(_(N))return T=P(w(N),T),new k(w(T.g),w(T.h));if(_(T))return T=P(N,w(T)),new k(w(T.g),T.h);if(N.g.length>30){if(_(N)||_(T))throw Error("slowDivide_ only works with positive integers.");for(var E=f,R=T;R.l(N)<=0;)E=A(E),R=A(R);var D=M(E,1),j=M(R,1);for(R=M(R,2),E=M(E,2);!y(R);){var L=j.add(R);L.l(N)<=0&&(D=D.add(E),j=L),R=M(R,1),E=M(E,1)}return T=x(N,D.j(T)),new k(D,T)}for(D=d;N.l(T)>=0;){for(E=Math.max(1,Math.floor(N.m()/T.m())),R=Math.ceil(Math.log(E)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),j=h(E),L=j.j(T);_(L)||L.l(N)>0;)E-=R,j=h(E),L=j.j(T);y(j)&&(j=f),D=D.add(j),N=x(N,L)}return new k(D,N)}e.B=function(N){return P(this,N).h},e.and=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)&N.i(R);return new o(E,this.h&N.h)},e.or=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)|N.i(R);return new o(E,this.h|N.h)},e.xor=function(N){const T=Math.max(this.g.length,N.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)^N.i(R);return new o(E,this.h^N.h)};function A(N){const T=N.g.length+1,E=[];for(let R=0;R<T;R++)E[R]=N.i(R)<<1|N.i(R-1)>>>31;return new o(E,N.h)}function M(N,T){const E=T>>5;T%=32;const R=N.g.length-E,D=[];for(let j=0;j<R;j++)D[j]=T>0?N.i(j+E)>>>T|N.i(j+E+1)<<32-T:N.i(j+E);return new o(D,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,YM=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=u,_o=o}).apply(typeof iN<"u"?iN:typeof self<"u"?self:typeof window<"u"?window:{});var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JM,wh,XM,Mg,Ox,ZM,t2,e2;(function(){var e,t=Object.defineProperty;function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zd=="object"&&Zd];for(var b=0;b<p.length;++b){var S=p[b];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function r(p,b){if(b)t:{var S=i;p=p.split(".");for(var V=0;V<p.length-1;V++){var G=p[V];if(!(G in S))break t;S=S[G]}p=p[p.length-1],V=S[p],b=b(V),b!=V&&b!=null&&t(S,p,{configurable:!0,writable:!0,value:b})}}r("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(p){return p||function(b){var S=[],V;for(V in b)Object.prototype.hasOwnProperty.call(b,V)&&S.push([V,b[V]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function c(p,b,S){return p.call.apply(p.bind,arguments)}function h(p,b,S){return h=c,h.apply(null,arguments)}function u(p,b){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function d(p,b){function S(){}S.prototype=b.prototype,p.Z=b.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(V,G,z){for(var ot=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)ot[Ft-2]=arguments[Ft];return b.prototype[G].apply(V,ot)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const b=p.length;if(b>0){const S=Array(b);for(let V=0;V<b;V++)S[V]=p[V];return S}return[]}function y(p,b){for(let V=1;V<arguments.length;V++){const G=arguments[V];var S=typeof G;if(S=S!="object"?S:G?Array.isArray(G)?"array":S:"null",S=="array"||S=="object"&&typeof G.length=="number"){S=p.length||0;const z=G.length||0;p.length=S+z;for(let ot=0;ot<z;ot++)p[S+ot]=G[ot]}else p.push(G)}}class _{constructor(b,S){this.i=b,this.j=S,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function w(p){o.setTimeout(()=>{throw p},0)}function x(){var p=N;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class C{constructor(){this.h=this.g=null}add(b,S){const V=k.get();V.set(b,S),this.h?this.h.next=V:this.g=V,this.h=V}}var k=new _(()=>new P,p=>p.reset());class P{constructor(){this.next=this.g=this.h=null}set(b,S){this.h=b,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let A,M=!1,N=new C,T=()=>{const p=Promise.resolve(void 0);A=()=>{p.then(E)}};function E(){for(var p;p=x();){try{p.h.call(p.g)}catch(S){w(S)}var b=k;b.j(p),b.h<100&&(b.h++,p.next=b.g,b.g=p)}M=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};o.addEventListener("test",S,b),o.removeEventListener("test",S,b)}catch{}return p}();function L(p){return/^[\s\xa0]*$/.test(p)}function lt(p,b){D.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,b)}d(lt,D),lt.prototype.init=function(p,b){const S=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget,b||(S=="mouseover"?b=p.fromElement:S=="mouseout"&&(b=p.toElement)),this.relatedTarget=b,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&lt.Z.h.call(this)},lt.prototype.h=function(){lt.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var dt="closure_listenable_"+(Math.random()*1e6|0),Y=0;function W(p,b,S,V,G){this.listener=p,this.proxy=null,this.src=b,this.type=S,this.capture=!!V,this.ha=G,this.key=++Y,this.da=this.fa=!1}function U(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Q(p,b,S){for(const V in p)b.call(S,p[V],V,p)}function F(p,b){for(const S in p)b.call(void 0,p[S],S,p)}function q(p){const b={};for(const S in p)b[S]=p[S];return b}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(p,b){let S,V;for(let G=1;G<arguments.length;G++){V=arguments[G];for(S in V)p[S]=V[S];for(let z=0;z<$.length;z++)S=$[z],Object.prototype.hasOwnProperty.call(V,S)&&(p[S]=V[S])}}function X(p){this.src=p,this.g={},this.h=0}X.prototype.add=function(p,b,S,V,G){const z=p.toString();p=this.g[z],p||(p=this.g[z]=[],this.h++);const ot=O(p,b,V,G);return ot>-1?(b=p[ot],S||(b.fa=!1)):(b=new W(b,this.src,z,!!V,G),b.fa=S,p.push(b)),b};function tt(p,b){const S=b.type;if(S in p.g){var V=p.g[S],G=Array.prototype.indexOf.call(V,b,void 0),z;(z=G>=0)&&Array.prototype.splice.call(V,G,1),z&&(U(b),p.g[S].length==0&&(delete p.g[S],p.h--))}}function O(p,b,S,V){for(let G=0;G<p.length;++G){const z=p[G];if(!z.da&&z.listener==b&&z.capture==!!S&&z.ha==V)return G}return-1}var B="closure_lm_"+(Math.random()*1e6|0),nt={};function K(p,b,S,V,G){if(Array.isArray(b)){for(let z=0;z<b.length;z++)K(p,b[z],S,V,G);return null}return S=Jt(S),p&&p[dt]?p.J(b,S,a(V)?!!V.capture:!1,G):at(p,b,S,!1,V,G)}function at(p,b,S,V,G,z){if(!b)throw Error("Invalid event type");const ot=a(G)?!!G.capture:!!G;let Ft=Tt(p);if(Ft||(p[B]=Ft=new X(p)),S=Ft.add(b,S,V,ot,z),S.proxy)return S;if(V=ct(),S.proxy=V,V.src=p,V.listener=S,p.addEventListener)j||(G=ot),G===void 0&&(G=!1),p.addEventListener(b.toString(),V,G);else if(p.attachEvent)p.attachEvent(ht(b.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function ct(){function p(S){return b.call(p.src,p.listener,S)}const b=st;return p}function vt(p,b,S,V,G){if(Array.isArray(b))for(var z=0;z<b.length;z++)vt(p,b[z],S,V,G);else V=a(V)?!!V.capture:!!V,S=Jt(S),p&&p[dt]?(p=p.i,z=String(b).toString(),z in p.g&&(b=p.g[z],S=O(b,S,V,G),S>-1&&(U(b[S]),Array.prototype.splice.call(b,S,1),b.length==0&&(delete p.g[z],p.h--)))):p&&(p=Tt(p))&&(b=p.g[b.toString()],p=-1,b&&(p=O(b,S,V,G)),(S=p>-1?b[p]:null)&&Rt(S))}function Rt(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[dt])tt(b.i,p);else{var S=p.type,V=p.proxy;b.removeEventListener?b.removeEventListener(S,V,p.capture):b.detachEvent?b.detachEvent(ht(S),V):b.addListener&&b.removeListener&&b.removeListener(V),(S=Tt(b))?(tt(S,p),S.h==0&&(S.src=null,b[B]=null)):U(p)}}}function ht(p){return p in nt?nt[p]:nt[p]="on"+p}function st(p,b){if(p.da)p=!0;else{b=new lt(b,this);const S=p.listener,V=p.ha||p.src;p.fa&&Rt(p),p=S.call(V,b)}return p}function Tt(p){return p=p[B],p instanceof X?p:null}var Nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Jt(p){return typeof p=="function"?p:(p[Nt]||(p[Nt]=function(b){return p.handleEvent(b)}),p[Nt])}function Et(){R.call(this),this.i=new X(this),this.M=this,this.G=null}d(Et,R),Et.prototype[dt]=!0,Et.prototype.removeEventListener=function(p,b,S,V){vt(this,p,b,S,V)};function Gt(p,b){var S,V=p.G;if(V)for(S=[];V;V=V.G)S.push(V);if(p=p.M,V=b.type||b,typeof b=="string")b=new D(b,p);else if(b instanceof D)b.target=b.target||p;else{var G=b;b=new D(V,p),H(b,G)}G=!0;let z,ot;if(S)for(ot=S.length-1;ot>=0;ot--)z=b.g=S[ot],G=yn(z,V,!0,b)&&G;if(z=b.g=p,G=yn(z,V,!0,b)&&G,G=yn(z,V,!1,b)&&G,S)for(ot=0;ot<S.length;ot++)z=b.g=S[ot],G=yn(z,V,!1,b)&&G}Et.prototype.N=function(){if(Et.Z.N.call(this),this.i){var p=this.i;for(const b in p.g){const S=p.g[b];for(let V=0;V<S.length;V++)U(S[V]);delete p.g[b],p.h--}}this.G=null},Et.prototype.J=function(p,b,S,V){return this.i.add(String(p),b,!1,S,V)},Et.prototype.K=function(p,b,S,V){return this.i.add(String(p),b,!0,S,V)};function yn(p,b,S,V){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();let G=!0;for(let z=0;z<b.length;++z){const ot=b[z];if(ot&&!ot.da&&ot.capture==S){const Ft=ot.listener,Je=ot.ha||ot.src;ot.fa&&tt(p.i,ot),G=Ft.call(Je,V)!==!1&&G}}return G&&!V.defaultPrevented}function oe(p,b){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:o.setTimeout(p,b||0)}function ft(p){p.g=oe(()=>{p.g=null,p.i&&(p.i=!1,ft(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class St extends R{constructor(b,S){super(),this.m=b,this.l=S,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:ft(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(p){R.call(this),this.h=p,this.g={}}d(ae,R);var xn=[];function Jn(p){Q(p.g,function(b,S){this.g.hasOwnProperty(S)&&Rt(b)},p),p.g={}}ae.prototype.N=function(){ae.Z.N.call(this),Jn(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ii=o.JSON.stringify,Xn=o.JSON.parse,Zn=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function Ai(){}function ti(){}var Ri={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fl(){D.call(this,"d")}d(Fl,D);function Qa(){D.call(this,"c")}d(Qa,D);var Sr={},wd=null;function Us(){return wd=wd||new Et}Sr.Ia="serverreachability";function Zi(p){D.call(this,Sr.Ia,p)}d(Zi,D);function Ko(p){const b=Us();Gt(b,new Zi(b))}Sr.STAT_EVENT="statevent";function bd(p,b){D.call(this,Sr.STAT_EVENT,p),this.stat=b}d(bd,D);function sn(p){const b=Us();Gt(b,new bd(b,p))}Sr.Ja="timingevent";function Ul(p,b){D.call(this,Sr.Ja,p),this.size=b}d(Ul,D);function Pt(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},b)}function be(){this.g=!0}be.prototype.ua=function(){this.g=!1};function on(p,b,S,V,G,z){p.info(function(){if(p.g)if(z){var ot="",Ft=z.split("&");for(let ce=0;ce<Ft.length;ce++){var Je=Ft[ce].split("=");if(Je.length>1){const an=Je[0];Je=Je[1];const Ar=an.split("_");ot=Ar.length>=2&&Ar[1]=="type"?ot+(an+"="+Je+"&"):ot+(an+"=redacted&")}}}else ot=null;else ot=z;return"XMLHTTP REQ ("+V+") [attempt "+G+"]: "+b+`
`+S+`
`+ot})}function Un(p,b,S,V,G,z,ot){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+G+"]: "+b+`
`+S+`
`+z+" "+ot})}function tr(p,b,S,V){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+ei(p,S)+(V?" "+V:"")})}function Ye(p,b){p.info(function(){return"TIMEOUT: "+b})}be.prototype.info=function(){};function ei(p,b){if(!p.g)return b;if(!b)return null;try{const z=JSON.parse(b);if(z){for(p=0;p<z.length;p++)if(Array.isArray(z[p])){var S=z[p];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var G=V[0];if(G!="noop"&&G!="stop"&&G!="close")for(let ot=1;ot<V.length;ot++)V[ot]=""}}}}return Ii(z)}catch{return b}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ni={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ii;function Ya(){}d(Ya,Ai),Ya.prototype.g=function(){return new XMLHttpRequest},ii=new Ya;function vi(p){return encodeURIComponent(String(p))}function PT(p){var b=1;p=p.split(":");const S=[];for(;b>0&&p.length;)S.push(p.shift()),b--;return p.length&&S.push(p.join(":")),S}function Os(p,b,S,V){this.j=p,this.i=b,this.l=S,this.S=V||1,this.V=new ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new MT}function MT(){this.i=null,this.g="",this.h=!1}var DT={},Kp={};function Wp(p,b,S){p.M=1,p.A=Cd(Ir(b)),p.u=S,p.R=!0,LT(p,null)}function LT(p,b){p.F=Date.now(),Td(p),p.B=Ir(p.A);var S=p.B,V=p.S;Array.isArray(V)||(V=[String(V)]),WT(S.i,"t",V),p.C=0,S=p.j.L,p.h=new MT,p.g=dC(p.j,S?b:null,!p.u),p.P>0&&(p.O=new St(h(p.Y,p,p.g),p.P)),b=p.V,S=p.g,V=p.ba;var G="readystatechange";Array.isArray(G)||(G&&(xn[0]=G.toString()),G=xn);for(let z=0;z<G.length;z++){const ot=K(S,G[z],V||b.handleEvent,!1,b.h||b);if(!ot)break;b.g[ot.key]=ot}b=p.J?q(p.J):{},p.u?(p.v||(p.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,b)):(p.v="GET",p.g.ea(p.B,p.v,null,b)),Ko(),on(p.i,p.v,p.B,p.l,p.S,p.u)}Os.prototype.ba=function(p){p=p.target;const b=this.O;b&&Hs(p)==3?b.j():this.Y(p)},Os.prototype.Y=function(p){try{if(p==this.g)t:{const Ft=Hs(this.g),Je=this.g.ya(),ce=this.g.ca();if(!(Ft<3)&&(Ft!=3||this.g&&(this.h.h||this.g.la()||eC(this.g)))){this.K||Ft!=4||Je==7||(Je==8||ce<=0?Ko(3):Ko(2)),Qp(this);var b=this.g.ca();this.X=b;var S=B4(this);if(this.o=b==200,Un(this.i,this.v,this.B,this.l,this.S,Ft,b),this.o){if(this.U&&!this.L){e:{if(this.g){var V,G=this.g;if((V=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(V)){var z=V;break e}}z=null}if(p=z)tr(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Yp(this,p);else{this.o=!1,this.m=3,sn(12),Wo(this),Ol(this);break t}}if(this.R){p=!0;let an;for(;!this.K&&this.C<S.length;)if(an=G4(this,S),an==Kp){Ft==4&&(this.m=4,sn(14),p=!1),tr(this.i,this.l,null,"[Incomplete Response]");break}else if(an==DT){this.m=4,sn(15),tr(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else tr(this.i,this.l,an,null),Yp(this,an);if(VT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||S.length!=0||this.h.h||(this.m=1,sn(16),p=!1),this.o=this.o&&p,!p)tr(this.i,this.l,S,"[Invalid Chunked Response]"),Wo(this),Ol(this);else if(S.length>0&&!this.W){this.W=!0;var ot=this.j;ot.g==this&&ot.aa&&!ot.P&&(ot.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),rv(ot),ot.P=!0,sn(11))}}else tr(this.i,this.l,S,null),Yp(this,S);Ft==4&&Wo(this),this.o&&!this.K&&(Ft==4?cC(this.j,this):(this.o=!1,Td(this)))}else i3(this.g),b==400&&S.indexOf("Unknown SID")>0?(this.m=3,sn(12)):(this.m=0,sn(13)),Wo(this),Ol(this)}}}catch{}finally{}};function B4(p){if(!VT(p))return p.g.la();const b=eC(p.g);if(b==="")return"";let S="";const V=b.length,G=Hs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Wo(p),Ol(p),"";p.h.i=new o.TextDecoder}for(let z=0;z<V;z++)p.h.h=!0,S+=p.h.i.decode(b[z],{stream:!(G&&z==V-1)});return b.length=0,p.h.g+=S,p.C=0,p.h.g}function VT(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function G4(p,b){var S=p.C,V=b.indexOf(`
`,S);return V==-1?Kp:(S=Number(b.substring(S,V)),isNaN(S)?DT:(V+=1,V+S>b.length?Kp:(b=b.slice(V,V+S),p.C=V+S,b)))}Os.prototype.cancel=function(){this.K=!0,Wo(this)};function Td(p){p.T=Date.now()+p.H,qT(p,p.H)}function qT(p,b){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Pt(h(p.aa,p),b)}function Qp(p){p.D&&(o.clearTimeout(p.D),p.D=null)}Os.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Ye(this.i,this.B),this.M!=2&&(Ko(),sn(17)),Wo(this),this.m=2,Ol(this)):qT(this,this.T-p)};function Ol(p){p.j.I==0||p.K||cC(p.j,p)}function Wo(p){Qp(p);var b=p.O;b&&typeof b.dispose=="function"&&b.dispose(),p.O=null,Jn(p.V),p.g&&(b=p.g,p.g=null,b.abort(),b.dispose())}function Yp(p,b){try{var S=p.j;if(S.I!=0&&(S.g==p||Jp(S.h,p))){if(!p.L&&Jp(S.h,p)&&S.I==3){try{var V=S.Ba.g.parse(b)}catch{V=null}if(Array.isArray(V)&&V.length==3){var G=V;if(G[0]==0){t:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)Id(S),Ed(S);else break t;iv(S),sn(18)}}else S.xa=G[1],0<S.xa-S.K&&G[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Pt(h(S.Va,S),6e3));UT(S.h)<=1&&S.ta&&(S.ta=void 0)}else Yo(S,11)}else if((p.L||S.g==p)&&Id(S),!L(b))for(G=S.Ba.g.parse(b),b=0;b<G.length;b++){let ce=G[b];const an=ce[0];if(!(an<=S.K))if(S.K=an,ce=ce[1],S.I==2)if(ce[0]=="c"){S.M=ce[1],S.ba=ce[2];const Ar=ce[3];Ar!=null&&(S.ka=Ar,S.j.info("VER="+S.ka));const Jo=ce[4];Jo!=null&&(S.za=Jo,S.j.info("SVER="+S.za));const $s=ce[5];$s!=null&&typeof $s=="number"&&$s>0&&(V=1.5*$s,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const zs=p.g;if(zs){const Rd=zs.g?zs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rd){var z=V.h;z.g||Rd.indexOf("spdy")==-1&&Rd.indexOf("quic")==-1&&Rd.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(Xp(z,z.h),z.h=null))}if(V.G){const sv=zs.g?zs.g.getResponseHeader("X-HTTP-Session-Id"):null;sv&&(V.wa=sv,pe(V.J,V.G,sv))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var ot=p;if(V.na=uC(V,V.L?V.ba:null,V.W),ot.L){OT(V.h,ot);var Ft=ot,Je=V.O;Je&&(Ft.H=Je),Ft.D&&(Qp(Ft),Td(Ft)),V.g=ot}else oC(V);S.i.length>0&&Sd(S)}else ce[0]!="stop"&&ce[0]!="close"||Yo(S,7);else S.I==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?Yo(S,7):nv(S):ce[0]!="noop"&&S.l&&S.l.qa(ce),S.A=0)}}Ko(4)}catch{}}var H4=class{constructor(p,b){this.g=p,this.map=b}};function jT(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function FT(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function UT(p){return p.h?1:p.g?p.g.size:0}function Jp(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function Xp(p,b){p.g?p.g.add(b):p.h=b}function OT(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}jT.prototype.cancel=function(){if(this.i=BT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function BT(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const S of p.g.values())b=b.concat(S.G);return b}return v(p.i)}var GT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $4(p,b){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const V=p[S].indexOf("=");let G,z=null;V>=0?(G=p[S].substring(0,V),z=p[S].substring(V+1)):G=p[S],b(G,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function Bs(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;p instanceof Bs?(this.l=p.l,Bl(this,p.j),this.o=p.o,this.g=p.g,Gl(this,p.u),this.h=p.h,Zp(this,QT(p.i)),this.m=p.m):p&&(b=String(p).match(GT))?(this.l=!1,Bl(this,b[1]||"",!0),this.o=Hl(b[2]||""),this.g=Hl(b[3]||"",!0),Gl(this,b[4]),this.h=Hl(b[5]||"",!0),Zp(this,b[6]||"",!0),this.m=Hl(b[7]||"")):(this.l=!1,this.i=new zl(null,this.l))}Bs.prototype.toString=function(){const p=[];var b=this.j;b&&p.push($l(b,HT,!0),":");var S=this.g;return(S||b=="file")&&(p.push("//"),(b=this.o)&&p.push($l(b,HT,!0),"@"),p.push(vi(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push($l(S,S.charAt(0)=="/"?W4:K4,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",$l(S,Y4)),p.join("")},Bs.prototype.resolve=function(p){const b=Ir(this);let S=!!p.j;S?Bl(b,p.j):S=!!p.o,S?b.o=p.o:S=!!p.g,S?b.g=p.g:S=p.u!=null;var V=p.h;if(S)Gl(b,p.u);else if(S=!!p.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var G=b.h.lastIndexOf("/");G!=-1&&(V=b.h.slice(0,G+1)+V)}if(G=V,G==".."||G==".")V="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){V=G.lastIndexOf("/",0)==0,G=G.split("/");const z=[];for(let ot=0;ot<G.length;){const Ft=G[ot++];Ft=="."?V&&ot==G.length&&z.push(""):Ft==".."?((z.length>1||z.length==1&&z[0]!="")&&z.pop(),V&&ot==G.length&&z.push("")):(z.push(Ft),V=!0)}V=z.join("/")}else V=G}return S?b.h=V:S=p.i.toString()!=="",S?Zp(b,QT(p.i)):S=!!p.m,S&&(b.m=p.m),b};function Ir(p){return new Bs(p)}function Bl(p,b,S){p.j=S?Hl(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function Gl(p,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);p.u=b}else p.u=null}function Zp(p,b,S){b instanceof zl?(p.i=b,J4(p.i,p.l)):(S||(b=$l(b,Q4)),p.i=new zl(b,p.l))}function pe(p,b,S){p.i.set(b,S)}function Cd(p){return pe(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Hl(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function $l(p,b,S){return typeof p=="string"?(p=encodeURI(p).replace(b,z4),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function z4(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var HT=/[#\/\?@]/g,K4=/[#\?:]/g,W4=/[#\?]/g,Q4=/[#\?@]/g,Y4=/#/g;function zl(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function Qo(p){p.g||(p.g=new Map,p.h=0,p.i&&$4(p.i,function(b,S){p.add(decodeURIComponent(b.replace(/\+/g," ")),S)}))}e=zl.prototype,e.add=function(p,b){Qo(this),this.i=null,p=Ja(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(b),this.h+=1,this};function $T(p,b){Qo(p),b=Ja(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function zT(p,b){return Qo(p),b=Ja(p,b),p.g.has(b)}e.forEach=function(p,b){Qo(this),this.g.forEach(function(S,V){S.forEach(function(G){p.call(b,G,V,this)},this)},this)};function KT(p,b){Qo(p);let S=[];if(typeof b=="string")zT(p,b)&&(S=S.concat(p.g.get(Ja(p,b))));else for(p=Array.from(p.g.values()),b=0;b<p.length;b++)S=S.concat(p[b]);return S}e.set=function(p,b){return Qo(this),this.i=null,p=Ja(this,p),zT(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},e.get=function(p,b){return p?(p=KT(this,p),p.length>0?String(p[0]):b):b};function WT(p,b,S){$T(p,b),S.length>0&&(p.i=null,p.g.set(Ja(p,b),v(S)),p.h+=S.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(let V=0;V<b.length;V++){var S=b[V];const G=vi(S);S=KT(this,S);for(let z=0;z<S.length;z++){let ot=G;S[z]!==""&&(ot+="="+vi(S[z])),p.push(ot)}}return this.i=p.join("&")};function QT(p){const b=new zl;return b.i=p.i,p.g&&(b.g=new Map(p.g),b.h=p.h),b}function Ja(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function J4(p,b){b&&!p.j&&(Qo(p),p.i=null,p.g.forEach(function(S,V){const G=V.toLowerCase();V!=G&&($T(this,V),WT(this,G,S))},p)),p.j=b}function X4(p,b){const S=new be;if(o.Image){const V=new Image;V.onload=u(Gs,S,"TestLoadImage: loaded",!0,b,V),V.onerror=u(Gs,S,"TestLoadImage: error",!1,b,V),V.onabort=u(Gs,S,"TestLoadImage: abort",!1,b,V),V.ontimeout=u(Gs,S,"TestLoadImage: timeout",!1,b,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else b(!1)}function Z4(p,b){const S=new be,V=new AbortController,G=setTimeout(()=>{V.abort(),Gs(S,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:V.signal}).then(z=>{clearTimeout(G),z.ok?Gs(S,"TestPingServer: ok",!0,b):Gs(S,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(G),Gs(S,"TestPingServer: error",!1,b)})}function Gs(p,b,S,V,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),V(S)}catch{}}function t3(){this.g=new Zn}function tv(p){this.i=p.Sb||null,this.h=p.ab||!1}d(tv,Ai),tv.prototype.g=function(){return new kd(this.i,this.h)};function kd(p,b){Et.call(this),this.H=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(kd,Et),e=kd.prototype,e.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=b,this.readyState=1,Wl(this)},e.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(b.body=p),(this.H||o).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Kl(this)),this.readyState=0},e.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Wl(this)),this.g&&(this.readyState=3,Wl(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;YT(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function YT(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}e.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?Kl(this):Wl(this),this.readyState==3&&YT(this)}},e.Oa=function(p){this.g&&(this.response=this.responseText=p,Kl(this))},e.Na=function(p){this.g&&(this.response=p,Kl(this))},e.ga=function(){this.g&&Kl(this)};function Kl(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Wl(p)}e.setRequestHeader=function(p,b){this.A.append(p,b)},e.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var S=b.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=b.next();return p.join(`\r
`)};function Wl(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(kd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function JT(p){let b="";return Q(p,function(S,V){b+=V,b+=":",b+=S,b+=`\r
`}),b}function ev(p,b,S){t:{for(V in S){var V=!1;break t}V=!0}V||(S=JT(S),typeof p=="string"?S!=null&&vi(S):pe(p,b,S))}function Pe(p){Et.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Pe,Et);var e3=/^https?$/i,n3=["POST","PUT"];e=Pe.prototype,e.Fa=function(p){this.H=p},e.ea=function(p,b,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ii.g(),this.g.onreadystatechange=f(h(this.Ca,this));try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch(z){XT(this,z);return}if(p=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var G in V)S.set(G,V[G]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const z of V.keys())S.set(z,V.get(z));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(z=>z.toLowerCase()=="content-type"),G=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(n3,b,void 0)>=0)||V||G||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,ot]of S)this.g.setRequestHeader(z,ot);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(z){XT(this,z)}};function XT(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.o=5,ZT(p),Nd(p)}function ZT(p){p.A||(p.A=!0,Gt(p,"complete"),Gt(p,"error"))}e.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Gt(this,"complete"),Gt(this,"abort"),Nd(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nd(this,!0)),Pe.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?tC(this):this.Xa())},e.Xa=function(){tC(this)};function tC(p){if(p.h&&typeof s<"u"){if(p.v&&Hs(p)==4)setTimeout(p.Ca.bind(p),0);else if(Gt(p,"readystatechange"),Hs(p)==4){p.h=!1;try{const z=p.ca();t:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break t;default:b=!1}var S;if(!(S=b)){var V;if(V=z===0){let ot=String(p.D).match(GT)[1]||null;!ot&&o.self&&o.self.location&&(ot=o.self.location.protocol.slice(0,-1)),V=!e3.test(ot?ot.toLowerCase():"")}S=V}if(S)Gt(p,"complete"),Gt(p,"success");else{p.o=6;try{var G=Hs(p)>2?p.g.statusText:""}catch{G=""}p.l=G+" ["+p.ca()+"]",ZT(p)}}finally{Nd(p)}}}}function Nd(p,b){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,b||Gt(p,"ready");try{S.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function Hs(p){return p.g?p.g.readyState:0}e.ca=function(){try{return Hs(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),Xn(b)}};function eC(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function i3(p){const b={};p=(p.g&&Hs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(L(p[V]))continue;var S=PT(p[V]);const G=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const z=b[G]||[];b[G]=z,z.push(S)}F(b,function(V){return V.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ql(p,b,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||b}function nC(p){this.za=0,this.i=[],this.j=new be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ql("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ql("baseRetryDelayMs",5e3,p),this.Za=Ql("retryDelaySeedMs",1e4,p),this.Ta=Ql("forwardChannelMaxRetries",2,p),this.va=Ql("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new jT(p&&p.concurrentRequestLimit),this.Ba=new t3,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=nC.prototype,e.ka=8,e.I=1,e.connect=function(p,b,S,V){sn(0),this.W=p,this.H=b||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=uC(this,null,this.W),Sd(this)};function nv(p){if(iC(p),p.I==3){var b=p.V++,S=Ir(p.J);if(pe(S,"SID",p.M),pe(S,"RID",b),pe(S,"TYPE","terminate"),Yl(p,S),b=new Os(p,p.j,b),b.M=2,b.A=Cd(Ir(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(b.A.toString(),"")}catch{}!S&&o.Image&&(new Image().src=b.A,S=!0),S||(b.g=dC(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Td(b)}hC(p)}function Ed(p){p.g&&(rv(p),p.g.cancel(),p.g=null)}function iC(p){Ed(p),p.v&&(o.clearTimeout(p.v),p.v=null),Id(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Sd(p){if(!FT(p.h)&&!p.m){p.m=!0;var b=p.Ea;A||T(),M||(A(),M=!0),N.add(b,p),p.D=0}}function r3(p,b){return UT(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=b.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Pt(h(p.Ea,p,b),lC(p,p.D)),p.D++,!0)}e.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const G=new Os(this,this.j,p);let z=this.o;if(this.U&&(z?(z=q(z),H(z,this.U)):z=this.U),this.u!==null||this.R||(G.J=z,z=null),this.S)t:{for(var b=0,S=0;S<this.i.length;S++){e:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break e}V=void 0}if(V===void 0)break;if(b+=V,b>4096){b=S;break t}if(b===4096||S===this.i.length-1){b=S+1;break t}}b=1e3}else b=1e3;b=sC(this,G,b),S=Ir(this.J),pe(S,"RID",p),pe(S,"CVER",22),this.G&&pe(S,"X-HTTP-Session-Id",this.G),Yl(this,S),z&&(this.R?b="headers="+vi(JT(z))+"&"+b:this.u&&ev(S,this.u,z)),Xp(this.h,G),this.Ra&&pe(S,"TYPE","init"),this.S?(pe(S,"$req",b),pe(S,"SID","null"),G.U=!0,Wp(G,S,null)):Wp(G,S,b),this.I=2}}else this.I==3&&(p?rC(this,p):this.i.length==0||FT(this.h)||rC(this))};function rC(p,b){var S;b?S=b.l:S=p.V++;const V=Ir(p.J);pe(V,"SID",p.M),pe(V,"RID",S),pe(V,"AID",p.K),Yl(p,V),p.u&&p.o&&ev(V,p.u,p.o),S=new Os(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),b&&(p.i=b.G.concat(p.i)),b=sC(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Xp(p.h,S),Wp(S,V,b)}function Yl(p,b){p.H&&Q(p.H,function(S,V){pe(b,V,S)}),p.l&&Q({},function(S,V){pe(b,V,S)})}function sC(p,b,S){S=Math.min(p.i.length,S);const V=p.l?h(p.l.Ka,p.l,p):null;t:{var G=p.i;let Ft=-1;for(;;){const Je=["count="+S];Ft==-1?S>0?(Ft=G[0].g,Je.push("ofs="+Ft)):Ft=0:Je.push("ofs="+Ft);let ce=!0;for(let an=0;an<S;an++){var z=G[an].g;const Ar=G[an].map;if(z-=Ft,z<0)Ft=Math.max(0,G[an].g-100),ce=!1;else try{z="req"+z+"_"||"";try{var ot=Ar instanceof Map?Ar:Object.entries(Ar);for(const[Jo,$s]of ot){let zs=$s;a($s)&&(zs=Ii($s)),Je.push(z+Jo+"="+encodeURIComponent(zs))}}catch(Jo){throw Je.push(z+"type="+encodeURIComponent("_badmap")),Jo}}catch{V&&V(Ar)}}if(ce){ot=Je.join("&");break t}}ot=void 0}return p=p.i.splice(0,S),b.G=p,ot}function oC(p){if(!p.g&&!p.v){p.Y=1;var b=p.Da;A||T(),M||(A(),M=!0),N.add(b,p),p.A=0}}function iv(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Pt(h(p.Da,p),lC(p,p.A)),p.A++,!0)}e.Da=function(){if(this.v=null,aC(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Pt(h(this.Wa,this),p)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,sn(10),Ed(this),aC(this))};function rv(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function aC(p){p.g=new Os(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var b=Ir(p.na);pe(b,"RID","rpc"),pe(b,"SID",p.M),pe(b,"AID",p.K),pe(b,"CI",p.F?"0":"1"),!p.F&&p.ia&&pe(b,"TO",p.ia),pe(b,"TYPE","xmlhttp"),Yl(p,b),p.u&&p.o&&ev(b,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Cd(Ir(b)),S.u=null,S.R=!0,LT(S,p)}e.Va=function(){this.C!=null&&(this.C=null,Ed(this),iv(this),sn(19))};function Id(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function cC(p,b){var S=null;if(p.g==b){Id(p),rv(p),p.g=null;var V=2}else if(Jp(p.h,b))S=b.G,OT(p.h,b),V=1;else return;if(p.I!=0){if(b.o)if(V==1){S=b.u?b.u.length:0,b=Date.now()-b.F;var G=p.D;V=Us(),Gt(V,new Ul(V,S)),Sd(p)}else oC(p);else if(G=b.m,G==3||G==0&&b.X>0||!(V==1&&r3(p,b)||V==2&&iv(p)))switch(S&&S.length>0&&(b=p.h,b.i=b.i.concat(S)),G){case 1:Yo(p,5);break;case 4:Yo(p,10);break;case 3:Yo(p,6);break;default:Yo(p,2)}}}function lC(p,b){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*b}function Yo(p,b){if(p.j.info("Error code "+b),b==2){var S=h(p.bb,p),V=p.Ua;const G=!V;V=new Bs(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Bl(V,"https"),Cd(V),G?X4(V.toString(),S):Z4(V.toString(),S)}else sn(2);p.I=0,p.l&&p.l.pa(b),hC(p),iC(p)}e.bb=function(p){p?(this.j.info("Successfully pinged google.com"),sn(2)):(this.j.info("Failed to ping google.com"),sn(1))};function hC(p){if(p.I=0,p.ja=[],p.l){const b=BT(p.h);(b.length!=0||p.i.length!=0)&&(y(p.ja,b),y(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function uC(p,b,S){var V=S instanceof Bs?Ir(S):new Bs(S);if(V.g!="")b&&(V.g=b+"."+V.g),Gl(V,V.u);else{var G=o.location;V=G.protocol,b=b?b+"."+G.hostname:G.hostname,G=+G.port;const z=new Bs(null);V&&Bl(z,V),b&&(z.g=b),G&&Gl(z,G),S&&(z.h=S),V=z}return S=p.G,b=p.wa,S&&b&&pe(V,S,b),pe(V,"VER",p.ka),Yl(p,V),V}function dC(p,b,S){if(b&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Aa&&!p.ma?new Pe(new tv({ab:S})):new Pe(p.ma),b.Fa(p.L),b}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function gC(){}e=gC.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Ad(){}Ad.prototype.g=function(p,b){return new yi(p,b)};function yi(p,b){Et.call(this),this.g=new nC(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(p?p["X-WebChannel-Client-Profile"]=b.sa:p={"X-WebChannel-Client-Profile":b.sa}),this.g.U=p,(p=b&&b.Qb)&&!L(p)&&(this.g.u=p),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!L(b)&&(this.g.G=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new Xa(this)}d(yi,Et),yi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yi.prototype.close=function(){nv(this.g)},yi.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=Ii(p),p=S);b.i.push(new H4(b.Ya++,p)),b.I==3&&Sd(b)},yi.prototype.N=function(){this.g.l=null,delete this.j,nv(this.g),delete this.g,yi.Z.N.call(this)};function fC(p){Fl.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){t:{for(const S in b){p=S;break t}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}d(fC,Fl);function mC(){Qa.call(this),this.status=1}d(mC,Qa);function Xa(p){this.g=p}d(Xa,gC),Xa.prototype.ra=function(){Gt(this.g,"a")},Xa.prototype.qa=function(p){Gt(this.g,new fC(p))},Xa.prototype.pa=function(p){Gt(this.g,new mC)},Xa.prototype.oa=function(){Gt(this.g,"b")},Ad.prototype.createWebChannel=Ad.prototype.g,yi.prototype.send=yi.prototype.o,yi.prototype.open=yi.prototype.m,yi.prototype.close=yi.prototype.close,e2=function(){return new Ad},t2=function(){return Us()},ZM=Sr,Ox={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,Mg=ts,ni.COMPLETE="complete",XM=ni,ti.EventType=Ri,Ri.OPEN="a",Ri.CLOSE="b",Ri.ERROR="c",Ri.MESSAGE="d",Et.prototype.listen=Et.prototype.J,wh=ti,Pe.prototype.listenOnce=Pe.prototype.K,Pe.prototype.getLastError=Pe.prototype.Ha,Pe.prototype.getLastErrorCode=Pe.prototype.ya,Pe.prototype.getStatus=Pe.prototype.ca,Pe.prototype.getResponseJson=Pe.prototype.La,Pe.prototype.getResponseText=Pe.prototype.la,Pe.prototype.send=Pe.prototype.ea,Pe.prototype.setWithCredentials=Pe.prototype.Fa,JM=Pe}).apply(typeof Zd<"u"?Zd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}In.UNAUTHENTICATED=new In(null),In.GOOGLE_CREDENTIALS=new In("google-credentials-uid"),In.FIRST_PARTY=new In("first-party-uid"),In.MOCK_USER=new In("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cl="12.8.0";function YH(e){Cl=e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=new td("@firebase/firestore");function nc(){return ka.logLevel}function pt(e,...t){if(ka.logLevel<=Ht.DEBUG){const n=t.map(fw);ka.debug(`Firestore (${Cl}): ${e}`,...n)}}function ks(e,...t){if(ka.logLevel<=Ht.ERROR){const n=t.map(fw);ka.error(`Firestore (${Cl}): ${e}`,...n)}}function Na(e,...t){if(ka.logLevel<=Ht.WARN){const n=t.map(fw);ka.warn(`Firestore (${Cl}): ${e}`,...n)}}function fw(e){if(typeof e=="string")return e;try{return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,n2(e,i,n)}function n2(e,t,n){let i=`FIRESTORE (${Cl}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw ks(i),new Error(i)}function ie(e,t,n,i){let r="Unexpected state";typeof n=="string"?r=n:i=n,e||n2(t,r,i)}function jt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends Xi{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class r2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(In.UNAUTHENTICATED))}shutdown(){}}class JH{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class XH{constructor(t){this.t=t,this.currentUser=In.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){ie(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let s=new gs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gs,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{pt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(pt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gs)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(pt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ie(typeof i.accessToken=="string",31837,{l:i}),new i2(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ie(t===null||typeof t=="string",2055,{h:t}),new In(t)}}class ZH{constructor(t,n,i){this.P=t,this.T=n,this.I=i,this.type="FirstParty",this.user=In.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class t8{constructor(t,n,i){this.P=t,this.T=n,this.I=i}getToken(){return Promise.resolve(new ZH(this.P,this.T,this.I))}start(t,n){t.enqueueRetryable(()=>n(In.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rN{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class e8{constructor(t,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Li(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,n){ie(this.o===void 0,3512);const i=s=>{s.error!=null&&pt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,pt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const r=s=>{pt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):pt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rN(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ie(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new rN(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=n8(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=t.charAt(r[s]%62))}return i}}function Wt(e,t){return e<t?-1:e>t?1:0}function Bx(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const r=e.charAt(i),s=t.charAt(i);if(r!==s)return Hv(r)===Hv(s)?Wt(r,s):Hv(r)?1:-1}return Wt(e.length,t.length)}const i8=55296,r8=57343;function Hv(e){const t=e.charCodeAt(0);return t>=i8&&t<=r8}function nl(e,t,n){return e.length===t.length&&e.every((i,r)=>n(i,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN="__name__";class Dr{constructor(t,n,i){n===void 0?n=0:n>t.length&&It(637,{offset:n,range:t.length}),i===void 0?i=t.length-n:i>t.length-n&&It(1746,{length:i,range:t.length-n}),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Dr.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Dr?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let r=0;r<i;r++){const s=Dr.compareSegments(t.get(r),n.get(r));if(s!==0)return s}return Wt(t.length,n.length)}static compareSegments(t,n){const i=Dr.isNumericId(t),r=Dr.isNumericId(n);return i&&!r?-1:!i&&r?1:i&&r?Dr.extractNumericId(t).compare(Dr.extractNumericId(n)):Bx(t,n)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return _o.fromString(t.substring(4,t.length-2))}}class de extends Dr{construct(t,n,i){return new de(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new ut(J.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new de(n)}static emptyPath(){return new de([])}}const s8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fn extends Dr{construct(t,n,i){return new fn(t,n,i)}static isValidIdentifier(t){return s8.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fn.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sN}static keyField(){return new fn([sN])}static fromServerFormat(t){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new ut(J.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new ut(J.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ut(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new ut(J.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new fn(n)}static emptyPath(){return new fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(t){this.path=t}static fromPath(t){return new Ct(de.fromString(t))}static fromName(t){return new Ct(de.fromString(t).popFirst(5))}static empty(){return new Ct(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&de.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return de.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ct(new de(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(e,t,n){if(!n)throw new ut(J.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function o2(e,t,n,i){if(t===!0&&i===!0)throw new ut(J.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function oN(e){if(!Ct.isDocumentKey(e))throw new ut(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function aN(e){if(Ct.isDocumentKey(e))throw new ut(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function a2(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Ym(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":It(12329,{type:typeof e})}function kr(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ut(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ym(e);throw new ut(J.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function o8(e,t){if(t<=0)throw new ut(J.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(e,t){const n={typeString:e};return t&&(n.value=t),n}function ed(e,t){if(!a2(e))throw new ut(J.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in t)if(t[i]){const r=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){n=`JSON missing required field: '${i}'`;break}const o=e[i];if(r&&typeof o!==r){n=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${i}' field to equal '${s.value}'`;break}}if(n)throw new ut(J.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=-62135596800,lN=1e6;class ge{static now(){return ge.fromMillis(Date.now())}static fromDate(t){return ge.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*lN);return new ge(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new ut(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ut(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<cN)throw new ut(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ut(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/lN}_compareTo(t){return this.seconds===t.seconds?Wt(this.nanoseconds,t.nanoseconds):Wt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ge._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ed(t,ge._jsonSchema))return new ge(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-cN;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ge._jsonSchemaVersion="firestore/timestamp/1.0",ge._jsonSchema={type:We("string",ge._jsonSchemaVersion),seconds:We("number"),nanoseconds:We("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{static fromTimestamp(t){return new Vt(t)}static min(){return new Vt(new ge(0,0))}static max(){return new Vt(new ge(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wu=-1;function a8(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Vt.fromTimestamp(i===1e9?new ge(n+1,0):new ge(n,i));return new So(r,Ct.empty(),t)}function c8(e){return new So(e.readTime,e.key,wu)}class So{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new So(Vt.min(),Ct.empty(),wu)}static max(){return new So(Vt.max(),Ct.empty(),wu)}}function l8(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Ct.comparator(e.documentKey,t.documentKey),n!==0?n:Wt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class u8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(e){if(e.code!==J.FAILED_PRECONDITION||e.message!==h8)throw e;pt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&It(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new Z((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof Z?n:Z.resolve(n)}catch(n){return Z.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):Z.reject(n)}static resolve(t){return new Z((n,i)=>{n(t)})}static reject(t){return new Z((n,i)=>{i(t)})}static waitFor(t){return new Z((n,i)=>{let r=0,s=0,o=!1;t.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},c=>i(c))}),o=!0,s===r&&n()})}static or(t){let n=Z.resolve(!1);for(const i of t)n=n.next(r=>r?Z.resolve(r):i());return n}static forEach(t,n){const i=[];return t.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(t,n){return new Z((i,r)=>{const s=t.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;n(t[h]).next(u=>{o[h]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(t,n){return new Z((i,r)=>{const s=()=>{t()===!0?n().next(()=>{s()},r):i()};s()})}}function d8(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Nl(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Jm.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw=-1;function Xm(e){return e==null}function Af(e){return e===0&&1/e==-1/0}function g8(e){return typeof e=="number"&&Number.isInteger(e)&&!Af(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="";function f8(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=hN(t)),t=m8(e.get(n),t);return hN(t)}function m8(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const s=e.charAt(r);switch(s){case"\0":n+="";break;case c2:n+="";break;default:n+=s}}return n}function hN(e){return e+c2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Bo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function l2(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qe=class Gx{constructor(t,n){this.comparator=t,this.root=n||wo.EMPTY}insert(t,n){return new Gx(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,wo.BLACK,null,null))}remove(t){return new Gx(this.comparator,this.root.remove(t,this.comparator).copy(null,null,wo.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new tg(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new tg(this.root,t,this.comparator,!1)}getReverseIterator(){return new tg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new tg(this.root,t,this.comparator,!0)}},tg=class{constructor(t,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=n?i(t.key,n):1,n&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},wo=class ns{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i??ns.RED,this.left=r??ns.EMPTY,this.right=s??ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,r,s){return new ns(t??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ns.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,r=this;if(n(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(t,r.key)===0){if(r.right.isEmpty())return ns.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw It(43730,{key:this.key,value:this.value});if(this.right.isRed())throw It(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw It(27949);return t+(this.isRed()?0:1)}};wo.EMPTY=null,wo.RED=!0,wo.BLACK=!1;wo.EMPTY=new class{constructor(){this.size=0}get key(){throw It(57766)}get value(){throw It(16141)}get color(){throw It(16727)}get left(){throw It(29726)}get right(){throw It(36894)}copy(t,n,i,r,s){return this}insert(t,n,i){return new wo(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(t){this.comparator=t,this.data=new Qe(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;n(r.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new dN(this.data.getIterator())}getIteratorFrom(t){return new dN(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof rn)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new rn(this.comparator);return n.data=t,n}}class dN{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(t){this.fields=t,t.sort(fn.comparator)}static empty(){return new bi([])}unionWith(t){let n=new rn(fn.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new bi(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return nl(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new h2("Invalid base64 string: "+s):s}}(t);return new pn(n)}static fromUint8Array(t){const n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(t);return new pn(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Wt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pn.EMPTY_BYTE_STRING=new pn("");const p8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Io(e){if(ie(!!e,39018),typeof e=="string"){let t=0;const n=p8.exec(e);if(ie(!!n,46558,{timestamp:e}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Fe(e.seconds),nanos:Fe(e.nanos)}}function Fe(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Ao(e){return typeof e=="string"?pn.fromBase64String(e):pn.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="server_timestamp",d2="__type__",g2="__previous_value__",f2="__local_write_time__";function pw(e){var n,i;return((i=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[d2])==null?void 0:i.stringValue)===u2}function Zm(e){const t=e.mapValue.fields[g2];return pw(t)?Zm(t):t}function bu(e){const t=Io(e.mapValue.fields[f2].timestampValue);return new ge(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{constructor(t,n,i,r,s,o,a,c,h,u,d){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=u,this.apiKey=d}}const Rf="(default)";class il{constructor(t,n){this.projectId=t,this.database=n||Rf}static empty(){return new il("","")}get isDefaultDatabase(){return this.database===Rf}isEqual(t){return t instanceof il&&t.projectId===this.projectId&&t.database===this.database}}function y8(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ut(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new il(e.options.projectId,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="__type__",x8="__max__",eg={mapValue:{}},p2="__vector__",Pf="value";function Ro(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?pw(e)?4:w8(e)?9007199254740991:_8(e)?10:11:It(28295,{value:e})}function Kr(e,t){if(e===t)return!0;const n=Ro(e);if(n!==Ro(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return bu(e).isEqual(bu(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Io(r.timestampValue),a=Io(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,s){return Ao(r.bytesValue).isEqual(Ao(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,s){return Fe(r.geoPointValue.latitude)===Fe(s.geoPointValue.latitude)&&Fe(r.geoPointValue.longitude)===Fe(s.geoPointValue.longitude)}(e,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Fe(r.integerValue)===Fe(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Fe(r.doubleValue),a=Fe(s.doubleValue);return o===a?Af(o)===Af(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return nl(e.arrayValue.values||[],t.arrayValue.values||[],Kr);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(uN(o)!==uN(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Kr(o[c],a[c])))return!1;return!0}(e,t);default:return It(52216,{left:e})}}function Tu(e,t){return(e.values||[]).find(n=>Kr(n,t))!==void 0}function rl(e,t){if(e===t)return 0;const n=Ro(e),i=Ro(t);if(n!==i)return Wt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Wt(e.booleanValue,t.booleanValue);case 2:return function(s,o){const a=Fe(s.integerValue||s.doubleValue),c=Fe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(e,t);case 3:return gN(e.timestampValue,t.timestampValue);case 4:return gN(bu(e),bu(t));case 5:return Bx(e.stringValue,t.stringValue);case 6:return function(s,o){const a=Ao(s),c=Ao(o);return a.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const u=Wt(a[h],c[h]);if(u!==0)return u}return Wt(a.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const a=Wt(Fe(s.latitude),Fe(o.latitude));return a!==0?a:Wt(Fe(s.longitude),Fe(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return fN(e.arrayValue,t.arrayValue);case 10:return function(s,o){var f,v,y,_;const a=s.fields||{},c=o.fields||{},h=(f=a[Pf])==null?void 0:f.arrayValue,u=(v=c[Pf])==null?void 0:v.arrayValue,d=Wt(((y=h==null?void 0:h.values)==null?void 0:y.length)||0,((_=u==null?void 0:u.values)==null?void 0:_.length)||0);return d!==0?d:fN(h,u)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===eg.mapValue&&o===eg.mapValue)return 0;if(s===eg.mapValue)return 1;if(o===eg.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},u=Object.keys(h);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=Bx(c[d],u[d]);if(f!==0)return f;const v=rl(a[c[d]],h[u[d]]);if(v!==0)return v}return Wt(c.length,u.length)}(e.mapValue,t.mapValue);default:throw It(23264,{he:n})}}function gN(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Wt(e,t);const n=Io(e),i=Io(t),r=Wt(n.seconds,i.seconds);return r!==0?r:Wt(n.nanos,i.nanos)}function fN(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const s=rl(n[r],i[r]);if(s)return s}return Wt(n.length,i.length)}function sl(e){return Hx(e)}function Hx(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=Io(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Ao(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Ct.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",r=!0;for(const s of n.values||[])r?r=!1:i+=",",i+=Hx(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${Hx(n.fields[o])}`;return r+"}"}(e.mapValue):It(61005,{value:e})}function Dg(e){switch(Ro(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Zm(e);return t?16+Dg(t):16;case 5:return 2*e.stringValue.length;case 6:return Ao(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+Dg(s),0)}(e.arrayValue);case 10:case 11:return function(i){let r=0;return Bo(i.fields,(s,o)=>{r+=s.length+Dg(o)}),r}(e.mapValue);default:throw It(13486,{value:e})}}function mN(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function $x(e){return!!e&&"integerValue"in e}function vw(e){return!!e&&"arrayValue"in e}function pN(e){return!!e&&"nullValue"in e}function vN(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Lg(e){return!!e&&"mapValue"in e}function _8(e){var n,i;return((i=(((n=e==null?void 0:e.mapValue)==null?void 0:n.fields)||{})[m2])==null?void 0:i.stringValue)===p2}function qh(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Bo(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=qh(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=qh(e.arrayValue.values[n]);return t}return{...e}}function w8(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===x8}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(t){this.value=t}static empty(){return new ci({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!Lg(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=qh(n)}setAll(t){let n=fn.emptyPath(),i={},r=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=qh(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(t){const n=this.field(t.popLast());Lg(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Kr(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=n.mapValue.fields[t.get(i)];Lg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(t,n,i){Bo(n,(r,s)=>t[r]=s);for(const r of i)delete t[r]}clone(){return new ci(qh(this.value))}}function v2(e){const t=[];return Bo(e.fields,(n,i)=>{const r=new fn([n]);if(Lg(i)){const s=v2(i.mapValue).fields;if(s.length===0)t.push(r);else for(const o of s)t.push(r.child(o))}else t.push(r)}),new bi(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(t,n,i,r,s,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Pn(t,0,Vt.min(),Vt.min(),Vt.min(),ci.empty(),0)}static newFoundDocument(t,n,i,r){return new Pn(t,1,n,Vt.min(),i,r,0)}static newNoDocument(t,n){return new Pn(t,2,n,Vt.min(),Vt.min(),ci.empty(),0)}static newUnknownDocument(t,n){return new Pn(t,3,n,Vt.min(),Vt.min(),ci.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ci.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ci.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Pn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(t,n){this.position=t,this.inclusive=n}}function yN(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(s.field.isKeyField()?i=Ct.comparator(Ct.fromName(o.referenceValue),n.key):i=rl(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function xN(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Kr(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(t,n="asc"){this.field=t,this.dir=n}}function b8(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{}class Ke extends y2{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new C8(t,n,i):n==="array-contains"?new E8(t,i):n==="in"?new S8(t,i):n==="not-in"?new I8(t,i):n==="array-contains-any"?new A8(t,i):new Ke(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new k8(t,i):new N8(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(rl(n,this.value)):n!==null&&Ro(this.value)===Ro(n)&&this.matchesComparison(rl(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return It(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Nr extends y2{constructor(t,n){super(),this.filters=t,this.op=n,this.Pe=null}static create(t,n){return new Nr(t,n)}matches(t){return x2(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function x2(e){return e.op==="and"}function _2(e){return T8(e)&&x2(e)}function T8(e){for(const t of e.filters)if(t instanceof Nr)return!1;return!0}function zx(e){if(e instanceof Ke)return e.field.canonicalString()+e.op.toString()+sl(e.value);if(_2(e))return e.filters.map(t=>zx(t)).join(",");{const t=e.filters.map(n=>zx(n)).join(",");return`${e.op}(${t})`}}function w2(e,t){return e instanceof Ke?function(i,r){return r instanceof Ke&&i.op===r.op&&i.field.isEqual(r.field)&&Kr(i.value,r.value)}(e,t):e instanceof Nr?function(i,r){return r instanceof Nr&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&w2(o,r.filters[a]),!0):!1}(e,t):void It(19439)}function b2(e){return e instanceof Ke?function(n){return`${n.field.canonicalString()} ${n.op} ${sl(n.value)}`}(e):e instanceof Nr?function(n){return n.op.toString()+" {"+n.getFilters().map(b2).join(" ,")+"}"}(e):"Filter"}class C8 extends Ke{constructor(t,n,i){super(t,n,i),this.key=Ct.fromName(i.referenceValue)}matches(t){const n=Ct.comparator(t.key,this.key);return this.matchesComparison(n)}}class k8 extends Ke{constructor(t,n){super(t,"in",n),this.keys=T2("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class N8 extends Ke{constructor(t,n){super(t,"not-in",n),this.keys=T2("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function T2(e,t){var n;return(((n=t.arrayValue)==null?void 0:n.values)||[]).map(i=>Ct.fromName(i.referenceValue))}class E8 extends Ke{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return vw(n)&&Tu(n.arrayValue,this.value)}}class S8 extends Ke{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&Tu(this.value.arrayValue,n)}}class I8 extends Ke{constructor(t,n){super(t,"not-in",n)}matches(t){if(Tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Tu(this.value.arrayValue,n)}}class A8 extends Ke{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!vw(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Tu(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(t,n=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function _N(e,t=null,n=[],i=[],r=null,s=null,o=null){return new R8(e,t,n,i,r,s,o)}function yw(e){const t=jt(e);if(t.Te===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>zx(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Xm(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>sl(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>sl(i)).join(",")),t.Te=n}return t.Te}function xw(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!b8(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!w2(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!xN(e.startAt,t.startAt)&&xN(e.endAt,t.endAt)}function Kx(e){return Ct.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(t,n=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function P8(e,t,n,i,r,s,o,a){return new El(e,t,n,i,r,s,o,a)}function _w(e){return new El(e)}function wN(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function M8(e){return Ct.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}function C2(e){return e.collectionGroup!==null}function jh(e){const t=jt(e);if(t.Ie===null){t.Ie=[];const n=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),n.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new rn(fn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(t).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new Cu(s,i))}),n.has(fn.keyField().canonicalString())||t.Ie.push(new Cu(fn.keyField(),i))}return t.Ie}function Ur(e){const t=jt(e);return t.Ee||(t.Ee=D8(t,jh(e))),t.Ee}function D8(e,t){if(e.limitType==="F")return _N(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Cu(r.field,s)});const n=e.endAt?new Mf(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Mf(e.startAt.position,e.startAt.inclusive):null;return _N(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function Wx(e,t){const n=e.filters.concat([t]);return new El(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function L8(e,t){const n=e.explicitOrderBy.concat([t]);return new El(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function Df(e,t,n){return new El(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function tp(e,t){return xw(Ur(e),Ur(t))&&e.limitType===t.limitType}function k2(e){return`${yw(Ur(e))}|lt:${e.limitType}`}function ic(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>b2(r)).join(", ")}]`),Xm(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>sl(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>sl(r)).join(",")),`Target(${i})`}(Ur(e))}; limitType=${e.limitType})`}function ep(e,t){return t.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Ct.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,r){for(const s of jh(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(e,t)&&function(i,r){return!(i.startAt&&!function(o,a,c){const h=yN(o,a,c);return o.inclusive?h<=0:h<0}(i.startAt,jh(i),r)||i.endAt&&!function(o,a,c){const h=yN(o,a,c);return o.inclusive?h>=0:h>0}(i.endAt,jh(i),r))}(e,t)}function V8(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function N2(e){return(t,n)=>{let i=!1;for(const r of jh(e)){const s=q8(r,t,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function q8(e,t,n){const i=e.field.isKeyField()?Ct.comparator(t.key,n.key):function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?rl(c,h):It(42886)}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return It(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,n]);r.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Bo(this.inner,(n,i)=>{for(const[r,s]of i)t(r,s)})}isEmpty(){return l2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8=new Qe(Ct.comparator);function Ns(){return j8}const E2=new Qe(Ct.comparator);function bh(...e){let t=E2;for(const n of e)t=t.insert(n.key,n);return t}function S2(e){let t=E2;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function la(){return Fh()}function I2(){return Fh()}function Fh(){return new Ga(e=>e.toString(),(e,t)=>e.isEqual(t))}const F8=new Qe(Ct.comparator),U8=new rn(Ct.comparator);function Qt(...e){let t=U8;for(const n of e)t=t.add(n);return t}const O8=new rn(Wt);function B8(){return O8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Af(t)?"-0":t}}function A2(e){return{integerValue:""+e}}function G8(e,t){return g8(t)?A2(t):ww(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(){this._=void 0}}function H8(e,t,n){return e instanceof ku?function(r,s){const o={fields:{[d2]:{stringValue:u2},[f2]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&pw(s)&&(s=Zm(s)),s&&(o.fields[g2]=s),{mapValue:o}}(n,t):e instanceof Nu?P2(e,t):e instanceof Eu?M2(e,t):function(r,s){const o=R2(r,s),a=bN(o)+bN(r.Ae);return $x(o)&&$x(r.Ae)?A2(a):ww(r.serializer,a)}(e,t)}function $8(e,t,n){return e instanceof Nu?P2(e,t):e instanceof Eu?M2(e,t):n}function R2(e,t){return e instanceof Lf?function(i){return $x(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class ku extends np{}class Nu extends np{constructor(t){super(),this.elements=t}}function P2(e,t){const n=D2(t);for(const i of e.elements)n.some(r=>Kr(r,i))||n.push(i);return{arrayValue:{values:n}}}class Eu extends np{constructor(t){super(),this.elements=t}}function M2(e,t){let n=D2(t);for(const i of e.elements)n=n.filter(r=>!Kr(r,i));return{arrayValue:{values:n}}}class Lf extends np{constructor(t,n){super(),this.serializer=t,this.Ae=n}}function bN(e){return Fe(e.integerValue||e.doubleValue)}function D2(e){return vw(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(t,n){this.field=t,this.transform=n}}function K8(e,t){return e.field.isEqual(t.field)&&function(i,r){return i instanceof Nu&&r instanceof Nu||i instanceof Eu&&r instanceof Eu?nl(i.elements,r.elements,Kr):i instanceof Lf&&r instanceof Lf?Kr(i.Ae,r.Ae):i instanceof ku&&r instanceof ku}(e.transform,t.transform)}class W8{constructor(t,n){this.version=t,this.transformResults=n}}class yr{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new yr}static exists(t){return new yr(void 0,t)}static updateTime(t){return new yr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Vg(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class ip{}function L2(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new q2(e.key,yr.none()):new nd(e.key,e.data,yr.none());{const n=e.data,i=ci.empty();let r=new rn(fn.comparator);for(let s of t.fields)if(!r.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Go(e.key,i,new bi(r.toArray()),yr.none())}}function Q8(e,t,n){e instanceof nd?function(r,s,o){const a=r.value.clone(),c=CN(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Go?function(r,s,o){if(!Vg(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=CN(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(V2(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(e,t,n):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Uh(e,t,n,i){return e instanceof nd?function(s,o,a,c){if(!Vg(s.precondition,o))return a;const h=s.value.clone(),u=kN(s.fieldTransforms,c,o);return h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(e,t,n,i):e instanceof Go?function(s,o,a,c){if(!Vg(s.precondition,o))return a;const h=kN(s.fieldTransforms,c,o),u=o.data;return u.setAll(V2(s)),u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,n,i):function(s,o,a){return Vg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function Y8(e,t){let n=null;for(const i of e.fieldTransforms){const r=t.data.field(i.field),s=R2(i.transform,r||null);s!=null&&(n===null&&(n=ci.empty()),n.set(i.field,s))}return n||null}function TN(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&nl(i,r,(s,o)=>K8(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class nd extends ip{constructor(t,n,i,r=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Go extends ip{constructor(t,n,i,r,s=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function V2(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function CN(e,t,n){const i=new Map;ie(e.length===n.length,32656,{Ve:n.length,de:e.length});for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,$8(o,a,n[r]))}return i}function kN(e,t,n){const i=new Map;for(const r of e){const s=r.transform,o=n.data.field(r.field);i.set(r.field,H8(s,o,t))}return i}class q2 extends ip{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class J8 extends ip{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(t,n,i,r){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(t.key)&&Q8(s,t,i[r])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=Uh(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=Uh(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=I2();return this.mutations.forEach(r=>{const s=t.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(r.key)?null:a;const c=L2(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Vt.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Qt())}isEqual(t){return this.batchId===t.batchId&&nl(this.mutations,t.mutations,(n,i)=>TN(n,i))&&nl(this.baseMutations,t.baseMutations,(n,i)=>TN(n,i))}}class bw{constructor(t,n,i,r){this.batch=t,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(t,n,i){ie(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let r=function(){return F8}();const s=t.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new bw(t,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He,Yt;function e$(e){switch(e){case J.OK:return It(64938);case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0;default:return It(15467,{code:e})}}function j2(e){if(e===void 0)return ks("GRPC error has no .code"),J.UNKNOWN;switch(e){case He.OK:return J.OK;case He.CANCELLED:return J.CANCELLED;case He.UNKNOWN:return J.UNKNOWN;case He.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case He.INTERNAL:return J.INTERNAL;case He.UNAVAILABLE:return J.UNAVAILABLE;case He.UNAUTHENTICATED:return J.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case He.NOT_FOUND:return J.NOT_FOUND;case He.ALREADY_EXISTS:return J.ALREADY_EXISTS;case He.PERMISSION_DENIED:return J.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case He.ABORTED:return J.ABORTED;case He.OUT_OF_RANGE:return J.OUT_OF_RANGE;case He.UNIMPLEMENTED:return J.UNIMPLEMENTED;case He.DATA_LOSS:return J.DATA_LOSS;default:return It(39323,{code:e})}}(Yt=He||(He={}))[Yt.OK=0]="OK",Yt[Yt.CANCELLED=1]="CANCELLED",Yt[Yt.UNKNOWN=2]="UNKNOWN",Yt[Yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yt[Yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yt[Yt.NOT_FOUND=5]="NOT_FOUND",Yt[Yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yt[Yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yt[Yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yt[Yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yt[Yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yt[Yt.ABORTED=10]="ABORTED",Yt[Yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yt[Yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yt[Yt.INTERNAL=13]="INTERNAL",Yt[Yt.UNAVAILABLE=14]="UNAVAILABLE",Yt[Yt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n$(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$=new _o([4294967295,4294967295],0);function NN(e){const t=n$().encode(e),n=new YM;return n.update(t),new Uint8Array(n.digest())}function EN(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new _o([n,i],0),new _o([r,s],0)]}class Tw{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Th(`Invalid padding: ${n}`);if(i<0)throw new Th(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Th(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new Th(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*t.length-n,this.pe=_o.fromNumber(this.ge)}ye(t,n,i){let r=t.add(n.multiply(_o.fromNumber(i)));return r.compare(i$)===1&&(r=new _o([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const n=NN(t),[i,r]=EN(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(t,n,i){const r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new Tw(s,r,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.ge===0)return;const n=NN(t),[i,r]=EN(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.be(o)}}be(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class Th extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(t,n,i,r,s){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const r=new Map;return r.set(t,id.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new rp(Vt.min(),r,new Qe(Wt),Ns(),Qt())}}class id{constructor(t,n,i,r,s){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new id(i,n,Qt(),Qt(),Qt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(t,n,i,r){this.Se=t,this.removedTargetIds=n,this.key=i,this.De=r}}class F2{constructor(t,n){this.targetId=t,this.Ce=n}}class U2{constructor(t,n,i=pn.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=r}}class SN{constructor(){this.ve=0,this.Fe=IN(),this.Me=pn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Qt(),n=Qt(),i=Qt();return this.Fe.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:It(38017,{changeType:s})}}),new id(this.Me,this.xe,t,n,i)}Ke(){this.Oe=!1,this.Fe=IN()}qe(t,n){this.Oe=!0,this.Fe=this.Fe.insert(t,n)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class r${constructor(t){this.Ge=t,this.ze=new Map,this.je=Ns(),this.He=ng(),this.Je=ng(),this.Ze=new Qe(Wt)}Xe(t){for(const n of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(n,t.De):this.et(n,t.key,t.De);for(const n of t.removedTargetIds)this.et(n,t.key,t.De)}tt(t){this.forEachTarget(t,n=>{const i=this.nt(n);switch(t.state){case 0:this.rt(n)&&i.Le(t.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(t.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.Qe(),i.Le(t.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(t.resumeToken));break;default:It(56790,{state:t.state})}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.ze.forEach((i,r)=>{this.rt(r)&&n(r)})}st(t){const n=t.targetId,i=t.Ce.count,r=this.ot(n);if(r){const s=r.target;if(Kx(s))if(i===0){const o=new Ct(s.path);this.et(n,o,Pn.newNoDocument(o,Vt.min()))}else ie(i===1,20013,{expectedCount:i});else{const o=this._t(n);if(o!==i){const a=this.ut(t),c=a?this.ct(a,t,o):1;if(c!==0){this.it(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,h)}}}}}ut(t){const n=t.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let o,a;try{o=Ao(i).toUint8Array()}catch(c){if(c instanceof h2)return Na("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Tw(o,r,s)}catch(c){return Na(c instanceof Th?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(t,n,i){return n.Ce.count===i-this.Pt(t,n.targetId)?0:2}Pt(t,n){const i=this.Ge.getRemoteKeysForTarget(n);let r=0;return i.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.et(n,s,null),r++)}),r}Tt(t){const n=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&Kx(a.target)){const c=new Ct(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Pn.newNoDocument(c,t))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let i=Qt();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.je.forEach((s,o)=>o.setReadTime(t));const r=new rp(t,n,this.Ze,this.je,i);return this.je=Ns(),this.He=ng(),this.Je=ng(),this.Ze=new Qe(Wt),r}Ye(t,n){if(!this.rt(t))return;const i=this.Et(t,n.key)?2:0;this.nt(t).qe(n.key,i),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(t)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(t))}et(t,n,i){if(!this.rt(t))return;const r=this.nt(t);this.Et(t,n)?r.qe(n,1):r.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(t)),this.Je=this.Je.insert(n,this.Rt(n).add(t)),i&&(this.je=this.je.insert(n,i))}removeTarget(t){this.ze.delete(t)}_t(t){const n=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let n=this.ze.get(t);return n||(n=new SN,this.ze.set(t,n)),n}Rt(t){let n=this.Je.get(t);return n||(n=new rn(Wt),this.Je=this.Je.insert(t,n)),n}It(t){let n=this.He.get(t);return n||(n=new rn(Wt),this.He=this.He.insert(t,n)),n}rt(t){const n=this.ot(t)!==null;return n||pt("WatchChangeAggregator","Detected inactive target",t),n}ot(t){const n=this.ze.get(t);return n&&n.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new SN),this.Ge.getRemoteKeysForTarget(t).forEach(n=>{this.et(t,n,null)})}Et(t,n){return this.Ge.getRemoteKeysForTarget(t).has(n)}}function ng(){return new Qe(Ct.comparator)}function IN(){return new Qe(Ct.comparator)}const s$={asc:"ASCENDING",desc:"DESCENDING"},o$={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},a$={and:"AND",or:"OR"};class c${constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Qx(e,t){return e.useProto3Json||Xm(t)?t:{value:t}}function Vf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function O2(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function l$(e,t){return Vf(e,t.toTimestamp())}function Or(e){return ie(!!e,49232),Vt.fromTimestamp(function(n){const i=Io(n);return new ge(i.seconds,i.nanos)}(e))}function Cw(e,t){return Yx(e,t).canonicalString()}function Yx(e,t){const n=function(r){return new de(["projects",r.projectId,"databases",r.database])}(e).child("documents");return t===void 0?n:n.child(t)}function B2(e){const t=de.fromString(e);return ie(K2(t),10190,{key:t.toString()}),t}function Jx(e,t){return Cw(e.databaseId,t.path)}function $v(e,t){const n=B2(t);if(n.get(1)!==e.databaseId.projectId)throw new ut(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ut(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ct(H2(n))}function G2(e,t){return Cw(e.databaseId,t)}function h$(e){const t=B2(e);return t.length===4?de.emptyPath():H2(t)}function Xx(e){return new de(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function H2(e){return ie(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function AN(e,t,n){return{name:Jx(e,t),fields:n.value.mapValue.fields}}function u$(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:It(39313,{state:h})}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(h,u){return h.useProto3Json?(ie(u===void 0||typeof u=="string",58123),pn.fromBase64String(u||"")):(ie(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),pn.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(h){const u=h.code===void 0?J.UNKNOWN:j2(h.code);return new ut(u,h.message||"")}(o);n=new U2(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=$v(e,i.document.name),s=Or(i.document.updateTime),o=i.document.createTime?Or(i.document.createTime):Vt.min(),a=new ci({mapValue:{fields:i.document.fields}}),c=Pn.newFoundDocument(r,s,o,a),h=i.targetIds||[],u=i.removedTargetIds||[];n=new qg(h,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=$v(e,i.document),s=i.readTime?Or(i.readTime):Vt.min(),o=Pn.newNoDocument(r,s),a=i.removedTargetIds||[];n=new qg([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=$v(e,i.document),s=i.removedTargetIds||[];n=new qg([],s,r,null)}else{if(!("filter"in t))return It(11601,{Vt:t});{t.filter;const i=t.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new t$(r,s),a=i.targetId;n=new F2(a,o)}}return n}function d$(e,t){let n;if(t instanceof nd)n={update:AN(e,t.key,t.value)};else if(t instanceof q2)n={delete:Jx(e,t.key)};else if(t instanceof Go)n={update:AN(e,t.key,t.data),updateMask:w$(t.fieldMask)};else{if(!(t instanceof J8))return It(16599,{dt:t.type});n={verify:Jx(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof ku)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Nu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Eu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Lf)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw It(20930,{transform:o.transform})}(0,i))),t.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:l$(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:It(27497)}(e,t.precondition)),n}function g$(e,t){return e&&e.length>0?(ie(t!==void 0,14353),e.map(n=>function(r,s){let o=r.updateTime?Or(r.updateTime):Or(s);return o.isEqual(Vt.min())&&(o=Or(s)),new W8(o,r.transformResults||[])}(n,t))):[]}function f$(e,t){return{documents:[G2(e,t.path)]}}function m$(e,t){const n={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=G2(e,r);const s=function(h){if(h.length!==0)return z2(Nr.create(h,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(u=>function(f){return{field:rc(f.field),direction:y$(f.dir)}}(u))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Qx(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(t.endAt)),{ft:n,parent:r}}function p$(e){let t=h$(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ie(i===1,65062);const u=n.from[0];u.allDescendants?r=u.collectionId:t=t.child(u.collectionId)}let s=[];n.where&&(s=function(d){const f=$2(d);return f instanceof Nr&&_2(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(f=>function(y){return new Cu(sc(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Xm(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(d){const f=!!d.before,v=d.values||[];return new Mf(v,f)}(n.startAt));let h=null;return n.endAt&&(h=function(d){const f=!d.before,v=d.values||[];return new Mf(v,f)}(n.endAt)),P8(t,r,o,s,a,"F",c,h)}function v$(e,t){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return It(28987,{purpose:r})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function $2(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=sc(n.unaryFilter.field);return Ke.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=sc(n.unaryFilter.field);return Ke.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=sc(n.unaryFilter.field);return Ke.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=sc(n.unaryFilter.field);return Ke.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return It(61313);default:return It(60726)}}(e):e.fieldFilter!==void 0?function(n){return Ke.create(sc(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return It(58110);default:return It(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Nr.create(n.compositeFilter.filters.map(i=>$2(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return It(1026)}}(n.compositeFilter.op))}(e):It(30097,{filter:e})}function y$(e){return s$[e]}function x$(e){return o$[e]}function _$(e){return a$[e]}function rc(e){return{fieldPath:e.canonicalString()}}function sc(e){return fn.fromServerFormat(e.fieldPath)}function z2(e){return e instanceof Ke?function(n){if(n.op==="=="){if(vN(n.value))return{unaryFilter:{field:rc(n.field),op:"IS_NAN"}};if(pN(n.value))return{unaryFilter:{field:rc(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vN(n.value))return{unaryFilter:{field:rc(n.field),op:"IS_NOT_NAN"}};if(pN(n.value))return{unaryFilter:{field:rc(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rc(n.field),op:x$(n.op),value:n.value}}}(e):e instanceof Nr?function(n){const i=n.getFilters().map(r=>z2(r));return i.length===1?i[0]:{compositeFilter:{op:_$(n.op),filters:i}}}(e):It(54877,{filter:e})}function w$(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function K2(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}function W2(e){return!!e&&typeof e._toProto=="function"&&e._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(t,n,i,r,s=Vt.min(),o=Vt.min(),a=pn.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new ao(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b${constructor(t){this.yt=t}}function T$(e){const t=p$({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Df(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C${constructor(){this.Sn=new k$}addToCollectionParentIndex(t,n){return this.Sn.add(n),Z.resolve()}getCollectionParents(t,n){return Z.resolve(this.Sn.getEntries(n))}addFieldIndex(t,n){return Z.resolve()}deleteFieldIndex(t,n){return Z.resolve()}deleteAllFieldIndexes(t){return Z.resolve()}createTargetIndexes(t,n){return Z.resolve()}getDocumentsMatchingTarget(t,n){return Z.resolve(null)}getIndexType(t,n){return Z.resolve(0)}getFieldIndexes(t,n){return Z.resolve([])}getNextCollectionGroupToUpdate(t){return Z.resolve(null)}getMinOffset(t,n){return Z.resolve(So.min())}getMinOffsetFromCollectionGroup(t,n){return Z.resolve(So.min())}updateCollectionGroup(t,n,i){return Z.resolve()}updateIndexEntries(t,n){return Z.resolve()}}class k${constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n]||new rn(de.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(t){const n=t.lastSegment(),i=t.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(t){return(this.index[t]||new rn(de.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Q2=41943040;class si{static withCacheSize(t){return new si(t,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */si.DEFAULT_COLLECTION_PERCENTILE=10,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,si.DEFAULT=new si(Q2,si.DEFAULT_COLLECTION_PERCENTILE,si.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),si.DISABLED=new si(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new ol(0)}static ar(){return new ol(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN="LruGarbageCollector",N$=1048576;function MN([e,t],[n,i]){const r=Wt(e,n);return r===0?Wt(t,i):r}class E${constructor(t){this.Pr=t,this.buffer=new rn(MN),this.Tr=0}Ir(){return++this.Tr}Er(t){const n=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();MN(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class S${constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){pt(PN,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Nl(n)?pt(PN,"Ignoring IndexedDB error during garbage collection: ",n):await kl(n)}await this.Ar(3e5)})}}class I${constructor(t,n){this.Vr=t,this.params=n}calculateTargetCount(t,n){return this.Vr.dr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return Z.resolve(Jm.ce);const i=new E$(n);return this.Vr.forEachTarget(t,r=>i.Er(r.sequenceNumber)).next(()=>this.Vr.mr(t,r=>i.Er(r))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.Vr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.Vr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(pt("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(RN)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(pt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RN):this.gr(t,n))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,n){let i,r,s,o,a,c,h;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(pt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(t,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(t,i,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,i))).next(d=>(h=Date.now(),nc()<=Ht.DEBUG&&pt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(h-c)+`ms
Total Duration: ${h-u}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}}function A$(e,t){return new I$(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R${constructor(){this.changes=new Ga(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Pn.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Z.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P${constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(t,n,i,r){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,n))).next(r=>(i!==null&&Uh(i.mutation,r,bi.empty(),ge.now()),r))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Qt()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Qt()){const r=la();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,i).next(s=>{let o=bh();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=la();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Qt()))}populateOverlays(t,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(t,r).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,r){let s=Ns();const o=Fh(),a=function(){return Fh()}();return n.forEach((c,h)=>{const u=i.get(h.key);r.has(h.key)&&(u===void 0||u.mutation instanceof Go)?s=s.insert(h.key,h):u!==void 0?(o.set(h.key,u.mutation.getFieldMask()),Uh(u.mutation,h,u.mutation.getFieldMask(),ge.now())):o.set(h.key,bi.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((h,u)=>o.set(h,u)),n.forEach((h,u)=>a.set(h,new P$(u,o.get(h)??null))),a))}recalculateAndSaveOverlays(t,n){const i=Fh();let r=new Qe((o,a)=>o-a),s=Qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let u=i.get(c)||bi.empty();u=a.applyToLocalView(h,u),i.set(c,u);const d=(r.get(a.batchId)||Qt()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,u=c.value,d=I2();u.forEach(f=>{if(!s.has(f)){const v=L2(n.get(f),i.get(f));v!==null&&d.set(f,v),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,d))}return Z.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,r){return M8(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):C2(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,r):this.getDocumentsMatchingCollectionQuery(t,n,i,r)}getNextDocuments(t,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,r-s.size):Z.resolve(la());let a=wu,c=s;return o.next(h=>Z.forEach(h,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?Z.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(t,h,s)).next(()=>this.computeViews(t,c,h,Qt())).next(u=>({batchId:a,changes:S2(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Ct(n)).next(i=>{let r=bh();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,n,i,r){const s=n.collectionGroup;let o=bh();return this.indexManager.getCollectionParents(t,s).next(a=>Z.forEach(a,c=>{const h=function(d,f){return new El(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,i,r).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,s,r))).next(o=>{s.forEach((c,h)=>{const u=h.getKey();o.get(u)===null&&(o=o.insert(u,Pn.newInvalidDocument(u)))});let a=bh();return o.forEach((c,h)=>{const u=s.get(c);u!==void 0&&Uh(u.mutation,h,bi.empty(),ge.now()),ep(n,h)&&(a=a.insert(c,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D${constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,n){return Z.resolve(this.Nr.get(n))}saveBundleMetadata(t,n){return this.Nr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Or(r.createTime)}}(n)),Z.resolve()}getNamedQuery(t,n){return Z.resolve(this.Br.get(n))}saveNamedQuery(t,n){return this.Br.set(n.name,function(r){return{name:r.name,query:T$(r.bundledQuery),readTime:Or(r.readTime)}}(n)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L${constructor(){this.overlays=new Qe(Ct.comparator),this.Lr=new Map}getOverlay(t,n){return Z.resolve(this.overlays.get(n))}getOverlays(t,n){const i=la();return Z.forEach(n,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((r,s)=>{this.bt(t,n,s)}),Z.resolve()}removeOverlaysForBatchId(t,n,i){const r=this.Lr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(i)),Z.resolve()}getOverlaysForCollection(t,n,i){const r=la(),s=n.length+1,o=new Ct(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Z.resolve(r)}getOverlaysForCollectionGroup(t,n,i,r){let s=new Qe((h,u)=>h-u);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>i){let u=s.get(h.largestBatchId);u===null&&(u=la(),s=s.insert(h.largestBatchId,u)),u.set(h.getKey(),h)}}const a=la(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,u)=>a.set(h,u)),!(a.size()>=r)););return Z.resolve(a)}bt(t,n,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Z8(n,i));let s=this.Lr.get(n);s===void 0&&(s=Qt(),this.Lr.set(n,s)),this.Lr.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V${constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(t){return Z.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(){this.kr=new rn(hn.Kr),this.qr=new rn(hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,n){const i=new hn(t,n);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.Wr(new hn(t,n))}Qr(t,n){t.forEach(i=>this.removeReference(i,n))}Gr(t){const n=new Ct(new de([])),i=new hn(n,t),r=new hn(n,t+1),s=[];return this.qr.forEachInRange([i,r],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(t=>this.Wr(t))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const n=new Ct(new de([])),i=new hn(n,t),r=new hn(n,t+1);let s=Qt();return this.qr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(t){const n=new hn(t,0),i=this.kr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class hn{constructor(t,n){this.key=t,this.Hr=n}static Kr(t,n){return Ct.comparator(t.key,n.key)||Wt(t.Hr,n.Hr)}static Ur(t,n){return Wt(t.Hr,n.Hr)||Ct.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q${constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new rn(hn.Kr)}checkEmpty(t){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,r){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new X8(s,n,i,r);this.mutationQueue.push(o);for(const a of r)this.Jr=this.Jr.add(new hn(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return Z.resolve(o)}lookupMutationBatch(t,n){return Z.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,r=this.Xr(i),s=r<0?0:r;return Z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?mw:this.Yn-1)}getAllMutationBatches(t){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new hn(n,0),r=new hn(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([i,r],o=>{const a=this.Zr(o.Hr);s.push(a)}),Z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new rn(Wt);return n.forEach(r=>{const s=new hn(r,0),o=new hn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],a=>{i=i.add(a.Hr)})}),Z.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,r=i.length+1;let s=i;Ct.isDocumentKey(s)||(s=s.child(""));const o=new hn(new Ct(s),0);let a=new rn(Wt);return this.Jr.forEachWhile(c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Hr)),!0)},o),Z.resolve(this.Yr(a))}Yr(t){const n=[];return t.forEach(i=>{const r=this.Zr(i);r!==null&&n.push(r)}),n}removeMutationBatch(t,n){ie(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Z.forEach(n.mutations,r=>{const s=new hn(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Jr=i})}nr(t){}containsKey(t,n){const i=new hn(n,0),r=this.Jr.firstAfterOrEqual(i);return Z.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,Z.resolve()}ei(t,n){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const n=this.Xr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j${constructor(t){this.ti=t,this.docs=function(){return new Qe(Ct.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,o=this.ti(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return Z.resolve(i?i.document.mutableCopy():Pn.newInvalidDocument(n))}getEntries(t,n){let i=Ns();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Pn.newInvalidDocument(r))}),Z.resolve(i)}getDocumentsMatchingQuery(t,n,i,r){let s=Ns();const o=n.path,a=new Ct(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:u}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||l8(c8(u),i)<=0||(r.has(u.key)||ep(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return Z.resolve(s)}getAllFromCollectionGroup(t,n,i,r){It(9500)}ni(t,n){return Z.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new F$(this)}getSize(t){return Z.resolve(this.size)}}class F$ extends R${constructor(t){super(),this.Mr=t}applyChanges(t){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.Mr.addEntry(t,r)):this.Mr.removeEntry(i)}),Z.waitFor(n)}getFromCache(t,n){return this.Mr.getEntry(t,n)}getAllFromCache(t,n){return this.Mr.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U${constructor(t){this.persistence=t,this.ri=new Ga(n=>yw(n),xw),this.lastRemoteSnapshotVersion=Vt.min(),this.highestTargetId=0,this.ii=0,this.si=new kw,this.targetCount=0,this.oi=ol._r()}forEachTarget(t,n){return this.ri.forEach((i,r)=>n(r)),Z.resolve()}getLastRemoteSnapshotVersion(t){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Z.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.ii&&(this.ii=n),Z.resolve()}lr(t){this.ri.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.oi=new ol(n),this.highestTargetId=n),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,n){return this.lr(n),this.targetCount+=1,Z.resolve()}updateTargetData(t,n){return this.lr(n),Z.resolve()}removeTargetData(t,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,Z.resolve()}removeTargets(t,n,i){let r=0;const s=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)}),Z.waitFor(s).next(()=>r)}getTargetCount(t){return Z.resolve(this.targetCount)}getTargetData(t,n){const i=this.ri.get(n)||null;return Z.resolve(i)}addMatchingKeys(t,n,i){return this.si.$r(n,i),Z.resolve()}removeMatchingKeys(t,n,i){this.si.Qr(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(t,o))}),Z.waitFor(s)}removeMatchingKeysForTargetId(t,n){return this.si.Gr(n),Z.resolve()}getMatchingKeysForTargetId(t,n){const i=this.si.jr(n);return Z.resolve(i)}containsKey(t,n){return Z.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(t,n){this._i={},this.overlays={},this.ai=new Jm(0),this.ui=!1,this.ui=!0,this.ci=new V$,this.referenceDelegate=t(this),this.li=new U$(this),this.indexManager=new C$,this.remoteDocumentCache=function(r){return new j$(r)}(i=>this.referenceDelegate.hi(i)),this.serializer=new b$(n),this.Pi=new D$(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new L$,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this._i[t.toKey()];return i||(i=new q$(n,this.referenceDelegate),this._i[t.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,n,i){pt("MemoryPersistence","Starting transaction:",t);const r=new O$(this.ai.next());return this.referenceDelegate.Ti(),i(r).next(s=>this.referenceDelegate.Ii(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ei(t,n){return Z.or(Object.values(this._i).map(i=>()=>i.containsKey(t,n)))}}class O$ extends u8{constructor(t){super(),this.currentSequenceNumber=t}}class Nw{constructor(t){this.persistence=t,this.Ri=new kw,this.Ai=null}static Vi(t){return new Nw(t)}get di(){if(this.Ai)return this.Ai;throw It(60996)}addReference(t,n,i){return this.Ri.addReference(i,n),this.di.delete(i.toString()),Z.resolve()}removeReference(t,n,i){return this.Ri.removeReference(i,n),this.di.add(i.toString()),Z.resolve()}markPotentiallyOrphaned(t,n){return this.di.add(n.toString()),Z.resolve()}removeTarget(t,n){this.Ri.Gr(n.targetId).forEach(r=>this.di.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(r=>{r.forEach(s=>this.di.add(s.toString()))}).next(()=>i.removeTargetData(t,n))}Ti(){this.Ai=new Set}Ii(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.di,i=>{const r=Ct.fromPath(i);return this.mi(t,r).next(s=>{s||n.removeEntry(r,Vt.min())})}).next(()=>(this.Ai=null,n.apply(t)))}updateLimboDocument(t,n){return this.mi(t,n).next(i=>{i?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(t){return 0}mi(t,n){return Z.or([()=>Z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ei(t,n)])}}class qf{constructor(t,n){this.persistence=t,this.fi=new Ga(i=>f8(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=A$(this,n)}static Vi(t,n){return new qf(t,n)}Ti(){}Ii(t){return Z.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}dr(t){const n=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(r=>i+r))}pr(t){let n=0;return this.mr(t,i=>{n++}).next(()=>n)}mr(t,n){return Z.forEach(this.fi,(i,r)=>this.wr(t,i,r).next(s=>s?Z.resolve():n(r)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ni(t,o=>this.wr(t,o,n).next(a=>{a||(i++,s.removeEntry(o,Vt.min()))})).next(()=>s.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.fi.set(n,t.currentSequenceNumber),Z.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.fi.set(i,t.currentSequenceNumber),Z.resolve()}removeReference(t,n,i){return this.fi.set(i,t.currentSequenceNumber),Z.resolve()}updateLimboDocument(t,n){return this.fi.set(n,t.currentSequenceNumber),Z.resolve()}hi(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=Dg(t.data.value)),n}wr(t,n,i){return Z.or([()=>this.persistence.Ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const r=this.fi.get(n);return Z.resolve(r!==void 0&&r>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(t,n,i,r){this.targetId=t,this.fromCache=n,this.Ts=i,this.Is=r}static Es(t,n){let i=Qt(),r=Qt();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Ew(t,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G${constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return E6()?8:d8(Fn())>0?6:4}()}initialize(t,n){this.fs=t,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(t,n,i,r){const s={result:null};return this.gs(t,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(t,n,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new B$;return this.ys(t,n,o).next(a=>{if(s.result=a,this.As)return this.ws(t,n,o,a.size)})}).next(()=>s.result)}ws(t,n,i,r){return i.documentReadCount<this.Vs?(nc()<=Ht.DEBUG&&pt("QueryEngine","SDK will not create cache indexes for query:",ic(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Z.resolve()):(nc()<=Ht.DEBUG&&pt("QueryEngine","Query:",ic(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(nc()<=Ht.DEBUG&&pt("QueryEngine","The SDK decides to create cache indexes for query:",ic(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ur(n))):Z.resolve())}gs(t,n){if(wN(n))return Z.resolve(null);let i=Ur(n);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Df(n,null,"F"),i=Ur(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const o=Qt(...s);return this.fs.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(c=>{const h=this.bs(n,a);return this.Ss(n,h,o,c.readTime)?this.gs(t,Df(n,null,"F")):this.Ds(t,h,n,c)}))})))}ps(t,n,i,r){return wN(n)||r.isEqual(Vt.min())?Z.resolve(null):this.fs.getDocuments(t,i).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,i,r)?Z.resolve(null):(nc()<=Ht.DEBUG&&pt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ic(n)),this.Ds(t,o,n,a8(r,wu)).next(a=>a))})}bs(t,n){let i=new rn(N2(t));return n.forEach((r,s)=>{ep(t,s)&&(i=i.add(s))}),i}Ss(t,n,i,r){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const s=t.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ys(t,n,i){return nc()<=Ht.DEBUG&&pt("QueryEngine","Using full collection scan to execute query:",ic(n)),this.fs.getDocumentsMatchingQuery(t,n,So.min(),i)}Ds(t,n,i,r){return this.fs.getDocumentsMatchingQuery(t,i,r).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="LocalStore",H$=3e8;class $${constructor(t,n,i,r){this.persistence=t,this.Cs=n,this.serializer=r,this.vs=new Qe(Wt),this.Fs=new Ga(s=>yw(s),xw),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(i)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new M$(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.vs))}}function z$(e,t,n,i){return new $$(e,t,n,i)}async function J2(e,t){const n=jt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.Os(t),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let c=Qt();for(const h of r){o.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}for(const h of s){a.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(i,c).next(h=>({Ns:h,removedBatchIds:o,addedBatchIds:a}))})})}function K$(e,t){const n=jt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,h,u){const d=h.batch,f=d.keys();let v=Z.resolve();return f.forEach(y=>{v=v.next(()=>u.getEntry(c,y)).next(_=>{const w=h.docVersions.get(y);ie(w!==null,48541),_.version.compareTo(w)<0&&(d.applyToRemoteDocument(_,h),_.isValidDocument()&&(_.setReadTime(h.commitVersion),u.addEntry(_)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,i,t,s).next(()=>s.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let c=Qt();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c}(t))).next(()=>n.localDocuments.getDocuments(i,r))})}function X2(e){const t=jt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.li.getLastRemoteSnapshotVersion(n))}function W$(e,t){const n=jt(e),i=t.snapshotVersion;let r=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});r=n.vs;const a=[];t.targetChanges.forEach((u,d)=>{const f=r.get(d);if(!f)return;a.push(n.li.removeMatchingKeys(s,u.removedDocuments,d).next(()=>n.li.addMatchingKeys(s,u.addedDocuments,d)));let v=f.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?v=v.withResumeToken(pn.EMPTY_BYTE_STRING,Vt.min()).withLastLimboFreeSnapshotVersion(Vt.min()):u.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(u.resumeToken,i)),r=r.insert(d,v),function(_,w,x){return _.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=H$?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,v,u)&&a.push(n.li.updateTargetData(s,v))});let c=Ns(),h=Qt();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(Q$(s,o,t.documentUpdates).next(u=>{c=u.Bs,h=u.Ls})),!i.isEqual(Vt.min())){const u=n.li.getLastRemoteSnapshotVersion(s).next(d=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return Z.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(n.vs=r,s))}function Q$(e,t,n){let i=Qt(),r=Qt();return n.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let o=Ns();return n.forEach((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(Vt.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):pt(Sw,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)}),{Bs:o,Ls:r}})}function Y$(e,t){const n=jt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=mw),n.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function J$(e,t){const n=jt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.li.getTargetData(i,t).next(s=>s?(r=s,Z.resolve(r)):n.li.allocateTargetId(i).next(o=>(r=new ao(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.li.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.vs=n.vs.insert(i.targetId,i),n.Fs.set(t,i.targetId)),i})}async function Zx(e,t,n){const i=jt(e),r=i.vs.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Nl(o))throw o;pt(Sw,`Failed to update sequence numbers for target ${t}: ${o}`)}i.vs=i.vs.remove(t),i.Fs.delete(r.target)}function DN(e,t,n){const i=jt(e);let r=Vt.min(),s=Qt();return i.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,u){const d=jt(c),f=d.Fs.get(u);return f!==void 0?Z.resolve(d.vs.get(f)):d.li.getTargetData(h,u)}(i,o,Ur(t)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.Cs.getDocumentsMatchingQuery(o,t,n?r:Vt.min(),n?s:Qt())).next(a=>(X$(i,V8(t),a),{documents:a,ks:s})))}function X$(e,t,n){let i=e.Ms.get(t)||Vt.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.Ms.set(t,i)}class LN{constructor(){this.activeTargetIds=B8()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Z${constructor(){this.vo=new LN,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,n,i){this.Fo[t]=n}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new LN,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{Mo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN="ConnectivityMonitor";class qN{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){pt(VN,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){pt(VN,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ig=null;function t0(){return ig===null?ig=function(){return 268435456+Math.round(2147483648*Math.random())}():ig++,"0x"+ig.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="RestConnection",e9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class n9{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+t.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===Rf?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(t,n,i,r,s){const o=t0(),a=this.Qo(t,n.toUriEncodedString());pt(zv,`Sending RPC '${t}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,r,s);const{host:h}=new URL(a),u=Ls(h);return this.zo(t,a,c,i,u).then(d=>(pt(zv,`Received RPC '${t}' ${o}: `,d),d),d=>{throw Na(zv,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",i),d})}jo(t,n,i,r,s,o){return this.Wo(t,n,i,r,s)}Go(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Cl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>t[s]=r),i&&i.headers.forEach((r,s)=>t[s]=r)}Qo(t,n){const i=e9[t];let r=`${this.qo}/v1/${n}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i9{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En="WebChannelConnection",ch=(e,t,n)=>{e.listen(t,i=>{try{n(i)}catch(r){setTimeout(()=>{throw r},0)}})};class Lc extends n9{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!Lc.c_){const t=t2();ch(t,ZM.STAT_EVENT,n=>{n.stat===Ox.PROXY?pt(En,"STAT_EVENT: detected buffering proxy"):n.stat===Ox.NOPROXY&&pt(En,"STAT_EVENT: detected no buffering proxy")}),Lc.c_=!0}}zo(t,n,i,r,s){const o=t0();return new Promise((a,c)=>{const h=new JM;h.setWithCredentials(!0),h.listenOnce(XM.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Mg.NO_ERROR:const d=h.getResponseJson();pt(En,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Mg.TIMEOUT:pt(En,`RPC '${t}' ${o} timed out`),c(new ut(J.DEADLINE_EXCEEDED,"Request time out"));break;case Mg.HTTP_ERROR:const f=h.getStatus();if(pt(En,`RPC '${t}' ${o} failed with status:`,f,"response text:",h.getResponseText()),f>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v==null?void 0:v.error;if(y&&y.status&&y.message){const _=function(x){const C=x.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(C)>=0?C:J.UNKNOWN}(y.status);c(new ut(_,y.message))}else c(new ut(J.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new ut(J.UNAVAILABLE,"Connection failed."));break;default:It(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{pt(En,`RPC '${t}' ${o} completed.`)}});const u=JSON.stringify(r);pt(En,`RPC '${t}' ${o} sending request:`,r),h.send(n,"POST",u,i,15)})}T_(t,n,i){const r=t0(),s=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,i),a.encodeInitMessageHeaders=!0;const h=s.join("");pt(En,`Creating RPC '${t}' stream ${r}: ${h}`,a);const u=o.createWebChannel(h,a);this.I_(u);let d=!1,f=!1;const v=new i9({Ho:y=>{f?pt(En,`Not sending because RPC '${t}' stream ${r} is closed:`,y):(d||(pt(En,`Opening RPC '${t}' stream ${r} transport.`),u.open(),d=!0),pt(En,`RPC '${t}' stream ${r} sending:`,y),u.send(y))},Jo:()=>u.close()});return ch(u,wh.EventType.OPEN,()=>{f||(pt(En,`RPC '${t}' stream ${r} transport opened.`),v.i_())}),ch(u,wh.EventType.CLOSE,()=>{f||(f=!0,pt(En,`RPC '${t}' stream ${r} transport closed`),v.o_(),this.E_(u))}),ch(u,wh.EventType.ERROR,y=>{f||(f=!0,Na(En,`RPC '${t}' stream ${r} transport errored. Name:`,y.name,"Message:",y.message),v.o_(new ut(J.UNAVAILABLE,"The operation could not be completed")))}),ch(u,wh.EventType.MESSAGE,y=>{var _;if(!f){const w=y.data[0];ie(!!w,16349);const x=w,C=(x==null?void 0:x.error)||((_=x[0])==null?void 0:_.error);if(C){pt(En,`RPC '${t}' stream ${r} received error:`,C);const k=C.status;let P=function(N){const T=He[N];if(T!==void 0)return j2(T)}(k),A=C.message;P===void 0&&(P=J.INTERNAL,A="Unknown error status: "+k+" with message "+C.message),f=!0,v.o_(new ut(P,A)),u.close()}else pt(En,`RPC '${t}' stream ${r} received:`,w),v.__(w)}}),Lc.u_(),setTimeout(()=>{v.s_()},0),v}terminate(){this.a_.forEach(t=>t.close()),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter(n=>n===t)}Go(t,n,i){super.Go(t,n,i),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return e2()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r9(e){return new Lc(e)}function Kv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(e){return new c$(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lc.c_=!1;class Z2{constructor(t,n,i=1e3,r=1.5,s=6e4){this.Ci=t,this.timerId=n,this.R_=i,this.A_=r,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const n=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-i);r>0&&pt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),t())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="PersistentStream";class tD{constructor(t,n,i,r,s,o,a,c){this.Ci=t,this.b_=i,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Z2(t,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(ks(n.toString()),ks("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(n)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===n&&this.G_(i,r)},i=>{t(()=>{const r=new ut(J.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(t,n){const i=this.Q_(this.D_);this.stream=this.j_(t,n),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.Yo(()=>{i(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.H_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return pt(jN,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return n=>{this.Ci.enqueueAndForget(()=>this.D_===t?n():(pt(jN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class s9 extends tD{constructor(t,n,i,r,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}j_(t,n){return this.connection.T_("Listen",t,n)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const n=u$(this.serializer,t),i=function(s){if(!("targetChange"in s))return Vt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Vt.min():o.readTime?Or(o.readTime):Vt.min()}(t);return this.listener.J_(n,i)}Z_(t){const n={};n.database=Xx(this.serializer),n.addTarget=function(s,o){let a;const c=o.target;if(a=Kx(c)?{documents:f$(s,c)}:{query:m$(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=O2(s,o.resumeToken);const h=Qx(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Vt.min())>0){a.readTime=Vf(s,o.snapshotVersion.toTimestamp());const h=Qx(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,t);const i=v$(this.serializer,t);i&&(n.labels=i),this.K_(n)}X_(t){const n={};n.database=Xx(this.serializer),n.removeTarget=t,this.K_(n)}}class o9 extends tD{constructor(t,n,i,r,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,n){return this.connection.T_("Write",t,n)}H_(t){return ie(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ie(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ie(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const n=g$(t.writeResults,t.commitTime),i=Or(t.commitTime);return this.listener.na(i,n)}ra(){const t={};t.database=Xx(this.serializer),this.K_(t)}ea(t){const n={streamToken:this.lastStreamToken,writes:t.map(i=>d$(this.serializer,i))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{}class c9 extends a9{constructor(t,n,i,r){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ut(J.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,n,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(t,Yx(n,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ut(J.UNKNOWN,s.toString())})}jo(t,n,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(t,Yx(n,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ut(J.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function l9(e,t,n,i){return new c9(e,t,n,i)}class h9{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ks(n),this.aa=!1):pt("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="RemoteStore";class u9{constructor(t,n,i,r,s){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{i.enqueueAndForget(async()=>{Ha(this)&&(pt(Ea,"Restarting streams for network reachability change."),await async function(c){const h=jt(c);h.Ea.add(4),await rd(h),h.Va.set("Unknown"),h.Ea.delete(4),await op(h)}(this))})}),this.Va=new h9(i,r)}}async function op(e){if(Ha(e))for(const t of e.Ra)await t(!0)}async function rd(e){for(const t of e.Ra)await t(!1)}function eD(e,t){const n=jt(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Pw(n)?Rw(n):Sl(n).O_()&&Aw(n,t))}function Iw(e,t){const n=jt(e),i=Sl(n);n.Ia.delete(t),i.O_()&&nD(n,t),n.Ia.size===0&&(i.O_()?i.L_():Ha(n)&&n.Va.set("Unknown"))}function Aw(e,t){if(e.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Vt.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Sl(e).Z_(t)}function nD(e,t){e.da.$e(t),Sl(e).X_(t)}function Rw(e){e.da=new r$({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Sl(e).start(),e.Va.ua()}function Pw(e){return Ha(e)&&!Sl(e).x_()&&e.Ia.size>0}function Ha(e){return jt(e).Ea.size===0}function iD(e){e.da=void 0}async function d9(e){e.Va.set("Online")}async function g9(e){e.Ia.forEach((t,n)=>{Aw(e,t)})}async function f9(e,t){iD(e),Pw(e)?(e.Va.ha(t),Rw(e)):e.Va.set("Unknown")}async function m9(e,t,n){if(e.Va.set("Online"),t instanceof U2&&t.state===2&&t.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.da.removeTarget(a))}(e,t)}catch(i){pt(Ea,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await jf(e,i)}else if(t instanceof qg?e.da.Xe(t):t instanceof F2?e.da.st(t):e.da.tt(t),!n.isEqual(Vt.min()))try{const i=await X2(e.localStore);n.compareTo(i)>=0&&await function(s,o){const a=s.da.Tt(o);return a.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.Ia.get(h);u&&s.Ia.set(h,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,h)=>{const u=s.Ia.get(c);if(!u)return;s.Ia.set(c,u.withResumeToken(pn.EMPTY_BYTE_STRING,u.snapshotVersion)),nD(s,c);const d=new ao(u.target,c,h,u.sequenceNumber);Aw(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){pt(Ea,"Failed to raise snapshot:",i),await jf(e,i)}}async function jf(e,t,n){if(!Nl(t))throw t;e.Ea.add(1),await rd(e),e.Va.set("Offline"),n||(n=()=>X2(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{pt(Ea,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await op(e)})}function rD(e,t){return t().catch(n=>jf(e,n,t))}async function ap(e){const t=jt(e),n=Po(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:mw;for(;p9(t);)try{const r=await Y$(t.localStore,i);if(r===null){t.Ta.length===0&&n.L_();break}i=r.batchId,v9(t,r)}catch(r){await jf(t,r)}sD(t)&&oD(t)}function p9(e){return Ha(e)&&e.Ta.length<10}function v9(e,t){e.Ta.push(t);const n=Po(e);n.O_()&&n.Y_&&n.ea(t.mutations)}function sD(e){return Ha(e)&&!Po(e).x_()&&e.Ta.length>0}function oD(e){Po(e).start()}async function y9(e){Po(e).ra()}async function x9(e){const t=Po(e);for(const n of e.Ta)t.ea(n.mutations)}async function _9(e,t,n){const i=e.Ta.shift(),r=bw.from(i,t,n);await rD(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await ap(e)}async function w9(e,t){t&&Po(e).Y_&&await async function(i,r){if(function(o){return e$(o)&&o!==J.ABORTED}(r.code)){const s=i.Ta.shift();Po(i).B_(),await rD(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await ap(i)}}(e,t),sD(e)&&oD(e)}async function FN(e,t){const n=jt(e);n.asyncQueue.verifyOperationInProgress(),pt(Ea,"RemoteStore received new credentials");const i=Ha(n);n.Ea.add(3),await rd(n),i&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await op(n)}async function b9(e,t){const n=jt(e);t?(n.Ea.delete(2),await op(n)):t||(n.Ea.add(2),await rd(n),n.Va.set("Unknown"))}function Sl(e){return e.ma||(e.ma=function(n,i,r){const s=jt(n);return s.sa(),new s9(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Zo:d9.bind(null,e),Yo:g9.bind(null,e),t_:f9.bind(null,e),J_:m9.bind(null,e)}),e.Ra.push(async t=>{t?(e.ma.B_(),Pw(e)?Rw(e):e.Va.set("Unknown")):(await e.ma.stop(),iD(e))})),e.ma}function Po(e){return e.fa||(e.fa=function(n,i,r){const s=jt(n);return s.sa(),new o9(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),Yo:y9.bind(null,e),t_:w9.bind(null,e),ta:x9.bind(null,e),na:_9.bind(null,e)}),e.Ra.push(async t=>{t?(e.fa.B_(),await ap(e)):(await e.fa.stop(),e.Ta.length>0&&(pt(Ea,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(t,n,i,r,s){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new gs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,r,s){const o=Date.now()+i,a=new Mw(t,n,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(J.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dw(e,t){if(ks("AsyncQueue",`${t}: ${e}`),Nl(e))return new ut(J.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{static emptySet(t){return new Vc(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Ct.comparator(n.key,i.key):(n,i)=>Ct.comparator(n.key,i.key),this.keyedMap=bh(),this.sortedSet=new Qe(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Vc)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Vc;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(){this.ga=new Qe(Ct.comparator)}track(t){const n=t.doc.key,i=this.ga.get(n);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(n,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(n):t.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:t.doc}):It(63341,{Vt:t,pa:i}):this.ga=this.ga.insert(n,t)}ya(){const t=[];return this.ga.inorderTraversal((n,i)=>{t.push(i)}),t}}class al{constructor(t,n,i,r,s,o,a,c,h){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(t,n,i,r,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new al(t,n,Vc.emptySet(n),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&tp(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(t=>t.Da())}}class C9{constructor(){this.queries=ON(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const r=jt(n),s=r.queries;r.queries=ON(),s.forEach((o,a)=>{for(const c of a.ba)c.onError(i)})})(this,new ut(J.ABORTED,"Firestore shutting down"))}}function ON(){return new Ga(e=>k2(e),tp)}async function aD(e,t){const n=jt(e);let i=3;const r=t.query;let s=n.queries.get(r);s?!s.Sa()&&t.Da()&&(i=2):(s=new T9,i=t.Da()?0:1);try{switch(i){case 0:s.wa=await n.onListen(r,!0);break;case 1:s.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=Dw(o,`Initialization of query '${ic(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,s),s.ba.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Lw(n)}async function cD(e,t){const n=jt(e),i=t.query;let r=3;const s=n.queries.get(i);if(s){const o=s.ba.indexOf(t);o>=0&&(s.ba.splice(o,1),s.ba.length===0?r=t.Da()?0:1:!s.Sa()&&t.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function k9(e,t){const n=jt(e);let i=!1;for(const r of t){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.ba)a.Fa(r)&&(i=!0);o.wa=r}}i&&Lw(n)}function N9(e,t,n){const i=jt(e),r=i.queries.get(t);if(r)for(const s of r.ba)s.onError(n);i.queries.delete(t)}function Lw(e){e.Ca.forEach(t=>{t.next()})}var e0,BN;(BN=e0||(e0={})).Ma="default",BN.Cache="cache";class lD{constructor(t,n,i){this.query=t,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)r.type!==3&&i.push(r);t=new al(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),n=!0):this.La(t,this.onlineState)&&(this.ka(t),n=!0),this.Na=t,n}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),n=!0),n}La(t,n){if(!t.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.Ka||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(t){t=al.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==e0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(t){this.key=t}}class uD{constructor(t){this.key=t}}class E9{constructor(t,n){this.query=t,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Qt(),this.mutatedKeys=Qt(),this.eu=N2(t),this.tu=new Vc(this.eu)}get nu(){return this.Za}ru(t,n){const i=n?n.iu:new UN,r=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((u,d)=>{const f=r.get(u),v=ep(this.query,d)?d:null,y=!!f&&this.mutatedKeys.has(f.key),_=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;f&&v?f.data.isEqual(v.data)?y!==_&&(i.track({type:3,doc:v}),w=!0):this.su(f,v)||(i.track({type:2,doc:v}),w=!0,(c&&this.eu(v,c)>0||h&&this.eu(v,h)<0)&&(a=!0)):!f&&v?(i.track({type:0,doc:v}),w=!0):f&&!v&&(i.track({type:1,doc:f}),w=!0,(c||h)&&(a=!0)),w&&(v?(o=o.add(v),s=_?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{tu:o,iu:i,Ss:a,mutatedKeys:s}}su(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,r){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort((u,d)=>function(v,y){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return It(20277,{Vt:w})}};return _(v)-_(y)}(u.type,d.type)||this.eu(u.doc,d.doc)),this.ou(i),r=r??!1;const a=n&&!r?this._u():[],c=this.Ya.size===0&&this.current&&!r?1:0,h=c!==this.Xa;return this.Xa=c,o.length!==0||h?{snapshot:new al(this.query,t.tu,s,o,t.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new UN,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=Qt(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))});const n=[];return t.forEach(i=>{this.Ya.has(i)||n.push(new uD(i))}),this.Ya.forEach(i=>{t.has(i)||n.push(new hD(i))}),n}cu(t){this.Za=t.ks,this.Ya=Qt();const n=this.ru(t.documents);return this.applyChanges(n,!0)}lu(){return al.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Vw="SyncEngine";class S9{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class I9{constructor(t){this.key=t,this.hu=!1}}class A9{constructor(t,n,i,r,s,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ga(a=>k2(a),tp),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qe(Ct.comparator),this.Au=new Map,this.Vu=new kw,this.du={},this.mu=new Map,this.fu=ol.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function R9(e,t,n=!0){const i=vD(e);let r;const s=i.Tu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await dD(i,t,n,!0),r}async function P9(e,t){const n=vD(e);await dD(n,t,!0,!1)}async function dD(e,t,n,i){const r=await J$(e.localStore,Ur(t)),s=r.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await M9(e,t,s,o==="current",r.resumeToken)),e.isPrimaryClient&&n&&eD(e.remoteStore,r),a}async function M9(e,t,n,i,r){e.pu=(d,f,v)=>async function(_,w,x,C){let k=w.view.ru(x);k.Ss&&(k=await DN(_.localStore,w.query,!1).then(({documents:N})=>w.view.ru(N,k)));const P=C&&C.targetChanges.get(w.targetId),A=C&&C.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(k,_.isPrimaryClient,P,A);return HN(_,w.targetId,M.au),M.snapshot}(e,d,f,v);const s=await DN(e.localStore,t,!0),o=new E9(t,s.ks),a=o.ru(s.documents),c=id.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",r),h=o.applyChanges(a,e.isPrimaryClient,c);HN(e,n,h.au);const u=new S9(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),h.snapshot}async function D9(e,t,n){const i=jt(e),r=i.Tu.get(t),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter(o=>!tp(o,t))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Zx(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Iw(i.remoteStore,r.targetId),n0(i,r.targetId)}).catch(kl)):(n0(i,r.targetId),await Zx(i.localStore,r.targetId,!0))}async function L9(e,t){const n=jt(e),i=n.Tu.get(t),r=n.Iu.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Iw(n.remoteStore,i.targetId))}async function V9(e,t,n){const i=G9(e);try{const r=await function(o,a){const c=jt(o),h=ge.now(),u=a.reduce((v,y)=>v.add(y.key),Qt());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let y=Ns(),_=Qt();return c.xs.getEntries(v,u).next(w=>{y=w,y.forEach((x,C)=>{C.isValidDocument()||(_=_.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,y)).next(w=>{d=w;const x=[];for(const C of a){const k=Y8(C,d.get(C.key).overlayedDocument);k!=null&&x.push(new Go(C.key,k,v2(k.value.mapValue),yr.exists(!0)))}return c.mutationQueue.addMutationBatch(v,h,x,a)}).next(w=>{f=w;const x=w.applyToLocalDocumentSet(d,_);return c.documentOverlayCache.saveOverlays(v,w.batchId,x)})}).then(()=>({batchId:f.batchId,changes:S2(d)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let h=o.du[o.currentUser.toKey()];h||(h=new Qe(Wt)),h=h.insert(a,c),o.du[o.currentUser.toKey()]=h}(i,r.batchId,n),await sd(i,r.changes),await ap(i.remoteStore)}catch(r){const s=Dw(r,"Failed to persist write");n.reject(s)}}async function gD(e,t){const n=jt(e);try{const i=await W$(n.localStore,t);t.targetChanges.forEach((r,s)=>{const o=n.Au.get(s);o&&(ie(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?ie(o.hu,14607):r.removedDocuments.size>0&&(ie(o.hu,42227),o.hu=!1))}),await sd(n,i,t)}catch(i){await kl(i)}}function GN(e,t,n){const i=jt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.Tu.forEach((s,o)=>{const a=o.view.va(t);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=jt(o);c.onlineState=a;let h=!1;c.queries.forEach((u,d)=>{for(const f of d.ba)f.va(a)&&(h=!0)}),h&&Lw(c)}(i.eventManager,t),r.length&&i.Pu.J_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function q9(e,t,n){const i=jt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Au.get(t),s=r&&r.key;if(s){let o=new Qe(Ct.comparator);o=o.insert(s,Pn.newNoDocument(s,Vt.min()));const a=Qt().add(s),c=new rp(Vt.min(),new Map,new Qe(Wt),o,a);await gD(i,c),i.Ru=i.Ru.remove(s),i.Au.delete(t),qw(i)}else await Zx(i.localStore,t,!1).then(()=>n0(i,t,n)).catch(kl)}async function j9(e,t){const n=jt(e),i=t.batch.batchId;try{const r=await K$(n.localStore,t);mD(n,i,null),fD(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await sd(n,r)}catch(r){await kl(r)}}async function F9(e,t,n){const i=jt(e);try{const r=await function(o,a){const c=jt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let u;return c.mutationQueue.lookupMutationBatch(h,a).next(d=>(ie(d!==null,37113),u=d.keys(),c.mutationQueue.removeMutationBatch(h,d))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,u)).next(()=>c.localDocuments.getDocuments(h,u))})}(i.localStore,t);mD(i,t,n),fD(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await sd(i,r)}catch(r){await kl(r)}}function fD(e,t){(e.mu.get(t)||[]).forEach(n=>{n.resolve()}),e.mu.delete(t)}function mD(e,t,n){const i=jt(e);let r=i.du[i.currentUser.toKey()];if(r){const s=r.get(t);s&&(n?s.reject(n):s.resolve(),r=r.remove(t)),i.du[i.currentUser.toKey()]=r}}function n0(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Iu.get(t))e.Tu.delete(i),n&&e.Pu.yu(i,n);e.Iu.delete(t),e.isPrimaryClient&&e.Vu.Gr(t).forEach(i=>{e.Vu.containsKey(i)||pD(e,i)})}function pD(e,t){e.Eu.delete(t.path.canonicalString());const n=e.Ru.get(t);n!==null&&(Iw(e.remoteStore,n),e.Ru=e.Ru.remove(t),e.Au.delete(n),qw(e))}function HN(e,t,n){for(const i of n)i instanceof hD?(e.Vu.addReference(i.key,t),U9(e,i)):i instanceof uD?(pt(Vw,"Document no longer in limbo: "+i.key),e.Vu.removeReference(i.key,t),e.Vu.containsKey(i.key)||pD(e,i.key)):It(19791,{wu:i})}function U9(e,t){const n=t.key,i=n.path.canonicalString();e.Ru.get(n)||e.Eu.has(i)||(pt(Vw,"New document in limbo: "+n),e.Eu.add(i),qw(e))}function qw(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Ct(de.fromString(t)),i=e.fu.next();e.Au.set(i,new I9(n)),e.Ru=e.Ru.insert(n,i),eD(e.remoteStore,new ao(Ur(_w(n.path)),i,"TargetPurposeLimboResolution",Jm.ce))}}async function sd(e,t,n){const i=jt(e),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach((a,c)=>{o.push(i.pu(c,t,n).then(h=>{var u;if((h||n)&&i.isPrimaryClient){const d=h?!h.fromCache:(u=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=Ew.Es(c.targetId,h);s.push(d)}}))}),await Promise.all(o),i.Pu.J_(r),await async function(c,h){const u=jt(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>Z.forEach(h,f=>Z.forEach(f.Ts,v=>u.persistence.referenceDelegate.addReference(d,f.targetId,v)).next(()=>Z.forEach(f.Is,v=>u.persistence.referenceDelegate.removeReference(d,f.targetId,v)))))}catch(d){if(!Nl(d))throw d;pt(Sw,"Failed to update sequence numbers: "+d)}for(const d of h){const f=d.targetId;if(!d.fromCache){const v=u.vs.get(f),y=v.snapshotVersion,_=v.withLastLimboFreeSnapshotVersion(y);u.vs=u.vs.insert(f,_)}}}(i.localStore,s))}async function O9(e,t){const n=jt(e);if(!n.currentUser.isEqual(t)){pt(Vw,"User change. New user:",t.toKey());const i=await J2(n.localStore,t);n.currentUser=t,function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new ut(J.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await sd(n,i.Ns)}}function B9(e,t){const n=jt(e),i=n.Au.get(t);if(i&&i.hu)return Qt().add(i.key);{let r=Qt();const s=n.Iu.get(t);if(!s)return r;for(const o of s){const a=n.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function vD(e){const t=jt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=gD.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=B9.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=q9.bind(null,t),t.Pu.J_=k9.bind(null,t.eventManager),t.Pu.yu=N9.bind(null,t.eventManager),t}function G9(e){const t=jt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=j9.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=F9.bind(null,t),t}class Ff{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=sp(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,n){return null}Mu(t,n){return null}vu(t){return z$(this.persistence,new G$,t.initialUser,this.serializer)}Cu(t){return new Y2(Nw.Vi,this.serializer)}Du(t){return new Z$}async terminate(){var t,n;(t=this.gcScheduler)==null||t.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ff.provider={build:()=>new Ff};class H9 extends Ff{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,n){ie(this.persistence.referenceDelegate instanceof qf,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new S$(i,t.asyncQueue,n)}Cu(t){const n=this.cacheSizeBytes!==void 0?si.withCacheSize(this.cacheSizeBytes):si.DEFAULT;return new Y2(i=>qf.Vi(i,n),this.serializer)}}class i0{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>GN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=O9.bind(null,this.syncEngine),await b9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new C9}()}createDatastore(t){const n=sp(t.databaseInfo.databaseId),i=r9(t.databaseInfo);return l9(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,r,s,o,a){return new u9(i,r,s,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>GN(this.syncEngine,n,0),function(){return qN.v()?new qN:new t9}())}createSyncEngine(t,n){return function(r,s,o,a,c,h,u){const d=new A9(r,s,o,a,c,h);return u&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(r){const s=jt(r);pt(Ea,"RemoteStore shutting down."),s.Ea.add(5),await rd(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(n=this.eventManager)==null||n.terminate()}}i0.provider={build:()=>new i0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):ks("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo="FirestoreClient";class $9{constructor(t,n,i,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this._databaseInfo=r,this.user=In.UNAUTHENTICATED,this.clientId=Qm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{pt(Mo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(pt(Mo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new gs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=Dw(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function Wv(e,t){e.asyncQueue.verifyOperationInProgress(),pt(Mo,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async r=>{i.isEqual(r)||(await J2(t.localStore,r),i=r)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function $N(e,t){e.asyncQueue.verifyOperationInProgress();const n=await z9(e);pt(Mo,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>FN(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,r)=>FN(t.remoteStore,r)),e._onlineComponents=t}async function z9(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){pt(Mo,"Using user provided OfflineComponentProvider");try{await Wv(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(r){return r.name==="FirebaseError"?r.code===J.FAILED_PRECONDITION||r.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Na("Error using user provided cache. Falling back to memory cache: "+n),await Wv(e,new Ff)}}else pt(Mo,"Using default OfflineComponentProvider"),await Wv(e,new H9(void 0));return e._offlineComponents}async function xD(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(pt(Mo,"Using user provided OnlineComponentProvider"),await $N(e,e._uninitializedComponentsProvider._online)):(pt(Mo,"Using default OnlineComponentProvider"),await $N(e,new i0))),e._onlineComponents}function K9(e){return xD(e).then(t=>t.syncEngine)}async function _D(e){const t=await xD(e),n=t.eventManager;return n.onListen=R9.bind(null,t.syncEngine),n.onUnlisten=D9.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=P9.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=L9.bind(null,t.syncEngine),n}function W9(e,t,n={}){const i=new gs;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,h){const u=new yD({next:f=>{u.Nu(),o.enqueueAndForget(()=>cD(s,d));const v=f.docs.has(a);!v&&f.fromCache?h.reject(new ut(J.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&f.fromCache&&c&&c.source==="server"?h.reject(new ut(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new lD(_w(a.path),u,{includeMetadataChanges:!0,Ka:!0});return aD(s,d)}(await _D(e),e.asyncQueue,t,n,i)),i.promise}function Q9(e,t,n={}){const i=new gs;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,h){const u=new yD({next:f=>{u.Nu(),o.enqueueAndForget(()=>cD(s,d)),f.fromCache&&c.source==="server"?h.reject(new ut(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new lD(a,u,{includeMetadataChanges:!0,Ka:!0});return aD(s,d)}(await _D(e),e.asyncQueue,t,n,i)),i.promise}function Y9(e,t){const n=new gs;return e.asyncQueue.enqueueAndForget(async()=>V9(await K9(e),t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="ComponentProvider",zN=new Map;function X9(e,t,n,i,r){return new v8(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,wD(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="firestore.googleapis.com",KN=!0;class WN{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new ut(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bD,this.ssl=KN}else this.host=t.host,this.ssl=t.ssl??KN;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Q2;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<N$)throw new ut(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}o2("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wD(t.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ut(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ut(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ut(J.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class cp{constructor(t,n,i,r){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new ut(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WN(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new r2;switch(i.type){case"firstParty":return new t8(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ut(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=zN.get(n);i&&(pt(J9,"Removing Datastore"),zN.delete(n),i.terminate())}(this),Promise.resolve()}}function TD(e,t,n,i={}){var h;e=kr(e,cp);const r=Ls(t),s=e._getSettings(),o={...s,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;r&&($m(`https://${a}`),zm("Firestore",!0)),s.host!==bD&&s.host!==a&&Na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:a,ssl:r,emulatorOptions:i};if(!Eo(c,o)&&(e._setSettings(c),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=In.MOCK_USER;else{u=hw(i.mockUserToken,(h=e._app)==null?void 0:h.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new ut(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new In(f)}e._authCredentials=new JH(new i2(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new qs(this.firestore,t,this._query)}}class qe{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new qe(this.firestore,t,this._key)}toJSON(){return{type:qe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,i){if(ed(n,qe._jsonSchema))return new qe(t,i||null,new Ct(de.fromString(n.referencePath)))}}qe._jsonSchemaVersion="firestore/documentReference/1.0",qe._jsonSchema={type:We("string",qe._jsonSchemaVersion),referencePath:We("string")};class fs extends qs{constructor(t,n,i){super(t,n,_w(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new qe(this.firestore,null,new Ct(t))}withConverter(t){return new fs(this.firestore,t,this._path)}}function Wr(e,t,...n){if(e=Ce(e),s2("collection","path",t),e instanceof cp){const i=de.fromString(t,...n);return aN(i),new fs(e,null,i)}{if(!(e instanceof qe||e instanceof fs))throw new ut(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(de.fromString(t,...n));return aN(i),new fs(e.firestore,null,i)}}function Dt(e,t,...n){if(e=Ce(e),arguments.length===1&&(t=Qm.newId()),s2("doc","path",t),e instanceof cp){const i=de.fromString(t,...n);return oN(i),new qe(e,null,new Ct(i))}{if(!(e instanceof qe||e instanceof fs))throw new ut(J.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(de.fromString(t,...n));return oN(i),new qe(e.firestore,e instanceof fs?e.converter:null,new Ct(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="AsyncQueue";class YN{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Z2(this,"async_queue_retry"),this._c=()=>{const i=Kv();i&&pt(QN,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const n=Kv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const n=Kv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const n=new gs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Yu.push(t),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!Nl(t))throw t;pt(QN,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const n=this.ac.then(()=>(this.rc=!0,t().catch(i=>{throw this.nc=i,this.rc=!1,ks("INTERNAL UNHANDLED ERROR: ",JN(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=n,n}enqueueAfterDelay(t,n,i){this.uc(),this.oc.indexOf(t)>-1&&(n=0);const r=Mw.createAndSchedule(this,t,n,i,s=>this.hc(s));return this.tc.push(r),r}uc(){this.nc&&It(47125,{Pc:JN(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const n of this.tc)if(n.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Tc()})}Rc(t){this.oc.push(t)}hc(t){const n=this.tc.indexOf(t);this.tc.splice(n,1)}}function JN(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}class $a extends cp{constructor(t,n,i,r){super(t,n,i,r),this.type="firestore",this._queue=new YN,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new YN(t),this._firestoreClient=void 0,await t}}}function CD(e,t){const n=typeof e=="object"?e:Wm(),i=typeof e=="string"?e:Rf,r=Ba(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=lw("firestore");s&&TD(r,...s)}return r}function lp(e){if(e._terminated)throw new ut(J.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Z9(e),e._firestoreClient}function Z9(e){var i,r,s,o;const t=e._freezeSettings(),n=X9(e._databaseId,((i=e._app)==null?void 0:i.options.appId)||"",e._persistenceKey,(r=e._app)==null?void 0:r.options.apiKey,t);e._componentsProvider||(s=t.localCache)!=null&&s._offlineComponentProvider&&((o=t.localCache)!=null&&o._onlineComponentProvider)&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new $9(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(c){const h=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(h),_online:h}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(t){this._byteString=t}static fromBase64String(t){try{return new _i(pn.fromBase64String(t))}catch(n){throw new ut(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new _i(pn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:_i._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ed(t,_i._jsonSchema))return _i.fromBase64String(t.bytes)}}_i._jsonSchemaVersion="firestore/bytes/1.0",_i._jsonSchema={type:We("string",_i._jsonSchemaVersion),bytes:We("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new ut(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new ut(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new ut(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Wt(this._lat,t._lat)||Wt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xr._jsonSchemaVersion}}static fromJSON(t){if(ed(t,xr._jsonSchema))return new xr(t.latitude,t.longitude)}}xr._jsonSchemaVersion="firestore/geoPoint/1.0",xr._jsonSchema={type:We("string",xr._jsonSchemaVersion),latitude:We("number"),longitude:We("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Oi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ed(t,Oi._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(n=>typeof n=="number"))return new Oi(t.vectorValues);throw new ut(J.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Oi._jsonSchemaVersion="firestore/vectorValue/1.0",Oi._jsonSchema={type:We("string",Oi._jsonSchemaVersion),vectorValues:We("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=/^__.*__$/;class ez{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Go(t,this.data,this.fieldMask,n,this.fieldTransforms):new nd(t,this.data,n,this.fieldTransforms)}}class kD{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Go(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function ND(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw It(40011,{dataSource:e})}}class jw{constructor(t,n,i,r,s,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new jw({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){var r;const n=(r=this.path)==null?void 0:r.child(t),i=this.contextWith({path:n,arrayElement:!1});return i.validatePathSegment(t),i}childContextForFieldPath(t){var r;const n=(r=this.path)==null?void 0:r.child(t),i=this.contextWith({path:n,arrayElement:!1});return i.validatePath(),i}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return Uf(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(ND(this.dataSource)&&tz.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class nz{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||sp(t)}createContext(t,n,i,r=!1){return new jw({dataSource:t,methodName:n,targetDoc:i,path:fn.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function up(e){const t=e._freezeSettings(),n=sp(e._databaseId);return new nz(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ED(e,t,n,i,r,s={}){const o=e.createContext(s.merge||s.mergeFields?2:0,t,n,r);Uw("Data must be an object, but it was:",o,i);const a=SD(i,o);let c,h;if(s.merge)c=new bi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const f=Sa(t,d,n);if(!o.contains(f))throw new ut(J.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);RD(u,f)||u.push(f)}c=new bi(u),h=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,h=o.fieldTransforms;return new ez(new ci(a),c,h)}class dp extends od{_toFieldTransform(t){if(t.dataSource!==2)throw t.dataSource===1?t.createError(`${this._methodName}() can only appear at the top level of your update data`):t.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof dp}}class Fw extends od{_toFieldTransform(t){return new z8(t.path,new ku)}isEqual(t){return t instanceof Fw}}function iz(e,t,n,i){const r=e.createContext(1,t,n);Uw("Data must be an object, but it was:",r,i);const s=[],o=ci.empty();Bo(i,(c,h)=>{const u=AD(t,c,n);h=Ce(h);const d=r.childContextForFieldPath(u);if(h instanceof dp)s.push(u);else{const f=ad(h,d);f!=null&&(s.push(u),o.set(u,f))}});const a=new bi(s);return new kD(o,a,r.fieldTransforms)}function rz(e,t,n,i,r,s){const o=e.createContext(1,t,n),a=[Sa(t,i,n)],c=[r];if(s.length%2!=0)throw new ut(J.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Sa(t,s[f])),c.push(s[f+1]);const h=[],u=ci.empty();for(let f=a.length-1;f>=0;--f)if(!RD(h,a[f])){const v=a[f];let y=c[f];y=Ce(y);const _=o.childContextForFieldPath(v);if(y instanceof dp)h.push(v);else{const w=ad(y,_);w!=null&&(h.push(v),u.set(v,w))}}const d=new bi(h);return new kD(u,d,o.fieldTransforms)}function sz(e,t,n,i=!1){return ad(n,e.createContext(i?4:3,t))}function ad(e,t){if(ID(e=Ce(e)))return Uw("Unsupported field value:",t,e),SD(e,t);if(e instanceof od)return function(i,r){if(!ND(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let c=ad(a,r.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(e,t)}return function(i,r){if((i=Ce(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return G8(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=ge.fromDate(i);return{timestampValue:Vf(r.serializer,s)}}if(i instanceof ge){const s=new ge(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vf(r.serializer,s)}}if(i instanceof xr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof _i)return{bytesValue:O2(r.serializer,i._byteString)};if(i instanceof qe){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Cw(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Oi)return function(o,a){const c=o instanceof Oi?o.toArray():o;return{mapValue:{fields:{[m2]:{stringValue:p2},[Pf]:{arrayValue:{values:c.map(u=>{if(typeof u!="number")throw a.createError("VectorValues must only contain numeric values.");return ww(a.serializer,u)})}}}}}}(i,r);if(W2(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${Ym(i)}`)}(e,t)}function SD(e,t){const n={};return l2(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Bo(e,(i,r)=>{const s=ad(r,t.childContextForField(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function ID(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof ge||e instanceof xr||e instanceof _i||e instanceof qe||e instanceof od||e instanceof Oi||W2(e))}function Uw(e,t,n){if(!ID(n)||!a2(n)){const i=Ym(n);throw i==="an object"?t.createError(e+" a custom object"):t.createError(e+" "+i)}}function Sa(e,t,n){if((t=Ce(t))instanceof hp)return t._internalPath;if(typeof t=="string")return AD(e,t);throw Uf("Field path arguments must be of type string or ",e,!1,void 0,n)}const oz=new RegExp("[~\\*/\\[\\]]");function AD(e,t,n){if(t.search(oz)>=0)throw Uf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new hp(...t.split("."))._internalPath}catch{throw Uf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Uf(e,t,n,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new ut(J.INVALID_ARGUMENT,a+e+c)}function RD(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{convertValue(t,n="none"){switch(Ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Fe(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Ao(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw It(62114,{value:t})}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return Bo(t,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertVectorValue(t){var i,r,s;const n=(s=(r=(i=t.fields)==null?void 0:i[Pf].arrayValue)==null?void 0:r.values)==null?void 0:s.map(o=>Fe(o.doubleValue));return new Oi(n)}convertGeoPoint(t){return new xr(Fe(t.latitude),Fe(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=Zm(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(bu(t));default:return null}}convertTimestamp(t){const n=Io(t);return new ge(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=de.fromString(t);ie(K2(i),9688,{name:t});const r=new il(i.get(1),i.get(3)),s=new Ct(i.popFirst(5));return r.isEqual(n)||ks(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD extends PD{constructor(t){super(),this.firestore=t}convertBytes(t){return new _i(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new qe(this.firestore,null,n)}}function DD(){return new Fw("serverTimestamp")}const XN="@firebase/firestore",ZN="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(t,n,i,r,s){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new az(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var t;return((t=this._document)==null?void 0:t.data.clone().value.mapValue.fields)??void 0}get(t){if(this._document){const n=this._document.data.field(Sa("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class az extends LD{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cz(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new ut(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ow{}class gp extends Ow{}function cl(e,t,...n){let i=[];t instanceof Ow&&i.push(t),i=i.concat(n),function(s){const o=s.filter(c=>c instanceof fp).length,a=s.filter(c=>c instanceof cd).length;if(o>1||o>0&&a>0)throw new ut(J.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)e=r._apply(e);return e}class cd extends gp{constructor(t,n,i){super(),this._field=t,this._op=n,this._value=i,this.type="where"}static _create(t,n,i){return new cd(t,n,i)}_apply(t){const n=this._parse(t);return VD(t._query,n),new qs(t.firestore,t.converter,Wx(t._query,n))}_parse(t){const n=up(t.firestore);return function(s,o,a,c,h,u,d){let f;if(h.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ut(J.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){eE(d,u);const y=[];for(const _ of d)y.push(tE(c,s,_));f={arrayValue:{values:y}}}else f=tE(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||eE(d,u),f=sz(a,o,d,u==="in"||u==="not-in");return Ke.create(h,u,f)}(t._query,"where",n,t.firestore._databaseId,this._field,this._op,this._value)}}function Of(e,t,n){const i=t,r=Sa("where",e);return cd._create(r,i,n)}class fp extends Ow{constructor(t,n){super(),this.type=t,this._queryConstraints=n}static _create(t,n){return new fp(t,n)}_parse(t){const n=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:Nr.create(n,this._getOperator())}_apply(t){const n=this._parse(t);return n.getFilters().length===0?t:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)VD(o,c),o=Wx(o,c)}(t._query,n),new qs(t.firestore,t.converter,Wx(t._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mp extends gp{constructor(t,n){super(),this._field=t,this._direction=n,this.type="orderBy"}static _create(t,n){return new mp(t,n)}_apply(t){const n=function(r,s,o){if(r.startAt!==null)throw new ut(J.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ut(J.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cu(s,o)}(t._query,this._field,this._direction);return new qs(t.firestore,t.converter,L8(t._query,n))}}function Bw(e,t="asc"){const n=t,i=Sa("orderBy",e);return mp._create(i,n)}class pp extends gp{constructor(t,n,i){super(),this.type=t,this._limit=n,this._limitType=i}static _create(t,n,i){return new pp(t,n,i)}_apply(t){return new qs(t.firestore,t.converter,Df(t._query,this._limit,this._limitType))}}function Gw(e){return o8("limit",e),pp._create("limit",e,"F")}function tE(e,t,n){if(typeof(n=Ce(n))=="string"){if(n==="")throw new ut(J.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!C2(t)&&n.indexOf("/")!==-1)throw new ut(J.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(de.fromString(n));if(!Ct.isDocumentKey(i))throw new ut(J.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return mN(e,new Ct(i))}if(n instanceof qe)return mN(e,n._key);throw new ut(J.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ym(n)}.`)}function eE(e,t){if(!Array.isArray(e)||e.length===0)throw new ut(J.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function VD(e,t){const n=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(e.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(n!==null)throw n===t.op?new ut(J.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ut(J.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function qD(e,t,n){let i;return i=e?e.toFirestore(t):t,i}class xc{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class bo extends LD{constructor(t,n,i,r,s,o){super(t,n,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new Oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(Sa("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(J.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,n={};return n.type=bo._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}bo._jsonSchemaVersion="firestore/documentSnapshot/1.0",bo._jsonSchema={type:We("string",bo._jsonSchemaVersion),bundleSource:We("string","DocumentSnapshot"),bundleName:We("string"),bundle:We("string")};class Oh extends bo{data(t={}){return super.data(t)}}class va{constructor(t,n,i,r){this._firestore=t,this._userDataWriter=n,this._snapshot=r,this.metadata=new xc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(i=>{t.call(n,new Oh(this._firestore,this._userDataWriter,i.key,i,new xc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ut(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const c=new Oh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new xc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const c=new Oh(r._firestore,r._userDataWriter,a.doc.key,a.doc,new xc(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,u=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:lz(a.type),doc:c,oldIndex:h,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(J.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=va._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Qm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function lz(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return It(61501,{type:e})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */va._jsonSchemaVersion="firestore/querySnapshot/1.0",va._jsonSchema={type:We("string",va._jsonSchemaVersion),bundleSource:We("string","QuerySnapshot"),bundleName:We("string"),bundle:We("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(e){e=kr(e,qe);const t=kr(e.firestore,$a),n=lp(t);return W9(n,e._key).then(i=>hz(t,e,i))}function Ia(e){e=kr(e,qs);const t=kr(e.firestore,$a),n=lp(t),i=new MD(t);return cz(e._query),Q9(n,e._query).then(r=>new va(t,i,e,r))}function Hw(e,t,n){e=kr(e,qe);const i=kr(e.firestore,$a),r=qD(e.converter,t),s=up(i);return yp(i,[ED(s,"setDoc",e._key,r,e.converter!==null,n).toMutation(e._key,yr.none())])}function Kt(e,t,n,...i){e=kr(e,qe);const r=kr(e.firestore,$a),s=up(r);let o;return o=typeof(t=Ce(t))=="string"||t instanceof hp?rz(s,"updateDoc",e._key,t,n,i):iz(s,"updateDoc",e._key,t),yp(r,[o.toMutation(e._key,yr.exists(!0))])}function vp(e,t){const n=kr(e.firestore,$a),i=Dt(e),r=qD(e.converter,t),s=up(e.firestore);return yp(n,[ED(s,"addDoc",i._key,r,e.converter!==null,{}).toMutation(i._key,yr.exists(!1))]).then(()=>i)}function yp(e,t){const n=lp(e);return Y9(n,t)}function hz(e,t,n){const i=n.docs.get(t._key),r=new MD(e);return new bo(e,r,t._key,i,new xc(n.hasPendingWrites,n.fromCache),t.converter)}(function(t,n=!0){YH(Oo),Wi(new Ni("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new $a(new XH(i.getProvider("auth-internal")),new e8(o,i.getProvider("app-check-internal")),y8(o,r),o);return s={useFetchStreams:n,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),qn(XN,ZN,t),qn(XN,ZN,"esm2020")})();const jD=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:PD,Bytes:_i,CollectionReference:fs,DocumentReference:qe,DocumentSnapshot:bo,FieldPath:hp,FieldValue:od,Firestore:$a,FirestoreError:ut,GeoPoint:xr,Query:qs,QueryCompositeFilterConstraint:fp,QueryConstraint:gp,QueryDocumentSnapshot:Oh,QueryFieldFilterConstraint:cd,QueryLimitConstraint:pp,QueryOrderByConstraint:mp,QuerySnapshot:va,SnapshotMetadata:xc,Timestamp:ge,VectorValue:Oi,_AutoId:Qm,_ByteString:pn,_DatabaseId:il,_DocumentKey:Ct,_EmptyAuthCredentialsProvider:r2,_FieldPath:fn,_cast:kr,_logWarn:Na,_validateIsNotUsedTogether:o2,addDoc:vp,collection:Wr,connectFirestoreEmulator:TD,doc:Dt,ensureFirestoreConfigured:lp,executeWrite:yp,getDoc:Qr,getDocs:Ia,getFirestore:CD,limit:Gw,orderBy:Bw,query:cl,serverTimestamp:DD,setDoc:Hw,updateDoc:Kt,where:Of},Symbol.toStringTag,{value:"Module"}));var uz="firebase",dz="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn(uz,dz,"app");var nE={};const iE="@firebase/database",rE="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FD="";function gz(e){FD=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){n==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),gn(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return n==null?null:xu(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){n==null?delete this.cache_[t]:this.cache_[t]=n}get(t){return Vs(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new fz(t)}}catch{}return new mz},ha=UD("localStorage"),pz=UD("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=new td("@firebase/database"),vz=function(){let e=1;return function(){return e++}}(),OD=function(e){const t=j6(e),n=new D6;n.update(t);const i=n.digest();return cw.encodeByteArray(i)},ld=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=ld.apply(null,i):typeof i=="object"?t+=gn(i):t+=i,t+=" "}return t};let Bh=null,sE=!0;const yz=function(e,t){rt(!0,"Can't turn on custom loggers persistently."),qc.logLevel=Ht.VERBOSE,Bh=qc.log.bind(qc)},Mn=function(...e){if(sE===!0&&(sE=!1,Bh===null&&pz.get("logging_enabled")===!0&&yz()),Bh){const t=ld.apply(null,e);Bh(t)}},hd=function(e){return function(...t){Mn(e,...t)}},r0=function(...e){const t="FIREBASE INTERNAL ERROR: "+ld(...e);qc.error(t)},Es=function(...e){const t=`FIREBASE FATAL ERROR: ${ld(...e)}`;throw qc.error(t),new Error(t)},mi=function(...e){const t="FIREBASE WARNING: "+ld(...e);qc.warn(t)},xz=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&mi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},BD=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},_z=function(e){if(document.readyState==="complete")e();else{let t=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ll="[MIN_NAME]",Aa="[MAX_NAME]",Il=function(e,t){if(e===t)return 0;if(e===ll||t===Aa)return-1;if(t===ll||e===Aa)return 1;{const n=oE(e),i=oE(t);return n!==null?i!==null?n-i===0?e.length-t.length:n-i:-1:i!==null?1:e<t?-1:1}},wz=function(e,t){return e===t?0:e<t?-1:1},lh=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+gn(t))},$w=function(e){if(typeof e!="object"||e===null)return gn(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)i!==0&&(n+=","),n+=gn(t[i]),n+=":",n+=$w(e[t[i]]);return n+="}",n},GD=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function pi(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const HD=function(e){rt(!BD(e),"Invalid JSON number");const t=11,n=52,i=(1<<t-1)-1;let r,s,o,a,c;e===0?(s=0,o=0,r=1/e===-1/0?1:0):(r=e<0,e=Math.abs(e),e>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),i),s=a+i,o=Math.round(e*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(e/Math.pow(2,1-i-n))));const h=[];for(c=n;c;c-=1)h.push(o%2?1:0),o=Math.floor(o/2);for(c=t;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(r?1:0),h.reverse();const u=h.join("");let d="";for(c=0;c<64;c+=8){let f=parseInt(u.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},bz=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Tz=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Cz(e,t){let n="Unknown Error";e==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?n="Client doesn't have permission to access the desired data.":e==="unavailable"&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}const kz=new RegExp("^-?(0*)\\d{1,10}$"),Nz=-2147483648,Ez=2147483647,oE=function(e){if(kz.test(e)){const t=Number(e);if(t>=Nz&&t<=Ez)return t}return null},Al=function(e){try{e()}catch(t){setTimeout(()=>{const n=t.stack||"";throw mi("Exception was thrown by user callback.",n),t},Math.floor(0))}},Sz=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Gh=function(e,t){const n=setTimeout(e,t);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(t,n){this.appCheckProvider=n,this.appName=t.name,Li(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){var n;(n=this.appCheckProvider)==null||n.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){mi(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(t,n,i){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&n.code==="auth/token-not-initialized"?(Mn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,i):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',mi(t)}}class jg{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}jg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="5",$D="v",zD="s",KD="r",WD="f",QD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,YD="ls",JD="p",s0="ac",XD="websocket",ZD="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(t,n,i,r,s=!1,o="",a=!1,c=!1,h=null){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=h,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ha.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&ha.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${n}`}}function Rz(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function eL(e,t,n){rt(typeof t=="string","typeof type must == string"),rt(typeof n=="object","typeof params must == object");let i;if(t===XD)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===ZD)i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);Rz(e)&&(n.ns=e.namespace);const r=[];return pi(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz{constructor(){this.counters_={}}incrementCounter(t,n=1){Vs(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return m6(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv={},Yv={};function Kw(e){const t=e.toString();return Qv[t]||(Qv[t]=new Pz),Qv[t]}function Mz(e,t){const n=e.toString();return Yv[n]||(Yv[n]=t()),Yv[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dz{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Al(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE="start",Lz="close",Vz="pLPCommand",qz="pRTLPCB",nL="id",iL="pw",rL="ser",jz="cb",Fz="seg",Uz="ts",Oz="d",Bz="dframe",sL=1870,oL=30,Gz=sL-oL,Hz=25e3,$z=3e4;class _c{constructor(t,n,i,r,s,o,a){this.connId=t,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=hd(t),this.stats_=Kw(n),this.urlFn=c=>(this.appCheckToken&&(c[s0]=this.appCheckToken),eL(n,ZD,c))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Dz(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($z)),_z(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ww((...s)=>{const[o,a,c,h,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===aE)this.id=a,this.password=c;else if(o===Lz)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[aE]="t",i[rL]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[jz]=this.scriptTagHolder.uniqueCallbackIdentifier),i[$D]=zw,this.transportSessionId&&(i[zD]=this.transportSessionId),this.lastSessionId&&(i[YD]=this.lastSessionId),this.applicationId&&(i[JD]=this.applicationId),this.appCheckToken&&(i[s0]=this.appCheckToken),typeof location<"u"&&location.hostname&&QD.test(location.hostname)&&(i[KD]=WD);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_c.forceAllow_=!0}static forceDisallow(){_c.forceDisallow_=!0}static isAvailable(){return _c.forceAllow_?!0:!_c.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!bz()&&!Tz()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=gn(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=DM(n),r=GD(i,Gz);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[Bz]="t",i[nL]=t,i[iL]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=gn(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Ww{constructor(t,n,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=vz(),window[Vz+this.uniqueCallbackIdentifier]=t,window[qz+this.uniqueCallbackIdentifier]=n,this.myIFrame=Ww.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Mn("frame writing exception"),a.stack&&Mn(a.stack),Mn(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Mn("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[nL]=this.myID,t[iL]=this.myPW,t[rL]=this.currentSerial;let n=this.urlFn(t),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+oL+i.length<=sL;){const o=this.pendingSegs.shift();i=i+"&"+Fz+r+"="+o.seg+"&"+Uz+r+"="+o.ts+"&"+Oz+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(t,n,i){this.pendingSegs.push({seg:t,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(Hz)),s=()=>{clearTimeout(r),i()};this.addTag(t,s)}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{Mn("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zz=16384,Kz=45e3;let Bf=null;typeof MozWebSocket<"u"?Bf=MozWebSocket:typeof WebSocket<"u"&&(Bf=WebSocket);class lr{constructor(t,n,i,r,s,o,a){this.connId=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=hd(this.connId),this.stats_=Kw(n),this.connURL=lr.connectionURL_(n,o,a,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,i,r,s){const o={};return o[$D]=zw,typeof location<"u"&&location.hostname&&QD.test(location.hostname)&&(o[KD]=WD),n&&(o[zD]=n),i&&(o[YD]=i),r&&(o[s0]=r),s&&(o[JD]=s),eL(t,XD,o)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ha.set("previous_websocket_failure",!0);try{let i;N6(),this.mySock=new Bf(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){lr.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Bf!==null&&!lr.forceDisallow_}static previouslyFailed(){return ha.isInMemoryStorage||ha.get("previous_websocket_failure")===!0}markConnectionHealthy(){ha.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=xu(n);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(rt(this.frames===null,"We already have a frame buffer"),t.length<=6){const n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const n=gn(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=GD(n,zz);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Kz))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}lr.responsesRequiredToBeHealthy=2;lr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{static get ALL_TRANSPORTS(){return[_c,lr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const n=lr&&lr.isAvailable();let i=n&&!lr.previouslyFailed();if(t.webSocketOnly&&(n||mi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[lr];else{const r=this.transports_=[];for(const s of Su.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);Su.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Su.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz=6e4,Qz=5e3,Yz=10*1024,Jz=100*1024,Jv="t",cE="d",Xz="s",lE="r",Zz="e",hE="o",uE="a",dE="n",gE="p",t7="h";class e7{constructor(t,n,i,r,s,o,a,c,h,u){this.id=t,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=hd("c:"+this.id+":"),this.transportManager_=new Su(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=Gh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Jz?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Yz?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){const n={t:"d",d:t};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Jv in t){const n=t[Jv];n===uE?this.upgradeIfSecondaryHealthy_():n===lE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===hE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=lh("t",t),i=lh("d",t);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:gE,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:uE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:dE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=lh("t",t),i=lh("d",t);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=lh(Jv,t);if(cE in t){const i=t[cE];if(n===t7){const r={...i};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===dE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Xz?this.onConnectionShutdown_(i):n===lE?this.onReset_(i):n===Zz?r0("Server Error: "+i):n===hE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):r0("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,i=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),zw!==i&&mi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Gh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Wz))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Gh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Qz))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:gE,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ha.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{put(t,n,i,r){}merge(t,n,i,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,i){}onDisconnectMerge(t,n,i){}onDisconnectCancel(t,n){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(t){this.allowedEvents_=t,this.listeners_={},rt(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(t,n,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:i});const r=this.getInitialEvent(t);r&&n.apply(i,r)}off(t,n,i){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(t){rt(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf extends cL{static getInstance(){return new Gf}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!uw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return rt(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE=32,mE=768;class he{constructor(t,n){if(n===void 0){this.pieces_=t.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(t+="/"+this.pieces_[n]);return t||"/"}}function ne(){return new he("")}function Ot(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Do(e){return e.pieces_.length-e.pieceNum_}function ue(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new he(e.pieces_,t)}function lL(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function n7(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)e.pieces_[n]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function hL(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function uL(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new he(t,0)}function en(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof he)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const i=t.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new he(n,0)}function $t(e){return e.pieceNum_>=e.pieces_.length}function hi(e,t){const n=Ot(e),i=Ot(t);if(n===null)return t;if(n===i)return hi(ue(e),ue(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Qw(e,t){if(Do(e)!==Do(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function hr(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(Do(e)>Do(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class i7{constructor(t,n){this.errorPrefix_=n,this.parts_=hL(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Km(this.parts_[i]);dL(this)}}function r7(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Km(t),dL(e)}function s7(e){const t=e.parts_.pop();e.byteLength_-=Km(t),e.parts_.length>0&&(e.byteLength_-=1)}function dL(e){if(e.byteLength_>mE)throw new Error(e.errorPrefix_+"has a key path longer than "+mE+" bytes ("+e.byteLength_+").");if(e.parts_.length>fE)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+fE+") or object contains a cycle "+ia(e))}function ia(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends cL{static getInstance(){return new Yw}constructor(){super(["visible"]);let t,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(t){return rt(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=1e3,o7=60*5*1e3,pE=30*1e3,a7=1.3,c7=3e4,l7="server_kill",vE=3;class ms extends aL{constructor(t,n,i,r,s,o,a,c){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=ms.nextPersistentConnectionId_++,this.log_=hd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=hh,this.maxReconnectDelay_=o7,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Yw.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Gf.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){const r=++this.requestNumber_,s={r,a:t,b:n};this.log_(gn(s)),rt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(t){this.initConnection_();const n=new Hm,r={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(t,n,i,r){this.initConnection_();const s=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),rt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),rt(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:t,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(t){const n=t.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},o="q";t.tag&&(s.q=n._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(o,s,a=>{const c=a.d,h=a.s;ms.warnOnListenWarnings_(c,n),(this.listens.get(i)&&this.listens.get(i).get(r))===t&&(this.log_("listen response",a),h!=="ok"&&this.removeListen_(i,r),t.onComplete&&t.onComplete(h,c))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Vs(t,"w")){const i=el(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();mi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||M6(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=pE)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,n=P6(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{const s=r.s,o=r.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const n=t.s,i=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(t,n){const i=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),rt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,t._queryObject,n)}sendUnlisten_(t,n,i,r){this.log_("Unlisten on "+t+" for "+n);const s={p:t},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:i})}onDisconnectMerge(t,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:i})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,i,r){const s={p:n,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(t,n,i,r){this.putInternal("p",t,n,i,r)}merge(t,n,i,r){this.putInternal("m",t,n,i,r)}putInternal(t,n,i,r,s){this.initConnection_();const o={p:n,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(t){const n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(t){if(this.connected_){const n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+gn(t));const n=t.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):r0("Unrecognized action received from server: "+gn(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){rt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=hh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=hh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>c7&&(this.reconnectDelay_=hh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*a7)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+ms.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,i())},h=function(d){rt(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:c,sendRequest:h};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Mn("getToken() completed but was canceled"):(Mn("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,a=new e7(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,v=>{mi(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(l7)},s))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&mi(d),c())}}}interrupt(t){Mn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Mn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Lx(this.interruptReasons_)&&(this.reconnectDelay_=hh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let i;n?i=n.map(s=>$w(s)).join("$"):i="default";const r=this.removeListen_(t,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(t,n){const i=new he(t).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(t,n){Mn("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vE&&(this.reconnectDelay_=pE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){Mn("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let n="js";t["sdk."+n+"."+FD.replace(/\./g,"-")]=1,uw()?t["framework.cordova"]=1:UM()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Gf.getInstance().currentlyOnline();return Lx(this.interruptReasons_)&&t}}ms.nextPersistentConnectionId_=0;ms.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new Bt(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const i=new Bt(ll,t),r=new Bt(ll,n);return this.compare(i,r)!==0}minPost(){return Bt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rg;class gL extends xp{static get __EMPTY_NODE(){return rg}static set __EMPTY_NODE(t){rg=t}compare(t,n){return Il(t.name,n.name)}isDefinedOn(t){throw bl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return Bt.MIN}maxPost(){return new Bt(Aa,rg)}makePost(t,n){return rt(typeof t=="string","KeyIndex indexValue must always be a string."),new Bt(t,rg)}toString(){return".key"}}const jc=new gL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(t,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(t=t,o=n?i(t.key,n):1,r&&(o*=-1),o<0)this.isReverse_?t=t.left:t=t.right;else if(o===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(t.key,t.value):n={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class dn{constructor(t,n,i,r,s){this.key=t,this.value=n,this.color=i??dn.RED,this.left=r??ui.EMPTY_NODE,this.right=s??ui.EMPTY_NODE}copy(t,n,i,r,s){return new dn(t??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let r=this;const s=i(t,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(t,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(t,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return ui.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let i,r;if(i=this,n(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(t,i.key)===0){if(i.right.isEmpty())return ui.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}dn.RED=!0;dn.BLACK=!1;class h7{copy(t,n,i,r,s){return this}insert(t,n,i){return new dn(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ui{constructor(t,n=ui.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new ui(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,dn.BLACK,null,null))}remove(t){return new ui(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,dn.BLACK,null,null))}get(t){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(t,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(t){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(t,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new sg(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new sg(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new sg(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new sg(this.root_,null,this.comparator_,!0,t)}}ui.EMPTY_NODE=new h7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u7(e,t){return Il(e.name,t.name)}function Jw(e,t){return Il(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o0;function d7(e){o0=e}const fL=function(e){return typeof e=="number"?"number:"+HD(e):"string:"+e},mL=function(e){if(e.isLeafNode()){const t=e.val();rt(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Vs(t,".sv"),"Priority must be a string or number.")}else rt(e===o0||e.isEmpty(),"priority of unexpected type.");rt(e===o0||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yE;class ln{static set __childrenNodeConstructor(t){yE=t}static get __childrenNodeConstructor(){return yE}constructor(t,n=ln.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,rt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),mL(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new ln(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:ln.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return $t(t)?this:Ot(t)===".priority"?this.priorityNode_:ln.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:ln.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){const i=Ot(t);return i===null?n:n.isEmpty()&&i!==".priority"?this:(rt(i!==".priority"||Do(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ln.__childrenNodeConstructor.EMPTY_NODE.updateChild(ue(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+fL(this.priorityNode_.val())+":");const n=typeof this.value_;t+=n+":",n==="number"?t+=HD(this.value_):t+=this.value_,this.lazyHash_=OD(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===ln.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof ln.__childrenNodeConstructor?-1:(rt(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,i=typeof this.value_,r=ln.VALUE_TYPE_ORDER.indexOf(n),s=ln.VALUE_TYPE_ORDER.indexOf(i);return rt(r>=0,"Unknown leaf type: "+n),rt(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}ln.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pL,vL;function g7(e){pL=e}function f7(e){vL=e}class m7 extends xp{compare(t,n){const i=t.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Il(t.name,n.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return Bt.MIN}maxPost(){return new Bt(Aa,new ln("[PRIORITY-POST]",vL))}makePost(t,n){const i=pL(t);return new Bt(n,new ln("[PRIORITY-POST]",i))}toString(){return".priority"}}const je=new m7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p7=Math.log(2);class v7{constructor(t){const n=s=>parseInt(Math.log(s)/p7,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(t+1),this.current_=this.count-1;const r=i(this.count);this.bits_=t+1&r}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Hf=function(e,t,n,i){e.sort(t);const r=function(c,h){const u=h-c;let d,f;if(u===0)return null;if(u===1)return d=e[c],f=n?n(d):d,new dn(f,d.node,dn.BLACK,null,null);{const v=parseInt(u/2,10)+c,y=r(c,v),_=r(v+1,h);return d=e[v],f=n?n(d):d,new dn(f,d.node,dn.BLACK,y,_)}},s=function(c){let h=null,u=null,d=e.length;const f=function(y,_){const w=d-y,x=d;d-=y;const C=r(w+1,x),k=e[w],P=n?n(k):k;v(new dn(P,k.node,_,null,C))},v=function(y){h?(h.left=y,h=y):(u=y,h=y)};for(let y=0;y<c.count;++y){const _=c.nextBitIsOne(),w=Math.pow(2,c.count-(y+1));_?f(w,dn.BLACK):(f(w,dn.BLACK),f(w,dn.RED))}return u},o=new v7(e.length),a=s(o);return new ui(i||t,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xv;const ec={};class as{static get Default(){return rt(ec&&je,"ChildrenNode.ts has not been loaded"),Xv=Xv||new as({".priority":ec},{".priority":je}),Xv}constructor(t,n){this.indexes_=t,this.indexSet_=n}get(t){const n=el(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof ui?n:null}hasIndex(t){return Vs(this.indexSet_,t.toString())}addIndex(t,n){rt(t!==jc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=n.getIterator(Bt.Wrap);let o=s.getNext();for(;o;)r=r||t.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Hf(i,t.getCompare()):a=ec;const c=t.toString(),h={...this.indexSet_};h[c]=t;const u={...this.indexes_};return u[c]=a,new as(u,h)}addToIndexes(t,n){const i=Sf(this.indexes_,(r,s)=>{const o=el(this.indexSet_,s);if(rt(o,"Missing index implementation for "+s),r===ec)if(o.isDefinedOn(t.node)){const a=[],c=n.getIterator(Bt.Wrap);let h=c.getNext();for(;h;)h.name!==t.name&&a.push(h),h=c.getNext();return a.push(t),Hf(a,o.getCompare())}else return ec;else{const a=n.get(t.name);let c=r;return a&&(c=c.remove(new Bt(t.name,a))),c.insert(t,t.node)}});return new as(i,this.indexSet_)}removeFromIndexes(t,n){const i=Sf(this.indexes_,r=>{if(r===ec)return r;{const s=n.get(t.name);return s?r.remove(new Bt(t.name,s)):r}});return new as(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uh;class At{static get EMPTY_NODE(){return uh||(uh=new At(new ui(Jw),null,as.Default))}constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&mL(this.priorityNode_),this.children_.isEmpty()&&rt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||uh}updatePriority(t){return this.children_.isEmpty()?this:new At(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const n=this.children_.get(t);return n===null?uh:n}}getChild(t){const n=Ot(t);return n===null?this:this.getImmediateChild(n).getChild(ue(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if(rt(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{const i=new Bt(t,n);let r,s;n.isEmpty()?(r=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?uh:this.priorityNode_;return new At(r,o,s)}}updateChild(t,n){const i=Ot(t);if(i===null)return n;{rt(Ot(t)!==".priority"||Do(t)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(ue(t),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(je,(o,a)=>{n[o]=a.val(t),i++,s&&At.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!t&&s&&r<2*i){const o=[];for(const a in n)o[a]=n[a];return o}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+fL(this.getPriority().val())+":"),this.forEachChild(je,(n,i)=>{const r=i.hash();r!==""&&(t+=":"+n+":"+r)}),this.lazyHash_=t===""?"":OD(t)}return this.lazyHash_}getPredecessorChildName(t,n,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new Bt(t,n));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const n=this.getFirstChildName(t);return n?new Bt(n,this.children_.get(n)):null}getLastChildName(t){const n=this.resolveIndex_(t);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const n=this.getLastChildName(t);return n?new Bt(n,this.children_.get(n)):null}forEachChild(t,n){const i=this.resolveIndex_(t);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(t,r=>r);{const r=this.children_.getIteratorFrom(t.name,Bt.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(t,r=>r);{const r=this.children_.getReverseIteratorFrom(t.name,Bt.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,t)>0;)r.getNext(),s=r.peek();return r}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ud?-1:0}withIndex(t){if(t===jc||this.indexMap_.hasIndex(t))return this;{const n=this.indexMap_.addIndex(t,this.children_);return new At(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===jc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(je),r=n.getIterator(je);let s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(t){return t===jc?null:this.indexMap_.get(t.toString())}}At.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class y7 extends At{constructor(){super(new ui(Jw),At.EMPTY_NODE,as.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return At.EMPTY_NODE}isEmpty(){return!1}}const ud=new y7;Object.defineProperties(Bt,{MIN:{value:new Bt(ll,At.EMPTY_NODE)},MAX:{value:new Bt(Aa,ud)}});gL.__EMPTY_NODE=At.EMPTY_NODE;ln.__childrenNodeConstructor=At;d7(ud);f7(ud);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7=!0;function bn(e,t=null){if(e===null)return At.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),rt(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const n=e;return new ln(n,bn(t))}if(!(e instanceof Array)&&x7){const n=[];let i=!1;if(pi(e,(o,a)=>{if(o.substring(0,1)!=="."){const c=bn(a);c.isEmpty()||(i=i||!c.getPriority().isEmpty(),n.push(new Bt(o,c)))}}),n.length===0)return At.EMPTY_NODE;const s=Hf(n,u7,o=>o.name,Jw);if(i){const o=Hf(n,je.getCompare());return new At(s,bn(t),new as({".priority":o},{".priority":je}))}else return new At(s,bn(t),as.Default)}else{let n=At.EMPTY_NODE;return pi(e,(i,r)=>{if(Vs(e,i)&&i.substring(0,1)!=="."){const s=bn(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(bn(t))}}g7(bn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7 extends xp{constructor(t){super(),this.indexPath_=t,rt(!$t(t)&&Ot(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const i=this.extractChild(t.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Il(t.name,n.name):s}makePost(t,n){const i=bn(t),r=At.EMPTY_NODE.updateChild(this.indexPath_,i);return new Bt(n,r)}maxPost(){const t=At.EMPTY_NODE.updateChild(this.indexPath_,ud);return new Bt(Aa,t)}toString(){return hL(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w7 extends xp{compare(t,n){const i=t.node.compareTo(n.node);return i===0?Il(t.name,n.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return Bt.MIN}maxPost(){return Bt.MAX}makePost(t,n){const i=bn(t);return new Bt(n,i)}toString(){return".value"}}const b7=new w7;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(e){return{type:"value",snapshotNode:e}}function hl(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Iu(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Au(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function T7(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(t){this.index_=t}updateChild(t,n,i,r,s,o){rt(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?t.hasChild(n)?o.trackChildChange(Iu(n,a)):rt(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(hl(n,i)):o.trackChildChange(Au(n,i,a))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(t,n,i){return i!=null&&(t.isLeafNode()||t.forEachChild(je,(r,s)=>{n.hasChild(r)||i.trackChildChange(Iu(r,s))}),n.isLeafNode()||n.forEachChild(je,(r,s)=>{if(t.hasChild(r)){const o=t.getImmediateChild(r);o.equals(s)||i.trackChildChange(Au(r,s,o))}else i.trackChildChange(hl(r,s))})),n.withIndex(this.index_)}updatePriority(t,n){return t.isEmpty()?At.EMPTY_NODE:t.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(t){this.indexedFilter_=new Xw(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Ru.getStartPost_(t),this.endPost_=Ru.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return n&&i}updateChild(t,n,i,r,s,o){return this.matches(new Bt(n,i))||(i=At.EMPTY_NODE),this.indexedFilter_.updateChild(t,n,i,r,s,o)}updateFullNode(t,n,i){n.isLeafNode()&&(n=At.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(At.EMPTY_NODE);const s=this;return n.forEachChild(je,(o,a)=>{s.matches(new Bt(o,a))||(r=r.updateImmediateChild(o,At.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,i)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const n=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),n)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const n=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),n)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(t){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{const i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Ru(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,n,i,r,s,o){return this.rangedFilter_.matches(new Bt(n,i))||(i=At.EMPTY_NODE),t.getImmediateChild(n).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,n,i,r,s,o):this.fullLimitUpdateChild_(t,n,i,s,o)}updateFullNode(t,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=At.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=At.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(At.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,At.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,i)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,i,r,s){let o;if(this.reverse_){const d=this.index_.getCompare();o=(f,v)=>d(v,f)}else o=this.index_.getCompare();const a=t;rt(a.numChildren()===this.limit_,"");const c=new Bt(n,i),h=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const d=a.getImmediateChild(n);let f=r.getChildAfterChild(this.index_,h,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);const v=f==null?1:o(f,c);if(u&&!i.isEmpty()&&v>=0)return s!=null&&s.trackChildChange(Au(n,i,d)),a.updateImmediateChild(n,i);{s!=null&&s.trackChildChange(Iu(n,d));const _=a.updateImmediateChild(n,At.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s!=null&&s.trackChildChange(hl(f.name,f.node)),_.updateImmediateChild(f.name,f.node)):_}}else return i.isEmpty()?t:u&&o(h,c)>=0?(s!=null&&(s.trackChildChange(Iu(h.name,h.node)),s.trackChildChange(hl(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(h.name,At.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=je}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return rt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return rt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ll}hasEnd(){return this.endSet_}getIndexEndValue(){return rt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return rt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Aa}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return rt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===je}copy(){const t=new Zw;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function k7(e){return e.loadsAllData()?new Xw(e.getIndex()):e.hasLimit()?new C7(e):new Ru(e)}function xE(e){const t={};if(e.isDefault())return t;let n;if(e.index_===je?n="$priority":e.index_===b7?n="$value":e.index_===jc?n="$key":(rt(e.index_ instanceof _7,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=gn(n),e.startSet_){const i=e.startAfterSet_?"startAfter":"startAt";t[i]=gn(e.indexStartValue_),e.startNameSet_&&(t[i]+=","+gn(e.indexStartName_))}if(e.endSet_){const i=e.endBeforeSet_?"endBefore":"endAt";t[i]=gn(e.indexEndValue_),e.endNameSet_&&(t[i]+=","+gn(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function _E(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;n===""&&(e.isViewFromLeft()?n="l":n="r"),t.vf=n}return e.index_!==je&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f extends aL{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return n!==void 0?"tag$"+n:(rt(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,n,i,r){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=hd("p:rest:"),this.listens_={}}listen(t,n,i,r){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=$f.getListenId_(t,i),a={};this.listens_[o]=a;const c=xE(t._queryParams);this.restRequest_(s+".json",c,(h,u)=>{let d=u;if(h===404&&(d=null,h=null),h===null&&this.onDataUpdate_(s,d,!1,i),el(this.listens_,o)===a){let f;h?h===401?f="permission_denied":f="rest_error:"+h:f="ok",r(f,null)}})}unlisten(t,n){const i=$f.getListenId_(t,n);delete this.listens_[i]}get(t){const n=xE(t._queryParams),i=t._path.toString(),r=new Hm;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(t){}restRequest_(t,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+Tl(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=xu(a.responseText)}catch{mi("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,c)}else a.status!==401&&a.status!==404&&mi("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(){this.rootNode_=At.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(){return{value:null,children:new Map}}function xL(e,t,n){if($t(t))e.value=n,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,n);else{const i=Ot(t);e.children.has(i)||e.children.set(i,zf());const r=e.children.get(i);t=ue(t),xL(r,t,n)}}function a0(e,t,n){e.value!==null?n(t,e.value):E7(e,(i,r)=>{const s=new he(t.toString()+"/"+i);a0(r,s,n)})}function E7(e,t){e.children.forEach((n,i)=>{t(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n={...t};return this.last_&&pi(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=10*1e3,I7=30*1e3,A7=5*60*1e3;class R7{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new S7(t);const i=wE+(I7-wE)*Math.random();Gh(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),n={};let i=!1;pi(t,(r,s)=>{s>0&&Vs(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),Gh(this.reportStats_.bind(this),Math.floor(Math.random()*2*A7))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ur||(ur={}));function _L(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function tb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function eb(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(t,n,i){this.path=t,this.affectedTree=n,this.revert=i,this.type=ur.ACK_USER_WRITE,this.source=_L()}operationForChild(t){if($t(this.path)){if(this.affectedTree.value!=null)return rt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new he(t));return new Kf(ne(),n,this.revert)}}else return rt(Ot(this.path)===t,"operationForChild called for unrelated child."),new Kf(ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(t,n){this.source=t,this.path=n,this.type=ur.LISTEN_COMPLETE}operationForChild(t){return $t(this.path)?new Pu(this.source,ne()):new Pu(this.source,ue(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(t,n,i){this.source=t,this.path=n,this.snap=i,this.type=ur.OVERWRITE}operationForChild(t){return $t(this.path)?new Ra(this.source,ne(),this.snap.getImmediateChild(t)):new Ra(this.source,ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(t,n,i){this.source=t,this.path=n,this.children=i,this.type=ur.MERGE}operationForChild(t){if($t(this.path)){const n=this.children.subtree(new he(t));return n.isEmpty()?null:n.value?new Ra(this.source,ne(),n.value):new Mu(this.source,ne(),n)}else return rt(Ot(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Mu(this.source,ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(t,n,i){this.node_=t,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if($t(t))return this.isFullyInitialized()&&!this.filtered_;const n=Ot(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function M7(e,t,n,i){const r=[],s=[];return t.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(T7(o.childName,o.snapshotNode))}),dh(e,r,"child_removed",t,i,n),dh(e,r,"child_added",t,i,n),dh(e,r,"child_moved",s,i,n),dh(e,r,"child_changed",t,i,n),dh(e,r,"value",t,i,n),r}function dh(e,t,n,i,r,s){const o=i.filter(a=>a.type===n);o.sort((a,c)=>L7(e,a,c)),o.forEach(a=>{const c=D7(e,a,s);r.forEach(h=>{h.respondsTo(a.type)&&t.push(h.createEvent(c,e.query_))})})}function D7(e,t,n){return t.type==="value"||t.type==="child_removed"||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function L7(e,t,n){if(t.childName==null||n.childName==null)throw bl("Should only compare child_ events.");const i=new Bt(t.childName,t.snapshotNode),r=new Bt(n.childName,n.snapshotNode);return e.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(e,t){return{eventCache:e,serverCache:t}}function Hh(e,t,n,i){return _p(new Pa(t,n,i),e.serverCache)}function wL(e,t,n,i){return _p(e.eventCache,new Pa(t,n,i))}function c0(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ma(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zv;const V7=()=>(Zv||(Zv=new ui(wz)),Zv);class ye{static fromObject(t){let n=new ye(null);return pi(t,(i,r)=>{n=n.set(new he(i),r)}),n}constructor(t,n=V7()){this.value=t,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(this.value!=null&&n(this.value))return{path:ne(),value:this.value};if($t(t))return null;{const i=Ot(t),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(ue(t),n);return s!=null?{path:en(new he(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if($t(t))return this;{const n=Ot(t),i=this.children.get(n);return i!==null?i.subtree(ue(t)):new ye(null)}}set(t,n){if($t(t))return new ye(n,this.children);{const i=Ot(t),s=(this.children.get(i)||new ye(null)).set(ue(t),n),o=this.children.insert(i,s);return new ye(this.value,o)}}remove(t){if($t(t))return this.children.isEmpty()?new ye(null):new ye(null,this.children);{const n=Ot(t),i=this.children.get(n);if(i){const r=i.remove(ue(t));let s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new ye(null):new ye(this.value,s)}else return this}}get(t){if($t(t))return this.value;{const n=Ot(t),i=this.children.get(n);return i?i.get(ue(t)):null}}setTree(t,n){if($t(t))return n;{const i=Ot(t),s=(this.children.get(i)||new ye(null)).setTree(ue(t),n);let o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new ye(this.value,o)}}fold(t){return this.fold_(ne(),t)}fold_(t,n){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(en(t,r),n)}),n(t,this.value,i)}findOnPath(t,n){return this.findOnPath_(t,ne(),n)}findOnPath_(t,n,i){const r=this.value?i(n,this.value):!1;if(r)return r;if($t(t))return null;{const s=Ot(t),o=this.children.get(s);return o?o.findOnPath_(ue(t),en(n,s),i):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,ne(),n)}foreachOnPath_(t,n,i){if($t(t))return this;{this.value&&i(n,this.value);const r=Ot(t),s=this.children.get(r);return s?s.foreachOnPath_(ue(t),en(n,r),i):new ye(null)}}foreach(t){this.foreach_(ne(),t)}foreach_(t,n){this.children.inorderTraversal((i,r)=>{r.foreach_(en(t,i),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,i)=>{i.value&&t(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(t){this.writeTree_=t}static empty(){return new _r(new ye(null))}}function $h(e,t,n){if($t(t))return new _r(new ye(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(i!=null){const r=i.path;let s=i.value;const o=hi(r,t);return s=s.updateChild(o,n),new _r(e.writeTree_.set(r,s))}else{const r=new ye(n),s=e.writeTree_.setTree(t,r);return new _r(s)}}}function bE(e,t,n){let i=e;return pi(n,(r,s)=>{i=$h(i,en(t,r),s)}),i}function TE(e,t){if($t(t))return _r.empty();{const n=e.writeTree_.setTree(t,new ye(null));return new _r(n)}}function l0(e,t){return za(e,t)!=null}function za(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return n!=null?e.writeTree_.get(n.path).getChild(hi(n.path,t)):null}function CE(e){const t=[],n=e.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(je,(i,r)=>{t.push(new Bt(i,r))}):e.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&t.push(new Bt(i,r.value))}),t}function To(e,t){if($t(t))return e;{const n=za(e,t);return n!=null?new _r(new ye(n)):new _r(e.writeTree_.subtree(t))}}function h0(e){return e.writeTree_.isEmpty()}function ul(e,t){return bL(ne(),e.writeTree_,t)}function bL(e,t,n){if(t.value!=null)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal((r,s)=>{r===".priority"?(rt(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=bL(en(e,r),s,n)}),!n.getChild(e).isEmpty()&&i!==null&&(n=n.updateChild(en(e,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(e,t){return NL(t,e)}function q7(e,t,n,i,r){rt(i>e.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=$h(e.visibleWrites,t,n)),e.lastWriteId=i}function j7(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}function F7(e,t){const n=e.allWrites.findIndex(a=>a.writeId===t);rt(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const a=e.allWrites[o];a.visible&&(o>=n&&U7(a,i.path)?r=!1:hr(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return O7(e),!0;if(i.snap)e.visibleWrites=TE(e.visibleWrites,i.path);else{const a=i.children;pi(a,c=>{e.visibleWrites=TE(e.visibleWrites,en(i.path,c))})}return!0}else return!1}function U7(e,t){if(e.snap)return hr(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&hr(en(e.path,n),t))return!0;return!1}function O7(e){e.visibleWrites=TL(e.allWrites,B7,ne()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function B7(e){return e.visible}function TL(e,t,n){let i=_r.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const o=s.path;let a;if(s.snap)hr(n,o)?(a=hi(n,o),i=$h(i,a,s.snap)):hr(o,n)&&(a=hi(o,n),i=$h(i,ne(),s.snap.getChild(a)));else if(s.children){if(hr(n,o))a=hi(n,o),i=bE(i,a,s.children);else if(hr(o,n))if(a=hi(o,n),$t(a))i=bE(i,ne(),s.children);else{const c=el(s.children,Ot(a));if(c){const h=c.getChild(ue(a));i=$h(i,ne(),h)}}}else throw bl("WriteRecord should have .snap or .children")}}return i}function CL(e,t,n,i,r){if(!i&&!r){const s=za(e.visibleWrites,t);if(s!=null)return s;{const o=To(e.visibleWrites,t);if(h0(o))return n;if(n==null&&!l0(o,ne()))return null;{const a=n||At.EMPTY_NODE;return ul(o,a)}}}else{const s=To(e.visibleWrites,t);if(!r&&h0(s))return n;if(!r&&n==null&&!l0(s,ne()))return null;{const o=function(h){return(h.visible||r)&&(!i||!~i.indexOf(h.writeId))&&(hr(h.path,t)||hr(t,h.path))},a=TL(e.allWrites,o,t),c=n||At.EMPTY_NODE;return ul(a,c)}}}function G7(e,t,n){let i=At.EMPTY_NODE;const r=za(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(je,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){const s=To(e.visibleWrites,t);return n.forEachChild(je,(o,a)=>{const c=ul(To(s,new he(o)),a);i=i.updateImmediateChild(o,c)}),CE(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const s=To(e.visibleWrites,t);return CE(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function H7(e,t,n,i,r){rt(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=en(t,n);if(l0(e.visibleWrites,s))return null;{const o=To(e.visibleWrites,s);return h0(o)?r.getChild(n):ul(o,r.getChild(n))}}function $7(e,t,n,i){const r=en(t,n),s=za(e.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){const o=To(e.visibleWrites,r);return ul(o,i.getNode().getImmediateChild(n))}else return null}function z7(e,t){return za(e.visibleWrites,t)}function K7(e,t,n,i,r,s,o){let a;const c=To(e.visibleWrites,t),h=za(c,ne());if(h!=null)a=h;else if(n!=null)a=ul(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=o.getCompare(),f=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let v=f.getNext();for(;v&&u.length<r;)d(v,i)!==0&&u.push(v),v=f.getNext();return u}else return[]}function W7(){return{visibleWrites:_r.empty(),allWrites:[],lastWriteId:-1}}function Wf(e,t,n,i){return CL(e.writeTree,e.treePath,t,n,i)}function ib(e,t){return G7(e.writeTree,e.treePath,t)}function kE(e,t,n,i){return H7(e.writeTree,e.treePath,t,n,i)}function Qf(e,t){return z7(e.writeTree,en(e.treePath,t))}function Q7(e,t,n,i,r,s){return K7(e.writeTree,e.treePath,t,n,i,r,s)}function rb(e,t,n){return $7(e.writeTree,e.treePath,t,n)}function kL(e,t){return NL(en(e.treePath,t),e.writeTree)}function NL(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,i=t.childName;rt(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),rt(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Au(i,t.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Iu(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,hl(i,t.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Au(i,t.snapshotNode,r.oldSnap));else throw bl("Illegal combination of changes: "+t+" occurred after "+r)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{getCompleteChild(t){return null}getChildAfterChild(t,n,i){return null}}const EL=new J7;class sb{constructor(t,n,i=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Pa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rb(this.writes_,t,i)}}getChildAfterChild(t,n,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ma(this.viewCache_),s=Q7(this.writes_,r,n,1,i,t);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X7(e){return{filter:e}}function Z7(e,t){rt(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),rt(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function tK(e,t,n,i,r){const s=new Y7;let o,a;if(n.type===ur.OVERWRITE){const h=n;h.source.fromUser?o=u0(e,t,h.path,h.snap,i,r,s):(rt(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered()&&!$t(h.path),o=Yf(e,t,h.path,h.snap,i,r,a,s))}else if(n.type===ur.MERGE){const h=n;h.source.fromUser?o=nK(e,t,h.path,h.children,i,r,s):(rt(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered(),o=d0(e,t,h.path,h.children,i,r,a,s))}else if(n.type===ur.ACK_USER_WRITE){const h=n;h.revert?o=sK(e,t,h.path,i,r,s):o=iK(e,t,h.path,h.affectedTree,i,r,s)}else if(n.type===ur.LISTEN_COMPLETE)o=rK(e,t,n.path,i,s);else throw bl("Unknown operation type: "+n.type);const c=s.getChanges();return eK(t,o,c),{viewCache:o,changes:c}}function eK(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=c0(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(yL(c0(t)))}}function SL(e,t,n,i,r,s){const o=t.eventCache;if(Qf(i,n)!=null)return t;{let a,c;if($t(n))if(rt(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const h=Ma(t),u=h instanceof At?h:At.EMPTY_NODE,d=ib(i,u);a=e.filter.updateFullNode(t.eventCache.getNode(),d,s)}else{const h=Wf(i,Ma(t));a=e.filter.updateFullNode(t.eventCache.getNode(),h,s)}else{const h=Ot(n);if(h===".priority"){rt(Do(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=t.serverCache.getNode();const d=kE(i,n,u,c);d!=null?a=e.filter.updatePriority(u,d):a=o.getNode()}else{const u=ue(n);let d;if(o.isCompleteForChild(h)){c=t.serverCache.getNode();const f=kE(i,n,o.getNode(),c);f!=null?d=o.getNode().getImmediateChild(h).updateChild(u,f):d=o.getNode().getImmediateChild(h)}else d=rb(i,h,t.serverCache);d!=null?a=e.filter.updateChild(o.getNode(),h,d,u,r,s):a=o.getNode()}}return Hh(t,a,o.isFullyInitialized()||$t(n),e.filter.filtersNodes())}}function Yf(e,t,n,i,r,s,o,a){const c=t.serverCache;let h;const u=o?e.filter:e.filter.getIndexedFilter();if($t(n))h=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){const v=c.getNode().updateChild(n,i);h=u.updateFullNode(c.getNode(),v,null)}else{const v=Ot(n);if(!c.isCompleteForPath(n)&&Do(n)>1)return t;const y=ue(n),w=c.getNode().getImmediateChild(v).updateChild(y,i);v===".priority"?h=u.updatePriority(c.getNode(),w):h=u.updateChild(c.getNode(),v,w,y,EL,null)}const d=wL(t,h,c.isFullyInitialized()||$t(n),u.filtersNodes()),f=new sb(r,d,s);return SL(e,d,n,r,f,a)}function u0(e,t,n,i,r,s,o){const a=t.eventCache;let c,h;const u=new sb(r,t,s);if($t(n))h=e.filter.updateFullNode(t.eventCache.getNode(),i,o),c=Hh(t,h,!0,e.filter.filtersNodes());else{const d=Ot(n);if(d===".priority")h=e.filter.updatePriority(t.eventCache.getNode(),i),c=Hh(t,h,a.isFullyInitialized(),a.isFiltered());else{const f=ue(n),v=a.getNode().getImmediateChild(d);let y;if($t(f))y=i;else{const _=u.getCompleteChild(d);_!=null?lL(f)===".priority"&&_.getChild(uL(f)).isEmpty()?y=_:y=_.updateChild(f,i):y=At.EMPTY_NODE}if(v.equals(y))c=t;else{const _=e.filter.updateChild(a.getNode(),d,y,f,u,o);c=Hh(t,_,a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function NE(e,t){return e.eventCache.isCompleteForChild(t)}function nK(e,t,n,i,r,s,o){let a=t;return i.foreach((c,h)=>{const u=en(n,c);NE(t,Ot(u))&&(a=u0(e,a,u,h,r,s,o))}),i.foreach((c,h)=>{const u=en(n,c);NE(t,Ot(u))||(a=u0(e,a,u,h,r,s,o))}),a}function EE(e,t,n){return n.foreach((i,r)=>{t=t.updateChild(i,r)}),t}function d0(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c=t,h;$t(n)?h=i:h=new ye(null).setTree(n,i);const u=t.serverCache.getNode();return h.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const v=t.serverCache.getNode().getImmediateChild(d),y=EE(e,v,f);c=Yf(e,c,new he(d),y,r,s,o,a)}}),h.children.inorderTraversal((d,f)=>{const v=!t.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!v){const y=t.serverCache.getNode().getImmediateChild(d),_=EE(e,y,f);c=Yf(e,c,new he(d),_,r,s,o,a)}}),c}function iK(e,t,n,i,r,s,o){if(Qf(r,n)!=null)return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(i.value!=null){if($t(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Yf(e,t,n,c.getNode().getChild(n),r,s,a,o);if($t(n)){let h=new ye(null);return c.getNode().forEachChild(jc,(u,d)=>{h=h.set(new he(u),d)}),d0(e,t,n,h,r,s,a,o)}else return t}else{let h=new ye(null);return i.foreach((u,d)=>{const f=en(n,u);c.isCompleteForPath(f)&&(h=h.set(u,c.getNode().getChild(f)))}),d0(e,t,n,h,r,s,a,o)}}function rK(e,t,n,i,r){const s=t.serverCache,o=wL(t,s.getNode(),s.isFullyInitialized()||$t(n),s.isFiltered());return SL(e,o,n,i,EL,r)}function sK(e,t,n,i,r,s){let o;if(Qf(i,n)!=null)return t;{const a=new sb(i,t,r),c=t.eventCache.getNode();let h;if($t(n)||Ot(n)===".priority"){let u;if(t.serverCache.isFullyInitialized())u=Wf(i,Ma(t));else{const d=t.serverCache.getNode();rt(d instanceof At,"serverChildren would be complete if leaf node"),u=ib(i,d)}u=u,h=e.filter.updateFullNode(c,u,s)}else{const u=Ot(n);let d=rb(i,u,t.serverCache);d==null&&t.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?h=e.filter.updateChild(c,u,d,ue(n),a,s):t.eventCache.getNode().hasChild(u)?h=e.filter.updateChild(c,u,At.EMPTY_NODE,ue(n),a,s):h=c,h.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Wf(i,Ma(t)),o.isLeafNode()&&(h=e.filter.updateFullNode(h,o,s)))}return o=t.serverCache.isFullyInitialized()||Qf(i,ne())!=null,Hh(t,h,o,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oK{constructor(t,n){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new Xw(i.getIndex()),s=k7(i);this.processor_=X7(s);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(At.EMPTY_NODE,o.getNode(),null),h=s.updateFullNode(At.EMPTY_NODE,a.getNode(),null),u=new Pa(c,o.isFullyInitialized(),r.filtersNodes()),d=new Pa(h,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=_p(d,u),this.eventGenerator_=new P7(this.query_)}get query(){return this.query_}}function aK(e){return e.viewCache_.serverCache.getNode()}function cK(e,t){const n=Ma(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!$t(t)&&!n.getImmediateChild(Ot(t)).isEmpty())?n.getChild(t):null}function SE(e){return e.eventRegistrations_.length===0}function lK(e,t){e.eventRegistrations_.push(t)}function IE(e,t,n){const i=[];if(n){rt(t==null,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,r);o&&i.push(o)})}if(t){let r=[];for(let s=0;s<e.eventRegistrations_.length;++s){const o=e.eventRegistrations_[s];if(!o.matches(t))r.push(o);else if(t.hasAnyCallback()){r=r.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=r}else e.eventRegistrations_=[];return i}function AE(e,t,n,i){t.type===ur.MERGE&&t.source.queryId!==null&&(rt(Ma(e.viewCache_),"We should always have a full cache before handling merges"),rt(c0(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=tK(e.processor_,r,t,n,i);return Z7(e.processor_,s.viewCache),rt(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,IL(e,s.changes,s.viewCache.eventCache.getNode(),null)}function hK(e,t){const n=e.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(je,(s,o)=>{i.push(hl(s,o))}),n.isFullyInitialized()&&i.push(yL(n.getNode())),IL(e,i,n.getNode(),t)}function IL(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return M7(e.eventGenerator_,t,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jf;class uK{constructor(){this.views=new Map}}function dK(e){rt(!Jf,"__referenceConstructor has already been defined"),Jf=e}function gK(){return rt(Jf,"Reference.ts has not been loaded"),Jf}function fK(e){return e.views.size===0}function ob(e,t,n,i){const r=t.source.queryId;if(r!==null){const s=e.views.get(r);return rt(s!=null,"SyncTree gave us an op for an invalid query."),AE(s,t,n,i)}else{let s=[];for(const o of e.views.values())s=s.concat(AE(o,t,n,i));return s}}function mK(e,t,n,i,r){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let a=Wf(n,r?i:null),c=!1;a?c=!0:i instanceof At?(a=ib(n,i),c=!1):(a=At.EMPTY_NODE,c=!1);const h=_p(new Pa(a,c,!1),new Pa(i,r,!1));return new oK(t,h)}return o}function pK(e,t,n,i,r,s){const o=mK(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),lK(o,n),hK(o,n)}function vK(e,t,n,i){const r=t._queryIdentifier,s=[];let o=[];const a=Lo(e);if(r==="default")for(const[c,h]of e.views.entries())o=o.concat(IE(h,n,i)),SE(h)&&(e.views.delete(c),h.query._queryParams.loadsAllData()||s.push(h.query));else{const c=e.views.get(r);c&&(o=o.concat(IE(c,n,i)),SE(c)&&(e.views.delete(r),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Lo(e)&&s.push(new(gK())(t._repo,t._path)),{removed:s,events:o}}function AL(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Fc(e,t){let n=null;for(const i of e.views.values())n=n||cK(i,t);return n}function RL(e,t){if(t._queryParams.loadsAllData())return wp(e);{const i=t._queryIdentifier;return e.views.get(i)}}function PL(e,t){return RL(e,t)!=null}function Lo(e){return wp(e)!=null}function wp(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xf;function yK(e){rt(!Xf,"__referenceConstructor has already been defined"),Xf=e}function xK(){return rt(Xf,"Reference.ts has not been loaded"),Xf}let _K=1;class RE{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ye(null),this.pendingWriteTree_=W7(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ML(e,t,n,i,r){return q7(e.pendingWriteTree_,t,n,i,r),r?dd(e,new Ra(_L(),t,n)):[]}function ua(e,t,n=!1){const i=j7(e.pendingWriteTree_,t);if(F7(e.pendingWriteTree_,t)){let s=new ye(null);return i.snap!=null?s=s.set(ne(),!0):pi(i.children,o=>{s=s.set(new he(o),!0)}),dd(e,new Kf(i.path,s,n))}else return[]}function bp(e,t,n){return dd(e,new Ra(tb(),t,n))}function wK(e,t,n){const i=ye.fromObject(n);return dd(e,new Mu(tb(),t,i))}function bK(e,t){return dd(e,new Pu(tb(),t))}function TK(e,t,n){const i=cb(e,n);if(i){const r=lb(i),s=r.path,o=r.queryId,a=hi(s,t),c=new Pu(eb(o),a);return hb(e,s,c)}else return[]}function g0(e,t,n,i,r=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&(t._queryIdentifier==="default"||PL(o,t))){const c=vK(o,t,n,i);fK(o)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const h=c.removed;if(a=c.events,!r){const u=h.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=e.syncPointTree_.findOnPath(s,(f,v)=>Lo(v));if(u&&!d){const f=e.syncPointTree_.subtree(s);if(!f.isEmpty()){const v=NK(f);for(let y=0;y<v.length;++y){const _=v[y],w=_.query,x=VL(e,_);e.listenProvider_.startListening(zh(w),Zf(e,w),x.hashFn,x.onComplete)}}}!d&&h.length>0&&!i&&(u?e.listenProvider_.stopListening(zh(t),null):h.forEach(f=>{const v=e.queryToTagMap.get(Tp(f));e.listenProvider_.stopListening(zh(f),v)}))}EK(e,h)}return a}function CK(e,t,n,i){const r=cb(e,i);if(r!=null){const s=lb(r),o=s.path,a=s.queryId,c=hi(o,t),h=new Ra(eb(a),c,n);return hb(e,o,h)}else return[]}function kK(e,t,n,i){const r=cb(e,i);if(r){const s=lb(r),o=s.path,a=s.queryId,c=hi(o,t),h=ye.fromObject(n),u=new Mu(eb(a),c,h);return hb(e,o,u)}else return[]}function PE(e,t,n,i=!1){const r=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(r,(f,v)=>{const y=hi(f,r);s=s||Fc(v,y),o=o||Lo(v)});let a=e.syncPointTree_.get(r);a?(o=o||Lo(a),s=s||Fc(a,ne())):(a=new uK,e.syncPointTree_=e.syncPointTree_.set(r,a));let c;s!=null?c=!0:(c=!1,s=At.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((v,y)=>{const _=Fc(y,ne());_&&(s=s.updateImmediateChild(v,_))}));const h=PL(a,t);if(!h&&!t._queryParams.loadsAllData()){const f=Tp(t);rt(!e.queryToTagMap.has(f),"View does not exist, but we have a tag");const v=SK();e.queryToTagMap.set(f,v),e.tagToQueryMap.set(v,f)}const u=nb(e.pendingWriteTree_,r);let d=pK(a,t,n,u,s,c);if(!h&&!o&&!i){const f=RL(a,t);d=d.concat(IK(e,t,f))}return d}function ab(e,t,n){const r=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(o,a)=>{const c=hi(o,t),h=Fc(a,c);if(h)return h});return CL(r,t,s,n,!0)}function dd(e,t){return DL(t,e.syncPointTree_,null,nb(e.pendingWriteTree_,ne()))}function DL(e,t,n,i){if($t(e.path))return LL(e,t,n,i);{const r=t.get(ne());n==null&&r!=null&&(n=Fc(r,ne()));let s=[];const o=Ot(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const h=n?n.getImmediateChild(o):null,u=kL(i,o);s=s.concat(DL(a,c,h,u))}return r&&(s=s.concat(ob(r,e,i,n))),s}}function LL(e,t,n,i){const r=t.get(ne());n==null&&r!=null&&(n=Fc(r,ne()));let s=[];return t.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,h=kL(i,o),u=e.operationForChild(o);u&&(s=s.concat(LL(u,a,c,h)))}),r&&(s=s.concat(ob(r,e,i,n))),s}function VL(e,t){const n=t.query,i=Zf(e,n);return{hashFn:()=>(aK(t)||At.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?TK(e,n._path,i):bK(e,n._path);{const s=Cz(r,n);return g0(e,n,null,s)}}}}function Zf(e,t){const n=Tp(t);return e.queryToTagMap.get(n)}function Tp(e){return e._path.toString()+"$"+e._queryIdentifier}function cb(e,t){return e.tagToQueryMap.get(t)}function lb(e){const t=e.indexOf("$");return rt(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new he(e.substr(0,t))}}function hb(e,t,n){const i=e.syncPointTree_.get(t);rt(i,"Missing sync point for query tag that we're tracking");const r=nb(e.pendingWriteTree_,t);return ob(i,n,r,null)}function NK(e){return e.fold((t,n,i)=>{if(n&&Lo(n))return[wp(n)];{let r=[];return n&&(r=AL(n)),pi(i,(s,o)=>{r=r.concat(o)}),r}})}function zh(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(xK())(e._repo,e._path):e}function EK(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const r=Tp(i),s=e.queryToTagMap.get(r);e.queryToTagMap.delete(r),e.tagToQueryMap.delete(s)}}}function SK(){return _K++}function IK(e,t,n){const i=t._path,r=Zf(e,t),s=VL(e,n),o=e.listenProvider_.startListening(zh(t),r,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(i);if(r)rt(!Lo(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((h,u,d)=>{if(!$t(h)&&u&&Lo(u))return[wp(u).query];{let f=[];return u&&(f=f.concat(AL(u).map(v=>v.query))),pi(d,(v,y)=>{f=f.concat(y)}),f}});for(let h=0;h<c.length;++h){const u=c[h];e.listenProvider_.stopListening(zh(u),Zf(e,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new ub(n)}node(){return this.node_}}class db{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=en(this.path_,t);return new db(this.syncTree_,n)}node(){return ab(this.syncTree_,this.path_)}}const AK=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},ME=function(e,t,n){if(!e||typeof e!="object")return e;if(rt(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return RK(e[".sv"],t,n);if(typeof e[".sv"]=="object")return PK(e[".sv"],t);rt(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},RK=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:rt(!1,"Unexpected server value: "+e)}},PK=function(e,t,n){e.hasOwnProperty("increment")||rt(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;typeof i!="number"&&rt(!1,"Unexpected increment value: "+i);const r=t.node();if(rt(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return typeof o!="number"?i:o+i},MK=function(e,t,n,i){return gb(t,new db(n,e),i)},qL=function(e,t,n){return gb(e,new ub(t),n)};function gb(e,t,n){const i=e.getPriority().val(),r=ME(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const o=e,a=ME(o.getValue(),t,n);return a!==o.getValue()||r!==o.getPriority().val()?new ln(a,bn(r)):e}else{const o=e;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new ln(r))),o.forEachChild(je,(a,c)=>{const h=gb(c,t.getImmediateChild(a),n);h!==c&&(s=s.updateImmediateChild(a,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(t="",n=null,i={children:{},childCount:0}){this.name=t,this.parent=n,this.node=i}}function mb(e,t){let n=t instanceof he?t:new he(t),i=e,r=Ot(n);for(;r!==null;){const s=el(i.node.children,r)||{children:{},childCount:0};i=new fb(r,i,s),n=ue(n),r=Ot(n)}return i}function Rl(e){return e.node.value}function jL(e,t){e.node.value=t,f0(e)}function FL(e){return e.node.childCount>0}function DK(e){return Rl(e)===void 0&&!FL(e)}function Cp(e,t){pi(e.node.children,(n,i)=>{t(new fb(n,e,i))})}function UL(e,t,n,i){n&&t(e),Cp(e,r=>{UL(r,t,!0)})}function LK(e,t,n){let i=e.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function gd(e){return new he(e.parent===null?e.name:gd(e.parent)+"/"+e.name)}function f0(e){e.parent!==null&&VK(e.parent,e.name,e)}function VK(e,t,n){const i=DK(n),r=Vs(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,f0(e)):!i&&!r&&(e.node.children[t]=n.node,e.node.childCount++,f0(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qK=/[\[\].#$\/\u0000-\u001F\u007F]/,jK=/[\[\].#$\u0000-\u001F\u007F]/,ty=10*1024*1024,OL=function(e){return typeof e=="string"&&e.length!==0&&!qK.test(e)},BL=function(e){return typeof e=="string"&&e.length!==0&&!jK.test(e)},FK=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),BL(e)},GL=function(e,t,n,i){i&&t===void 0||pb(dw(e,"value"),t,n)},pb=function(e,t,n){const i=n instanceof he?new i7(n,e):n;if(t===void 0)throw new Error(e+"contains undefined "+ia(i));if(typeof t=="function")throw new Error(e+"contains a function "+ia(i)+" with contents = "+t.toString());if(BD(t))throw new Error(e+"contains "+t.toString()+" "+ia(i));if(typeof t=="string"&&t.length>ty/3&&Km(t)>ty)throw new Error(e+"contains a string greater than "+ty+" utf8 bytes "+ia(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let r=!1,s=!1;if(pi(t,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!OL(o)))throw new Error(e+" contains an invalid key ("+o+") "+ia(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);r7(i,o),pb(e,a,i),s7(i)}),r&&s)throw new Error(e+' contains ".value" child '+ia(i)+" in addition to actual children.")}},HL=function(e,t,n,i){if(!BL(n))throw new Error(dw(e,t)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},UK=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),HL(e,t,n)},$L=function(e,t){if(Ot(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},OK=function(e,t){const n=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!OL(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!FK(n))throw new Error(dw(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BK{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function vb(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();n!==null&&!Qw(s,n.path)&&(e.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function zL(e,t,n){vb(e,n),KL(e,i=>Qw(i,t))}function Ss(e,t,n){vb(e,n),KL(e,i=>hr(i,t)||hr(t,i))}function KL(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){const s=r.path;t(s)?(GK(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function GK(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(n!==null){e.events[t]=null;const i=n.getEventRunner();Bh&&Mn("event: "+n.toString()),Al(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HK="repo_interrupt",$K=25;class zK{constructor(t,n,i,r){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new BK,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=zf(),this.transactionQueueTree_=new fb,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function KK(e,t,n){if(e.stats_=Kw(e.repoInfo_),e.forceRestClient_||Sz())e.server_=new $f(e.repoInfo_,(i,r,s,o)=>{DE(e,i,r,s,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>LE(e,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gn(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}e.persistentConnection_=new ms(e.repoInfo_,t,(i,r,s,o)=>{DE(e,i,r,s,o)},i=>{LE(e,i)},i=>{WK(e,i)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(i=>{e.server_.refreshAuthToken(i)}),e.appCheckProvider_.addTokenChangeListener(i=>{e.server_.refreshAppCheckToken(i.token)}),e.statsReporter_=Mz(e.repoInfo_,()=>new R7(e.stats_,e.server_)),e.infoData_=new N7,e.infoSyncTree_=new RE({startListening:(i,r,s,o)=>{let a=[];const c=e.infoData_.getNode(i._path);return c.isEmpty()||(a=bp(e.infoSyncTree_,i._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),xb(e,"connected",!1),e.serverSyncTree_=new RE({startListening:(i,r,s,o)=>(e.server_.listen(i,s,r,(a,c)=>{const h=o(a,c);Ss(e.eventQueue_,i._path,h)}),[]),stopListening:(i,r)=>{e.server_.unlisten(i,r)}})}function WL(e){const n=e.infoData_.getNode(new he(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function yb(e){return AK({timestamp:WL(e)})}function DE(e,t,n,i,r){e.dataUpdateCount++;const s=new he(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const c=Sf(n,h=>bn(h));o=kK(e.serverSyncTree_,s,c,r)}else{const c=bn(n);o=CK(e.serverSyncTree_,s,c,r)}else if(i){const c=Sf(n,h=>bn(h));o=wK(e.serverSyncTree_,s,c)}else{const c=bn(n);o=bp(e.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=kp(e,s)),Ss(e.eventQueue_,a,o)}function LE(e,t){xb(e,"connected",t),t===!1&&YK(e)}function WK(e,t){pi(t,(n,i)=>{xb(e,n,i)})}function xb(e,t,n){const i=new he("/.info/"+t),r=bn(n);e.infoData_.updateSnapshot(i,r);const s=bp(e.infoSyncTree_,i,r);Ss(e.eventQueue_,i,s)}function QL(e){return e.nextWriteId_++}function QK(e,t,n,i,r){_b(e,"set",{path:t.toString(),value:n,priority:i});const s=yb(e),o=bn(n,i),a=ab(e.serverSyncTree_,t),c=qL(o,a,s),h=QL(e),u=ML(e.serverSyncTree_,t,c,h,!0);vb(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),(f,v)=>{const y=f==="ok";y||mi("set at "+t+" failed: "+f);const _=ua(e.serverSyncTree_,h,!y);Ss(e.eventQueue_,t,_),ZK(e,r,f,v)});const d=eV(e,t);kp(e,d),Ss(e.eventQueue_,d,[])}function YK(e){_b(e,"onDisconnectEvents");const t=yb(e),n=zf();a0(e.onDisconnect_,ne(),(r,s)=>{const o=MK(r,s,e.serverSyncTree_,t);xL(n,r,o)});let i=[];a0(n,ne(),(r,s)=>{i=i.concat(bp(e.serverSyncTree_,r,s));const o=eV(e,r);kp(e,o)}),e.onDisconnect_=zf(),Ss(e.eventQueue_,ne(),i)}function JK(e,t,n){let i;Ot(t._path)===".info"?i=PE(e.infoSyncTree_,t,n):i=PE(e.serverSyncTree_,t,n),zL(e.eventQueue_,t._path,i)}function YL(e,t,n){let i;Ot(t._path)===".info"?i=g0(e.infoSyncTree_,t,n):i=g0(e.serverSyncTree_,t,n),zL(e.eventQueue_,t._path,i)}function XK(e){e.persistentConnection_&&e.persistentConnection_.interrupt(HK)}function _b(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Mn(n,...t)}function ZK(e,t,n,i){t&&Al(()=>{if(n==="ok")t(null);else{const r=(n||"error").toUpperCase();let s=r;i&&(s+=": "+i);const o=new Error(s);o.code=r,t(o)}})}function JL(e,t,n){return ab(e.serverSyncTree_,t,n)||At.EMPTY_NODE}function wb(e,t=e.transactionQueueTree_){if(t||Np(e,t),Rl(t)){const n=ZL(e,t);rt(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&tW(e,gd(t),n)}else FL(t)&&Cp(t,n=>{wb(e,n)})}function tW(e,t,n){const i=n.map(h=>h.currentWriteId),r=JL(e,t,i);let s=r;const o=r.hash();for(let h=0;h<n.length;h++){const u=n[h];rt(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=hi(t,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,h=>{_b(e,"transaction put response",{path:c.toString(),status:h});let u=[];if(h==="ok"){const d=[];for(let f=0;f<n.length;f++)n[f].status=2,u=u.concat(ua(e.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&d.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();Np(e,mb(e.transactionQueueTree_,t)),wb(e,e.transactionQueueTree_),Ss(e.eventQueue_,t,u);for(let f=0;f<d.length;f++)Al(d[f])}else{if(h==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{mi("transaction at "+c.toString()+" failed: "+h);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=h}kp(e,t)}},o)}function kp(e,t){const n=XL(e,t),i=gd(n),r=ZL(e,n);return eW(e,r,i),i}function eW(e,t,n){if(t.length===0)return;const i=[];let r=[];const o=t.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const c=t[a],h=hi(n,c.path);let u=!1,d;if(rt(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,r=r.concat(ua(e.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=$K)u=!0,d="maxretry",r=r.concat(ua(e.serverSyncTree_,c.currentWriteId,!0));else{const f=JL(e,c.path,o);c.currentInputSnapshot=f;const v=t[a].update(f.val());if(v!==void 0){pb("transaction failed: Data returned ",v,c.path);let y=bn(v);typeof v=="object"&&v!=null&&Vs(v,".priority")||(y=y.updatePriority(f.getPriority()));const w=c.currentWriteId,x=yb(e),C=qL(y,f,x);c.currentOutputSnapshotRaw=y,c.currentOutputSnapshotResolved=C,c.currentWriteId=QL(e),o.splice(o.indexOf(w),1),r=r.concat(ML(e.serverSyncTree_,c.path,C,c.currentWriteId,c.applyLocally)),r=r.concat(ua(e.serverSyncTree_,w,!0))}else u=!0,d="nodata",r=r.concat(ua(e.serverSyncTree_,c.currentWriteId,!0))}Ss(e.eventQueue_,n,r),r=[],u&&(t[a].status=2,function(f){setTimeout(f,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&(d==="nodata"?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(d),!1,null))))}Np(e,e.transactionQueueTree_);for(let a=0;a<i.length;a++)Al(i[a]);wb(e,e.transactionQueueTree_)}function XL(e,t){let n,i=e.transactionQueueTree_;for(n=Ot(t);n!==null&&Rl(i)===void 0;)i=mb(i,n),t=ue(t),n=Ot(t);return i}function ZL(e,t){const n=[];return tV(e,t,n),n.sort((i,r)=>i.order-r.order),n}function tV(e,t,n){const i=Rl(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Cp(t,r=>{tV(e,r,n)})}function Np(e,t){const n=Rl(t);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,jL(t,n.length>0?n:void 0)}Cp(t,i=>{Np(e,i)})}function eV(e,t){const n=gd(XL(e,t)),i=mb(e.transactionQueueTree_,t);return LK(i,r=>{ey(e,r)}),ey(e,i),UL(i,r=>{ey(e,r)}),n}function ey(e,t){const n=Rl(t);if(n){const i=[];let r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(rt(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(rt(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(ua(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?jL(t,void 0):n.length=s+1,Ss(e.eventQueue_,gd(t),r);for(let o=0;o<i.length;o++)Al(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nW(e){let t="";const n=e.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}t+="/"+r}return t}function iW(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const n of e.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):mi(`Invalid query segment '${n}' in query '${e}'`)}return t}const VE=function(e,t){const n=rW(e),i=n.namespace;n.domain==="firebase.com"&&Es(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Es("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||xz();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new tL(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new he(n.pathString)}},rW=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",c=443;if(typeof e=="string"){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let u=e.indexOf("/");u===-1&&(u=e.length);let d=e.indexOf("?");d===-1&&(d=e.length),t=e.substring(0,Math.min(u,d)),u<d&&(r=nW(e.substring(u,d)));const f=iW(e.substring(Math.min(e.length,d)));h=t.indexOf(":"),h>=0?(o=a==="https"||a==="wss",c=parseInt(t.substring(h+1),10)):h=t.length;const v=t.slice(0,h);if(v.toLowerCase()==="localhost")n="localhost";else if(v.split(".").length<=2)n=v;else{const y=t.indexOf(".");i=t.substring(0,y).toLowerCase(),n=t.substring(y+1),s=i}"ns"in f&&(s=f.ns)}return{host:t,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",sW=function(){let e=0;const t=[];return function(n){const i=n===e;e=n;let r;const s=new Array(8);for(r=7;r>=0;r--)s[r]=qE.charAt(n%64),n=Math.floor(n/64);rt(n===0,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&t[r]===63;r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=qE.charAt(t[r]);return rt(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oW{constructor(t,n,i,r){this.eventType=t,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gn(this.snapshot.exportVal())}}class aW{constructor(t,n,i){this.eventRegistration=t,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cW{constructor(t,n){this.snapshotCallback=t,this.cancelCallback=n}onValue(t,n){this.snapshotCallback.call(null,t,n)}onCancel(t){return rt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(t,n,i,r){this._repo=t,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return $t(this._path)?null:lL(this._path)}get ref(){return new Ho(this._repo,this._path)}get _queryIdentifier(){const t=_E(this._queryParams),n=$w(t);return n==="{}"?"default":n}get _queryObject(){return _E(this._queryParams)}isEqual(t){if(t=Ce(t),!(t instanceof bb))return!1;const n=this._repo===t._repo,i=Qw(this._path,t._path),r=this._queryIdentifier===t._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+n7(this._path)}}class Ho extends bb{constructor(t,n){super(t,n,new Zw,!1)}get parent(){const t=uL(this._path);return t===null?null:new Ho(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class tm{constructor(t,n,i){this._node=t,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const n=new he(t),i=Du(this.ref,t);return new tm(this._node.getChild(n),i,je)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>t(new tm(r,Du(this.ref,i),je)))}hasChild(t){const n=new he(t);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function lW(e,t){return e=Ce(e),e._checkNotDeleted("ref"),Du(e._root,t)}function Du(e,t){return e=Ce(e),Ot(e._path)===null?UK("child","path",t):HL("child","path",t),new Ho(e._repo,en(e._path,t))}function hW(e,t){e=Ce(e),$L("push",e._path),GL("push",t,e._path,!0);const n=WL(e._repo),i=sW(n),r=Du(e,i),s=Du(e,i);let o;return o=Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function uW(e,t){e=Ce(e),$L("set",e._path),GL("set",t,e._path,!1);const n=new Hm;return QK(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class Tb{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,n){const i=n._queryParams.getIndex();return new oW("value",this,new tm(t.snapshotNode,new Ho(n._repo,n._path),i))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new aW(this,t,n):null}matches(t){return t instanceof Tb?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function dW(e,t,n,i,r){const s=new cW(n,void 0),o=new Tb(s);return JK(e._repo,e,o),()=>YL(e._repo,e,o)}function gW(e,t,n,i){return dW(e,"value",t)}function ny(e,t,n){YL(e._repo,e,null)}dK(Ho);yK(Ho);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW="FIREBASE_DATABASE_EMULATOR_HOST",m0={};let mW=!1;function pW(e,t,n,i){const r=t.lastIndexOf(":"),s=t.substring(0,r),o=Ls(s);e.repoInfo_=new tL(t,o,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),i&&(e.authTokenProvider_=i)}function vW(e,t,n,i,r){let s=i||e.options.databaseURL;s===void 0&&(e.options.projectId||Es("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mn("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=VE(s,r),a=o.repoInfo,c;typeof process<"u"&&nE&&(c=nE[fW]),c?(s=`http://${c}?ns=${a.namespace}`,o=VE(s,r),a=o.repoInfo):o.repoInfo.secure;const h=new Az(e.name,e.options,t);OK("Invalid Firebase Database URL",o),$t(o.path)||Es("Database URL must point to the root of a Firebase Database (not including a child path).");const u=xW(a,e,h,new Iz(e,n));return new _W(u,e)}function yW(e,t){const n=m0[t];(!n||n[e.key]!==e)&&Es(`Database ${t}(${e.repoInfo_}) has already been deleted.`),XK(e),delete n[e.key]}function xW(e,t,n,i){let r=m0[t.name];r||(r={},m0[t.name]=r);let s=r[e.toURLString()];return s&&Es("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new zK(e,mW,n,i),r[e.toURLString()]=s,s}class _W{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(KK(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ho(this._repo,ne())),this._rootInternal}_delete(){return this._rootInternal!==null&&(yW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Es("Cannot call "+t+" on a deleted database.")}}function wW(e=Wm(),t){const n=Ba(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const i=lw("database");i&&bW(n,...i)}return n}function bW(e,t,n,i={}){e=Ce(e),e._checkNotDeleted("useEmulator");const r=`${t}:${n}`,s=e._repoInternal;if(e._instanceStarted){if(r===e._repoInternal.repoInfo_.host&&Eo(i,s.repoInfo_.emulatorOptions))return;Es("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Es('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new jg(jg.OWNER);else if(i.mockUserToken){const a=typeof i.mockUserToken=="string"?i.mockUserToken:hw(i.mockUserToken,e.app.options.projectId);o=new jg(a)}Ls(t)&&($m(t),zm("Database",!0)),pW(s,r,i,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TW(e){gz(Oo),Wi(new Ni("database",(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return vW(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),qn(iE,rE,e),qn(iE,rE,"esm2020")}ms.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};ms.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};TW();function nV(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CW=nV,iV=new Oa("auth","Firebase",nV());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em=new td("@firebase/auth");function kW(e,...t){em.logLevel<=Ht.WARN&&em.warn(`Auth (${Oo}): ${e}`,...t)}function Fg(e,...t){em.logLevel<=Ht.ERROR&&em.error(`Auth (${Oo}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e,...t){throw Cb(e,...t)}function Br(e,...t){return Cb(e,...t)}function rV(e,t,n){const i={...CW(),[t]:n};return new Oa("auth","Firebase",i).create(t,{appName:e.name})}function ya(e){return rV(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cb(e,...t){if(typeof e!="string"){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return iV.create(e,...t)}function Mt(e,t,...n){if(!e)throw Cb(t,...n)}function cs(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Fg(t),new Error(t)}function As(e,t){e||cs(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(){var e;return typeof self<"u"&&((e=self.location)==null?void 0:e.href)||""}function NW(){return jE()==="http:"||jE()==="https:"}function jE(){var e;return typeof self<"u"&&((e=self.location)==null?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EW(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NW()||FM()||"connection"in navigator)?navigator.onLine:!0}function SW(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(t,n){this.shortDelay=t,this.longDelay=n,As(n>t,"Short delay should be less than long delay!"),this.isMobile=uw()||UM()}get(){return EW()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(e,t){As(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{static initialize(t,n,i){this.fetchImpl=t,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IW={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AW=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RW=new fd(3e4,6e4);function Nb(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Pl(e,t,n,i,r={}){return oV(e,r,async()=>{let s={},o={};i&&(t==="GET"?o=i:s={body:JSON.stringify(i)});const a=Tl({key:e.config.apiKey,...o}).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const h={method:t,headers:c,...s};return C6()||(h.referrerPolicy="no-referrer"),e.emulatorConfig&&Ls(e.emulatorConfig.host)&&(h.credentials="include"),sV.fetch()(await aV(e,e.config.apiHost,n,a),h)})}async function oV(e,t,n){e._canInitEmulator=!1;const i={...IW,...t};try{const r=new MW(e),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw og(e,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw og(e,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw og(e,"email-already-in-use",o);if(c==="USER_DISABLED")throw og(e,"user-disabled",o);const u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw rV(e,u,h);Is(e,u)}}catch(r){if(r instanceof Xi)throw r;Is(e,"network-request-failed",{message:String(r)})}}async function PW(e,t,n,i,r={}){const s=await Pl(e,t,n,i,r);return"mfaPendingCredential"in s&&Is(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function aV(e,t,n,i){const r=`${t}${n}?${i}`,s=e,o=s.config.emulator?kb(e.config,r):`${e.config.apiScheme}://${r}`;return AW.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class MW{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Br(this.auth,"network-request-failed")),RW.get())})}}function og(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Br(e,t,i);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DW(e,t){return Pl(e,"POST","/v1/accounts:delete",t)}async function nm(e,t){return Pl(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function LW(e,t=!1){const n=Ce(e),i=await n.getIdToken(t),r=Eb(i);Mt(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Kh(iy(r.auth_time)),issuedAtTime:Kh(iy(r.iat)),expirationTime:Kh(iy(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function iy(e){return Number(e)*1e3}function Eb(e){const[t,n,i]=e.split(".");if(t===void 0||n===void 0||i===void 0)return Fg("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ef(n);return r?JSON.parse(r):(Fg("Failed to decode base64 JWT payload"),null)}catch(r){return Fg("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function FE(e){const t=Eb(e);return Mt(t,"internal-error"),Mt(typeof t.exp<"u","internal-error"),Mt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(e,t,n=!1){if(n)return t;try{return await t}catch(i){throw i instanceof Xi&&VW(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function VW({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qW{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const n=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kh(this.lastLoginAt),this.creationTime=Kh(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function im(e){var d;const t=e.auth,n=await e.getIdToken(),i=await Lu(e,nm(t,{idToken:n}));Mt(i==null?void 0:i.users.length,t,"internal-error");const r=i.users[0];e._notifyReloadListener(r);const s=(d=r.providerUserInfo)!=null&&d.length?cV(r.providerUserInfo):[],o=FW(e.providerData,s),a=e.isAnonymous,c=!(e.email&&r.passwordHash)&&!(o!=null&&o.length),h=a?c:!1,u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new v0(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(e,u)}async function jW(e){const t=Ce(e);await im(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function FW(e,t){return[...e.filter(i=>!t.some(r=>r.providerId===i.providerId)),...t]}function cV(e){return e.map(({providerId:t,...n})=>({providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UW(e,t){const n=await oV(e,{},async()=>{const i=Tl({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,o=await aV(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return e.emulatorConfig&&Ls(e.emulatorConfig.host)&&(c.credentials="include"),sV.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function OW(e,t){return Pl(e,"POST","/v2/accounts:revokeToken",Nb(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Mt(t.idToken,"internal-error"),Mt(typeof t.idToken<"u","internal-error"),Mt(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):FE(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){Mt(t.length!==0,"internal-error");const n=FE(t);this.updateTokensAndExpiration(t,null,n)}async getToken(t,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Mt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,n){const{accessToken:i,refreshToken:r,expiresIn:s}=await UW(t,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(t,n,i){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,n){const{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new Uc;return i&&(Mt(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),r&&(Mt(typeof r=="string","internal-error",{appName:t}),o.accessToken=r),s&&(Mt(typeof s=="number","internal-error",{appName:t}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Uc,this.toJSON())}_performRefresh(){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(e,t){Mt(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class dr{constructor({uid:t,auth:n,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new qW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new v0(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const n=await Lu(this,this.stsTokenManager.getToken(this.auth,t));return Mt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(t){return LW(this,t)}reload(){return jW(this)}_assign(t){this!==t&&(Mt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>({...n})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new dr({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(t){Mt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,n=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),n&&await im(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Li(this.auth.app))return Promise.reject(ya(this.auth));const t=await this.getIdToken();return await Lu(this,DW(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){const i=n.displayName??void 0,r=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,h=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:v,providerData:y,stsTokenManager:_}=n;Mt(d&&_,t,"internal-error");const w=Uc.fromJSON(this.name,_);Mt(typeof d=="string",t,"internal-error"),Qs(i,t.name),Qs(r,t.name),Mt(typeof f=="boolean",t,"internal-error"),Mt(typeof v=="boolean",t,"internal-error"),Qs(s,t.name),Qs(o,t.name),Qs(a,t.name),Qs(c,t.name),Qs(h,t.name),Qs(u,t.name);const x=new dr({uid:d,auth:t,email:r,emailVerified:f,displayName:i,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:u});return y&&Array.isArray(y)&&(x.providerData=y.map(C=>({...C}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(t,n,i=!1){const r=new Uc;r.updateFromServerResponse(n);const s=new dr({uid:n.localId,auth:t,stsTokenManager:r,isAnonymous:i});return await im(s),s}static async _fromGetAccountInfoResponse(t,n,i){const r=n.users[0];Mt(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?cV(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Uc;a.updateFromIdToken(i);const c=new dr({uid:r.localId,auth:t,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new v0(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE=new Map;function ls(e){As(e instanceof Function,"Expected a class definition");let t=UE.get(e);return t?(As(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,UE.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,n){this.storage[t]=n}async _get(t){const n=this.storage[t];return n===void 0?null:n}async _remove(t){delete this.storage[t]}_addListener(t,n){}_removeListener(t,n){}}lV.type="NONE";const OE=lV;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(e,t,n){return`firebase:${e}:${t}:${n}`}class Oc{constructor(t,n,i){this.persistence=t,this.auth=n,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Ug(this.userKey,r.apiKey,s),this.fullPersistenceKey=Ug("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const n=await nm(this.auth,{idToken:t}).catch(()=>{});return n?dr._fromGetAccountInfoResponse(this.auth,n,t):null}return dr._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,i="authUser"){if(!n.length)return new Oc(ls(OE),t,i);const r=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||ls(OE);const o=Ug(i,t.config.apiKey,t.name);let a=null;for(const h of n)try{const u=await h._get(o);if(u){let d;if(typeof u=="string"){const f=await nm(t,{idToken:u}).catch(()=>{});if(!f)break;d=await dr._fromGetAccountInfoResponse(t,f,u)}else d=dr._fromJSON(t,u);h!==s&&(a=d),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Oc(s,t,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Oc(s,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gV(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(hV(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(mV(t))return"Blackberry";if(pV(t))return"Webos";if(uV(t))return"Safari";if((t.includes("chrome/")||dV(t))&&!t.includes("edge/"))return"Chrome";if(fV(t))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function hV(e=Fn()){return/firefox\//i.test(e)}function uV(e=Fn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function dV(e=Fn()){return/crios\//i.test(e)}function gV(e=Fn()){return/iemobile/i.test(e)}function fV(e=Fn()){return/android/i.test(e)}function mV(e=Fn()){return/blackberry/i.test(e)}function pV(e=Fn()){return/webos/i.test(e)}function Sb(e=Fn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function BW(e=Fn()){var t;return Sb(e)&&!!((t=window.navigator)!=null&&t.standalone)}function GW(){return k6()&&document.documentMode===10}function vV(e=Fn()){return Sb(e)||fV(e)||pV(e)||mV(e)||/windows phone/i.test(e)||gV(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(e,t=[]){let n;switch(e){case"Browser":n=BE(Fn());break;case"Worker":n=`${BE(Fn())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Oo}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HW{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const i=s=>new Promise((o,a)=>{try{const c=t(s);o(c)}catch(c){a(c)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const n=[];try{for(const i of this.queue)await i(t),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $W(e,t={}){return Pl(e,"GET","/v2/passwordPolicy",Nb(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW=6;class KW{constructor(t){var i;const n=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??zW,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=t.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,n),this.validatePasswordCharacterOptions(t,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(t,n){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=t.length>=i),r&&(n.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<t.length;r++)i=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WW{constructor(t,n,i,r){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GE(this),this.idTokenSubscription=new GE(this),this.beforeStateQueue=new HW(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iV,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,n){return n&&(this._popupRedirectResolver=ls(n)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await Oc.create(this,t),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const n=await nm(this,{idToken:t}),i=await dr._fromGetAccountInfoResponse(this,n,t);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var s;if(Li(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(t);(!o||o===a)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Mt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(t){try{await im(t)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=SW()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Li(this.app))return Promise.reject(ya(this));const n=t?Ce(t):null;return n&&Mt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(t,n=!1){if(!this._deleted)return t&&Mt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Li(this.app)?Promise.reject(ya(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Li(this.app)?Promise.reject(ya(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ls(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await $W(this),n=new KW(t);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Oa("auth","Firebase",t())}onAuthStateChanged(t,n,i){return this.registerStateListener(this.authStateSubscription,t,n,i)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,i){return this.registerStateListener(this.idTokenSubscription,t,n,i)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},n)}})}async revokeAccessToken(t){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await OW(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)==null?void 0:t.toJSON()}}async _setRedirectUser(t,n){const i=await this.getOrInitRedirectPersistenceManager(n);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const n=t&&ls(t)||this._popupRedirectResolver;Mt(n,this,"argument-error"),this.redirectPersistenceManager=await Oc.create(this,[ls(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===t?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,i,r){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Mt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=t.addObserver(n,i,r);return()=>{o=!0,c()}}else{const c=t.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Mt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=yV(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var n;if(Li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return t!=null&&t.error&&kW(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Ib(e){return Ce(e)}class GE{constructor(t){this.auth=t,this.observer=null,this.addObserver=L6(n=>this.observer=n)}get next(){return Mt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ab={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function QW(e){Ab=e}function YW(e){return Ab.loadJS(e)}function JW(){return Ab.gapiScript}function XW(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZW(e,t){const n=Ba(e,"auth");if(n.isInitialized()){const r=n.getImmediate(),s=n.getOptions();if(Eo(s,t??{}))return r;Is(r,"already-initialized")}return n.initialize({options:t})}function tQ(e,t){const n=(t==null?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ls);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function eQ(e,t,n){const i=Ib(e);Mt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!1,s=xV(t),{host:o,port:a}=nQ(t),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Mt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Mt(Eo(h,i.config.emulator)&&Eo(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,Ls(o)?($m(`${s}//${o}${c}`),zm("Auth",!0)):iQ()}function xV(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function nQ(e){const t=xV(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:HE(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:HE(o)}}}function HE(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function iQ(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return cs("not implemented")}_getIdTokenResponse(t){return cs("not implemented")}_linkToIdToken(t,n){return cs("not implemented")}_getReauthenticationResolver(t){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bc(e,t){return PW(e,"POST","/v1/accounts:signInWithIdp",Nb(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rQ="http://localhost";class Da extends _V{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new Da(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Is("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:r,...s}=n;if(!i||!r)return null;const o=new Da(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){const n=this.buildRequest();return Bc(t,n)}_linkToIdToken(t,n){const i=this.buildRequest();return i.idToken=n,Bc(t,i)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,Bc(t,n)}buildRequest(){const t={requestUri:rQ,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=Tl(n)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md extends wV{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends md{constructor(){super("facebook.com")}static credential(t){return Da._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return eo.credentialFromTaggedObject(t)}static credentialFromError(t){return eo.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return eo.credential(t.oauthAccessToken)}catch{return null}}}eo.FACEBOOK_SIGN_IN_METHOD="facebook.com";eo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends md{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return Da._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return no.credentialFromTaggedObject(t)}static credentialFromError(t){return no.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return no.credential(n,i)}catch{return null}}}no.GOOGLE_SIGN_IN_METHOD="google.com";no.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends md{constructor(){super("github.com")}static credential(t){return Da._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return io.credentialFromTaggedObject(t)}static credentialFromError(t){return io.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return io.credential(t.oauthAccessToken)}catch{return null}}}io.GITHUB_SIGN_IN_METHOD="github.com";io.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro extends md{constructor(){super("twitter.com")}static credential(t,n){return Da._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return ro.credentialFromTaggedObject(t)}static credentialFromError(t){return ro.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return ro.credential(n,i)}catch{return null}}}ro.TWITTER_SIGN_IN_METHOD="twitter.com";ro.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,n,i,r=!1){const s=await dr._fromIdTokenResponse(t,i,r),o=$E(i);return new dl({user:s,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(t,n,i){await t._updateTokensIfNecessary(i,!0);const r=$E(i);return new dl({user:t,providerId:r,_tokenResponse:i,operationType:n})}}function $E(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm extends Xi{constructor(t,n,i,r){super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,rm.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,n,i,r){return new rm(t,n,i,r)}}function bV(e,t,n,i){return(t==="reauthenticate"?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rm._fromErrorAndOperation(e,s,t,i):s})}async function sQ(e,t,n=!1){const i=await Lu(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return dl._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oQ(e,t,n=!1){const{auth:i}=e;if(Li(i.app))return Promise.reject(ya(i));const r="reauthenticate";try{const s=await Lu(e,bV(i,r,t,e),n);Mt(s.idToken,i,"internal-error");const o=Eb(s.idToken);Mt(o,i,"internal-error");const{sub:a}=o;return Mt(e.uid===a,i,"user-mismatch"),dl._forOperation(e,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Is(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aQ(e,t,n=!1){if(Li(e.app))return Promise.reject(ya(e));const i="signIn",r=await bV(e,i,t),s=await dl._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}function cQ(e,t,n,i){return Ce(e).onIdTokenChanged(t,n,i)}function lQ(e,t,n){return Ce(e).beforeAuthStateChanged(t,n)}const sm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(sm,"1"),this.storage.removeItem(sm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hQ=1e3,uQ=10;class CV extends TV{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vV(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&t(n,r,i)}}onStorageEvent(t,n=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=t.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);GW()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,uQ):r()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},hQ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,n){await super._set(t,n),this.localCache[t]=JSON.stringify(n)}async _get(t){const n=await super._get(t);return this.localCache[t]=JSON.stringify(n),n}async _remove(t){await super._remove(t),delete this.localCache[t]}}CV.type="LOCAL";const dQ=CV;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV extends TV{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}kV.type="SESSION";const NV=kV;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gQ(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(r=>r.isListeningto(t));if(n)return n;const i=new Ep(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const n=t,{eventId:i,eventType:r,data:s}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(n.origin,s)),c=await gQ(a);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(t,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ep.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(Math.random()*10);return e+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fQ{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=Rb("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const f=d;if(f.data.eventId===h)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(){return window}function mQ(e){Gr().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(){return typeof Gr().WorkerGlobalScope<"u"&&typeof Gr().importScripts=="function"}async function pQ(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vQ(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)==null?void 0:e.controller)||null}function yQ(){return EV()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV="firebaseLocalStorageDb",xQ=1,om="firebaseLocalStorage",IV="fbase_key";class pd{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Sp(e,t){return e.transaction([om],t?"readwrite":"readonly").objectStore(om)}function _Q(){const e=indexedDB.deleteDatabase(SV);return new pd(e).toPromise()}function y0(){const e=indexedDB.open(SV,xQ);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(om,{keyPath:IV})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(om)?t(i):(i.close(),await _Q(),t(await y0()))})})}async function zE(e,t,n){const i=Sp(e,!0).put({[IV]:t,value:n});return new pd(i).toPromise()}async function wQ(e,t){const n=Sp(e,!1).get(t),i=await new pd(n).toPromise();return i===void 0?null:i.value}function KE(e,t){const n=Sp(e,!0).delete(t);return new pd(n).toPromise()}const bQ=800,TQ=3;class AV{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await y0(),this.db)}async _withRetries(t){let n=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(n++>TQ)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return EV()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ep._getInstance(yQ()),this.receiver._subscribe("keyChanged",async(t,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(t,n)=>["keyChanged"])}async initializeSender(){var n,i;if(this.activeServiceWorker=await pQ(),!this.activeServiceWorker)return;this.sender=new fQ(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&(n=t[0])!=null&&n.fulfilled&&(i=t[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||vQ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await y0();return await zE(t,sm,"1"),await KE(t,sm),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>zE(i,t,n)),this.localCache[t]=n,this.notifyServiceWorker(t)))}async _get(t){const n=await this._withRetries(i=>wQ(i,t));return this.localCache[t]=n,n}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(n=>KE(n,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(r=>{const s=Sp(r,!1).getAll();return new pd(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(t.length!==0)for(const{fbase_key:r,value:s}of t)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bQ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AV.type="LOCAL";const CQ=AV;new fd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kQ(e,t){return t?ls(t):(Mt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb extends _V{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Bc(t,this._buildIdpRequest())}_linkToIdToken(t,n){return Bc(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return Bc(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function NQ(e){return aQ(e.auth,new Pb(e),e.bypassAuthState)}function EQ(e){const{auth:t,user:n}=e;return Mt(n,t,"internal-error"),oQ(n,new Pb(e),e.bypassAuthState)}async function SQ(e){const{auth:t,user:n}=e;return Mt(n,t,"internal-error"),sQ(n,new Pb(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RV{constructor(t,n,i,r,s=!1){this.auth=t,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(t,n)=>{this.pendingPromise={resolve:t,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return NQ;case"linkViaPopup":case"linkViaRedirect":return SQ;case"reauthViaPopup":case"reauthViaRedirect":return EQ;default:Is(this.auth,"internal-error")}}resolve(t){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IQ=new fd(2e3,1e4);class wc extends RV{constructor(t,n,i,r,s){super(t,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,wc.currentPopupAction&&wc.currentPopupAction.cancel(),wc.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Mt(t,this.auth,"internal-error"),t}async onExecution(){As(this.filter.length===1,"Popup operations only handle one event");const t=Rb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)==null?void 0:t.associatedEvent)||null}cancel(){this.reject(Br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wc.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;if((i=(n=this.authWindow)==null?void 0:n.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,IQ.get())};t()}}wc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AQ="pendingRedirect",Og=new Map;class RQ extends RV{constructor(t,n,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let t=Og.get(this.auth._key());if(!t){try{const i=await PQ(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(n){t=()=>Promise.reject(n)}Og.set(this.auth._key(),t)}return this.bypassAuthState||Og.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const n=await this.auth._redirectUserForId(t.eventId);if(n)return this.user=n,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PQ(e,t){const n=LQ(t),i=DQ(e);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}function MQ(e,t){Og.set(e._key(),t)}function DQ(e){return ls(e._redirectPersistence)}function LQ(e){return Ug(AQ,e.config.apiKey,e.name)}async function VQ(e,t,n=!1){if(Li(e.app))return Promise.reject(ya(e));const i=Ib(e),r=kQ(i,t),o=await new RQ(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qQ=10*60*1e3;class jQ{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(n=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!FQ(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var i;if(t.error&&!PV(t)){const r=((i=t.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";n.onError(Br(this.auth,r))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const i=n.eventId===null||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=qQ&&this.cachedEventUids.clear(),this.cachedEventUids.has(WE(t))}saveEventToCache(t){this.cachedEventUids.add(WE(t)),this.lastProcessedEventTime=Date.now()}}function WE(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function PV({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function FQ(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PV(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UQ(e,t={}){return Pl(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OQ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BQ=/^https?/;async function GQ(e){if(e.config.emulator)return;const{authorizedDomains:t}=await UQ(e);for(const n of t)try{if(HQ(n))return}catch{}Is(e,"unauthorized-domain")}function HQ(e){const t=p0(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const o=new URL(e);return o.hostname===""&&i===""?n==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!BQ.test(n))return!1;if(OQ.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Q=new fd(3e4,6e4);function QE(){const e=Gr().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}}function zQ(e){return new Promise((t,n)=>{var r,s,o;function i(){QE(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{QE(),n(Br(e,"network-request-failed"))},timeout:$Q.get()})}if((s=(r=Gr().gapi)==null?void 0:r.iframes)!=null&&s.Iframe)t(gapi.iframes.getContext());else if((o=Gr().gapi)!=null&&o.load)i();else{const a=XW("iframefcb");return Gr()[a]=()=>{gapi.load?i():n(Br(e,"network-request-failed"))},YW(`${JW()}?onload=${a}`).catch(c=>n(c))}}).catch(t=>{throw Bg=null,t})}let Bg=null;function KQ(e){return Bg=Bg||zQ(e),Bg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WQ=new fd(5e3,15e3),QQ="__/auth/iframe",YQ="emulator/auth/iframe",JQ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XQ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZQ(e){const t=e.config;Mt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?kb(t,YQ):`https://${e.config.authDomain}/${QQ}`,i={apiKey:t.apiKey,appName:e.name,v:Oo},r=XQ.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${Tl(i).slice(1)}`}async function tY(e){const t=await KQ(e),n=Gr().gapi;return Mt(n,e,"internal-error"),t.open({where:document.body,url:ZQ(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JQ,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Br(e,"network-request-failed"),a=Gr().setTimeout(()=>{s(o)},WQ.get());function c(){Gr().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nY=500,iY=600,rY="_blank",sY="http://localhost";class YE{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oY(e,t,n,i=nY,r=iY){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...eY,width:i.toString(),height:r.toString(),top:s,left:o},h=Fn().toLowerCase();n&&(a=dV(h)?rY:n),hV(h)&&(t=t||sY,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[v,y])=>`${f}${v}=${y},`,"");if(BW(h)&&a!=="_self")return aY(t||"",a),new YE(null);const d=window.open(t||"",a,u);Mt(d,e,"popup-blocked");try{d.focus()}catch{}return new YE(d)}function aY(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cY="__/auth/handler",lY="emulator/auth/handler",hY=encodeURIComponent("fac");async function JE(e,t,n,i,r,s){Mt(e.config.authDomain,e,"auth-domain-config-required"),Mt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Oo,eventId:r};if(t instanceof wV){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",Lx(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(t instanceof md){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const c=await e._getAppCheckToken(),h=c?`#${hY}=${encodeURIComponent(c)}`:"";return`${uY(e)}?${Tl(a).slice(1)}${h}`}function uY({config:e}){return e.emulator?kb(e,lY):`https://${e.authDomain}/${cY}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry="webStorageSupport";class dY{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NV,this._completeRedirectFn=VQ,this._overrideRedirectResult=MQ}async _openPopup(t,n,i,r){var o;As((o=this.eventManagers[t._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await JE(t,n,i,p0(),r);return oY(t,s,Rb())}async _openRedirect(t,n,i,r){await this._originValidation(t);const s=await JE(t,n,i,p0(),r);return mQ(s),new Promise(()=>{})}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(As(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(t){const n=await tY(t),i=new jQ(t);return n.register("authEvent",r=>(Mt(r==null?void 0:r.authEvent,t,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=n,i}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(ry,{type:ry},r=>{var o;const s=(o=r==null?void 0:r[0])==null?void 0:o[ry];s!==void 0&&n(!!s),Is(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=GQ(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return vV()||uV()||Sb()}}const gY=dY;var XE="@firebase/auth",ZE="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)==null?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Mt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mY(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pY(e){Wi(new Ni("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Mt(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yV(e)},h=new WW(i,r,s,c);return tQ(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,i)=>{t.getProvider("auth-internal").initialize()})),Wi(new Ni("auth-internal",t=>{const n=Ib(t.getProvider("auth").getImmediate());return(i=>new fY(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),qn(XE,ZE,mY(e)),qn(XE,ZE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vY=5*60,yY=jM("authIdTokenMaxAge")||vY;let tS=null;const xY=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>yY)return;const r=n==null?void 0:n.token;tS!==r&&(tS=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function _Y(e=Wm()){const t=Ba(e,"auth");if(t.isInitialized())return t.getImmediate();const n=ZW(e,{popupRedirectResolver:gY,persistence:[CQ,dQ,NV]}),i=jM("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=xY(s.toString());lQ(n,o,()=>o(n.currentUser)),cQ(n,a=>o(a))}}const r=VM("auth");return r&&eQ(n,`http://${r}`),n}function wY(){var e;return((e=document.getElementsByTagName("head"))==null?void 0:e[0])??document}QW({loadJS(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=r=>{const s=Br("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",wY().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pY("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV="firebasestorage.googleapis.com",bY="storageBucket",TY=2*60*1e3,CY=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends Xi{constructor(t,n,i=0){super(sy(t),`Firebase Storage: ${n} (${sy(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zr.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return sy(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Yr;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Yr||(Yr={}));function sy(e){return"storage/"+e}function kY(){const e="An unknown error occurred, please check the error payload for server response.";return new Zr(Yr.UNKNOWN,e)}function NY(){return new Zr(Yr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EY(){return new Zr(Yr.CANCELED,"User canceled the upload/download.")}function SY(e){return new Zr(Yr.INVALID_URL,"Invalid URL '"+e+"'.")}function IY(e){return new Zr(Yr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function eS(e){return new Zr(Yr.INVALID_ARGUMENT,e)}function DV(){return new Zr(Yr.APP_DELETED,"The Firebase app was deleted.")}function AY(e){return new Zr(Yr.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=gr.makeFromUrl(t,n)}catch{return new gr(t,"")}if(i.path==="")return i;throw IY(t)}static makeFromUrl(t,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",v=new RegExp(`^https?://${d}/${u}/b/${r}/o${f}`,"i"),y={bucket:1,path:3},_=n===MV?"(?:storage.googleapis.com|storage.cloud.google.com)":n,w="([^?#]*)",x=new RegExp(`^https?://${_}/${r}/${w}`,"i"),k=[{regex:a,indices:c,postModify:s},{regex:v,indices:y,postModify:h},{regex:x,indices:{bucket:1,path:2},postModify:h}];for(let P=0;P<k.length;P++){const A=k[P],M=A.regex.exec(t);if(M){const N=M[A.indices.bucket];let T=M[A.indices.path];T||(T=""),i=new gr(N,T),A.postModify(i);break}}if(i==null)throw SY(t);return i}}class RY{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PY(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function u(...w){h||(h=!0,t.apply(null,w))}function d(w){r=setTimeout(()=>{r=null,e(v,c())},w)}function f(){s&&clearTimeout(s)}function v(w,...x){if(h){f();return}if(w){f(),u.call(null,w,...x);return}if(c()||o){f(),u.call(null,w,...x);return}i<64&&(i*=2);let k;a===1?(a=2,k=0):k=(i+Math.random())*1e3,d(k)}let y=!1;function _(w){y||(y=!0,f(),!h&&(r!==null?(w||(a=2),clearTimeout(r),d(0)):w||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,_(!0)},n),_}function MY(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DY(e){return e!==void 0}function nS(e,t,n,i){if(i<t)throw eS(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw eS(`Invalid value for '${e}'. Expected ${n} or less.`)}function LY(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const r=t(i)+"="+t(e[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var am;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(am||(am={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VY(e,t){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return n||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qY{constructor(t,n,i,r,s,o,a,c,h,u,d,f=!0,v=!1){this.url_=t,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=u,this.connectionFactory_=d,this.retry=f,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,_)=>{this.resolve_=y,this.reject_=_,this.start_()})}start_(){const t=(i,r)=>{if(r){i(!1,new ag(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===am.NO_ERROR,c=s.getStatus();if(!a||VY(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===am.ABORT;i(!1,new ag(!1,null,u));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new ag(h,s))})},n=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());DY(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=kY();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?DV():EY();o(c)}else{const c=NY();o(c)}};this.canceled_?n(!1,new ag(!1,null,!0)):this.backoffId_=PY(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&MY(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ag{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function jY(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function FY(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function UY(e,t){t&&(e["X-Firebase-GMPID"]=t)}function OY(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function BY(e,t,n,i,r,s,o=!0,a=!1){const c=LY(e.urlParams),h=e.url+c,u=Object.assign({},e.headers);return UY(u,t),jY(u,n),FY(u,s),OY(u,i),new qY(h,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GY(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function HY(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(t,n){this._service=t,n instanceof gr?this._location=n:this._location=gr.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new cm(t,n)}get root(){const t=new gr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return HY(this._location.path)}get storage(){return this._service}get parent(){const t=GY(this._location.path);if(t===null)return null;const n=new gr(this._location.bucket,t);return new cm(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw AY(t)}}function iS(e,t){const n=t==null?void 0:t[bY];return n==null?null:gr.makeFromBucketSpec(n,e)}function $Y(e,t,n,i={}){e.host=`${t}:${n}`;const r=Ls(t);r&&($m(`https://${e.host}/b`),zm("Storage",!0)),e._isUsingEmulator=!0,e._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:hw(s,e.app.options.projectId))}class zY{constructor(t,n,i,r,s,o=!1){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=MV,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TY,this._maxUploadRetryTime=CY,this._requests=new Set,r!=null?this._bucket=gr.makeFromBucketSpec(r,this._host):this._bucket=iS(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=gr.makeFromBucketSpec(this._url,t):this._bucket=iS(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){nS("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){nS("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new cm(this,t)}_makeRequest(t,n,i,r,s=!0){if(this._deleted)return new RY(DV());{const o=BY(t,this._appId,i,r,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,r).getPromise()}}const rS="@firebase/storage",sS="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV="storage";function KY(e=Wm(),t){e=Ce(e);const i=Ba(e,LV).getImmediate({identifier:t}),r=lw("storage");return r&&WY(i,...r),i}function WY(e,t,n,i={}){$Y(e,t,n,i)}function QY(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new zY(n,i,r,t,Oo)}function YY(){Wi(new Ni(LV,QY,"PUBLIC").setMultipleInstances(!0)),qn(rS,sS,""),qn(rS,sS,"esm2020")}YY();const VV="@firebase/installations",Mb="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV=1e4,jV=`w:${Mb}`,FV="FIS_v2",JY="https://firebaseinstallations.googleapis.com/v1",XY=60*60*1e3,ZY="installations",tJ="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eJ={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},La=new Oa(ZY,tJ,eJ);function UV(e){return e instanceof Xi&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV({projectId:e}){return`${JY}/projects/${e}/installations`}function BV(e){return{token:e.token,requestStatus:2,expiresIn:iJ(e.expiresIn),creationTime:Date.now()}}async function GV(e,t){const i=(await t.json()).error;return La.create("request-failed",{requestName:e,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function HV({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function nJ(e,{refreshToken:t}){const n=HV(e);return n.append("Authorization",rJ(t)),n}async function $V(e){const t=await e();return t.status>=500&&t.status<600?e():t}function iJ(e){return Number(e.replace("s","000"))}function rJ(e){return`${FV} ${e}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sJ({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=OV(e),r=HV(e),s=t.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={fid:n,authVersion:FV,appId:e.appId,sdkVersion:jV},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await $V(()=>fetch(i,a));if(c.ok){const h=await c.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:BV(h.authToken)}}else throw await GV("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oJ(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aJ=/^[cdef][\w-]{21}$/,x0="";function cJ(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const n=lJ(e);return aJ.test(n)?n:x0}catch{return x0}}function lJ(e){return oJ(e).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV=new Map;function WV(e,t){const n=Ip(e);QV(n,t),hJ(n,t)}function QV(e,t){const n=KV.get(e);if(n)for(const i of n)i(t)}function hJ(e,t){const n=uJ();n&&n.postMessage({key:e,fid:t}),dJ()}let da=null;function uJ(){return!da&&"BroadcastChannel"in self&&(da=new BroadcastChannel("[Firebase] FID Change"),da.onmessage=e=>{QV(e.data.key,e.data.fid)}),da}function dJ(){KV.size===0&&da&&(da.close(),da=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gJ="firebase-installations-database",fJ=1,Va="firebase-installations-store";let oy=null;function Db(){return oy||(oy=zM(gJ,fJ,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Va)}}})),oy}async function lm(e,t){const n=Ip(e),r=(await Db()).transaction(Va,"readwrite"),s=r.objectStore(Va),o=await s.get(n);return await s.put(t,n),await r.done,(!o||o.fid!==t.fid)&&WV(e,t.fid),t}async function YV(e){const t=Ip(e),i=(await Db()).transaction(Va,"readwrite");await i.objectStore(Va).delete(t),await i.done}async function Ap(e,t){const n=Ip(e),r=(await Db()).transaction(Va,"readwrite"),s=r.objectStore(Va),o=await s.get(n),a=t(o);return a===void 0?await s.delete(n):await s.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&WV(e,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lb(e){let t;const n=await Ap(e.appConfig,i=>{const r=mJ(i),s=pJ(e,r);return t=s.registrationPromise,s.installationEntry});return n.fid===x0?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function mJ(e){const t=e||{fid:cJ(),registrationStatus:0};return JV(t)}function pJ(e,t){if(t.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(La.create("app-offline"));return{installationEntry:t,registrationPromise:r}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=vJ(e,n);return{installationEntry:n,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:yJ(e)}:{installationEntry:t}}async function vJ(e,t){try{const n=await sJ(e,t);return lm(e.appConfig,n)}catch(n){throw UV(n)&&n.customData.serverCode===409?await YV(e.appConfig):await lm(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function yJ(e){let t=await oS(e.appConfig);for(;t.registrationStatus===1;)await zV(100),t=await oS(e.appConfig);if(t.registrationStatus===0){const{installationEntry:n,registrationPromise:i}=await Lb(e);return i||n}return t}function oS(e){return Ap(e,t=>{if(!t)throw La.create("installation-not-found");return JV(t)})}function JV(e){return xJ(e)?{fid:e.fid,registrationStatus:0}:e}function xJ(e){return e.registrationStatus===1&&e.registrationTime+qV<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _J({appConfig:e,heartbeatServiceProvider:t},n){const i=wJ(e,n),r=nJ(e,n),s=t.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={installation:{sdkVersion:jV,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await $V(()=>fetch(i,a));if(c.ok){const h=await c.json();return BV(h)}else throw await GV("Generate Auth Token",c)}function wJ(e,{fid:t}){return`${OV(e)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vb(e,t=!1){let n;const i=await Ap(e.appConfig,s=>{if(!XV(s))throw La.create("not-registered");const o=s.authToken;if(!t&&CJ(o))return s;if(o.requestStatus===1)return n=bJ(e,t),s;{if(!navigator.onLine)throw La.create("app-offline");const a=NJ(s);return n=TJ(e,a),a}});return n?await n:i.authToken}async function bJ(e,t){let n=await aS(e.appConfig);for(;n.authToken.requestStatus===1;)await zV(100),n=await aS(e.appConfig);const i=n.authToken;return i.requestStatus===0?Vb(e,t):i}function aS(e){return Ap(e,t=>{if(!XV(t))throw La.create("not-registered");const n=t.authToken;return EJ(n)?{...t,authToken:{requestStatus:0}}:t})}async function TJ(e,t){try{const n=await _J(e,t),i={...t,authToken:n};return await lm(e.appConfig,i),n}catch(n){if(UV(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await YV(e.appConfig);else{const i={...t,authToken:{requestStatus:0}};await lm(e.appConfig,i)}throw n}}function XV(e){return e!==void 0&&e.registrationStatus===2}function CJ(e){return e.requestStatus===2&&!kJ(e)}function kJ(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+XY}function NJ(e){const t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}function EJ(e){return e.requestStatus===1&&e.requestTime+qV<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SJ(e){const t=e,{installationEntry:n,registrationPromise:i}=await Lb(t);return i?i.catch(console.error):Vb(t).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IJ(e,t=!1){const n=e;return await AJ(n),(await Vb(n,t)).token}async function AJ(e){const{registrationPromise:t}=await Lb(e);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RJ(e){if(!e||!e.options)throw ay("App Configuration");if(!e.name)throw ay("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw ay(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function ay(e){return La.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV="installations",PJ="installations-internal",MJ=e=>{const t=e.getProvider("app").getImmediate(),n=RJ(t),i=Ba(t,"heartbeat");return{app:t,appConfig:n,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},DJ=e=>{const t=e.getProvider("app").getImmediate(),n=Ba(t,ZV).getImmediate();return{getId:()=>SJ(n),getToken:r=>IJ(n,r)}};function LJ(){Wi(new Ni(ZV,MJ,"PUBLIC")),Wi(new Ni(PJ,DJ,"PRIVATE"))}LJ();qn(VV,Mb);qn(VV,Mb,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS="analytics",VJ="firebase_id",qJ="origin",jJ=60*1e3,FJ="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qb="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new td("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UJ={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Bi=new Oa("analytics","Analytics",UJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OJ(e){if(!e.startsWith(qb)){const t=Bi.create("invalid-gtag-resource",{gtagURL:e});return Kn.warn(t.message),""}return e}function tq(e){return Promise.all(e.map(t=>t.catch(n=>n)))}function BJ(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function GJ(e,t){const n=BJ("firebase-js-sdk-policy",{createScriptURL:OJ}),i=document.createElement("script"),r=`${qb}?l=${e}&id=${t}`;i.src=n?n==null?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function HJ(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function $J(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const c=(await tq(n)).find(h=>h.measurementId===r);c&&await t[c.appId]}}catch(a){Kn.error(a)}e("config",r,s)}async function zJ(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await tq(n);for(const c of o){const h=a.find(d=>d.measurementId===c),u=h&&t[h.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(s){Kn.error(s)}}function KJ(e,t,n,i){async function r(s,...o){try{if(s==="event"){const[a,c]=o;await zJ(e,t,n,a,c)}else if(s==="config"){const[a,c]=o;await $J(e,t,n,i,a,c)}else if(s==="consent"){const[a,c]=o;e("consent",a,c)}else if(s==="get"){const[a,c,h]=o;e("get",a,c,h)}else if(s==="set"){const[a]=o;e("set",a)}else e(s,...o)}catch(a){Kn.error(a)}}return r}function WJ(e,t,n,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=KJ(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}function QJ(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(qb)&&n.src.includes(e))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YJ=30,JJ=1e3;class XJ{constructor(t={},n=JJ){this.throttleMetadata=t,this.intervalMillis=n}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,n){this.throttleMetadata[t]=n}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const eq=new XJ;function ZJ(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function tX(e){var o;const{appId:t,apiKey:n}=e,i={method:"GET",headers:ZJ(n)},r=FJ.replace("{app-id}",t),s=await fetch(r,i);if(s.status!==200&&s.status!==304){let a="";try{const c=await s.json();(o=c.error)!=null&&o.message&&(a=c.error.message)}catch{}throw Bi.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function eX(e,t=eq,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw Bi.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Bi.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new rX;return setTimeout(async()=>{a.abort()},jJ),nq({appId:i,apiKey:r,measurementId:s},o,a,t)}async function nq(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=eq){var a;const{appId:s,measurementId:o}=e;try{await nX(i,t)}catch(c){if(o)return Kn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:s,measurementId:o};throw c}try{const c=await tX(e);return r.deleteThrottleMetadata(s),c}catch(c){const h=c;if(!iX(h)){if(r.deleteThrottleMetadata(s),o)return Kn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:s,measurementId:o};throw c}const u=Number((a=h==null?void 0:h.customData)==null?void 0:a.httpStatus)===503?Wk(n,r.intervalMillis,YJ):Wk(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(s,d),Kn.debug(`Calling attemptFetch again in ${u} millis`),nq(e,d,i,r)}}function nX(e,t){return new Promise((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener(()=>{clearTimeout(s),i(Bi.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function iX(e){if(!(e instanceof Xi)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}class rX{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function sX(e,t,n,i,r){if(r&&r.global){e("event",n,i);return}else{const s=await t,o={...i,send_to:s};e("event",n,o)}}async function oX(e,t,n,i){if(i&&i.global){const r={};for(const s of Object.keys(n))r[`user_properties.${s}`]=n[s];return e("set",r),Promise.resolve()}else{const r=await t;e("config",r,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aX(){if(OM())try{await BM()}catch(e){return Kn.warn(Bi.create("indexeddb-unavailable",{errorInfo:e==null?void 0:e.toString()}).message),!1}else return Kn.warn(Bi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function cX(e,t,n,i,r,s,o){const a=eX(e);a.then(f=>{n[f.measurementId]=f.appId,e.options.measurementId&&f.measurementId!==e.options.measurementId&&Kn.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Kn.error(f)),t.push(a);const c=aX().then(f=>{if(f)return i.getId()}),[h,u]=await Promise.all([a,c]);QJ(s)||GJ(s,h.measurementId),r("js",new Date);const d=(o==null?void 0:o.config)??{};return d[qJ]="firebase",d.update=!0,u!=null&&(d[VJ]=u),r("config",h.measurementId,d),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lX{constructor(t){this.app=t}_delete(){return delete Gc[this.app.options.appId],Promise.resolve()}}let Gc={},lS=[];const hS={};let cy="dataLayer",hX="gtag",uS,jb,dS=!1;function uX(){const e=[];if(FM()&&e.push("This is a browser extension environment."),S6()||e.push("Cookies are not available."),e.length>0){const t=e.map((i,r)=>`(${r+1}) ${i}`).join(" "),n=Bi.create("invalid-analytics-context",{errorInfo:t});Kn.warn(n.message)}}function dX(e,t,n){uX();const i=e.options.appId;if(!i)throw Bi.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)Kn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Bi.create("no-api-key");if(Gc[i]!=null)throw Bi.create("already-exists",{id:i});if(!dS){HJ(cy);const{wrappedGtag:s,gtagCore:o}=WJ(Gc,lS,hS,cy,hX);jb=s,uS=o,dS=!0}return Gc[i]=cX(e,lS,hS,t,uS,cy,n),new lX(e)}function gX(e,t,n){e=Ce(e),oX(jb,Gc[e.app.options.appId],t,n).catch(i=>Kn.error(i))}function fX(e,t,n,i){e=Ce(e),sX(jb,Gc[e.app.options.appId],t,n,i).catch(r=>Kn.error(r))}const gS="@firebase/analytics",fS="0.10.19";function mX(){Wi(new Ni(cS,(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();return dX(i,r,n)},"PUBLIC")),Wi(new Ni("analytics-internal",e,"PRIVATE")),qn(gS,fS),qn(gS,fS,"esm2020");function e(t){try{const n=t.getProvider(cS).getImmediate();return{logEvent:(i,r,s)=>fX(n,i,r,s),setUserProperties:(i,r)=>gX(n,i,r)}}catch(n){throw Bi.create("interop-component-reg-failed",{reason:n})}}}mX();const pX={apiKey:"AIzaSyDgAQpq-gbHeYVJen_cMMgepsxf0TzUopI",authDomain:"quiz-cd4c1.firebaseapp.com",projectId:"quiz-cd4c1",storageBucket:"quiz-cd4c1.firebasestorage.app",messagingSenderId:"252346768980",appId:"1:252346768980:web:16f1f4b9d365d6e1ad57c1",measurementId:"G-8JDJSZR9X9",databaseURL:"https://quiz-cd4c1-default-rtdb.asia-southeast1.firebasedatabase.app"},Rp=KM(pX),kt=CD(Rp),iq=wW(Rp);_Y(Rp);KY(Rp);const vX=Object.freeze(Object.defineProperty({__proto__:null,db:kt,rtdb:iq},Symbol.toStringTag,{value:"Module"})),yX=()=>{const e="quiz_user_id";let t=localStorage.getItem(e);return t||(t="web_user_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),localStorage.setItem(e,t)),t},xX=()=>localStorage.getItem("quiz_user_name")||"Ngi chi",rq=()=>{const e=new Date,t=e.getDay(),n=e.getDate()-t+(t===0?-6:1);return new Date(e.setDate(n)).toDateString()},mS=e=>e<=1?0:100*e*(e-1)/2,sq=e=>{const t=Math.floor((1+Math.sqrt(1+8*e/100))/2);return Math.max(1,t)},_X=e=>{const t=sq(e),n=mS(t),i=mS(t+1);return{current:e-n,required:i-n}},Sn={dailyCorrect:0,dailyQuizzes:0,dailyDate:new Date().toDateString(),weeklyXP:0,weeklyPerfect:0,weeklyStartDate:rq(),claimedDailyQuests:[],claimedWeeklyQuests:[],dailyConquests:0,weeklyConquests:0,weeklyConquestWins:0,dailyGachaPulls:0,weeklyGachaPulls:0,dailyTowerFloors:0,weeklyTowerFloors:0,dailyAvatarChanged:0,dailyFrameChanged:0,dailyBadgeChanged:0,dailyCardViewed:0,weeklyCardViewed:0},pS={totalScore:0,totalCorrect:0,totalWrong:0,totalQuizzes:0,streak:0,lastPlayDate:"",level:1,exp:0,badges:[],chapterProgress:{},hearts:5,maxHearts:5,lastHeartRefill:"",gems:300,dailyGoal:50,dailyProgress:0,achievements:[],totalPlayTime:0,perfectLessons:0,longestStreak:0,conquestStats:{rankPoints:0,highestRankId:"wood_1",totalConquests:0,totalConquestCorrect:0,totalConquestWrong:0,bestWinStreak:0,currentWinStreak:0,lastConquestDate:""},questProgress:Sn,claimedAchievementRewards:[],claimedMails:[],usedRedeemCodes:[],gachaInventory:{cards:{},rewards:[],shards:0,totalPulls:0,pityCounters:{},gachaStats:{totalNCards:0,totalRCards:0,totalSRCards:0,totalURCards:0,totalAvatars:0,totalFrames:0,totalBadges:0,completedCollections:0}}},te=Zu((e,t)=>({user:null,isLoading:!1,error:null,updateUsername:async n=>{const{user:i}=t();if(!i||!n.trim())return!1;const r=n.trim();if(r.length<2||r.length>20)return!1;try{const s=Dt(kt,"users",i.oderId);return await Kt(s,{odername:r}),e({user:{...i,odername:r}}),!0}catch(s){return console.error("Error updating username:",s),!1}},initUser:async()=>{e({isLoading:!0,error:null});try{const n=yX(),i=xX(),r=Dt(kt,"users",n),s=await Qr(r);if(s.exists()){const o=s.data(),a=Date.now(),c=o.lastHeartRefill?new Date(o.lastHeartRefill).getTime():0,h=(a-c)/(1e3*60*30),u=Math.min(Math.floor(h),o.maxHearts-o.hearts);u>0&&(o.hearts=Math.min(o.hearts+u,o.maxHearts),o.lastHeartRefill=new Date().toISOString(),await Kt(r,{hearts:o.hearts,lastHeartRefill:o.lastHeartRefill}));const d=new Date().toDateString();(o.lastPlayDate?new Date(o.lastPlayDate).toDateString():"")!==d&&(o.dailyProgress=0),e({user:o,isLoading:!1})}else{const o={oderId:n,odername:i,avatar:"",...pS};await Hw(r,o),e({user:o,isLoading:!1})}}catch(n){console.error("Error init user:",n);const i={oderId:"dev_user_"+Date.now(),odername:"Dev User",avatar:"",...pS};e({user:i,isLoading:!1})}},updateStats:async(n,i,r)=>{const{user:s,checkAchievements:o,getXPMultiplier:a}=t();if(!s)return;const c=a(),u=(n?10:2)*c,d={totalScore:s.totalScore+r,totalCorrect:s.totalCorrect+(n?1:0),totalWrong:s.totalWrong+(n?0:1),exp:s.exp+u,gems:s.gems+(n?15:0)},f=sq(d.exp);try{const v=Dt(kt,"users",s.oderId);await Kt(v,{...d,level:f}),e({user:{...s,...d,level:f}}),await o()}catch(v){console.error("Error updating stats:",v),e({user:{...s,...d,level:f}})}},loseHeart:async()=>{const{user:n,hasUnlimitedHearts:i}=t();if(!n)return!1;if(i())return!0;if(n.hearts<=0)return!1;const r=n.hearts-1;try{const s=Dt(kt,"users",n.oderId);return await Kt(s,{hearts:r}),e({user:{...n,hearts:r}}),r>0}catch{return e({user:{...n,hearts:r}}),r>0}},refillHearts:async()=>{const{user:n}=t();if(n)try{const i=Dt(kt,"users",n.oderId);await Kt(i,{hearts:n.maxHearts,lastHeartRefill:new Date().toISOString()}),e({user:{...n,hearts:n.maxHearts,lastHeartRefill:new Date().toISOString()}})}catch{e({user:{...n,hearts:n.maxHearts}})}},addGems:async n=>{const{user:i}=t();if(!i)return;const r=i.gems+n;try{const s=Dt(kt,"users",i.oderId);await Kt(s,{gems:r}),e({user:{...i,gems:r}})}catch{e({user:{...i,gems:r}})}},spendGems:async n=>{const{user:i}=t();if(!i||i.gems<n)return!1;const r=i.gems-n;try{const s=Dt(kt,"users",i.oderId);return await Kt(s,{gems:r}),e({user:{...i,gems:r}}),!0}catch{return e({user:{...i,gems:r}}),!0}},updateDailyProgress:async n=>{const{user:i}=t();if(!i)return;const r=i.dailyProgress+n;try{const s=Dt(kt,"users",i.oderId);await Kt(s,{dailyProgress:r}),e({user:{...i,dailyProgress:r}})}catch{e({user:{...i,dailyProgress:r}})}},addPerfectLesson:async()=>{const{user:n,checkAchievements:i}=t();if(!n)return;const r=n.perfectLessons+1,s=150;try{const o=Dt(kt,"users",n.oderId);await Kt(o,{perfectLessons:r,gems:n.gems+s}),e({user:{...n,perfectLessons:r,gems:n.gems+s}}),await i()}catch{e({user:{...n,perfectLessons:r,gems:n.gems+s}})}},updateChapterProgress:async(n,i)=>{const{user:r}=t();if(!r)return;const o={...r.chapterProgress[n]||{completed:0,correct:0,bestScore:0,lastAttempt:"",stars:0,locked:!1},...i},a={...r.chapterProgress,[n]:o};try{const c=Dt(kt,"users",r.oderId);await Kt(c,{chapterProgress:a}),e({user:{...r,chapterProgress:a}})}catch{e({user:{...r,chapterProgress:a}})}},addBadge:async n=>{const{user:i}=t();if(!i||i.badges.includes(n))return;const r=[...i.badges,n];try{const s=Dt(kt,"users",i.oderId);await Kt(s,{badges:r}),e({user:{...i,badges:r}})}catch{e({user:{...i,badges:r}})}},updateStreak:async()=>{const{user:n,checkAchievements:i}=t();if(!n)return;const r=new Date().toDateString(),s=n.lastPlayDate?new Date(n.lastPlayDate).toDateString():"",o=new Date(Date.now()-864e5).toDateString(),a=n.lastPlayDate?new Date(n.lastPlayDate).getTime():0,c=new Date(r).getTime(),h=a?Math.floor((c-a)/864e5)-1:0;let u=n.streak,d=0;const f=n.streakFreezes||0;if(s===r)return;s===o?u+=1:h>0&&f>=h?(d=h,u+=1):h>0&&f>0?(d=f,u=1):s!==r&&(u=1);const v=f-d,y=Math.max(n.longestStreak,u),_=u%7===0?300:0;try{const w=Dt(kt,"users",n.oderId);await Kt(w,{streak:u,lastPlayDate:r,longestStreak:y,gems:n.gems+_,streakFreezes:v,lastStreakFreezeUsed:d>0?d:null}),e({user:{...t().user,streak:u,lastPlayDate:r,longestStreak:y,gems:t().user.gems+_,streakFreezes:v,lastStreakFreezeUsed:d>0?d:void 0}}),await i(),d>0&&console.log(` s dng ${d} Streak Freeze t ng!`)}catch{e({user:{...n,streak:u,lastPlayDate:r,longestStreak:y,streakFreezes:v}})}},checkAchievements:async()=>{var s,o,a,c,h;const{user:n}=t();if(!n)return[];const{ACHIEVEMENTS:i}=await Tf(async()=>{const{ACHIEVEMENTS:u}=await Promise.resolve().then(()=>TX);return{ACHIEVEMENTS:u}},[]),r=[];for(const u of i){if(n.achievements.includes(u.id))continue;let d=!1;const f=(s=n.gachaInventory)==null?void 0:s.gachaStats,v=((f==null?void 0:f.totalURCards)??0)+((f==null?void 0:f.totalSRCards)??0)+((f==null?void 0:f.totalRCards)??0)+((f==null?void 0:f.totalNCards)??0);switch(u.type){case"streak":d=n.streak>=u.requirement;break;case"correct":d=n.totalCorrect>=u.requirement;break;case"perfect":d=(n.perfectLessons??0)>=u.requirement;break;case"level":d=(n.level??1)>=u.requirement;break;case"conquest":d=(((o=n.conquestStats)==null?void 0:o.totalConquests)??0)>=u.requirement;break;case"conquest_wins":d=(((a=n.conquestStats)==null?void 0:a.bestWinStreak)??0)>=u.requirement;break;case"rank_points":d=(((c=n.conquestStats)==null?void 0:c.rankPoints)??0)>=u.requirement;break;case"gems":d=n.gems>=u.requirement;break;case"gacha_pulls":d=(((h=n.gachaInventory)==null?void 0:h.totalPulls)??0)>=u.requirement;break;case"gacha_ur":d=((f==null?void 0:f.totalURCards)??0)>=u.requirement;break;case"gacha_sr":d=((f==null?void 0:f.totalSRCards)??0)>=u.requirement;break;case"gacha_total_cards":d=v>=u.requirement;break;case"gacha_collections":d=((f==null?void 0:f.completedCollections)??0)>=u.requirement;break;case"quizzes":d=(n.totalQuizzes??0)>=u.requirement;break}if(d){r.push(u.id);const y=[...n.achievements,u.id];try{const _=Dt(kt,"users",n.oderId);await Kt(_,{achievements:y,gems:n.gems+50}),e({user:{...n,achievements:y,gems:n.gems+50}})}catch{e({user:{...n,achievements:y}})}}}return r},updateQuestProgress:async n=>{const{user:i}=t();if(!i)return;const r=i.questProgress||Sn,s=new Date().toDateString(),o=rq();let a={...r};r.dailyDate!==s&&(a={...a,dailyCorrect:0,dailyQuizzes:0,dailyDate:s,claimedDailyQuests:[]}),r.weeklyStartDate!==o&&(a={...a,weeklyXP:0,weeklyPerfect:0,weeklyStartDate:o,claimedWeeklyQuests:[]}),a={...a,...n};try{const c=Dt(kt,"users",i.oderId);await Kt(c,{questProgress:a}),e({user:{...i,questProgress:a}})}catch(c){console.error("Error updating quest progress:",c),e({user:{...i,questProgress:a}})}},claimDailyQuest:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const o=[...(i.questProgress||Sn).claimedDailyQuests,n];await r({claimedDailyQuests:o})},claimWeeklyQuest:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const o=[...(i.questProgress||Sn).claimedWeeklyQuests,n];await r({claimedWeeklyQuests:o})},incrementDailyCorrect:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyCorrect:r.dailyCorrect+1})},incrementDailyQuizzes:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyQuizzes:r.dailyQuizzes+1})},incrementWeeklyXP:async n=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const s=i.questProgress||Sn;await r({weeklyXP:s.weeklyXP+n})},incrementWeeklyPerfect:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({weeklyPerfect:r.weeklyPerfect+1})},incrementDailyConquests:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyConquests:(r.dailyConquests||0)+1,weeklyConquests:(r.weeklyConquests||0)+1})},incrementWeeklyConquestWins:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({weeklyConquestWins:(r.weeklyConquestWins||0)+1})},incrementDailyGachaPulls:async(n=1)=>{const{user:i,updateQuestProgress:r}=t();if(!i)return;const s=i.questProgress||Sn;await r({dailyGachaPulls:(s.dailyGachaPulls||0)+n,weeklyGachaPulls:(s.weeklyGachaPulls||0)+n})},incrementDailyTowerFloors:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyTowerFloors:(r.dailyTowerFloors||0)+1,weeklyTowerFloors:(r.weeklyTowerFloors||0)+1})},incrementDailyAvatarChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyAvatarChanged:(r.dailyAvatarChanged||0)+1})},incrementDailyFrameChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyFrameChanged:(r.dailyFrameChanged||0)+1})},incrementDailyBadgeChanged:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyBadgeChanged:(r.dailyBadgeChanged||0)+1})},incrementDailyCardViewed:async()=>{const{user:n,updateQuestProgress:i}=t();if(!n)return;const r=n.questProgress||Sn;await i({dailyCardViewed:(r.dailyCardViewed||0)+1,weeklyCardViewed:(r.weeklyCardViewed||0)+1})},claimAchievementReward:async n=>{const i=t().user;if(!i)return;const r=i.claimedAchievementRewards||[];if(r.includes(n))return;const s=[...r,n];try{const o=Dt(kt,"users",i.oderId);await Kt(o,{claimedAchievementRewards:s});const a=t().user;a&&e({user:{...a,claimedAchievementRewards:s}})}catch(o){console.error("Error claiming achievement reward:",o);const a=t().user;a&&e({user:{...a,claimedAchievementRewards:s}})}},claimMail:async n=>{const{user:i}=t();if(!i)return;const r=i.claimedMails||[];if(r.includes(n))return;const s=[...r,n];try{const o=Dt(kt,"users",i.oderId);await Kt(o,{claimedMails:s}),e({user:{...i,claimedMails:s}})}catch(o){console.error("Error claiming mail:",o),e({user:{...i,claimedMails:s}})}},deleteMail:async n=>{const{user:i}=t();if(!i)return;const r=i.deletedMails||[];if(r.includes(n))return;const s=[...r,n];try{const o=Dt(kt,"users",i.oderId);await Kt(o,{deletedMails:s}),e({user:{...i,deletedMails:s}})}catch(o){console.error("Error deleting mail:",o),e({user:{...i,deletedMails:s}})}},useRedeemCode:async n=>{const{user:i}=t();if(!i)return;const r=i.usedRedeemCodes||[];if(r.includes(n))return;const s=[...r,n];try{const o=Dt(kt,"users",i.oderId);await Kt(o,{usedRedeemCodes:s}),e({user:{...i,usedRedeemCodes:s}})}catch(o){console.error("Error using redeem code:",o),e({user:{...i,usedRedeemCodes:s}})}},buyUnlimitedHearts:async()=>{const{user:n,spendGems:i}=t();if(!n)return!1;const r=3e3,s=24*60*60*1e3;if(n.gems<r||!await i(r))return!1;const a=new Date(Date.now()+s).toISOString();try{const c=Dt(kt,"users",n.oderId);return await Kt(c,{unlimitedHeartsUntil:a}),e({user:{...t().user,unlimitedHeartsUntil:a}}),!0}catch(c){return console.error("Error buying unlimited hearts:",c),!1}},hasUnlimitedHearts:()=>{const{user:n}=t();if(!(n!=null&&n.unlimitedHeartsUntil))return!1;const i=new Date(n.unlimitedHeartsUntil).getTime();return Date.now()<i},getUnlimitedHeartsTimeLeft:()=>{const{user:n}=t();if(!(n!=null&&n.unlimitedHeartsUntil))return null;const r=new Date(n.unlimitedHeartsUntil).getTime()-Date.now();if(r<=0)return null;const s=Math.floor(r/(60*60*1e3)),o=Math.floor(r%(60*60*1e3)/6e4);return`${s}h ${o}m`},equipAvatar:async n=>{const{user:i}=t();if(i)try{const r=Dt(kt,"users",i.oderId);await Kt(r,{equippedAvatar:n||null}),e({user:{...i,equippedAvatar:n||void 0}})}catch(r){console.error("Error equipping avatar:",r),e({user:{...i,equippedAvatar:n||void 0}})}},equipFrame:async n=>{const{user:i}=t();if(i)try{const r=Dt(kt,"users",i.oderId);await Kt(r,{equippedFrame:n||null}),e({user:{...i,equippedFrame:n||void 0}})}catch(r){console.error("Error equipping frame:",r),e({user:{...i,equippedFrame:n||void 0}})}},equipBadge:async n=>{const{user:i}=t();if(i)try{const r=Dt(kt,"users",i.oderId);await Kt(r,{equippedBadge:n||null}),e({user:{...i,equippedBadge:n||void 0}})}catch(r){console.error("Error equipping badge:",r),e({user:{...i,equippedBadge:n||void 0}})}},buyXPBoost:async n=>{const{user:i,spendGems:r}=t();if(!i)return!1;const o={1:500,3:1200,8:2500}[n];if(!o||i.gems<o||!await r(o))return!1;const c=i.xpBoostUntil?new Date(i.xpBoostUntil).getTime():Date.now(),h=c>Date.now()?c:Date.now(),u=new Date(h+n*60*60*1e3).toISOString();try{const d=Dt(kt,"users",i.oderId);return await Kt(d,{xpBoostUntil:u,xpBoostMultiplier:2}),e({user:{...t().user,xpBoostUntil:u,xpBoostMultiplier:2}}),!0}catch(d){return console.error("Error buying XP boost:",d),!1}},hasXPBoost:()=>{const{user:n}=t();return n!=null&&n.xpBoostUntil?Date.now()<new Date(n.xpBoostUntil).getTime():!1},getXPBoostTimeLeft:()=>{const{user:n}=t();if(!(n!=null&&n.xpBoostUntil))return null;const r=new Date(n.xpBoostUntil).getTime()-Date.now();if(r<=0)return null;const s=Math.floor(r/(60*60*1e3)),o=Math.floor(r%(60*60*1e3)/6e4);return`${s}h ${o}m`},getXPMultiplier:()=>{const{hasXPBoost:n,user:i}=t();return n()?(i==null?void 0:i.xpBoostMultiplier)||2:1},buyStreakFreeze:async()=>{const{user:n,spendGems:i}=t();if(!n)return!1;const r=1e3,s=5,o=n.streakFreezes||0;if(o>=s||n.gems<r||!await i(r))return!1;const c=o+1;try{const h=Dt(kt,"users",n.oderId);return await Kt(h,{streakFreezes:c}),e({user:{...t().user,streakFreezes:c}}),!0}catch(h){return console.error("Error buying streak freeze:",h),!1}},useStreakFreeze:async()=>{const{user:n}=t();if(!n)return!1;const i=n.streakFreezes||0;if(i<=0)return!1;const r=i-1;try{const s=Dt(kt,"users",n.oderId);return await Kt(s,{streakFreezes:r}),e({user:{...n,streakFreezes:r}}),!0}catch(s){return console.error("Error using streak freeze:",s),!1}},getStreakFreezeCount:()=>{const{user:n}=t();return(n==null?void 0:n.streakFreezes)||0}}));function _0({isOpen:e,onClose:t,title:n,children:i,showCloseButton:r=!0}){return e?l.jsxs("div",{className:"fixed inset-0 z-[150] flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),l.jsxs("div",{className:"relative bg-[var(--card)] rounded-3xl p-6 mx-4 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",children:[r&&l.jsx("button",{onClick:t,className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--muted-foreground)]"})}),n&&l.jsx("h2",{className:"font-bold text-xl text-foreground text-center mb-4",children:n}),i]})]}):null}function oq({isOpen:e,onClose:t,onBuyHearts:n,onGoToShop:i,userGems:r,heartCost:s}){const[o,a]=I.useState(!1),c=r>=s,h=()=>{c?n():a(!0)},u=()=>{a(!1),t()};return o?l.jsx(_0,{isOpen:e,onClose:u,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-12 h-12 grayscale opacity-50"})}),l.jsx("h2",{className:"font-bold text-xl text-foreground mb-2",children:"Khng  Gems!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-4",children:"Bn cn thm gems  mua tim."}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Cn"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-foreground",children:s})]})]}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Hin c"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:r})]})]}),l.jsx("div",{className:"border-t border-[var(--border)] pt-2",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-[var(--duo-red)]",children:"Thiu"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:s-r})]})]})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>{a(!1),i()},className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #1cb0f6 0%, #1899d6 100%)",boxShadow:"0 4px 0 #1682c4"},children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{children:"Kim thm Gems"})]}),l.jsx("button",{onClick:()=>a(!1),className:"w-full py-3 px-4 rounded-xl font-bold text-[var(--muted-foreground)] bg-[var(--secondary)]",children:"Quay li"})]})]})}):l.jsx(_0,{isOpen:e,onClose:u,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-12 h-12 grayscale opacity-50"})}),l.jsx("h2",{className:"font-bold text-xl text-foreground mb-2",children:"Ht tim ri!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-4",children:"Bn cn tim  tip tc chi. Hy ch hi phc hoc dng gems  mua thm."}),l.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Gems hin c:"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:r})]})]}),l.jsx("div",{className:"bg-[var(--duo-blue)]/10 rounded-xl p-3 mb-4",children:l.jsxs("p",{className:"text-xs text-[var(--duo-blue)] font-semibold",children:["Vo ",l.jsx("span",{className:"font-bold",children:"Luyn tp"})," hoc"," ",l.jsx("span",{className:"font-bold",children:"Chinh chin"}),"  cy gems m hi tim nh!"]})}),l.jsxs("div",{className:"space-y-3",children:[c&&l.jsxs("button",{onClick:h,className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #58cc02 0%, #46a302 100%)",boxShadow:"0 4px 0 #3d8c02"},children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-5 h-5"}),l.jsx("span",{children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center gap-1 ml-2 bg-white/20 px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{children:s})]})]}),!c&&l.jsxs("button",{onClick:i,className:"w-full py-3 px-4 rounded-xl font-bold text-white flex items-center justify-center gap-2",style:{background:"linear-gradient(135deg, #1cb0f6 0%, #1899d6 100%)",boxShadow:"0 4px 0 #1682c4"},children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{children:"Kim thm Gems"})]}),l.jsx("button",{onClick:u,className:"w-full py-3 px-4 rounded-xl font-bold text-[var(--muted-foreground)] bg-[var(--secondary)]",children:"Ch hi phc"})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-4",children:"Tim t hi phc mi 30 pht"})]})})}function Gn({isOpen:e,onClose:t,title:n="Nhn qu thnh cng!",subtitle:i,rewards:r,buttonText:s="Tuyt vi!",gradientFrom:o="var(--duo-green)",gradientTo:a="var(--duo-blue)"}){if(!e)return null;const c=u=>{if(u.icon)return u.icon;switch(u.type){case"gems":return"/AppAssets/BlueDiamond.png";case"xp":case"exp":return"/AppAssets/Lighting.png";case"hearts":return"/AppAssets/Heart.png";case"shard":return"/AppAssets/Shard.png";default:return"/AppAssets/BlueDiamond.png"}},h=u=>{if(u.label)return u.label;switch(u.type){case"gems":return"Gems";case"xp":case"exp":return"XP";case"hearts":return"Tim";case"shard":return"Mnh";default:return""}};return l.jsx(_0,{isOpen:e,onClose:t,showCloseButton:!1,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:`linear-gradient(135deg, ${o}, ${a})`},children:l.jsx(Be,{className:"w-10 h-10 text-white"})}),l.jsx("h2",{className:"text-xl font-bold mb-2",style:{color:o},children:n}),i&&l.jsx("p",{className:"text-[var(--muted-foreground)] mb-4",children:i}),l.jsx("div",{className:"bg-[var(--secondary)] rounded-2xl p-4 mb-4 space-y-3",children:r.map((u,d)=>l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("img",{src:c(u),alt:u.type,className:"w-10 h-10"}),l.jsxs("span",{className:"text-3xl font-bold text-[var(--duo-blue)]",children:["+",u.amount]}),h(u)&&l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:h(u)})]},d))}),l.jsx("button",{onClick:t,className:"btn-3d btn-3d-green w-full py-3",children:s})]})})}function wX(){const e=we(),{loadQuiz:t,chapters:n}=ds(),{initUser:i,user:r,spendGems:s,refillHearts:o,hasUnlimitedHearts:a}=te(),[c,h]=I.useState(!1),[u,d]=I.useState(null),[f,v]=I.useState(!1),[y,_]=I.useState(0);I.useEffect(()=>{t(),i()},[]),I.useEffect(()=>{r!=null&&r.lastStreakFreezeUsed&&r.lastStreakFreezeUsed>0&&(_(r.lastStreakFreezeUsed),v(!0),(async()=>{const{doc:T,updateDoc:E}=await Tf(async()=>{const{doc:D,updateDoc:j}=await Promise.resolve().then(()=>jD);return{doc:D,updateDoc:j}},void 0),{db:R}=await Tf(async()=>{const{db:D}=await Promise.resolve().then(()=>vX);return{db:D}},void 0);try{const D=T(R,"users",r.oderId);await E(D,{lastStreakFreezeUsed:null})}catch(D){console.error("Error clearing freeze notification:",D)}})())},[r==null?void 0:r.lastStreakFreezeUsed]);const w=N=>{if(r&&r.hearts<=0&&!a()){d(N),h(!0);return}ds.getState().selectChapter(N),e("/quiz")},x=async()=>{await s(500)&&(await o(),h(!1),u!==null&&(ds.getState().selectChapter(u),e("/quiz")))},C=()=>{h(!1),e("/shop")},k=["#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b","#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b","#ff9600"],P=(r==null?void 0:r.dailyProgress)??0,A=(r==null?void 0:r.dailyGoal)??50,M=A>0?Math.min(P/A*100,100):0;return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-3 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-11 h-11 rounded-2xl bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(tl,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-lg text-foreground",children:"Quiz QTDA"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[n.length," chng"]})]})]}),r&&l.jsx("div",{className:"bg-[var(--duo-yellow)] px-2.5 py-1 rounded-lg",children:l.jsxs("span",{className:"text-xs font-bold text-[#1a2c35]",children:["Lv.",r.level]})})]}),r&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[a()?l.jsxs("div",{className:"flex items-center gap-1 bg-gradient-to-r from-[var(--duo-red)] to-[var(--duo-pink)] px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),l.jsx("span",{className:"text-white font-bold text-sm",children:""})]}):l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(r.maxHearts??5)].map((N,T)=>l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:`w-4 h-4 ${T>=(r.hearts??5)?"opacity-30 grayscale":""}`},T))}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-orange)]",children:r.streak})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-blue)]",children:Dn(r.gems)})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Ve,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-yellow)]",children:Dn(kf(r,0).totalScore)})]})]})]})]}),l.jsxs("div",{className:"px-4 pt-40 pb-28",children:[r&&l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(ji,{className:"w-4 h-4 text-[var(--duo-green)]"}),l.jsx("span",{className:"font-bold text-sm text-foreground",children:"Mc tiu hm nay"})]}),l.jsxs("span",{className:`font-bold text-sm ${(r.dailyProgress??0)>=(r.dailyGoal??50)?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`,children:[r.dailyProgress??0,"/",r.dailyGoal??50," XP"]})]}),l.jsx("div",{className:"progress-duo h-2.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${M}%`,background:(r.dailyProgress??0)>=(r.dailyGoal??50)?"var(--duo-yellow)":void 0}})})]}),l.jsxs("button",{onClick:()=>e("/battle"),className:"btn-battle w-full mb-3 py-4 px-4 rounded-2xl font-bold text-white text-lg flex items-center justify-center gap-3",style:{background:"linear-gradient(135deg, #58cc02 0%, #46a302 100%)",boxShadow:"0 6px 0 #3d8c02, 0 8px 20px rgba(88, 204, 2, 0.4)"},children:[l.jsx(xB,{className:"w-7 h-7"}),l.jsx("span",{children:"LUYN TP"})]}),l.jsxs("button",{onClick:()=>e("/conquest"),className:"btn-battle w-full mb-5 py-4 px-4 rounded-2xl font-bold text-white text-lg flex items-center justify-center gap-3",style:{background:"linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%)",boxShadow:"0 6px 0 #7c3aed, 0 8px 20px rgba(139, 92, 246, 0.4)"},children:[l.jsx(Ci,{className:"w-7 h-7"}),l.jsx("span",{children:"CHINH CHIN"})]}),l.jsx("h2",{className:"text-sm font-bold mb-3 text-[var(--muted-foreground)]",children:"Chn chng"}),l.jsx("div",{className:"space-y-2.5",children:n.map((N,T)=>{const E=r==null?void 0:r.chapterProgress[N.id],R=E?Math.round(E.completed/N.totalQuestions*100):0,D=(E==null?void 0:E.stars)||0;return l.jsx("button",{onClick:()=>w(N.id),className:"card-3d w-full p-3 text-left",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center text-white font-bold text-base shrink-0",style:{background:k[T%k.length]},children:N.id}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground line-clamp-1",children:N.name}),l.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[N.totalQuestions," cu"]}),D>0&&l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(3)].map((j,L)=>l.jsx(me,{className:`w-3 h-3 ${L<D?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},L))})]}),l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})})]}),l.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[(E==null?void 0:E.isCompleted)&&l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}),E&&E.bestScore>0&&l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Best"}),l.jsx("div",{className:"font-bold text-sm text-[var(--duo-green)]",children:E.bestScore})]})]})]})},N.id)})})]}),l.jsx(oq,{isOpen:c,onClose:()=>{h(!1),d(null)},onBuyHearts:x,onGoToShop:C,userGems:(r==null?void 0:r.gems)??0,heartCost:500}),l.jsx(Gn,{isOpen:f,onClose:()=>v(!1),title:"Streak  c bo v! ",subtitle:` s dng ${y} Streak Freeze  gi streak ca bn`,rewards:[{type:"custom",amount:(r==null?void 0:r.streak)||0,icon:"/AppAssets/Fire.png",label:"ngy streak c gi"}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-blue)",gradientTo:"#84d8ff"})]})}var Fb={};(function e(t,n,i,r){var s=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=function(){if(!t.OffscreenCanvas)return!1;try{var F=new OffscreenCanvas(1,1),q=F.getContext("2d");q.fillRect(0,0,1,1);var $=F.transferToImageBitmap();q.createPattern($,"no-repeat")}catch{return!1}return!0}();function c(){}function h(F){var q=n.exports.Promise,$=q!==void 0?q:t.Promise;return typeof $=="function"?new $(F):(F(c,c),null)}var u=function(F,q){return{transform:function($){if(F)return $;if(q.has($))return q.get($);var H=new OffscreenCanvas($.width,$.height),X=H.getContext("2d");return X.drawImage($,0,0),q.set($,H),H},clear:function(){q.clear()}}}(a,new Map),d=function(){var F=Math.floor(16.666666666666668),q,$,H={},X=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(q=function(tt){var O=Math.random();return H[O]=requestAnimationFrame(function B(nt){X===nt||X+F-1<nt?(X=nt,delete H[O],tt()):H[O]=requestAnimationFrame(B)}),O},$=function(tt){H[tt]&&cancelAnimationFrame(H[tt])}):(q=function(tt){return setTimeout(tt,F)},$=function(tt){return clearTimeout(tt)}),{frame:q,cancel:$}}(),f=function(){var F,q,$={};function H(X){function tt(O,B){X.postMessage({options:O||{},callback:B})}X.init=function(B){var nt=B.transferControlToOffscreen();X.postMessage({canvas:nt},[nt])},X.fire=function(B,nt,K){if(q)return tt(B,null),q;var at=Math.random().toString(36).slice(2);return q=h(function(ct){function vt(Rt){Rt.data.callback===at&&(delete $[at],X.removeEventListener("message",vt),q=null,u.clear(),K(),ct())}X.addEventListener("message",vt),tt(B,at),$[at]=vt.bind(null,{data:{callback:at}})}),q},X.reset=function(){X.postMessage({reset:!0});for(var B in $)$[B](),delete $[B]}}return function(){if(F)return F;if(!i&&s){var X=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{F=new Worker(URL.createObjectURL(new Blob([X])))}catch(tt){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",tt),null}H(F)}return F}}(),v={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function y(F,q){return q?q(F):F}function _(F){return F!=null}function w(F,q,$){return y(F&&_(F[q])?F[q]:v[q],$)}function x(F){return F<0?0:Math.floor(F)}function C(F,q){return Math.floor(Math.random()*(q-F))+F}function k(F){return parseInt(F,16)}function P(F){return F.map(A)}function A(F){var q=String(F).replace(/[^0-9a-f]/gi,"");return q.length<6&&(q=q[0]+q[0]+q[1]+q[1]+q[2]+q[2]),{r:k(q.substring(0,2)),g:k(q.substring(2,4)),b:k(q.substring(4,6))}}function M(F){var q=w(F,"origin",Object);return q.x=w(q,"x",Number),q.y=w(q,"y",Number),q}function N(F){F.width=document.documentElement.clientWidth,F.height=document.documentElement.clientHeight}function T(F){var q=F.getBoundingClientRect();F.width=q.width,F.height=q.height}function E(F){var q=document.createElement("canvas");return q.style.position="fixed",q.style.top="0px",q.style.left="0px",q.style.pointerEvents="none",q.style.zIndex=F,q}function R(F,q,$,H,X,tt,O,B,nt){F.save(),F.translate(q,$),F.rotate(tt),F.scale(H,X),F.arc(0,0,1,O,B,nt),F.restore()}function D(F){var q=F.angle*(Math.PI/180),$=F.spread*(Math.PI/180);return{x:F.x,y:F.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:F.startVelocity*.5+Math.random()*F.startVelocity,angle2D:-q+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:F.color,shape:F.shape,tick:0,totalTicks:F.ticks,decay:F.decay,drift:F.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:F.gravity*3,ovalScalar:.6,scalar:F.scalar,flat:F.flat}}function j(F,q){q.x+=Math.cos(q.angle2D)*q.velocity+q.drift,q.y+=Math.sin(q.angle2D)*q.velocity+q.gravity,q.velocity*=q.decay,q.flat?(q.wobble=0,q.wobbleX=q.x+10*q.scalar,q.wobbleY=q.y+10*q.scalar,q.tiltSin=0,q.tiltCos=0,q.random=1):(q.wobble+=q.wobbleSpeed,q.wobbleX=q.x+10*q.scalar*Math.cos(q.wobble),q.wobbleY=q.y+10*q.scalar*Math.sin(q.wobble),q.tiltAngle+=.1,q.tiltSin=Math.sin(q.tiltAngle),q.tiltCos=Math.cos(q.tiltAngle),q.random=Math.random()+2);var $=q.tick++/q.totalTicks,H=q.x+q.random*q.tiltCos,X=q.y+q.random*q.tiltSin,tt=q.wobbleX+q.random*q.tiltCos,O=q.wobbleY+q.random*q.tiltSin;if(F.fillStyle="rgba("+q.color.r+", "+q.color.g+", "+q.color.b+", "+(1-$)+")",F.beginPath(),o&&q.shape.type==="path"&&typeof q.shape.path=="string"&&Array.isArray(q.shape.matrix))F.fill(W(q.shape.path,q.shape.matrix,q.x,q.y,Math.abs(tt-H)*.1,Math.abs(O-X)*.1,Math.PI/10*q.wobble));else if(q.shape.type==="bitmap"){var B=Math.PI/10*q.wobble,nt=Math.abs(tt-H)*.1,K=Math.abs(O-X)*.1,at=q.shape.bitmap.width*q.scalar,ct=q.shape.bitmap.height*q.scalar,vt=new DOMMatrix([Math.cos(B)*nt,Math.sin(B)*nt,-Math.sin(B)*K,Math.cos(B)*K,q.x,q.y]);vt.multiplySelf(new DOMMatrix(q.shape.matrix));var Rt=F.createPattern(u.transform(q.shape.bitmap),"no-repeat");Rt.setTransform(vt),F.globalAlpha=1-$,F.fillStyle=Rt,F.fillRect(q.x-at/2,q.y-ct/2,at,ct),F.globalAlpha=1}else if(q.shape==="circle")F.ellipse?F.ellipse(q.x,q.y,Math.abs(tt-H)*q.ovalScalar,Math.abs(O-X)*q.ovalScalar,Math.PI/10*q.wobble,0,2*Math.PI):R(F,q.x,q.y,Math.abs(tt-H)*q.ovalScalar,Math.abs(O-X)*q.ovalScalar,Math.PI/10*q.wobble,0,2*Math.PI);else if(q.shape==="star")for(var ht=Math.PI/2*3,st=4*q.scalar,Tt=8*q.scalar,Nt=q.x,Jt=q.y,Et=5,Gt=Math.PI/Et;Et--;)Nt=q.x+Math.cos(ht)*Tt,Jt=q.y+Math.sin(ht)*Tt,F.lineTo(Nt,Jt),ht+=Gt,Nt=q.x+Math.cos(ht)*st,Jt=q.y+Math.sin(ht)*st,F.lineTo(Nt,Jt),ht+=Gt;else F.moveTo(Math.floor(q.x),Math.floor(q.y)),F.lineTo(Math.floor(q.wobbleX),Math.floor(X)),F.lineTo(Math.floor(tt),Math.floor(O)),F.lineTo(Math.floor(H),Math.floor(q.wobbleY));return F.closePath(),F.fill(),q.tick<q.totalTicks}function L(F,q,$,H,X){var tt=q.slice(),O=F.getContext("2d"),B,nt,K=h(function(at){function ct(){B=nt=null,O.clearRect(0,0,H.width,H.height),u.clear(),X(),at()}function vt(){i&&!(H.width===r.width&&H.height===r.height)&&(H.width=F.width=r.width,H.height=F.height=r.height),!H.width&&!H.height&&($(F),H.width=F.width,H.height=F.height),O.clearRect(0,0,H.width,H.height),tt=tt.filter(function(Rt){return j(O,Rt)}),tt.length?B=d.frame(vt):ct()}B=d.frame(vt),nt=ct});return{addFettis:function(at){return tt=tt.concat(at),K},canvas:F,promise:K,reset:function(){B&&d.cancel(B),nt&&nt()}}}function lt(F,q){var $=!F,H=!!w(q||{},"resize"),X=!1,tt=w(q,"disableForReducedMotion",Boolean),O=s&&!!w(q||{},"useWorker"),B=O?f():null,nt=$?N:T,K=F&&B?!!F.__confetti_initialized:!1,at=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ct;function vt(ht,st,Tt){for(var Nt=w(ht,"particleCount",x),Jt=w(ht,"angle",Number),Et=w(ht,"spread",Number),Gt=w(ht,"startVelocity",Number),yn=w(ht,"decay",Number),oe=w(ht,"gravity",Number),ft=w(ht,"drift",Number),St=w(ht,"colors",P),ae=w(ht,"ticks",Number),xn=w(ht,"shapes"),Jn=w(ht,"scalar"),Ii=!!w(ht,"flat"),Xn=M(ht),Zn=Nt,Ai=[],ti=F.width*Xn.x,Ri=F.height*Xn.y;Zn--;)Ai.push(D({x:ti,y:Ri,angle:Jt,spread:Et,startVelocity:Gt,color:St[Zn%St.length],shape:xn[C(0,xn.length)],ticks:ae,decay:yn,gravity:oe,drift:ft,scalar:Jn,flat:Ii}));return ct?ct.addFettis(Ai):(ct=L(F,Ai,nt,st,Tt),ct.promise)}function Rt(ht){var st=tt||w(ht,"disableForReducedMotion",Boolean),Tt=w(ht,"zIndex",Number);if(st&&at)return h(function(Gt){Gt()});$&&ct?F=ct.canvas:$&&!F&&(F=E(Tt),document.body.appendChild(F)),H&&!K&&nt(F);var Nt={width:F.width,height:F.height};B&&!K&&B.init(F),K=!0,B&&(F.__confetti_initialized=!0);function Jt(){if(B){var Gt={getBoundingClientRect:function(){if(!$)return F.getBoundingClientRect()}};nt(Gt),B.postMessage({resize:{width:Gt.width,height:Gt.height}});return}Nt.width=Nt.height=null}function Et(){ct=null,H&&(X=!1,t.removeEventListener("resize",Jt)),$&&F&&(document.body.contains(F)&&document.body.removeChild(F),F=null,K=!1)}return H&&!X&&(X=!0,t.addEventListener("resize",Jt,!1)),B?B.fire(ht,Nt,Et):vt(ht,Nt,Et)}return Rt.reset=function(){B&&B.reset(),ct&&ct.reset()},Rt}var dt;function Y(){return dt||(dt=lt(null,{useWorker:!0,resize:!0})),dt}function W(F,q,$,H,X,tt,O){var B=new Path2D(F),nt=new Path2D;nt.addPath(B,new DOMMatrix(q));var K=new Path2D;return K.addPath(nt,new DOMMatrix([Math.cos(O)*X,Math.sin(O)*X,-Math.sin(O)*tt,Math.cos(O)*tt,$,H])),K}function U(F){if(!o)throw new Error("path confetti are not supported in this browser");var q,$;typeof F=="string"?q=F:(q=F.path,$=F.matrix);var H=new Path2D(q),X=document.createElement("canvas"),tt=X.getContext("2d");if(!$){for(var O=1e3,B=O,nt=O,K=0,at=0,ct,vt,Rt=0;Rt<O;Rt+=2)for(var ht=0;ht<O;ht+=2)tt.isPointInPath(H,Rt,ht,"nonzero")&&(B=Math.min(B,Rt),nt=Math.min(nt,ht),K=Math.max(K,Rt),at=Math.max(at,ht));ct=K-B,vt=at-nt;var st=10,Tt=Math.min(st/ct,st/vt);$=[Tt,0,0,Tt,-Math.round(ct/2+B)*Tt,-Math.round(vt/2+nt)*Tt]}return{type:"path",path:q,matrix:$}}function Q(F){var q,$=1,H="#000000",X='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof F=="string"?q=F:(q=F.text,$="scalar"in F?F.scalar:$,X="fontFamily"in F?F.fontFamily:X,H="color"in F?F.color:H);var tt=10*$,O=""+tt+"px "+X,B=new OffscreenCanvas(tt,tt),nt=B.getContext("2d");nt.font=O;var K=nt.measureText(q),at=Math.ceil(K.actualBoundingBoxRight+K.actualBoundingBoxLeft),ct=Math.ceil(K.actualBoundingBoxAscent+K.actualBoundingBoxDescent),vt=2,Rt=K.actualBoundingBoxLeft+vt,ht=K.actualBoundingBoxAscent+vt;at+=vt+vt,ct+=vt+vt,B=new OffscreenCanvas(at,ct),nt=B.getContext("2d"),nt.font=O,nt.fillStyle=H,nt.fillText(q,Rt,ht);var st=1/$;return{type:"bitmap",bitmap:B.transferToImageBitmap(),matrix:[st,0,0,st,-at*st/2,-ct*st/2]}}n.exports=function(){return Y().apply(this,arguments)},n.exports.reset=function(){Y().reset()},n.exports.create=lt,n.exports.shapeFromPath=U,n.exports.shapeFromText=Q})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Fb,!1);const Se=Fb.exports;Fb.exports.create;function bX(){var W;const e=we(),{currentQuestions:t,currentIndex:n,selectedAnswer:i,isAnswered:r,selectAnswer:s,nextQuestion:o,score:a,quizMode:c}=ds(),{user:h,updateStats:u,updateStreak:d,loseHeart:f,updateDailyProgress:v,spendGems:y,refillHearts:_,hasUnlimitedHearts:w}=te(),[x,C]=I.useState(!1),[k,P]=I.useState(!1),[A,M]=I.useState(!1),[N,T]=I.useState(null),E=t[n],R=(n+1)/t.length*100,D=i===(E==null?void 0:E.correctAnswer),j=n===t.length-1;I.useEffect(()=>{T(null)},[n]),I.useEffect(()=>{r&&(D?(C(!0),Se({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]}),setTimeout(()=>C(!1),800)):c==="chapter"&&!w()&&(P(!0),setTimeout(()=>P(!1),800)))},[r,D,c]);const L=U=>{r||T(U)},lt=async()=>{if(!N||r)return;const U=c!=="chapter";if(h&&h.hearts<=0&&!w()&&!U){M(!0);return}s(N);const Q=N===E.correctAnswer;if(!Q&&!U&&await f(),Q){const F=new Date().toDateString(),q=parseInt(localStorage.getItem(`daily_correct_${F}`)||"0");localStorage.setItem(`daily_correct_${F}`,(q+1).toString());const $=parseInt(localStorage.getItem("weekly_xp")||"0");localStorage.setItem("weekly_xp",($+10).toString())}await u(Q,E.chapter,Q?10:0),await v(Q?10:2),n===0&&await d()},dt=async()=>{if(!h)return;await y(500)&&(await _(),M(!1))},Y=()=>{M(!1),e("/shop")};return E?l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})}),l.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Cu ",n+1,"/",t.length]}),l.jsxs("div",{className:"flex items-center gap-3",children:[h&&c==="chapter"&&(w()?l.jsxs("div",{className:"flex items-center gap-1 bg-gradient-to-r from-[var(--duo-red)] to-[var(--duo-pink)] px-2 py-0.5 rounded-full",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),l.jsx("span",{className:"text-white font-bold text-sm",children:""})]}):l.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(h.maxHearts??5)].map((U,Q)=>l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:`w-4 h-4 ${Q>=(h.hearts??5)?"opacity-30 grayscale":""}`},Q))})),l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-yellow)]",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:a})]})]})]})]}),x&&l.jsx("div",{className:"fixed top-1/3 left-1/2 -translate-x-1/2 z-50",children:l.jsxs("div",{className:"xp-pop flex items-center gap-2 bg-[var(--duo-green)] text-white px-4 py-2 rounded-full font-bold",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"}),"+10 XP"]})}),k&&l.jsx("div",{className:"fixed top-1/3 left-1/2 -translate-x-1/2 z-50",children:l.jsxs("div",{className:"xp-pop flex items-center gap-2 bg-[var(--duo-red)] text-white px-4 py-2 rounded-full font-bold",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-5 h-5"}),"-1"]})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"inline-block px-3 py-1 rounded-full bg-[var(--secondary)] text-xs text-[var(--muted-foreground)] mb-3",children:E.chapterName}),l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:E.question}),l.jsx("div",{className:"space-y-2.5",children:E.options.map(U=>{const Q=N===U.id,F=i===U.id,q=U.id===E.correctAnswer,$=r&&q,H=r&&F&&!q;return l.jsxs("button",{onClick:()=>L(U.id),disabled:r,className:qt("option-btn w-full p-3 text-left flex items-center gap-3",Q&&!r&&"selected",$&&"correct",H&&"wrong"),children:[l.jsx("div",{className:qt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",$&&"bg-[var(--duo-green)] text-white",H&&"bg-[var(--duo-red)] text-white",!r&&!Q&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",Q&&!r&&"bg-[var(--duo-blue)] text-white"),children:$?l.jsx(Cr,{className:"w-4 h-4"}):H?l.jsx($r,{className:"w-4 h-4"}):U.id}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:U.text})]},U.id)})})]}),l.jsx("div",{className:qt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",r?D?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:r?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[D?l.jsx(Cr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:qt("font-bold text-xl",D?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:D?"Chnh xc!":"Sai mt ri!"}),!D&&l.jsxs("p",{className:"text-[var(--duo-red)]/80 text-sm",children:["p n:"," ",(W=E.options.find(U=>U.id===E.correctAnswer))==null?void 0:W.text]})]})]}),l.jsx("button",{onClick:o,className:qt("btn-3d w-full py-3.5 text-base",D?"btn-3d-green":"btn-3d-orange"),children:j?"XEM KT QU":"TIP TC"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:lt,disabled:!N,className:qt("btn-3d w-full py-3.5 text-base",N?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})}),l.jsx("div",{className:"h-24"}),l.jsx(oq,{isOpen:A,onClose:()=>M(!1),onBuyHearts:dt,onGoToShop:Y,userGems:(h==null?void 0:h.gems)??0,heartCost:500})]}):null}const cr=[{id:"first_quiz",name:"Khi u",description:"Tr li ng cu u tin",icon:"Target",requirement:1,type:"correct"},{id:"streak_3",name:"Kin tr",description:"t streak 3 ngy",icon:"Flame",requirement:3,type:"streak"},{id:"streak_7",name:"Tun l hon ho",description:"t streak 7 ngy",icon:"Zap",requirement:7,type:"streak"},{id:"streak_30",name:"Thng vng",description:"t streak 30 ngy",icon:"Crown",requirement:30,type:"streak"},{id:"correct_50",name:"Hc sinh gii",description:"Tr li ng 50 cu",icon:"BookOpen",requirement:50,type:"correct"},{id:"correct_100",name:"Xut sc",description:"Tr li ng 100 cu",icon:"Trophy",requirement:100,type:"correct"},{id:"correct_500",name:"Bc thy",description:"Tr li ng 500 cu",icon:"GraduationCap",requirement:500,type:"correct"},{id:"correct_1000",name:"Huyn thoi",description:"Tr li ng 1000 cu",icon:"Crown",requirement:1e3,type:"correct"},{id:"perfect_5",name:"Hon ho",description:"5 bi quiz 100%",icon:"Gem",requirement:5,type:"perfect"},{id:"perfect_20",name:"Siu sao",description:"20 bi quiz 100%",icon:"Star",requirement:20,type:"perfect"},{id:"perfect_50",name:"Thin ti",description:"50 bi quiz 100%",icon:"Sparkles",requirement:50,type:"perfect"},{id:"level_5",name:"Cp 5",description:"t level 5",icon:"Sparkles",requirement:5,type:"level"},{id:"level_10",name:"Cp 10",description:"t level 10",icon:"Medal",requirement:10,type:"level"},{id:"level_20",name:"Cp 20",description:"t level 20",icon:"Trophy",requirement:20,type:"level"},{id:"gems_100",name:"Nh giu",description:"S hu 100 gems",icon:"Coins",requirement:100,type:"gems"},{id:"gems_500",name:"Triu ph",description:"S hu 500 gems",icon:"Gem",requirement:500,type:"gems"},{id:"gems_1000",name:"T ph",description:"S hu 1000 gems",icon:"Crown",requirement:1e3,type:"gems"},{id:"conquest_first",name:"Chin binh",description:"Hon thnh trn Chinh Chin u tin",icon:"Swords",requirement:1,type:"conquest"},{id:"conquest_10",name:"Dng s",description:"Hon thnh 10 trn Chinh Chin",icon:"Shield",requirement:10,type:"conquest"},{id:"conquest_50",name:"Chin tng",description:"Hon thnh 50 trn Chinh Chin",icon:"Award",requirement:50,type:"conquest"},{id:"conquest_wins_5",name:"Chui thng",description:"t chui thng 5 trn",icon:"Zap",requirement:5,type:"conquest_wins"},{id:"conquest_wins_10",name:"Bt bi",description:"t chui thng 10 trn",icon:"Crown",requirement:10,type:"conquest_wins"},{id:"rank_100",name:"Tn binh",description:"t 100 Rank Points",icon:"Target",requirement:100,type:"rank_points"},{id:"rank_500",name:"Tinh anh",description:"t 500 Rank Points",icon:"Star",requirement:500,type:"rank_points"},{id:"rank_1000",name:"Cao th",description:"t 1000 Rank Points",icon:"Medal",requirement:1e3,type:"rank_points"},{id:"rank_2000",name:"i cao th",description:"t 2000 Rank Points",icon:"Trophy",requirement:2e3,type:"rank_points"},{id:"gacha_first",name:"Ln u quay",description:"Quay gacha ln u tin",icon:"Sparkles",requirement:1,type:"gacha_pulls"},{id:"gacha_pulls_50",name:"Ngi chi h",description:"Quay gacha 50 ln",icon:"Package",requirement:50,type:"gacha_pulls"},{id:"gacha_pulls_100",name:"am m su tp",description:"Quay gacha 100 ln",icon:"Sparkles",requirement:100,type:"gacha_pulls"},{id:"gacha_pulls_500",name:"Gacha Master",description:"Quay gacha 500 ln",icon:"Crown",requirement:500,type:"gacha_pulls"},{id:"gacha_ur_1",name:"Th vng u tin",description:"S hu 1 th UR",icon:"Star",requirement:1,type:"gacha_ur"},{id:"gacha_ur_5",name:"B su tp vng",description:"S hu 5 th UR",icon:"Star",requirement:5,type:"gacha_ur"},{id:"gacha_ur_10",name:"Kho bu UR",description:"S hu 10 th UR",icon:"Crown",requirement:10,type:"gacha_ur"},{id:"gacha_ur_25",name:"Vua th UR",description:"S hu 25 th UR",icon:"Crown",requirement:25,type:"gacha_ur"},{id:"gacha_sr_10",name:"B su tp tm",description:"S hu 10 th SR",icon:"Gem",requirement:10,type:"gacha_sr"},{id:"gacha_sr_50",name:"Kho bu SR",description:"S hu 50 th SR",icon:"Gem",requirement:50,type:"gacha_sr"},{id:"gacha_cards_25",name:"Nh su tp nh",description:"S hu 25 th unique",icon:"Image",requirement:25,type:"gacha_total_cards"},{id:"gacha_cards_100",name:"Nh su tp",description:"S hu 100 th unique",icon:"Image",requirement:100,type:"gacha_total_cards"},{id:"gacha_cards_250",name:"i su tp gia",description:"S hu 250 th unique",icon:"Crown",requirement:250,type:"gacha_total_cards"},{id:"gacha_collection_1",name:"Hon thnh b u",description:"Hon thnh 1 b su tp",icon:"Package",requirement:1,type:"gacha_collections"},{id:"gacha_collection_3",name:"Ngi su tp",description:"Hon thnh 3 b su tp",icon:"Package",requirement:3,type:"gacha_collections"},{id:"gacha_collection_5",name:"Bc thy su tp",description:"Hon thnh 5 b su tp",icon:"Trophy",requirement:5,type:"gacha_collections"},{id:"tower_floor_10",name:"Ngi leo thp",description:"t tng 10 trong Thp Luyn Ngc",icon:"Building",requirement:10,type:"tower_floor"},{id:"tower_floor_50",name:"Chinh phc thp",description:"t tng 50 trong Thp Luyn Ngc",icon:"Building",requirement:50,type:"tower_floor"},{id:"tower_floor_100",name:"B ch thp",description:"t tng 100 trong Thp Luyn Ngc",icon:"Building",requirement:100,type:"tower_floor"},{id:"tower_floor_200",name:"Huyn thoi thp",description:"t tng 200 trong Thp Luyn Ngc",icon:"Crown",requirement:200,type:"tower_floor"},{id:"tower_complete",name:"nh cao thp ngc",description:"Hon thnh ton b Thp Luyn Ngc",icon:"Trophy",requirement:1,type:"tower_complete"},{id:"quizzes_10",name:"Chm ch",description:"Hon thnh 10 bi luyn tp",icon:"Brain",requirement:10,type:"quizzes"},{id:"quizzes_50",name:"Sing nng",description:"Hon thnh 50 bi luyn tp",icon:"Brain",requirement:50,type:"quizzes"},{id:"quizzes_100",name:"Cn c",description:"Hon thnh 100 bi luyn tp",icon:"Brain",requirement:100,type:"quizzes"},{id:"quizzes_500",name:"Hc gi",description:"Hon thnh 500 bi luyn tp",icon:"GraduationCap",requirement:500,type:"quizzes"},{id:"correct_2000",name:"Siu nhn",description:"Tr li ng 2000 cu",icon:"Crown",requirement:2e3,type:"correct"},{id:"correct_5000",name:"Thn ng",description:"Tr li ng 5000 cu",icon:"Crown",requirement:5e3,type:"correct"},{id:"correct_10000",name:"Bt t",description:"Tr li ng 10000 cu",icon:"Crown",requirement:1e4,type:"correct"},{id:"streak_60",name:"2 thng lin tc",description:"t streak 60 ngy",icon:"Flame",requirement:60,type:"streak"},{id:"streak_100",name:"100 ngy huyn thoi",description:"t streak 100 ngy",icon:"Crown",requirement:100,type:"streak"},{id:"streak_365",name:"C nm khng ngh",description:"t streak 365 ngy",icon:"Crown",requirement:365,type:"streak"},{id:"level_30",name:"Cp 30",description:"t level 30",icon:"Star",requirement:30,type:"level"},{id:"level_50",name:"Cp 50",description:"t level 50",icon:"Crown",requirement:50,type:"level"},{id:"level_100",name:"Cp 100",description:"t level 100",icon:"Crown",requirement:100,type:"level"},{id:"conquest_100",name:"i tng",description:"Hon thnh 100 trn Chinh Chin",icon:"Swords",requirement:100,type:"conquest"},{id:"conquest_500",name:"Chin thn",description:"Hon thnh 500 trn Chinh Chin",icon:"Crown",requirement:500,type:"conquest"},{id:"rank_3000",name:"Hc Ngc",description:"t 3000 Rank Points",icon:"Trophy",requirement:3e3,type:"rank_points"},{id:"rank_4000",name:"Huyn Thoi",description:"t 4000 Rank Points",icon:"Crown",requirement:4e3,type:"rank_points"},{id:"rank_5000",name:"Thn thoi",description:"t 5000 Rank Points",icon:"Crown",requirement:5e3,type:"rank_points"},{id:"gacha_pulls_1000",name:"Gacha Legend",description:"Quay gacha 1000 ln",icon:"Crown",requirement:1e3,type:"gacha_pulls"},{id:"gacha_ur_50",name:"Vua UR",description:"S hu 50 th UR",icon:"Crown",requirement:50,type:"gacha_ur"},{id:"gacha_ur_100",name:"Hong  UR",description:"S hu 100 th UR",icon:"Crown",requirement:100,type:"gacha_ur"},{id:"gacha_cards_500",name:"Bo tng th",description:"S hu 500 th unique",icon:"Crown",requirement:500,type:"gacha_total_cards"},{id:"quizzes_1000",name:"Gio s",description:"Hon thnh 1000 bi luyn tp",icon:"GraduationCap",requirement:1e3,type:"quizzes"},{id:"quizzes_5000",name:"Vin s",description:"Hon thnh 5000 bi luyn tp",icon:"Crown",requirement:5e3,type:"quizzes"},{id:"perfect_100",name:"Hon ho tuyt i",description:"100 bi quiz 100%",icon:"Crown",requirement:100,type:"perfect"},{id:"perfect_500",name:"Khng sai mt cu",description:"500 bi quiz 100%",icon:"Crown",requirement:500,type:"perfect"},{id:"gems_5000",name:"i gia",description:"S hu 5000 gems",icon:"Gem",requirement:5e3,type:"gems"},{id:"gems_10000",name:"Ti phit",description:"S hu 10000 gems",icon:"Crown",requirement:1e4,type:"gems"}],TX=Object.freeze(Object.defineProperty({__proto__:null,ACHIEVEMENTS:cr},Symbol.toStringTag,{value:"Module"})),CX={Target:ji,Flame:zr,Zap:Vr,Crown:wf,BookOpen:tl,Trophy:Ve,GraduationCap:gM,Gem:dM,Star:me,Sparkles:Xt,Medal:Dc,Coins:uM,Swords:Ci,Shield:mM,Award:vr,Package:Ts,Image:Bm,Building:Yu,Brain:cM};function kX(){const e=we(),{score:t,correctCount:n,wrongCount:i,currentQuestions:r,currentChapter:s,resetQuiz:o,selectChapter:a,chapters:c,quizMode:h}=ds(),{user:u,updateChapterProgress:d,addBadge:f,addPerfectLesson:v,addGems:y,checkAchievements:_,incrementDailyQuizzes:w,incrementDailyCorrect:x,incrementWeeklyXP:C,incrementWeeklyPerfect:k}=te(),[P,A]=I.useState(0),[M,N]=I.useState([]),[T,E]=I.useState(!1),[R,D]=I.useState(!1),[j,L]=I.useState([]),lt=r.length,dt=lt>0?Math.round(n/lt*100):0,Y=dt===100,U=dt>=90?3:dt>=70?2:dt>=50?1:0,Q=s?c.find(tt=>tt.id===s):null,F=Q&&n>=Q.totalQuestions*.7;I.useEffect(()=>{(async()=>{var Rt;await w();for(let ht=0;ht<n;ht++)await x();if(await C(t),Y&&await k(),s&&u){const ht=(Rt=u.chapterProgress)==null?void 0:Rt[s];await d(s,{completed:n,correct:((ht==null?void 0:ht.correct)??0)+n,bestScore:Math.max((ht==null?void 0:ht.bestScore)??0,t),lastAttempt:new Date().toISOString(),stars:Math.max((ht==null?void 0:ht.stars)??0,U),isCompleted:F||((ht==null?void 0:ht.isCompleted)??!1)})}const O=[],B=h==="survival"?3:h==="timeattack"?2:1,nt=n*20*B;let K=0,at="";Y?(await v(),K=100*B,at=h==="survival"?"Hardcore Perfect!":h==="timeattack"?"Speed Perfect!":"Hon ho!"):dt>=80?(K=60*B,at="Xut sc!"):dt>=50&&(K=30*B,at="Tt lm!");const ct=nt+K;ct>0&&(await y(ct),A(ct),O.push({type:"gems",amount:ct,label:at||`${n} cu ng`})),t>0&&O.push({type:"xp",amount:t}),O.length>0&&(L(O),D(!0));const vt=await _();if(vt.length>0){const ht=cr.filter(st=>vt.includes(st.id));N(ht),E(!0)}if(dt>=80){const ht=Y?3e3:1500,st=Date.now()+ht,Tt=()=>{Se({particleCount:Y?7:3,angle:60,spread:55,origin:{x:0},colors:["#58cc02","#ffc800","#1cb0f6"]}),Se({particleCount:Y?7:3,angle:120,spread:55,origin:{x:1},colors:["#58cc02","#ffc800","#1cb0f6"]}),Date.now()<st&&requestAnimationFrame(Tt)};Tt()}Y&&await f("perfect_score")})()},[]);const $=dt>=90?{label:"Xut sc!",icon:Ve,color:"var(--duo-yellow)"}:dt>=70?{label:"Tt lm!",icon:me,color:"var(--duo-green)"}:dt>=50?{label:"Kh n!",icon:ji,color:"var(--duo-blue)"}:{label:"C gng hn!",icon:zr,color:"var(--duo-orange)"},H=$.icon,X=()=>{s?a(s):(o(),e("/battle"))};return l.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[65vh] px-4",children:[l.jsx(Gn,{isOpen:R,onClose:()=>D(!1),title:Y?"Hon ho!":dt>=80?"Xut sc!":"Hon thnh!",subtitle:s?`Chng ${s}`:"Luyn tp",rewards:j,gradientFrom:Y?"var(--duo-yellow)":"var(--duo-green)",gradientTo:Y?"var(--duo-orange)":"var(--duo-blue)"}),T&&M.length>0&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full text-center",children:[l.jsx(vr,{className:"w-16 h-16 text-[var(--duo-yellow)] mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-bold text-[var(--duo-yellow)] mb-2",children:"Thnh tu mi!"}),l.jsx("div",{className:"space-y-3 mb-4",children:M.map(tt=>{const O=CX[tt.icon];return l.jsxs("div",{className:"flex items-center gap-3 bg-[var(--secondary)] p-3 rounded-xl",children:[l.jsx(O,{className:"w-8 h-8 text-[var(--duo-yellow)]"}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-bold text-foreground",children:tt.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:tt.description})]})]},tt.id)})}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)] mb-4",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"}),l.jsxs("span",{className:"font-bold",children:["+",M.length*50," Gems"]})]}),l.jsx("button",{onClick:()=>E(!1),className:"btn-3d btn-3d-green w-full py-3",children:"Tuyt vi!"})]})}),l.jsx("div",{className:"w-20 h-20 rounded-full bg-[var(--secondary)] flex items-center justify-center mb-3",children:l.jsx(H,{className:"w-10 h-10",style:{color:$.color}})}),l.jsx("h1",{className:"text-2xl font-bold mb-1",style:{color:$.color},children:$.label}),F&&l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-green)] mb-2",children:[l.jsx(ai,{className:"w-5 h-5"}),l.jsx("span",{className:"font-semibold text-sm",children:"Chng hon thnh!"})]}),l.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(3)].map((tt,O)=>l.jsx(me,{className:`w-8 h-8 ${O<U?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},O))}),l.jsxs("div",{className:"relative w-32 h-32 mb-4",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",children:[l.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:"var(--secondary)",strokeWidth:"10"}),l.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:$.color,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:`${dt/100*352} 352`})]}),l.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:l.jsxs("span",{className:"text-3xl font-bold text-foreground",children:[dt,"%"]})})]}),l.jsxs("div",{className:"w-full max-w-xs card-3d p-3 mb-4",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-green)]/20 flex items-center justify-center mb-1",children:l.jsx(ai,{className:"w-4 h-4 text-[var(--duo-green)]"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-green)]",children:n}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"ng"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-red)]/20 flex items-center justify-center mb-1",children:l.jsx(ji,{className:"w-4 h-4 text-[var(--duo-red)]"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-red)]",children:i}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Sai"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"w-8 h-8 mx-auto rounded-lg bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-1",children:l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"})}),l.jsx("div",{className:"text-xl font-bold text-[var(--duo-yellow)]",children:t}),l.jsx("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:"XP"})]})]}),P>0&&l.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--border)] text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold",children:["+",P," Gems bonus!"]})]})}),u&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--border)] flex items-center justify-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-sm text-[var(--duo-orange)]",children:u.streak})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Ve,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsxs("span",{className:"font-bold text-sm",children:["Lv.",u.level]})]})]})]}),l.jsxs("div",{className:"w-full max-w-xs space-y-2.5",children:[l.jsxs("button",{onClick:X,className:"btn-3d btn-3d-green w-full py-3 flex items-center justify-center gap-2",children:[l.jsx(yu,{className:"w-4 h-4"})," Lm li"]}),l.jsxs("button",{onClick:()=>{const tt=!s;o(),e(tt?"/battle":"/")},className:"btn-3d btn-3d-blue w-full py-3 flex items-center justify-center gap-2",children:[l.jsx(sw,{className:"w-4 h-4"})," ",s?"Trang ch":"Luyn tp"]})]})]})}function NX(){var N;const e=we(),{currentQuestions:t,currentIndex:n,resetQuiz:i,chapters:r,currentChapter:s,correctCount:o,wrongCount:a,score:c,quizMode:h,timeLimit:u,maxWrong:d}=ds(),{user:f,updateChapterProgress:v}=te(),[y,_]=I.useState(u??0),[w,x]=I.useState(!1),C=I.useRef(null);I.useEffect(()=>{if(h==="timeattack"&&u&&!w)return _(u),C.current=setInterval(()=>{_(T=>T<=1?(clearInterval(C.current),x(!0),0):T-1)},1e3),()=>{C.current&&clearInterval(C.current)}},[h,u]);const k=h==="survival"&&d&&a>=d,P=n>=t.length||w||k,A=s?(N=r.find(T=>T.id===s))==null?void 0:N.name:h==="timeattack"?"Time Attack":h==="survival"?"Sinh Tn":"Trc nghim";I.useEffect(()=>{t.length===0&&(window.location.pathname!=="/quiz"||e("/"))},[]);const M=async()=>{var E;if(C.current&&clearInterval(C.current),s&&n>0&&f){const R=(E=f.chapterProgress)==null?void 0:E[s],D=o+a;await v(s,{completed:Math.max((R==null?void 0:R.completed)??0,D),correct:((R==null?void 0:R.correct)??0)+o,bestScore:Math.max((R==null?void 0:R.bestScore)??0,c),lastAttempt:new Date().toISOString()})}const T=!s;i(),e(T?"/battle":"/")};return t.length===0?null:l.jsxs(se,{className:"bg-background min-h-screen",children:[!P&&l.jsx("div",{className:"pt-16 pb-2 px-4 bg-background sticky top-0 z-10",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:M,className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h1",{className:"font-bold text-sm text-[var(--muted-foreground)] truncate max-w-[200px]",children:s?`Chng ${s}: ${A}`:A}),h==="timeattack"&&l.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-lg ${y<=10?"bg-[var(--duo-red)]":"bg-[var(--duo-blue)]"}`,children:[l.jsx(Ju,{className:"w-4 h-4 text-white"}),l.jsxs("span",{className:"font-bold text-sm text-white",children:[y,"s"]})]}),h==="survival"&&d&&l.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-lg bg-[var(--duo-red)]",children:[l.jsx(ow,{className:"w-4 h-4 text-white"}),l.jsx("span",{className:"font-bold text-sm text-white",children:d-a})]})]}),l.jsx("div",{className:"w-10"})," "]})}),l.jsx("div",{className:`px-4 pb-8 ${P?"pt-16":""}`,style:{minHeight:"calc(100vh - 100px)"},children:P?l.jsx(kX,{}):l.jsx(bX,{})})]})}var EX={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let SX,IX;function AX(){return{geminiUrl:SX,vertexUrl:IX}}function RX(e,t,n,i){var r,s;if(!(e!=null&&e.baseUrl)){const o=AX();return t?(r=o.vertexUrl)!==null&&r!==void 0?r:n:(s=o.geminiUrl)!==null&&s!==void 0?s:i}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class js{}function gt(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(i,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){const s=t[r];return s!=null?String(s):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function m(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in e))if(Array.isArray(n))e[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[a])){const c=e[a];if(Array.isArray(n))for(let h=0;h<c.length;h++){const u=c[h];m(u,t.slice(s+1),n[h])}else for(const h of c)m(h,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in e||(e[a]=[{}]);const c=e[a];m(c[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const i=t[t.length-1],r=e[i];if(r!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===r)return;if(typeof r=="object"&&typeof n=="object"&&r!==null&&n!==null)Object.assign(r,n);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[i]=n}function g(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let i=0;i<t.length;i++){if(typeof e!="object"||e===null)return n;const r=t[i];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in e){const o=e[s];return Array.isArray(o)?o.map(a=>g(a,t.slice(i+1),n)):n}else return n}else e=e[r]}return e}catch(i){if(i instanceof TypeError)return n;throw i}}function PX(e,t){for(const[n,i]of Object.entries(t)){const r=n.split("."),s=i.split("."),o=new Set;let a=-1;for(let c=0;c<r.length;c++)if(r[c]==="*"){a=c;break}if(a!==-1&&s.length>a)for(let c=a;c<s.length;c++){const h=s[c];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&o.add(h)}w0(e,r,s,0,o)}}function w0(e,t,n,i,r){if(i>=t.length||typeof e!="object"||e===null)return;const s=t[i];if(s.endsWith("[]")){const o=s.slice(0,-2),a=e;if(o in a&&Array.isArray(a[o]))for(const c of a[o])w0(c,t,n,i+1,r)}else if(s==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const o=e,a=Object.keys(o).filter(h=>!h.startsWith("_")&&!r.has(h)),c={};for(const h of a)c[h]=o[h];for(const[h,u]of Object.entries(c)){const d=[];for(const f of n.slice(i))f==="*"?d.push(h):d.push(f);m(o,d,u)}for(const h of a)delete o[h]}}else{const o=e;s in o&&w0(o[s],t,n,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ub(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MX(e){const t={},n=g(e,["operationName"]);n!=null&&m(t,["operationName"],n);const i=g(e,["resourceName"]);return i!=null&&m(t,["_url","resourceName"],i),t}function DX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response","generateVideoResponse"]);return o!=null&&m(t,["response"],VX(o)),t}function LX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],qX(o)),t}function VX(e){const t={},n=g(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>jX(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function qX(e){const t={},n=g(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>FX(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function jX(e){const t={},n=g(e,["video"]);return n!=null&&m(t,["video"],$X(n)),t}function FX(e){const t={},n=g(e,["_self"]);return n!=null&&m(t,["video"],zX(n)),t}function UX(e){const t={},n=g(e,["operationName"]);return n!=null&&m(t,["_url","operationName"],n),t}function OX(e){const t={},n=g(e,["operationName"]);return n!=null&&m(t,["_url","operationName"],n),t}function BX(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],GX(o)),t}function GX(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function aq(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],HX(o)),t}function HX(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function $X(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["encodedVideo"]);i!=null&&m(t,["videoBytes"],Ub(i));const r=g(e,["encoding"]);return r!=null&&m(t,["mimeType"],r),t}function zX(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["uri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["videoBytes"],Ub(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vS;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(vS||(vS={}));var yS;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(yS||(yS={}));var xS;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(xS||(xS={}));var le;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(le||(le={}));var _S;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(_S||(_S={}));var wS;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(wS||(wS={}));var bS;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(bS||(bS={}));var TS;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(TS||(TS={}));var CS;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(CS||(CS={}));var kS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(kS||(kS={}));var NS;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(NS||(NS={}));var ES;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(ES||(ES={}));var SS;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(SS||(SS={}));var IS;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(IS||(IS={}));var AS;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(AS||(AS={}));var RS;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(RS||(RS={}));var PS;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(PS||(PS={}));var MS;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(MS||(MS={}));var DS;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(DS||(DS={}));var LS;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(LS||(LS={}));var VS;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(VS||(VS={}));var hm;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(hm||(hm={}));var qS;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(qS||(qS={}));var jS;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(jS||(jS={}));var FS;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(FS||(FS={}));var b0;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(b0||(b0={}));var US;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(US||(US={}));var OS;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(OS||(OS={}));var BS;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(BS||(BS={}));var GS;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(GS||(GS={}));var HS;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(HS||(HS={}));var $S;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})($S||($S={}));var zS;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(zS||(zS={}));var KS;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(KS||(KS={}));var WS;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(WS||(WS={}));var QS;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(QS||(QS={}));var YS;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(YS||(YS={}));var JS;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(JS||(JS={}));var XS;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(XS||(XS={}));var ZS;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(ZS||(ZS={}));var t1;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(t1||(t1={}));var e1;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(e1||(e1={}));var n1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(n1||(n1={}));var i1;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(i1||(i1={}));var r1;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(r1||(r1={}));var s1;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(s1||(s1={}));var o1;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(o1||(o1={}));var a1;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(a1||(a1={}));var c1;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(c1||(c1={}));var l1;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(l1||(l1={}));var h1;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(h1||(h1={}));var u1;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(u1||(u1={}));var d1;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(d1||(d1={}));var g1;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(g1||(g1={}));var f1;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(f1||(f1={}));var bc;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(bc||(bc={}));class T0{constructor(t){const n={};for(const i of t.headers.entries())n[i[0]]=i[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class gh{get text(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",u=!1;const d=[];for(const f of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[v,y]of Object.entries(f))v!=="text"&&v!=="thought"&&v!=="thoughtSignature"&&(y!==null||y!==void 0)&&d.push(v);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;u=!0,h+=f.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?h:void 0}get data(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const u=[];for(const d of(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[f,v]of Object.entries(d))f!=="inlineData"&&(v!==null||v!==void 0)&&u.push(f);d.inlineData&&typeof d.inlineData.data=="string"&&(h+=atob(d.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,n,i,r,s,o,a,c;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>u!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,n,i,r,s,o,a,c,h;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(d=>d.executableCode).map(d=>d.executableCode).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return(h=u==null?void 0:u[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,n,i,r,s,o,a,c,h;if(((r=(i=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=(c=(a=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(d=>d.codeExecutionResult).map(d=>d.codeExecutionResult).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return(h=u==null?void 0:u[0])===null||h===void 0?void 0:h.output}}class m1{}class p1{}class KX{}class WX{}class QX{}class YX{}class v1{}class y1{}class x1{}class JX{}class um{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new um;let r;const s=t;return n?r=LX(s):r=DX(s),Object.assign(i,r),i}}class _1{}class w1{}class b1{}class T1{}class XX{}class ZX{}class tZ{}class Ob{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new Ob,s=BX(t);return Object.assign(i,s),i}}class eZ{}class nZ{}class iZ{}class C1{}class rZ{get text(){var t,n,i;let r="",s=!1;const o=[];for(const a of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[c,h]of Object.entries(a))c!=="text"&&c!=="thought"&&h!==null&&o.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;s=!0,r+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?r:void 0}get data(){var t,n,i;let r="";const s=[];for(const o of(i=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&i!==void 0?i:[]){for(const[a,c]of Object.entries(o))a!=="inlineData"&&c!==null&&s.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(r+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class sZ{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Bb{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const i=new Bb,s=aq(t);return Object.assign(i,s),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ee(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function cq(e,t){const n=ee(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function lq(e){return Array.isArray(e)?e.map(t=>dm(t)):[dm(e)]}function dm(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function hq(e){const t=dm(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function uq(e){const t=dm(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function k1(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function dq(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>k1(t)):[k1(e)]}function C0(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function N1(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function E1(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ln(e){if(e==null)throw new Error("ContentUnion is required");return C0(e)?e:{role:"user",parts:dq(e)}}function Gb(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const i=Ln(n);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(e.isVertexAI()){const n=Ln(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Ln(n)):[Ln(t)]}function Gi(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(N1(e)||E1(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ln(e)]}const t=[],n=[],i=C0(e[0]);for(const r of e){const s=C0(r);if(s!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(r);else{if(N1(r)||E1(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return i||t.push({role:"user",parts:dq(n)}),t}function oZ(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(i=>i!=="null");if(n.length===1)t.type=Object.values(le).includes(n[0].toUpperCase())?n[0].toUpperCase():le.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const i of n)t.anyOf.push({type:Object.values(le).includes(i.toUpperCase())?i.toUpperCase():le.TYPE_UNSPECIFIED})}}function Hc(e){const t={},n=["items"],i=["anyOf"],r=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&oZ(e.type,t);for(const[o,a]of Object.entries(e))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(le).includes(a.toUpperCase())?a.toUpperCase():le.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Hc(a);else if(i.includes(o)){const c=[];for(const h of a){if(h.type=="null"){t.nullable=!0;continue}c.push(Hc(h))}t[o]=c}else if(r.includes(o)){const c={};for(const[h,u]of Object.entries(a))c[h]=Hc(u);t[o]=c}else{if(o==="additionalProperties")continue;t[o]=a}return t}function Hb(e){return Hc(e)}function $b(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function zb(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Ml(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Hc(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Hc(t.response));return e}function Dl(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function aZ(e,t,n,i=1){const r=!t.startsWith(`${n}/`)&&t.split("/").length===i;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:r?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:r?`${n}/${t}`:t}function Fs(e,t){if(typeof t!="string")throw new Error("name must be a string");return aZ(e,t,"cachedContents")}function gq(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function $o(e){return Ub(e)}function cZ(e){return e!=null&&typeof e=="object"&&"name"in e}function lZ(e){return e!=null&&typeof e=="object"&&"video"in e}function hZ(e){return e!=null&&typeof e=="object"&&"uri"in e}function fq(e){var t;let n;if(cZ(e)&&(n=e.name),!(hZ(e)&&(n=e.uri,n===void 0))&&!(lZ(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function mq(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function pq(e){for(const t of["models","tunedModels","publisherModels"])if(uZ(e,t))return e[t];return[]}function uZ(e,t){return e!==null&&typeof e=="object"&&t in e}function dZ(e,t={}){const n=e,i={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(i.responseJsonSchema=n.outputSchema),t.behavior&&(i.behavior=t.behavior),{functionDeclarations:[i]}}function gZ(e,t={}){const n=[],i=new Set;for(const r of e){const s=r.name;if(i.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);i.add(s);const o=dZ(r,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function vq(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function fZ(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function yq(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const r=n.inlinedResponses;if(!Array.isArray(r)||r.length===0)return e;let s=!1;for(const o of r){if(typeof o!="object"||o===null)continue;const c=o.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){s=!0;break}}return s&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Ll(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function xq(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mZ(e){const t={},n=g(e,["responsesFile"]);n!=null&&m(t,["fileName"],n);const i=g(e,["inlinedResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>QZ(o))),m(t,["inlinedResponses"],s)}const r=g(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["inlinedEmbedContentResponses"],s)}return t}function pZ(e){const t={},n=g(e,["predictionsFormat"]);n!=null&&m(t,["format"],n);const i=g(e,["gcsDestination","outputUriPrefix"]);i!=null&&m(t,["gcsUri"],i);const r=g(e,["bigqueryDestination","outputUri"]);return r!=null&&m(t,["bigqueryUri"],r),t}function vZ(e){const t={},n=g(e,["format"]);n!=null&&m(t,["predictionsFormat"],n);const i=g(e,["gcsUri"]);i!=null&&m(t,["gcsDestination","outputUriPrefix"],i);const r=g(e,["bigqueryUri"]);if(r!=null&&m(t,["bigqueryDestination","outputUri"],r),g(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function Gg(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata","displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["metadata","state"]);r!=null&&m(t,["state"],xq(r));const s=g(e,["metadata","createTime"]);s!=null&&m(t,["createTime"],s);const o=g(e,["metadata","endTime"]);o!=null&&m(t,["endTime"],o);const a=g(e,["metadata","updateTime"]);a!=null&&m(t,["updateTime"],a);const c=g(e,["metadata","model"]);c!=null&&m(t,["model"],c);const h=g(e,["metadata","output"]);return h!=null&&m(t,["dest"],mZ(yq(h))),t}function k0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["state"]);r!=null&&m(t,["state"],xq(r));const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["createTime"]);o!=null&&m(t,["createTime"],o);const a=g(e,["startTime"]);a!=null&&m(t,["startTime"],a);const c=g(e,["endTime"]);c!=null&&m(t,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(t,["updateTime"],h);const u=g(e,["model"]);u!=null&&m(t,["model"],u);const d=g(e,["inputConfig"]);d!=null&&m(t,["src"],yZ(d));const f=g(e,["outputConfig"]);f!=null&&m(t,["dest"],pZ(yq(f)));const v=g(e,["completionStats"]);return v!=null&&m(t,["completionStats"],v),t}function yZ(e){const t={},n=g(e,["instancesFormat"]);n!=null&&m(t,["format"],n);const i=g(e,["gcsSource","uris"]);i!=null&&m(t,["gcsUri"],i);const r=g(e,["bigquerySource","inputUri"]);return r!=null&&m(t,["bigqueryUri"],r),t}function xZ(e,t){const n={};if(g(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=g(t,["fileName"]);i!=null&&m(n,["fileName"],i);const r=g(t,["inlinedRequests"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>WZ(e,o))),m(n,["requests","requests"],s)}return n}function _Z(e){const t={},n=g(e,["format"]);n!=null&&m(t,["instancesFormat"],n);const i=g(e,["gcsUri"]);i!=null&&m(t,["gcsSource","uris"],i);const r=g(e,["bigqueryUri"]);if(r!=null&&m(t,["bigquerySource","inputUri"],r),g(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function wZ(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function bZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function TZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function CZ(e){const t={},n=g(e,["content"]);n!=null&&m(t,["content"],n);const i=g(e,["citationMetadata"]);i!=null&&m(t,["citationMetadata"],kZ(i));const r=g(e,["tokenCount"]);r!=null&&m(t,["tokenCount"],r);const s=g(e,["finishReason"]);s!=null&&m(t,["finishReason"],s);const o=g(e,["avgLogprobs"]);o!=null&&m(t,["avgLogprobs"],o);const a=g(e,["groundingMetadata"]);a!=null&&m(t,["groundingMetadata"],a);const c=g(e,["index"]);c!=null&&m(t,["index"],c);const h=g(e,["logprobsResult"]);h!=null&&m(t,["logprobsResult"],h);const u=g(e,["safetyRatings"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(v=>v)),m(t,["safetyRatings"],f)}const d=g(e,["urlContextMetadata"]);return d!=null&&m(t,["urlContextMetadata"],d),t}function kZ(e){const t={},n=g(e,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["citations"],i)}return t}function _q(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>ntt(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function NZ(e,t){const n={},i=g(e,["displayName"]);if(t!==void 0&&i!=null&&m(t,["batch","displayName"],i),g(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function EZ(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["dest"]);return t!==void 0&&r!=null&&m(t,["outputConfig"],vZ(fZ(r))),n}function S1(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["src"]);r!=null&&m(n,["batch","inputConfig"],xZ(e,vq(e,r)));const s=g(t,["config"]);return s!=null&&NZ(s,n),n}function SZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],ee(e,i));const r=g(t,["src"]);r!=null&&m(n,["inputConfig"],_Z(vq(e,r)));const s=g(t,["config"]);return s!=null&&EZ(s,n),n}function IZ(e,t){const n={},i=g(e,["displayName"]);return t!==void 0&&i!=null&&m(t,["batch","displayName"],i),n}function AZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["src"]);r!=null&&m(n,["batch","inputConfig"],qZ(e,r));const s=g(t,["config"]);return s!=null&&IZ(s,n),n}function RZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function PZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function MZ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);return s!=null&&m(t,["error"],s),t}function DZ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);return s!=null&&m(t,["error"],s),t}function LZ(e,t){const n={},i=g(t,["contents"]);if(i!=null){let s=Gb(e,i);Array.isArray(s)&&(s=s.map(o=>o)),m(n,["requests[]","request","content"],s)}const r=g(t,["config"]);return r!=null&&(m(n,["_self"],VZ(r,n)),PX(n,{"requests[].*":"requests[].request.*"})),n}function VZ(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["requests[]","taskType"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["requests[]","title"],r);const s=g(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&m(t,["requests[]","outputDimensionality"],s),g(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function qZ(e,t){const n={},i=g(t,["fileName"]);i!=null&&m(n,["file_name"],i);const r=g(t,["inlinedRequests"]);return r!=null&&m(n,["requests"],LZ(e,r)),n}function jZ(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function FZ(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function UZ(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function OZ(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],_q(Ln(r)));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const _=g(t,["seed"]);_!=null&&m(i,["seed"],_);const w=g(t,["responseMimeType"]);w!=null&&m(i,["responseMimeType"],w);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],Hb(x));const C=g(t,["responseJsonSchema"]);if(C!=null&&m(i,["responseJsonSchema"],C),g(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=g(t,["safetySettings"]);if(n!==void 0&&k!=null){let L=k;Array.isArray(L)&&(L=L.map(lt=>itt(lt))),m(n,["safetySettings"],L)}const P=g(t,["tools"]);if(n!==void 0&&P!=null){let L=Dl(P);Array.isArray(L)&&(L=L.map(lt=>stt(Ml(lt)))),m(n,["tools"],L)}const A=g(t,["toolConfig"]);if(n!==void 0&&A!=null&&m(n,["toolConfig"],rtt(A)),g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=g(t,["cachedContent"]);n!==void 0&&M!=null&&m(n,["cachedContent"],Fs(e,M));const N=g(t,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const T=g(t,["mediaResolution"]);T!=null&&m(i,["mediaResolution"],T);const E=g(t,["speechConfig"]);if(E!=null&&m(i,["speechConfig"],$b(E)),g(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=g(t,["thinkingConfig"]);R!=null&&m(i,["thinkingConfig"],R);const D=g(t,["imageConfig"]);D!=null&&m(i,["imageConfig"],KZ(D));const j=g(t,["enableEnhancedCivicAnswers"]);return j!=null&&m(i,["enableEnhancedCivicAnswers"],j),i}function BZ(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(h=>CZ(h))),m(t,["candidates"],c)}const r=g(e,["modelVersion"]);r!=null&&m(t,["modelVersion"],r);const s=g(e,["promptFeedback"]);s!=null&&m(t,["promptFeedback"],s);const o=g(e,["responseId"]);o!=null&&m(t,["responseId"],o);const a=g(e,["usageMetadata"]);return a!=null&&m(t,["usageMetadata"],a),t}function GZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function HZ(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Ll(e,i)),n}function $Z(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function zZ(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function KZ(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);if(i!=null&&m(t,["imageSize"],i),g(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function WZ(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["request","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let a=Gi(r);Array.isArray(a)&&(a=a.map(c=>_q(c))),m(n,["request","contents"],a)}const s=g(t,["metadata"]);s!=null&&m(n,["metadata"],s);const o=g(t,["config"]);return o!=null&&m(n,["request","generationConfig"],OZ(e,o,g(n,["request"],{}))),n}function QZ(e){const t={},n=g(e,["response"]);n!=null&&m(t,["response"],BZ(n));const i=g(e,["error"]);return i!=null&&m(t,["error"],i),t}function YZ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);if(t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),g(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function JZ(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);t!==void 0&&r!=null&&m(t,["_query","pageToken"],r);const s=g(e,["filter"]);return t!==void 0&&s!=null&&m(t,["_query","filter"],s),n}function XZ(e){const t={},n=g(e,["config"]);return n!=null&&YZ(n,t),t}function ZZ(e){const t={},n=g(e,["config"]);return n!=null&&JZ(n,t),t}function ttt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["operations"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Gg(o))),m(t,["batchJobs"],s)}return t}function ett(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["batchPredictionJobs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>k0(o))),m(t,["batchJobs"],s)}return t}function ntt(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],jZ(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],FZ(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],wZ(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function itt(e){const t={},n=g(e,["category"]);if(n!=null&&m(t,["category"],n),g(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(e,["threshold"]);return i!=null&&m(t,["threshold"],i),t}function rtt(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],UZ(i)),t}function stt(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],$Z(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],zZ(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Rs;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(Rs||(Rs={}));class Ka{constructor(t,n,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,i,r)}init(t,n,i){var r,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(r=o.config)===null||r===void 0?void 0:r.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ott extends js{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ka(Rs.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(t){const n=S1(this.apiClient,t),i=n._url,r=gt("{model}:batchGenerateContent",i),a=n.batch.inputConfig.requests,c=a.requests,h=[];for(const u of c){const d=Object.assign({},u);if(d.systemInstruction){const f=d.systemInstruction;delete d.systemInstruction;const v=d.request;v.systemInstruction=f,d.request=v}h.push(d)}return a.requests=h,delete n.config,delete n._url,delete n._query,{path:r,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const i=n?Object.assign({},n):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const s=this.getGcsUri(t),o=this.getBigqueryUri(t);if(s)s.endsWith(".jsonl")?i.dest=`${s.slice(0,-6)}/dest`:i.dest=`${s}_dest_${r}`;else if(o)i.dest=`${o}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=SZ(this.apiClient,t);return a=gt("batchPredictionJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>k0(u))}else{const h=S1(this.apiClient,t);return a=gt("{model}:batchGenerateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>Gg(u))}}async createEmbeddingsInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=AZ(this.apiClient,t);return s=gt("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>Gg(c))}}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=HZ(this.apiClient,t);return a=gt("batchPredictionJobs/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>k0(u))}else{const h=GZ(this.apiClient,t);return a=gt("batches/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>Gg(u))}}async cancel(t){var n,i,r,s;let o="",a={};if(this.apiClient.isVertexAI()){const c=TZ(this.apiClient,t);o=gt("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}else{const c=bZ(this.apiClient,t);o=gt("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=ZZ(t);return a=gt("batchPredictionJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ett(u),f=new C1;return Object.assign(f,d),f})}else{const h=XZ(t);return a=gt("batches",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ttt(u),f=new C1;return Object.assign(f,d),f})}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=PZ(this.apiClient,t);return a=gt("batchPredictionJobs/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>DZ(u))}else{const h=RZ(this.apiClient,t);return a=gt("batches/{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>MZ(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function att(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function I1(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Att(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function ctt(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);t!==void 0&&r!=null&&m(t,["expireTime"],r);const s=g(e,["displayName"]);t!==void 0&&s!=null&&m(t,["displayName"],s);const o=g(e,["contents"]);if(t!==void 0&&o!=null){let u=Gi(o);Array.isArray(u)&&(u=u.map(d=>I1(d))),m(t,["contents"],u)}const a=g(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],I1(Ln(a)));const c=g(e,["tools"]);if(t!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(d=>Ptt(d))),m(t,["tools"],u)}const h=g(e,["toolConfig"]);if(t!==void 0&&h!=null&&m(t,["toolConfig"],Rtt(h)),g(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function ltt(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);t!==void 0&&r!=null&&m(t,["expireTime"],r);const s=g(e,["displayName"]);t!==void 0&&s!=null&&m(t,["displayName"],s);const o=g(e,["contents"]);if(t!==void 0&&o!=null){let d=Gi(o);Array.isArray(d)&&(d=d.map(f=>f)),m(t,["contents"],d)}const a=g(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],Ln(a));const c=g(e,["tools"]);if(t!==void 0&&c!=null){let d=c;Array.isArray(d)&&(d=d.map(f=>Mtt(f))),m(t,["tools"],d)}const h=g(e,["toolConfig"]);t!==void 0&&h!=null&&m(t,["toolConfig"],h);const u=g(e,["kmsKeyName"]);return t!==void 0&&u!=null&&m(t,["encryption_spec","kmsKeyName"],u),n}function htt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],cq(e,i));const r=g(t,["config"]);return r!=null&&ctt(r,n),n}function utt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["model"],cq(e,i));const r=g(t,["config"]);return r!=null&&ltt(r,n),n}function dtt(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Fs(e,i)),n}function gtt(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Fs(e,i)),n}function ftt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function mtt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function ptt(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function vtt(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function ytt(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function xtt(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function _tt(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Fs(e,i)),n}function wtt(e,t){const n={},i=g(t,["name"]);return i!=null&&m(n,["_url","name"],Fs(e,i)),n}function btt(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function Ttt(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function Ctt(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function ktt(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function Ntt(e){const t={},n=g(e,["config"]);return n!=null&&Ctt(n,t),t}function Ett(e){const t={},n=g(e,["config"]);return n!=null&&ktt(n,t),t}function Stt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["cachedContents"],s)}return t}function Itt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["cachedContents"],s)}return t}function Att(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],ptt(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],vtt(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],att(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function Rtt(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],ytt(i)),t}function Ptt(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],btt(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],Ttt(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function Mtt(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>xtt(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function Dtt(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);return t!==void 0&&r!=null&&m(t,["expireTime"],r),n}function Ltt(e,t){const n={},i=g(e,["ttl"]);t!==void 0&&i!=null&&m(t,["ttl"],i);const r=g(e,["expireTime"]);return t!==void 0&&r!=null&&m(t,["expireTime"],r),n}function Vtt(e,t){const n={},i=g(t,["name"]);i!=null&&m(n,["_url","name"],Fs(e,i));const r=g(t,["config"]);return r!=null&&Dtt(r,n),n}function qtt(e,t){const n={},i=g(t,["name"]);i!=null&&m(n,["_url","name"],Fs(e,i));const r=g(t,["config"]);return r!=null&&Ltt(r,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jtt extends js{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ka(Rs.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(n),n)}async create(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=utt(this.apiClient,t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=htt(this.apiClient,t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=wtt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=_tt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=gtt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=mtt(u),f=new b1;return Object.assign(f,d),f})}else{const h=dtt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ftt(u),f=new b1;return Object.assign(f,d),f})}}async update(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=qtt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>u)}else{const h=Vtt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Ett(t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Itt(u),f=new T1;return Object.assign(f,d),f})}else{const h=Ntt(t);return a=gt("cachedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Stt(u),f=new T1;return Object.assign(f,d),f})}}}function gm(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function A1(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lt(e){return this instanceof Lt?(this.v=e,this):new Lt(e)}function wr(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(e,t||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(v){return function(y){return Promise.resolve(y).then(v,d)}}function a(v,y){i[v]&&(r[v]=function(_){return new Promise(function(w,x){s.push([v,_,w,x])>1||c(v,_)})},y&&(r[v]=y(r[v])))}function c(v,y){try{h(i[v](y))}catch(_){f(s[0][3],_)}}function h(v){v.value instanceof Lt?Promise.resolve(v.value.v).then(u,d):f(s[0][2],v)}function u(v){c("next",v)}function d(v){c("throw",v)}function f(v,y){v(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function br(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof A1=="function"?A1(e):e[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(h){s({value:h,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ftt(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:wq(n)}function wq(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function Utt(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function R1(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let i=0;for(;i<n;)if(e[i].role==="user")t.push(e[i]),i++;else{const r=[];let s=!0;for(;i<n&&e[i].role==="model";)r.push(e[i]),s&&!wq(e[i])&&(s=!1),i++;s?t.push(...r):t.pop()}return t}class Ott{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new Btt(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class Btt{constructor(t,n,i,r={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=i,this.config=r,this.history=s,this.sendPromise=Promise.resolve(),Utt(s)}async sendMessage(t){var n;await this.sendPromise;const i=Ln(t.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,a;const c=await r,h=(o=(s=c.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,u=c.automaticFunctionCallingHistory,d=this.getHistory(!0).length;let f=[];u!=null&&(f=(a=u.slice(d))!==null&&a!==void 0?a:[]);const v=h?[h]:[];this.recordHistory(i,v,f)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(t){var n;await this.sendPromise;const i=Ln(t.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const s=await r;return this.processStreamResponse(s,i)}getHistory(t=!1){const n=t?R1(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){return wr(this,arguments,function*(){var r,s,o,a,c,h;const u=[];try{for(var d=!0,f=br(t),v;v=yield Lt(f.next()),r=v.done,!r;d=!0){a=v.value,d=!1;const y=a;if(Ftt(y)){const _=(h=(c=y.candidates)===null||c===void 0?void 0:c[0])===null||h===void 0?void 0:h.content;_!==void 0&&u.push(_)}yield yield Lt(y)}}catch(y){s={error:y}}finally{try{!d&&!r&&(o=f.return)&&(yield Lt(o.call(f)))}finally{if(s)throw s.error}}this.recordHistory(n,u)})}recordHistory(t,n,i){let r=[];n.length>0&&n.every(s=>s.role!==void 0)?r=n:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...R1(i)):this.history.push(t),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pp extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Pp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gtt(e){const t={},n=g(e,["file"]);return n!=null&&m(t,["file"],n),t}function Htt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function $tt(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","file"],fq(n)),t}function ztt(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function Ktt(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","file"],fq(n)),t}function Wtt(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function Qtt(e){const t={},n=g(e,["config"]);return n!=null&&Wtt(n,t),t}function Ytt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["files"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["files"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jtt extends js{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ka(Rs.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Qtt(t);return s=gt("files",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=Ytt(c),u=new eZ;return Object.assign(u,h),u})}}async createInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Gtt(t);return s=gt("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Htt(c),u=new nZ;return Object.assign(u,h),u})}}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Ktt(t);return s=gt("files/{file}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$tt(t);return s=gt("files/{file}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=ztt(c),u=new iZ;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hg(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Xtt(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>met(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function Ztt(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function tet(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function eet(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function net(e){const t={},n=g(e,["modelSelectionConfig"]);n!=null&&m(t,["modelConfig"],n);const i=g(e,["responseJsonSchema"]);i!=null&&m(t,["responseJsonSchema"],i);const r=g(e,["audioTimestamp"]);r!=null&&m(t,["audioTimestamp"],r);const s=g(e,["candidateCount"]);s!=null&&m(t,["candidateCount"],s);const o=g(e,["enableAffectiveDialog"]);o!=null&&m(t,["enableAffectiveDialog"],o);const a=g(e,["frequencyPenalty"]);a!=null&&m(t,["frequencyPenalty"],a);const c=g(e,["logprobs"]);c!=null&&m(t,["logprobs"],c);const h=g(e,["maxOutputTokens"]);h!=null&&m(t,["maxOutputTokens"],h);const u=g(e,["mediaResolution"]);u!=null&&m(t,["mediaResolution"],u);const d=g(e,["presencePenalty"]);d!=null&&m(t,["presencePenalty"],d);const f=g(e,["responseLogprobs"]);f!=null&&m(t,["responseLogprobs"],f);const v=g(e,["responseMimeType"]);v!=null&&m(t,["responseMimeType"],v);const y=g(e,["responseModalities"]);y!=null&&m(t,["responseModalities"],y);const _=g(e,["responseSchema"]);_!=null&&m(t,["responseSchema"],_);const w=g(e,["routingConfig"]);w!=null&&m(t,["routingConfig"],w);const x=g(e,["seed"]);x!=null&&m(t,["seed"],x);const C=g(e,["speechConfig"]);C!=null&&m(t,["speechConfig"],C);const k=g(e,["stopSequences"]);k!=null&&m(t,["stopSequences"],k);const P=g(e,["temperature"]);P!=null&&m(t,["temperature"],P);const A=g(e,["thinkingConfig"]);A!=null&&m(t,["thinkingConfig"],A);const M=g(e,["topK"]);M!=null&&m(t,["topK"],M);const N=g(e,["topP"]);if(N!=null&&m(t,["topP"],N),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function iet(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function ret(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function set(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],i);const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],zb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],Xtt(Ln(y)));const _=g(e,["tools"]);if(t!==void 0&&_!=null){let M=Dl(_);Array.isArray(M)&&(M=M.map(N=>vet(Ml(N)))),m(t,["setup","tools"],M)}const w=g(e,["sessionResumption"]);t!==void 0&&w!=null&&m(t,["setup","sessionResumption"],pet(w));const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);if(t!==void 0&&A!=null&&m(t,["setup","proactivity"],A),g(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function oet(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],net(i));const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],zb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],Ln(y));const _=g(e,["tools"]);if(t!==void 0&&_!=null){let N=Dl(_);Array.isArray(N)&&(N=N.map(T=>yet(Ml(T)))),m(t,["setup","tools"],N)}const w=g(e,["sessionResumption"]);t!==void 0&&w!=null&&m(t,["setup","sessionResumption"],w);const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);t!==void 0&&A!=null&&m(t,["setup","proactivity"],A);const M=g(e,["explicitVadSignal"]);return t!==void 0&&M!=null&&m(t,["setup","explicitVadSignal"],M),n}function aet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],ee(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],set(r,n)),n}function cet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],ee(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],oet(r,n)),n}function het(e){const t={},n=g(e,["musicGenerationConfig"]);return n!=null&&m(t,["musicGenerationConfig"],n),t}function uet(e){const t={},n=g(e,["weightedPrompts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["weightedPrompts"],i)}return t}function det(e){const t={},n=g(e,["media"]);if(n!=null){let h=lq(n);Array.isArray(h)&&(h=h.map(u=>Hg(u))),m(t,["mediaChunks"],h)}const i=g(e,["audio"]);i!=null&&m(t,["audio"],Hg(uq(i)));const r=g(e,["audioStreamEnd"]);r!=null&&m(t,["audioStreamEnd"],r);const s=g(e,["video"]);s!=null&&m(t,["video"],Hg(hq(s)));const o=g(e,["text"]);o!=null&&m(t,["text"],o);const a=g(e,["activityStart"]);a!=null&&m(t,["activityStart"],a);const c=g(e,["activityEnd"]);return c!=null&&m(t,["activityEnd"],c),t}function get(e){const t={},n=g(e,["media"]);if(n!=null){let h=lq(n);Array.isArray(h)&&(h=h.map(u=>u)),m(t,["mediaChunks"],h)}const i=g(e,["audio"]);i!=null&&m(t,["audio"],uq(i));const r=g(e,["audioStreamEnd"]);r!=null&&m(t,["audioStreamEnd"],r);const s=g(e,["video"]);s!=null&&m(t,["video"],hq(s));const o=g(e,["text"]);o!=null&&m(t,["text"],o);const a=g(e,["activityStart"]);a!=null&&m(t,["activityStart"],a);const c=g(e,["activityEnd"]);return c!=null&&m(t,["activityEnd"],c),t}function fet(e){const t={},n=g(e,["setupComplete"]);n!=null&&m(t,["setupComplete"],n);const i=g(e,["serverContent"]);i!=null&&m(t,["serverContent"],i);const r=g(e,["toolCall"]);r!=null&&m(t,["toolCall"],r);const s=g(e,["toolCallCancellation"]);s!=null&&m(t,["toolCallCancellation"],s);const o=g(e,["usageMetadata"]);o!=null&&m(t,["usageMetadata"],xet(o));const a=g(e,["goAway"]);a!=null&&m(t,["goAway"],a);const c=g(e,["sessionResumptionUpdate"]);c!=null&&m(t,["sessionResumptionUpdate"],c);const h=g(e,["voiceActivityDetectionSignal"]);h!=null&&m(t,["voiceActivityDetectionSignal"],h);const u=g(e,["voiceActivity"]);return u!=null&&m(t,["voiceActivity"],_et(u)),t}function met(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],Ztt(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],tet(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],Hg(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function pet(e){const t={},n=g(e,["handle"]);if(n!=null&&m(t,["handle"],n),g(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function vet(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],iet(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],ret(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function yet(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>eet(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function xet(e){const t={},n=g(e,["promptTokenCount"]);n!=null&&m(t,["promptTokenCount"],n);const i=g(e,["cachedContentTokenCount"]);i!=null&&m(t,["cachedContentTokenCount"],i);const r=g(e,["candidatesTokenCount"]);r!=null&&m(t,["responseTokenCount"],r);const s=g(e,["toolUsePromptTokenCount"]);s!=null&&m(t,["toolUsePromptTokenCount"],s);const o=g(e,["thoughtsTokenCount"]);o!=null&&m(t,["thoughtsTokenCount"],o);const a=g(e,["totalTokenCount"]);a!=null&&m(t,["totalTokenCount"],a);const c=g(e,["promptTokensDetails"]);if(c!=null){let v=c;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["promptTokensDetails"],v)}const h=g(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["cacheTokensDetails"],v)}const u=g(e,["candidatesTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["responseTokensDetails"],v)}const d=g(e,["toolUsePromptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(y=>y)),m(t,["toolUsePromptTokensDetails"],v)}const f=g(e,["trafficType"]);return f!=null&&m(t,["trafficType"],f),t}function _et(e){const t={},n=g(e,["type"]);return n!=null&&m(t,["voiceActivityType"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wet(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function bet(e){const t={},n=g(e,["content"]);n!=null&&m(t,["content"],n);const i=g(e,["citationMetadata"]);i!=null&&m(t,["citationMetadata"],Tet(i));const r=g(e,["tokenCount"]);r!=null&&m(t,["tokenCount"],r);const s=g(e,["finishReason"]);s!=null&&m(t,["finishReason"],s);const o=g(e,["avgLogprobs"]);o!=null&&m(t,["avgLogprobs"],o);const a=g(e,["groundingMetadata"]);a!=null&&m(t,["groundingMetadata"],a);const c=g(e,["index"]);c!=null&&m(t,["index"],c);const h=g(e,["logprobsResult"]);h!=null&&m(t,["logprobsResult"],h);const u=g(e,["safetyRatings"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(v=>v)),m(t,["safetyRatings"],f)}const d=g(e,["urlContextMetadata"]);return d!=null&&m(t,["urlContextMetadata"],d),t}function Tet(e){const t={},n=g(e,["citationSources"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["citations"],i)}return t}function Cet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let s=Gi(r);Array.isArray(s)&&(s=s.map(o=>o)),m(n,["contents"],s)}return n}function ket(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(t,["tokensInfo"],r)}return t}function Net(e){const t={},n=g(e,["values"]);n!=null&&m(t,["values"],n);const i=g(e,["statistics"]);return i!=null&&m(t,["statistics"],Eet(i)),t}function Eet(e){const t={},n=g(e,["truncated"]);n!=null&&m(t,["truncated"],n);const i=g(e,["token_count"]);return i!=null&&m(t,["tokenCount"],i),t}function Mp(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>qnt(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function Iet(e){const t={},n=g(e,["controlType"]);n!=null&&m(t,["controlType"],n);const i=g(e,["enableControlImageComputation"]);return i!=null&&m(t,["computeControl"],i),t}function Aet(e){const t={};if(g(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Ret(e,t){const n={},i=g(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],Ln(i));const r=g(e,["tools"]);if(t!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>kq(a))),m(t,["tools"],o)}const s=g(e,["generationConfig"]);return t!==void 0&&s!=null&&m(t,["generationConfig"],bnt(s)),n}function Pet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let o=Gi(r);Array.isArray(o)&&(o=o.map(a=>Mp(a))),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&Aet(s),n}function Met(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let o=Gi(r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&Ret(s,n),n}function Det(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["totalTokens"]);i!=null&&m(t,["totalTokens"],i);const r=g(e,["cachedContentTokenCount"]);return r!=null&&m(t,["cachedContentTokenCount"],r),t}function Let(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["totalTokens"]);return i!=null&&m(t,["totalTokens"],i),t}function Vet(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],ee(e,i)),n}function qet(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],ee(e,i)),n}function jet(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function Fet(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}function Uet(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["negativePrompt"]);t!==void 0&&r!=null&&m(t,["parameters","negativePrompt"],r);const s=g(e,["numberOfImages"]);t!==void 0&&s!=null&&m(t,["parameters","sampleCount"],s);const o=g(e,["aspectRatio"]);t!==void 0&&o!=null&&m(t,["parameters","aspectRatio"],o);const a=g(e,["guidanceScale"]);t!==void 0&&a!=null&&m(t,["parameters","guidanceScale"],a);const c=g(e,["seed"]);t!==void 0&&c!=null&&m(t,["parameters","seed"],c);const h=g(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&m(t,["parameters","safetySetting"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&m(t,["parameters","includeSafetyAttributes"],d);const f=g(e,["includeRaiReason"]);t!==void 0&&f!=null&&m(t,["parameters","includeRaiReason"],f);const v=g(e,["language"]);t!==void 0&&v!=null&&m(t,["parameters","language"],v);const y=g(e,["outputMimeType"]);t!==void 0&&y!=null&&m(t,["parameters","outputOptions","mimeType"],y);const _=g(e,["outputCompressionQuality"]);t!==void 0&&_!=null&&m(t,["parameters","outputOptions","compressionQuality"],_);const w=g(e,["addWatermark"]);t!==void 0&&w!=null&&m(t,["parameters","addWatermark"],w);const x=g(e,["labels"]);t!==void 0&&x!=null&&m(t,["labels"],x);const C=g(e,["editMode"]);t!==void 0&&C!=null&&m(t,["parameters","editMode"],C);const k=g(e,["baseSteps"]);return t!==void 0&&k!=null&&m(t,["parameters","editConfig","baseSteps"],k),n}function Oet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["referenceImages"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>Gnt(c))),m(n,["instances[0]","referenceImages"],a)}const o=g(t,["config"]);return o!=null&&Uet(o,n),n}function Bet(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>Dp(s))),m(t,["generatedImages"],r)}return t}function Get(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["requests[]","taskType"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["requests[]","title"],r);const s=g(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&m(t,["requests[]","outputDimensionality"],s),g(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Het(e,t){const n={},i=g(e,["taskType"]);t!==void 0&&i!=null&&m(t,["instances[]","task_type"],i);const r=g(e,["title"]);t!==void 0&&r!=null&&m(t,["instances[]","title"],r);const s=g(e,["outputDimensionality"]);t!==void 0&&s!=null&&m(t,["parameters","outputDimensionality"],s);const o=g(e,["mimeType"]);t!==void 0&&o!=null&&m(t,["instances[]","mimeType"],o);const a=g(e,["autoTruncate"]);return t!==void 0&&a!=null&&m(t,["parameters","autoTruncate"],a),n}function $et(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let a=Gb(e,r);Array.isArray(a)&&(a=a.map(c=>c)),m(n,["requests[]","content"],a)}const s=g(t,["config"]);s!=null&&Get(s,n);const o=g(t,["model"]);return o!==void 0&&m(n,["requests[]","model"],ee(e,o)),n}function zet(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let o=Gb(e,r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["instances[]","content"],o)}const s=g(t,["config"]);return s!=null&&Het(s,n),n}function Ket(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["embeddings"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["embeddings"],s)}const r=g(e,["metadata"]);return r!=null&&m(t,["metadata"],r),t}function Wet(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions[]","embeddings"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Net(o))),m(t,["embeddings"],s)}const r=g(e,["metadata"]);return r!=null&&m(t,["metadata"],r),t}function Qet(e){const t={},n=g(e,["endpoint"]);n!=null&&m(t,["name"],n);const i=g(e,["deployedModelId"]);return i!=null&&m(t,["deployedModelId"],i),t}function Yet(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Jet(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function Xet(e){const t={},n=g(e,["allowedFunctionNames"]);n!=null&&m(t,["allowedFunctionNames"],n);const i=g(e,["mode"]);if(i!=null&&m(t,["mode"],i),g(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function Zet(e){const t={},n=g(e,["description"]);n!=null&&m(t,["description"],n);const i=g(e,["name"]);i!=null&&m(t,["name"],i);const r=g(e,["parameters"]);r!=null&&m(t,["parameters"],r);const s=g(e,["parametersJsonSchema"]);s!=null&&m(t,["parametersJsonSchema"],s);const o=g(e,["response"]);o!=null&&m(t,["response"],o);const a=g(e,["responseJsonSchema"]);if(a!=null&&m(t,["responseJsonSchema"],a),g(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function tnt(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],Mp(Ln(r)));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const _=g(t,["seed"]);_!=null&&m(i,["seed"],_);const w=g(t,["responseMimeType"]);w!=null&&m(i,["responseMimeType"],w);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],Hb(x));const C=g(t,["responseJsonSchema"]);if(C!=null&&m(i,["responseJsonSchema"],C),g(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=g(t,["safetySettings"]);if(n!==void 0&&k!=null){let L=k;Array.isArray(L)&&(L=L.map(lt=>Hnt(lt))),m(n,["safetySettings"],L)}const P=g(t,["tools"]);if(n!==void 0&&P!=null){let L=Dl(P);Array.isArray(L)&&(L=L.map(lt=>Jnt(Ml(lt)))),m(n,["tools"],L)}const A=g(t,["toolConfig"]);if(n!==void 0&&A!=null&&m(n,["toolConfig"],Ynt(A)),g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=g(t,["cachedContent"]);n!==void 0&&M!=null&&m(n,["cachedContent"],Fs(e,M));const N=g(t,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const T=g(t,["mediaResolution"]);T!=null&&m(i,["mediaResolution"],T);const E=g(t,["speechConfig"]);if(E!=null&&m(i,["speechConfig"],$b(E)),g(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=g(t,["thinkingConfig"]);R!=null&&m(i,["thinkingConfig"],R);const D=g(t,["imageConfig"]);D!=null&&m(i,["imageConfig"],Ent(D));const j=g(t,["enableEnhancedCivicAnswers"]);return j!=null&&m(i,["enableEnhancedCivicAnswers"],j),i}function ent(e,t,n){const i={},r=g(t,["systemInstruction"]);n!==void 0&&r!=null&&m(n,["systemInstruction"],Ln(r));const s=g(t,["temperature"]);s!=null&&m(i,["temperature"],s);const o=g(t,["topP"]);o!=null&&m(i,["topP"],o);const a=g(t,["topK"]);a!=null&&m(i,["topK"],a);const c=g(t,["candidateCount"]);c!=null&&m(i,["candidateCount"],c);const h=g(t,["maxOutputTokens"]);h!=null&&m(i,["maxOutputTokens"],h);const u=g(t,["stopSequences"]);u!=null&&m(i,["stopSequences"],u);const d=g(t,["responseLogprobs"]);d!=null&&m(i,["responseLogprobs"],d);const f=g(t,["logprobs"]);f!=null&&m(i,["logprobs"],f);const v=g(t,["presencePenalty"]);v!=null&&m(i,["presencePenalty"],v);const y=g(t,["frequencyPenalty"]);y!=null&&m(i,["frequencyPenalty"],y);const _=g(t,["seed"]);_!=null&&m(i,["seed"],_);const w=g(t,["responseMimeType"]);w!=null&&m(i,["responseMimeType"],w);const x=g(t,["responseSchema"]);x!=null&&m(i,["responseSchema"],Hb(x));const C=g(t,["responseJsonSchema"]);C!=null&&m(i,["responseJsonSchema"],C);const k=g(t,["routingConfig"]);k!=null&&m(i,["routingConfig"],k);const P=g(t,["modelSelectionConfig"]);P!=null&&m(i,["modelConfig"],P);const A=g(t,["safetySettings"]);if(n!==void 0&&A!=null){let Y=A;Array.isArray(Y)&&(Y=Y.map(W=>W)),m(n,["safetySettings"],Y)}const M=g(t,["tools"]);if(n!==void 0&&M!=null){let Y=Dl(M);Array.isArray(Y)&&(Y=Y.map(W=>kq(Ml(W)))),m(n,["tools"],Y)}const N=g(t,["toolConfig"]);n!==void 0&&N!=null&&m(n,["toolConfig"],N);const T=g(t,["labels"]);n!==void 0&&T!=null&&m(n,["labels"],T);const E=g(t,["cachedContent"]);n!==void 0&&E!=null&&m(n,["cachedContent"],Fs(e,E));const R=g(t,["responseModalities"]);R!=null&&m(i,["responseModalities"],R);const D=g(t,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const j=g(t,["speechConfig"]);j!=null&&m(i,["speechConfig"],$b(j));const L=g(t,["audioTimestamp"]);L!=null&&m(i,["audioTimestamp"],L);const lt=g(t,["thinkingConfig"]);lt!=null&&m(i,["thinkingConfig"],lt);const dt=g(t,["imageConfig"]);if(dt!=null&&m(i,["imageConfig"],Snt(dt)),g(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function P1(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let o=Gi(r);Array.isArray(o)&&(o=o.map(a=>Mp(a))),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&m(n,["generationConfig"],tnt(e,s,n)),n}function M1(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["contents"]);if(r!=null){let o=Gi(r);Array.isArray(o)&&(o=o.map(a=>a)),m(n,["contents"],o)}const s=g(t,["config"]);return s!=null&&m(n,["generationConfig"],ent(e,s,n)),n}function D1(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(h=>bet(h))),m(t,["candidates"],c)}const r=g(e,["modelVersion"]);r!=null&&m(t,["modelVersion"],r);const s=g(e,["promptFeedback"]);s!=null&&m(t,["promptFeedback"],s);const o=g(e,["responseId"]);o!=null&&m(t,["responseId"],o);const a=g(e,["usageMetadata"]);return a!=null&&m(t,["usageMetadata"],a),t}function L1(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(u=>u)),m(t,["candidates"],h)}const r=g(e,["createTime"]);r!=null&&m(t,["createTime"],r);const s=g(e,["modelVersion"]);s!=null&&m(t,["modelVersion"],s);const o=g(e,["promptFeedback"]);o!=null&&m(t,["promptFeedback"],o);const a=g(e,["responseId"]);a!=null&&m(t,["responseId"],a);const c=g(e,["usageMetadata"]);return c!=null&&m(t,["usageMetadata"],c),t}function nnt(e,t){const n={};if(g(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=g(e,["numberOfImages"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["aspectRatio"]);t!==void 0&&r!=null&&m(t,["parameters","aspectRatio"],r);const s=g(e,["guidanceScale"]);if(t!==void 0&&s!=null&&m(t,["parameters","guidanceScale"],s),g(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=g(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&m(t,["parameters","safetySetting"],o);const a=g(e,["personGeneration"]);t!==void 0&&a!=null&&m(t,["parameters","personGeneration"],a);const c=g(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&m(t,["parameters","includeSafetyAttributes"],c);const h=g(e,["includeRaiReason"]);t!==void 0&&h!=null&&m(t,["parameters","includeRaiReason"],h);const u=g(e,["language"]);t!==void 0&&u!=null&&m(t,["parameters","language"],u);const d=g(e,["outputMimeType"]);t!==void 0&&d!=null&&m(t,["parameters","outputOptions","mimeType"],d);const f=g(e,["outputCompressionQuality"]);if(t!==void 0&&f!=null&&m(t,["parameters","outputOptions","compressionQuality"],f),g(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const v=g(e,["imageSize"]);if(t!==void 0&&v!=null&&m(t,["parameters","sampleImageSize"],v),g(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function int(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["negativePrompt"]);t!==void 0&&r!=null&&m(t,["parameters","negativePrompt"],r);const s=g(e,["numberOfImages"]);t!==void 0&&s!=null&&m(t,["parameters","sampleCount"],s);const o=g(e,["aspectRatio"]);t!==void 0&&o!=null&&m(t,["parameters","aspectRatio"],o);const a=g(e,["guidanceScale"]);t!==void 0&&a!=null&&m(t,["parameters","guidanceScale"],a);const c=g(e,["seed"]);t!==void 0&&c!=null&&m(t,["parameters","seed"],c);const h=g(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&m(t,["parameters","safetySetting"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&m(t,["parameters","includeSafetyAttributes"],d);const f=g(e,["includeRaiReason"]);t!==void 0&&f!=null&&m(t,["parameters","includeRaiReason"],f);const v=g(e,["language"]);t!==void 0&&v!=null&&m(t,["parameters","language"],v);const y=g(e,["outputMimeType"]);t!==void 0&&y!=null&&m(t,["parameters","outputOptions","mimeType"],y);const _=g(e,["outputCompressionQuality"]);t!==void 0&&_!=null&&m(t,["parameters","outputOptions","compressionQuality"],_);const w=g(e,["addWatermark"]);t!==void 0&&w!=null&&m(t,["parameters","addWatermark"],w);const x=g(e,["labels"]);t!==void 0&&x!=null&&m(t,["labels"],x);const C=g(e,["imageSize"]);t!==void 0&&C!=null&&m(t,["parameters","sampleImageSize"],C);const k=g(e,["enhancePrompt"]);return t!==void 0&&k!=null&&m(t,["parameters","enhancePrompt"],k),n}function rnt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["config"]);return s!=null&&nnt(s,n),n}function snt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["config"]);return s!=null&&int(s,n),n}function ont(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ynt(o))),m(t,["generatedImages"],s)}const r=g(e,["positivePromptSafetyAttributes"]);return r!=null&&m(t,["positivePromptSafetyAttributes"],Tq(r)),t}function ant(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Dp(o))),m(t,["generatedImages"],s)}const r=g(e,["positivePromptSafetyAttributes"]);return r!=null&&m(t,["positivePromptSafetyAttributes"],Cq(r)),t}function cnt(e,t){const n={},i=g(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i),g(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=g(e,["durationSeconds"]);if(t!==void 0&&r!=null&&m(t,["parameters","durationSeconds"],r),g(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=g(e,["aspectRatio"]);t!==void 0&&s!=null&&m(t,["parameters","aspectRatio"],s);const o=g(e,["resolution"]);t!==void 0&&o!=null&&m(t,["parameters","resolution"],o);const a=g(e,["personGeneration"]);if(t!==void 0&&a!=null&&m(t,["parameters","personGeneration"],a),g(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=g(e,["negativePrompt"]);t!==void 0&&c!=null&&m(t,["parameters","negativePrompt"],c);const h=g(e,["enhancePrompt"]);if(t!==void 0&&h!=null&&m(t,["parameters","enhancePrompt"],h),g(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const u=g(e,["lastFrame"]);t!==void 0&&u!=null&&m(t,["instances[0]","lastFrame"],Lp(u));const d=g(e,["referenceImages"]);if(t!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(v=>hit(v))),m(t,["instances[0]","referenceImages"],f)}if(g(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function lnt(e,t){const n={},i=g(e,["numberOfVideos"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["outputGcsUri"]);t!==void 0&&r!=null&&m(t,["parameters","storageUri"],r);const s=g(e,["fps"]);t!==void 0&&s!=null&&m(t,["parameters","fps"],s);const o=g(e,["durationSeconds"]);t!==void 0&&o!=null&&m(t,["parameters","durationSeconds"],o);const a=g(e,["seed"]);t!==void 0&&a!=null&&m(t,["parameters","seed"],a);const c=g(e,["aspectRatio"]);t!==void 0&&c!=null&&m(t,["parameters","aspectRatio"],c);const h=g(e,["resolution"]);t!==void 0&&h!=null&&m(t,["parameters","resolution"],h);const u=g(e,["personGeneration"]);t!==void 0&&u!=null&&m(t,["parameters","personGeneration"],u);const d=g(e,["pubsubTopic"]);t!==void 0&&d!=null&&m(t,["parameters","pubsubTopic"],d);const f=g(e,["negativePrompt"]);t!==void 0&&f!=null&&m(t,["parameters","negativePrompt"],f);const v=g(e,["enhancePrompt"]);t!==void 0&&v!=null&&m(t,["parameters","enhancePrompt"],v);const y=g(e,["generateAudio"]);t!==void 0&&y!=null&&m(t,["parameters","generateAudio"],y);const _=g(e,["lastFrame"]);t!==void 0&&_!=null&&m(t,["instances[0]","lastFrame"],Er(_));const w=g(e,["referenceImages"]);if(t!==void 0&&w!=null){let k=w;Array.isArray(k)&&(k=k.map(P=>uit(P))),m(t,["instances[0]","referenceImages"],k)}const x=g(e,["mask"]);t!==void 0&&x!=null&&m(t,["instances[0]","mask"],lit(x));const C=g(e,["compressionQuality"]);return t!==void 0&&C!=null&&m(t,["parameters","compressionQuality"],C),n}function hnt(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response","generateVideoResponse"]);return o!=null&&m(t,["response"],fnt(o)),t}function unt(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],mnt(o)),t}function dnt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["image"]);s!=null&&m(n,["instances[0]","image"],Lp(s));const o=g(t,["video"]);o!=null&&m(n,["instances[0]","video"],Nq(o));const a=g(t,["source"]);a!=null&&pnt(a,n);const c=g(t,["config"]);return c!=null&&cnt(c,n),n}function gnt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["prompt"]);r!=null&&m(n,["instances[0]","prompt"],r);const s=g(t,["image"]);s!=null&&m(n,["instances[0]","image"],Er(s));const o=g(t,["video"]);o!=null&&m(n,["instances[0]","video"],Eq(o));const a=g(t,["source"]);a!=null&&vnt(a,n);const c=g(t,["config"]);return c!=null&&lnt(c,n),n}function fnt(e){const t={},n=g(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>_nt(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function mnt(e){const t={},n=g(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>wnt(o))),m(t,["generatedVideos"],s)}const i=g(e,["raiMediaFilteredCount"]);i!=null&&m(t,["raiMediaFilteredCount"],i);const r=g(e,["raiMediaFilteredReasons"]);return r!=null&&m(t,["raiMediaFilteredReasons"],r),t}function pnt(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],Lp(r));const s=g(e,["video"]);return t!==void 0&&s!=null&&m(t,["instances[0]","video"],Nq(s)),n}function vnt(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],Er(r));const s=g(e,["video"]);return t!==void 0&&s!=null&&m(t,["instances[0]","video"],Eq(s)),n}function ynt(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["image"],Int(n));const i=g(e,["raiFilteredReason"]);i!=null&&m(t,["raiFilteredReason"],i);const r=g(e,["_self"]);return r!=null&&m(t,["safetyAttributes"],Tq(r)),t}function Dp(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["image"],bq(n));const i=g(e,["raiFilteredReason"]);i!=null&&m(t,["raiFilteredReason"],i);const r=g(e,["_self"]);r!=null&&m(t,["safetyAttributes"],Cq(r));const s=g(e,["prompt"]);return s!=null&&m(t,["enhancedPrompt"],s),t}function xnt(e){const t={},n=g(e,["_self"]);n!=null&&m(t,["mask"],bq(n));const i=g(e,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(t,["labels"],r)}return t}function _nt(e){const t={},n=g(e,["video"]);return n!=null&&m(t,["video"],ait(n)),t}function wnt(e){const t={},n=g(e,["_self"]);return n!=null&&m(t,["video"],cit(n)),t}function bnt(e){const t={},n=g(e,["modelSelectionConfig"]);n!=null&&m(t,["modelConfig"],n);const i=g(e,["responseJsonSchema"]);i!=null&&m(t,["responseJsonSchema"],i);const r=g(e,["audioTimestamp"]);r!=null&&m(t,["audioTimestamp"],r);const s=g(e,["candidateCount"]);s!=null&&m(t,["candidateCount"],s);const o=g(e,["enableAffectiveDialog"]);o!=null&&m(t,["enableAffectiveDialog"],o);const a=g(e,["frequencyPenalty"]);a!=null&&m(t,["frequencyPenalty"],a);const c=g(e,["logprobs"]);c!=null&&m(t,["logprobs"],c);const h=g(e,["maxOutputTokens"]);h!=null&&m(t,["maxOutputTokens"],h);const u=g(e,["mediaResolution"]);u!=null&&m(t,["mediaResolution"],u);const d=g(e,["presencePenalty"]);d!=null&&m(t,["presencePenalty"],d);const f=g(e,["responseLogprobs"]);f!=null&&m(t,["responseLogprobs"],f);const v=g(e,["responseMimeType"]);v!=null&&m(t,["responseMimeType"],v);const y=g(e,["responseModalities"]);y!=null&&m(t,["responseModalities"],y);const _=g(e,["responseSchema"]);_!=null&&m(t,["responseSchema"],_);const w=g(e,["routingConfig"]);w!=null&&m(t,["routingConfig"],w);const x=g(e,["seed"]);x!=null&&m(t,["seed"],x);const C=g(e,["speechConfig"]);C!=null&&m(t,["speechConfig"],C);const k=g(e,["stopSequences"]);k!=null&&m(t,["stopSequences"],k);const P=g(e,["temperature"]);P!=null&&m(t,["temperature"],P);const A=g(e,["thinkingConfig"]);A!=null&&m(t,["thinkingConfig"],A);const M=g(e,["topK"]);M!=null&&m(t,["topK"],M);const N=g(e,["topP"]);if(N!=null&&m(t,["topP"],N),g(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function Tnt(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],ee(e,i)),n}function Cnt(e,t){const n={},i=g(t,["model"]);return i!=null&&m(n,["_url","name"],ee(e,i)),n}function knt(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function Nnt(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function Ent(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);if(i!=null&&m(t,["imageSize"],i),g(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function Snt(e){const t={},n=g(e,["aspectRatio"]);n!=null&&m(t,["aspectRatio"],n);const i=g(e,["imageSize"]);i!=null&&m(t,["imageSize"],i);const r=g(e,["personGeneration"]);r!=null&&m(t,["personGeneration"],r);const s=g(e,["outputMimeType"]);s!=null&&m(t,["imageOutputOptions","mimeType"],s);const o=g(e,["outputCompressionQuality"]);return o!=null&&m(t,["imageOutputOptions","compressionQuality"],o),t}function Int(e){const t={},n=g(e,["bytesBase64Encoded"]);n!=null&&m(t,["imageBytes"],$o(n));const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function bq(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["imageBytes"],$o(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function Lp(e){const t={};if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=g(e,["imageBytes"]);n!=null&&m(t,["bytesBase64Encoded"],$o(n));const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function Er(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["imageBytes"]);i!=null&&m(t,["bytesBase64Encoded"],$o(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function Ant(e,t,n){const i={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&m(n,["_query","pageSize"],r);const s=g(t,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const o=g(t,["filter"]);n!==void 0&&o!=null&&m(n,["_query","filter"],o);const a=g(t,["queryBase"]);return n!==void 0&&a!=null&&m(n,["_url","models_url"],mq(e,a)),i}function Rnt(e,t,n){const i={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&m(n,["_query","pageSize"],r);const s=g(t,["pageToken"]);n!==void 0&&s!=null&&m(n,["_query","pageToken"],s);const o=g(t,["filter"]);n!==void 0&&o!=null&&m(n,["_query","filter"],o);const a=g(t,["queryBase"]);return n!==void 0&&a!=null&&m(n,["_url","models_url"],mq(e,a)),i}function Pnt(e,t){const n={},i=g(t,["config"]);return i!=null&&Ant(e,i,n),n}function Mnt(e,t){const n={},i=g(t,["config"]);return i!=null&&Rnt(e,i,n),n}function Dnt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["_self"]);if(r!=null){let s=pq(r);Array.isArray(s)&&(s=s.map(o=>N0(o))),m(t,["models"],s)}return t}function Lnt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["_self"]);if(r!=null){let s=pq(r);Array.isArray(s)&&(s=s.map(o=>E0(o))),m(t,["models"],s)}return t}function Vnt(e){const t={},n=g(e,["maskMode"]);n!=null&&m(t,["maskMode"],n);const i=g(e,["segmentationClasses"]);i!=null&&m(t,["maskClasses"],i);const r=g(e,["maskDilation"]);return r!=null&&m(t,["dilation"],r),t}function N0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);r!=null&&m(t,["description"],r);const s=g(e,["version"]);s!=null&&m(t,["version"],s);const o=g(e,["_self"]);o!=null&&m(t,["tunedModelInfo"],Xnt(o));const a=g(e,["inputTokenLimit"]);a!=null&&m(t,["inputTokenLimit"],a);const c=g(e,["outputTokenLimit"]);c!=null&&m(t,["outputTokenLimit"],c);const h=g(e,["supportedGenerationMethods"]);h!=null&&m(t,["supportedActions"],h);const u=g(e,["temperature"]);u!=null&&m(t,["temperature"],u);const d=g(e,["maxTemperature"]);d!=null&&m(t,["maxTemperature"],d);const f=g(e,["topP"]);f!=null&&m(t,["topP"],f);const v=g(e,["topK"]);v!=null&&m(t,["topK"],v);const y=g(e,["thinking"]);return y!=null&&m(t,["thinking"],y),t}function E0(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["displayName"]);i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);r!=null&&m(t,["description"],r);const s=g(e,["versionId"]);s!=null&&m(t,["version"],s);const o=g(e,["deployedModels"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Qet(f))),m(t,["endpoints"],d)}const a=g(e,["labels"]);a!=null&&m(t,["labels"],a);const c=g(e,["_self"]);c!=null&&m(t,["tunedModelInfo"],Znt(c));const h=g(e,["defaultCheckpointId"]);h!=null&&m(t,["defaultCheckpointId"],h);const u=g(e,["checkpoints"]);if(u!=null){let d=u;Array.isArray(d)&&(d=d.map(f=>f)),m(t,["checkpoints"],d)}return t}function qnt(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],Yet(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],Jet(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],wet(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function jnt(e){const t={},n=g(e,["productImage"]);return n!=null&&m(t,["image"],Er(n)),t}function Fnt(e,t){const n={},i=g(e,["numberOfImages"]);t!==void 0&&i!=null&&m(t,["parameters","sampleCount"],i);const r=g(e,["baseSteps"]);t!==void 0&&r!=null&&m(t,["parameters","baseSteps"],r);const s=g(e,["outputGcsUri"]);t!==void 0&&s!=null&&m(t,["parameters","storageUri"],s);const o=g(e,["seed"]);t!==void 0&&o!=null&&m(t,["parameters","seed"],o);const a=g(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&m(t,["parameters","safetySetting"],a);const c=g(e,["personGeneration"]);t!==void 0&&c!=null&&m(t,["parameters","personGeneration"],c);const h=g(e,["addWatermark"]);t!==void 0&&h!=null&&m(t,["parameters","addWatermark"],h);const u=g(e,["outputMimeType"]);t!==void 0&&u!=null&&m(t,["parameters","outputOptions","mimeType"],u);const d=g(e,["outputCompressionQuality"]);t!==void 0&&d!=null&&m(t,["parameters","outputOptions","compressionQuality"],d);const f=g(e,["enhancePrompt"]);t!==void 0&&f!=null&&m(t,["parameters","enhancePrompt"],f);const v=g(e,["labels"]);return t!==void 0&&v!=null&&m(t,["labels"],v),n}function Unt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["source"]);r!=null&&Bnt(r,n);const s=g(t,["config"]);return s!=null&&Fnt(s,n),n}function Ont(e){const t={},n=g(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Dp(r))),m(t,["generatedImages"],i)}return t}function Bnt(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["personImage"]);t!==void 0&&r!=null&&m(t,["instances[0]","personImage","image"],Er(r));const s=g(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>jnt(a))),m(t,["instances[0]","productImages"],o)}return n}function Gnt(e){const t={},n=g(e,["referenceImage"]);n!=null&&m(t,["referenceImage"],Er(n));const i=g(e,["referenceId"]);i!=null&&m(t,["referenceId"],i);const r=g(e,["referenceType"]);r!=null&&m(t,["referenceType"],r);const s=g(e,["maskImageConfig"]);s!=null&&m(t,["maskImageConfig"],Vnt(s));const o=g(e,["controlImageConfig"]);o!=null&&m(t,["controlImageConfig"],Iet(o));const a=g(e,["styleImageConfig"]);a!=null&&m(t,["styleImageConfig"],a);const c=g(e,["subjectImageConfig"]);return c!=null&&m(t,["subjectImageConfig"],c),t}function Tq(e){const t={},n=g(e,["safetyAttributes","categories"]);n!=null&&m(t,["categories"],n);const i=g(e,["safetyAttributes","scores"]);i!=null&&m(t,["scores"],i);const r=g(e,["contentType"]);return r!=null&&m(t,["contentType"],r),t}function Cq(e){const t={},n=g(e,["safetyAttributes","categories"]);n!=null&&m(t,["categories"],n);const i=g(e,["safetyAttributes","scores"]);i!=null&&m(t,["scores"],i);const r=g(e,["contentType"]);return r!=null&&m(t,["contentType"],r),t}function Hnt(e){const t={},n=g(e,["category"]);if(n!=null&&m(t,["category"],n),g(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(e,["threshold"]);return i!=null&&m(t,["threshold"],i),t}function $nt(e){const t={},n=g(e,["image"]);return n!=null&&m(t,["image"],Er(n)),t}function znt(e,t){const n={},i=g(e,["mode"]);t!==void 0&&i!=null&&m(t,["parameters","mode"],i);const r=g(e,["maxPredictions"]);t!==void 0&&r!=null&&m(t,["parameters","maxPredictions"],r);const s=g(e,["confidenceThreshold"]);t!==void 0&&s!=null&&m(t,["parameters","confidenceThreshold"],s);const o=g(e,["maskDilation"]);t!==void 0&&o!=null&&m(t,["parameters","maskDilation"],o);const a=g(e,["binaryColorThreshold"]);t!==void 0&&a!=null&&m(t,["parameters","binaryColorThreshold"],a);const c=g(e,["labels"]);return t!==void 0&&c!=null&&m(t,["labels"],c),n}function Knt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["source"]);r!=null&&Qnt(r,n);const s=g(t,["config"]);return s!=null&&znt(s,n),n}function Wnt(e){const t={},n=g(e,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>xnt(r))),m(t,["generatedMasks"],i)}return t}function Qnt(e,t){const n={},i=g(e,["prompt"]);t!==void 0&&i!=null&&m(t,["instances[0]","prompt"],i);const r=g(e,["image"]);t!==void 0&&r!=null&&m(t,["instances[0]","image"],Er(r));const s=g(e,["scribbleImage"]);return t!==void 0&&s!=null&&m(t,["instances[0]","scribble"],$nt(s)),n}function Ynt(e){const t={},n=g(e,["retrievalConfig"]);n!=null&&m(t,["retrievalConfig"],n);const i=g(e,["functionCallingConfig"]);return i!=null&&m(t,["functionCallingConfig"],Xet(i)),t}function Jnt(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],knt(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],Nnt(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}function kq(e){const t={},n=g(e,["retrieval"]);n!=null&&m(t,["retrieval"],n);const i=g(e,["computerUse"]);if(i!=null&&m(t,["computerUse"],i),g(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=g(e,["codeExecution"]);r!=null&&m(t,["codeExecution"],r);const s=g(e,["enterpriseWebSearch"]);s!=null&&m(t,["enterpriseWebSearch"],s);const o=g(e,["functionDeclarations"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>Zet(f))),m(t,["functionDeclarations"],d)}const a=g(e,["googleMaps"]);a!=null&&m(t,["googleMaps"],a);const c=g(e,["googleSearch"]);c!=null&&m(t,["googleSearch"],c);const h=g(e,["googleSearchRetrieval"]);h!=null&&m(t,["googleSearchRetrieval"],h);const u=g(e,["urlContext"]);return u!=null&&m(t,["urlContext"],u),t}function Xnt(e){const t={},n=g(e,["baseModel"]);n!=null&&m(t,["baseModel"],n);const i=g(e,["createTime"]);i!=null&&m(t,["createTime"],i);const r=g(e,["updateTime"]);return r!=null&&m(t,["updateTime"],r),t}function Znt(e){const t={},n=g(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(t,["baseModel"],n);const i=g(e,["createTime"]);i!=null&&m(t,["createTime"],i);const r=g(e,["updateTime"]);return r!=null&&m(t,["updateTime"],r),t}function tit(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);t!==void 0&&r!=null&&m(t,["description"],r);const s=g(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&m(t,["defaultCheckpointId"],s),n}function eit(e,t){const n={},i=g(e,["displayName"]);t!==void 0&&i!=null&&m(t,["displayName"],i);const r=g(e,["description"]);t!==void 0&&r!=null&&m(t,["description"],r);const s=g(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&m(t,["defaultCheckpointId"],s),n}function nit(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","name"],ee(e,i));const r=g(t,["config"]);return r!=null&&tit(r,n),n}function iit(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["config"]);return r!=null&&eit(r,n),n}function rit(e,t){const n={},i=g(e,["outputGcsUri"]);t!==void 0&&i!=null&&m(t,["parameters","storageUri"],i);const r=g(e,["safetyFilterLevel"]);t!==void 0&&r!=null&&m(t,["parameters","safetySetting"],r);const s=g(e,["personGeneration"]);t!==void 0&&s!=null&&m(t,["parameters","personGeneration"],s);const o=g(e,["includeRaiReason"]);t!==void 0&&o!=null&&m(t,["parameters","includeRaiReason"],o);const a=g(e,["outputMimeType"]);t!==void 0&&a!=null&&m(t,["parameters","outputOptions","mimeType"],a);const c=g(e,["outputCompressionQuality"]);t!==void 0&&c!=null&&m(t,["parameters","outputOptions","compressionQuality"],c);const h=g(e,["enhanceInputImage"]);t!==void 0&&h!=null&&m(t,["parameters","upscaleConfig","enhanceInputImage"],h);const u=g(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&m(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const d=g(e,["labels"]);t!==void 0&&d!=null&&m(t,["labels"],d);const f=g(e,["numberOfImages"]);t!==void 0&&f!=null&&m(t,["parameters","sampleCount"],f);const v=g(e,["mode"]);return t!==void 0&&v!=null&&m(t,["parameters","mode"],v),n}function sit(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["_url","model"],ee(e,i));const r=g(t,["image"]);r!=null&&m(n,["instances[0]","image"],Er(r));const s=g(t,["upscaleFactor"]);s!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=g(t,["config"]);return o!=null&&rit(o,n),n}function oit(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>Dp(s))),m(t,["generatedImages"],r)}return t}function ait(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["encodedVideo"]);i!=null&&m(t,["videoBytes"],$o(i));const r=g(e,["encoding"]);return r!=null&&m(t,["mimeType"],r),t}function cit(e){const t={},n=g(e,["gcsUri"]);n!=null&&m(t,["uri"],n);const i=g(e,["bytesBase64Encoded"]);i!=null&&m(t,["videoBytes"],$o(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function lit(e){const t={},n=g(e,["image"]);n!=null&&m(t,["_self"],Er(n));const i=g(e,["maskMode"]);return i!=null&&m(t,["maskMode"],i),t}function hit(e){const t={},n=g(e,["image"]);n!=null&&m(t,["image"],Lp(n));const i=g(e,["referenceType"]);return i!=null&&m(t,["referenceType"],i),t}function uit(e){const t={},n=g(e,["image"]);n!=null&&m(t,["image"],Er(n));const i=g(e,["referenceType"]);return i!=null&&m(t,["referenceType"],i),t}function Nq(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["uri"],n);const i=g(e,["videoBytes"]);i!=null&&m(t,["encodedVideo"],$o(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["encoding"],r),t}function Eq(e){const t={},n=g(e,["uri"]);n!=null&&m(t,["gcsUri"],n);const i=g(e,["videoBytes"]);i!=null&&m(t,["bytesBase64Encoded"],$o(i));const r=g(e,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dit(e,t){const n={},i=g(e,["displayName"]);return t!==void 0&&i!=null&&m(t,["displayName"],i),n}function git(e){const t={},n=g(e,["config"]);return n!=null&&dit(n,t),t}function fit(e,t){const n={},i=g(e,["force"]);return t!==void 0&&i!=null&&m(t,["_query","force"],i),n}function mit(e){const t={},n=g(e,["name"]);n!=null&&m(t,["_url","name"],n);const i=g(e,["config"]);return i!=null&&fit(i,t),t}function pit(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","name"],n),t}function vit(e,t){const n={},i=g(e,["customMetadata"]);if(t!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["customMetadata"],s)}const r=g(e,["chunkingConfig"]);return t!==void 0&&r!=null&&m(t,["chunkingConfig"],r),n}function yit(e){const t={},n=g(e,["name"]);n!=null&&m(t,["name"],n);const i=g(e,["metadata"]);i!=null&&m(t,["metadata"],i);const r=g(e,["done"]);r!=null&&m(t,["done"],r);const s=g(e,["error"]);s!=null&&m(t,["error"],s);const o=g(e,["response"]);return o!=null&&m(t,["response"],_it(o)),t}function xit(e){const t={},n=g(e,["fileSearchStoreName"]);n!=null&&m(t,["_url","file_search_store_name"],n);const i=g(e,["fileName"]);i!=null&&m(t,["fileName"],i);const r=g(e,["config"]);return r!=null&&vit(r,t),t}function _it(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["parent"]);i!=null&&m(t,["parent"],i);const r=g(e,["documentName"]);return r!=null&&m(t,["documentName"],r),t}function wit(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function bit(e){const t={},n=g(e,["config"]);return n!=null&&wit(n,t),t}function Tit(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["fileSearchStores"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["fileSearchStores"],s)}return t}function Sq(e,t){const n={},i=g(e,["mimeType"]);t!==void 0&&i!=null&&m(t,["mimeType"],i);const r=g(e,["displayName"]);t!==void 0&&r!=null&&m(t,["displayName"],r);const s=g(e,["customMetadata"]);if(t!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),m(t,["customMetadata"],a)}const o=g(e,["chunkingConfig"]);return t!==void 0&&o!=null&&m(t,["chunkingConfig"],o),n}function Cit(e){const t={},n=g(e,["fileSearchStoreName"]);n!=null&&m(t,["_url","file_search_store_name"],n);const i=g(e,["config"]);return i!=null&&Sq(i,t),t}function kit(e){const t={},n=g(e,["sdkHttpResponse"]);return n!=null&&m(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nit="Content-Type",Eit="X-Server-Timeout",Sit="User-Agent",S0="x-goog-api-client",Iit="1.37.0",Ait=`google-genai-sdk/${Iit}`,Rit="v1beta1",Pit="v1beta";class Mit{constructor(t){var n,i;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Rit,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Pit,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&i.push(t.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,i){const r=[this.getRequestUrlInternal(n)];return i&&r.push(this.getBaseResourcePath()),t!==""&&r.push(t),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,n,i);if(t.queryParams)for(const[o,a]of Object.entries(t.queryParams))r.searchParams.append(o,String(a));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,r.toString(),t.abortSignal),this.unaryApiCall(r,s,t.httpMethod)}patchHttpOptions(t,n){const i=JSON.parse(JSON.stringify(t));for(const[r,s]of Object.entries(n))typeof s=="object"?i[r]=Object.assign(Object.assign({},i[r]),s):s!==void 0&&(i[r]=s);return i}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const i=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,n,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,r.toString(),t.abortSignal),this.streamApiCall(r,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,i,r){if(n&&n.timeout||r){const s=new AbortController,o=s.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>s.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}r&&r.addEventListener("abort",()=>{s.abort()}),t.signal=o}return n&&n.extraBody!==null&&Dit(t,n.extraBody),t.headers=await this.getHeadersInternal(n,i),t}async unaryApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await V1(r),new T0(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(t,n,i){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:i})).then(async r=>(await V1(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(t){return wr(this,arguments,function*(){var i;const r=(i=t==null?void 0:t.body)===null||i===void 0?void 0:i.getReader(),s=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let o="";const a="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:u}=yield Lt(r.read());if(h){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=s.decode(u,{stream:!0});try{const y=JSON.parse(d);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),w=_.status,x=_.code,C=`got status: ${w}. ${JSON.stringify(y)}`;if(x>=400&&x<600)throw new Pp({message:C,status:x})}}catch(y){if(y.name==="ApiError")throw y}o+=d;let f=-1,v=0;for(;;){f=-1,v=0;for(const w of c){const x=o.indexOf(w);x!==-1&&(f===-1||x<f)&&(f=x,v=w.length)}if(f===-1)break;const y=o.substring(0,f);o=o.substring(f+v);const _=y.trim();if(_.startsWith(a)){const w=_.substring(a.length).trim();try{const x=new Response(w,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Lt(new T0(x))}catch(x){throw new Error(`exception parsing stream chunk ${w}. ${x}`)}}}}}finally{r.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const t={},n=Ait+" "+this.clientOptions.userAgentExtra;return t[Sit]=n,t[S0]=n,t[Nit]="application/json",t}async getHeadersInternal(t,n){const i=new Headers;if(t&&t.headers){for(const[r,s]of Object.entries(t.headers))i.append(r,s);t.timeout&&t.timeout>0&&i.append(Eit,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,n),i}getFileName(t){var n;let i="";return typeof t=="string"&&(i=t.replace(/[/\\]+$/,""),i=(n=i.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),i}async uploadFile(t,n){var i;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);r.sizeBytes=String(o.size);const a=(i=n==null?void 0:n.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;const c={file:r},h=this.getFileName(t),u=gt("upload/v1beta/files",c._url),d=await this.fetchUploadUrl(u,r.sizeBytes,r.mimeType,h,c,n==null?void 0:n.httpOptions);return s.upload(t,d,this)}async uploadFileToFileSearchStore(t,n,i){var r;const s=this.clientOptions.uploader,o=await s.stat(n),a=String(o.size),c=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:o.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${t}:uploadToFileSearchStore`,u=this.getFileName(n),d={};i!=null&&Sq(i,d);const f=await this.fetchUploadUrl(h,a,c,u,d,i==null?void 0:i.httpOptions);return s.uploadToFileSearchStore(n,f,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,i,r,s,o){var a;let c={};o?c=o:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const h=await this.request({path:t,body:JSON.stringify(s),httpMethod:"POST",httpOptions:c});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(a=h==null?void 0:h.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function V1(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let i;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await e.json():i={error:{message:await e.text(),code:e.status,status:e.statusText}};const r=JSON.stringify(i);throw n>=400&&n<600?new Pp({message:r,status:n}):new Error(r)}}function Dit(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(s,o){const a=Object.assign({},s);for(const c in o)if(Object.prototype.hasOwnProperty.call(o,c)){const h=o[c],u=a[c];h&&typeof h=="object"&&!Array.isArray(h)&&u&&typeof u=="object"&&!Array.isArray(u)?a[c]=i(u,h):(u&&h&&typeof u!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof u}, New type: ${typeof h}. Overwriting.`),a[c]=h)}return a}const r=i(n,t);e.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Lit="mcp_used/unknown";let Vit=!1;function Iq(e){for(const t of e)if(qit(t)||typeof t=="object"&&"inputSchema"in t)return!0;return Vit}function Aq(e){var t;const n=(t=e[S0])!==null&&t!==void 0?t:"";e[S0]=(n+` ${Lit}`).trimStart()}function qit(e){return e!==null&&typeof e=="object"&&e instanceof Kb}function jit(e){return wr(this,arguments,function*(n,i=100){let r,s=0;for(;s<i;){const o=yield Lt(n.listTools({cursor:r}));for(const a of o.tools)yield yield Lt(a),s++;if(!o.nextCursor)break;r=o.nextCursor}})}class Kb{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new Kb(t,n)}async initialize(){var t,n,i,r;if(this.mcpTools.length>0)return;const s={},o=[];for(const u of this.mcpClients)try{for(var a=!0,c=(n=void 0,br(jit(u))),h;h=await c.next(),t=h.done,!t;a=!0){r=h.value,a=!1;const d=r;o.push(d);const f=d.name;if(s[f])throw new Error(`Duplicate function name ${f} found in MCP tools. Please ensure function names are unique.`);s[f]=u}}catch(d){n={error:d}}finally{try{!a&&!t&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),gZ(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const i of t)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await r.callTool({name:i.name,arguments:i.args},void 0,s);n.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Fit(e,t,n){const i=new sZ;let r;n.data instanceof Blob?r=JSON.parse(await n.data.text()):r=JSON.parse(n.data),Object.assign(i,r),t(i)}class Uit{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i}async connect(t){var n,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=Git(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${a}`;let h=()=>{};const u=new Promise(k=>{h=k}),d=t.callbacks,f=function(){h({})},v=this.apiClient,y={onopen:f,onmessage:k=>{Fit(v,d.onmessage,k)},onerror:(n=d==null?void 0:d.onerror)!==null&&n!==void 0?n:function(k){},onclose:(i=d==null?void 0:d.onclose)!==null&&i!==void 0?i:function(k){}},_=this.webSocketFactory.create(c,Bit(o),y);_.connect(),await u;const C={setup:{model:ee(this.apiClient,t.model)}};return _.send(JSON.stringify(C)),new Oit(_,this.apiClient)}}class Oit{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=uet(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=het(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(bc.PLAY)}pause(){this.sendPlaybackControl(bc.PAUSE)}stop(){this.sendPlaybackControl(bc.STOP)}resetContext(){this.sendPlaybackControl(bc.RESET_CONTEXT)}close(){this.conn.close()}}function Bit(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function Git(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hit="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function $it(e,t,n){const i=new rZ;let r;n.data instanceof Blob?r=await n.data.text():n.data instanceof ArrayBuffer?r=new TextDecoder().decode(n.data):r=n.data;const s=JSON.parse(r);if(e.isVertexAI()){const o=fet(s);Object.assign(i,o)}else Object.assign(i,s);t(i)}class zit{constructor(t,n,i){this.apiClient=t,this.auth=n,this.webSocketFactory=i,this.music=new Uit(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,i,r,s,o,a;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let u;const d=this.apiClient.getHeaders();t.config&&t.config.tools&&Iq(t.config.tools)&&Aq(d);const f=Yit(d);if(this.apiClient.isVertexAI())u=`${c}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(f,u);else{const E=this.apiClient.getApiKey();let R="BidiGenerateContent",D="key";E!=null&&E.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),R="BidiGenerateContentConstrained",D="access_token"),u=`${c}/ws/google.ai.generativelanguage.${h}.GenerativeService.${R}?${D}=${E}`}let v=()=>{};const y=new Promise(E=>{v=E}),_=t.callbacks,w=function(){var E;(E=_==null?void 0:_.onopen)===null||E===void 0||E.call(_),v({})},x=this.apiClient,C={onopen:w,onmessage:E=>{$it(x,_.onmessage,E)},onerror:(n=_==null?void 0:_.onerror)!==null&&n!==void 0?n:function(E){},onclose:(i=_==null?void 0:_.onclose)!==null&&i!==void 0?i:function(E){}},k=this.webSocketFactory.create(u,Qit(f),C);k.connect(),await y;let P=ee(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const E=this.apiClient.getProject(),R=this.apiClient.getLocation();P=`projects/${E}/locations/${R}/`+P}let A={};this.apiClient.isVertexAI()&&((r=t.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[hm.AUDIO]}:t.config.responseModalities=[hm.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],N=[];for(const E of M)if(this.isCallableTool(E)){const R=E;N.push(await R.tool())}else N.push(E);N.length>0&&(t.config.tools=N);const T={model:P,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?A=cet(this.apiClient,T):A=aet(this.apiClient,T),delete A.config,k.send(JSON.stringify(A)),new Wit(k,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const Kit={turnComplete:!0};class Wit{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let i=[];try{i=Gi(n.turns),t.isVertexAI()||(i=i.map(r=>Mp(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:i,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let i=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?i=n.functionResponses:i=[n.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const s of i){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(Hit)}return{toolResponse:{functionResponses:i}}}sendClientContent(t){t=Object.assign(Object.assign({},Kit),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:get(t)}:n={realtimeInput:det(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Qit(e){const t={};return e.forEach((n,i)=>{t[i]=n}),t}function Yit(e){const t=new Headers;for(const[n,i]of Object.entries(e))t.append(n,i);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const q1=10;function j1(e){var t,n,i;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let r=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if($c(o)){r=!0;break}if(!r)return!0;const s=(i=e==null?void 0:e.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function $c(e){return"callTool"in e&&typeof e.callTool=="function"}function Jit(e){var t,n,i;return(i=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(r=>$c(r)))!==null&&i!==void 0?i:!1}function F1(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((i,r)=>{if($c(i))return;const s=i;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(r)}),n}function U1(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xit extends js{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var i,r,s,o,a;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!Jit(n)||j1(n.config))return await this.generateContentInternal(c);const h=F1(n);if(h.length>0){const _=h.map(w=>`tools[${w}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${_}.`)}let u,d;const f=Gi(c.contents),v=(s=(r=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:q1;let y=0;for(;y<v&&(u=await this.generateContentInternal(c),!(!u.functionCalls||u.functionCalls.length===0));){const _=u.candidates[0].content,w=[];for(const x of(a=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if($c(x)){const k=await x.callTool(u.functionCalls);w.push(...k)}y++,d={role:"user",parts:w},c.contents=Gi(c.contents),c.contents.push(_),c.contents.push(d),U1(c.config)&&(f.push(_),f.push(d))}return U1(c.config)&&(u.automaticFunctionCallingHistory=f),u},this.generateContentStream=async n=>{var i,r,s,o,a;if(this.maybeMoveToResponseJsonSchem(n),j1(n.config)){const d=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(d)}const c=F1(n);if(c.length>0){const d=c.map(f=>`tools[${f}]`).join(", ");throw new Error(`Incompatible tools found at ${d}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(s=(r=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,u=(a=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(h&&!u)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(i=>{var r;let s;const o=[];if(i!=null&&i.generatedImages)for(const c of i.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((r=c==null?void 0:c.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?s=c==null?void 0:c.safetyAttributes:o.push(c);let a;return s?a={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async n=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Ka(Rs.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async n=>{const i={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(i.referenceImages=n.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async n=>{let i={numberOfImages:1,mode:"upscale"};n.config&&(i=Object.assign(Object.assign({},i),n.config));const r={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async n=>{var i,r,s,o,a,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=n.video)===null||i===void 0)&&i.uri&&(!((r=n.video)===null||r===void 0)&&r.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(s=n.source)===null||s===void 0?void 0:s.video)===null||o===void 0)&&o.uri&&(!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,i,r;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async c=>$c(c)?await c.tool():c)),a={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(a.config.tools=o,t.config&&t.config.tools&&Iq(t.config.tools)){const c=(r=(i=t.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let h=Object.assign({},c);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),Aq(h),a.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return a}async initAfcToolsMap(t){var n,i,r;const s=new Map;for(const o of(i=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&i!==void 0?i:[])if($c(o)){const a=o,c=await a.tool();for(const h of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!h.name)throw new Error("Function declaration name is required.");if(s.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);s.set(h.name,a)}}return s}async processAfcStream(t){var n,i,r;const s=(r=(i=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:q1;let o=!1,a=0;const c=await this.initAfcToolsMap(t);return function(h,u,d){return wr(this,arguments,function*(){for(var f,v,y,_,w,x;a<s;){o&&(a++,o=!1);const A=yield Lt(h.processParamsMaybeAddMcpUsage(d)),M=yield Lt(h.generateContentStreamInternal(A)),N=[],T=[];try{for(var C=!0,k=(v=void 0,br(M)),P;P=yield Lt(k.next()),f=P.done,!f;C=!0){_=P.value,C=!1;const E=_;if(yield yield Lt(E),E.candidates&&(!((w=E.candidates[0])===null||w===void 0)&&w.content)){T.push(E.candidates[0].content);for(const R of(x=E.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<s&&R.functionCall){if(!R.functionCall.name)throw new Error("Function call name was not returned by the model.");if(u.has(R.functionCall.name)){const D=yield Lt(u.get(R.functionCall.name).callTool([R.functionCall]));N.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${u.keys()}, mising tool: ${R.functionCall.name}`)}}}}catch(E){v={error:E}}finally{try{!C&&!f&&(y=k.return)&&(yield Lt(y.call(k)))}finally{if(v)throw v.error}}if(N.length>0){o=!0;const E=new gh;E.candidates=[{content:{role:"user",parts:N}}],yield yield Lt(E);const R=[];R.push(...T),R.push({role:"user",parts:N});const D=Gi(d.contents).concat(R);d.contents=D}else break}})}(this,c,t)}async generateContentInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=M1(this.apiClient,t);return a=gt("{model}:generateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=L1(u),f=new gh;return Object.assign(f,d),f})}else{const h=P1(this.apiClient,t);return a=gt("{model}:generateContent",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=D1(u),f=new gh;return Object.assign(f,d),f})}}async generateContentStreamInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=M1(this.apiClient,t);return a=gt("{model}:streamGenerateContent?alt=sse",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(d){return wr(this,arguments,function*(){var f,v,y,_;try{for(var w=!0,x=br(d),C;C=yield Lt(x.next()),f=C.done,!f;w=!0){_=C.value,w=!1;const k=_,P=L1(yield Lt(k.json()));P.sdkHttpResponse={headers:k.headers};const A=new gh;Object.assign(A,P),yield yield Lt(A)}}catch(k){v={error:k}}finally{try{!w&&!f&&(y=x.return)&&(yield Lt(y.call(x)))}finally{if(v)throw v.error}}})})}else{const h=P1(this.apiClient,t);return a=gt("{model}:streamGenerateContent?alt=sse",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(d){return wr(this,arguments,function*(){var f,v,y,_;try{for(var w=!0,x=br(d),C;C=yield Lt(x.next()),f=C.done,!f;w=!0){_=C.value,w=!1;const k=_,P=D1(yield Lt(k.json()));P.sdkHttpResponse={headers:k.headers};const A=new gh;Object.assign(A,P),yield yield Lt(A)}}catch(k){v={error:k}}finally{try{!w&&!f&&(y=x.return)&&(yield Lt(y.call(x)))}finally{if(v)throw v.error}}})})}}async embedContent(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=zet(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Wet(u),f=new m1;return Object.assign(f,d),f})}else{const h=$et(this.apiClient,t);return a=gt("{model}:batchEmbedContents",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Ket(u),f=new m1;return Object.assign(f,d),f})}}async generateImagesInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=snt(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ant(u),f=new p1;return Object.assign(f,d),f})}else{const h=rnt(this.apiClient,t);return a=gt("{model}:predict",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ont(u),f=new p1;return Object.assign(f,d),f})}}async editImageInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Oet(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=Bet(c),u=new KX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=sit(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=oit(c),u=new WX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Unt(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Ont(c),u=new QX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Knt(this.apiClient,t);return s=gt("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Wnt(c),u=new YX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Cnt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>E0(u))}else{const h=Tnt(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>N0(u))}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Mnt(this.apiClient,t);return a=gt("{models_url}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Lnt(u),f=new v1;return Object.assign(f,d),f})}else{const h=Pnt(this.apiClient,t);return a=gt("{models_url}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Dnt(u),f=new v1;return Object.assign(f,d),f})}}async update(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=iit(this.apiClient,t);return a=gt("{model}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>E0(u))}else{const h=nit(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>N0(u))}}async delete(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=qet(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Fet(u),f=new y1;return Object.assign(f,d),f})}else{const h=Vet(this.apiClient,t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=jet(u),f=new y1;return Object.assign(f,d),f})}}async countTokens(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=Met(this.apiClient,t);return a=gt("{model}:countTokens",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Let(u),f=new x1;return Object.assign(f,d),f})}else{const h=Pet(this.apiClient,t);return a=gt("{model}:countTokens",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=Det(u),f=new x1;return Object.assign(f,d),f})}}async computeTokens(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=Cet(this.apiClient,t);return s=gt("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>{const h=ket(c),u=new JX;return Object.assign(u,h),u})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=gnt(this.apiClient,t);return a=gt("{model}:predictLongRunning",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o.then(u=>{const d=unt(u),f=new um;return Object.assign(f,d),f})}else{const h=dnt(this.apiClient,t);return a=gt("{model}:predictLongRunning",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o.then(u=>{const d=hnt(u),f=new um;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zit extends js{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let s;i&&"httpOptions"in i&&(s=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(t){const n=t.operation,i=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let s;i&&"httpOptions"in i&&(s=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:i});return n._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=OX(t);return a=gt("{operationName}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),o}else{const h=UX(t);return a=gt("{operationName}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),o}}async fetchPredictVideosOperationInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=MX(t);return s=gt("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function trt(e){const t={},n=g(e,["data"]);if(n!=null&&m(t,["data"],n),g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function ert(e){const t={},n=g(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>hrt(s))),m(t,["parts"],r)}const i=g(e,["role"]);return i!=null&&m(t,["role"],i),t}function nrt(e,t,n){const i={},r=g(t,["expireTime"]);n!==void 0&&r!=null&&m(n,["expireTime"],r);const s=g(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&m(n,["newSessionExpireTime"],s);const o=g(t,["uses"]);n!==void 0&&o!=null&&m(n,["uses"],o);const a=g(t,["liveConnectConstraints"]);n!==void 0&&a!=null&&m(n,["bidiGenerateContentSetup"],lrt(e,a));const c=g(t,["lockAdditionalFields"]);return n!==void 0&&c!=null&&m(n,["fieldMask"],c),i}function irt(e,t){const n={},i=g(t,["config"]);return i!=null&&m(n,["config"],nrt(e,i,n)),n}function rrt(e){const t={};if(g(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=g(e,["fileUri"]);n!=null&&m(t,["fileUri"],n);const i=g(e,["mimeType"]);return i!=null&&m(t,["mimeType"],i),t}function srt(e){const t={},n=g(e,["id"]);n!=null&&m(t,["id"],n);const i=g(e,["args"]);i!=null&&m(t,["args"],i);const r=g(e,["name"]);if(r!=null&&m(t,["name"],r),g(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function ort(e){const t={};if(g(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=g(e,["enableWidget"]);return n!=null&&m(t,["enableWidget"],n),t}function art(e){const t={};if(g(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=g(e,["timeRangeFilter"]);return n!=null&&m(t,["timeRangeFilter"],n),t}function crt(e,t){const n={},i=g(e,["generationConfig"]);t!==void 0&&i!=null&&m(t,["setup","generationConfig"],i);const r=g(e,["responseModalities"]);t!==void 0&&r!=null&&m(t,["setup","generationConfig","responseModalities"],r);const s=g(e,["temperature"]);t!==void 0&&s!=null&&m(t,["setup","generationConfig","temperature"],s);const o=g(e,["topP"]);t!==void 0&&o!=null&&m(t,["setup","generationConfig","topP"],o);const a=g(e,["topK"]);t!==void 0&&a!=null&&m(t,["setup","generationConfig","topK"],a);const c=g(e,["maxOutputTokens"]);t!==void 0&&c!=null&&m(t,["setup","generationConfig","maxOutputTokens"],c);const h=g(e,["mediaResolution"]);t!==void 0&&h!=null&&m(t,["setup","generationConfig","mediaResolution"],h);const u=g(e,["seed"]);t!==void 0&&u!=null&&m(t,["setup","generationConfig","seed"],u);const d=g(e,["speechConfig"]);t!==void 0&&d!=null&&m(t,["setup","generationConfig","speechConfig"],zb(d));const f=g(e,["thinkingConfig"]);t!==void 0&&f!=null&&m(t,["setup","generationConfig","thinkingConfig"],f);const v=g(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&m(t,["setup","generationConfig","enableAffectiveDialog"],v);const y=g(e,["systemInstruction"]);t!==void 0&&y!=null&&m(t,["setup","systemInstruction"],ert(Ln(y)));const _=g(e,["tools"]);if(t!==void 0&&_!=null){let M=Dl(_);Array.isArray(M)&&(M=M.map(N=>drt(Ml(N)))),m(t,["setup","tools"],M)}const w=g(e,["sessionResumption"]);t!==void 0&&w!=null&&m(t,["setup","sessionResumption"],urt(w));const x=g(e,["inputAudioTranscription"]);t!==void 0&&x!=null&&m(t,["setup","inputAudioTranscription"],x);const C=g(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&m(t,["setup","outputAudioTranscription"],C);const k=g(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&m(t,["setup","realtimeInputConfig"],k);const P=g(e,["contextWindowCompression"]);t!==void 0&&P!=null&&m(t,["setup","contextWindowCompression"],P);const A=g(e,["proactivity"]);if(t!==void 0&&A!=null&&m(t,["setup","proactivity"],A),g(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function lrt(e,t){const n={},i=g(t,["model"]);i!=null&&m(n,["setup","model"],ee(e,i));const r=g(t,["config"]);return r!=null&&m(n,["config"],crt(r,n)),n}function hrt(e){const t={},n=g(e,["mediaResolution"]);n!=null&&m(t,["mediaResolution"],n);const i=g(e,["codeExecutionResult"]);i!=null&&m(t,["codeExecutionResult"],i);const r=g(e,["executableCode"]);r!=null&&m(t,["executableCode"],r);const s=g(e,["fileData"]);s!=null&&m(t,["fileData"],rrt(s));const o=g(e,["functionCall"]);o!=null&&m(t,["functionCall"],srt(o));const a=g(e,["functionResponse"]);a!=null&&m(t,["functionResponse"],a);const c=g(e,["inlineData"]);c!=null&&m(t,["inlineData"],trt(c));const h=g(e,["text"]);h!=null&&m(t,["text"],h);const u=g(e,["thought"]);u!=null&&m(t,["thought"],u);const d=g(e,["thoughtSignature"]);d!=null&&m(t,["thoughtSignature"],d);const f=g(e,["videoMetadata"]);return f!=null&&m(t,["videoMetadata"],f),t}function urt(e){const t={},n=g(e,["handle"]);if(n!=null&&m(t,["handle"],n),g(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function drt(e){const t={};if(g(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=g(e,["computerUse"]);n!=null&&m(t,["computerUse"],n);const i=g(e,["fileSearch"]);i!=null&&m(t,["fileSearch"],i);const r=g(e,["codeExecution"]);if(r!=null&&m(t,["codeExecution"],r),g(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=g(e,["functionDeclarations"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>d)),m(t,["functionDeclarations"],u)}const o=g(e,["googleMaps"]);o!=null&&m(t,["googleMaps"],ort(o));const a=g(e,["googleSearch"]);a!=null&&m(t,["googleSearch"],art(a));const c=g(e,["googleSearchRetrieval"]);c!=null&&m(t,["googleSearchRetrieval"],c);const h=g(e,["urlContext"]);return h!=null&&m(t,["urlContext"],h),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function grt(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(s=>`${n}.${s}`);t.push(...r)}else t.push(n)}return t.join(",")}function frt(e,t){let n=null;const i=e.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const s=i.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else i!==void 0&&delete e.bidiGenerateContentSetup;const r=e.fieldMask;if(n){const s=grt(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];r.length>0&&(a=r.map(h=>o.includes(h)?`generationConfig.${h}`:h));const c=[];s&&c.push(s),a.length>0&&c.push(...a),c.length>0?e.fieldMask=c.join(","):delete e.fieldMask}else delete e.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?e.fieldMask=r.join(","):delete e.fieldMask;return e}class mrt extends js{constructor(t){super(),this.apiClient=t}async create(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=irt(this.apiClient,t);s=gt("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const c=frt(a,t.config);return r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),r.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function prt(e,t){const n={},i=g(e,["force"]);return t!==void 0&&i!=null&&m(t,["_query","force"],i),n}function vrt(e){const t={},n=g(e,["name"]);n!=null&&m(t,["_url","name"],n);const i=g(e,["config"]);return i!=null&&prt(i,t),t}function yrt(e){const t={},n=g(e,["name"]);return n!=null&&m(t,["_url","name"],n),t}function xrt(e,t){const n={},i=g(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=g(e,["pageToken"]);return t!==void 0&&r!=null&&m(t,["_query","pageToken"],r),n}function _rt(e){const t={},n=g(e,["parent"]);n!=null&&m(t,["_url","parent"],n);const i=g(e,["config"]);return i!=null&&xrt(i,t),t}function wrt(e){const t={},n=g(e,["sdkHttpResponse"]);n!=null&&m(t,["sdkHttpResponse"],n);const i=g(e,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=g(e,["documents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),m(t,["documents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class brt extends js{constructor(t){super(),this.apiClient=t,this.list=async n=>new Ka(Rs.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:n.parent,config:i.config}),await this.listInternal(n),n)}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yrt(t);return s=gt("{name}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=vrt(t);r=gt("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=_rt(t);return s=gt("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=wrt(c),u=new XX;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Trt extends js{constructor(t,n=new brt(t)){super(),this.apiClient=t,this.documents=n,this.list=async(i={})=>new Ka(Rs.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=git(t);return s=gt("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async get(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pit(t);return s=gt("{name}",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(t){var n,i;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=mit(t);r=gt("{name}",o._url),s=o._query,delete o._url,delete o._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=bit(t);return s=gt("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=Tit(c),u=new ZX;return Object.assign(u,h),u})}}async uploadToFileSearchStoreInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Cit(t);return s=gt("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=kit(c),u=new tZ;return Object.assign(u,h),u})}}async importFile(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xit(t);return s=gt("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{const h=yit(c),u=new Ob;return Object.assign(u,h),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Rq=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return Rq=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^n()&15>>+i/4).toString(16))};const Crt=()=>Rq();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I0(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const A0=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qi extends Error{}class Wn extends Qi{constructor(t,n,i,r){super(`${Wn.makeMessage(t,n,i)}`),this.status=t,this.headers=r,this.error=n}static makeMessage(t,n,i){const r=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):i;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,n,i,r){if(!t||!r)return new Vp({message:i,cause:A0(n)});const s=n;return t===400?new Mq(t,s,i,r):t===401?new Dq(t,s,i,r):t===403?new Lq(t,s,i,r):t===404?new Vq(t,s,i,r):t===409?new qq(t,s,i,r):t===422?new jq(t,s,i,r):t===429?new Fq(t,s,i,r):t>=500?new Uq(t,s,i,r):new Wn(t,s,i,r)}}class R0 extends Wn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Vp extends Wn{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class Pq extends Vp{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Mq extends Wn{}class Dq extends Wn{}class Lq extends Wn{}class Vq extends Wn{}class qq extends Wn{}class jq extends Wn{}class Fq extends Wn{}class Uq extends Wn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const krt=/^[a-z][a-z0-9+.-]*:/i,Nrt=e=>krt.test(e);let P0=e=>(P0=Array.isArray,P0(e));const Ert=P0;let Srt=Ert;const O1=Srt;function Irt(e){if(!e)return!0;for(const t in e)return!1;return!0}function Art(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Rrt=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Qi(`${e} must be an integer`);if(t<0)throw new Qi(`${e} must be a positive integer`);return t},Prt=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mrt=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oc="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Drt(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Lrt=()=>{var e,t,n,i,r;const s=Drt();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":oc,"X-Stainless-OS":G1(Deno.build.os),"X-Stainless-Arch":B1(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":oc,"X-Stainless-OS":G1((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":B1((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const o=Vrt();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Vrt(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const i=n.exec(navigator.userAgent);if(i){const r=i[1]||0,s=i[2]||0,o=i[3]||0;return{browser:t,version:`${r}.${s}.${o}`}}}return null}const B1=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",G1=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let cg;const qrt=()=>cg??(cg=Lrt());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jrt(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Oq(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function Frt(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return Oq({start(){},async pull(n){const{done:i,value:r}=await t.next();i?n.close():n.enqueue(r)},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}function Bq(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Urt(e){var t,n;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((n=(t=e[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(t));return}const i=e.getReader(),r=i.cancel();i.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ort=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gq=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ly(e,t,n){return Gq(),new File(e,t??"unknown_file",n)}function Brt(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Grt=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hq=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Hrt=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Hq(e),$rt=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function zrt(e,t,n){if(Gq(),e=await e,Hrt(e))return e instanceof File?e:ly([await e.arrayBuffer()],e.name);if($rt(e)){const r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),ly(await M0(r),t,n)}const i=await M0(e);if(t||(t=Brt(e)),!(n!=null&&n.type)){const r=i.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof r=="string"&&(n=Object.assign(Object.assign({},n),{type:r}))}return ly(i,t,n)}async function M0(e){var t,n,i,r,s;let o=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)o.push(e);else if(Hq(e))o.push(e instanceof Blob?e:await e.arrayBuffer());else if(Grt(e))try{for(var a=!0,c=br(e),h;h=await c.next(),t=h.done,!t;a=!0){r=h.value,a=!1;const u=r;o.push(...await M0(u))}}catch(u){n={error:u}}finally{try{!a&&!t&&(i=c.return)&&await i.call(c)}finally{if(n)throw n.error}}else{const u=(s=e==null?void 0:e.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${u?`; constructor: ${u}`:""}${Krt(e)}`)}return o}function Krt(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $q{constructor(t){this._client=t}}$q._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zq(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const H1=Object.freeze(Object.create(null)),Wrt=(e=zq)=>function(n,...i){if(n.length===1)return n[0];let r=!1;const s=[],o=n.reduce((u,d,f)=>{var v,y,_;/[?#]/.test(d)&&(r=!0);const w=i[f];let x=(r?encodeURIComponent:e)(""+w);return f!==i.length&&(w==null||typeof w=="object"&&w.toString===((_=Object.getPrototypeOf((y=Object.getPrototypeOf((v=w.hasOwnProperty)!==null&&v!==void 0?v:H1))!==null&&y!==void 0?y:H1))===null||_===void 0?void 0:_.toString))&&(x=w+"",s.push({start:u.length+d.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(w).slice(8,-1)} is not a valid path parameter`})),u+d+(f===i.length?"":x)},""),a=o.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=c.exec(a))!==null;)s.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(s.sort((u,d)=>u.start-d.start),s.length>0){let u=0;const d=s.reduce((f,v)=>{const y=" ".repeat(v.start-u),_="^".repeat(v.length);return u=v.start+v.length,f+y+_},"");throw new Qi(`Path parameters result in path with invalid segments:
${s.map(f=>f.error).join(`
`)}
${o}
${d}`)}return o},lg=Wrt(zq);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kq extends $q{create(t,n){var i;const{api_version:r=this._client.apiVersion}=t,s=gm(t,["api_version"]);if("model"in s&&"agent_config"in s)throw new Qi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new Qi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(lg`/${r}/interactions`,Object.assign(Object.assign({body:s},n),{stream:(i=t.stream)!==null&&i!==void 0?i:!1}))}delete(t,n={},i){const{api_version:r=this._client.apiVersion}=n??{};return this._client.delete(lg`/${r}/interactions/${t}`,i)}cancel(t,n={},i){const{api_version:r=this._client.apiVersion}=n??{};return this._client.post(lg`/${r}/interactions/${t}/cancel`,i)}get(t,n={},i){var r;const s=n??{},{api_version:o=this._client.apiVersion}=s,a=gm(s,["api_version"]);return this._client.get(lg`/${o}/interactions/${t}`,Object.assign(Object.assign({query:a},i),{stream:(r=n==null?void 0:n.stream)!==null&&r!==void 0?r:!1}))}}Kq._key=Object.freeze(["interactions"]);class Wq extends Kq{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qrt(e){let t=0;for(const r of e)t+=r.length;const n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}let hg;function Wb(e){let t;return(hg??(t=new globalThis.TextEncoder,hg=t.encode.bind(t)))(e)}let ug;function $1(e){let t;return(ug??(t=new globalThis.TextDecoder,ug=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qp{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Wb(t):t;this.buffer=Qrt([this.buffer,n]);const i=[];let r;for(;(r=Yrt(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push($1(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,o=$1(this.buffer.subarray(0,s));i.push(o),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}qp.NEWLINE_CHARS=new Set([`
`,"\r"]);qp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Yrt(e,t){for(let r=t??0;r<e.length;r++){if(e[r]===10)return{preceding:r,index:r+1,carriage:!1};if(e[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Jrt(e){for(let i=0;i<e.length-1;i++){if(e[i]===10&&e[i+1]===10||e[i]===13&&e[i+1]===13)return i+2;if(e[i]===13&&e[i+1]===10&&i+3<e.length&&e[i+2]===13&&e[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fm={off:0,error:200,warn:300,info:400,debug:500},z1=(e,t,n)=>{if(e){if(Art(fm,e))return e;On(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(fm))}`)}};function Ch(){}function dg(e,t,n){return!t||fm[e]>fm[n]?Ch:t[e].bind(t)}const Xrt={error:Ch,warn:Ch,info:Ch,debug:Ch};let K1=new WeakMap;function On(e){var t;const n=e.logger,i=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!n)return Xrt;const r=K1.get(n);if(r&&r[0]===i)return r[1];const s={error:dg("error",n,i),warn:dg("warn",n,i),info:dg("info",n,i),debug:dg("debug",n,i)};return K1.set(n,[i,s]),s}const ra=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tc{constructor(t,n,i){this.iterator=t,this.controller=n,this.client=i}static fromSSEResponse(t,n,i){let r=!1;const s=i?On(i):console;function o(){return wr(this,arguments,function*(){var c,h,u,d;if(r)throw new Qi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let f=!1;try{try{for(var v=!0,y=br(Zrt(t,n)),_;_=yield Lt(y.next()),c=_.done,!c;v=!0){d=_.value,v=!1;const w=d;if(!f)if(w.data.startsWith("[DONE]")){f=!0;continue}else try{yield yield Lt(JSON.parse(w.data))}catch(x){throw s.error("Could not parse message into JSON:",w.data),s.error("From chunk:",w.raw),x}}}catch(w){h={error:w}}finally{try{!v&&!c&&(u=y.return)&&(yield Lt(u.call(y)))}finally{if(h)throw h.error}}f=!0}catch(w){if(I0(w))return yield Lt(void 0);throw w}finally{f||n.abort()}})}return new Tc(o,n,i)}static fromReadableStream(t,n,i){let r=!1;function s(){return wr(this,arguments,function*(){var c,h,u,d;const f=new qp,v=Bq(t);try{for(var y=!0,_=br(v),w;w=yield Lt(_.next()),c=w.done,!c;y=!0){d=w.value,y=!1;const x=d;for(const C of f.decode(x))yield yield Lt(C)}}catch(x){h={error:x}}finally{try{!y&&!c&&(u=_.return)&&(yield Lt(u.call(_)))}finally{if(h)throw h.error}}for(const x of f.flush())yield yield Lt(x)})}function o(){return wr(this,arguments,function*(){var c,h,u,d;if(r)throw new Qi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let f=!1;try{try{for(var v=!0,y=br(s()),_;_=yield Lt(y.next()),c=_.done,!c;v=!0){d=_.value,v=!1;const w=d;f||w&&(yield yield Lt(JSON.parse(w)))}}catch(w){h={error:w}}finally{try{!v&&!c&&(u=y.return)&&(yield Lt(u.call(y)))}finally{if(h)throw h.error}}f=!0}catch(w){if(I0(w))return yield Lt(void 0);throw w}finally{f||n.abort()}})}return new Tc(o,n,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],i=this.iterator(),r=s=>({next:()=>{if(s.length===0){const o=i.next();t.push(o),n.push(o)}return s.shift()}});return[new Tc(()=>r(t),this.controller,this.client),new Tc(()=>r(n),this.controller,this.client)]}toReadableStream(){const t=this;let n;return Oq({async start(){n=t[Symbol.asyncIterator]()},async pull(i){try{const{value:r,done:s}=await n.next();if(s)return i.close();const o=Wb(JSON.stringify(r)+`
`);i.enqueue(o)}catch(r){i.error(r)}},async cancel(){var i;await((i=n.return)===null||i===void 0?void 0:i.call(n))}})}}function Zrt(e,t){return wr(this,arguments,function*(){var i,r,s,o;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Qi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Qi("Attempted to iterate over a response with no body");const a=new est,c=new qp,h=Bq(e.body);try{for(var u=!0,d=br(tst(h)),f;f=yield Lt(d.next()),i=f.done,!i;u=!0){o=f.value,u=!1;const v=o;for(const y of c.decode(v)){const _=a.decode(y);_&&(yield yield Lt(_))}}}catch(v){r={error:v}}finally{try{!u&&!i&&(s=d.return)&&(yield Lt(s.call(d)))}finally{if(r)throw r.error}}for(const v of c.flush()){const y=a.decode(v);y&&(yield yield Lt(y))}})}function tst(e){return wr(this,arguments,function*(){var n,i,r,s;let o=new Uint8Array;try{for(var a=!0,c=br(e),h;h=yield Lt(c.next()),n=h.done,!n;a=!0){s=h.value,a=!1;const u=s;if(u==null)continue;const d=u instanceof ArrayBuffer?new Uint8Array(u):typeof u=="string"?Wb(u):u;let f=new Uint8Array(o.length+d.length);f.set(o),f.set(d,o.length),o=f;let v;for(;(v=Jrt(o))!==-1;)yield yield Lt(o.slice(0,v)),o=o.slice(v)}}catch(u){i={error:u}}finally{try{!a&&!n&&(r=c.return)&&(yield Lt(r.call(c)))}finally{if(i)throw i.error}}o.length>0&&(yield yield Lt(o))})}class est{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,i,r]=nst(t,":");return r.startsWith(" ")&&(r=r.substring(1)),n==="event"?this.event=r:n==="data"&&this.data.push(r),null}}function nst(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function ist(e,t){const{response:n,requestLogID:i,retryOfRequestLogID:r,startTime:s}=t,o=await(async()=>{var a;if(t.options.stream)return On(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Tc.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const c=n.headers.get("content-type"),h=(a=c==null?void 0:c.split(";")[0])===null||a===void 0?void 0:a.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?await n.json():await n.text()})();return On(e).debug(`[${i}] response parsed`,ra({retryOfRequestLogID:r,url:n.url,status:n.status,body:o,durationMs:Date.now()-s})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qb extends Promise{constructor(t,n,i=ist){super(r=>{r(null)}),this.responsePromise=n,this.parseResponse=i,this.client=t}_thenUnwrap(t){return new Qb(this.client,this.responsePromise,async(n,i)=>t(await this.parseResponse(n,i),i))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qq=Symbol("brand.privateNullableHeaders");function*rst(e){if(!e)return;if(Qq in e){const{values:i,nulls:r}=e;yield*i.entries();for(const s of r)yield[s,null];return}let t=!1,n;e instanceof Headers?n=e.entries():O1(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let i of n){const r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const s=O1(i[1])?i[1]:[i[1]];let o=!1;for(const a of s)a!==void 0&&(t&&!o&&(o=!0,yield[r,null]),yield[r,a])}}const fh=e=>{const t=new Headers,n=new Set;for(const i of e){const r=new Set;for(const[s,o]of rst(i)){const a=s.toLowerCase();r.has(a)||(t.delete(s),r.add(a)),o===null?(t.delete(s),n.add(a)):(t.append(s,o),n.delete(a))}}return{[Qq]:!0,values:t,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hy=e=>{var t,n,i,r,s,o;if(typeof globalThis.process<"u")return(i=(n=(t=EX)===null||t===void 0?void 0:t[e])===null||n===void 0?void 0:n.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(o=(s=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||s===void 0?void 0:s.call(r,e))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yq;class jp{constructor(t){var n,i,r,s,o,a,c,{baseURL:h=hy("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=(n=hy("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:d="v1beta"}=t,f=gm(t,["baseURL","apiKey","apiVersion"]);const v=Object.assign(Object.assign({apiKey:u,apiVersion:d},f),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=v.baseURL,this.timeout=(i=v.timeout)!==null&&i!==void 0?i:jp.DEFAULT_TIMEOUT,this.logger=(r=v.logger)!==null&&r!==void 0?r:console;const y="warn";this.logLevel=y,this.logLevel=(o=(s=z1(v.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:z1(hy("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:y,this.fetchOptions=v.fetchOptions,this.maxRetries=(a=v.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(c=v.fetch)!==null&&c!==void 0?c:jrt(),this.encoder=Ort,this._options=v,this.apiKey=u,this.apiVersion=d,this.clientAdapter=v.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const n=fh([t.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return fh([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return fh([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([n,i])=>typeof i<"u").map(([n,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(n)}=`;throw new Qi(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${oc}`}defaultIdempotencyKey(){return`stainless-node-retry-${Crt()}`}makeStatusError(t,n,i,r){return Wn.generate(t,n,i,r)}buildURL(t,n,i){const r=!this.baseURLOverridden()&&i||this.baseURL,s=Nrt(t)?new URL(t):new URL(r+(r.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return Irt(o)||(n=Object.assign(Object.assign({},o),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(s.search=this.stringifyQuery(n)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const n=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(t,{url:n,options:i}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,i){return this.request(Promise.resolve(i).then(r=>Object.assign({method:t,path:n},r)))}request(t,n=null){return new Qb(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,i){var r,s,o;const a=await t,c=(r=a.maxRetries)!==null&&r!==void 0?r:this.maxRetries;n==null&&(n=c),await this.prepareOptions(a);const{req:h,url:u,timeout:d}=await this.buildRequest(a,{retryCount:c-n});await this.prepareRequest(h,{url:u,options:a});const f="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),v=i===void 0?"":`, retryOf: ${i}`,y=Date.now();if(On(this).debug(`[${f}] sending request`,ra({retryOfRequestLogID:i,method:a.method,url:u,options:a,headers:h.headers})),!((s=a.signal)===null||s===void 0)&&s.aborted)throw new R0;const _=new AbortController,w=await this.fetchWithTimeout(u,h,d,_).catch(A0),x=Date.now();if(w instanceof globalThis.Error){const k=`retrying, ${n} attempts remaining`;if(!((o=a.signal)===null||o===void 0)&&o.aborted)throw new R0;const P=I0(w)||/timed? ?out/i.test(String(w)+("cause"in w?String(w.cause):""));if(n)return On(this).info(`[${f}] connection ${P?"timed out":"failed"} - ${k}`),On(this).debug(`[${f}] connection ${P?"timed out":"failed"} (${k})`,ra({retryOfRequestLogID:i,url:u,durationMs:x-y,message:w.message})),this.retryRequest(a,n,i??f);throw On(this).info(`[${f}] connection ${P?"timed out":"failed"} - error; no more retries left`),On(this).debug(`[${f}] connection ${P?"timed out":"failed"} (error; no more retries left)`,ra({retryOfRequestLogID:i,url:u,durationMs:x-y,message:w.message})),P?new Pq:new Vp({cause:w})}const C=`[${f}${v}] ${h.method} ${u} ${w.ok?"succeeded":"failed"} with status ${w.status} in ${x-y}ms`;if(!w.ok){const k=await this.shouldRetry(w);if(n&&k){const E=`retrying, ${n} attempts remaining`;return await Urt(w.body),On(this).info(`${C} - ${E}`),On(this).debug(`[${f}] response error (${E})`,ra({retryOfRequestLogID:i,url:w.url,status:w.status,headers:w.headers,durationMs:x-y})),this.retryRequest(a,n,i??f,w.headers)}const P=k?"error; no more retries left":"error; not retryable";On(this).info(`${C} - ${P}`);const A=await w.text().catch(E=>A0(E).message),M=Prt(A),N=M?void 0:A;throw On(this).debug(`[${f}] response error (${P})`,ra({retryOfRequestLogID:i,url:w.url,status:w.status,headers:w.headers,message:N,durationMs:Date.now()-y})),this.makeStatusError(w.status,M,N,w.headers)}return On(this).info(C),On(this).debug(`[${f}] response start`,ra({retryOfRequestLogID:i,url:w.url,status:w.status,headers:w.headers,durationMs:x-y})),{response:w,options:a,controller:_,requestLogID:f,retryOfRequestLogID:i,startTime:y}}async fetchWithTimeout(t,n,i,r){const s=n||{},{signal:o,method:a}=s,c=gm(s,["signal","method"]);o&&o.addEventListener("abort",()=>r.abort());const h=setTimeout(()=>r.abort(),i),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,d=Object.assign(Object.assign(Object.assign({signal:r.signal},u?{duplex:"half"}:{}),{method:"GET"}),c);a&&(d.method=a.toUpperCase());try{return await this.fetch.call(void 0,t,d)}finally{clearTimeout(h)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,i,r){var s;let o;const a=r==null?void 0:r.get("retry-after-ms");if(a){const h=parseFloat(a);Number.isNaN(h)||(o=h)}const c=r==null?void 0:r.get("retry-after");if(c&&!o){const h=parseFloat(c);Number.isNaN(h)?o=Date.parse(c)-Date.now():o=h*1e3}if(!(o&&0<=o&&o<60*1e3)){const h=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,h)}return await Mrt(o),this.makeRequest(t,n-1,i)}calculateDefaultRetryTimeoutMillis(t,n){const s=n-t,o=Math.min(.5*Math.pow(2,s),8),a=1-Math.random()*.25;return o*a*1e3}async buildRequest(t,{retryCount:n=0}={}){var i,r,s;const o=Object.assign({},t),{method:a,path:c,query:h,defaultBaseURL:u}=o,d=this.buildURL(c,h,u);"timeout"in o&&Rrt("timeout",o.timeout),o.timeout=(i=o.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:f,body:v}=this.buildBody({options:o}),y=await this.buildHeaders({options:t,method:a,bodyHeaders:f,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:y},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&v instanceof globalThis.ReadableStream&&{duplex:"half"}),v&&{body:v}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(s=o.fetchOptions)!==null&&s!==void 0?s:{}),url:d,timeout:o.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:i,retryCount:r}){let s={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const o=await this.authHeaders(t);let a=fh([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),qrt()),this._options.defaultHeaders,i,t.headers,o]);return this.validateHeaders(a),a.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const i=fh([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&i.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:Frt(t)}:this.encoder({body:t,headers:i})}}jp.DEFAULT_TIMEOUT=6e4;class vn extends jp{constructor(){super(...arguments),this.interactions=new Wq(this)}}Yq=vn;vn.GeminiNextGenAPIClient=Yq;vn.GeminiNextGenAPIClientError=Qi;vn.APIError=Wn;vn.APIConnectionError=Vp;vn.APIConnectionTimeoutError=Pq;vn.APIUserAbortError=R0;vn.NotFoundError=Vq;vn.ConflictError=qq;vn.RateLimitError=Fq;vn.BadRequestError=Mq;vn.AuthenticationError=Dq;vn.InternalServerError=Uq;vn.PermissionDeniedError=Lq;vn.UnprocessableEntityError=jq;vn.toFile=zrt;vn.Interactions=Wq;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sst(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function ost(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function ast(e,t){const n={},i=g(e,["sdkHttpResponse"]);return i!=null&&m(n,["sdkHttpResponse"],i),n}function cst(e,t){const n={},i=g(e,["sdkHttpResponse"]);return i!=null&&m(n,["sdkHttpResponse"],i),n}function lst(e,t,n){const i={};if(g(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=g(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&m(t,["displayName"],r),g(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=g(e,["epochCount"]);t!==void 0&&s!=null&&m(t,["tuningTask","hyperparameters","epochCount"],s);const o=g(e,["learningRateMultiplier"]);if(o!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],o),g(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=g(e,["batchSize"]);t!==void 0&&a!=null&&m(t,["tuningTask","hyperparameters","batchSize"],a);const c=g(e,["learningRate"]);if(t!==void 0&&c!=null&&m(t,["tuningTask","hyperparameters","learningRate"],c),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function hst(e,t,n){const i={};let r=g(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const v=g(e,["validationDataset"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec"],W1(v))}else if(r==="PREFERENCE_TUNING"){const v=g(e,["validationDataset"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec"],W1(v))}const s=g(e,["tunedModelDisplayName"]);t!==void 0&&s!=null&&m(t,["tunedModelDisplayName"],s);const o=g(e,["description"]);t!==void 0&&o!=null&&m(t,["description"],o);let a=g(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const v=g(e,["epochCount"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","epochCount"],v)}else if(a==="PREFERENCE_TUNING"){const v=g(e,["epochCount"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],v)}let c=g(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const v=g(e,["learningRateMultiplier"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],v)}else if(c==="PREFERENCE_TUNING"){const v=g(e,["learningRateMultiplier"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],v)}let h=g(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const v=g(e,["exportLastCheckpointOnly"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","exportLastCheckpointOnly"],v)}else if(h==="PREFERENCE_TUNING"){const v=g(e,["exportLastCheckpointOnly"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],v)}let u=g(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const v=g(e,["adapterSize"]);t!==void 0&&v!=null&&m(t,["supervisedTuningSpec","hyperParameters","adapterSize"],v)}else if(u==="PREFERENCE_TUNING"){const v=g(e,["adapterSize"]);t!==void 0&&v!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],v)}if(g(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const d=g(e,["labels"]);t!==void 0&&d!=null&&m(t,["labels"],d);const f=g(e,["beta"]);return t!==void 0&&f!=null&&m(t,["preferenceOptimizationSpec","hyperParameters","beta"],f),i}function ust(e,t){const n={},i=g(e,["baseModel"]);i!=null&&m(n,["baseModel"],i);const r=g(e,["preTunedModel"]);r!=null&&m(n,["preTunedModel"],r);const s=g(e,["trainingDataset"]);s!=null&&bst(s);const o=g(e,["config"]);return o!=null&&lst(o,n),n}function dst(e,t){const n={},i=g(e,["baseModel"]);i!=null&&m(n,["baseModel"],i);const r=g(e,["preTunedModel"]);r!=null&&m(n,["preTunedModel"],r);const s=g(e,["trainingDataset"]);s!=null&&Tst(s,n,t);const o=g(e,["config"]);return o!=null&&hst(o,n,t),n}function gst(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function fst(e,t){const n={},i=g(e,["name"]);return i!=null&&m(n,["_url","name"],i),n}function mst(e,t,n){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&m(t,["_query","pageSize"],r);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=g(e,["filter"]);return t!==void 0&&o!=null&&m(t,["_query","filter"],o),i}function pst(e,t,n){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&m(t,["_query","pageSize"],r);const s=g(e,["pageToken"]);t!==void 0&&s!=null&&m(t,["_query","pageToken"],s);const o=g(e,["filter"]);return t!==void 0&&o!=null&&m(t,["_query","filter"],o),i}function vst(e,t){const n={},i=g(e,["config"]);return i!=null&&mst(i,n),n}function yst(e,t){const n={},i=g(e,["config"]);return i!=null&&pst(i,n),n}function xst(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["nextPageToken"]);r!=null&&m(n,["nextPageToken"],r);const s=g(e,["tunedModels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>Jq(a))),m(n,["tuningJobs"],o)}return n}function _st(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["nextPageToken"]);r!=null&&m(n,["nextPageToken"],r);const s=g(e,["tuningJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>D0(a))),m(n,["tuningJobs"],o)}return n}function wst(e,t){const n={},i=g(e,["name"]);i!=null&&m(n,["model"],i);const r=g(e,["name"]);return r!=null&&m(n,["endpoint"],r),n}function bst(e,t){const n={};if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=g(e,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(s=>s)),m(n,["examples","examples"],r)}return n}function Tst(e,t,n){const i={};let r=g(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=g(e,["gcsUri"]);t!==void 0&&o!=null&&m(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=g(e,["gcsUri"]);t!==void 0&&o!=null&&m(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let s=g(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=g(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&m(t,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=g(e,["vertexDatasetResource"]);t!==void 0&&o!=null&&m(t,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(g(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Jq(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["state"]);s!=null&&m(n,["state"],gq(s));const o=g(e,["createTime"]);o!=null&&m(n,["createTime"],o);const a=g(e,["tuningTask","startTime"]);a!=null&&m(n,["startTime"],a);const c=g(e,["tuningTask","completeTime"]);c!=null&&m(n,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(n,["updateTime"],h);const u=g(e,["description"]);u!=null&&m(n,["description"],u);const d=g(e,["baseModel"]);d!=null&&m(n,["baseModel"],d);const f=g(e,["_self"]);return f!=null&&m(n,["tunedModel"],wst(f)),n}function D0(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["state"]);s!=null&&m(n,["state"],gq(s));const o=g(e,["createTime"]);o!=null&&m(n,["createTime"],o);const a=g(e,["startTime"]);a!=null&&m(n,["startTime"],a);const c=g(e,["endTime"]);c!=null&&m(n,["endTime"],c);const h=g(e,["updateTime"]);h!=null&&m(n,["updateTime"],h);const u=g(e,["error"]);u!=null&&m(n,["error"],u);const d=g(e,["description"]);d!=null&&m(n,["description"],d);const f=g(e,["baseModel"]);f!=null&&m(n,["baseModel"],f);const v=g(e,["tunedModel"]);v!=null&&m(n,["tunedModel"],v);const y=g(e,["preTunedModel"]);y!=null&&m(n,["preTunedModel"],y);const _=g(e,["supervisedTuningSpec"]);_!=null&&m(n,["supervisedTuningSpec"],_);const w=g(e,["preferenceOptimizationSpec"]);w!=null&&m(n,["preferenceOptimizationSpec"],w);const x=g(e,["tuningDataStats"]);x!=null&&m(n,["tuningDataStats"],x);const C=g(e,["encryptionSpec"]);C!=null&&m(n,["encryptionSpec"],C);const k=g(e,["partnerModelTuningSpec"]);k!=null&&m(n,["partnerModelTuningSpec"],k);const P=g(e,["customBaseModel"]);P!=null&&m(n,["customBaseModel"],P);const A=g(e,["experiment"]);A!=null&&m(n,["experiment"],A);const M=g(e,["labels"]);M!=null&&m(n,["labels"],M);const N=g(e,["outputUri"]);N!=null&&m(n,["outputUri"],N);const T=g(e,["pipelineJob"]);T!=null&&m(n,["pipelineJob"],T);const E=g(e,["serviceAccount"]);E!=null&&m(n,["serviceAccount"],E);const R=g(e,["tunedModelDisplayName"]);R!=null&&m(n,["tunedModelDisplayName"],R);const D=g(e,["veoTuningSpec"]);return D!=null&&m(n,["veoTuningSpec"],D),n}function Cst(e,t){const n={},i=g(e,["sdkHttpResponse"]);i!=null&&m(n,["sdkHttpResponse"],i);const r=g(e,["name"]);r!=null&&m(n,["name"],r);const s=g(e,["metadata"]);s!=null&&m(n,["metadata"],s);const o=g(e,["done"]);o!=null&&m(n,["done"],o);const a=g(e,["error"]);return a!=null&&m(n,["error"],a),n}function W1(e,t){const n={},i=g(e,["gcsUri"]);i!=null&&m(n,["validationDatasetUri"],i);const r=g(e,["vertexDatasetResource"]);return r!=null&&m(n,["validationDatasetUri"],r),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kst extends js{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Ka(Rs.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var i;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const r={tunedModelName:n.baseModel};!((i=n.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=n.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},n),{preTunedModel:r});return s.baseModel=void 0,await this.tuneInternal(s)}else{const r=Object.assign({},n);return await this.tuneInternal(r)}else{const r=Object.assign({},n),s=await this.tuneMldevInternal(r);let o="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?o=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(o=s.name.split("/operations/")[0]),{name:o,state:b0.JOB_STATE_QUEUED}}}}async getInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=fst(t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>D0(u))}else{const h=gst(t);return a=gt("{name}",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>Jq(u))}}async listInternal(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=yst(t);return a=gt("tuningJobs",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=_st(u),f=new _1;return Object.assign(f,d),f})}else{const h=vst(t);return a=gt("tunedModels",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=xst(u),f=new _1;return Object.assign(f,d),f})}}async cancel(t){var n,i,r,s;let o,a="",c={};if(this.apiClient.isVertexAI()){const h=ost(t);return a=gt("{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=cst(u),f=new w1;return Object.assign(f,d),f})}else{const h=sst(t);return a=gt("{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,o=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const d=ast(u),f=new w1;return Object.assign(f,d),f})}}async tuneInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI()){const a=dst(t,t);return s=gt("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>D0(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,i;let r,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ust(t);return s=gt("tunedModels",a._url),o=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(i=t.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(h=>{const u=h;return u.sdkHttpResponse={headers:c.headers},u})),r.then(c=>Cst(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nst{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Est=1024*1024*8,Sst=3,Ist=1e3,Ast=2,mm="x-goog-upload-status";async function Rst(e,t,n){var i;const r=await Xq(e,t,n),s=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[mm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function Pst(e,t,n){var i;const r=await Xq(e,t,n),s=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[mm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=aq(s),a=new Bb;return Object.assign(a,o),a}async function Xq(e,t,n){var i,r;let s=0,o=0,a=new T0(new Response),c="upload";for(s=e.size;o<s;){const h=Math.min(Est,s-o),u=e.slice(o,o+h);o+h>=s&&(c+=", finalize");let d=0,f=Ist;for(;d<Sst&&(a=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(o),"Content-Length":String(h)}}}),!(!((i=a==null?void 0:a.headers)===null||i===void 0)&&i[mm]));)d++,await Dst(f),f=f*Ast;if(o+=h,((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[mm])!=="active")break;if(s<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function Mst(e){return{size:e.size,type:e.type}}function Dst(e){return new Promise(t=>setTimeout(t,e))}class Lst{async upload(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Rst(t,n,i)}async uploadToFileSearchStore(t,n,i){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Pst(t,n,i)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Mst(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vst{create(t,n,i){return new qst(t,n,i)}}class qst{constructor(t,n,i){this.url=t,this.headers=n,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Q1="x-goog-api-key";class jst{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(Q1)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Q1,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fst="gl-node/";class Ust{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new vn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=n.interactions,this._interactions}constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const i=RX(t.httpOptions,t.vertexai,void 0,void 0);i&&(t.httpOptions?t.httpOptions.baseUrl=i:t.httpOptions={baseUrl:i}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const r=new jst(this.apiKey);this.apiClient=new Mit({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Fst+"web",uploader:new Lst,downloader:new Nst}),this.models=new Xit(this.apiClient),this.live=new zit(this.apiClient,r,new Vst),this.batches=new ott(this.apiClient),this.chats=new Ott(this.models,this.apiClient),this.caches=new jtt(this.apiClient),this.files=new Jtt(this.apiClient),this.operations=new Zit(this.apiClient),this.authTokens=new mrt(this.apiClient),this.tunings=new kst(this.apiClient),this.fileSearchStores=new Trt(this.apiClient)}}const Y1=[{id:1,name:"Chng 1: TNG QUAN V QUN L D N",shortName:"TNG QUAN V QUN L D N",content:`Chng 1. TNG QUAN V QUN L D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. Hiu c khi nim v d n, d n CNTT l g.
2. M t v qui trnh qun l d n.
3. Bit c cc nhim v trong cc hot ng QLDA.
4. Bit cch phn loi d n.
5. Phn loi c d n. Xc nh c cng vic qun l d n.
6. Xc nh c cc bn lin quan n d n.

1.1 Khi nim v d n, d n CNTT.
1.1.1 Khi nim d n
D n l mt hot ng to ra mt cch c phng php, vi cc phng tin v ngun lc  cho  to ra mt sn phm mi hoc mt thc t mi.
V th, d n phi c tnh c th v mc tiu xc nh, nhm p ng mt nhu cu chuyn bit (ca ngi dng). D n cng khng phi l mt nghin cu tru tng m phi cu trc nn mt thc t mi cha tn ti trc . Mc d vic nghin cu, th nghim v pht trin c th l mt phn nht nh trong d n, nhng cng ch ng vai tr h tr trong qu trnh thc hin mc tiu cui cng ca d n m thi. Do vy, chng ta cn phn bit r s khc nhau gia d n v cc  ti nghin cu trin khai m cc c quan, n v nghin cu vn thng lm.

[Hnh nh: Hnh 1.1 Cc lnh vc trong QLDA]

1.1.2 D n Cng ngh thng tin
Qun l d n CNTT l tp hp cc cng vic c thc hin bi mt tp th (c th c chuyn mn khc nhau, thc hin cng vic khc nhau, thi gian tham gia d n khc nhau) nhm t c mt kt qu nh d kin, trong thi gian d kin, vi mt kinh ph d kin. Trong thut ng ca chuyn ngnh Cng ngh phn mm, Qun l d n phn mm l cc hot ng trong lp k hoch, gim st v iu khin ti nguyn d n (v d nh kinh ph, con ngi), thi gian thc hin, cc ri ro v quy trnh thc hin d n nhm m bo thnh cng cho d n.
Qun l d n phn mm cn m bo cn bng gia ba yu t: thi gian, ti nguyn v cht lng. Ba yu t ny c gi l tam gic d n.

1.1.3 c trng ca mt d n
Mi d n thng b rng buc theo b ba nhiu cch, do:
- Mc tiu v phm vi (Scope): t c ci g?
- Mc tiu v thi gian (Time): Thi gian bao lu?
- Mc tiu v chi ph (Cost): S tn km bao nhiu?
Nhim v ca ngi qun l d n l phi cn i nhng mc tiu thng hay xung t ny.

[Hnh nh: Hnh 1.2. B 3 rng buc trong QLDA]

1.1.4 Mc tiu ca d n
Mi d n u bt u khi c mt vn  c t ra trong thc t. Km theo  phi l nhng yu cu cn c gii quyt. Mc tiu ca d n l gii quyt c vn  ny. Cc mc tiu ca d n nht thit phi c vit ra mt cch r rng ngay t u, nu khng kh c th hon thnh c.
Mi d n CNTT cn phi c th ho cc mc tiu ca mnh c v mt nh tnh v nh lng. Mun c mc tiu c th, chng ta phi xc nh c yu cu tht c th.

1.2 Quy trnh qun l d n
Quy trnh qun l d n phn mm l quy trnh vn dng nhng kin thc, k nng v k thut cng ngh vo hot ng ca d n  t c mc tiu ca d n t ra. Nhng ng dng ny c a vo phn mm theo mt tiu chun ha ca qun l d n.
 m bo d n thnh cng, cc thnh vin d n phi m bo:
 La chn quy trnh ph hp  t c mc tiu ca d n
 Tun theo cc yu cu  p ng c nhu cu v mong i ca cc bn lin quan.
 Cn bng c cc yu cu (nhn t) cnh tranh trong d n nh: phm vi cng vic, ngn sch, tin , cht lng, ri ro, thay i. Ty theo quy m ca tng d n m cc mi giai on li c th gm nhng quy trnh nh hn.
Ngoi cc li ch chin lc nu trn phn mm cn cung cp y  cc tnh nng h thng. Vic bo mt c tin hnh mt cch tuyt i nghim ngt. Vic phn quyn c c th n tng vai tr ca ngi s dng.

[Hnh nh: Hnh 1.3 Quy trnh kim tra v gim st QLDA phn mm.]

1.2.1 Khi to d n
Giai on ny thc hin vic nh ngha mt d n mi hoc mt pht sinh (hoc trn ln) mi ca mt d n c sn nh: Xc nh yu cu ca d n, mc  u tin ca d n, phn tch cc yu cu u t, phn cng trch nhim cho cc b phn trin khai.

1.2.2 Lp k hoch d n
Giao on ny yu cu thit lp phm vi cng vic ca d n, iu chnh li mc tiu v xc nh ng i ti mc tiu .

1.2.3 Trin khai
Giai on ny thc hin hon thnh cc cng vic c xc nh trong phn lp k hoch  m bo cc yu cu ca d n.

1.2.4 Gim st v kim sot
Giai on ny yu cu vic theo di, r sot v iu chnh li tin  v kh nng thc hin ca d n. Theo di cc ri ro, thay i, pht sinh trong qu trnh thc hin v c nhng  xut iu chnh kp thi.

1.2.5 Kt thc
Giai on ny thc hin  kt thc tt c cc hot ng ca d n  chnh thc ng li d n.

1.2.6 Cc hot ng chnh trong qun l d n phn mm
1.2.6.1 Xc nh cc bc thc hin d n phn mm
Xc nh yu cu chung
Trc tin, cn xc nh cc yu cu chc nng (cng vic phn mm thc hin) cng nh phi chc nng (cng ngh dng  pht trin phn mm, s dng trong h iu hnh) ca phn mm. Tip theo cn xc nh r ti nguyn cn thit  xy dng phn mm. Ti nguyn  y c th gm c nhn t con ngi, cc thnh phn, phn mm c th s dng li, cc phn cng hoc cng c c sn cn dng n; trong  nhn t con ngi l quan trng nht. iu cui cng l xc nh thi gian cn thit  thc hin d n. Trong qu trnh ny cn phi nm bt c bi ton thc t cn gii quyt cng nh cc hot ng mang tnh nghip v ca khch hng  c th xc nh r rng yu cu chung ca  n, xem xt d n c kh thi hay khng.

Vit  n
Vit  n l qu trnh xy dng ti liu m t  n  xc nh phm vi ca d n, trch nhim ca nhng ngi tham gia d n; l cam kt gia ngi qun l d n, ngi ti tr d n v khch hng. Ni dung ca ti liu m t  n thng c nhng ni dung:
- Bi cnh thc hin d n: Cn c php l  thc hin d n, hin trng cng ngh thng tin ca khch hng trc khi c d n, nhu cu ng dng phn mm ca khch hng, c im v phm vi ca phn mm s xy dng.
- Mc ch v mc tiu ca d n: xc nh mc ch tng th, tin hc ha hot ng no trong quy trnh nghip v ca khch hng, xc nh mc tiu ca phn mm gm lng d liu x l, li ch phn mm em li.
- Phm vi d n: Nhng ngi lin quan ti d n, cc hot ng nghip v cn tin hc ha.
- Ngun nhn lc tham gia d n: Cn b nghip v, ngi phn tch, ngi thit k, ngi lp trnh, ngi kim th, ngi ci t trin khai d n cho khch hng, ngi hng dn khch hng s dng phn mm, ngi bo tr d n phn mm.
- Rng buc thi gian thc hin d n: Ngy nghim thu d n, ngy bn giao d n.
- Rng buc kinh ph: Kinh ph trong tng giai on thc hin d n.
- Rng buc cng ngh pht trin: Cng ngh no c php s dng  thc hin d n.
- Ch k cc bn lin quan ti d n.

1.2.6.2 Lp k hoch thc hin d n
Lp k hoch thc hin d n l hot ng din ra trong sut qu trnh t khi bt u thc hin d n n khi bn giao sn phm vi nhiu loi k hoch khc nhau nhm h tr k hoch chnh ca d n phn mm v lch trnh v ngn sch.
Cc loi k hoch thc hin d n
- K hoch m bo cht lng: M t cc chun, cc qui trnh c s dng trong d n.
- K hoch thm nh: M t cc phng php, ngun lc, lch trnh thm nh h thng.
- K hoch qun l cu hnh: M t cc th tc, cu trc qun l cu hnh c s dng.
- K hoch bo tr: D tnh cc yu cu v h thng, chi ph, n lc cn thit cho bo tr.
- K hoch pht trin i ng: M t k nng v kinh nghim ca cc thnh vin trong nhm d n s pht trin nh th no.

1.2.6.3 Quy trnh lp k hoch thc hin d n
- Thit lp cc rng buc ca d n: thi gian, nhn lc, ngn sch
- nh gi bc u v cc "tham s" ca d n: quy m,  phc tp, ngun lc
- Xc nh cc mc thi gian trong thc hin d n v sn phm thu c ng vi mi mc thi gian
- Trong khi d n cha hon thnh hoc cha b hy b th thc hin lp i lp li cc cng vic sau:
1. Lp lch thc hin d n
2. Thc hin cc hot ng theo lch trnh
3. Theo di s tin trin ca d n, so snh vi lch trnh
4. nh gi li cc tham s ca d n
5. Lp li lch thc hin d n cho cc tham s mi
6. Tha thun li cc rng buc v sn phm bn giao ca mi mc thi gian
7. Nu c vn  ny sinh th xem xt li cc k thut khi u a ra cc bin php cn thit

1.2.6.4 Cu trc k hoch thc hin d n
1 T chc d n
2 Phn tch cc ri ro
3 Yu cu v ti nguyn phn cng, phn mm
4 Phn cng cng vic
5 Lp lch d n
6 C ch kim sot v bo co

1.2.7 Mc ch ca qun l d n
Mc ch cui cng ca vic qun l d n l nhm m bo cho d n c thc hin thnh cng. Mt d n c nh gi l thnh cng nu nh p ng c 4 vn  c bn sau:
 Sn phm cui cng ca d n thc s p ng cc yu cu ca ngi dng, m bo thi gian v kinh ph khng vt qu 10-20% d tnh ban u;
 Ngi dng hi lng vi qu trnh thc hin d n, thc s tham d v gp phn cng sc ca mnh trong cc hot ng ca d n. c bit i vi cc d n ng dng CNTT, vai tr ca nhng cn b nghip v trong vic xc nh yu cu, phn tch quy trnh, thng tin... ti chnh n v ca mnh l rt quan trng;
 Qun l cp trn ca d n cung cp y  thng tin v tnh hnh thc hin d n.
 Nhng ngi thc hin d n cng phn khi, khng b qu g b, tch lu c kinh nghim, tng thm thu nhp...

1.2.8 Phng php lun v k thut qun l d n
Tt c nhng vn  nu trn cho thy cn phi c thi  ht sc nghim tc khi xy dng v thc hin mt d n, nht l cc d n c nhng u t rt ln ca Nh nc. Do vy, vic qun l d n i hi phi c nhng phng php lun khoa hc v nhng cng c mnh  h tr cho vic lp k hoch v theo di d n.

1.2.9 Nguyn nhn khin d n tht bi
Theo thng k chung trn th gii:
 33% cc d n b hu bi v
- Vt qua gii hn v thi gian hoc kinh ph;
- Cng ngh  b thay i qu nhiu so vi hiu qu m d n s mang li;
- Ngi dng hoc khch hng khng cn ti n na;
- Nhng l do chnh tr.
 50 - 100% qu ti
- Mt d n m chi ph ca n vt qu 50% kinh ph cho php
- Hoc ko di qu 50% thi gian d nh th coi nh l  tht bi.
 Khng s dng c
Nhiu d n khng bao gi a vo s dng c. L do c th l:
- D n khng gii quyt c vn  t ra;
- Qu kh s dng,
- Khng c o to.
 Nguyn nhn su xa ca vic tht bi c th xut pht:
- Ngay t khi bt u d n, do thiu mt k hoch tt:
D n khng th trin khai c v khng xut pht t thc t c th. Ngi ta bt tay vo vic lp trnh m khng hiu r ti sao li c d n  v chnh xc l cn phi hon thnh ci g; lm vic khng c k hoch. Nu khng nh gi xem l s cn phi tn bao nhiu cng sc  lm vic , ta s khng th hnh dung c s nhn cng cn thit, m  chnh l chi ph chnh ca d n. Nu khng thng nht r rng trc vi ngi dng v nhng g h yu cu d n phi t c, th sau ny s rt kh khn  ngi dng chp nhn cc kt qu ca d n. Tt c nhng cam kt u phi c ghi nh li di dng cc vn bn. Ngoi ra, vic t ra nhng thi hn v kinh ph khng st thc t thng khin cho nhng nhm thc hin khng th no hon thnh c cng vic.
- Trong cc bc pht trin tip:
+ D n c th mc sai lm trong giai on phn tch v thit k.
+ Ngi qun l d n khng phn cng r nhim v ca tng ngi.
+ Thiu hoc khng hiu r cc cng c h tr cho vic pht trin h thng cng nh cho vic qun l - theo di d n, s lm nh hng n thi gian v kt qu ca d n.
+ Khng lm r lch iu phi nhn s v thng bo trc cho cc i tng lin quan, th s rt kh khn khi cn huy ng nhn lc cn thit  hon thnh cng vic.
+ Vic bt u vit chng trnh trc khi bn thit k c hon thnh s khin cho d n kh m thnh cng mt cch tt p, hoc s tn thm nhiu cng sc  m iu chnh v sau.
+ Khng kp thi pht hin ra cc vn  chnh ny sinh trc v sau giai on pht trin.  l do thiu s r sot chi tit v mt k thut (thit k, chng trnh, ti liu...) v xem xt li v mt qun l ( cng, kinh ph, lch trnh...) mt cch khch quan t bn ngoi.
+ S thay i cng tc ca cc thnh vin tham gia d n cng l mt nguyn nhn phi xem xt.
+ Thiu cc chun mc, qui nh trong qu trnh pht trin cng lm cho d n b tht bi  mt mc  no .
+ Nhiu ngi tham gia d n cha chc  y nhanh tc  m c khi cn lm cho d n chm i v phi thm vic o to, hun luyn, thm vic giao tip gia mi ngi... tc l thm thi gian v kinh ph.
- Trong giai on kt thc:
+ Khi  n thi hn cui cng, hoc khi  ht kinh ph m mi chuyn vn cha xong, th yu cu i vi d n thng b tho hip. Ngi ta ngh rng mt phn (ln) cng vic  hon thnh ri th l c. Th nhng, i vi nhiu ngi dng th phi hon tt ton b mi p ng yu cu ca h.
+ Mt s ng dng c to ra khng c s r li cn thn. iu  gy nn n tng ban u khng hay v gy kh khn cho vic a vo s dng.
+ Mt s h thng a ra khng p ng c ng cc ch tiu k thut   ra.
+ Nu chi ph cho vic bo tr qu ln th h thng cng c th b ngng hot ng.
Trong nhiu trng hp, nu  thi im no  m chng minh c rng khng c ch li g m tip tc d n na th cng nn mnh dng xem xt n vic phi ngng d n li.

1.3 Cc nhim v trong cc hot ng QLDA.
1.3.1 Qun l thi gian ca d n
i vi mi d n phi xc nh c mt thi hn ti a phi hon thnh, c th hn l phi c thi im bt u v thi im kt thc. Thi im bt u l khi vn  gii quyt c t ra. Thi im kt thc l hn cui cng m d n phi hon thnh. Thi im ny phi c xc nh r rng, nu khng d n c th s khng bao gi kt thc.

1.3.2 Qun l kinh ph ca d n
Mi d n u phi xc nh mt kinh ph ti a, hay ni khc i l mt khon tin ti a m d n c th s dng.
Mi d n CNTT u phi xc nh tng d ton kinh ph cho ton b qu trnh thc hin, phn b theo tng nm hoc tng giai thc hin.

1.3.3 Qun l ngun nhn lc ca d n
L tt c nhng ngi tham gia vo d n. Mi d n phi xc nh danh sch nhng ngi tham gia, t mc qun l d n n nhng ngi thc hin, trin khai.

1.3.4 Qun l cc kt qu chuyn giao ca d n
L kt qu ca d n hay ni khc i l sn phm cui cng ca d n. Mc tiu ca d n thng thng l gii quyt vn  bng vic to ra cc kt qu ny. Cc kt qu v cc mc tiu nht thit phi c vit ra r rng, nu khng mc ch ca d n s khng t c; s to ra nhng kt qu sai khc i v s khng ai hi lng c.

1.4 Phn loi d n
D n trong thc t rt a dng, c th phn loi theo nhiu cch khc nhau:
1.4.1 Theo tm c d n
D n ln: c c trng bi tng kinh ph huy ng ln, s lng cc bn tham gia ng, thi gian dn tri, qui m rng ln. Chng i hi phi thit lp cc cu trc t chc ring bit, vi mc phn cp trch nhim khc nhau,  ra quy ch hot ng v cc phng php kim tra cht ch.
D n trung bnh v nh: khng i hi kinh ph nhiu, thi gian n nh ngn, khng qu phc tp... Kinh nghim cc nc cho thy nhng d n trung bnh hoc nh l nhng d n c t hn 15 ngi trong mt nm.
V l thuyt, qun l d n ln hay nh cng u theo nhng phng php lun nh nhau. D n ln c th gi l chng trnh; chng trnh thng c phn thnh nhiu d n nh hn. Trong trng hp  s tn ti nhiu mc qun l d n khc nhau, v  phn bit c th gi nhng ngi qun l bng nhng tn khc nhau nh ngi qun l chng trnh, ngi qun l d n, ngi iu hnh d n, gim c d n, nhm trng,...Thm ch, mi mt ngi tham gia vo d n cng phi bit cch t chc v qun l cng vic m mnh c giao.

1.4.2 Theo ni dung ca d n
C th phn lm 3 loi chnh:
D n ng dng CNTT trong cng tc qun l v hot ng nghip v.
D n xy dng c s h tng v CNTT: d n Mng truyn thng d liu quc gia; d n xy dng CSDL quc gia;
Cc d n nhm thc hin nhim v  phn cng cho cc B ngnh nh pht trin Cng ngh thng tin; m bo  cn b tin hc cho t nc...

1.4.3 D n mt ngi hay d n nhiu ngi
Mt d n c th c thc hin bi mt ngi hoc nhiu ngi. Vic qun l d n s kh khn hn khi c t hai ngi tr ln.

1.4.4 Ni b hay bn ngoi
- D n ni b l d n ca mt n v t chc thc hin nhm phc v cho yu cu ca chnh t chc .
- D n bn ngoi l d n c thc hin  p ng yu cu cho mt n v khc.

1.5 Cc bn lin quan n d n

[Hnh nh: Hnh 1.4 Cc bn lin quan ca mt d n]

S  trn c th xem nh l mt v d  cp ti tt c cc n v v nhn s c lin quan n mt d n v tin hc. Tnh hnh tin  v kt qu thc hin ca d n l iu m nhng ni (ngi) ny cn phi quan tm n.
V t chc qun l, ta c th phn bit v phi bit r chc nng ca tng ngi:

| Gim c d n | T chc, phi hp, i ngoi |
| :--- | :--- |
| - Gim c iu hnh: | - Trc tip iu hnh, tch hp |
| - Nhm trng k thut: | - Chu trch nhim tng phn k thut |
| - Nhn vin k thut trong mi nhm: | - Thc hin cng vic k thut c th. |

H u l nhng ngi qun l d n, nhng  nhng mc  chi tit khc nhau. Mc qun l cui cng l cc nhm trng ph trch tng cng vic k thut.

 Cu hi (bi tp) cng c:
1. Th no l QLDA CNTT; B ba rng buc trong mt d n l g?  m bo c b ba ny theo anh ch phi lm nh th no? C my lai d n?
2. Nguyn nhn no dn n d n tht bi? L mt nh QLDA anh ch hy a ra nhng bin php nhm khc phc nhng nguyn nhn .`},{id:2,name:"Chng 2: K NNG GIAO TIP TRONG QUN L D N",shortName:"K NNG GIAO TIP TRONG QUN L D N",content:`Chng 2. K NNG GIAO TIP TRONG QUN L D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th bit c:
1. Cc khi nim v trao i
2. Cc khi nim v quan st, lng nghe, trnh by
3. Cc k thut trnh by trc quan
4. Khi nim quan h tng tc Cu hi  cu tr li thch hp

2.1.Khi nim giao tip, cc thuyt giao tip
Ngy nay d bn lm bt c vic g bn cng phi c k nng giao tip  qun l v trao i vi mi ngi v cng vic, nghe mi ngi phn hi v cc vn  X hi cng pht trin, vn minh th nhu cu v hnh thc giao tip cng cao v a dng. Giao tip cng tr nn mt k nng khng th thiu v cn phi c rn luyn. C rt nhiu khi nim v giao tip.
- Giao tip l vic trao i thng tin gia con ngi v thng dn ti hnh ng tip theo.
- Giao tip l s tip xc gia hai hay nhiu ngi thng qua phng tin ngn ng nhm trao i thng tin, tnh cm, hiu bit, tc ng qua li v iu chnh ln nhau,
- Giao tip l mt qu trnh trao i thng tin gia cc c nhn thng qua mt h thng bao gm cc k hiu, du hiu v hnh vi. Giao tip cng c th hiu l cc hnh thc biu l tnh cm, tr chuyn, din thuyt, trao i th tn, thng tin.
Nh vy giao tip xy ra rt nhiu hng ngy v di nhiu hnh thc, gin tip hoc trc tip. Giao tip qua li ni, ngn ng khng li (c ch, hnh vi, nt mt, trang phc), hi p, quan st, nghe, trnh by, ni chuyn, qua bo co, gi th, th in tGiao tip vi ngi cng nhm, c quan hay ngi ngoi, c chun b hay khng chun b trc. Giao tip l hin tng tm l ca con ngi rt phc tp. Mc d c nhiu nh ngha, quan nim khc nhau v giao tip nhng ni chung mi ngi u cho rng giao tip l phi c xy dng mt bn thng ip sau  gi i vi hy vng ngi nhn s hiu thng ip .

[Hnh nh: Hnh 2.1 Qu trnh giao tip (Ngi gi -> Ngi nhn)]

Theo quan nim truyn thng ny chng ta thy cp  giao tip hiu qu nht l trong tnh hung mt i mt, c hai bn c th tip nhn thng tin trc tip di cc dng ngn ng giao tip, trnh c mt s nhiu, c th iu chnh nhanh  tng hiu qu giao tip. Cp  ny c  hnh thc giao tip nh ni chuyn vi nhau, phng vn, hi m song phng, hi ngh quy m nh, hp nhmCp  giao tip cng c tin hnh song phng t hiu qu hn nhng tin li l giao tip khng gp mt qua in thoi.  cp  ny hai bn nghe ging ni ca nhau, thng tin qua li nhng thiu yu t phi ngn t. Cp  ba l cp  km hiu qu nht: ch gi thng tin dng vn bn nh th, cng vn, n, bo co, th in t. Cp  giao tip ny thiu h tr ca yu t phi ngn t v nhn s phn hi chm. Trong qu trnh lm vic chng ta, v nhng l do no  nh thi gian, khng gian, ti chnh, c th dng hnh thc giao tip no cho ph hp v hiu qu nht hoc dng ng thi ba hnh thc giao tip.

C 4 quy m giao tip.
- Th nht giao tip vi chnh bn thn: t a ra thng tin, t nhn thng tin (suy ngm) v ci thin bn thn.
- Th hai: giao tip nhn cch gia hai c nhn vi nhau trong cng vic cng nh trong tnh cm, i sng.
- Th ba: giao tip nhm gia cc c nhn trong mt nhm no .
- Th t: giao tip trong t chc, giao tip gia cc nhm vi nhau  hon thnh cng vic chung ca t chc. Giao tip trong t chc c cc lung giao tip t trn xung, t di ln v theo hng ngang.

[Hnh nh: Hnh 2.2 Cc dng giao tip trong nhm (a. Hnh nan qut, b. Hnh vng trn, d. Hnh sao, d. Hnh dy xch)]

2.1.1 Cc thuyt v giao tip.
- Thuyt hnh vi cho rng mi ng x ca c nhn trong x hi l qu trnh tip nhn kch thch ngoi gii v phn ng p li kch thch ca c th. Hnh vi c th hin bng cng thc kch thch -> phn ng, c kch thch th c phn ng. Hnh vi theo ngha chung l s tc ng qua li gia c th sng v mi trng c to bi kch thch bn ngoi v nhu cu bn trong. Giao tip l hnh thc c bn v tiu biu ca hnh vi.
Thuyt hnh vi quan tm nhiu hn ti phng din ng x, tc nhn kch thch ca mi trng quy nh tnh cht, c im ca hnh vi ng x. Hnh vi ng x l mt chui phn ng trc hay sau nhng thay i ca mi trng, iu kin bn ngoi.
- Thuyt lin h x hi cho rng con ngi nm trong mi lin h vi con ngi v nhng ngi khc trong x hi loi ngi. Cc mi lin h ny chnh l bn cht x hi ca c nhn. Giao tip c xem l phng tin thit lp cc mi quan h x hi. Cc c nhn thc hin cc hot ng giao tip thng qua cc hnh ng v thao tc  t mc ch tho mn nhu cu no . Thuyt x hi nhn mnh n yu t hon cnh trong giao tip. Khi giao tip chng ta tham gia vo mt hon cnh x hi vi nhng v tr khc nhau, quy tc chun mc v nn vn ho khc nhau. Cc yu t cu thnh trong giao tip gm ngi gi, ngi nhn, thng tin, mi trng x hi c th.
- Thuyt hot ng cho rng thng qua hot ng c s tip xc tm l, giao tip vi nhau, hnh thnh cc mi quan h x hi v quan h lin nhn cch. V d nh tm l hc Lnchiep a ra nh ngha: Giao tip l h thng nhng qu trnh c mc ch v ng c m bo s tng tc ca ngi ny vi ngi khc trong hot ng tp th, thc hin cc mi quan h x hi v nhn cch, cc quan h tm l v s dng phng tin c th m trc ht l ngn ng.
 thc hin cc hot ng hng ngy cho hiu qu, c 4 k nng giao tip c bn cn c hc tp v rn luyn: ni, nghe, vit, x giao ng x. Cng cn nhiu k nng khc b sung cho k nng giao tip c hon chnh hn nh k nng quan st, k nng t cu hi v tr li cu hi, k nng hp tc v chp nhn, k nng gii quyt vn ... rt cn thit cho mi con ngi  sng v lm vic.

2.1.2 Nguyn tc v phong cch giao tip
Nguyn tc trong giao tip l nhng h thng quan im ch o, nh hng thi  v hnh vi ng x, la chn cc phng php, phng tin giao tip ca c nhn. C th k ra y mt s nguyn tc giao tip c bn.
Nguyn tc bnh ng trong giao tip (tn trng nhn cch trong giao tip). Theo nguyn tc ny ngi giao tip phi tn trng nhn cch i tng giao tip tc l tn trng phm gi, tm t nguyn vng ca nhau, khng p buc nhau bng quyn lc. Tn trng nhn cch cng c ngha l coi i tng giao tip l mt con ngi, c y  cc quyn con ngi v c bnh ng trong cc mi quan h x hi.
Nguyn tc thin ch trong giao tip. Thin  trong giao tip l s tin tng  i tng giao tip, lun ngh tt v h. Ginh nhng tnh cm tt p v em li nim vui cho i tng giao tip, lun lun ng vin, khuyn khch h lm vic tt.
Nguyn tc tn trng cc gi tr vn ho trong giao tip. Giao tip trong mi trng a vn ha i hi mi c nhn phi c nhng hiu bit nht nh v cc gi tr vn ha ca i tc giao tip thuc cc quc gia, cc dn tc, gii  c ng x ph hp.
V phong cch giao tip c th c cch phn chia khc nhau.  y a ra mt s phong cch c trng da vo ng x.
Phong cch c on: Cc thnh vin tham gia giao tip khng quan tm n c im ring ca i tng giao tip dn ti thiu thin ch, hay va chm v gy cng thng. Ngi giao tip khng gy c thin cm, kh thit lp mi quan h hp tc, kh chim c cm tnh ca i tc. u im ca phong cch giao tip c on l c tc dng trong vic a ra nhng quyt nh nht thi, gii quyt c vn  mt cch nhanh chng. Nhc im l lm mt i s t do, dn ch trong giao tip, kim ch sc sng to ca con ngi, gim tnh gio dc v tnh thuyt phc.
Phong cch t do: Cc thnh vin tham gia giao tip linh hot qu mc, d thay i mc ch, chiu theo  i tc giao tip. Phong cch ny d dng thit lp cc quan h nhng cng d mt cc mi quan h, khng su sc, thiu lp trng, th no cng c. Phong cch t do l kiu phong cch linh hot, c ng, mm do, d thay i theo i tng v hon cnh giao tip. u im ca phong cch ny l pht huy c tnh tch cc ca con ngi, c kch thch t duy c lp v sng to. Nhc im l khng lm ch c cm xc ca bn thn, thng hay ph thuc hoc bt chc, d pht sinh t do qu mc.
Phong cch dn ch: Cc thnh vin tham gia giao tip biu hin s nhit tnh, thin , tn trng nhn cch ca i tng giao tip. Cc thnh vin bit lng nghe, bit quan tm, d dng thit lp mi quan h tt trn c s hiu bit tm t ca cc bn. u im ca phng php ny l lm tng kh nng sng to ca i tng giao tip, gip mi ngi thn thin, gn gi v hiu nhau hn, to mi quan h tt khi lm vic. Nhc im ca phng php ny l dn ch qu c th dn n vic ri xa cc li ch ca tp th. Chng ta c gng rn luyn  theo phong cch giao tip dn ch nhng trnh dn ch qu trn..

2.2 K nng lng nghe
2.2.1 Nghe v lng nghe, vai tr trong giao tip
Nghe l hot ng thng ngy ca con ngi nn chng ta thng b qua, t quan tm ti rn luyn k nng ny m cho rng  c sn. C kt qu nghin cu cho thy rng con ngi dng 45% thi gian giao tip hng ngy cho vic nghe, tuy nhin ngi ra li khng c luyn nghe m ch yu l luyn vit. Nghe v lng nghe khc nhau. Bi vy cn phi phn bit nghe v lng nghe.
- Nghe l th ng, l trng thi t ng mang tnh cht vt l.
- Lng nghe l ch tm, ch ng. Lng nghe i hi tp trung, tm kim tch cc  ngha ca i tng ni. Trong giao tip chng ta phi c gng to ra trng thi lng nghe  n nhn v hiu ng,  giao tip ci m,  chn lc thng tin.
Trong giao tip lng nghe s tip nhn y , trn vn thng tin, gip li th trong gii quyt vn  v m phn vi i tc. Lng nghe cn th hin s tn trng i tc v s hp tc lm vic v gii quyt vn . Lng nghe kt hp quan st cn c th nghe c nhng g m ngi ta khng ni bng li.
Lng nghe s lm tha mn ngi ni, th hin mnh tn trng ngi ni. Lng nghe s nhn nhiu thng tin dn ti vic ra quyt nh chnh xc hn. Lng nghe ngi khc s lm cho ngi khc c cm tnh vi mnh, thn thin vi mnh khi lm vic. lng nghe lm cho mnh nm bt chnh xc tnh cch, tnh nt v quan im ca ngi ni chuyn. Lng nghe gia hai bn to khng kh trao i thng thn, hiu nhau dn ti gii quyt mu thun, tm kim gii php nhanh hn.

2.2.2 Cc yu t nh hng
Tuy nhin c rt nhiu yu t nh hng n vic lng nghe ca chng ta. Chng ta trc ht cn trnh nhng thi quen c nh hng n vic lng nghe.
- Th nht: gi v lng nghe, t ra lng nghe lm hi lng ngi ni nhng li khng nghe.
- Th hai: nghe qua loa cc thng tin, nghe m khng c suy ngh, chn lc, nghe ht m khng hiu.
- Th ba: bung tri tng thi im, lc lng nghe, lc khng, dng thng tin khng lin tc.
- Th t: lun bnh lun v cch ni hoc tc phong, b ngoi ca ngi ni theo tiu chun ca bn thn.
- Th nm: khng nghe nhng vn  khng th v theo suy ngh ca bn thn.
Bn cht ca s khng lng nghe l t nhin ca con ngi nn mun lng nghe cng phi tp luyn. V tc  suy ngh ca con ngi nhanh hn rt nhiu so vi tc  ni, nn khi nghe xong con ngi cn nhiu thi gian  suy ngh chuyn khc m sao lng vic nghe.
T nh chng ta thng c luyn vit, ni ch khng ch  rn luyn cch lng nghe.  cng l mt tr ngi t nhin hnh thnh trong qu trnh ln ln ca con ngi. Vic thch nghe nhng ch  ny m khng thch nghe ch  khc, c th l ch  phc tp hoc nhy cm, mang tnh ch quan cng l mt yu t nh hng n vic lng nghe. Cc yu t nh hng khc nh s thiu kin nhn, thch d ght kh, khng kt hp cc k nng quan st c ch iu b ngi ni v nghe ging m iu li ni, thnh kin vi ngi ni cng nh hng nhiu n vic lng nghe.

2.2.3. Rn k nng lng nghe
Mun lng nghe tt, hiu qu th ngi nghe cn c tp luyn. Sau y l mt s li khuyn  c th ci thin k nng lng nghe ca chng ta.
- Chm ch khi nghe: nhn vo ngi ni, tp trung n nhn tng li.
- Nghe cho ht li ht  ngi ni: khng st rut, nn nng; khng ngt li ngi ni; gt u ng h, khng ngt li ngi ni.
- Tm hiu  ngha ca cc cu ni, li ni v cc c ch, hnh ng ngn ng khng li.
- Khch quan khi lng nghe, ng ch trng qu vo phong cch ngi ni, ch  ni dung, c on trc din gi mun ni g, ch no ngi ni nhn mnh.
- Trao i phn hi vi ngi ni khi h ni xong, c th tm tt ni dung  nghe c  khng nh thng tin vi ngi ni.
- Loi b cc nhiu vt l: ting n, ngi i li, phng tin, v tr ngi
- Tng hp v x l thng tin khi nghe ni: phn tch nhanh, i chiu vi thng tin  bit

Nn lm:
- By t mi quan tm
- Kin nhn
- C hiu vn 
- Th hin khch quan
- Biu l ng cm
- Tch cc tm hiu  ngha
- Gip ngi ni pht trin nng lc, ng c hnh thnh  ngh, quan im v  tng
- Gi im lng khi ang nghe

Khng nn:
- Thc gic ngi ni
- Tranh ci
- Ngt li
- Nhanh chng ch trch khi cha r
- Ln ging khuyn bo
- Vi vng kt lun
-  tm l ngi ni ln t tm l mnh

2.3 K nng vit
2.3.1 Khi nim
Vit theo ngha n gin l hnh ng t ch, biu tng, s, t,  ln giy theo quy lut, cu trc ca ngn ng. Vit thng l  nhn mnh hoc gii thch  tng. Mt bi vit tt l mt bi vit r rng, xc tch, ng ng php v c php, ng hnh thc trnh by, ngi c c th d dng hiu c ng v chnh xc  tng, mc ch ca ngi vit.

2.3.2 Tm quan trng ca vit
Vit l mt cng c tt  giao tip c hiu qu, mun rn luyn k nng vit tt cn phi luyn tp. Vit gip ngi gi thng tin c th xem xt tt c cc kha cnh chi tit ca thng tin m mnh gi di dng vn bn chnh xc v trau chut. Vit lm ngi nhn thng tin c th xem qua thng tin sau  nghin cu n chi tit hn, lu li thng tin lu di. Vit l  truyn ti thng tin. K nng vit tt m ra nhiu c hi cho chng ta trong cng vic v thng tin (c hi c nhn, c hi nhm ni bn lm vic).

2.3.2 Qu trnh vit mt vn bn
 vit mt vn bn no  ngi ta ch  n cc yu t:  cng, ni dung, vn phong, cu vn v  chnh xc. Lp  cng cho vn bn c th theo cch truyn thng, lit k cc  chnh cp mt, cp hai ri cp nh hn na. Hoc lp  cng theo s  t duy, t mt  chnh phn ra cc  chnh cp mt,  chnh cp hai v nh hn na lin h vi nhau nh cc dy thn kinh.
Cc bc son tho mt vn bn gm chun b, thc hin vit, v hon thin bi vit.
- Chun b:
u tin l vic xc nh i tng c: bi vit ca bn l ni cho ai  mt iu g , l ngi vit bn phi quyt nh vit ci g v vit nh th no  ni cho ngi c ca bn mt cch tt nht. V th bn phi xc nh ai l ngi c bi vit ca bn, h s thu c g khi c bi vit ca bn, ti sao h li phi c (y l vn  quan trng  xc nh mc ch vit ca bn) v cui cng l h c bi vit ca bn nh th no.
Th hai l xc nh ni dung bi vit, vit ci g, thng ip chnh l g. Phi xc nh ni dung bi vit chnh xc theo ch  ca bi vit, sau  phi sp xp cc  tng ca bi vit mt cch h thng, hi ha.
Th ba l xc nh vn phong ca bi vit. Vn phong bi vit ca bn l cch m bn giao tip vi ngi c ca bn. Vn phong tt gip cho ngi c d dng thu c thng tin trong bi vit ca bn nhanh nht v chnh xc nht. Vn phong th hin qua ngn ng s dng trong bi vit, cu trc ca bi vit v nhng minh ha s dng trong bi vit.
Th t l xc nh hnh thc trnh by. Ty theo cc loi vn bn khc nhau th hnh thc trnh by khc nhau. Hnh thc trnh by bao gm nh dng bi vit, cn l (trn, di, tri, phi), loi ch, c ch, tiu ... Mt s vn bn thng c quy nh hnh thc trnh by nht nh chng ta phi tun theo (bi bo, bo co khoa hc, lun vn)
-Thc hin vit:
u tin phi vit bn tho. Sau khi xc nh c cc vn  chng ta bt tay vo vit bn d tho u tin. Mt bi vit thng c phn gii thiu, phn trin khai  tng v phn kt lun.
Phn gii thiu: Mc ch ca phn gii thiu thng cho ngi c bit ch  bn vit l g, thng bo cho ngi c v quan im ca bn, gi c tr t m cho ngi c  tm hiu v bi vit ca bn. Phn gii thiu nn trnh by chung v ch  ca bi vit sau  kt thc vi  chnh ca ch  m bn vit.
Phn chnh: Phn ny bao gm cc on gii thch cc  ca bi vit. Phn chnh gm cc on vn. Mi on thng gii thch trn l mt  ca bi vit. Gia cc on s dng t chuyn tip  m bo s thng sut gia cc on.
Phn kt lun: y l phn cui cng tng kt li cc  chnh ca bi vit, nhn mnh mt ln na thng ip mun gi.
Sau khi vit xong bn tho th s l cng vic chnh sa bi vit. Chnh sa l qu trnh xem li bi vit ca bn. C th thc hin nhiu ln chnh sa. Mi ln chnh sa gip ngi vit n st hn mc ch d nh vit. Chng ta thng chnh sa v ni dung sao cho st vi ch , chnh xc, y . Chnh sa vn phong bi vit v ngn ng s dng, minh ha, cu trc. Chnh sa v hnh thc trnh by c ng vi loi vn bn m bn vit hay khng, ng php, chnh t...
- Hon thin bi vit:
Sau khi chnh sa bn thm vo hay bt i nhng phn cn thay i v hon chnh li bi vit bng cch thm vo hay bt i nhng lin t ni cc on vn, xem xt bi vit c theo logic hay khng, sau  sa theo ng hnh thc quy nh v mc nh.

2.4 K nng ni v thuyt trnh
2.4.1 Ni v s dng ngn t
Ngn t c hiu l h thng nhng t v cc nguyn tc kt hp chng m nhng ngi trong cng ng dng lm phng tin truyn t thng tin cho nhau.
K nng ni hiu qu l kh nng biu t bng li ni, l mt loi nng lc c th hin qua khu ng  truyn t thng tin, biu t t tng, tnh cm mt cch chnh xc, sinh ng, c sc thuyt phc.
K nng ni c quyt nh bi 3 yu t: s pht m (phonation), kh nng din t (articulation) v s pht m chnh xc (pronunciation). S pht m c cc c trng v cao  (ging cao, thp), trng  (di, ngn) v cng  (mnh, yu). Kh nng din t lin quan ti cch pht m, khuyt tt c quan lin quan n pht m, v s bt cn trong khi ni cng nh im mnh v yu ca ting a phng. Pht m chnh xc lin quan n cc t kh pht m, pht m ln ln mt s ch  mt s vng ly ting ph thng ca mt quc gia lm chun.
S dng ngn t tt gip truyn t thng tin v gii quyt cng vic nhanh chng, hiu qu. N to ra mi quan h tt p trong giao tip. N gip con ngi nng cao uy tn bn thn, t khng nh v l cng c to nh hng i vi ngi khc.

2.4.2 Chun b bi ni
Trc khi ni hoc trnh by vn , thng tin no  cn phi c bc chun b. Chun b bi ni l bc quan trng. Nh Richard Hal, mt nh thuyt trnh ngi M ni rng thnh cng bi thuyt trnh ca ng l chun b, chun b v chun b. Mt bi ni chuyn thng thng gm ba phn: m u, ni dung, v kt lun.
- M u/t vn :
M u l phn nu ra thng ip chnh mnh mun gi ti ngi nghe. Phn m u nu mc ch, tm quan trng ca bi ni.  m u cho linh hot c th dng mt hot ng gy hng th, mt cu chuyn c k, mt cu hi gi suy ngh c a ra hoc a ngay ni dung khi qut bui ni chuyn.
- Ni dung:
u tin la chn cc ni dung chnh, ni bt th nht, th hai th ba vit ra giy, sau  sp xp cc ni dung  theo th t ri vit thnh cc on vn. Sau  vit cc  lin kt gia cc ni dung ny. Ton phn vit  chun b s dng mt kiu hnh vn. Chun b cc s liu thng k  h tr, minh ha cho cc  kin a ra. Chun b mt s giai thoi hoc cu trch dn, mt s cu chuyn vui, li ni a  a vo trong lc ni nu thy ph hp. Chun b thm nhng hnh nh, v d minh ha cho bi ni.
- Kt lun:
Phn kt lun phi nhn mnh  tng ch o ca bi ni, thng ip chnh mt ln na. Dng bi ni  mt cu trch dn hay, chn lc, kch tnh lm p bui ni chuyn. Phi th hin v c thi  trn trng i vi ngi nghe ngay khi vit chun b.
Khi ni s dng ngn t theo nhng li khuyn sau: chnh xc, r rng, d hiu, sinh ng, c th, gn gi, nh nhn, lch s, ph hp bi cnh, ph hp i tng, hng vo i tng, kt hp yu t phi ngn t, phi hp kho lo vi cc yu t minh ha

2.4.3 Ngn ng c th
Khi ni trc mi ngi, ngn ng c th cng mang thng ip tt hoc xu gi ti ngi nghe. y l cc yu t phi ngn t.
Ngn ng khng li gm c: nh mt, nt mt, tip xc c th, t th ng ng, chuyn ng tay, di chuyn, khong cch, trang phc. Khi ni ngn ng khng li b sung cho li ni. Trong khi ni t th ng cn thoi mi, t nhin, hai chn ng trn khong cch bng vai Trnh t to ra cc trng thi ng g b nh nghing ngi, ng ngi v trc. Tay c cc c ng va phi, minh ha bng cc ngn tay v bn tay, trnh vung tay v c ng thi qu. Nu ng khng c bc th hai bn tay  trc bng, v tr ngang tht lng. Trnh chp tay ngang hng hoc khoanh tay trc ngc. Khi ni vi ai  nn nhn vo mt h. Khi ni vi m ng th nhn bao qut vi con mt thn thin, ming lun ti. Ngn ng khng li cng cn phi c rn luyn cho thnh thi quen v  t tin th phi chun b k.

2.4.4 K nng thuyt trnh, trnh by:
Thuyt trnh l trnh by trc mt s hoc nhiu ngi v mt vn  no . Thuyt trnh c th ch trong mt vi pht, nhng cng c th nhiu gi. Thuyt trnh c th vi mc ch thng bo (bo co vi mi ngi vic mnh  lm hoc v vn thuc mi quan tm ca mi ngi) hoc thuyt phc (bo co v li ch ca vn  no  v ku gi s ng tnh ca mi ngi, dn ti hnh ng sau thuyt trnh). Thuyt trnh tt cn c s chun b. Thng thng ngi ta chia ra 3 cng vic: chun b thuyt trnh, tin hnh thuyt trnh v nh gi kt qu thuyt trnh. Hai cng vic u bt buc phi c  mi bi thuyt trnh.
- Chun b thuyt trnh:
Trc khi thuyt trnh bn phi t t cc cu hi: bn c hng th vi ch   v c  kin thc  thuyt trnh hay khng? Mc tiu ca bi ni ca bn l thng tin, thng bo hay thuyt phc? Bn c bao nhiu thi gian cho chun b, cho thc hin? i tng ngi nghe bn thuyt trnh l ai (ngi lao ng nng thn, min ni, cc b, cng chc, thanh nin, sinh vin, hc sinh, nh khoa hc, hi ng xt duyt, tuyn chn)? Ngn ng no c s dng? Thng ip chnh ca bui thuyt trnh ca bn l g? Bn thuyt trnh  u v cc phng tin c s dng h tr khi thuyt trnh l cc phng tin no? Kim tra c s vt cht ni thuyt trnh xem tt c mi ngi c th nghe r khng, c thit b m thanh tt khng, nhn r khng? Liu nh sng trong phng c va ? Dn bi ca bi thuyt trnh chia lm 3 phn: m u, thn bi (ni dung) v kt lun.
- Thc hin thuyt trnh:
Thc hin thuyt trnh cng theo th t: vo  (m u), ni dung chnh, v kt lun (kt thc). Nn nh rng mc  ch  ca ngi nghe gim dn v cui bui thuyt trnh v gn cui c th tng ln cht t. Do  khong gia bui phi lm th no ko s tp trung ca ngi nghe, gim cng thng.
Khi thc hin thuyt trnh phn m u c th c nhiu cch tin hnh. C th vo bui thuyt trnh mt cch trc tip, c th dn nhp bng nhng s kin tng phn, c th dn nhp bng mt cu chuyn lin h vi vn  trnh by, c th bng cch t cu hi vi ngi nghe, c th dn nhp bng bng mt cu trch dn ca ngi ni ting, c th dn nhp bng s vic gy chn ng hoc sc M u thuyt trnh phi gy c s ch , xy dng lng tin ca ngi nghe v nu c khi qut vn  thuyt trnh.
Phn ni dung ch yu phi c lin kt cht ch cc  vi nhau. Trong khi thuyt trnh phi quan st, c bin php duy tr s ch  ca ngi nghe.  duy tr s ch  cn s dng cc bin php sau y cho ng lc: khng c nguyn vn hay thuc lng; khng dng nhiu li l hng hn; sp xp cc  theo trnh t hp l; a nhng v d, s liu minh ha; xy dng cch ni ty theo i tng ngi nghe; c th thm nhng cu ni, cu chuyn khi hi ng lc v lin h vi ni dung trnh by; lun bm st ch .
C th thuyt trnh c thc hin bng cch hc thuc lng, c bi  vit, da vo cc phiu ghi dn , v thuyt trnh t do. Mi kiu thuyt trnh c nhng u im v nhc im ca n. Thuyt trnh khi hc thuc lng c nhiu hn ch nht v s n iu, s dng ngn ng, c ch khng da vo phn hi ca ngi nghe m thay i, nu qun mt ch no  th lm hng c bui ni chuyn, n ch hiu qu khi li thuyt trnh ngn, lc khai mc bui hp no . Thuyt trnh bng cch c thch hp vi nhng bui ni chuyn, bo co s liu phc tp, khng c php ni sai s liu, bo co khoa hc, thi gian hn ch so vi ni dung. Cch trnh by c nh vy to khong cch ngi ni v ngi nghe, d gy bun ng, phn tn, sao lng vic nghe. Cch thuyt trnh t do hoc ghi dn  l hp dn ngi nghe hn c v ty theo i tng ngi nghe, phn ng, phn hi ca ngi nghe khi quan st m thay i cch ni, ngn ng khng li, thm chuyn vui, cu ni a. Cch ny ngi thuyt trnh phi chun b k, c kinh nghim nhiu, l cch m cc thy gio v nh thuyt trnh chuyn nghip s dng.
Phn kt thc bi thuyt trnh nn nhc li, tm tt cc  chnh  trnh by, m t, khuyn co cc hot ng tip theo, kt thc bng nhn xt tch cc. Yu cu khuyn co ngi nghe hnh ng hoc xem xt vn  theo quan im mi. Nn kt thc thuyt trnh ng thi gian  ghi trong chng trnh hoc sm hn t giy. Sau  nn dnh mt thi gian  cho ngi nghe hi v tr li cc cu hi, thc mc . Cm n ngi nghe trc khi dng ni. Nu c nh gi th cn thit k cc phiu nh gi bui thuyt trnh, hoc nghe nhng phn hi  ci thin thuyt trnh ln sau v c dnh thi gian cho vic nh gi ny.

2.4.5 K nng i ph vi hi hp khi thuyt trnh:
Ni, thuyt trnh trc m ng vi a s mi ngi u l cng vic kh, gy ra hi hp, run, nht l nhng ln u. S hi trong trng hp ny l bn cht t nhin ca con ngi v nhu cu b e da (theo Maslow). Vic s hi s biu hin v mt sinh l nh v mi hi, tay chn run, ni lp hoc ni nhu.
 i ph vi hi hp v run th trc tin phi chun b k ni dung bi ni v tp ni mt mnh trc khi ni trc m ng. Khi tp ni c th nh mt s ngi nghe v nhn xt  sa v ni dung, ging ni, t th, dng c h tr. Ni chung vic chun b k gp phn rt quan trng vo chng hi hp. Trc khi thuyt trnh nn c chun b c v mt sc khe, ngh ngi thoi mi mt bui trc thuyt trnh. Cn dnh thi gian lm quen v s dng thnh tho cc dng c h tr, lm quen vi cn phng ni thuyt trnh.
Bui thuyt trnh nn n sm trc ngi nghe, c th lm quen vi vi ngi nghe i sm  tranh th s cm tnh ca h. Khi c gii thiu i thong th t di ln bc Trong khi thuyt trnh phi tin tng rng ngi nghe c thin ch v quan tm ti vn  mnh trnh by. Khi ni lun nhn xung ngi nghe, bao qut thnh phng  lun c mi lin h vi ngi nghe  iu chnh. Hy coi bui thuyt trnh nh l cuc ni chuyn, i thoi gia hai ngi vi nhau. Thnh thong ht th su hoc ung mt hp nc lnh nh khi c cm gic hi hp. Phi hp cc cng c h tr, chiu ln bng hnh nh no . C th cm cht ci g  (cy bt, mnh giy, hay micro) trong tay.

 Cu hi (bi tp) cng c:
1. Th no l trao i, quan st, lng nghe v trnh by?
2. Cc k thut trnh by trc quan? Cho v d.
3. Quan h tng tc Cu hi  cu tr li thch hp l g?
4. Thc hnh vit mt bi bo co, chun b mt bi thuyt trnh.`},{id:3,name:"Chng 3: C LNG CA D N",shortName:"C LNG CA D N",content:`Chng 3. C LNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c th no l c lng.
2. Bit c mt s phng php c lng

3.1 Khi nim
c lng l mt qu trnh mang tnh cht lp. Ngay trong giai on xc nh,  c th vit k hoch d n ban u, chng ta  phi tin hnh c lng ln th nht. Tuy nhin, c lng  giai on ny thng sai s t 50% n 100%. Sau khi lp k hoch  giai on phn tch, chng ta phi xem li cc c lng ny v chnh li k hoch d n ban u thnh k hoch d n cui cng. Giai on ny, c lng chnh xc ln gp i: sai s ch cn t 25% n 50%. Sau khi hon thnh thit k mc trung gian, chng ta xt li ln na cc c lng. Sai s lc ny gim xung cn 10%.

3.2 K thut c lng
C ba k thut chnh c dng  c lng: nh gi chuyn gia, qui trnh lch s v cng thc.

3.2.1 S dng nh gi chuyn gia
L phng php da vo kinh nghim ca cc nh lp trnh chuyn gia
- u im: l rt nhanh v nu chng ta tm ng c mt chuyn gia ng ngha, th vic c lng c th rt chnh xc.
- Nhc im: nu chng ta cn tm mt chuyn gia c kinh nghim trong lnh vc tng ng, m nhng chuyn gia nh vy li thng kh tm. Hn na,  chnh xc ph thuc vo thi gian chuyn gia b ra  nh gi. c lng s khng th tin cy c, nu chuyn gia  li giao cho mt ngi khc thc hin. Ngoi ra, vic ch da vo  kin ch quan ca s t chuyn gia, cng l mt iu nguy him.

3.2.2 Da vo quy trnh lch s
 khng phi ph thuc vo mt vi ngi v lm cho c lng ca chng ta c c s khoa hc hn, chng ta nn lu gi quy trnh lch s. Chng ta hy vit ra mi cng vic cn bao lu  hon thnh v ai l ngi chu trch nhim. Sau , chng ta c th so snh cng vic cn nh gi vi nhng cng vic tng t  c thc hin trong qu kh v i ti mt c lng. Nh vy, chng ta cn chia d n thnh nhng cng vic thng hay lp li  d so snh.

3.2.3 S dng cng thc
C nhiu cng thc  c cng b v c lng phn mm. Cng thc ni ting nht c tn l COCOMO (COnstructive COst MOdel). Cng thc ny c th c dng  c lng gi thnh d n, ngy cng (ngi thng), lch biu (thng), v bin ch (s nhn vin) cho tng giai on sau:
- Thit k s b (PD) - Ca chng ta l giai on Phn tch
- Thit k chi tit (DD) - Ca chng ta l giai on Thit k
- Lp trnh v kim th (CUT) - Nh ca chng ta
- Kim th h thng (ST) - Ca chng ta l giai on Chp nhn
- Kim th H thng

C ba kiu u vo cho COCOMO: trc ht l chi ph hng thng cho i ng nhn vin. Cc kiu nhn vin c th l ngi lp trnh, nh phn tch, ngi kim th, nhn vin hnh chnh, ngi vit ti liu k thut

Nhn chung, COCOMO thc hin c lng tuyt vi v cc khon mc  y l nhng yu t xc nh  di d n. Nhng c mt kh khn: mc cui cng ca COCOMO yu cu bit s dng chng trnh gc (LOSC). C  kin cho rng n lc chng ta c  hiu bit v h thng  tin on chnh xc LOSC, th chng ta cng chng cn cng thc no na - c l lc y chng ta  c th c lng c ton b d n.

3.3 Cng thc im chc nng
Cch tip cn COCOMO c ci tin kh nhiu bng nhng sn phm tnh cc hm cho LOSC nu trn, ri lp kt qu vo cng thc ca COCOMO. Mt trong nhng sn phm nh vy l Before You Leap (BYL) ca Nhm Gordon.

Mt sn phm khc cng nn xt  y l estimac ca Hip hi My tnh (Computer associatess). CA-estimac cho php chng ta tm gi thnh, ngy cng, lch biu, v bin ch nh trong COCOMO, nhng c thm cc yu cu phn cng (hng IBM), phn tch chia theo s kin ti chnh, phn tch ri ro v gi bo hnh cho c cc mi trng mt v nhiu d n. CA-estimac c th tnh ti c cc cng c pht trin h thng hin i nh b sinh chng trnh hay b to bn mu. Thm ch n cn c th c lng cc l trnh c mua hay pht trin theo yu cu.

3.3.1 c lng vic lp trnh
Mt cch tip cn cng thc t ra rt thnh cng cho vic c lng giai on lp trnh l cch tip cn im chc nng n gin. Ta hy xt chi tit cch tip cn ny l  hiu tc dng ca cc cng thc. V c bn ch c hai nhn t nh hng ti thi gian  thc hin mt cng vic:  phc tp ca cng vic (C) v hiu nng ca ngi thc hin. Hiu nng ca ngi ph thuc vo s nm kinh nghim ni chung (G) v tri thc v mt cng vic  cho (J). Di dng cng thc iu ny c th c din t l:
D = C x (G + J) [cng thc 1] vi
- D l  di thi gian thc hin cng vic
- C l nhn t  phc tp
- G l nhn t kinh nghim ni chung
- J l nhn t tri thc v cng vic ang xt

3.3.2  phc tp
 suy ra nhn t  phc tp cho mt cng vic chng ta phi chia n ra thnh cc chc nng nh nht lp li c v b sung thm  phc tp ca tng chc nng. i vi mt cng vic lp trnh, chng c gi l cc im chc nng. Cc im chc nng c th l ngi dng a vo, ngi dng hin th, thit b ngoi vi vo/ra, cu trc li d liu, kim tra iu kin, tnh ton, nhy v gi.  phc tp ca chng trnh tt nhin ph thuc vo ngn ng c dng v  phc tp ca tng thi im chc nng.

3.3.3 Cc nhn t  phc tp c lng cho vic lp trnh
Cc nhn t ny c suy ra bng cch dng cch o hin thi ri iu chnh sao cho cng thc D = C x (G + J) cho kt qu tnh bng ngi - ngy.  phc tp tng cng (C) i vi mt chng trnh s l tng cc nhn t cho cc im chc nng.

3.3.4 Hiu nng
Chng ta cn thit lp cc nhn t cho tnh hiu nng ca i ng nhn vin ca mnh. iu ny cn kh hn nhiu vi vic tnh cc nhn t  phc tp cng vic, v hiu nng ca con ngi c th thay i tu theo mc  quan tm ca h, thi ,... Hiu nng chu nh hng bi nhng nm kinh nghim ni chung v hiu bit v cng vic. Sau y l mt danh sch cc nhn t da trn kinh nghim chung ca mt c nhn:

Nhn t hiu nng da trn nm kinh nghim ni chung (G):
| Kiu ngi lp trnh | Nm kinh nghim | Phm vi nhn t |
| :--- | :--- | :--- |
| Cp cao | 5 + | 0.5 - 0.75 |
| Trung bnh | 1.5  5 | 1.0 - 1.5 |
| Tp s | 0.5 - 1.5 | 2.0 - 3.0 |
| Hc ngh | 0.0 - 0.5 | 3.5 - 4.0 |

Tc  m mt nh chuyn mn s to ra sn phm ph thuc khng ch vo kinh nghim chung (G) c tnh  trn, m cn ph thuc khng ch vo kinh nghim i vi mt cng vic hin ang lm v vi cc cng vic c lin quan. Bn cnh , khi lng tri thc thc t cn ti nn c a thnh mt nhn t. C th dng bng sau y  nh tnh cho tri thc ny (J).

Tri thc v cng vic:
| Tri thc v cng vic | Tri thc cn c: Nhiu | Tri thc cn c: Va | Tri thc cn c: Khng cn |
| :--- | :--- | :--- | :--- |
| Tri thc chi tit v vic ny v tri thc v nhng vic lin quan | 0.75 | 0.25 | 0.0 |
| Tri thc tt v vic ny v kh v vic lin quan | 1.25 | 0.50 | 0.0 |
| Tri thc kh v vic ny v khng bit v cc vic lin quan | 1.50 | 0.75 | 0.0 |
| Khng bit v vic ny v bit chi tit v cc vic lin quan | 2.00 | 1.25 | 0.25 |
| Khng bit v vic ny v khng bit v cc vic lin quan | | | |

3.3.5 Kt lun v phng php cng thc.
Phng php ny dng c nu chng ta xy dng cc nhn t chnh xc. Ci hay ca cch tip cn ny l  ch ta c th dng n cho bt k cng vic no, d  l lp trnh hay xy dng. Lu  rng phng php ny, nh bt k phng php c lng no khc, u tu thuc vo vic phn chia nh cng vic nh th no.

3.4 Qui tc c lng theo DEC (v cc cng ty ln khc)
- Khng bao gi yu cu mt ngi khng c kinh nghim lm c lng. c lng ch yu ph thuc vo kinh nghim. C th  mt ngi tp s hc lm c lng bng cch hoc  anh ta cng lm vic vi mt ngi c kinh nghim, hoc ngi c kinh nghim a ra cc cng thc chi tit ri trao cho ngi tp s kim chng.
- Lp cc nhm lm c lng nu chng ta c  nhn lc. Hiu qu ca vic kt hp nhiu tr tu tun theo quy tc bnh thng: hai tr tu gp li hiu qu gp bn ln mt tr tu n l; ba tr tu gp chn ln,...
- Khng bao gi p buc mt nh chuyn mn nh cn b lp trnh lm c lng. Ngi gim st trc ht nn hi ngi lp trnh anh ta d kin cng vic mt bao lu. Nu ngi gim st khng ng , th c th thng lng vi nhau.
- Khng bao gi ly trung bnh ca cc c lng. Vi mt sn phm chnh, nn c t nht hai nhm hay hai ngi lm c lng c lp vi nhau. Nu c sai khc ln, hy mi mi ngi ngi li vi nhau v i ti tho thun. L do duy nht  hai ngi cng kinh nghim nh nhau cho c lng khc nhau (v cng mt vic) ch l ch mt ngi c tnh n iu g  m ngi kia khng tnh.
- Chia nh xung mc mt tun hay t hn. Mt cng vic phn mm thc hin trong mt tun dng nh l iu mi ngi u hnh dung v c lng c.
- Lun lun cng thm (nhn thm?) phn ngu nhin.
- i vi cc nh qun l hay khch hng, hy lun lun a ra c lng trong khong t ... n ... y l vn  tm l. Nu chng ta ni vi nh qun l l cng vic cn 12 thng ng ta s ngh chng ta c mt con s chnh xc; nhng nu chng ta ni cng vic ny i hi t 10 n 14 thng, th ngi ta s hiu y l c lng.
- Hy dng "cm gic" ca mnh. Sau khi chng ta xy dng xong c lng, hy t hi, "c lng ny  n cha?" Cm gic li c th tr nn rt chnh xc mt khi chng ta  c kinh nghim, t ra th chng ta cng cm nhn c l c lng nh vy c vt ra ngoi phm vi "c lng" hay khng.

3.5 Tin trnh c lng
Nu nh c mt chng trnh phn mm qun l d n tt, chng ta c th s dng n  pht trin WBS ca ring mnh v a vo cc c lng cho tt c cc cng vic tng ng. Nu chng ta khng c, hy xy dng v dng cc mu sau:

Tm tt c lng d n
D n: ..................................................... Ngy thng: ...........................................
Khch hng: ............................................ Tc gi: ..................................................
n v: ....................................................
Xc nh
Phn tch
Thit k h thng
Chun b ATP
(ATP - kim th chp nhn)
Lp trnh (ti liu, chng trnh, kim th)
Chun b ti liu s dng
Kim th h thng
Chp nhn
Hun luyn khch hng
Vn hnh (bo tr)
Qun l d n
Hp d n
Ngu nhin
Cc vn  khc
Tng cng ---------------------------------------------

3.5.1 Chi tit c lng cng vic cho d n
Khon mc: ............................................ Tc gi: ..................................................
Ngy thng: ............................................ Tham kho WBS: ..................................
-----------------------------------------------------------------------------
-----------------------------------------------------------------------------
Nhim v | M t LX | CMP DYS | c lng | Ch thch
-----------------------------------------------------------------------------
Tng cng
-----------------------------------------------------------------------------
Trng c tn CMPLX l  phc tp cng vic: Thp, Trung bnh hay Cao. iu ny v sau s c dng  phn vic cho ngi c kinh nghim thp, trung bnh hay cao. Trong lp trnh, phn chia bao gi cng l Thit k, Lm ti liu, Lp trnh v Kim th.

3.5.2 Chi tit c lng lp trnh cho d n
Khon mc: ............................................ Tc gi: ..................................................
Ngy thng: ............................................ Tham kho WBS: ..................................
-----------------------------------------------------------------------------
Nhim v | M t LX | CMP DYS | c lng | Ch thch
| | | | Thit k, Ti liu, Ch/trnh, Kim th
-----------------------------------------------------------------------------
Tng cng
-----------------------------------------------------------------------------
Mt trang tnh chi tit c th tri trn cc trang tnh chi tit khc. Khng c gii hn nhng chng ta khng nn chia nh qu na ngy.

3.6 Kt lun v c lng
c lng, l kh nng yu nht ca chng ta, nhng tt c mi k hoch v kim sot u ph thuc vo k nng c lng.
c lng l mt qu trnh lp - n cn phi c hiu chnh dn.  l l do v sao cn phi c cc s kin mc trong qu trnh xy dng mt sn phm. S kin mc cho php ta dng li, tnh ton xem cn bao lu  t ti  v c lng li ngy thng cho cc s kin mc tip theo da trn kinh nghim  c.
c lng vn cn l mt ngh thut. Khng tn ti phn mm hay cng c no c sn  gip chng ta lm vic ny.

 Cu hi (bi tp) cng c:
1. Vo nhng lc no trong vng i d n chng ta cn c lng (v c lng li) v  chnh xc ca cc c lng  nh th no?
2. Hy m t phng php c lng nh gi theo chuyn gia. u l u nhc im ca phng php ny?
3. Ti sao phng php lch s li tt hn nh gi chuyn gia?`},{id:4,name:"Chng 4: LP LCH D N",shortName:"LP LCH D N",content:`Chng 4. LP LCH D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c cc khi nim v cng vic  lp lch cho d n.
2. Bit c cch nh x t k hoch vo lch biu.

Vic c lng c nu  phn trn l c lng v s ngi - ngy n lc cn  thc hin d n. iu ny cn c gi l thi gian trc tip. Vic lp lch nh x thi gian trc tip vo mt lch biu tht  cho thi hn theo lch, hay thi gian tri qua.

Chng ta bit rng cc bc thc t trong vic lp k hoch d n l:
Ngi lp k hoch (thng l Trng hay ph Ban qun l d n) lm chi tit Cu trc phn chia cng vic (WBS). Mt ngi hay mt nhm ngi c giao trch nhim thc hin cc hot ng mc thp nht.
Nhm c trch nhim ny c lng cc hot ng mc thp nht theo s ngi cn thc hin hay theo ngy trc tip.
Nhm c trch nhim cng ch ra cc hot ng trc  cn cho mi nhim v v gi  ngun ti nguyn cn cho nhim v .
Ngi lp k hoch v ra mng cc hot ng, thng di dng s  PERT.
Trng ban qun l d n ln lch cc hot ng
Phn ny m t chi tit cc bc 4,5 v 6, mng v lch cng vic.

4.1 S  PERT

PERT, ch vit tt cho k thut nh gi v xem xt chng trnh Program Evaluation and Review Technique, c Hi qun M pht minh ra nm 1958 khi pht trin tn la Polaris  mt d n bao gm 300.000 hot ng! Ban u PERT ch c dng  m t mt dy cc hot ng qua mt tp cc mi tn, nh trong hnh di

[Hnh nh: Hnh 4.1 S  PERT cho cc hot ng]

Mi mi tn biu th cho mt hot ng v c gn nhn theo tn hot ng , chng hn A, B, C... Nu mt hot ng khng th bt u trc khi mt hot ng trc n c hon tt th ui ca mi tn ca hot ng ny c t vo u ca hot ng trc . Trong hnh trn chng hn E khng th bt u trc khi D hon tt, G khng th bt u trc khi c C v F c hon tt. Cc im u v im cui mi tn  c gi l cc nt v c nh s. S  trong hnh trn dng nh c v tm thng nhng n c gi tr  v s  PERT cho bt k d n no, v n buc chng ta phi phn tch dy cc hot ng.

PERT cng ch ra hot ng no c tin hnh ng thi. Mt dy cc hot ng, nh A-B-C-G c gi l mt ng dn. Nu c cc thi dn hay cc phn ng dn song song nh ng B-C v ng D-E-F th hot ng B v C c th c thc hin ng thi vi cc hot ng D, E v F.

4.2 ng gng

C th t ti s ci tin kh ln cho s  PERT trn bng cch t thi hn cho mi nhim v trn PERT, nh trong/sau. Ta s thy cch xc nh thi hn khi ti nguyn (con ngi) c cp pht cho nhim v.

Trc ht, cn phi tnh ng gng. y l ng di nht trong mng c tnh bng cch cng dn thi hn theo ng ny. Chng hn, trong hnh sau ng nh l 26 ngy (ng gng) cn ng y l 25 ngy, vy nn ng trn l ng gng. ng kp ch ra mt ng gng hon chnh. Vic hiu bit v ng gng l iu ch cht vi ngi qun tr d n. N ch ra chiu di ca ton b d n: 26 ngy trong trng hp ca ta. N cng ch ra cc hot ng cn theo di. Nu bt k hot ng no trn ng gng b trt i (ko di hn k hoch) th ngy bn giao ca d n cng b ko trt theo.

[Hnh nh: Hnh 4.2 S  PERT c gn ti nguyn]

4.3 Th ni hay  chng

Cc hot ng khng trn ng gng c th c th ni hay  chng - tc l mt khong thi gian m cc hot ng  c th trt m vn khng nh hng ti ng gng v do  khng nh hng ti ngy bn giao. Trong hnh trn chng hn, cc hot ng D, E v F c 1 ngy th ni. (Tnh ton: cc hot ng trn ng gng B v C mt 11 ngy; ng thi cc hot ng khng trn ng gng D, E v F mt 10 ngy tt c; do  11 - 10 = 1 ngy th ni). Bt k hot ng D, E hay F hay c ba u c th ko di thm mt ngy m khng nh hng ti ng gng.

4.3.1 ng gng c th thay i

iu g xy ra nu hot ng D ko di 5 ngy thay v 3 ngy? ng gng  thay i cho ng D-E-F.  l l do ti sao ngi qun l d n phi thng xuyn cp nht mng theo mi thay i.

4.3.2 Th ni t do v th ni ton b

Trong s  PERT  di y, pha di cc hot ng ng gng n th Chng trnh A v n th Kim th A do ngi lp trnh 1 thc hin. Cc hot ng trn ng trung tm, n th chng trnh B v n th kim th B do ngi lp trnh 2 thc hin c 5 ngy th ni. Cc hot ng trn ng y, n th chng trnh C, n th kim th C v Tch hp c ngi lp trnh 3 v ngi ph trch d n thc hin. ng y c 5 ngy th ni tt c.

Th ni ton b l qung thi gian th ni m mt hot ng c trc khi nh hng ti ng gng. Th ni t do l khong thi gian th ni m mt hot ng c trc khi n nh hng ti bt k hot ng no khc (khng gng).

[Hnh nh: Hnh 4.3 Th ni hay  chng]

Th ni d n (th ni bt k theo bt k hot ng no) l mt cng vic ca ngi qun tr d n, c s dng tu theo cn nhc ca ngi ny.

4.4 Cp pht ti nguyn

Nu chng ta ang lm k hoch th cng th s  PERT l s  tt nht dng  cp pht ti nguyn. Trc ht hy v PERT b qua mi ngun ti nguyn. S  cho d n phn mm c th ta Hnh sau.

[Hnh nh: Hnh 4.4 S  PERT b qua ti nguyn]
X - Xc nh, PT - Phn tch, TK - Thit k, TH&KT - Tch hp v kim th h thng, HL - hun luyn ngi dng, VH - Vn hnh, ch/tr - chng trnh

Bc tip l v li PERT c tnh ti ti nguyn

4.4.1 Cp pht ti nguyn nhn lc

Mng trong Hnh trn c 10 hot ng ng thi tin hnh ti mt thi im v cng kt thc ng hn nu chng ta c 10 ngi lp trnh. (Hoc nu mt ngi lp trnh th phi dnh mt phn mi thi gian cho tng cng vic!) Hin nhin c cch tt hn  s dng ngi. Vic cp pht ti nguyn nhn lc mang tnh ch quan v tu thuc ch yu vo ngi sn c, nhng sau y l nhng iu phi xem ti:

- Giao nhim v cho tng c nhn c mc  k nng thch hp vi cng vic. ng trao cho mt chuyn gia mt cng vic khng  ngha g my cng ng trao mt vic rt phc tp cho ngi mi tp s.
- Giao nhim v tng t cho cng mt ngi. iu ny s lm gim thi gian hc vic hay nghin cu cng vic mi.
- Giao nhim v ch cht cho ngi chng ta tin cn nht. Ngi tin cy khng phi l ngi c th thc hin nhim v  trong ba ngy m i khi c th mt n nm hay mi ngy; ngi tin cy l ngi qu quyt cn nm ngy thc hin v  chnh l thi gian cn  thc hin nhim v.
- Giao cc nhim v cn lin lc ln nhau cho cng mt c nhn  gim thiu vic tng tc gia cc thnh vin.
- Ngi qun l d n s cn dnh thi gian  gim st, c bit vo lc bt u d n.

Hy phn mc ti nguyn nhn lc tht chi tit. Tt hn l nn  ba ngi lp trnh bn bu trong nm tun hn l s dng nm ngi trong tun u, khng cn ai c trong tun tip, ba ngi trong tun tip na v li vi ti nguyn nhn lc  c b tr. Thi gian trc tip cho tng nhim v s c rt bt nu c thm ngun nhn lc c s dng.

Quyt nh b tr nhn lc c thc hin da trn nhng iu sau: Lt1 (ngi lp trnh 1) dnh 100% thi gian cho d n, cn Lt2 v Lt3 ch lm vic cho d n trong thi k ngn. Cc n th A, B v C l kh nht nhng tng t nhau cho nn Ph ban qun l d n (PQlda) s gip Lt2 lp trnh trong tt c cc khu. Vi ph ban qun l d n nn gim st trn ng gng s lm gim s cng thng cho Trng ban qun l d n. Lt1 l mt chuyn gia cao cp lm vic mt mnh. Lt3 l ngi tp s cho nn c giao nhim v lm t liu. Lu  rng mi ngi u lm vic lin tc trong phn cng vic ca mnh.

4.4.2 Gim thi hn nhim v bng cch b sung nhn lc

Vic thm ngi vo mt nhm khng nht thit lm gim thi hn nhim v. Mt quy tc cng nghip l "Hy b sung thm t nht 10% s c lng thi gian trc tip cho tng thnh vin b sung vo mt nhm chuyn nghip". iu ny ko theo rng nu mt nhim v  mt ngi thc hin mt 10 ngy th vi 2 ngi s tn 11 ngy. Thm 10% cho mi ngi mt cch tch lu khi c nhiu ngi.

Thi hn nhim v c chuyn t hai hnh trn  c ly theo qui tc trn, cng vi mt s nh gi chuyn mn da theo vic phn chia cng vic tt n u, mi ngi trao i vi nhau nh th no...

4.4.3 Cp pht ti nguyn "Phi con ngi"

Ti nguyn phi con ngi cn cho mt d n phn mm c th l phn cng my tnh, phn mm, h iu hnh, thng tin, ti liu, hun luyn, bo hnh my tnh, cc dch v Cc khon mc ny c th c lit k ra bi ngi c trch nhim c lng. Thng thng chng ta khng bn tm ti vic t cc khon mc ny vo PERT nhng phi m bo chng c lit k ra.

4.5 Rng buc b ba

Nh ta  trnh by trc y, Chng ta c th mun cng vic c tt, r v nhanh: hy chn ly hai iu thi! Thm nhiu ti nguyn nhn lc s rt ngn thi gian nhng chi ph li cao. Chuyn mt ngi tin cy t mt hot ng phc tp nhng ngn hn sang mt hot ng di hn c th lm gim thi gian tng th nhng li c th gy kh khn cho ton b d n nu cht lng ca nhim v ngn hn b gim bt.

Nhiu cch chn la c th c khi chng ta phn phi ti nguyn. Bao gi cng hy chn nhiu cch tip cn, nhn vo hiu qu s dng ti nguyn v chi ph, chiu di ca ng gng v s n gin chung ca PERT. Ngi qun l d n phi nh gi b ba rng buc ny v i ti s cn bng tt nht tu theo cc u tin p t ln ba rng buc  do ngi dng hay qun l cp trn n nh.

Kt lun v vic rt ngn d n
Ta c nhiu gi thit  y: trc ht, cc nhim v ny u c th rt ngn c. Vic thm ngi hay lm thm gi khng tng tc thm c bao nhiu. Th hai l cc nhim v ny c th c rt ngn theo bt k th t no. Th ba l cc nhim v ny c th c rt ngn c lp nhau. Vic rt ngn mt nhim v c th nh hng ti cc nhim v khc

4.6 Lch biu hay s  Gantt

S  Gantt ch l mt s  theo thi gian. N mang tn ngi pht minh ra n, Henry Gantt.

4.6.1 Cc bc  v mt s  Gantt l

Bc 1: v cc n v thi gian trn nh. Chn n v thi gian sao cho chng ta ch cn mt s  thi. Chng ta s thy rng s  Gantt chnh l kinh thnh ca ngi qun tr d n. Tt c thng tin ph thuc lch u c th c t vo s  Gannt, v 99% cuc i ca ngi qun tr d n l tu thuc vo lch ny.

Bc 2: nh du tt c cc s kin lch  bit vo y.  l ngy l, ngh h, ngh php, hi hp, hun luyn, cam kt trc... Mi s kin m chng ta phi ln lch.

Bc 3: T s  PERT, hy lp lch cho tng hot ng. Bt u t giai on u tin. Xc nh, hy v ra mt thanh bng vi chiu di ngy theo lch trn PERT. Hy nh du nhng ngi c trch nhim v phn trm thi gian chng ta d kin cho mi ngi mt vic trong d n nu khng l 100%.

Bc 4: Lp lch cho iu bt ng theo tng nhim v. Vi mi nhim v hy t hi chng ta, "Liu c th c iu g lm ko di thi hn ca nhim v ny khng?" Chng hn, "iu g c th lm cho giai on xc nh d n ko di hn su ngy theo lch biu?" Hy ch  rng nn b sung thm hai ngy bt ng cho giai on xc nh, c th bi v ngi s dng bit qu t. Bng di y lit k mt s khon mc ri ro chung cho cc d n v cc nhim v c th ko di bi ri ro .

Bc 5: Nhn li cc bc 3 v 4, lp lch li cho tt c cc nhim v trn PERT, t tri qua phi v t trn xung di cho cc nhim v song song. Mt nhim v bt u khi s bt ng ca nhim v trc n chm dt. Hy b sung tht nhiu s bt ng vo nhim v ring cui cng, nhim v Kim th H thng, Xem nh mt bin php an ton.

D n: ABC
Tc gi: B. qun tr
Ngy: 5/9/1996
Cng ty: XYZ phn mm
Ngy bt u: 2/2/2012

Bc 6: nh du tt c cc s kin quan trng. nh u cc ct mc chnh c ch ra bi vic hon thnh cc s kin v sn phm quan trng. Phi chc chn cc ct mc  kh thng xuyn  cho thi gian gia mi ct mc l  ngn khng gy ra mt kim sot. C hai ti ba thng trong mt d n mi hai thng thng thng nn c mt ct mc. iu ny ko theo rng c th phi ba thm cc ct mc "gi", nh ct mc 3, duyt gia k lp trnh trong Hnh trn. Hy nh du cc cuc duyt xt v hp quan trng. Nhng ngi tham d vo tt c cc s kin ny s nh gi s tin trin ca d n. nh du ngy thng khi cn c cc thit b phn cng. Thi gian  cho nh sn xut cng di th chng ta cng c c hi nhn c hng ng hn.

4.6.2 Tp trung vo ng gng

Tnh ng gng
Nu chng ta ang dng my tnh  v ng gng th ng ny s c chiu sng bng  ho hay mu c bit. Nu chng ta v th cng th cn lm ni bt ng gng bng cch dng cc k t nh =.  xc nh ng gng, hy tun theo iu sau:
Nu chng ta  v s  PERT th hy tnh n   v lm ni bt cc khon mc gng tng ng trn s  Gantt, Vic tm ng gng trn s  Gantt cng n gin. Chng ta hy ly khon mc cui cng (bn phi nht) ri lm ni bt n - n bao gi cng nm trn ng gng. (Vn hnh trn hnh trn) Hy tm hot ng trc n (Chp nhn v Hun luyn) ri lm ni bt mt hot ng vi ngy chm nht (Chp nhn). Hy tm phn t ng trc ca hot ng cui cng ri lm tip nh vy cho ti khi t ti ngy khi u d n.
Tt c nhng nhim v gng hay khng c lm ni bt u c th th ni. Vic th ni xut hin t cui ca hot ng ny n u ca hot ng tip. Nu c nhiu vic k tip th phi i t ngy bt u ca vic sm nht. Vic th ni c v bng ng chm chm.

Gim ri ro trn cc khon mc ng gng
Mc du tt c cc nhim v trn d n u cn c   nhng chng ta trc ht vn phi xem xt cc khon mc trn ng gng. T hi mnh, "Nhim v ny cn nhng g, khi no v u l nh hng ca n nu n b mun hoc khng c sn?" Hy t k hoch phng bt ng vo ng ch. c bit hy ch  ti cc khon mc do ngi bn ngoi s kim sot ca chng ta cung cp. Hy xem liu chng ta c th c quyn g i vi nhng ngi cung cp ti nguyn . Vi nhn vin ni b, cch tt nht thc thi quyn lc l a u vo cuc hp xem xt vic hon thnh ca h. Vi nhng ngi hp ng bn ngoi hy c gng thng lng cc ct mc, tho lun v iu khon pht v bn giao mun. Hy tm ngun th hai cho khon mc m h cung cp.
Cc nhim v cng v sau th  ri ro cng cao. Cc nhim v sm hn dng ht cc ngy th ni ca d n lm cho cc nhim v sau tr nn cng thng. Bao gi cng phi thm  th ni cho cc nhim v cui. Nhim v cng ngn,  ri ro cng cao, v c hi cho nhim v ngn vt qu mc c lng th ln hn c hi cho nhim v di hn. Hy thm  ni ph cho nhng nhim v rt ngn, gng.

 Cu hi (bi tp) cng c:
1. ng gng trong d n l g?
2. Th no l th ni hay  chng, th ni t do v th ni ton b?
3. Rng buc b ba l g?
4. Hy cho bit cc bc  v mt s  Gantt
5. Ti sao Ban qun l d n cn tp trung vo ng Gantt?`},{id:5,name:"Chng 5: KIM SOT D N",shortName:"KIM SOT D N",content:`Chng 5. KIM SOT D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c th no l kim sot d n.
2. Bit c mt s phng php kim sot d n.

5.1 Kim sot d n
Gm ba mng cng vic chnh:
- Gim st tin  d n so vi k hoch  ra;
- Pht hin v gii quyt cc vn  ny sinh;
- Trong trng hp gp vn  khng gii quyt c, iu chnh li k hoch v thng bo tt c cc bn lin quan.

5.2 Gim st d n
 mi cp qun l khc nhau, vic gim st d n i hi nhng yu cu ring v c th tin hnh theo nhiu cch khc nhau. Di y, ta s xt t pha Ban ch o (Ban gim c) d n v t pha khch hng (ngi s dng).

5.2.1 Gim st d n t pha Ban ch o d n
PG iu hnh theo di tng ngy tin  cc cng on thit k, lp trnh v th nghim h thng. Cn trc tip gim st cc cn b chuyn mn tham gia thc hin d n ch khng phi thng qua cc bo co.

PG iu hnh cn tin hnh gim st n mc no? iu ny ph thuc vo trnh  ca cc lp trnh vin. Cn tng cng gim st trong trng hp c s trao i gia cc chng trnh. i vi mi cng on hoc mi cng vic, lc bt u l lc i hi phi theo di nhiu.

PG iu hnh lm th no  gim st c nhn vin m khng gy "nhiu", khng cn tr cng vic ca h?
- C th tin hnh gim st mt cch khng chnh thc nh gh thm, v tr chuyn.
- Gim st chnh thc, thng qua cc cuc hp hay hi  thng k hng tun.

PG iu hnh cn quan tm theo di  lm sao:
- Cc cn b lp trnh to ra sn phm hay tng cng vic c hon thnh ng thi hn, cc chc nng ph hp vi cc yu cu k thut  t ra.
- Cc cn b lp trnh tun th ng cc chun  c m t i vi cc thit k modun, lp trnh cu trc v hng dn s dng.
- Cc cng vic tin trin theo k hoch. Mi vn  c th gy ra chm gii quyt.

Ban ch o cng cn theo di tin  d n, nhng l nhng nt chnh nh thi gian v kinh ph s dng, cht lng, tnh hnh cn b cng nhn vin. G d n c th i thm  nm tnh hnh v  c c cc thng tin khng chnh thc t pha PG v cn b lp trnh. Tuy nhin, phn ln thng tin d n cho G l do cc nhm lm vic cung cp, thng qua cc cuc hp chnh thc v cc bo co.

G d n cn gim st nht l trong cc trng hp sau:
- D n pht trin chm hn so vi k hoch
- Chi ph s dng vt qu ngn sch.
- Vn  con ngi.
- Cc vn  v giao tip vi lnh o cp trn vi khch hng.

5.2.2 Gim st d n t pha cc cp qun l cao hn
Cp qun l cao hn (so vi ban ch o) ca d n gim st trn nhng phng tin sau:
- Cc kt qu cui cng ca d n; D n s hon thnh ng thi hn hay khng? D n s em li li ch nh d tnh hay khng?
- Khch hng (ngi s dng) hon ton tho mn. C quan (cng ty) qun l d n cng mt lc c th c nhiu d n ang trong giai on trin khai vi cng mt khch hng. Cc cp qun l cao nht ca hai bn cn phi gp g nhau  sao cho cc yu cu a ra u c p ng mt cch tho ng.
- Cc vn  v con ngi trong - kp ca chnh G d n. Cc cp lnh o pha trn cn phi gip  trong nhng vn  m G d n khng th t mnh gii quyt c. V nu bn thn G d n c vn 

5.2.3 Gim st d n t pha khch hng
Mc d c quan qun l d n c th khng ng , khch hng c quyn c bit tin  d n, v nu d n tht bi, khch hng l ngi b nh hng nhiu nht. Khch hng mun kim tra ngay t trc xem sn phm liu s c c giao np ng thi hn hay khng, gi cui cng phi tr c gi ng nh  quy nh hay khng v cht lng sn phm c m bo nh  ha hay khng.

Khch hng cng c th gim st d n theo ng chnh thc; yu cu cung cp cc bo co nh k  nm c tin  d n cng nh cc khuynh hng d bo, tham d phin hp ca ban ch o d n hoc nhn dp kt thc cc giai on ln. Tin  d n cn c th hin qua cc bin bn kim tra k thut  tng cng on trong qu trnh trin khai thc hin d n, vi c ch k i din khch hng. Ngoi ra, khch hng c th thng xuyn gp g Ban ch o d n  nm tnh hnh.

5.3 Pht hin v gii quyt cc vn 
Cc vn  sau y thng hay gp nht trong qun l d n:
- Cc vn  v nhn s 1-5% (nhng c u tin cao nht)
- Cc vn  v kinh ph 10-20%
- Cc vn  v lch biu 90-95%

Tuy nhin,  mt s d n kinh ph c coi l quan trng hn, thi hn c th linh hot t nhiu, trong khi  mt s d n khc thi hn li l quan trng hn.

Cc vn  v lch biu
Vn  hay gp nht i vi ngi lm qun l d n l vn  ko di thi hn. Trong s cc nguyn nhn thng dn n ko di thi hn d n c th l:
- Th t u tin thay i (c ch th, yu cu ngng d n  lm vic khc)
- Hng t c a n khng ng thi hn
- c lng sai nhiu

Khi thy mt cng vic phi ko di, trc ht cn xem cng vic  nm trn ng gng hay khng. Nu  khng phi l mt cng vic gng v thi gian ko di khng nhiu hn so vi khong thi gian th ni, th s khng c vn  g. Tri li nu thi gian ko di nhiu so vi khong thi gian th ni hoc cng vic  cho nm trn ng gng, th thi hn hon thnh d n cng s phi ko di theo.

- Nu  l cng vic ang thc hin d dang, chng ta c th th khc phc bng cch tng cng cc bin php qun l. Nu nguyn nhn ca s chm tr l cc vn  thuc v k thut, hy huy ng s gip  ca cc chuyn gia. Nu l do c nhn lp trnh vin k thut gy ra, hy tm hiu xem hon cnh, cuc sng ring t ca ngi . Ngi lm qun l d n cn c gng gii quyt cc vn  nhn s bng cch gp g, ni chuyn trc tip vi nhn vin, ch khng ch thng qua cc nhm trng.

- Nu cc n lc v qun l khng em li kt qu, hy xem xt phng n b sung ngun lc, phng tin  thc y nhanh cng vic. C th huy ng lm thm gi, song cn thn; trong lp trnh b sung thm nhn lc khng c ngha l thc y nhanh cng vic, thm ch c khi ngc li. Nn tham kho trc  kin ca nhng ngi trong nhm v ch quyt nh b sung thm ngi nu h ng .

- Xt xem cc cng vic cn phi lm, nhng cng vic no chng ta c th thc hin song song, nhng khi lp lch biu ta   ni tip ch v thiu ngun lc, phng tin ny. C th tnh hnh    thay i ngi ta c th tng cng thm cho chng ta.

- Nu c mt cng vic cha lm nhng chc l s phi ko di, v khng lin quan n s chm tr c th xy ra  cc cng vic ang tin hnh, th thng l do khng c cung cp ngun lc, phng tin theo ng yu cu v thi hn. Hy dng bin php qun l, ni kho hoc ngc li, lm gng, thm ch e do nu cn thit.

- Nu tt c cc gii php trn u khng c hiu qu, hy dng cm chp nhn v tuyn b y li thi hn d n. y l cch ph bin nht v trong chng mc no  l tt nht v nh vy t ri ro nht.

Cc vn  v kinh ph
Vn  th hai thng gp trong qun l d n l kinh ph s dng vt qu ngn sch d kin.  xc nh xem trong trng hp ny thc s c vn  hay khng, v trn c s  d bo tng chi ph cho d n cng nh thi hn kt thc, ta cn xc nh c gi tr phn vic  thc hin.

D bo Thi hn kt thc v tng chi ph bng cch tnh gi tr phn vic  thc hin (EV)
Ta xt v d 1 d n sau y. Ngn sch d tnh v kinh ph s dng c m t trn bng sau. k hoch  ra mi thng hon thnh mt modun, vi gi tr 100$ mi modun, tc l ngn sch d chi 100$ mi thng.  thi im hin ti, tc 30/4,  chi ht 450$ thay v 400$ nh d kin. Thot nhn tng nh vy l c vn , nhng thc t ta  hon thnh c 5 modun, ch khng phi 4 nh trong k hoch. Hn th na ta li ch tiu ht 450 $ cho 5 modun. Lm th no m thc hin bo co c tt c cc im tt ?

Mun vy, cn phi ch ra Gi tr ca phn vic  thc hin. Trong v d trn, EV l phn kinh ph theo ngn sch d tnh  hon thnh 5 modun, tc bng 500$

Ngy 30-4

| Cng vic | Thi hn hon thnh theo k hoch | Thi hn hon thnh thc t | Chi ph d tnh | Chi ph thc t tng t | Chi ph thc t cng dn |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 30/1 | 30/1 | 100 | 100 | 100 |
| 2 | 28/2 | 15/2 | 100 | 100 | 200 |
| 3 | 31/3 | 28/2 | 100 | 100 | 300 |
| 4 | 30/4 | 31/3 | 100 | 75 | 375 |
| 5 | 31/5 | 30/4 | 100 | 75 | 450 |
| .. | | | | | |
| 8 | 31/8 | | | | |

[Hnh nh:  th 5.1  th biu din Gi tr phn vic  thc hin (EV)]

 th ny cho thy mc d chi ph thc t vt chi ph d tnh, gi tr phn vic  thc hin li cao hn chi ph thc t. Ngi lm qun l d n c th s dng dng  th ny  d bo khuynh hng tin trin ca d n v thi hn kt thc cng nh tng chi ph.

Tht vy, gi s cc ng chi ph thc t v EV c th pht trin bng cch tip tc ko di ra. Khi  ta c th thy:

[Hnh nh:  th 5.2  th d bo]

D n kt thc khi hon thnh c 8 modun, hay khi EV bng ngn sch d tnh, tc l 800$. Ko di ng EV cho n khi gp im 800$ trn trc tung. T giao im nhn c, v mt ng thng ng. ng ny gp trc honh  u, th  l thi hn d bo s kt thc d n. Trong v d ca ta, d n d bo s kt thc vo thng by

Tt nhin, chng ta s ngng ch khi d n kt thc. V vy cn ko di ng Chi ph thc t cho n khi gp ng thng ng va v trn mt im. Qua im ny v mt ng nm ngang. Giao ca ng ny vi trc tung s cho ta d bo v tng chi ph ca d n  trong v d ang xt l 750$

Pht hin v gii quyt cc vn  ngay t trc khi chng xy ra
Di y l mt s du hiu "bo ng d n c vn :
- Lm vic khng c k hoch. D cho d n ln hay nh phi lp k hoch thc hin. Khng c d n no qu nh  khng cn phi lp k hoch c, v nu khng xy dng k hoch ngay t u, th sau  vi t cch l ngi qun l d n, chng ta s rt bn, khng c thi gian  lm vic  na.
- Cc yu cu v chc nng khng r rng hoc hon ton khng c xc nh. Nu thy ai  khng nh ngi s dng khng bit anh ta mun g", hoc "yu cu cn s thay i, hoc nu chng ta thy qu nhiu gi nh t ra, hy xem li phn c t chc nng. Hy  ngi s dng tham gia cho  kin, to mu th giao din, hoc tin hnh  cng hai giai on  xc nh r cc c t chc nng.
- c lng i khi hoc tu tin, hoc b p t. Nu nhiu  kin cho rng, s khng th hon thnh d n ng thi hn v /hoc ch vi ngn y kinh ph, chc l  c mt s i khi, tu tin hoc p t no  trong khi c tnh. Hy kim tra v c tnh li cho chnh xc, khch quan hn v bo v cc c tnh .

Pht hin v gii quyt cc vn  trong khi trin khai
Trong qu trnh trin khai cc d n thng gp cc vn  sau y:
-  xut hoc  ngh thay i hoc c t chc nng. Qua mt thi gian lm vic, trong s cc thnh vin d n c th s c  ngh thay i hoc c t chc nng, v thy nu gi nh vy th s khng th hon thnh v giao np sn phm ng thi hn c. Cu tr li  y khng phi l khng, tr khi c s ng  ca ngi s dng. Hy gc cc  ngh  li v chp nhn ko di thm thi hn. Ngay c khi khch hng  ngh thay i c t chc nng, nu trong giai on trin khai th cu tr li vn khng. Cn m phn  dnh nhng yu cu mi cho giai on tip theo
- Ti liu cha bin son xong. Ti liu, bao gm c hng dn s dng, l sn phm quan trng nht trong mt d n CNTT, hy m bo hon tt cc ti liu cn thit, thm ch nu c v th m phi y li cng vic khc.
- Th nghim khi thit k cha kt thc. Nh ta  thy trc, cc chng trnh vit trc khi c thit k bao gi cng phi vit li.
- Cc bo co nh k. Ban ch o d n cn phi ra bo co hng tun v tnh hnh trin khai thc hin d n. Nu cc bo co mi tun li thy ra mun hn, hoc ngng bt, hoc bo co sau khng c g mi so vi bo co trc, th chc chn d n c vn . Hy i tm hiu xem vn    u v th p dng cc bin php nu trn  gii quyt.
- n cc thay i v lch biu bo co trong nh k. C th  ra k hoch chnh xc cho tt c mi hot ng ca mt d n ln.
- Ngi c trch nhim lu khng thy xut hin. Nu khng thy ngi c trch nhim tr li in thoi, thoi thc hoc lng trnh mi khi nhn thy chng ta t xa, th chc c vn . Kin quyt yu cu tip xc v xc nh xem vn   u.
- (ngi s dng khng tho mn). Thng tin ny c th t khch hng phn nh, hoc t pha cc thnh vin d n. Trng ban d n, vi t cch l ngi chu trch nhim chnh giao cho khch hng, phi p dng ngay cc bin php cn thit  khch hng c tho mn.

Pht hin v gii quyt cc vn   giai on cui
Giai on kt thc ca d n l rt quan trng, v mi cng vic u nm trn ng gng. Hy c bit ch  n cc vn  sau y:
- Thiu gi my. Nguyn nhn  y thng l do khu th nghim mt nhiu thi gian hn d tnh (nhiu li k thut). Tuy nhin, th phi ko thi gian d n cn hn l bn giao mt sn phm km cht lng
- Lm ngoi gi qu nhiu. Hin tng thng xuyn phi lm ngoi gi l du hiu chc chn dn n s mt mi, kit sc. Cc cn b lp trnh thng c khuynh hng mun-thm ch ham m- li c quan lm vic sau gi hnh chnh. Trong mt gii hn no , lm ngoi gi c th c nng sut, nhng nu vt qu, chng ta s thy hiu qu rt thp, thm ch hon ton khng c. Trong mt tun, ni chung khng nn  nhn vin  li lm ngoi gi qu hai bui.
- Cc cp qun l pha trn "quan tm". Cng v cui d n (nht l nu d n kt thc mun), cc cp trn cng t ra lo lng.

* Kt lun:
Ngi lm qun l d n cn lun gi tay theo di mch p ca d n, phn ng kp thi vi mi vn  pht hin ra, v bt k trong tnh hung no cng vn phi bnh tnh, vng vng. Cui cng, nu khng c nhng vn  xy ra nh vy, th ngi ta  chng cn n nh qun l d n lm g.

5.4 Kim sot thng qua hp nh k, hp tng quan k thut v cc bo co
T d n cn phi giao tip vi nhau v th gii bn ngoi. Cc cuc hp v cc bo co chnh l nhm mc ch ny.

Trong mt d n CNTT, cc cuc hp c th c phn ra lm ba loi: Loi th nht l cc cuc hp nh k  tho lun tnh hnh trin khai d n. Loi th hai bao gm cc cuc hp nhm xem xt tng quan sn phm, pht hin v chnh sa cc vn  thuc v k thut. V loi th ba l cc cuc hp v qun l, bo co vi cc cp c lin quan v tin  d n. Cc cuc hp qun l ny cng c th l cc cuc hp nh k, nh phin hp ca Ban ch o, hoc mi t s kt sau mi cng on chnh.

Hnh thc giao tip th hai l qua cc bo co. Chng hn nhng ngi t c dp gp g trc tip vi t d n c th nm tnh hnh thng qua cc bo co nh k hng tun hoc hng thng.

Cc cuc hp nh k
Mc ch v thnh phn
i vi cc d n CNTT va v nh, cn phi c cc cuc hp nh k hng tun vi s tham gia ca tt c cc thnh vin t d n. Cc cuc hp ny l dp  cc b phn bo co vi Ban ch o v tin  d n v nhng vn  ny sinh. i vi cc d n ln, bao gm nhiu n v, nhiu nhm lm vic, cc cuc hp nh k nn chia thnh hai hay ba phn (hai hay ba cuc hp nh). Trong phn u tin ngn gn qung 30 pht n 60 pht, nht l trong tun nhm trng  theo st cc khu. Cui cng c th phn th ba, cc nhm trng li hp vi Ban ch o. Thng thng cc nhm trng ch cn bo co ming, nhng Ban ch o c th yu cu bo co bng vn bn.

Nn b tr hp nh k vo ngy no trong tun?
Cc chuyn gia v qun l d n cho rng nn b tr hp nh k vo cui tun- tt nht vo chiu th 6 hay sng th 7. Nh th, mi ngi s tp trung c gng lm vic trong tun, gt sang bn nhng g khng lin quan n d n,  cui tun c kt qu bo co. Nu b tr hp vo th hai, mi ngi s ch bt u lo vo cui tun v s lm vic cng thng c th by-ch nht  th hai kp bo co. Nh vy s khng cn thi gian ngh ngi v  b mt mi.

Cc bo co nh k
Mc ch v s trang
Hnh thc giao tip ch yu ca d n vi bn ngoi l cc bo co nh k, ngn gn v theo mu quy nh sn, do Ban ch o ra. Bo co nh k l vn  cn phi bn ti khng ch vi cc d n cng ngh phn mm, m cn vi c cc d n trong lnh vc khc na; bo co thng qu di v i hi qu nhiu thi gian  chun b. Ai cng bit rng, khi nhn c mt ti liu no , trc ht ngi ta thng lt qua my dng u tin xem c g ng gi hay khng. Nu thy hay, c th ngi ta mi c tip trang u,  ri sau  chuyn ngay xung on kt ca ti liu. Mt bo co tun ch nn di khng qu hai ba trang giy A4: phn tng thut ti a mt trang u, tip n mt hoc hai trang do my tnh in ra. Mi bo co nh vy G d n ch cn khng qu 30 pht l c th chun b xong. Khng nn k l nhiu v cc vic  qua, l gii di dng hoc thuyt gio trn lan v cc vn  sp ti. Hy dnh chuyn  cho cc cuc bn lun khng chnh thc.

nh k ra bo co
 c c nhng bc tin ng k, vic quyt nh ra bo co hng tun, hai tun hay hng thng... l tu thuc vo thi gian cn thit  hon thnh mt khi lng cng vic trung bnh trong d n. i vi nhng d n va v nh, c th phn ra thnh nhng cng vic vi thi gian thc hin khng qu mt tun, bo co tun l thch hp hn c. Nu phn ln cc cng vic phi cn mt thng mi hon thnh xong, c th ra bo co thng, cng c th ra cc bo co ngn ngy hn, nu khch hng yu cu nh vy cho h thng xuyn nm c tin , hoc trong trng hp d n ph thuc nhiu vo cc ngun lc  bn ngoi.

Ni dung bo co nh k
Bo co nh k cn bao gm nhng phn sau y:
1. Cc hot ng v kt qu thu c t bo co trc
K khai cc cng vic ang thc hin, tin  ca tng cng vic, cc cng vic hon thnh.
2. Cc vn  ny sinh
Gii thch cc tr ngi mi xut hin, do ai hoc ci g gy ra, ai chu trch nhim theo di v hin ang x l n u. Quan trng nht l xc nh nh hng ca n ti d n.
3. Cc vn   gii quyt
Gii thch tm tt (hoc dn chiu n bo co k trc), vn   c gii quyt nh th no, do ai gii quyt v tc ng ca n ln d n
4. Cc vn  cn tn ti
Nhc li  cc b phn nh l chng ta, vi t cch l ngi qun l d n, khng h qun nhng vn  cn cha c gii quyt. Ch cn mt hay hai cu l . Khng cn m t li nhng vn   cc bo co trc.
5. Lch biu mi i chiu vi k hoch
Trang hai ca bo co tt nht nn dnh cho s  Gantt do my tnh in ra. ng vi mi cng vic s c hai ng: i vi cc cng vic  hon thnh-thi gian d tnh theo k hoch v thi gian thc t s dng  lm cng vic , i vi cc cng vic cn phi lm-thi gian d tnh theo k hoch v thi gian theo lch biu mi. Gii thch tt c cc thay i so vi s  Gantt tun trc, c bit nu thi hn giao hng  khc. Gch di  nhn mnh cc thng bo ko di thi hn.
6. i chiu chi ph thc t vi d tnh ngn sch
C th s dng MS Project  c ngay s  chiu gia chi ph thc t, d tnh ngn sch (k hoch) v Gi tr phn vic  thc hin. Tm tt nhng khon mi phi chi k t ln bo co trc.
7. K hoch tun sau
Lit k cc cng vic theo k hoch v cc s kin mc ca tun ti

Cc cuc hp tng quan k thut
Mt s cc cuc hp tng quan l tn km v mt thi gian. V vy, cn bit t chc sao cho c hiu qu.
- Ln lch hp, phn chia r thi gian  tho lun tng phn
- Gi sm lch hp v cc ti liu cn thit cho cc thnh vin tham d c thi gian nghin cu trc.
- B tr a im hp sao cho khng b quy nhiu. iu khin phin hp theo chng trnh   ra, khng ch thi gian  phn cho tng mc, nhng khng qu cng nhc, nht l khi gp mt vn  quan trng cn tho lun lu hn.
- Dnh  thi gian  bn cc cng vic  k kt; kin quyt yu cu gi ng tin 

Hp xt duyt k thut (K hoch, Thit k, M ha, Th nghim, Ti liu)
Ni dung cc cuc hp ny  c nu chi tit khi trnh by cc giai on tng ng ca d n. Mc ch hp xt duyt l xem xt mt chng trnh, mt ti liu, mt k hoch th nghim l kim tra li cc sn phm , tm li v  ra cc gii php ci tin tt hn. Thnh phn tham gia c th ch bao gm tc gi sn phm a ra xt v mt hoc hai ngi na, v Ph ban ch o ph trch iu hnh. Ngoi l duy nht l hp xt duyt thit k h thng c th mi thm ba hoc bn chuyn gia ngoi.

Hp v qun l
- Hp ban ch o.  mi d n quan trng thng c mt Ban ch o, thnh phn Ban ch o bao gm Trng-Ph ban, ngi ph trch d n ca bn khch hng, mt hoc hai i din ca cc b phn (Vin, Phng, Ban...) chuyn mn c ngi tham gia d n, v t nht mt th trng cp trn, c  thm quyn i vi tt c cc b phn lin quan theo ngha l nhng n v cung cp ngun lc cho d n.
Ban ch o hp thng k vo nhng thi gian nh sn-trung bnh t 6 n 8 tun mt ln i vi mt d n t 6 n 24 thng. Mc ch hp l  thu nhn thng tin v tnh hnh trin khai d n v xc nh cc vn . Cc cuc hp ny cng gip cho cc cp qun l nm st hn tin  d n, tr nn gn gi hn vi t d n, v iu  c tc dng ng vin tt c mi ngi.

- Hp nhn dp cc s kin mc. Mi khi kt thc cc cng vic chnh nn c hp. Cc cuc hp ny cn c hai phn: Phn th nht  cc nhm k thut trao i v nhng g  lm c, cc vn  ny sinh  giai on va qua, v lp k hoch lm vic cho giai on ti. Phn th hai dnh cho tt c cc thnh vin tham gia d n bao gm c khch hng v cc cp qun l c lin quan. Trng ban ch o ch tr phin hp v sau  c th c (tic ng)  mi ngi c th trao i v hiu nhau hn. Trc khi vo tic cn bn xong cc kt qu  t c, nhng vn  t ra v ngun lc cn thit cho giai on tip theo. Cc cuc hp ny tng cng s gn b v hng hi ca mi ngi. Di y ta s  cp mt s s kin mc trong d n

Cc cuc hp c bit nhn cc dp c bit
Nhng s kin mu cht trong chu trnh d n i hi s tham gia  kin khng ch ca mt ngi. i vi mi s kin nh vy, c th b tr mt cuc hp ring  tho lun.

- Hp nh gi ri ro v quyt nh c theo ui d n hay khng.
 nh gi ri ro, nn mi nhng ngi  c kinh nghim vi cc d n cng loi. Cuc hp ny phi tin hnh trc khi a ra  xut d n,  bo m l tt c cc ri ro  c nh gi v tnh vo gi thnh d n, trn c s  quyt nh c nn b cng sc vit d n hay khng. Thnh phn hp l Trng-Ph ban ch o d n (tng lai) v cc chuyn gia.

- Khai trng d n.
Ban ch o d n t chc hp khai trng ngay sau khi d n c k kt. Cuc hp ny nn chia lm hai phn: phn long trng, hp chung, v phn hp ring, gia cc nhm k thut. Mi tham d phn u tt c nhng ai lin quan n d n; Khch hng, ngi cung cp thit b, thnh vin Ban ch o, cc cp qun l, i ng k thut vin... Mc ch  gii thiu cc bn vi nhau, t quan h giao tip, nu r ngun gc v mc tiu d n. Phin hp ny cng nhm to ra bu khng kh phn khi v hng hi bc vo d n. Phn th hai ch dnh cho cc cn b k thut, nhm  ra cc hng ch o, quy nh cc th tc,... Phi nm c chnh xc trnh  ca mi ngi v ln k hoch o to nu cn.

- Hp lp k hoch (c lng) d n.
Nh ta  thy, s rt tt nu  mt nhm nh, ba hoc bn ngi, tin hnh cc c lng cn thit. Nhm ny c th m nhim lun khu phn r cng vic, xc nh cc ngun lc, phng tin cn c v sp xp cng vic theo th t trc sau.

- Thng qua cc c t chc nng. Trc ht hp i ng k thut vin xem xt cc vn  ca giai on cui, c lng v lch biu, nht l nu c s thay i v c t chc nng. Sau  tin hnh hp chung vi ng  cc bn nh  m t  trn. Thng bo v mi thay i trong k hoch nh li thi hn giao sn phm hoc nng gi. Cn c s cam kt t pha cc b phn thit k v lp trnh.

- Tho lun chi tit thit k mc cao nht.
Ph ban ch o iu hnh phin hp. Nhiu nht ch nn khng qu 5 ngi tham d bao gm cc cn b thit k, chuyn gia ngoi hoc lp trnh vin c kinh nghim. Tc gi thit k trnh by cc phng n khc nhau, ni r u im v nhc im ca tng phng n. Nhng ngi tham d b xung  kin v  ngh cc phng n khc ca h. Cuc tho lun chi tit ny ko di t 2 n 4 gi.

- Tho lun chi tit thit k mc trung.
i vi cc d n ln, cn tin hnh tho lun chi tit v la chn thit k tng mc, v tt nhin l cho thit k hon chnh. Mc ch cc bui tho lun ny nhm pht hin tt c cc vn  cn cn phi lm r trong thit k. Tu thuc vo s lng modun trong thit k, c th phn ra mt s bui, nhng khng nn qu 5 ngi tham gia v mi bui ko di khng qu t 3 n 5 gi

- Thng qua thit k h thng.
Mc ch v cch tin hnh ging nh hp thng qua cc c t chc nng. Xem xt li mt ln na cc c lng,  ngh cam kt v cc iu khon khc nhau nh bn giao phn cng, i ng cn b lp trnh, khu chp nhn, ti liu hng dn s dng..

- Tho lun chi tit v thit k modun, ti liu v k hoch th nghim.
Ba  mc ny c th tho lun chung. Ch c Ph ban ch o ph trch iu hnh, cn b ph trch nhm lp trnh v c th thm mt cn b lp trnh tham gia. Cuc hp phi khng nh thit k  chn l tt nht, v xem cn vn  g na khng. C th tho lun lin my modun, nhng mi modun khng qu t 1 n 2 gi, v mi bui khng qu 4 gi. Tc gi modun trnh by, ghi li cc  kin  xut,  suy ngh, tm cch gii quyt v s bo li vi Ban ch o sau

- Tho lun m ti liu cho ngi dng.
Tt c nhng iu trnh by  phn tho lun modun cng s ng  y. Tuy nhin cuc tho lun ny chi tit c th c nhiu ngi tham d.

- Hp kt thc chp nhn th nghim (s kin mc).
y khng tht s l s kin mc nh mt s s kin mc khc. Ch xem nh cuc gp mt gia khch hng v Trng ban ch o d n.

- Hp kt thc giai on vn hnh (s kin mc)
y thc ra khng phi l mt cuc hp, m l mt ba tic v tt c mi ngi u c mi, mt dp  x hi v chuyn sang giai on hu d n

- Hp rt kinh nghim sau d n.
y l mt vic thng hay b b qua, mc d rt quan trng. Cn phi c hai phin hp- phin hp vi khch hng v hp ni b. Hp vi khch hng c th mi c t d n v cc cp qun l cao hn. Khng  phin hp ny tr thnh qua loa. Mc ch l phn tch cc trc trc xy ra vi ngi s dng v bn cch khc phc nhng s kin  trong tng lai. Trong trng hp khch hng khng tho mn, y c th l dp  chng t vi h rng vn  khng nm trong tm kim sot ca chng ta. Trong trng hp khch hng tho mn, c th  ngh h gii thiu vi cc khch hng khc.

Phin hp th hai l gia t d n vi cc cp qun l c lin quan. Phi lm sao y tht s l phin hp ph bnh xy dng. Phn tch nhng thiu st sai lm, lm th no  trnh c nhng thiu st sai lm  trong tng lai, ghi li cc  xut tng ng.

- Bo co sau d n.
Kt qu cuc hp rt kinh nghim sau d n c ban ch o trnh by trong mt bo co chnh thc. Bo co ny s l mt ti liu tng kt s c lu hnh cho nhiu d n khc cng nh c th s c nhiu ngi ngoi d n xem. Bo co sau d n cn bao gm nhng phn sau y:
- D n  c hnh thnh nh th no, mc tiu ban u, cc gii php  xut
- Phng php v t chc d n, cc kin ngh ci tin nu c
- So snh k hoch  ra vi kt qu t c trn thc t. Nu c s khc nhau ng k  gii thch v sao
- Cp nht cc cng thc v t s dng  c lng
- Cc im thnh cng ca d n
- Cc ri ro  gp phi,  xut  trnh nhng ri ro  trong tng li. Cp nht ti liu lu v ri ro.
- Cc phn ca sn phm c th ti s dng

Hp tho lun cc vn  gay cn. C trng hp Trng ban ch o mt mnh khng th gii quyt c kh khn t ra. V d nh tnh trng nhiu cn b lm cho d n xin thi vic v do  phi tm ngi thay th, cc ngun lc, phng tin quan trng khng c cung cp, nhiu cn b qu mt mi hoc mu thun ln nhau, lin h gia d n v ngi s dng b gin on Trng ban ch o d n cn mi hp  tham kho  kin tt c cc bn lin quan. Thng thng cn c cp i din qun l cao ca hai bn, bn d n v bn ngi s dng, tham gia.

Kt lun: Cc cuc hp xem xt tng quan v k thut l khng th thiu c, nu mun d n t kt qu tt. Cc cuc hp chung khc nhm m bo lin h gia d n vi bn ngoi. Nhng khng phi bt k trng hp no cng phi hp. Ch t chc hp khi cn trao i trc din gia cc bn. Ngoi ra c th s dng cc phng tin khc nhau nh th, cng vn, gi in, fax, Email...

 Cu hi (bi tp) cng c:
1. Kim sot d n l g? Kim sot d n gm nhng mng cng vic no?
2. Hy cho bit cc cp  gim st?
3. Ch ra cc phng php gim st hiu qu?`},{id:6,name:"Chng 6: QUN L PHM VI CA D N",shortName:"QUN L PHM VI CA D N",content:`Chng 6. QUN L PHM VI CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca qun l phm vi.
2. Hiu c qui trnh qun l phm vi.
3. M t s h tr ca phn mm trong qun l phm vi d n.

6.1 Qun l phm vi l g?
Phm vi (Scope) l mt danh sch tt c nhng g d n phi lm (v cng c th l mt danh sch tt c nhng iu m d n khng phi lm). D n phi c mt phm vi c vit ra r rng, nu khng d n s khng bao gi kt thc.
- Cc Kt qu chuyn giao (Deliverables) l nhng kt qu ca d n m s chuyn giao: nh l Phn cng, phn mm (mua hoc t lm), bo hnh, ti liu, o to v phng thc chuyn giao.
- Nhm d n v cc bn lin quan (Stakeholders) phi cng hiu nhng sn phm no c to ra nh l kt qu ca d n v chng c to ra nh th no.

6.2 Cc qui trnh qun l phm vi d n
- Khi ng: Bt u mt d n hoc chuyn tip sang giai on tip theo.
Xy dng k hoch chin lc
Bc u tin trong khi ng d n l nhn vo bc tranh tng th hay l k hoch chin lc ca cng ty. K hoch chin lc i hi xc nh cc mc tiu nghip v lu di. Cc d n CNTT cn h tr cc mc tiu chin lc v ti chnh.
+ Xc nh cc d n tim nng.
+ Sau  chn cc d n CNTT v phn b ti nguyn.
Cc phng php chn d n.
Tp trung vo nhu cu chung ca d n, phn loi d n v phn tch ti chnh. Dng WSM (m hnh tnh im c trng s) hoc thc hin BC (Bng im cn i)

6.2.1 Tn ch d n

[Hnh nh: Tn ch D n (Project Charter)]

6.2.2 Lp k hoch phm vi
L qu trnh xy dng cc ti liu nhm cung cp nn tng v phm vi ca d n. Tuyn b v phm vi (scope statement) gm:
 Kim chng v d n (project justification)
 M t ngn v sn phm ca d n
 Tng kt v tt c cc sn phm trung gian ca d n
 Tuyn b v nhng yu t xc nh thnh cng ca d n

[Hnh nh: PHT BIU V PHM VI - Scope Statement]

6.2.3 Xc nh phm vi
Sau khi hon tt k hoch v phm vi, bc tip theo l xc nh chi tit cng vic bng cch chia thnh cc cng vic nh hn c th qun l c.
- Lp k hoch phm vi: pht trin cc ti liu nhm cung cp nn tng cho cc quyt nh v d n trong tng lai.
L qu trnh xy dng cc ti liu nhm cung cp nn tng v phm vi ca d n. Tuyn b v phm vi (scope statement) gm:
+ Kim chng v d n (project justification)
+ M t ngn v sn phm ca d n.
+ Tng kt v tt c cc sn phm trung gian ca d n.
+ Tuyn b v nhng yu t xc nh thnh cng ca d n.
- Xc nh phm vi: chia nh cc sn phm trung gian ca d n thnh cc thnh phn nh hn, d qun l hn.
Xc nh ng phm vi: Gip ci tin s chnh xc v thi gian, chi ph, v ti nguyn; Xc nh nn tng  o hiu sut vn hnh v iu khin d n; Gip truyn t r rng cc trch nhim ca mi cng vic.
Cu trc phn r cng vic (WBS).
+ Chia nh cng vic theo s  phn cp.

[Hnh nh: WBS cho D n]

6.2.4 Cc nguyn l c bn to WBS
1. Mt n v cng vic ch xut hin mt ni trong WBS.
2. Ni dung cng vic trong mt mc WBS bng tng cc cng vic di n.
3. Mt mc WBS l nhim v ca ch mt ngi, ngay c khi c nhiu ngi thc hin cng vic ny
4. WBS phi nht qun vi cch thc hin cng vic; trc ht n phi phc v nhm d n v cc mc ch khc nu thc t cho php.
5. Cc thnh vin nhm d n phi tham gia pht trin WBS  bo m tnh nht qun.
6. Mi mc WBS phi c ti liu i km  bo m hiu c chnh xc phm vi cng vic.
7. WBS phi l cng c linh hot  p ng nhng thay i khng trnh c, iu khin ni dung cng vic theo ng tuyn b v phm vi.
- Kim tra phm vi v iu khin thay i phm vi: hp thc ha vic chp nhn phm vi ca d n, iu khin nhng thay i ca phm vi d n.
Rt kh to c tuyn b phm vi tt v WBS tt cho mt d n. Kim tra phm vi d n v gim thiu thay i phm vi l iu kh hn. Nhiu d n CNTT chu phi tnh trng phm vi phnh ra (scope creep) v kim tra phm vi khng tt.

* Cu hi (bi tp) cng c.
1. Qun l phm vi d n gm nhng g? Tm quan trng ca n i vi cc d n CNTT.
2. Cc phng php chn d n. Dng v d  minh ha.
3. Cc thnh phn chnh ca bn tuyn b phm vi (scope statement). Ti sao phi c bn tuyn b phm vi nu  c tuyn b d n v WBS.
4. Trnh by cc phng php xy dng WBS, gii thch ti sao cng vic ny thng rt kh.
5. M t mt d n b vt phm vi  (scope creep). C th trnh tnh hung ny c khng?
6. Ti sao  s dng phn mm qun l d n phi c WBS tt? Gii thiu cc loi phn mm khc dng trong qun tr phm vi d n.`},{id:7,name:"Chng 7: QUN L THI GIAN CA D N",shortName:"QUN L THI GIAN CA D N",content:`Chng 7. QUN L THI GIAN CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l thi gian d n.
2. Hiu c cc qui trnh qun l thi gian.
3. Hiu c cc phng php dng  qun l thi gian: CPM (Critical Path Method), PERT (Program Evaluation and Review Technique).
4. M t cch dng phn mm trong qun l thi gian d n.

7.1 Tm quan trng ca vic qun l thi gian
Kt thc d n ng hn l mt trong nhng thch thc ln nht.
Thi gian qu hn trung bnh l 222% (theo bo co ca CHAOS nm 1995; c ci tin ln 163% vo nm 2001).
Thi gian c  linh hot b nht; n tri qua bt k iu g xy ra.
Cc vn  lch biu l l do chnh dn n xung t trong d n, c bit l trong na sau ca d n.

7.2 Cc Qui trnh qun l thi gian d n
Qun l thi gian d n gm nhng qui trnh bo m hon tt d n ng hn. Nhng qui trnh ny gm:
- Xc nh cc hot ng
- Sp th t cc hot ng
- c lng thi gian cho mi hot ng
- Pht trin lch biu
- iu khin lch biu

7.3 Xc nh cc hot ng.
Lch biu d n bt ngun t ti liu khi ng d n
- Bn tuyn b d n c cha ngy bt u v kt thc, cng vi thng tin v ngn sch.
- Tuyn b phm vi v WBS gip xc nh cn phi lm nhng g.
- Xc nh hot ng i hi pht trin WBS chi tit hn cng vi nhng li gii thch  hiu c tt c nhng vic cn lm, nhm c c cc c lng ph hp vi thc t

7.4 Sp th t cc hot ng.
- Xem xt cc hot ng v xc nh quan h ph thuc
+ Ph thuc bt buc: c hu do bn cht cng vic.
+ Ph thuc xc nh bi nhm d n.
+ Ph thuc lin quan gia cc hot ng bn trong d n v bn ngoi d n.
Dng Phng php CPM (Critical Path Method)  xc nh cc quan h ph thuc.

7.5 c lng thi gian cho mi hot ng.
c lng thi gian cho mi hot ng, ty theo hng tip cn s c cc c lng khc nhau.
+ CPM: thi gian mi cng vic l thi gian xc nh, cho php thc hin c cng vic .
+ PERT: tnh thi gian mong mun (k vng) ca thi gian thun li (lc quan), thi gian khng thun li (bi quan) v thi gian trung bnh thc hin c cng vic .
+ Lp Bng phn tch CPM (PERT) v xc nh ng ti hn (biu din bng s  GANTT) v xc nh thi gian hon thnh c d n.

7.6 iu khin lch biu.
- Kim tra lch biu so vi thc t
- S dng k hoch phng h bt trc
- Khng lp k hoch cho mi ngi lm vic 100% kh nng vo mi thi im.
- T chc cc bui hp tin  vi cc bn lin quan, v tht r rng, trung tht khi bn v cc vn  lin quan n lch biu.

* Cu hi (bi tp) cng c:
1. Gii thch ti sao lch biu (schedule) thng gy nhiu xung t (conflict) trong cc d n.
2. Ti sao vic xc nh cc hot ng l bc u tin trong qun l thi gian d n?
3. Ti sao phi xc nh tun t cc cng vic trong d n?
4. Gii thch s khc bit gia c lng thi gian cho cng vic v c lng n lc  thc hin cng vic.
5. Gii thch cc khi nim biu  Gantt.`},{id:8,name:"Chng 8: QUN L CHI PH",shortName:"QUN L CHI PH",content:`Chng 8. QUN L CHI PH

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l chi ph d n
2. Hiu c mt s khi nim v thut ng v qun l chi ph.
3. Hiu c cc qui trnh qun l chi ph
4. M t cch dng phn mm trong qun l chi ph d n

8.1. Khi nim qun l chi ph d n.
Chi ph l ti nguyn c hy sinh hay tnh trc  t c mt mc tiu r rng hay  trao i ci g . Chi ph thng c o bng n v tin t.
Qun l chi ph d n bao gm nhng quy trnh yu cu m bo cho d n c hon tt trong s cho php ca ngn sch.

8.2 Qui trnh qun l chi ph d n.
Qun l chi ph d n gm nhng qui trnh bo m cho d n c hon tt trong s cho php ca ngn sch. Nhng qui trnh ny gm:
 Lp k hoch cho ngun ti nguyn: xc nh ngun ti nguyn cn thit v s lng  thc hin d n.
 c lng chi ph: c tnh chi ph v cc ngun ti nguyn  hon tt mt d n.
 D tan chi ph: phn b ton b chi ph c tnh vo tng hng mc cng vic  thit lp mt ng mc (Base line) cho vic o lng vic thc hin.
 Kim sot  iu chnh chi ph: iu chnh thay i chi ph d n.

8.3 Lp k hoch ngn sch (Chi ph).
 Lp k hoch cho ngn sch ph thuc vo bn cht ca d n v t chc. Khi thc hin lp k hoch cho ngn sch cn cn nhc mt s vn  sau:
- Cc kh khn no s gp khi thc hin cc cng vic c th trong d n?
- C phm vi nht nh no nh hng n ngun ti nguyn?
- T chc  thc hin nhng cng vic no tng t nh d n?
- T chc  c  ngi, trang thit b v vt t  thc hin d n?

8.4 c lng chi ph
 u ra quan trng ca qun l chi ph d n l c tnh chi ph. C nhiu loi c tnh chi ph v nhng cng c cng vi k thut gip to ra chng. iu quan trng l chng ta pht trin mt k hoch qun l chi ph trong  m t s dao ng chi ph s c qun l trong d n ra sao
 Cc lai c tnh chi ph:

| Loi c tnh | Khi no lm? | Ti sao lm? |  chnh xc |
| :--- | :--- | :--- | :--- |
|  ln th (ROM) | Rt sm trong chu trnh 3- 5 nm trc | Cho bit chi ph th  quyt nh la chn | -25%, +75% |
| Ngn sch | sm 1-2 nm xong | a $ vo cc K hoch Ngn sch | - 10%, +25% |
| Xc nh | Mun hn trong d n < 1 nm xong | Cung cp chi tit  mua, c lng chi ph tht s. | -5%, +10% |

Cc phng php c tnh chi ph:
o Tng t hay Trn - xung (top-down): s dng chi ph thc t trc , cc d n tng t lm nn tng c bn  lm c tnh mi
o Di ln (Bottom-up): c tnh ring tng nhm lm vic v tnh ton con s tng cng.
o M hnh im chc nng.
o Dng thng s: s dng cc c im ring bit trong d n p dng phng thc ton hc  c tnh chi ph. M hnh COCOMO (Constructive Cost Model) l m hnh thng dng.

8.5 D tan chi ph.
8.5.1. Kim sat - iu chnh chi ph.
Kim sat - iu chnh ph bao gm :
 Gim st hot ng chi ph.
 Bo m rng ch c s thay i hp l u c ghi nhn trong ng mc (Base line).
 Thng bo nhng thay i n nhng ngi c thm quyn.
EMV (Earned value management): l mt cng c quan trng h tr kim tra chi ph.
 EVM l mt k thut o lng s thc hin d n thng qua tch hp cc d liu v phm vi, thi gian, v chi ph;
 a ra mc chi ph (Cost Base line) (d tnh ban u cng vi s thay i cho php), ngi QL cn phi xc nh cch tt nht m d n t c mc tiu.
 Cn phi c thng tin nh k  s dng EVM.

8.5.2 Thut ng trong EMV
 Gi tr tr tnh (PV=Planned Value), cn gi l ngn sch chi ph cng vic  ln lch (BCWS=Bugedted Cost of Work Scheduled), cng l ngn sch d tr cho tng cho tng chi ph s chi tiu cho mt cng vic trong sut mt giai on nh trc.
 Chi ph thc s (AC=Actual Cost), cn gi l chi ph thc s ca cng vic c thc hin (ACWP= Actual Cost of Work Performed), l tng cng cc chi ph trc tip hay gin tip trong vic hon tt cng vic trong mt giai on nh trc.
 Gi tr thu c (EV= Earned Value), cn gi l chi ph ngn sch cho vic tin hnh cng vic (BCWP= Budgeted Cost of Work ), l d tr gi tr ca cng vic tht s hon thnh

8.5.3 Cc cng thc tnh trong EMV

| Khi nim | Cng thc |
| :--- | :--- |
| Gi tr thu c (EV) | EV=PV * (%Thi gian hon thnh) |
| Chi ph pht sinh (CV= Cost Variance) | CV = EV - AC |
| Bin ng Lch (SV= Schedule Variance) | SV = EV  PV |
| Ch s thc hin chi ph (CPI=Cost Performance Index) | CPI = EV/AC |
| Ch s thc hin lch (SPI=Schedele performance index) | SPI = EV/PV |
| c tnh ti thi im hon tt (EAC=Estimate at completion) | EAC = BAC/CPI |
| c tnh thi gian hon tt (Estimate time to complete) | c tnh thi gian ban u/SPI |

Nhn xt:
- CV cho bit s sai bit gia chi ph tht s v gi tr thu c.
- SV cho bit s sai bit gia han thnh theo lch v gi tr thu c.
- CPI l t s gia gi tr thu c v chi ph tht s. Nu bng 1 th ph hp, <1 vt ngn sch.
- SPI l t s thc hin theo lch. Nu bng >1 th han thnh trc lch v <1 ngc li.

V d:

| Hot ng | Tun 1. |
| :--- | :--- |
| Gi tr thu c (EV) | 7 500 |
| Gi tr tr tnh (PV) | 10 000 |
| Chi ph tht s (AC) | 15 000 |
| Chi ph pht sinh (CV= Cost Variance) | CV = EV - AC = -7 500 |
| Bin ng Lch (SV= Schedule Variance) | SV = EV  PV = - 2 500 |
| Ch s thc hin chi ph CPI | CPI = EV/AC *100%= 50% |
| Ch s thc hin lch SPI | SPI = EV/PV*100% = 75% |

*Cu hi (bi tp) cng c:
1. Cc khi nim c bn trong qun tr chi ph, nh li nhun, chi ph chu trnh sng, chi ph v li ch hu hnh v v hnh, chi ph trc tip v gin tip
2. Gii thch nhng iu xy ra trong qu trnh d tho ngn sch?
3. M t cc loi phn mm h tr qun tr chi ph d n?`},{id:9,name:"Chng 9: QUN L CHT LNG CA D N",shortName:"QUN L CHT LNG CA D N",content:`Chng 9. QUN L CHT LNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l cht lng d n.
2. Hiu c cc qui trnh qun l cht lng.
3. M t cch dng phn mm trong qun l cht lng d n.

9.1 Cht lng l g ?
T chc quc t v tiu chun ho (ISO=International Standart Organisation) xc nh cht lng nh tng th cc chi tit nh ca mt sn phm m n phi tho mn nhng quy nh  c  ra.
Mt s chuyn gia khc li nh ngha theo nguyn tc c bn:
- Yu cu ph hp: tho mn cc yu cu i hi
- Tin li cho s dng: chc chn rng mt sn phm c th c s dng ngay t khi c  nh sn xut n.

9.2 Qui trnh qun l cht lng
Qui trnh qun l cht lng bao gm ba giai an:
1) Lp k hoch cht lng: nhn bit c tiu chun cht lng no c lin quan ti d n v nhn bit nh th no v lm th no tha mn chng.
2) m bo cht lng: nh gi ton b vic thc hin d n  chc chn d n s tho mn nhng vn  lin quan ti tiu chun cht lng.
3) Kim tra cht lng: kim tra chi tit nhng kt qu d n  chc chn rng chng  tun th nhng tiu chun cht lng c lin quan trong khi  tm ra nhng cch  ci tin cht lng tng th.

9.2.1 Lp k hoch cht lng
- iu quan trng  thit k trong tiu chun cht lng v truyn t nhng yu t quan trng gp phn trc tip p ng nhng i hi ca khch hng.
- Nhng th nghim trong thit k gip nhn ra tc ng c th thay i trong ton b kt qu ca mt quy trnh.
- Nhiu kha cnh phm vi ca cc d n cng ngh thng tin nh hng cht lng nh cc chc nng, c im, u ra ca h thng, tnh hot ng,  tin cy, v kh nng duy tr.

9.2.2 m bo cht lng
- Bo m cht lng bao gm tt c cc hot ng lin quan ti vic nhn bit nhng vn  ca mt d n.
- Mt mc tiu ca vic bo m cht lng na l lin tc ci tin cht lng.
- Qui trnh nh gi (Benchmarking) c th s dng  pht minh nhng sng kin ci tin cht lng.
- Kim nh cht lng gip ta rt ra nhng bi hc  ci tin vic thc hin  hin ti hay nhng d n trong tng lai.

9.2.3 Kim tra cht lng
u ra cho vic qun l cht lng l:
- Tn thnh nhng s quyt nh.
- Lm li
- Sa i Qui trnh
Mt s k tht v cng c bao gm:
- Phn tch Pareto
- Mu thng k
-  lch chun.

Phn tch Pareto.
- Phn tch Pareto xc nh cc nguyn nhn gy ra vn  v cht lng. N cn c gi l qui tc 80 -20, c ngha l 80% c vn  l do 20% nguyn nhn ca cc vn  cn li. S  Pareto l nhng s  gip nhn bit v xc nh u tin cho cc loi vn 

9.3 Ci tin cht lng d n cng ngh thng tin.
Mt vi  xut ci tin cht lng cho d n l:
- Lnh o thc y cht lng. y l thnh phn ht sc quan trng trn cng ca tm qun l cht lng. Trong trng hp thiu s th hin quan tm lnh o, nhng vic nh nht s xy ra sau ny.
- a s vn  cht lng u lin quan vi qun l, khng phi l vn  k thut.
- Hiu bit r v chi ph cht lng. Chi ph m bo cht lng l:
+ Chi ph hp l hoc cung cp nhng mt hng m p ng yu cu cn thit v thun tin cho vic s dng.
+ Chi ph khng hp l hay lm sai bn phn hay khng thc hin ng yu cu  ra.

9.4 Nm loi chi ph lin quan n vn  qun l cht lng:
- Chi ph ngn nga: chi ph d tnh v thc thi d n c th l khng li hay li c th chp nhn c.
- Chi ph cho s nh gi: chi ph nh gi qu trnh v sn phm a ra t cht lng.
- Chi ph cho sai st trong cng ty: chi ph dng  ch nh chnh xc thiu xt c nh ra trc khi khch hng nhn c sn phm.
- Chi ph sai st bn ngoi cng ty: chi ph lin quan n tt c li khng c nhn ra trc khi a n cho khch hng.
- Chi ph cho cng c th nghim v o lng: vn cho cng c dng  phng trnh v nhng hot ng nh gi.

Ch tm vo nhng vic nh hng ti cng ty v mi trng c th nh hng ti cht lng.
- Nhng vn  thuc v t chc c nh hng ln n nng sut lm vic ca cc nhn vin lp trnh hn l mi trng k thut cng nh ngn ng lp trnh.
- Nng sut ca nhn vin lp trnh thay i theo t l 1/10 gia cc t chc, nhng ch 21% trong cng mt t chc. Khng c s lin quan no gia nng sut v ngn ng lp trnh, s nm lm vic hay mc lng.
- Mt khng gian lm vic tn tm, mt mi trng lm vic yn tnh l yu t chnh cho vic ci thin nng sut ca cc lp trnh vin.

* Cu hi (bi tp) cng c:
1. Qun l cht lng d n gm nhng qui trnh chnh no?
2. Cc loi thng tin trong k hoch bo m cht lng
3. Ba u ra chnh ca kim sot cht lng
4. Lch s ca qui trnh cht lng hin i.
5. M t 3 loi phn mm h tr qun l cht lng d n`},{id:10,name:"Chng 10: QUN L NGUN NHN LC CA D N",shortName:"QUN L NGUN NHN LC CA D N",content:`Chng 10. QUN L NGUN NHN LC CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l nhn s ca d n.
2. Hiu c cc qun l nhn s.
3. Dng phn mm trong qun l nhn s d n.

10.1 Nhn s d n
Trong thc t c rt nhiu cuc hp bn v cc vic khc nhau, nhng li khng phn r trch nhim ai lm vic g. L d nhin l sau  chng ai lm vic g c-v ngi no cng ngh l  c ngi khc lm, khng phi vic ca mnh. Nhn s d n trc ht l t chc d n- cn bit chnh xc ai lm vic g,  u, khi no?

10.2 T chc d n
T d n
i vi cc d n quy m va v nh, hnh thc t chc bn di t ra thch hp

[Hnh nh: Hnh 10.1 T chc cc d n va v nh]

Mi ngi trong t c cng vic ring ca mnh. Cng vic ca cc cn b lp trnh, nh tn  gi, l vit chng trnh phn mm. PG k thut gim st, ch o tt c cc cng vic thuc v k thut, gii quyt cc vn  lin quan n h thng, ng thi chu trch nhim v cht lng sn phm. Trn cng l G Ban qun l d n lnh o v mt qun l, m bo lin h gia d n vi bn ngoi, ng thi chu trch nhim v k hoch v kim sot.

Ngi ta nhn thy rng, mi trng nhm k thut thng theo di tt c 5 cn b lp trnh.
D n c th c phn thnh cc t, sao cho mi t c th coi nh l mt d n c lp tng i.

T chc theo chuyn mn
Rt nhiu hng, cng ty p dng hnh thc t chc theo chuyn mn. V d nu hng chuyn sn xut mt s loi phn mm, th c th phn chia thnh cc b phn, mi b phn chu trch nhim v mt loi phn mm nht nh.
Hnh thc t chc theo chuyn mn nh trn c c u im ln nhc im. u im l cc cn b trong cng mt chuyn mn d hiu nhau hn, v ngi lm qun l ng thi l trng phng chuyn mn nn cng d lm vic hn. Nhc im l trong trng hp d n cn n nhiu lnh vc chuyn mn khc nhau, th s phi mi chuyn gia ngoi. Cc chuyn gia ny cng lc lm vic cho nhiu d n, nn thng h khng c  thi gian  hon thnh phn vic c giao mt cch c cht lng. Ngoi ra, i vi mt cn b c nng lc v thch ci mi, lm vic mi cho nhng d n ging nhau, c th dn n km ho hng v nhm chn.

10.3 Vai tr ca G d n
Vai tr quan trng nht ca G (Trng ban qun l) vi t cch l ngi qun l d n l lin h gia d n vi bn ngoi, G c trch nhim bo co k hoch v tin  d n cho khch hng, cho cp qun l cao hn v cho tt c cc bn lin quan. Mi thng tin t bn ngoi c nh hng n d n, kinh ph, lch biu, nhn s, cc thay i v t chc cng u qua G d n xem xt, sau  mi thng bo li ti cc b phn c nhn lin quan.
Qun l nhn s d n cng thuc v trch nhim ca G. G d n l th trng, l ngi ng vin, khuyn khch l ngi gii quyt mi vn  v con ngi t ra trong d n.
Ngoi ra G d n phi bit bo v d n v bit bo v chnh mnh khi b chi phi bi v vn nhng th tc lin quan, cng nh nhng cng vic s v hng ngy, tp trung thi gian v ngun lc vo thc hin cc mc tiu ca d n.
Di y ta s bn v trch nhim ca G trong tng giai on ca d n:

1. Giai on xc nh.
G c th l mt trong nhng ngi tham gia quyt nh c theo ui d n hay khng, ch tr cc cuc trao i v gip ngi s dng tho ra cc yu cu. G d n c khi chnh l tc gi ca  cng d n. PG k thut s m nhn phn trnh by v k thut trong  cng, ng thi phc tho s b k hoch d n. Phn ri ro cng c vit vi s h tr ca cc chuyn vin. G d n lp k hoch phn b  mc tng th, sau  giao b phn ph trch k thut phn chia tip v cho cc c lng. Sau khi cc cng vic c phn ra mt cch chi tit, G s tnh ton tng chi ph, vch ra lch thc hin v lin h vi cc bn cung cp ngun lc.
G d n ch tr tt c cc cuc hp vi khch hng, m phn bng vn bn, thng nht vi i ng k thut vin v tt c nhng thay i trong vn bn d n, v cng vi khch hng k kt.
Sau khi vn bn d n c k kt, G s lp ra Vn phng D n, ni sau ny tp trung tt c cc ti liu d n, bao gm cc bo co nh k, chng trnh v bin bn cc phin hp, cc vn bn ghi nh.

2. Giai on phn tch.
G d n phi vit cc phn sau y trong h s c t chc nng: Cc ti liu bn giao, thay i c t, Chp nhn, Giao din ngi s dng, Trch nhim ca pha ngi s dng (chi tit do PG k thut cung cp), Cch thc v iu kin, Bo hnh cng nh v cc hiu ng m h thng mi c th gy ra do tc ng ln mi trng ngi s dng.
G d n m bo xy dng c t Chc nng xong ng hn (pha khch hng cung cp m t u vo ng hn), m phn c t chc nng vi khch hng v  khch hng k xc nhn ng . Giai on ny l lc G d n tp trung vo lp k hoch d n. Phi c c s cam kt ca cc bn cung cp ngun lc, nht l ca cc phng chuyn mn v vic c cn b thit k v lp trnh tham gia d n. Nu thy c nhu cu cn t chc ngay cc lp o to.
Kim sot d n cng bt u t giai on ny. Gim c d n gim st tin trnh, triu tp cc cuc hp nh k v hp tng quan, vit bo co nh k gi cc bn lin quan v x l mi vn  ny sinh.

3. Giai on thit k.
V y l giai on nng v k thut, nn cng vic ca G d n c phn nh hn. Vn  l phi c cc th tc kim sot chnh thc. G d n n nh cc cuc hp v in cc bo co thng k hng tun kim tra tin  v mt thi gian v kinh ph so vi k hoch, d bo tng kinh ph ngy giao hng v cp nht cc sa i cn thit. G d n phi pht hin vn , nu c th th gii quyt cc vn  , nu khng th xem xt li k hoch. G d n ch tr cc cuc hp v qun l nu c (hp Ban qun l d n, Ban ch o, hp nhn cc s kin mc) c bit, G d n phi m bo sao cho khch hng tho mn vi tin  sn phm.
Khch hng thng thay i yu cu ngay t giai on thit k. V vy G d n cn a ra mt qui trnh x l cc yu cu , ng thi tnh v a cc chi ph pht sinh vo gi thnh.

4. Giai on lp trnh.
Giai on ny thu ht nhiu ngi nht v do  c th c nhiu vn  v nhn s. G d n phi theo di st v can thip ngay nu thy c g khng n PG v cc nhm trng cung cp cho G v tnh hnh lm vic ca cc nhn vin thuc mnh qun l.
y c th xem l giai on di nht v khng r mc kt thc. G d n cn c tm nhn xa v m bo tin  d n, thng xuyn gp g, trao i vi cc cn b lp trnh  pht hin cc vn  ngay trc khi chng xy ra.

5. Giai on Tch hp h thng v Th nghim. iu tt nht m G d n c th lm cho giai on ny l gi cho cc cn b chuyn mn trong d n khi b quy nhiu. V khi  khch hng, cp trn... chc hn s lo lng, lin tc gi in, triu tp hp v yu cu bo co tin  hng ngy. G d n s phi ng u vi tt c cc v vic , to iu kin cho t tp trung hon thnh giai on cui.

6. Giai on chp nhn. G d n  xut thi gian, b tr cc cn b v phng tin  ngi s dng c th n v k chp nhn.

7. Giai on vn hnh. G d n m bo cung cp h tr k thut nh  ha v sao cho h iu hnh p ng cc yu cu ca ngi s dng. y cng l giai on thch hp, nu G c  nh a ra mt d n mi.
Cui cng G d n t chc hp tng kt nh gi d n v vit bo co tng kt.

10.4 Vai tr ca PG k thut
Chc nng ch yu ca PG k thut l m bo lm ra sn phm cht lng cao. Khc vi G thin v i ngoi. PG thin v cc hot ng bn trong d n. PG cn ch o, kim sot sao cho sn phm to ra ph hp vi c t chc nng v khng b li. PG lnh o phn ln cc cng vic k thut, ch tr cc cuc hp tng quan k thut, xc nh v giao vic cho cc cn b thit k v lp trnh, gii quyt nhng vn  ln lin quan n vn  k thut, v t mnh m nhn nhng phn vic phc tp nht.
i vi mi giai on trong d n, trch nhim ca PG c nhng c th ring.

1. Giai on xc nh. PG tho phn ln k hoch s b ca d n: phn r cng vic  mc chi tit v tin hnh c lng. Trong trng hp pha khch hng phi cung cp cc chi tit k thut  giai on ny hoc nguyn mu, PG k thut l u mi lin h chnh.

2. Giai on phn tch. Trong d n quy m va v nh, PG l ngi phn tch chnh v son tho tt c phn k thut ca h s c t chc nng: Tng quan, Mc tiu, Yu cu h thng, M t cc b phn. Nu cn PG h tr G v phng din k thut trong m phn v c t chc nng, tnh ton chi ph pht sinh khi khch hng c  ngh thay i. PG cng ng thi gip G tuyn chn ngi vo lm vic cho d n.

3. Giai on thit k. PG l ngi ng u nhm thit k, ch tr cc cuc trao i v hp tng quan v thit k, giao vic cho cc cn b thit k, ng thi t mnh m nhn thit k nhng khu quan trng, nht l  mc tng th.
 giai on ny cng nh  giai on Lp trnh v Th nghim H thng, PG cn gp G hng tun  bo co tnh hnh d n. V PG l ngi tip xc hng ngy vi cc nhn vin, nn phi thng tin cho G v tnh hnh lm vic ca mi ngi.

4. Giai on lp trnh. y l giai on i hi PG phi lm vic cng nht. PG phi phn b cng vic lp trnh, gii quyt bt c vn  g m cc cn b lp trnh khng gii quyt c. PG duyt thit k chng trnh, k hoch th nghim, ti liu ngi s dng, m bo s lin kt cn thit gia cc cn b lp trnh. Mi chng di v phc tp c th giao ring cho mt cn b lp trnh lm vic di s h tr ca PG. Nh vy, PG c th nh du c cc khi chng trnh trong khi cn b lp trnh vit chng trnh chi tit. PG cng c th m nhn vit trn vn mt chng trnh, nhng khng phi l chng trnh nm trn ng gng.

5. Giai on Tch hp h thng v Th nghim. Tch hp v th nghim ln cui cng sn phm hon ton thuc phm v trch nhim ca PG. PG ln k hoch tch hp kim tra vic thc hin k hoch , xc nhn cc kt qu t c v thng xuyn bo co vi G v tin  thc hin.

6. Giai on chp nhn. PG m bo ton b phn k thut, v c th l ngi tho ra k hoch th nghim chp nhn, ng thi cng l ngi thc hin k hoch .

7. Giai on vn hnh. Mc d c th ch cn c mt cn b lp trnh tr, PG phi l ngi bo hnh thng trc, sn sng gii p cc cu hi qua in thoi, hoc thm ch m nhn phn ln khu hun luyn ngi s dng.

10.5 Vai tr ca cn b lp trnh
Cn b lp trnh nhn c thit k mc trung  trn c s  tin hnh thit k chi tit, lp k hoch th nghim modun. Cn b lp trnh cng c th chu trch nhim v ti liu cho ngi s dng v hun luyn, mc d tt hn ht vn l thu cc chuyn gia son ti liu v ging dy m nhn cc khu ny. Mt cn b lp trnh phi bo co tin  vi PG, c mt khi th nghim h thng cc phn lin quan n chng trnh do bn thn mnh vit.

10.6 Vai tr ca pha khch hng
Pha khch hng c th c mt s trch nhim nh son tho ti liu hoc cung cp d liu  th nghim. Trong mi trng hp pha khch hng phi c ra mt i din, chu trch nhim lin h v lm vic vi d n v cc vn  qun l. Pha khch hng phi c t nht mt ngi  hiu bit  tr li cu hi ca t d n.
Ngi s dng cng phi tm hiu v qun l d n, t ra l  bit vai tr ca mnh n u, khi no th phi tham gia hp hoc k. Ngi s dng phi bit c v ph duyt cc ti liu do pha d n a sang. Mc d khng can thip vo cc cng vic k thut, ngi s dng gi lin h vi G d n, a ra cc  ngh thay i theo ng quy trnh, v qua  bit c sn phm giao np c p ng yu cu cam kt khng.
Tm li  hon thnh tt d n, khng c cch no khc l phi phn cng cng vic r rng, sao cho mi ngi u bit phn vic ca mnh. i vi cc cng vic pht sinh ngoi d kin, c th p dng phng cch phn trch nhim chung nh va trnh by  trn: G d n m nhn tt c cc hot ng i hi tip xc vi bn ngoi, cng nh mi vn  thuc v nhn s. PG d n chu trch nhim v tt c cc vn  v k thut. Nh vy khi c mt vn  mi ny sinh, s c th xc nh ngay  thuc trch nhim ca ai, m khng cn mt thi gian bn ci.

10.7 Tuyn chn nhn s d n
G d n.
G d n thng l do cp trn b nhim. Cng v ny thc ra  c b tr sn ngay t khi d n mi hnh thnh, v c th chnh G l ngi cho  kin xem c nn xy dng d n hay khng.
G D n trc ht phi l ngi c ngh thut giao tip. Tip  l k nng qun l d n, ti t chc, v cui cng l trnh  chuyn mn. Nu G d n hiu c ngn ng ca cc nh k thut, th s rt thun li trong cng vic.
Cng v G d n i khi c nhng i hi khc v cc chnh sch v th tc ca bn c quan khch hng cng nh ca c quan mnh. Nhng cng vic nh th i hi cc k nng v lnh o, m phn v ngoi giao.
Vic la chn ai vo cng v G d n nhiu khi cn tu thuc c ch lm vic, chnh sch s dng ngi ca c quan, doanh nghip. Kinh nghim cho thy  mt d n CNTT c nhiu phng, ban tham gia, G nn l mt cn b lnh o c  thm quyn i vi tt c cc phng ban ny, mc d c th khng phi l mt chuyn gia tin hc.

PG k thut.
y l cng v th hai trong d n. Tt nht l  G d n chn PG. Cng vic ca PG nng v chuyn mn, v th nn chn trong s cc chuyn gia gii. PG ng thi phi l ngi bao qut c chi tit ton b d n, khng b xa  vo nhng vic vn vt. G phi chn PG trc khi vit  cng d n, v c rt nhiu chi tit trong  cng d n s do PG iu tra cung cp.
PG cng phi c k nng giao tip tt. Chnh PG l ngi tin hnh phng vn ngi s dng v l ngi hng ngy gim st cng vic ca cc lp trnh vin. Hy chn vo cng v ny chuyn gia no bit t chc, phn cng cng vic, bit gi tin . PG phi c  uy tn v mt chuyn mn  c th lnh o, gip  cc cn b thit k cng nh lp trnh.

Cn b lp trnh.
Hy chn cn b lp trnh trc ht theo nng lc lp trnh ca h. Sau  xt n kinh nghim lp trnh m h  c trong lnh vc ng dng phn mm tng ng, nhng trnh tnh trng  mt ngi lm i lm li mt vic.

10.8 Tnh cch ca ngi lm qun l d n
iu d thy l tnh cch ca ngi qun l c th c tc ng n d n. Sau y l mt s nt v tnh cch c coi l cn thit i vi ngi lm qun l d n:
Ngi lm qun l d n bit giao tip.  l mt thnh vin t, sn sng chia s cc  tng v hiu bit c gi tr. Ngi  khng ch bit trnh by cc t tng, m phi c quyt tm tranh u cho nhng t tng .
Ngi lm qun l d n phi bit lng nghe  kin ngi khc, v sn sng tha nhn nu  l nhng  kin tt hn.
Ngi lm qun l d n c u c t chc. D n c rt nhiu vic, mi vic phi c hon thnh vo mt thi gian tng ng. Hy cn thn vi nhng ngi lm vic khng n ni n chn, sn sng b d vic ny nhy sang vic khc. Nh vy th chng bao lu trong d n s c nhiu vic b b d dang.
Ngi lm d n khng nn cu ton. Quan trng l bit bo m thi hn. Kt qu d n bao gi cn c th lm tt ln. Nhng phi bit dng li  u v dnh cc  xut ci tin cho ln sau.
Ngi lm qun l d n c kh nng phn tch, logic v c kinh nghim tng ng

10.9 Giao vic cho tng c nhn
Trong cun tm l hc lp trnh (The Psychology or Computer Progamming, New-York: Van Nostrand, Reinhold, 1971), G.Weinberg cho rng ng c thc y mnh nht i vi mt ngi lm lp trnh l hc ci mi. Cn giao cho lp trnh vin cng vic kh hn so vi trc y. Tuy nhin khng nn phn nhim v phc tp cho mt lp trnh vin mi ra trng, cng nh khng nn  cc chuyn gia gii lm nhng vic tm thng.
Nhng phn vic hoc chng trnh lin quan n nhau nn giao cho mt ngi, hoc ti a hai ngi, vi iu kin hai ngi ny kt hp c tt vi nhau.
Trong khi phn vic khng nn  ra tnh trng tt c ph thuc vo mt ngi, theo ngha nu ngi  i vng th tt c phi ngng ht. Hng IBM  tng kt thy rng phng php t chc hm lp trnh theo ch  km cp" l rt hiu qu. Theo phng php ny ph trch nhm l mt chuyn gia lp trnh bc thy, m nhn tt c cc m phc tp "80%" v gip vic l cc lp trnh vin hc tr, vi 20% m d hn. c bit c mt lp trnh vin hc tr lun lm vic cng vi thy, c thy km cp hng dn cho y ,  c th thay th thy mi khi thy i vng. Nh vy cng vic ca c nhm s khng b gin on.

* ng c thc y
ng c thc y lm cho ngi ta lm vic hng hi hn, hiu xut cao hn v t kt qu tt hn.
F. Herzberg  tin hnh mt cuc iu tra v cc ng c thc y i vi cng nhn  M. ng  ngh mi ngi hy nh trong u mnh nhng trng hp lm vic c hiu qu nht v nhng trng hp lm vic km hiu qu nht. Kt qu cho thy nhng trng hp sau y dn n hiu qu lm vic km nht:

Chnh sch v cch qun l hnh chnh ca cng ty | 38%
S theo di, gim st | 20%
iu kin lm vic | 18%
Lng | 8%

Ngoi ra cn l quan h cp trn v / hay vi ng nghip, cc ch  i ng x hi v bo him
Nhng trng hp sau y dn n hiu qu lm vic cao nht:
Thnh qu: 50%
(Thy mnh hon thnh xong mt cng vic, t c mc tiu  ra. Cng vic l mt c hi  hc hi, nng cao trnh , tay ngh)
Tnh cht cng vic:
- i vi ngi lm chuyn mn: 48%
- i vi nhng ngi lm khng chuyn: 13%
(Cng vic th v, thch thc, khng qu n gin, d dng, m i hi phi vn ng tr tu, trnh  chuyn mn, kinh nghim... Mi trng lm vic d chu, iu kin v phng tin tt)
c ng nghip ng h v cng nhn: 25%
(Ngi lm nhn c thng tin phn hi v kt qu v hiu qu cng vic, thy rng vic mnh lm c, ngi khc v nht l cc ng nghip quan tm v nh gi tt )
Thng tin: 23%
(c ct nhc ln cp quyn lc cao hn)
Trch nhim
( thc v trch nhim ca mnh, v vai tr v li ch ca cng vic mnh lm trong s nghip chung)

* Cu hi (bi tp) cng c:
1. Th trng cng vic v tnh hnh kinh t nh hng n qun tr ngun nhn lc nh th no?
2. Cc qui trnh trong qun tr ngun nhn lc
3. Trnh by s khc bit gia hai k thut resource loading v resource leveling. Cho v d i vi mi k thut.
4. Trnh by 2 loi hot ng xy dng nhm.
5. C th dng MS. Project 2003  h tr qun tr ngun nhn lc nh th no?`},{id:11,name:"Chng 11: QUN L TRUYN THNG CA D N",shortName:"QUN L TRUYN THNG CA D N",content:`Chng 11. QUN L TRUYN THNG CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca truyn thng tt khi lm vic vi d n v m t cc thnh phn chnh ca mt k hoch qun l giao tip.
2. Hiu c qui trnh qun l truyn thng.
3. Cung cp mt s phng php ci tin truyn thng.
4. M t cch s dng phn mm  h tr qun l truyn thng.

11.1 Tm quan trng ca truyn thng tt
Ni s hi ln nht i vi d n l tht bi (km) truyn thng. Cc nh chuyn mn v CNTT thng khng phi l ngi truyn thng tt Cc nghin cu cho thy nh chuyn mn CNTT phi c kh nng truyn thng hiu qu  c th thng tin trong ngh nghip. K nng ni l yu t ch yu  thng tin ngh nghip i vi cc nh chuyn mn CNTT.

11.2 Qui trnh qun l truyn thng
Cc qu trnh bao gm:
- Lp k hoch truyn thng: xc nh thng tin v nhu cu giao tip ca cc bn lin quan.
- Phn phi thng tin: c th dng thng tin cn thit ng lc.
- Bo co hiu sut: thu thp v ph bin thng tin v hiu sut.
- Kt thc hnh chnh: to, thu thp, v thng tin  hp thc ha kt thc d n / giai on

11.3 Lp k hoch truyn thng
Mi d n cn c k hoch qun l truyn thng, l ti liu hng dn truyn thng trong d n. Phn tch cc bn lin quan trong truyn thng d n cng h tr qui trnh lp k hoch truyn thng.
Ni dung ca k hoch qun l truyn thng:
- M t vic thu thp cc loi thng tin khc nhau.
- Cu trc phn phi m t thng tin n vi ai, khi no v bng cch no.
- nh dng thng tin  truyn thng.
- Lch biu to thng tin.
- Cc phng php truy cp  nhn thng tin.
- Phng php cp nht k hoch qun l truyn thng theo tin  ca d n.
- Phn tch truyn thng vi cc bn lin quan.

11.4 Phn phi thng tin
- Cung cp thng tin cho ng ngi vo ng thi im v ng nh dng cng quan trng nh to thng tin.
- Cc yu t quan trng cn xt:
- Dng cng ngh  ci tin phn b thng tin.
- Cc phng php hnh thc v khng hnh thc  phn b thng tin.

11.5 Bo co hiu sut
Bo co hiu sut gip cc bn tham gia bit thng tin v s dng ti nguyn  t cc mc tiu ca d n
- Bo co tnh trng m t d n ang  giai on no.
- Bo co tin  m t nhm d n  t nhng g trong mt khong thi gian.
- D bo d n tin on trng thi tng lai ca d n da trn thng tin qu kh v xu hng pht trin.
- Cc bui hp nh gi tnh trng thng c bo co hiu sut.

11.6 Kt thc hnh chnh
D n i hi phi c giai on kt thc. Kt thc hnh chnh (Administrative closure) to ra:
- Ti liu lu tr v d n.
- Chp nhn chnh thc.
- Cc bi hc rt ra.

11.7 Ci tin Truyn thng
- Qun l xung t hiu qu.
Gii quyt vn : trc tip i mt vi xung t. Xung t c th l iu tt. Xung t thng dn n nhng kt qu quan trng, nh  tng mi, nhng gii php tt hn, v ng c lm vic kin tr v hp tc hn. Suy ngh theo nhm c th pht trin nu khng c xung t v quan im. Xung t lin quan n cng vic thng ci tin hiu sut lm vic ca nhm, nhng xung t v tnh cm thng lm gim hiu sut lm vic. Sau y l mt s phng thc gii quyt xung t:
- Tha hip: dng tip cn cho v nhn.
- Lm trn (Smoothing): nhn mnh nhng im ng tnh v b qua nhng khc bit.
- p t (Forcing): dng tip cn thng-thua.
- Rt lui: rt lui do khng ng tnh.
- Pht trin k nng truyn thng tt hn.
- Hp hiu qu hn.
Xc nh c nn trnh c bui hp no khng. Xc nh mc ch v kt qu t c ca bui hp. Xc nh nhng ngi tham gia cuc hp. Cung cp chng trnh hp cho ngi tham gia trc bui hp, chun b ti liu v cc h tr trc quan, tin hnh cuc hp mt cch chuyn nghip.
- Dng email hiu qu. Bo m email l phng tin truyn thng chung ca d n, e-mail n ng ngi, ch  trong email phi ph hp, gii hn s lng v kch thc cc tp tin nh km, xa cc email khng cn thit. Tr li nhanh cc email khi c th.
- Dng cc mu trong truyn thng d n.

11.8 Pht trin h tng truyn thng
H tng truyn thng l tp cc cng c, k thut, v cc nguyn l cung cp nn tng  truyn t thng tin hiu qu:
- Cc cng c gm e-mail, phn mm qun l d n, phn mm lm vic theo nhm, my fax, in thoi, h hi ngh t xa (teleconferencing), h qun l ti liu, v cc phn mm son tho vn bn.
- Cc k thut gm hng dn v cc mu bo co, cc quy nh v th tc hi hp, qui trnh ra quyt nh, cc tip cn gii quyt vn , gii quyt xung t v k thut m phn.

* Cu hi cng c:
1. Cc thnh phn chnh ca k hoch giao tip trong d n.
2. u im v nhc im ca cc phng php phn b thng tin v d n.
3. Trnh by mt vi cch to v phn b thng tin v hiu sut vn hnh d n.
4. Phn mm c th h tr giao tip nh th no?`},{id:12,name:"Chng 12: QUN L RI RO CA D N",shortName:"QUN L RI RO CA D N",content:`Chng 12. QUN L RI RO CA D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c kh nng:
1. Hiu c tm quan trng ca vic qun l ri ro d n.
2. Bit c cch d on cc ri ro c th xy ra.
3. Bit cch lp danh sch ri ro, a ra cch khc phc.

12.1 Qun l ri ro
Qun l ri ro. Qun l ri ro bao gm bn bc:
Bc 1: D on ri ro
Bc 2: Kh b ri ro  mt ni c th
Bc 3: Gim bt tc ng ca ri ro
Bc 4: Vn trong kim sot khi c iu trc trc

12.2 D on ri ro (bc 1)
Cng vic u tin v quan trng nht trong qun l ri ro l nhn bit iu g c th dn n sai st. Phng php tt nht  xc nh cc khon mc c th ri ro l nhn vo lch s v rt ra mt danh sch nhng g c th a ti sai st. Nu chng ta khng ghi chp lch s  xem li th cn hiu r khi no chng ta ang trong tnh hung ri ro.

Mt s tnh hung c th xy ra ri ro trong d n:

Cc tnh hung ri ro chung
- Nhn vin k thut khng thch hp. Thiu hun luyn v kinh nghim v phn cng, h iu hnh, phn mm hay lnh vc ng dng. Thiu kinh nghim trong cng vic nhm gy ra vn  v trao i. Nhng yu cu ca khch hng v an ton, php l, quy tc thanh ton...
- Mi trng lm vic khng st hp. Mi trng lp trnh cn yn tnh v khng b quy ri. Cn c bit lu  nu vic lp trnh phi thc hin ti c quan khch. Ni chung cn c my tnh  mnh, trnh bin dch thch hp v phn mm pht trin tt.
- Ti nguyn do bn th ba cung cp. Nu c vic g  do mt bn cung cp m chng ta khng kim sot c h, th chng ta ang  cnh mt ri ro. Chng ta c gng thu c quyn kim sot i vi cc bn .
- Rt ngn d n. chng ta c th lm cho d n c hon thnh sm hn hoc nu chng ta c nhiu ngi, mi ngi u lm thm gi v c my tnh ln. Nhng chi ph  cng phi ln gp i!
- Ngun vn t ngn sch. Nu khch hng s dng ngn qu theo tng qu th chng ta ng trc kh nng thiu kinh ph, nu chng ta c lng cho mi qu khng st hp.

Tnh hung ri ro ti chnh
Vic qun l d n kiu phn b khng c hiu qu. Tt nht l mi thnh vin ca nhm d n, cng nh khch hng u trong cng min a l, nu khng s rt tn km cho chi ph i li.
Qun l qu st sng c th li "khng qun l k" c d n. Hy gi cc ti liu  mc ti thiu. Mi ngi c th ngh cch tt hn  bo co li hot ng ca mnh. Hy xc nh mt tp nh cc ti liu chun ri dng chng. Gi cc cuc hp  mc ti thiu. Chng ta hy dng in thoi v bn ghi nh  lin lc mi lc c th. ng lm nh hng ti cc nhn vin.
Ri ro cn xy ra khi c ngi dng khng th v khng c quyn tr li cc cu hi nhanh chng.

Tnh hung ri ro k thut
- Gii php sai. Chn ngn ng lp trnh, phn cng khng ph hp. Cn phi m bo my tnh pht trin v my tnh vn hnh tng thch nhau v u c sn khi cn n, c phn cng ln phn mm u c sn xut bo m. Phi c bit cn thn trong mi trng c nhiu nh cung cp.
- Yu cu/c t khng tt. Nu c iu g cn cha r hay m h, hay nu ngi dng khng th trao cho chng ta cc yu cu chc chn th nhng thay i nht nh s xut hin trong hoc sau khi pht trin. Thay i c th rt tn km cho vic thc hin v chng ta khng th c thanh ton  lm vic . Cn phi lm vic phn tch d n k trong trng hp ny.
- Khng hiu bit v ngi dng. Chng ta phi bit cch thc, quy trnh m ngi dng ang lm.
-  ng sai mt mt d liu Phi xc nh ra cc th tc sao lu, ghi li cc giao dch hay sao chp cc tp cn phi c thit k cho h thng.

Thch  ri ro. Hy t hi chng ta cc cu hi v ri ro sau tr li c hay thm ch c phn no , cho bt k cu hi no th tc nhn ri ro. Danh sch c chia thnh 3 phn: ri ro thp, ri ro trung bnh, ri ro cao.

Ri ro thp
Lnh vc: Kch c nhm
Cu hi: Nhm d n c t 3 n 5 ngi? (ch  iu ny ko theo rng nhm mt hay hai ngi khng ri ro!)

Lnh vc: Phn mm/ phn cng
Cu hi: Chng ta c ang dng mt ngn ng khng thch ng vi ng dng khng?

Lnh vc: Ngi s dng
Cu hi: Liu ngi s dng c l ngi bit my vi tnh khng? (iu  s lm tn thi gian hun luyn, ri khi h bit hn th h s i c s thay i)

Lnh vc: Hun luyn
Cu hi: Chng ta c tht s cn hun luyn v phn cng my khch, phn mm h thng, ngn ng khng?

Lnh vc: Thnh vin nhm
Cu hi: Chng ta c lm vic c vi nhau khng? (Sc kho, hiu nng, vn  c nhn)

Ri ro va
Lnh vc: Kch c nhm
Cu hi: Nhm d n c trn 5 ngi

Lnh vc: Phn mm/ phn cng
Cu hi: Liu c yu cu no v thi gian p ng/ hiu xut hay tnh sn c l qu ng khng? Liu ta c a vo mt phn cng qu yu khng? Liu c dnh dng g n hp ng/ ngn ng macro khng (Macro kh hc, kh g li v cng kh tm c ngi lp trnh). Ta c phi sa i h iu hnh khng? C lin quan ti mng hay khng? C sn phm phn cng hay phn mm mi no khng?

Lnh vc: Ngi s dng
Cu hi: C vn  kh khn trong trao i vi ngi dng khng? (Ngi dng bt hp tc hay  xa)

Lnh vc: Thnh vin nhm
Cu hi: Liu c ai trong nhm m ngi dng khng c quyn tc ng ti khng?

Ri ro cao
Lnh vc: Phn mm/phn cng
Cu hi: Trong mi trng nhiu nh cung cp, liu c nh cung cp no a ra cc sn phm khng ph hp khng? Chng ta c ang dng phn cng, phn mm cc phng php thit k hay lp trnh cha tng c sa trc hay khng?

Lnh vc: Thnh vin nhm
Cu hi: Chng ta c lm vic c vi nhau khng? Liu c vn  c nhn no khng? (Sc kho, hiu nng, vn  c nhn)

Lnh vc: Cc bn th ba
Cu hi: Liu c ti nng no ph thuc vo cc bn ngoi s kim sot ca chng ta khng?

Lnh vc: Hn cht
Cu hi: Liu d n c phi rt ngn khng? C c cng b khng?

Lnh vc: Yu cu
Cu hi: Ti liu yu cu c chc c khng, hay mt trong chng ta (ngi dng, nhm d n ) khng hiu n?

Chng ta c th d tnh cc ri ro bng cch to ra cc danh sch nh trn  nhc nh mnh v nhng ri ro c th c. Chng ta hy dng lch s cc d n trong cng ty chng ta  to ra cc danh sch ring ca mnh. Hy nh danh sch ri ro l ng phi thay i chng khi mi trng thay i.

12.3 Kh b ri ro  mi ni c th (bc 2)
Ti im ny mt  tng tt l lp mc u tin cho cc khon mc ri ro. Chng ta hy lp mt bng nh bn di:

Bng ri ro
Khon mc ri ro | Xc sut (1-10) | Tc ng (1-10) | u tin (XxT)
--- | --- | --- | ---
Ngi s dng khng trao i  Yu cu s trt | 8 | 8 | 64
Trng nhm lp trnh ngh php/vic lp trnh trt | 2 | 8 | 16

Chng ta hy a vo trong bng tng khon mc trong bn cu hi ri ro m chng ta  tr li c hay thm ch c th. Hy dch cc khon mc ri ro ny thnh nh hng thc t ln d n, thng l tng chi ph hay thi hn. Chng ta hy quyt nh v xc sut ca vic xut hin khon mc ny v gn cho n mt s t 1 ti 10, 10 l xc sut cao nht. Ri quyt nh v tc ng ln d n. Hy gn cho Tc ng mt s trong khon t 1 ti 10, 1 l khon mc c th xoay s c, 10 l khon mc s lm dng d n. Cc khon mc tc ng cao l cc khon mc ri ro Va hay Cao trong phn cu hi ri ro, cng nh cc khon mc nm trn ng gng. Hy nhn Xc sut vi Tc ng cho tng khon mc  thu c u tin.

Bng ri ro trn s cho chng ta mt th t, theo  gii quyt kh b cc ri ro. Hin nhin, s u tin cng cao trong Bng ri ro th khon mc  cng phi ch . Trong thc t cn gii quyt cho cc khon mc theo th t gim dn ca s u tin.

i vi mi khon mc ri ro, u tin hy th loi b nguyn nhn ri ro. Hy xem xt n quyn kim sot, thay i nhn vin, tm phn cng/ phn mm tt hn, o to chnh chng ta v ngi dng. Mi khon mc u i hi phi c mt gii php.

12.4 Gim bt tc ng ca ri ro bng lp k hoch (bc 3)
Vi nhng khon mc chng ta khng th kh b c ri ro, th hy xc nh k hoch i ph vi iu bt ng. Vi mi khon mc ri ro c lin quan n ti nguyn, chng ta hy th s dng ti nguyn d phng.
Nu c xc sut cao v mt khon mc ri ro c th xut hin, th chng ta phi iu chnh ca gi tng ng.

Bng tm tt k hoch cho iu bt ng:
Khon mc ri ro | Hnh ng | Ai | Chi ph (%)
--- | --- | --- | ---
C trao i vi ngi dng | Hp theo tun; Lm bn mu | Trng QLDA; Ph QLDA | 5000$; 25000 $,3th
Ngi lp trnh ngh php | Ngi d phng | Tp s | 20.000$

t k hoch cho iu bt ng vo ct hnh ng ca bng bt ng. Trong ct Ai t tn ca ngi s chu trch nhim thc hin k hoch cho iu bt ng. Vi nhng khon mc ca chng ta cn c cnh bo sm, hy t vo ct Ai tn ca c nhn chu trch nhim vic ny v bo cho ton nhm khi s vic xy ra. Trong ct chi ph, t chi ph tng ln hoc thi gian m khon mc ri ro gy ra.

12.5 Kim sot khi c iu trc trc (bc 4)
Cui cng, mc cho tt c mi n lc ca chng ta, vi iu no  vn c trc trc. Hy tnh n vic mi th c th trc trc hy c gng gi quyn kim sot nhiu nht c th c. Hy lm ht sc mnh, cng b vic trt d n nu cn, v bo co cho mi ngi bit nguyn nhn vn , c bit nu h  bn ngoi quyn hn php l ca chng ta.

* Cu hi cng c:
1. Khi  cp n k hoch qun l ri ro cn phi xt n cc yu t no?
2. Cc ngun ri ro ph bin trong cc d n CNTT.
3. Tm hiu s khc bit gia k thut brainstorm v Delphi trong vic xc nh cc ri ro. u im v nhc im ca mi k thut.
4. Trnh by cch s dng cy quyt nh (decision tree) v phng php Monte Carlo i vi cc ri ro nh lng. Cho v d v cch s dng mi k thut cho d n CNTT.
5. Lit k cc cng c v k thut theo di v kim sot ri ro.
6. Cch s dng Microsoft Project v Excel  h tr qun l ri ro d n.`},{id:13,name:"Chng 13: QUN L TCH HP D N",shortName:"QUN L TCH HP D N",content:`Chng 13. QUN L TCH HP D N

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. M t khung lm vic ca qun l s tch hp d n trong mi quan h vi cc lnh vc kin thc v chu trnh sng ca d n.
2. M t vic pht trin k hoch d n, gm ni dung k hoch d n, dng cc hng dn v cc ti liu mu  pht trin k hoch, v phn tch stakeholder  qun l cc mi quan h.
3. Gii thch vic thc thi d n, quan h ca n vi hot ng lp k hoch, cc yu t dn n thnh cng, cc cng c v k thut h tr thc thi d n.

13.1 Tm quan trng ca qun l tch hp
Qun l ri ro d n l mt ngh thut v nhng nhn bit khoa hc, l nhim v, v s i ph vi ri ro thng qua hot ng ca mt d n v nhng mc tiu i hi quan trong nht ca d n.
Qun l ri ro thng khng c ch  trong cc d n, nhng n li gip ci thin c s thnh cng ca d n trong vic gip chn la nhng d n tt, xc nh phm vi d n, v pht trin nhng c tnh c tnh thc t.
Cha kha thnh cng: Qun l tch hp tt.
- Ngi qun l d n phi iu phi tt c cc lnh vc kin thc trong sut chu trnh sng ca d n.
- Nhiu ngi qun l d n mi gp kh khn khi nhn vo bc tranh tng th v mun tp trung vo qu nhiu chi tit.
- Qun l tch hp d n khng ging nh tch hp phn mm.

13.2 Qui trnh qun l tch hp
Nhng tin trnh chnh bao gm:
- Pht trin k hoch d n: ly kt qu ca cc qui trnh lp k hoch khc v a vo thnh mt ti liu nht qun v kt dnh  k hoch d n.
- Thc thi k hoch d n: thc hin k hoch d n
- iu khin thay i tch hp: iu phi nhng thay i trong ton b d n.

13.2.1 Pht trin k hoch d n
- K hoch d n l ti liu dng  iu phi tt c cc ti liu v hot ng ca d n. Mc ch chnh l hng dn thc thi d n. K hoch d n gip ngi QLDA lnh o nhm d n v nh gi tnh trng d n. Cn phi o vic thc hin d n so vi k hoch
Cc thuc tnh ca k hoch d n.
- K hoch d n mang tnh duy nht
- K hoch phi ng (dynamic)
- K hoch phi linh hot (flexible)
- K hoch phi c cp nht khi c thay i
- K hoch phi ng vai tr l ti liu hng dn thc thi d n
Cc thnh phn ph bin ca k hoch d n
- Tng quan v d n
- M t v cch t chc d n
- Cc qui trnh qun l v k thut dng trong d n
- Thng tin v cc vic phi lm, lch biu, v ngn sch
Phn tch cc bn tham gia
Phn tch cc bn tham gia cung cp thng tin quan trng (thng nhy cm) v cc cc bn tham gia nh:
Tn tui cc cng ty ca cc bn tham gia
- Vai tr ca h trong d n
- Cc s liu thc v cc bn tham gia
- Mc nh hng v quan tm n d n
-  xut cho qun l cc mi quan h

13.2.2. Thc thi k hoch d n
Thc thi k hoch d n i hi qun l v thc hin cc cng vic m t trong k hoch d n. Hu ht thi gian v tin bc c dng trong qu trnh thc thi d n. Lnh vc ng dng ca d n tc ng n vic thc thi d n v sn phm ca d n c to ra trong qu trnh ny.
Cc k nng quan trng  thc thi k hoch d n:
- Cc k nng qun l tng qut nh k nng lnh o, giao tip, v chnh tr
- K nng v sn phm v kin thc.
Cc cng c v k thut thc thi d n:
- H giao vic (Work Authorization System): mt phng php bo m con ngi  iu kin lm vic ng lc v ng trnh t.
- Hp nh gi tnh trng (Status Review Meetings): cc bui hp thng k  trao i thng tin v d n.
- Phn mm qun l d n (Project Management Software): phn mm c bit h tr qun l cc d n.

13.2.3 iu khin thay i tch hp
iu khin thay i tch hp gm nhn din, nh gi, v qun l nhng thay i trong sut chu trnh sng ca d n. Ba mc tiu ca iu khin thay i:
- Tc ng n cc yu t to ra s thay i  bo m c li.
- Xc nh nhng thay i  xy ra.
- Qun l nhng thay i thc t khi xy ra.
iu khin thay i i vi cc d n CNTT
- Cch nhn trc y: Nhm d n cn n lc lm ng theo k hoch, ng thi hn v trong phm vi ngn sch.
- Vn : cc bn tham gia him khi ng  ngay t u v phm vi ca d n, cho rng thi gian v chi ph d n l khng chnh xc.
- Cch nhn hin i: Qun l d n l mt qu trnh giao tip v tha thun lin tc.
- Gii php: Thay i thng c li, v nhm d n cn lp k hoch cho iu ny.
H iu khin thay i
- Mt qui trnh mang tnh hnh thc m t cc ti liu d n c th c thay i khi no v nh th no.
- M t ai c php thay i v thay i nh th no?
- Thng gm bng iu khin thay i (CCB), qun tr cu hnh, v mt qui trnh truyn t s thay i.
- Ban iu khin thay i (CCB=Change Controlling Board)
- Mt nhm ngi chu trch nhim v ph duyt hoc t chi thay i ca d n.
- CCB cung cp nhng hng dn  chun b yu cu thay i, nh gi yu cu thay i, v qun l vic thc hin nhng thay i c duyt.
- Gm cc bn tham gia ca ton cng ty.
Thay i ng lc
- Mt s CCB ch thnh thong mi gp nhau, v th nhng thay i c th xy ra qu lu.
- Mt s cng ty c chnh sch cho nhng thay i nhy cm v thi gian  chnh sch 48-gi cho php cc thnh vin nhm d n quyt nh, sau  h c 48 gi  ch ph duyt ca lnh o cp cao  a nhng thay i xung mc thp nht c th c, nhng phi thng bo cho mi ngi.
Qun tr cu hnh
- Bo m sn phm v m t v sn phm l ng v y .
- Tp trung vo qun l cng ngh bng cch xc nh v iu khin cc c trng chc nng v vt l ca sn phm.
- Cc chuyn gia qun tr cu hnh xc nh v vit ti liu v cc yu cu cu hnh, iu khin thay i, lu v bo co nhng thay i, kim tra sn phm xem c ph hp vi yu cu hay khng.

* Cu hi cng c:
1. Gii thiu khi nim qun tr tch hp dng t ng ring ca bn. Qun tr tch hp c quan h vi chu trnh sng d n, v cc lnh vc qun tr khc nh th no?
2. Cc thnh phn quan trng ca mt k hoch tt.
3. Cc yu t quan trng  thc thi d n thnh cng. Trnh by mt v d v d n c thc thi thnh cng, mt v d v d n tht bi. Xc nh nhng khc bit gia hai d n ny.
4. Tm quan trng ca qui trnh iu khin thay i tch hp (integrated change control process) i vi cc d n CNTT.
5. Trnh by ng dng ca cc cng c phn mm sau y trong qun tr tch hp d n: phn mm son tho vn bn (v d Winword), phn mm trnh by (v d Power Point), bng tnh (v d Excel), CSDL (v d Access), email, Web v phn mm qun tr d n.`},{id:14,name:"Chng 14: MICROSOFT PROJECT",shortName:"MICROSOFT PROJECT",content:`Chng 14. MICROSOFT PROJECT

 Mc tiu hc tp: Sau khi hc xong bi ny, ngi hc c th:
1. Bit cch xc nh cc quy trnh lp d n
2. p dng Microsoft Project  to d n, t chc cc cng vic, qun l thi gian, qun l ti nguyn, chi ph ca d n
3. Xc nh c quy trnh theo di v qun l d n
4. Theo di chi ph hin ti v kh nng ti chnh
5. Xem v in bo biu

Phn mm h tr cho vic qun  d n c nhiu, t n gin nh bng tnh, son tho vn bn.. n cc phn mm c trng h tr cho tng cng vic lin qua n qun l d n nh lp lch, theo di, lu tr thng tin Trong phn ny ch tp trung gii thiu cc chc nng chnh ca MicroSoft Project- mt trong nhng cng c phn mm c th h tr cho chng ta trong vic phn chia cc cng vic, lp lch, theo di tin , iu phi nhn lc..

14.1 Khi nim chung v cc yu cu ca Microsoft Project

Microsoft Project l mt chng trnh chuyn dng  qun l cc d n, l chng trnh c nhng cng c mnh v thun tin. Microsoft Project c th lm vic vi nhiu ch , nhiu cng c, chc nng  thc hin cc thao tc to lp v hiu chnh trn d n ng thi tit kim thi gian v tin bc.

Mc ch ca Microsoft Project 2003 gm:
- T chc lp k hoch v qun l d n.
- Ln lch cng tc.
- Ch nh cc ti nguyn v chi ph cho cc cng vic trong d n.
- iu chnh k hoch  thch ng vi cc iu kin rng buc.
- Chun b cc bo biu cn thit cho d n.
- D tr cc tc ng n tin  ca d n khi xy ra nhng thay i c nh hng ln n d n.
- Xem xt li d n  i ph vi cc tnh hung ngu nhin.
- nh gi ti chnh chung ca d n.
- In n cc bo biu phc v d n.
- Lm vic v qun l theo nhm.
- Rt kinh nghim trong khi thc hin d n.

14.2 C s d liu ca Microsoft Project 2003

L mt nh qun l d n, s c rt nhiu cng vic  lm. Vy th Microsoft Project c th gip g cho cng vic ny? Trc ht, n lu tr thng tin chi tit v d n trong c s d liu v s dng cc thng tin ny  tnh ton, theo di tin trnh, chi ph ca d n v cc thnh phn khc ng thi to ra mt k hoch cho d n. Cng nhiu thng tin v d n cung cp, d n cng c thc hin chnh xc by nhiu.

Ging nh mt bng tnh, Microsoft Project th hin kt qu ngay sau cc tnh ton.

Tuy nhin k hoch ca d n s khng c lp cho n khi hon thnh cc thng tin quan trng ca cc cng vic.

Microsoft Project lu gi thng tin nhp vo v thng tin n tnh ton trong cc trng nh tn cng vic hay khong thi gian thc hin. Trong Microsoft Project, mi trng c th hin trn mt ct.

14.3 Xem xt d liu cn thit

Ngi s dng (NSD) c th xem xt thi gian kt thc ca cc cng vic trong hm nay, ngy mai NSD li mun xem xt chi ph cng vic. C s d liu d n cha ng rt nhiu thng tin nhng ti mt thi im NSD c th ch cn mt phn thng tin.  lm c iu  Microsoft Project cung cp mt s dng th hin sau:
- Cc khung nhn: Th hin mt tp con ca cc thng tin  c nh dng. V d s  Gantt th hin thng tin v cc cng vic.
- Cc bng: Gm cc thng tin c nh ngha ngay ban u.
- Cc thng tin chn lc: cho php chn lc cc thng tin v cng vic hay ti nguyn.

14.4 H thng lch lm vic ca Microsoft Project

Cch thc Microsoft Project s dng h thng thi gian bt u v kt thc cc cng vic nh th no? iu ny c tnh ton theo cc nhn t nh mc  c lp ca cng vic, cc rng buc lin quan, cc khong thi gian t on cng nh cc ngy ngh, ngy l.

Mt s t kho trong Microsoft Project 2003
- Task: Cng vic, nhim v
- Duration: Thi gian thc hin cng vic
- Start: Ngy bt u
- Finish: Ngy kt thc
- Predecessors: Cng vic lm trc
- Successors: Cng vic k tip
- Task list: Danh sch cc cng vic
- Resource: Ti nguyn/nhn lc, my mc thc hin cc cng vic ca d n
- Work: S gi cng c gn  thc hin cng vic
- Unit: Kh nng lao ng ca ti nguyn
- Milestone: Loi cng vic c bit (im mc) c Duration=0, dng  kt thc cc giai on trong d n
- Recurring Task: Cng vic nh k, lp i lp li nhiu ln theo chu k trong thi gian thc hin d n. V d cc bui hp giao ban u tun
- Shedule: Lch trnh ca d n
- Baseline: Theo k hoch
- Summary Task (Cng vic tm lc): Cng vic m chc nng duy nht ca n l cha ng v tm lc thi khong, cng vic v chi ph ca cc cng vic khc.

14.5 To mt d n

Thi gian NSD xc inh c r mc ch ca d n v vch ra c cc giai on chnh ca d n cng chnh l lc NSD cn to ra mt k hoch cho d n.

Trc ht, nhp v t chc cc cng vic v khong thi gian  thc hin chng. Sau  khi to nhn lc, thit b, nguyn vt liu v chi ph cho cc cng vic. Vi nhng thng tin ny, Microsoft Project s to ra mt k hoch lm vic, ch cn kim tra li k hoch v iu chnh khi cn thit. Phn ny s hng dn to lp k hoch d n.

Phn ny s bao gm cc giai on sau:
Giai on 1: Thit lp mt d n mi.
Giai on 2: Cch thc nhp v t chc cc cng vic.
Giai on 3: Thi gian bt u v thi gian kt thc cng vic.
Giai on 4: Khi to ti nguyn, nhn lc cho cng vic.
Giai on 5: Xem xt h thng cng vic
Giai on 6: Xem v in bo co

14.5.1 Giai on 1 - Thit lp mt d n mi

Bc u tin  to k hoch lm vic l to ra mt file d liu mi, thit lp thi gian bt u, thi gian kt thc v nhp cc thng tin chung v d n. Sau khi nghin cu xong giai on ny, NSD s c mt file d liu Microsoft Project cha ng tn d n, ngy d kin bt u, ngy d kin kt thc, k hoch d n cng nh cc thng tin khc v d n.

Giai on ny gm c 3 im chnh sau:
- To mi mt d n
- Nhp cc thng tin quan trng v d n
- Thit lp h thng thi gian trong d n

1. To mi 1 d n

Khi bt u vi 1 d n mi vi Microsoft Project, ch c th nhp thi gian bt u hay thi gian kt thc ca d n. Microsoft cng khuyn rng chng ta ch nhp thi gian bt u ca d n v  t chng trnh tnh thi im kt thc sau khi  nhp cc thng tin v thi gian ca tng cng vic.

B1 Kch nt New trn thanh cng c hay trong menu File, chn New.
B2 Trong hp thoi Project Information, nhp thi gian bt u hay kt thc ti mc Start date hay Finish date cho d n, v sau  kch nt OK.

[Hnh nh: Hp thoi Project Information]

B3 Kch nt Save hay trong menu File, chn mc Save  lu gi thng tin d n.
B4 Trong mc File name, nhp tn d n, v sau  nhn nt Save.

[Hnh nh: Hp thoi Save As]

Ch  C th thay i thng tin v d n bt c thi im no bng cch chn mc Project Information trn menu Project

[Hnh nh: Menu Project Information]

2. Nhp cc thng tin quan trng cho d n

Mi mt d n u c mt s thnh phn c trng nh cc cng vic c lin quan, mt s vng mc s gp phi khi thc hin, ngi thc hin chng v mc ch ca d n.  c th nh v theo di c cc thng tin ny khi cn thit hy thc hin theo cc bc sau:

B1 Trn menu File, kch Properties, v sau  kch tab Summary.

[Hnh nh: Menu File Properties]

B2 Trong Tab Summary, nhp nhng thng tin lin quan n d n, nh ngi lp v qun l file d n, mc ch ca d n, hay bt c iu g c th gy kh khn trong qu trnh thc hin d n.

[Hnh nh: Hp thoi Properties]

B3 Kch nt OK.

3. Thit lp h thng lch lm vic cho d n

C th thay i thi gian lm vic ca d n  phn nh s ngy cng nh s gi lm vic ca mi ngi trong d n. Microsoft Project thit lp mc nh thi gian lm vic cho d n t th 2 n th 6, bt u t 8 gi sng n 5 gi chiu.

C th xc nh thi gian ngh nh cui tun v cc bui ti cng nh ngy l hay thi gian i ngh.

B1 Trn menu View, kch Gantt Chart.

[Hnh nh: Menu View Gantt Chart]

B2 Trn menu Tools, kch Change Working Time.

[Hnh nh: Menu Tools Change Working Time]

B3 Trn hp thoi Chage Working Time, chn lch lm vic.

[Hnh nh: Hp thoi Change Working Time]

 thay i thi gian lm vic ca mt ngy trong tun trong ton b d n, chn ngy cn thay i, sau  chn la chn Default Working Time v chnh li thi gian lm vic ca ngy . V d mun ngy th 6 hng tun u kt thc vo 4 gi chng hn.

 thay i thi gian lm vic ca mt s ngy, v d nh t th 3 n th 6 u lm vic lc 9 gi, ch cn kch chut vo ngy th 3, sau  gi phm Shift v kch chut n th 6. Cng vic tip theo l thay i thi gian lm vic ca nhng ngy ny.

B4 Kch Nonworking time i vi nhng ngy ngh, hay Nondefault working time  thay i thi gian lm vic ca mt ngy no .
B5 Kch OK.

14.5.2 Giai on 2 - Cch thc nhp v t chc cc cng vic

u tin hy lit k cc bc  hon thnh d n, bt u vi tng khi cng vic v chia nh nhng khi cng vic thnh nhng khi nh hn. C nh vy cho ti khi n c chia thnh nhng cng vic nh c th phn giao c th c. Cui cng nhp cc khong thi gian thit lp cho tng cng vic.

Sau khi hon thnh giai on ny, s c mt tp hp cc cng vic c t chc mt cch h thng v thng tin chi tit v nhng cng vic ny.

Giai on ny c 5 im chnh sau:
- Nhp cng vic v thi gian thc hin.
- To nhng mc nh du.
- To nhng cng vic nh k.
- Phn cp cng vic.
- Hiu chnh h thng cng vic.

1. Nhp cc cng vic v thi gian thc hin

Mt d n l mt chui nhng cng vic c lin quan ti nhau. Mt cng vic s chim gi mt khong thi gian v chng s c theo di tin trnh thc hin. Mt cng vic c th c thc hin trong mt ngy hay nhiu tun.

Hy nhp cc cng vic theo th t m chng xy ra, sau  c tnh s thi gian  thc hin cng vic .

Ch : Khng nn nhp ngy bt u v kt thc trong cc trng Start v Finish i vi mi cng vic. Microsoft Project tnh ton thi gian bt u v kt thc da trn mi quan h gia cc cng vic, da trn cc thng tin nhp vo. Phn ny s c ni r trong giai on sau:

B1 Trn menu View, kch Gantt Chart.

[Hnh nh: Menu Gantt Chart]

B2 Trong ct Task Name, nh tn cng vic, v sau  nhn phm TAB.

[Hnh nh: Nhp tn cng vic trn bng]

Microsoft Project t ng nhp thi gian c tnh cho cng vic l mt ngy cng vi du ?

B3 Trong ct Duration, nhp thi gian thc hin cng vic theo thng, tun, ngy, gi hay pht. C th s dng cc du tt sau:
thng = mo
tun = w
ngy = d
gi = h
pht = m

Ch :  ch ra y l thi gian c tnh, nh thm du hi sau khong thi gian thc hin.

B4 Nhn phm ENTER.

Ch : C th thm mt ch thch cho mi cng vic. Trong ct Task Name, chn tn cng vic cn thm ch thch, sau  kch nt Task Notes. Nhp thng tin ch thch trong hp thoi Notes, sau  kch nt OK.

2. To mc d n (milstones)

To mc d n l mt vic rt c  ngha trong k hoch thc hin d n, v d nh vic hon thnh mt pha chnh ca d n, bo co thnh qu hoc mt s kin nh du kt thc 1 cng vic. Khi nhp khong thi gian cho 1 cng vic l 0 ngy Microsoft Project th hin 1 biu tng mc d n trn biu  Gantt ti thi gian bt u cng vic.

B1 Trong ct Duration ca cng vic cn to mc nhp 0.
B2 Nhn phm ENTER.

Ch :  hin th tt c cc im mc trong khung nhn, chn kiu hin th trong danh sch l Milestones.  hin th li ton b cc cng vic trong d n, chn All task trong danh sch kiu hin th.

[Hnh nh: Danh sch cc cng vic v im mc trn mn hnh]

3. To cc cng vic nh k

Cng vic nh k l nhng cng vic thng xuyn lp i lp li, v d nh 1 bui hp giao ban th hai hng tun. Cng vic nh k c th xy ra hng ngy, hng tun, hng thng hay hng nm. C th xc nh khong thi gian thc hin i vi mi ln cng vic xut hin hay thi gian no n s xy ra.

B1 Trong ct Task Name, chn ni mun cng vic nh k xy ra
B2 Trong menu Insert, chn Recurring Task.

[Hnh nh: Menu Insert Recurring Task]

B3 Trong hp thoi Recurring Task Information, nh tn cng vic

[Hnh nh: Hp thoi Recurring Task Information]

B4 Trong phn Duration, nhp thi gian thc hin cng vic mi khi cng vic xy ra.
B5 Di Recurrence pattern, kch Daily, Weekly, Monthly, hay Yearly  chn kiu xut hin ca cng vic theo hng ngy, hng tun, hng thng hay hng nm.
B6 Pha bn phi Daily, Weekly, Monthly, hay Yearly, xc nh tn xut cng vic xy ra. V d nu nh mt cng vic nh k xut hin vo th hai hng tun.
B7 Di Range of recurrence, nhp ngy bt u v sau  chn ngy kt thc sau mt s ln xy ra (mc End After) hay cng vic s c kt thc vo thi gian no (End By).
 Nu chn End after, chn s ln cng vic xy ra.
 Nu chn End by, nhp ngy mun cng vic ny kt thc.
B8 Nhp OK  ng .

Ch :  xem tt c cc phn ca cng vic nh k, kch vo du + gn cng vic inh k.

4. Phn cp cc cng vic

Vic phn cp gip t chc cc cng vic thnh nhng khi d dng qun l, cc cng vic c to thnh mt h thng phn cp, cng vic ny c th l cp con ca cng vic khc nhng cng c th l cp cha ca mt s cng vic. Thi gian bt u v kt thc mt cng vic cha c tnh theo thi gian bt u sm nht v thi gian kt thc mun nht ca cc cng vic con ca n.

 t chc theo ch  phn cp, s dng cc nt sau:
[Hnh nh: Nt mi tn phi] Cp thp hn
[Hnh nh: Nt mi tn tri] Cp cao hn
[Hnh nh: Nt du cng] Hin th cc cng vic con
[Hnh nh: Nt du tr] Khng hin th cc cng vic con
[Hnh nh: Nt Show All] Hin th tt c cc cng vic con

B1 Trn menu View, chn s  Gantt.
B2 Chn cng vic m NSD mun n tr thnh cng vic con ca cng vic pha trn n.
B3 Kch nt [Hnh nh: Nt Indent]. Cng vic ny s tr thnh cng vic con.

Ch : C th chuyn i cp ca cng vic bng cch t chut vo phn u tn cng vic mun chuyn, khi con tr chuyn sang hnh mi tn hai chiu c th ko ra ngoi hay vo trong tu theo cp ca cng vic.

5. Hiu chnh danh sch cc cng vic

Ngay khi to danh sch cng vic, c th chia nhng cng vic ln thnh nhiu cng vic con v sp xp li. NSD c th mun sao chp, xo hay di chuyn cc cng vic trong d n.

B1 Trong ct ID, chn cng vic mun sao chp, xo hay di chuyn
  chn mt hng, kch vo s ID.
  chn mt s cng vic lin k nhau, t chut vo cng vic u, gi phm Shift v sau  ko chut n cng vic cui.
  chn nhng cng vic khng lin k nhau, t chut vo mt cng vic no , sau  gi phm Ctrl v kch chut vo cc cng vic cn thay i.

B2 Sao chp, di chuyn, hay xo cng vic.
  sao chp cng vic, kch nt Copy trn thanh cng c hoc c th vo menu Edit, chn Copy Cell.

[Hnh nh: Menu Edit Copy Cell]

 di chuyn cng vic, kch nt Cut trn thanh cng c hoc c th vo menu Edit, chn Cut Cell.

[Hnh nh: Menu Edit Cut Cell]

  xo cng vic, trong menu Edit, chn Delete.

[Hnh nh: Menu Edit Delete Task]

B3  di chuyn nhng cng vic  la chn, chn ni mun di chuyn ti.
B4 Kch nt Paste. Trn thanh cng c hay trong menu Edit, chn Paste.

[Hnh nh: Menu Edit Paste]

Ch :  thm mi mt cng vic vo gia nhng cng vic  tn ti, kch vo mt s ID no  v nhn phm INSERT. Ct ID ca cc cng vic pha sau s t ng cp nhp li sau khi thm mi mt cng vic.

14.5.3 Giai on 3 - Thi gian bt u v thi gian kt thc cng vic

Ngay sau khi to v phn cp danh sch cc cng vic l thi im xc nh mi quan h gia cc cng vic v thi gian thc hin chng. Cc mi lin h gia cc cng vic c th hin bng cc ng kt ni. Microsoft Project t ng quyt nh thi im bt u v thi im kt thc cho mi cng vic nu chng c lin quan ti cng vic khc. i vi nhng cng vic thc hin mt cch c lp, phi t xc nh thi im bt u v kt thc cng vic .

Mt c im thun li ca nhng cng vic c lin kt vi cng vic khc l bt c khi thi gian thc hin 1 cng vic thay i, thi gian thc hin ca cc cng vic c lin quan cng thay i theo. C th thay i h thng k hoch cc cng vic bng cch s dng cc rng buc, cc cng vic gi ln nhau hay cc cng vic b ngt qung.

Giai on ny gm 5 im chnh sau:
- Thit lp mi quan h gia cc cng vic.
- Cc cng vic gi chng ln nhau v cc cng vic ngt qung.
- Thi gian bt u v kt thc ca mt cng vic.
- Xc nh hn cui cng cho 1 cng vic.
- Chia mt cng vic thnh nhiu phn.

1. Thit lp mi quan h gia cc cng vic

 thit lp mi quan h gia cc cng vic, chng ta s dng cc ng kt ni. Trc ht, chn nhng cng vic c lin quan, kt ni chng v sau  c th thay i kiu kt ni. Cng vic c ngy bt u v kt thc ph thuc vo cng vic khc gi l cng vic k tip. Cng vic m cng vic k tip ph thuc vo gi l cng vic lm trc. V d sau s ch r cho thy mi quan h gia cc cng vic, nu thit lp mi quan h gia 2 cng vic l treo ng h v sn tng th cng vic sn tng s l cng vic lm trc, cng vic treo ng h s l cng vic k tip.

Sau khi cc cng vic c thit lp mi quan h, vic thay i thi gian bt u cng nh kt thc ca cc cng vic lm trc s nh hng n thi gian thc hin ca cc cng vic k tip. Microsoft Project mc nh  quan h kt thc- bt u (Finish- to- Start) khi to cc lin kt gia cc cng vic. Trong nhiu trng hp, mi quan h gia cc cng vic khng phi nh vy, c th thay i kiu lin kt ny theo cc dng sau  ph hp vi m hnh d n: bt u - bt u (Start- to- Start), kt thc- kt thc (Finish- to-Finish), bt u - kt thc (Start- to Finish)

B1 Trn menu View, chn s  Gantt.
B2 Trong ct Task Name, chn hai hay nhiu cng vic mun lin kt vi nhau.
 lin kt cc cng vic lin tip nhau, gi phm Shift, v sau  kch chut vo cng vic u tin v cng vic cui.
 lin kt cc cng vic cch xa nhau, gi phm CTRL,v sau  chn nhng cng vic mun lin kt vi nhau theo th t cng vic no chn trc s l cng vic lm trc, cng vic no chn sau s l cng vic k tip.

B3 Kch nt Link Tasks.
B4  thay i kiu lin kt, kch p vo ng li kt gia 2 cng vic ang mun thay i.

[Hnh nh: Minh ha click p vo ng lin kt]

Mt hp thoi Task Dependency xut hin

[Hnh nh: Hp thoi Task Dependency]

B5 Trong hp lit k Type, chn kiu lin kt, sau  kch OK.

Ch :  hu b lin kt gia cc cng vic, chn cc cng vic mun hu trong ct Task Name, v kch nt Unlink Tasks. Cc cng vic ny s c sp xp li da trn nhng lin kt v cc rng buc cn tn ti .

2. Cc cng vic gi chng ln nhau

Sau khi cc cng vic  c lin kt vi nhau, c th gi chng hay thm mt khong tr thi gian gia 2 cng vic. Trong Microsoft Project, c th nhp khong thi gian gi chng hay thi gian ngt qung i vi cc cng vic c lin kt.

B1 Trong ct Task Name, chn cng vic mun thm thi gian gi chng hay thi gian tr (y l nhng cng vic k tip), v sau  kch nt Task Information. C th thc hin thao tc trn bng cch chn cng vic v trong menu Project, chn mc Task Information.

[Hnh nh: Menu Project Task Information]

B2 Hp thoi Task Information hin ln, Kch Tab Predecessors.

[Hnh nh: Hp thoi Task Information - Tab Predecessors]

B3 Trong ct Lag, nhp thi gian gi chng hay thi gian tr.
 Nhp thi gian gi chng theo s m (v d, 2d cho 2 ngy gi chng)
 Nhp thi gian tr theo s dng.
B4 Kch nt OK.

Ch :  nhanh chng a thi gian xp chng hay thi gian tr cho mt cng vic k tip, kch p vo ng kt ni gia cng vic  v cng vic lm trc Gantt Chart, v sau  nhp thi gian gi chng hay thi gian tr trong hp thoi Task Dependency.

3. Thit lp thi gian bt u v thi gian kt thc ca cng vic

C th lp k hoch thc hin cc cng vic hiu qu bng cch nhp khong thi gian, to cc lin kt gia cc cng vic v sau   Microsoft Project tnh ton thi gian bt u v kt thc cho cc cng vic c lin quan. Tuy nhin phi xc nh thi gian bt u v thi gian kt thc cho mt s cng vic.

Nhng rng buc v thi gian bt u hay kt thc i vi mt cng vic c gi l nhng rng buc cng. Do Microsoft Project tnh ton h thng k hoch da c trn nhng rng buc ny do  ch s dng khi cng vic b rng buc v thi gian bt u hay kt thc.

B1 Trong ct Task Name, chn cng vic mun xc nh thi im bt u v kt thc, sau  kch Task Information.
B2 Chn Tab Advanced.
B3 Trong hp thoi Task Information, mc Constraint type, chn kiu rng buc.

[Hnh nh: Hp thoi Task Information - Tab Advanced]

B4 Chn ngy trong Constraint date, v kch OK.

Ch : Sau y l bng lit k cc kiu rng buc:

* Kiu rng buc | *  ngha
--- | ---
As soon as possible | Cng vic khng b rng buc
As Late as possible | Cng vic ny phi b tr hon cng lu cng tt
Finish No Earlier than | Cng vic phi kt thc sau ngy thng ch nh.
Finish No Later than | Cng vic phi kt thc vo ngy hoc sm hn ngy thng ch nh.
Must Finish On | Cng vic phi kt thc chnh xc vo ngy thng  nh.
Must Start On | Cng vic phi bt u vo ngy thng  nh
Start No Earlier than | Cng vic bt u vo ngy thng hoc mun hn ngy thng ch nh.
Start No Later than | Cng vic phi bt u trc ngy thng ch nh.

4. Xc nh hn cui cho 1 cng vic

Khi thit lp mt hn cui cho 1 cng vic, Microssoft Project s th hin mt du hiu thng bo nu cng vic trong k hoch l kt thc sau thi hn cui.

[Hnh nh: Minh ha cnh bo hn cht trn biu  Gantt]

Vic thit lp mt hn nh cho 1 cng vic khng nh hng nhiu n k hoch cng vic.  l cch Microsoft Project thng bo cho bit rng cng vic  s kt thc m vt qu thi gian hn nh  c th iu chnh k hoch hp l hn.

B1 Trn menu View, chn khung nhn Gantt.
B2 Trong ct Task Name, chn cng vic mun thit lp hn nh thi gian.
B3 Chn nt Task Information v sau  chn Tab Advanced.
B4 Trong phn Deadline, chn ngy hn nh v kch OK.

5. Chia mt cng vic thnh nhng phn nh

C th chia nh mt cng vic nu thi gian cho cng vic b ngt qung. iu ny rt c ch, v d s c thi gian tm thi dng cng vic ang lm  chuyn sang mt cng vic khc. C th chia mt cng vic thnh nhiu phn nu cn thit.

Cng phi ch  thm rng vic chia nh 1 cng vic thnh nhiu phn khng ging nh nhng cng vic nh k  c bit trong nhng bi trc.

B1 Trn menu View, chn khung nhn Gantt.
B2 Kch nt Split Task hay trong menu Edit chn mc Split Task.

[Hnh nh: Menu Edit Split Task]

B3 Trn thanh ngang biu din cng vic, kch vo ngy mun chia cng vic, sau  ko phn cn li ti ngy mun cng vic li bt u tip tc.

Ch  C th ghp li cc phn bng cch ko cc phn cng vic chm vo nhau.

14.5.4 Giai on 4 - Khi to ti nguyn, nhn lc cho cng vic

Khi to ti nguyn cho cc cng vic trong d n :
- Theo di mc  s dng ti nguyn trong d n
- Theo di c chi ph cho ti nguyn.

Giai on ny bao gm cc im chnh sau:
- To danh sch cc ti nguyn.
- Thay i thi gian lm vic cho nhn vin hay my mc.
- Khi to cc ti nguyn cho cng vic.
- Sa i khong thi gian thc hin cng vic.
- Kim tra hiu chnh vic khi to ti nguyn.

1. To danh sch ti nguyn

C th s dng khung nhn Resource Sheet trong Microsoft Project  to mt danh sch cc ti nguyn s dng trong d n nh nhn cng, thit b, nguyn vt liu. Cc ti nguyn bao gm ti nguyn cng vic v ti nguyn vt liu.

B1 Trn menu View, chn khung nhn Resource Sheet.

[Hnh nh: Menu View Resource Sheet]

B2 Trn menu View, ch ti Table, v sau  kch Entry.

[Hnh nh: Menu View Table Entry]

B3 Trong ct Resource Name, nh tn ti nguyn.

[Hnh nh: Bng danh sch ti nguyn Resource Sheet]

B4  ch nh nhm ti nguyn, trong ct Group, nh tn nhm.
B5 Trong ct Type, xc nh kiu ti nguyn
B6 Vi mi mt kiu ti nguyn cng vic (ngi v my mc, thit b), nhp n v ti ct Max. Vi kiu ti nguyn ny n v s dng c tnh theo t l phn trm ca gi tr max. V d, nhp 100% c ngha l thi gian s dng ton b thi gian lm vic i vi mi ti nguyn no .

Ch :
 Nhm ti nguyn c dng  sp xp, lc hay nhm cc cng vic, v d nh c th xem danh sch cc cn b ca mt nhm chuyn  no .
 Khng th khi to nhm ti nguyn cho 1 cng vic no 

2. Thay i thi gian lm vic cho nhn vin

C th nh ngha thi gian lm vic cho mt nhn vin no   thch ng vi d n. Ly mt v d rt n gin nh sau, mt nhn vin A c thi gian ngh ti thng 6 nhng nhn vin B li l thng 7 v vy cn phi c nhng thi gian biu khc nhau i vi tng nhn vin.

B1 Trn menu View, chn Resource Sheet, v sau  chn ti nguyn mun thay i thi gian lm vic.
B2 Trong menu Project, chn Resource Information, v chn tab Working Time.

[Hnh nh: Menu Project Resource Information]

[Hnh nh: Hp thoi Resource Information - Tab General]

B3 Trong Tab Resource Information, ti h thng lch lm vic, chn ngy mun thay i.

[Hnh nh: Hp thoi Resource Information - Tab Working Time]

B4 Chn kiu Use default, Nonworking time, hay Nondefault.
Khi chn Use default, thi gian lm vic ca ngy chn s ly theo thi gian mc nh ca h thng Microsoft Project.
B5 Nu chn Nondefault ti bc 4, nhp thi gian bt u vo mc From v thi gian kt thc vo mc To.
B6 Chn OK.

Ch : Nu 1 nhm ti nguyn c cng thi gian lm vic v ngh ging nhau, c th to mt lch lm vic mi cho chng. Trn menu Tools, chn Change Working Time. Kch New v nhp tn cho h thng lch lm vic mi.

3. Khi to cc ti nguyn cho cng vic

C th khi to bt c mt ti nguyn no cho bt k cng vic no, c th khi to nhiu hn 1 ti nguyn cho mt cng vic v xc nh ti nguyn  c s dng ton thi gian hay bn thi gian. Nu s khi to thi gian s dng ti nguyn vt qu thi gian cho php ( c thit lp trong h thng lch s dng ti nguyn), Microsoft Project th hin mc  s dng qu ti ti nguyn  bng mu  trong khung nhn Resouce View.

B1 Trong menu View, chn Gantt Chart.
B2 Trong ct Task Name, chn cng vic mun khi to ti nguyn, v sau  kch Assign Resources hay trong menu Tools, mc Resources, chn Assign Resources.

[Hnh nh: Menu Tools Assign Resources]

B3 Trong ct Name, chn ti nguyn mun khi to cho cng vic.
B4 Nu ch s dng ti nguyn bn thi gian, nhp s phn trm s dng
  khi to mt s ti nguyn, gi phm CTRL v sau  kch vo tn ca cc ti nguyn.
B5 Kch Assign.
B6 Kch Close.

Ch : C th thay th ti nguyn ny bng ti nguyn khc. Chn cng vic c ngun ti nguyn mun thay th. Trong hp thoi Assign Resources, chn tn ti nguyn v kch Replace.

4. Sa i khong thi gian thc hin cng vic

Khi khi to nhiu ti nguyn cho mt cng vic, Microsoft Project t ng gim khong thi gian thc hin cng vic. V d mt cng vic do 1 nhn vin thc hin trong mt ngy th s ch mt na ngy  thc hin nu hai nhn vin cng thc hin. Nu mun gi khong thi gian thc hin cho cng vic  l nh c trong khi vn c thm ti nguyn s dng cho cng vic , thc hin nh sau.

B1 Trn menu View, kch khung nhn Gantt.

[Hnh nh: Menu View Gantt Chart]

B2 Trong ct Task Name, chn tn cng vic.
B3 Kch nt Task Information trn thanh cng c hay trong menu Project chn mc Task Information. V sau  chuyn sang Tab Advanced.

[Hnh nh: Menu Project Task Information]

B4 Trong hp thoi Task Information xo b du kim trong mc Effort driven, v sau  kch OK.

[Hnh nh: Hp thoi Task Information - Tab Advanced]

By gi khi khi to thm ti nguyn cho cng vic, khong thi gian thc hin s khng thay i.

Ch : C th lm cho tt c cc cng vic mi s to ra khi thm ti nguyn th thi gian thc hin s khng gim bng cch trong menu Tools, chn mc Options, kch tab Schedule v sau  b du kim ti mc New tasks are effort driven.

[Hnh nh: Hp thoi Options - Tab Schedule]

5. Kim tra hiu chnh vic khi to ti nguyn

Khung nhn Resource Usage th hin tt c cc ti nguyn s dng trong d n. Vi khung nhn ny, c th thy rng ngun ti nguyn c s dng nh th no, nhng ngun ti nguyn no c th s dng c tip, ngun ti nguyn no ang b qu ti.

B1 Trong menu View, chn Resource Usage.

[Hnh nh: Menu View Resource Usage]

 c nhiu thng tin hn v vic s dng ti nguyn, trong menu View, mc Table, kch vo bng mun hin th trong khung nhn Resource Usage.

[Hnh nh: Menu View Table]

B2 Trong ct Resource Name, xem li cc cng vic s dng ngun ti nguyn ny.
B3  chuyn i ngun ti nguyn cho mt cng vic, chn hng cha cng vic  v sau  ko ln phn ti nguyn cn chuyn i.

Ch :
 Vic thm cc bng thng tin hin th trn khng lm thay i thng tin v d liu m ch l thay i cch th hin.
 Nu mt ti nguyn mu  v m, ti nguyn  ang b s dng qu ti.

14.5.5 Giai on 5 - Xem xt h thng cng vic

Sau khi nhp ht nhng thng tin v d n, hy xem xt li xem chng c ph hp vi d tnh hay khng. Nu khng hy kim tra li qu trnh thc hin cc cng vic. Giai on ny bao gm cc im chnh sau:
- Xem xt ton b d n
- Kim tra ngy bt u v kt thc ca d n
- Chuyn i gia cc khung nhn
- Xem xt cc ct khc nhau trong mt khung nhn
- Th hin thng tin c chn lc
- Sp xp thng tin trong mt khung nhn
- Nhm thng tin trong mt khung nhn

1. Xem xt ton b d n

C th quan st thi gian bt u, kt thc d n v thi gian nhng pha chnh xy ra trn khung nhn Gantt.

B1 Trn menu View, chn Gantt Chart.
B2 On the View menu, click Zoom, click Entire project, and then click OK.

[Hnh nh: Hp thoi Zoom]

2. Kim tra ngy bt u v kt thc ca d n

C th xem li thng tin v ngy kt thc d n xem c ng mong i hay khng.

Trong menu Project, chn Project Information v kch Statistics, ngy bt u v kt thc d n s c hin th.

3. Chuyn i gia cc khung nhn

C th thy c d n qua cc khung nhn khc nhau nh: Calendar, Network Diagram, Task Usage, Resource Usage, Resource Graph...

Trn menu View, chn khung nhn mun quan st.
Nu khung nhn mun quan st hin thi khng c trong menu View, kch vo mc More Views  c nhiu la chn. Chn 1 kiu khung nhn trong bng lit k Views, sau  chn Apply.

Ch : Thay i khung nhn khng lm nh hng n d liu thng tin d n, n ch thay i cch nhn v d n.

Di y l 8 khung nhn thng dng nht:

Tn khung nhn | Ni dung
--- | ---
Calendar | Lch hng thng ch ra cc cng vic v kh nng hon thnh n.
Gantt Chart | Din t cc cng vic v cc thng tin c lin quan, mt biu  (biu  ngang) th hin cc cng vic v thi gian hon thnh chng.
Network Diagram | Th hin di dng li cc cng tc (s  mng) v s ph thuc gia chng. Dng khung nhn ny  c mt ci nhn bao qut v cc cng vic.
Task Usage | Th hin danh sch cc cng vic  c gn ti nguyn. Dng khung nhn ny  thy ngun ti nguyn no  c gn cho mt cng vic c th
Tracking Gantt | Th hin danh sch ca cng vic v thng tin c lin quan. Dng khung nhn ny  theo di tin trnh ca d n.
Resource Graph | Th hin biu  phn phi ti nguyn. Dng khung nhn ny  th hin thng tin v mt ti nguyn di cc tiu ch khc nhau.
Resource Sheet | Danh sch ti nguyn v thng tin lin quan. Dng khung nhn ny  nhp v hiu chnh cc thng tin v ti nguyn.
Resource Usage | Th hin danh sch gn ti nguyn cho cng vic c nhm di mi ngun ti nguyn. Dng khung nhn ny  th hin chi ph hoc phn phi gi cng ngoi gi.
More View | Cho php la chn cc khung nhn khc ca chng trnh.

4. Xem xt cc ct khc nhau trong mt khung nhn

Trong khi lp v theo di d n, rt hu ch nu chng ta c th xem xt thm nhiu t hp cc thng tin trong mt khung nhn. Microsoft Project cung cp mt tp hp cc t hp thng tin i vi mi khung nhn:

B1 Trong menu View, chn khung nhn mun quan st.
B2 Trn menu View, mc Table, chn bng mun xut hin trong khung nhn.

 thm nhng bng khng nm trong mc Table, chn More Tables, chn bng mun thm, v sau  chn Apply.

5. Th hin thng tin c chn lc

i khi, ch cn theo di ch mt s cng vic xc nh no , Microsoft Project cho php lc thng tin trong ton d n  c c nhng thng tin cn thit.

B1 Trn menu Project, mc Filtered for, sau  chn kiu lc.
 nhp kiu lc hin thi khng nm trong mc Filtered for, chn mc More Filters.
B2 Chn Apply  xc nh kiu lc.
B3  th hin tt c cc cng vic tr li, trn menu Project v sau  chn All Tasks hay All Resources.

Ch : Khng th lc cc cng vic trong khung nhn Resource hay lc cc ti nguyn trong khung nhn Task.

6. Sp xp thng tin trong mt khung nhn

C th sp xp cc cng vic hay ti nguyn theo mt iu kin no  nh tn cng vic, ngy kt thc, tn ti nguyn. Vic sp xp s l rt hu ch khi mun theo di cc cng vic theo th t. V d c th xem xt cng vic no nn bt u hay kt thc sm hn.

Vic sp xp vn c duy tr khi chuyn i gia cc khung nhn cng nh ng hay lu d n.

B1 Trn menu View, chn Gantt Chart.
B2 Trn menu Project, mc Sort, v chn kiu sp xp theo  mun.

[Hnh nh: Menu Project Sort]

B3  tin li trong qu trnh sp xp, Microsoft Project cung cp mt chc nng tu bin khi sp xp. Trong menu Project, mc Sort, v chn Sort by.
B4 Trong hp thoi Sort by, chn nhng ct mun sp xp, v chn Ascending hay Descending  xc nh kiu sp xp l tng dn hay gim dn.

[Hnh nh: Hp thoi Sort]

7. Nhm thng tin trong mt khung nhn

Trong mt s khung nhn, c th nhm cc cng vic hay ti nguyn theo mt iu kin no . V d, c th xem xt tt c nhng cng vic c cng mt khong thi gian thc hin.

B1  nhm thng tin v cng vic, trn menu View, chn mc More Views, v sau  chn Task Sheet.
 nhm thng tin v ti nguyn, trn menu View, chn Resource Sheet.
B2 Trong menu Project, mc Group by, v chn nhm.
 chn mt nhm khng nm trong mc Group by, kch More Groups.

[Hnh nh: Menu Project Group by]

B3  tr li trng thi ban u, trn menu Project, mc Group by v chn No Group.

14.5.6 Giai on 6- Xem v in bo co

Vic in n cc bo co c th theo cc dng sau:
- Cc bo co chun ca Microsoft Project 2003.
- Tin  chung ca d n.
- Bo co lch trnh cc cng vic.
- Bo co v vic s dng ti nguyn v cc cng vic.
- Bo co v lch lm vic theo tun, qu, thng.
- Cc bo co chun ca Microsoft Project
- Thit lp cu hnh trang in.
- In cc biu  ca d n.

1. Cc bo biu chun ca Microsoft Project

Trong menu View chn mc Reports

[Hnh nh: Menu View Reports]

Hp thoi Reports hin ln:

[Hnh nh: Hp thoi Reports]

 ngha ca cc bng la chn:

Mc |  ngha
--- | ---
Overview | Cc biu tng quan v d n
Current Activities | Bo co v cc cng vic
Cost | Cc bo biu v ti chnh ca d n
Assignment | Bo biu v phn b ti nguyn
Workload | Bo biu v vic thc hin cng vic v s dng ti nguyn
Custom | Bo biu c thit lp bi ngi s dng

2. In cc biu  ca d n

Biu  tin  ca d n thng c in di 2 dng chnh:
- Biu  Gantt
- S  mng Network Diagram

Trong menu File chn Print Preview

[Hnh nh: Menu File Print Preview]

Khung nhn Print Preview hin th:

[Hnh nh: Mn hnh Print Preview]

3. Thit lp cu hnh trang In

Trong menu File, chn Page Setup

[Hnh nh: Menu File Page Setup]

Hp thoi Page Setup xut hin

[Hnh nh: Hp thoi Page Setup]

Trong hp thoi Page Setup ny cho php thit lp cc tham s
Page: t cch nhn kh giy cho trang in.
Margins: Cn l trang in.
Header: Cc tiu  bn trn trang in ca d n.
Footer: Cc tiu  bn di trang in ca d n.
Legend: Cc hnh minh ha cho trang in.
View: Thit lp cc cu hnh cho trang in.

 Cu hi (bi tp) cng c:
1. Anh, ch hy chn 1 d n, sau  vit:
-  cng cho d n
- Ti liu nghin cu kh thi
- Lp k hoch cho d n
- c lng
2. Dng Microsoft Project  lp lch cho d n`}],Ost={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDgAQpq-gbHeYVJen_cMMgepsxf0TzUopI",VITE_FIREBASE_APP_ID:"1:252346768980:web:16f1f4b9d365d6e1ad57c1",VITE_FIREBASE_AUTH_DOMAIN:"quiz-cd4c1.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-8JDJSZR9X9",VITE_FIREBASE_MESSAGING_SENDER_ID:"252346768980",VITE_FIREBASE_PROJECT_ID:"quiz-cd4c1",VITE_FIREBASE_STORAGE_BUCKET:"quiz-cd4c1.firebasestorage.app",VITE_GACHA_PROXY_URL:"https://quizqtdathayquoc.vercel.app/",VITE_GEMINI_API_KEY_1:"AIzaSyDSl3ipTnBOASJzZdlPqbLsKQCGtPAmppo",VITE_GEMINI_API_KEY_10:"AIzaSyAdI0111XPeOwsXKNve0ksEjzPIUir8zy4",VITE_GEMINI_API_KEY_11:"AIzaSyDLtQe67Qu_eWywsl_9WrxU6Z7whyG8Sbc",VITE_GEMINI_API_KEY_12:"AIzaSyD07fAfHdsRdzL_b1wPA-mIHs9jRd6EwkI",VITE_GEMINI_API_KEY_13:"AIzaSyCw-CX-iOz3FhzYjUUSiYPYstRH99Isvlw",VITE_GEMINI_API_KEY_14:"AIzaSyDFy_rQO4qu9TTpvCNUUIYJVd5WfUerJik",VITE_GEMINI_API_KEY_15:"AIzaSyCY9ZbH5Sc0G08_kbcowlex8rFVsS_5ezE",VITE_GEMINI_API_KEY_16:"AIzaSyAEix1NdYb4IJnPLMvAQ1hv3yjg-w2gdjE",VITE_GEMINI_API_KEY_17:"AIzaSyBCX6dP1thS5zaDxwIlAk4ERCmTpaMy1aY",VITE_GEMINI_API_KEY_18:"AIzaSyCZbg-DCDGNr8Tl23yIMnJc12nyc5RqGSg",VITE_GEMINI_API_KEY_19:"AIzaSyDSqySCfafOmoIILzlshPc-9LiPu6qr3NE",VITE_GEMINI_API_KEY_2:"AIzaSyCUERop1C_tHy0i9nRfpSq6Ua8FyfH7ahE",VITE_GEMINI_API_KEY_20:"AIzaSyA01LBQ2txCyTsX5EHgFjYFD059Juriy-0",VITE_GEMINI_API_KEY_21:"AIzaSyBRz_hVsdCsz4b5hV7lazkwrT9B8iVXgww",VITE_GEMINI_API_KEY_22:"AIzaSyAklKYmEcjNSDGzOJy5b2EdAgUHkOunL7o",VITE_GEMINI_API_KEY_23:"AIzaSyD_W_R_ZQbjvRyr-6ZTmismld9dHIcGPVo",VITE_GEMINI_API_KEY_24:"AIzaSyB55WMCndclBEwwtfcr_u26FWLgwgB7SAk",VITE_GEMINI_API_KEY_25:"AIzaSyAJ7ayYRFDUqgwr39O-m7VRSBcn5O3nic0",VITE_GEMINI_API_KEY_26:"AIzaSyCrW8VvnC00mfzqqks-LCpDbnrLJCGGqmM",VITE_GEMINI_API_KEY_27:"AIzaSyAhUx3NxsHZPRc9mtjCFXUeZYK2hAAVS58",VITE_GEMINI_API_KEY_28:"AIzaSyAFd4MMvolUjRIGF00uKKsof7xm18F7XkY",VITE_GEMINI_API_KEY_29:"AIzaSyAW9A5RqeaXVIp_naEHKrfOQKeGrwqJLnU",VITE_GEMINI_API_KEY_3:"AIzaSyARDCacbHpYaQR6rbkucbniRwdbIeneUPg",VITE_GEMINI_API_KEY_30:"AIzaSyAyedibmuGw5RO2LAmDD7a0SEryoF9HeKo",VITE_GEMINI_API_KEY_4:"AIzaSyCCIw1IV3W7mYJ6hfZDeinVSY1Zhywf18o",VITE_GEMINI_API_KEY_5:"AIzaSyCUGV8ymrgFd7aJelOeoUZ_4aOdlT1yKss",VITE_GEMINI_API_KEY_6:"AIzaSyB6RmuV2_M5D8oe-Ka9-6agkNnjIY8jDVM",VITE_GEMINI_API_KEY_7:"AIzaSyDy2Zd9Tkw0L2vlo9WIGv0y4UnR18LUayg",VITE_GEMINI_API_KEY_8:"AIzaSyD7W8KvBsxVK_vRGl9zM6yvMJhq80JKLn0",VITE_GEMINI_API_KEY_9:"AIzaSyDf_5lu3MhNeJRb-qRgFzsgESgv5no0DFU"},Ue=[{id:"wood",name:"G",shortName:"G",tiers:7,minScore:0,difficulty:1,folder:"Wood"},{id:"stone",name:"",shortName:"",tiers:7,minScore:100,difficulty:2,folder:"Stone"},{id:"bronze",name:"ng",shortName:"ng",tiers:7,minScore:300,difficulty:3,folder:"Bronze"},{id:"silver",name:"Bc",shortName:"Bc",tiers:7,minScore:600,difficulty:4,folder:"Silver"},{id:"gold",name:"Vng",shortName:"Vng",tiers:7,minScore:1e3,difficulty:5,folder:"Gold"},{id:"platinum",name:"Bch Kim",shortName:"B.Kim",tiers:7,minScore:1500,difficulty:6,folder:"Platinum"},{id:"amethyst",name:"Thch Anh",shortName:"T.Anh",tiers:7,minScore:2200,difficulty:7,folder:"Amethyst"},{id:"onyx",name:"Hc Ngc",shortName:"H.Ngc",tiers:7,minScore:3e3,difficulty:8,folder:"Onyx"},{id:"master",name:"Huyn Thoi",shortName:"H.Thoi",tiers:0,minScore:4e3,difficulty:10,folder:"Master",isMaster:!0}];function Bst(){const e=Math.floor(Math.random()*Y1.length);return Y1[e]}function Gst(e){return`Bn l AI chuyn gia v Qun Tr D n CNTT. Di y l ni dung kin thc bn cn da vo  to cu hi:

=== ${e.name} ===
${e.content}

 QUY TC QUAN TRNG:
1. CH to cu hi da trn ni dung kin thc ca chng ny
2. KHNG to cu hi v ni dung khng c trong ti liu
3. m bo p n ng phi chnh xc theo ni dung ti liu
4. Gii thch phi trch dn hoc tham chiu n ni dung trong ti liu`}const Hst={type:le.OBJECT,properties:{questions:{type:le.ARRAY,items:{type:le.OBJECT,properties:{id:{type:le.STRING,description:"ID duy nht ca cu hi"},type:{type:le.STRING,enum:["multiple_choice","true_false","fill_blank","matching","ordering","multi_select","scenario"],description:"Loi cu hi"},question:{type:le.STRING,description:"Ni dung cu hi"},options:{type:le.ARRAY,items:{type:le.STRING},description:"Cc la chn cho cu hi multiple_choice, true_false, multi_select, scenario"},correctAnswer:{type:le.STRING,description:"p n ng (string cho single answer, JSON array string cho multi answer)"},explanation:{type:le.STRING,description:"Gii thch p n"},pairs:{type:le.ARRAY,items:{type:le.OBJECT,properties:{left:{type:le.STRING},right:{type:le.STRING}},required:["left","right"]},description:"Cc cp ghp cho cu hi matching"},items:{type:le.ARRAY,items:{type:le.STRING},description:"Cc mc cn sp xp cho cu hi ordering"},distractors:{type:le.ARRAY,items:{type:le.STRING},description:"3 t gy nhiu cho cu hi fill_blank"},scenario:{type:le.STRING,description:"M t tnh hung thc t cho cu hi scenario"}},required:["id","type","question","correctAnswer","explanation"],propertyOrdering:["id","type","question","options","correctAnswer","explanation","pairs","items","distractors","scenario"]},description:"Danh sch cu hi"}},required:["questions"],propertyOrdering:["questions"]};function ps(e){let t=Ue[0];for(const a of Ue)if(e>=a.minScore)t=a;else break;if(t.id==="master")return{rankId:t.id,tier:0,points:e,rankName:t.name};const n=Ue.find(a=>a.minScore>t.minScore),i=e-t.minScore,r=n?(n.minScore-t.minScore)/t.tiers:200,s=Math.min(Math.floor(i/r),t.tiers-1),o=t.tiers-s;return{rankId:t.id,tier:o,points:e,rankName:`${t.name} ${o}`}}function qa(e){const t=Ue.find(i=>i.id===e.rankId);if(!t)return"/Rank/Wood/rank-wood-1_NoOL_large.png";if(e.rankId==="master")return"/Rank/master.png";const n=8-e.tier;return`/Rank/${t.folder}/rank-${e.rankId}-${n}_NoOL_large.png`}function $st(e,t,n){var u;const r=(((u=Ue.find(d=>d.id===e.rankId))==null?void 0:u.difficulty)||1)+(8-e.tier)*.5;let s="",o="",a="";r<=3?(s="D - Cu hi trc tip t ti liu, d nhn bit p n",o="multiple_choice, true_false",a="Hi trc tip nh ngha, khi nim c bn. p n sai r rng khc bit vi p n ng."):r<=5?(s="TRUNG BNH D - Cu hi bm st ti liu, cn nh chi tit",o="multiple_choice, true_false, fill_blank",a="Hi v chi tit trong ti liu, cc p n sai c th gn ging p n ng."):r<=7?(s="TRUNG BNH - Cu hi cn hiu ni dung, khng ch nh",o="multiple_choice, true_false, fill_blank, matching",a="Din t li cu hi theo cch khc, hi v mi quan h gia cc khi nim trong ti liu."):r<=9?(s="KH - Cu hi i hi hiu su v lin kt kin thc",o="multiple_choice, fill_blank, matching, ordering, multi_select",a="Hi v quy trnh, th t cc bc, kt hp nhiu khi nim trong cng chng. p n sai rt gn vi p n ng."):r<=11?(s="RT KH - Cu hi phn tch, vn dng kin thc",o="multiple_choice, fill_blank, matching, ordering, multi_select, scenario",a="t cu hi trong tnh hung c th, yu cu phn tch v p dng kin thc t ti liu. Cc p n u c v hp l."):(s="HUYN THOI - Cu hi tng hp, phn tch chuyn su",o="multiple_choice, fill_blank, matching, ordering, multi_select, scenario",a="To tnh hung phc tp i hi hiu su ton b ni dung chng. Cc p n u rt gn ng, ch khc  chi tit nh.");const c=Math.floor(Math.random()*1e6),h=Date.now();return`Bn l AI to cu hi trc nghim v Qun Tr D n CNTT.

 BT BUC: TT C CU HI, P N, GII THCH PHI BNG TING VIT. KHNG DNG TING ANH HAY NGN NG KHC.

 SESSION ID: ${c}-${h}
(Dng session ID ny  to b cu hi HON TON MI, KHC vi cc ln trc)

RANK HIN TI: ${e.rankName} ( kh: ${r.toFixed(1)}/12)
MC : ${s}
SNG TO: ${a}

 TO CU HI T CHNG: ${n.name}
(Ni dung chng  c cung cp trong system prompt)

To ${t} cu hi vi cc loi C TH DNG: ${o}

 YU CU QUAN TRNG:
- BM ST NI DUNG TI LIU: Tt c cu hi v p n PHI da trn ni dung chng  cung cp
- KHNG ba thng tin khng c trong ti liu
- PHI to cu hi KHC NHAU mi ln gi, KHNG lp li cu hi c
- Mi cu hi phi c ID duy nht (dng format: q_${c}_1, q_${c}_2, ...)

 V  KH:
-  kh KHNG phi l hi ngoi ti liu, m l CCH HI phc tp hn
- Rank thp: Hi trc tip, p n sai d loi
- Rank cao: Hi gin tip, p n sai rt gn ng, cn hiu su mi phn bit c

 V LOI CU HI:
- T DO chn loi cu hi ph hp vi ni dung, KHNG cn theo th t
- C th to nhiu cu cng loi, hoc a dng cc loi - ty ni dung ph hp
- u tin loi cu hi PH HP vi kin thc trong chng

QUY TC:
- NGN NG: Ch dng ting Vit cho tt c ni dung
- multiple_choice: 4 options, correctAnswer l 1 trong cc options
- true_false: options l ["ng", "Sai"], correctAnswer l "ng" hoc "Sai"
- fill_blank: question c ch trng ___, correctAnswer l t cn in, distractors l mng 3 t gy nhiu (t lin quan nhng SAI, phi khc correctAnswer)
- matching: pairs l mng {left, right}, correctAnswer l mng ["0-0", "1-1"...] 
- ordering: items l mng cn sp xp, correctAnswer l mng ng th t
- multi_select: 5-6 options, correctAnswer l MNG cc p n ng (2-3 p n), cu hi phi ghi r "Chn TT C p n ng"
- scenario: scenario l m t tnh hung thc t (2-3 cu), question l cu hi v tnh hung , 4 options, correctAnswer l 1 p n`}function zst(){const e=[];for(let t=1;t<=30;t++){const n=Ost[`VITE_GEMINI_API_KEY_${t}`];n&&n.trim()&&e.push(n.trim())}return e}const J1=zst();let mh=0;function Kst(e){return e instanceof Error?e.message.includes("429")||e.message.includes("rate limit")||e.message.includes("RESOURCE_EXHAUSTED")||e.message.includes("quota")||e.status===429:!1}async function Wst(e,t){const n=J1.length;let i=0;for(;i<n;){const r=J1[mh],s=new Ust({apiKey:r});console.log(` Using Gemini key ${mh+1}/${n}`);try{const a=(await s.models.generateContent({model:"models/gemini-flash-latest",contents:t,config:{systemInstruction:e,temperature:.9,thinkingConfig:{thinkingBudget:24576},responseMimeType:"application/json",responseSchema:Hst}})).text||"";return JSON.parse(a).questions||[]}catch(o){if(Kst(o))console.warn(` Gemini key ${mh+1} rate limited, trying next key...`),mh=(mh+1)%n,i++;else throw o}}throw new Error("ALL_GEMINI_KEYS_RATE_LIMITED")}async function Qst(e,t=5){const n=Bst();console.log(" Chng c chn:",n.shortName);const i=Gst(n),r=$st(e,t,n);try{return await Wst(i,r)}catch(s){return s instanceof Error&&s.message==="ALL_GEMINI_KEYS_RATE_LIMITED"?(console.warn(" All Gemini keys rate limited, using fallback questions..."),X1(t)):(console.error("Error generating AI questions:",s),X1(t))}}function X1(e){return[{id:"fb1",type:"multiple_choice",question:"D n l g?",options:["L hot ng nghin cu mang tnh l thuyt","L cng vic lp li nhiu ln theo chu k","L hot ng c phng php, s dng ngun lc  to sn phm mi","L k hoch sn xut c p dng lu di"],correctAnswer:"L hot ng c phng php, s dng ngun lc  to sn phm mi",explanation:"D n l hot ng c phng php, s dng ngun lc  to sn phm mi."},{id:"fb2",type:"true_false",question:"Qun l d n CNTT l vic t chc cc hot ng nhm t c mc tiu trong gii hn v thi gian, kinh ph v cht lng.",options:["ng","Sai"],correctAnswer:"ng",explanation:"y l nh ngha chnh xc v qun l d n CNTT."},{id:"fb3",type:"fill_blank",question:"Giao tip hiu qu nht din ra khi giao tip ___, mt i mt gia hai bn.",correctAnswer:"trc tip",explanation:"Giao tip trc tip, mt i mt l hnh thc hiu qu nht."},{id:"fb4",type:"multiple_choice",question:"Mc tiu ca d n l g?",options:["Gii quyt vn  thc t v p ng nhu cu ngi dng","a ra m hnh khoa hc v phng php nghin cu","Xy dng chin lc ti chnh cho t chc","Pht trin h thng phn mm phc v nghin cu"],correctAnswer:"Gii quyt vn  thc t v p ng nhu cu ngi dng",explanation:"Mc tiu ca d n l gii quyt vn  thc t v p ng nhu cu ngi dng."},{id:"fb5",type:"true_false",question:"ng gng (Critical Path) l chui hot ng di nht quyt nh thi gian hon thnh d n.",options:["ng","Sai"],correctAnswer:"ng",explanation:"ng gng l chui hot ng di nht, quyt nh thi gian ti thiu  hon thnh d n."}].slice(0,e)}function Yst(e,t,n=0){const i=Ue.find(o=>o.id===t.rankId),r=(i==null?void 0:i.difficulty)||1,s=(8-t.tier)*.2;if(e)return Math.round(10*(1+r*.1+s)+n);{const o=Math.min(3+r*1.5,15);return-Math.round(o)}}function Jst(e){const t=Ue.find(n=>n.id===e.rankId);return(t==null?void 0:t.minScore)||0}const Xst={stone:{gems:50,title:"t rank "},bronze:{gems:100,title:"t rank ng"},silver:{gems:200,title:"t rank Bc"},gold:{gems:400,title:"t rank Vng"},platinum:{gems:600,title:"t rank Bch Kim"},amethyst:{gems:1e3,title:"t rank Thch Anh"},onyx:{gems:1500,title:"t rank Hc Ngc"},master:{gems:3e3,title:"t rank Huyn Thoi"}};function Zst(e,t){switch(e.type){case"multiple_choice":case"true_false":case"fill_blank":case"scenario":{const n=String(e.correctAnswer).toLowerCase().trim(),i=String(t).toLowerCase().trim();return n===i||n.includes(i)||i.includes(n)}case"matching":return!Array.isArray(t)||!Array.isArray(e.correctAnswer)?!1:JSON.stringify([...t].sort())===JSON.stringify([...e.correctAnswer].sort());case"ordering":return!Array.isArray(t)||!Array.isArray(e.correctAnswer)?!1:JSON.stringify(t)===JSON.stringify(e.correctAnswer);case"multi_select":{if(!Array.isArray(t)||!Array.isArray(e.correctAnswer))return!1;const n=[...t].sort(),i=[...e.correctAnswer].sort();return JSON.stringify(n)===JSON.stringify(i)}default:return!1}}const tot=3e4;async function Fp(e,t={}){const n=lW(iq,"gacha_commands"),i=hW(n);return new Promise((r,s)=>{let o=!1;const a=setTimeout(()=>{o||(o=!0,ny(i),s(new Error(`Command timeout: ${e}`)))},tot);gW(i,c=>{var u;const h=c.val();!h||o||(h.status==="completed"||h.status==="error")&&(o=!0,clearTimeout(a),ny(i),h.status==="error"?s(new Error(((u=h.response)==null?void 0:u.error)||"Unknown error")):r(h.response))}),uW(i,{action:e,params:t,status:"pending",createdAt:Date.now()}).catch(c=>{o||(o=!0,clearTimeout(a),ny(i),s(c))})})}function fr(e){switch(e){case 40:return"UR";case 30:return"SR";case 20:return"R";case 10:return"N";default:return"Unknown"}}function mt(e){switch(e){case 40:return"#FFD700";case 30:return"#9B59B6";case 20:return"#3498DB";case 10:return"#95A5A6";default:return"#7F8C8D"}}function Co(e,t=400){return e?e.includes("hdslb.com")?`${e}@${t}w_${t}h_1c.webp`:e:""}function Ne(e,t=600){return e?e.includes("hdslb.com")?`${e}@${t}w.webp`:e:""}function ja(e){return!!(e&&e.length>1&&e[1])}const eot=5*60*1e3,L0=new Map;function Up(e){const t=L0.get(e);return t&&t.expiry>Date.now()?t.data:(L0.delete(e),null)}function Op(e,t,n=eot){L0.set(e,{data:t,expiry:Date.now()+n})}const Z1=new Set;function Zq(e){e.forEach(t=>{if(!t||Z1.has(t))return;const n=new Image;n.referrerPolicy="no-referrer",n.src=t,Z1.add(t)})}function tI(e){if(!(e!=null&&e.item_list))return;const t=e.item_list.map(n=>Ne(n.card_img,400));Zq(t)}function eI(e){const t=e.map(n=>Ne(n.act_square_img,400));Zq(t)}async function tj(){const e="collections",t=Up(e);if(t)return eI(t),t;try{console.log("[Gacha] Fetching collections via Firebase bridge...");const i=(await Fp("getCollections")).data||[];return i.sort((r,s)=>s.startTime-r.startTime),Op(e,i),eI(i),console.log("[Gacha] Got",i.length,"collections"),i}catch(n){throw console.error("[getGachaCollections] Error:",n),n}}async function ej(e){var i;const t=`collection-${e}`,n=Up(t);if(n)return n;try{const s=(i=(await Fp("getCollection",{actId:e})).data)==null?void 0:i.data;return s&&Op(t,s),s||null}catch(r){throw console.error("[getGachaCollectionDetail] Error:",r),r}}async function Vu(e){var i;const t=await ej(e);if(!((i=t==null?void 0:t.lottery_list)!=null&&i.length))return[];const n=[];for(const r of t.lottery_list){const s=await not(e,r.lottery_id);s&&n.push(s)}return n}async function not(e,t){var r,s,o;const n=`lottery-${e}-${t}`,i=Up(n);if(i)return tI(i),i;try{const c=(r=(await Fp("getLottery",{collectionId:e,lotteryId:t})).data)==null?void 0:r.data;if(!c)return null;const h={lottery_id:t,lottery_name:c.lottery_name||"",price:c.price||0,lottery_image:c.lottery_image||"",item_list:(c.item_list||[]).map(u=>{var d,f,v,y,_,w,x,C,k,P;return{item_type:u.item_type,card_info:u.card_info,card_name:((d=u.card_info)==null?void 0:d.card_name)||"",card_img:((f=u.card_info)==null?void 0:f.card_img)||"",card_scarcity:((v=u.card_info)==null?void 0:v.card_scarcity)||0,card_type:(y=u.card_info)==null?void 0:y.card_type,card_id:(_=u.card_info)==null?void 0:_.card_id,width:((w=u.card_info)==null?void 0:w.width)||0,height:((x=u.card_info)==null?void 0:x.height)||0,video_list:((C=u.card_info)==null?void 0:C.video_list)||[],card_img_download:((k=u.card_info)==null?void 0:k.card_img_download)||"",is_physical_orientation:(P=u.card_info)==null?void 0:P.is_physical_orientation}}),collect_list:c.collect_list||{},collect_infos:((s=c.collect_list)==null?void 0:s.collect_infos)||[],collect_chain:((o=c.collect_list)==null?void 0:o.collect_chain)||[]};return Op(n,h,30*60*1e3),tI(h),h}catch(a){throw console.error("[getLotteryDetail] Error:",a),a}}async function iot(e,t,n){const i=`video-${e}-${t}-${n}`,r=Up(i);if(r)return r;try{const s=await Fp("getVideoUrl",{collectionId:e,lotteryId:t,cardImg:n});return s.videoUrl?(Op(i,s.videoUrl,25*60*1e3),s.videoUrl):null}catch(s){return console.error("[getFreshVideoUrl] Error:",s),null}}const Yb={conquest:{name:"Chinh Chin",rewards:[{rank:1,gems:1500,title:"Top 1 Chinh Chin",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 Chinh Chin",icon:"medal"},{rank:3,gems:750,title:"Top 3 Chinh Chin",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 Chinh Chin",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 Chinh Chin",icon:"star"}]},score:{name:"im Tng",rewards:[{rank:1,gems:1500,title:"Top 1 im Tng",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 im Tng",icon:"medal"},{rank:3,gems:750,title:"Top 3 im Tng",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 im Tng",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 im Tng",icon:"star"}]},urCards:{name:"Th UR",rewards:[{rank:1,gems:1500,title:"Top 1 Th UR",icon:"crown"},{rank:2,gems:1e3,title:"Top 2 Th UR",icon:"medal"},{rank:3,gems:750,title:"Top 3 Th UR",icon:"medal"},{rank:[4,10],gems:400,title:"Top 4-10 Th UR",icon:"trophy"},{rank:[11,20],gems:200,title:"Top 11-20 Th UR",icon:"star"}]}},rot=(e,t)=>{const n=Yb[e].rewards;for(const i of n){if(typeof i.rank=="number"&&i.rank===t)return i;if(Array.isArray(i.rank)){const[r,s]=i.rank;if(t>=r&&t<=s)return i}}return null},sot=async e=>{const t=new Date().toDateString(),n=Dt(kt,"leaderboardRewardLogs",`${e}_${t}`);if((await Qr(n)).exists())return{sent:!1,reason:"already_sent"};const r=[{key:"conquest",orderField:"conquestStats.rankPoints"},{key:"score",orderField:"totalScore"},{key:"urCards",orderField:"gachaInventory.gachaStats.totalURCards"}],s=[];for(const{key:o,orderField:a}of r)try{const c=cl(Wr(kt,"users"),Bw(a,"desc"),Gw(20)),d=(await Ia(c)).docs.map(f=>f.data()).findIndex(f=>f.oderId===e)+1;if(d>0&&d<=20){const f=rot(o,d);f&&s.push({category:Yb[o].name,rank:d,gems:f.gems,title:f.title})}}catch(c){console.error(`Error checking ${o} leaderboard:`,c)}if(s.length===0)return{sent:!1,reason:"no_rewards"};for(const o of s)await vp(Wr(kt,"mails"),{title:o.title,content:`Chc mng bn  t hng ${o.rank} trong BXH ${o.category}! y l phn thng xng ng cho n lc ca bn.`,reward:o.gems,active:!0,createdAt:new Date().toISOString(),targetUserId:e,type:"leaderboard_reward"});return await Hw(n,{userId:e,date:t,rewards:s,sentAt:new Date().toISOString()}),{sent:!0,rewards:s}};function oot(){const e=we(),{user:t}=te(),[n,i]=I.useState("conquest"),[r,s]=I.useState([]),[o,a]=I.useState(!0),[c,h]=I.useState(!1);I.useEffect(()=>{t!=null&&t.oderId&&sot(t.oderId).catch(console.error)},[t==null?void 0:t.oderId]),I.useEffect(()=>{(async()=>{a(!0);try{let _="exp";n==="conquest"?_="conquestStats.rankPoints":n==="urCards"&&(_="gachaInventory.gachaStats.totalURCards");const w=cl(Wr(kt,"users"),Bw(_,"desc"),Gw(100));let C=(await Ia(w)).docs.map(k=>k.data());n==="score"?C=C.map(k=>({...k,_calculatedScore:kf(k,0).totalScore})).sort((k,P)=>P._calculatedScore-k._calculatedScore).slice(0,50):C=C.slice(0,50),s(C)}catch(_){console.error("Error fetching leaderboard:",_),s([])}finally{a(!1)}})()},[n]);const u=y=>y===1?{bg:"bg-[var(--duo-yellow)]",icon:wf}:y===2?{bg:"bg-gray-400",icon:Dc}:y===3?{bg:"bg-amber-600",icon:Dc}:{bg:"bg-[var(--secondary)]",icon:null},d=()=>{switch(n){case"conquest":return"from-[var(--duo-purple)] to-[var(--duo-blue)]";case"score":return"from-[var(--duo-yellow)] to-[var(--duo-orange)]";case"urCards":return"from-[var(--duo-orange)] to-[var(--duo-yellow)]"}},f=y=>{e(`/profile/${y}`)},v=(y,_)=>{var N;const w=_+1,x=(t==null?void 0:t.oderId)===y.oderId,C=u(w),k=C.icon,P=()=>{var T,E,R;switch(n){case"conquest":return((T=y.conquestStats)==null?void 0:T.rankPoints)??0;case"score":return kf(y,0).totalScore;case"urCards":return((R=(E=y.gachaInventory)==null?void 0:E.gachaStats)==null?void 0:R.totalURCards)??0}},A=()=>{const T=P();switch(n){case"conquest":const E=ps(T);return l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:qa(E),alt:E.rankName,className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-bold text-[var(--duo-purple)]",children:Dn(T)})]});case"score":return l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-yellow)]",children:[l.jsx(Ve,{className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-lg",children:Dn(T)})]});case"urCards":return l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-orange)]",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-lg",children:T})]})}},M=()=>{var T;switch(n){case"conquest":return ps(((T=y.conquestStats)==null?void 0:T.rankPoints)??0).rankName;case"score":return"im";case"urCards":return"Th UR"}};return l.jsx("button",{onClick:()=>f(y.oderId),className:`card-3d p-3 w-full text-left ${x?"border-[var(--duo-green)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl ${C.bg} flex items-center justify-center`,children:k?l.jsx(k,{className:"w-5 h-5 text-white"}):l.jsx("span",{className:"font-bold text-[var(--muted-foreground)]",children:w})}),l.jsxs("div",{className:"relative w-[60px] h-[60px] flex items-center justify-center shrink-0",children:[y.equippedFrame&&l.jsx("img",{src:Ne(y.equippedFrame,80),alt:"Frame",className:"absolute inset-0 w-[60px] h-[60px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-xs overflow-hidden",children:y.equippedAvatar||y.avatar?l.jsx("img",{src:y.equippedAvatar?Ne(y.equippedAvatar,80):y.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((N=y.odername)==null?void 0:N.charAt(0).toUpperCase())||"?"})]}),y.equippedBadge&&l.jsx("div",{className:"w-8 h-8 shrink-0",children:l.jsx("img",{src:Ne(y.equippedBadge,60),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("p",{className:"font-bold text-foreground truncate",children:[y.odername||"Ngi chi",x&&l.jsx("span",{className:"text-[var(--duo-green)] ml-1",children:"(Bn)"})]}),l.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[l.jsxs("span",{className:"flex items-center gap-1 text-[var(--duo-orange)]",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-4 h-4"}),y.streak??0]}),l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Lv.",y.level??1]})]})]}),l.jsxs("div",{className:"text-right",children:[A(),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:M()})]})]})},y.oderId)};return l.jsxs(se,{className:"bg-background min-h-screen",children:[c&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:()=>h(!1),children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:y=>y.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)] flex items-center justify-center",children:l.jsx(Be,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"font-bold text-lg text-[var(--duo-orange)]",children:"Phn thng BXH"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhn thng mi ngy theo th hng"})]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsx("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)] text-center",children:["Phn thng c gi vo"," ",l.jsx("span",{className:"text-[var(--duo-orange)] font-bold",children:"Hm th"})," ","mi ngy da trn th hng ca bn."]})})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:l.jsx("div",{className:"space-y-4",children:Object.entries(Yb).map(([y,_])=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h3",{className:"font-bold text-foreground flex items-center gap-2 text-sm",children:[y==="conquest"&&l.jsx(Ci,{className:"w-4 h-4 text-[var(--duo-purple)]"}),y==="score"&&l.jsx(Ve,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),y==="urCards"&&l.jsx(Xt,{className:"w-4 h-4 text-[var(--duo-orange)]"}),_.name]}),l.jsx("div",{className:"space-y-1.5",children:_.rewards.map((w,x)=>{const C=()=>w.icon==="crown"?l.jsx(wf,{className:"w-4 h-4 text-[var(--duo-yellow)]"}):w.icon==="medal"?l.jsx(Dc,{className:"w-4 h-4 text-gray-400"}):w.icon==="trophy"?l.jsx(Ve,{className:"w-4 h-4 text-amber-600"}):l.jsx(Xt,{className:"w-4 h-4 text-[var(--duo-blue)]"});return l.jsxs("div",{className:"flex items-center justify-between bg-[var(--secondary)] rounded-xl px-3 py-2.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[C(),l.jsx("span",{className:"text-sm text-foreground font-medium",children:typeof w.rank=="number"?`Top ${w.rank}`:`Top ${w.rank[0]}-${w.rank[1]}`})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold text-[var(--duo-blue)]",children:["+",w.gems]})]})]},x)})})]},y))})}),l.jsx("div",{className:"px-5 pb-6",children:l.jsx("button",{onClick:()=>h(!1),className:"btn-3d btn-3d-orange w-full py-3",children:" hiu!"})})]})}),l.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r ${d()}`,children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ve,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Bng xp hng"})]})}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("p",{className:"text-white/80 text-sm flex items-center gap-1",children:["Top ngi chi  Nhn ",l.jsx(Rx,{className:"w-3 h-3 inline"})," xem phn thng"]}),l.jsx("button",{onClick:()=>h(!0),className:"w-9 h-9 rounded-full bg-white/20 flex items-center justify-center",children:l.jsx(Rx,{className:"w-5 h-5 text-white"})})]})]}),l.jsx("div",{className:"fixed top-[124px] left-0 right-0 z-40 px-4 py-3 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>i("conquest"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="conquest"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Ci,{className:"w-4 h-4"}),"Chinh Chin"]}),l.jsxs("button",{onClick:()=>i("score"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="score"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Ve,{className:"w-4 h-4"}),"im Tng"]}),l.jsxs("button",{onClick:()=>i("urCards"),className:`flex-1 flex items-center justify-center gap-1.5 py-2 px-2 rounded-xl text-xs font-semibold transition-all ${n==="urCards"?"bg-[var(--duo-orange)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Xt,{className:"w-4 h-4"}),"Th UR"]})]})}),l.jsx("div",{className:"px-4 pt-[188px] pb-28",children:o?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-[var(--duo-green)] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"ang ti..."})]}):r.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ve,{className:"w-16 h-16 text-[var(--muted-foreground)] mx-auto mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Cha c d liu"})]}):l.jsx("div",{className:"space-y-3",children:r.map((y,_)=>v(y,_))})})]})}function aot(e,t){let n;try{n=e()}catch{return}return{getItem:r=>{var s;const o=c=>c===null?null:JSON.parse(c,void 0),a=(s=n.getItem(r))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,s)=>n.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>n.removeItem(r)}}const V0=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(i){return V0(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return V0(i)(n)}}}},cot=(e,t)=>(n,i,r)=>{let s={storage:aot(()=>localStorage),partialize:w=>w,version:0,merge:(w,x)=>({...x,...w}),...t},o=!1,a=0;const c=new Set,h=new Set;let u=s.storage;if(!u)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...w)},i,r);const d=()=>{const w=s.partialize({...i()});return u.setItem(s.name,{state:w,version:s.version})},f=r.setState;r.setState=(w,x)=>(f(w,x),d());const v=e((...w)=>(n(...w),d()),i,r);r.getInitialState=()=>v;let y;const _=()=>{var w,x;if(!u)return;const C=++a;o=!1,c.forEach(P=>{var A;return P((A=i())!=null?A:v)});const k=((x=s.onRehydrateStorage)==null?void 0:x.call(s,(w=i())!=null?w:v))||void 0;return V0(u.getItem.bind(u))(s.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==s.version){if(s.migrate){const A=s.migrate(P.state,P.version);return A instanceof Promise?A.then(M=>[!0,M]):[!0,A]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var A;if(C!==a)return;const[M,N]=P;if(y=s.merge(N,(A=i())!=null?A:v),n(y,!0),M)return d()}).then(()=>{C===a&&(k==null||k(y,void 0),y=i(),o=!0,h.forEach(P=>P(y)))}).catch(P=>{C===a&&(k==null||k(void 0,P))})};return r.persist={setOptions:w=>{s={...s,...w},w.storage&&(u=w.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(h.add(w),()=>{h.delete(w)})},s.skipHydration||_(),y||v},nj=cot;function lot(){const e=new Date,t=e.getDay(),n=t===0?1:8-t,i=new Date(e);return i.setDate(e.getDate()+n),i.setHours(0,0,0,0),i.getTime()}function hot(e){if(!e)return!1;const t=new Date,n=new Date(e),i=new Date(t),r=t.getDay(),s=r===0?6:r-1;return i.setDate(t.getDate()-s),i.setHours(0,0,0,0),n.getTime()<i.getTime()}function Wh(e){return e*25}const Jb=Zu()(nj((e,t)=>({currentFloor:1,highestFloor:0,claimedFloors:[],totalGemsEarned:0,lastResetTime:null,allQuestions:[],totalFloors:0,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null,initTower:()=>{const{lastResetTime:n}=t(),i=Dx;hot(n)?e({currentFloor:1,highestFloor:0,claimedFloors:[],lastResetTime:Date.now(),allQuestions:i.questions,totalFloors:i.questions.length}):e(n?{allQuestions:i.questions,totalFloors:i.questions.length}:{lastResetTime:Date.now(),allQuestions:i.questions,totalFloors:i.questions.length})},startFloor:n=>{const{allQuestions:i,currentFloor:r}=t();if(n>r||n<1)return;const s=i[n-1];s&&e({activeFloor:n,currentQuestion:s,selectedAnswer:null,isAnswered:!1,isCorrect:null})},selectAnswer:n=>{const{isAnswered:i,currentQuestion:r}=t();if(i||!r)return;const s=n===r.correctAnswer;e({selectedAnswer:n,isAnswered:!0,isCorrect:s})},completeFloor:()=>{const{activeFloor:n,highestFloor:i,totalFloors:r}=t();if(!n)return{gems:0,isNewRecord:!1};const s=n>i,o=Math.min(n+1,r);return e({currentFloor:o,highestFloor:s?n:i}),{gems:Wh(n),isNewRecord:s}},failFloor:()=>{e({currentFloor:1,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},claimReward:n=>{const{claimedFloors:i,totalGemsEarned:r,highestFloor:s}=t();if(n>s||i.includes(n))return 0;const o=Wh(n);return e({claimedFloors:[...i,n],totalGemsEarned:r+o}),o},exitQuiz:()=>{e({activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},resetTower:()=>{const n=Dx;e({currentFloor:1,highestFloor:0,claimedFloors:[],totalGemsEarned:0,lastResetTime:Date.now(),allQuestions:n.questions,activeFloor:null,currentQuestion:null,selectedAnswer:null,isAnswered:!1,isCorrect:null})},getNextResetTime:()=>lot()}),{name:"tower-storage",partialize:e=>({currentFloor:e.currentFloor,highestFloor:e.highestFloor,claimedFloors:e.claimedFloors,totalGemsEarned:e.totalGemsEarned,lastResetTime:e.lastResetTime})})),uot={Target:ji,Flame:zr,Zap:Vr,Crown:wf,BookOpen:tl,Trophy:Ve,GraduationCap:gM,Gem:dM,Star:me,Sparkles:Xt,Medal:Dc,Coins:uM,Swords:Ci,Shield:mM,Award:vr,Package:Ts,Image:Bm,Building:Yu,Brain:cM},uy={first_quiz:30,streak_3:50,streak_7:100,streak_30:300,correct_50:75,correct_100:150,correct_500:400,correct_1000:800,perfect_5:100,perfect_20:250,perfect_50:600,level_5:75,level_10:150,level_20:300,gems_100:50,gems_500:150,gems_1000:300,conquest_first:60,conquest_10:150,conquest_50:400,conquest_wins_5:120,conquest_wins_10:300,rank_100:100,rank_500:200,rank_1000:400,rank_2000:800,gacha_first:60,gacha_pulls_50:150,gacha_pulls_100:300,gacha_pulls_500:800,gacha_ur_1:100,gacha_ur_5:250,gacha_ur_10:450,gacha_ur_25:1e3,gacha_sr_10:120,gacha_sr_50:350,gacha_cards_25:150,gacha_cards_100:400,gacha_cards_250:1e3,gacha_collection_1:300,gacha_collection_3:700,gacha_collection_5:1500,tower_floor_10:100,tower_floor_50:300,tower_floor_100:700,tower_floor_200:1500,tower_complete:3e3,quizzes_10:60,quizzes_50:180,quizzes_100:400,quizzes_500:1e3,correct_2000:1500,correct_5000:3e3,correct_10000:6e3,streak_60:600,streak_100:1500,streak_365:1e4,level_30:500,level_50:1e3,level_100:3e3,conquest_100:800,conquest_500:3e3,rank_3000:1200,rank_4000:2e3,rank_5000:4e3,gacha_pulls_1000:2e3,gacha_ur_50:2e3,gacha_ur_100:5e3,gacha_cards_500:3e3,quizzes_1000:2e3,quizzes_5000:8e3,perfect_100:1500,perfect_500:5e3,gems_5000:1e3,gems_10000:3e3};function dot(){const e=we(),{user:t,addGems:n,claimAchievementReward:i}=te(),{highestFloor:r,totalFloors:s,initTower:o}=Jb(),[a,c]=I.useState(!1),[h,u]=I.useState(null);I.useEffect(()=>{o()},[]);const d=(t==null?void 0:t.claimedAchievementRewards)||[],f=M=>{if(!t)return 0;const N=v(M);return Math.min(N/M.requirement*100,100)},v=M=>{var E,R,D,j,L;if(!t)return 0;const N=(E=t.gachaInventory)==null?void 0:E.gachaStats,T=((N==null?void 0:N.totalURCards)??0)+((N==null?void 0:N.totalSRCards)??0)+((N==null?void 0:N.totalRCards)??0)+((N==null?void 0:N.totalNCards)??0);switch(M.type){case"streak":return t.streak;case"correct":return t.totalCorrect;case"perfect":return t.perfectLessons??0;case"level":return t.level??1;case"gems":return t.gems??0;case"conquest":return((R=t.conquestStats)==null?void 0:R.totalConquests)??0;case"conquest_wins":return((D=t.conquestStats)==null?void 0:D.bestWinStreak)??0;case"rank_points":return((j=t.conquestStats)==null?void 0:j.rankPoints)??0;case"gacha_pulls":return((L=t.gachaInventory)==null?void 0:L.totalPulls)??0;case"gacha_ur":return(N==null?void 0:N.totalURCards)??0;case"gacha_sr":return(N==null?void 0:N.totalSRCards)??0;case"gacha_total_cards":return T;case"gacha_collections":return(N==null?void 0:N.completedCollections)??0;case"tower_floor":return r;case"tower_complete":return r>=s&&s>0?1:0;case"quizzes":return t.totalQuizzes??0;default:return 0}},y=M=>v(M)>=M.requirement,_=M=>{const N=cr.find(R=>R.id===M);if(!N)return!1;const T=y(N),E=d.includes(M);return T&&!E},w=async M=>{const N=uy[M.id]||10;await i(M.id),await n(N),u({achievement:M,gems:N}),c(!0),Se({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})},x=cr.filter(M=>y(M)).length,C=cr.filter(M=>_(M.id)).length,[k,P]=I.useState(!1),A=async()=>{if(k)return;const M=cr.filter(N=>_(N.id));if(M.length!==0){P(!0);try{const N=M.reduce((T,E)=>T+(uy[E.id]||10),0);for(const T of M)await i(T.id);await n(N),u({achievement:{name:`${M.length} thnh tu`},gems:N}),c(!0),Se({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(N){console.error("Error claiming all achievements:",N)}finally{P(!1)}}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a&&!!h,onClose:()=>c(!1),title:"Nhn qu thnh cng!",subtitle:`Thnh tu: ${h==null?void 0:h.achievement.name}`,rewards:h?[{type:"gems",amount:h.gems}]:[],gradientFrom:"var(--duo-yellow)",gradientTo:"var(--duo-orange)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-3 px-3 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Ji,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(vr,{className:"w-5 h-5 text-white shrink-0"}),l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Thnh tu"})]}),l.jsxs("p",{className:"text-white/80 text-xs truncate",children:[x,"/",cr.length,"  t"]})]}),C>0&&l.jsxs("button",{onClick:A,disabled:k,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Be,{className:"w-3.5 h-3.5"}),"Nhn (",C,")"]})]})}),l.jsx("div",{className:"px-4 pt-36 pb-28 space-y-3",children:cr.map(M=>{const N=y(M),T=d.includes(M.id),E=N&&!T,R=f(M),D=v(M),j=uot[M.icon],L=uy[M.id]||10;return l.jsx("div",{className:`card-3d p-4 ${E?"border-[var(--duo-green)] border-2":N?"border-[var(--duo-yellow)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center ${N?"bg-[var(--duo-yellow)]/20":"bg-[var(--secondary)]"}`,children:N?l.jsx(j,{className:"w-7 h-7 text-[var(--duo-yellow)]"}):l.jsx(Xu,{className:"w-6 h-6 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:`font-bold ${N?"text-[var(--duo-yellow)]":"text-foreground"}`,children:M.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mb-1",children:M.description}),l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx(Be,{className:"w-3 h-3 text-[var(--duo-blue)]"}),l.jsxs("span",{className:"text-[var(--duo-blue)] font-semibold",children:[L," Gems"]})]}),!N&&l.jsxs("div",{className:"mt-2",children:[l.jsx("div",{className:"progress-duo h-2",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${R}%`}})}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:[D,"/",M.requirement]})]})]}),E?l.jsx("button",{onClick:()=>w(M),className:"btn-3d btn-3d-green px-4 py-2.5 text-sm min-w-[70px]",children:"Nhn"}):N&&T?l.jsx(ai,{className:"w-6 h-6 text-[var(--duo-green)]"}):null]})},M.id)})})]})}const dy=[{id:"daily_xp_50",name:"Mc tiu XP",description:"Kim 50 XP hm nay",icon:ji,type:"daily",requirement:50,reward:30,getValue:e=>(e==null?void 0:e.dailyProgress)??0},{id:"daily_correct_10",name:"Tr li ng",description:"Tr li ng 10 cu",icon:ai,type:"daily",requirement:10,reward:40,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyCorrect)??0}},{id:"daily_quiz_3",name:"Hon thnh quiz",description:"Hon thnh 3 bi quiz",icon:tl,type:"daily",requirement:3,reward:50,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyQuizzes)??0}},{id:"daily_conquest_1",name:"Chinh chin",description:"Hon thnh 1 trn chinh chin",icon:Ci,type:"daily",requirement:1,reward:60,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyConquests)??0}},{id:"daily_gacha_1",name:"Quay gacha",description:"Quay gacha 1 ln",icon:Xt,type:"daily",requirement:1,reward:40,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyGachaPulls)??0}},{id:"daily_tower_3",name:"Leo thp",description:"Vt qua 3 tng thp luyn ngc",icon:Yu,type:"daily",requirement:3,reward:50,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyTowerFloors)??0}},{id:"daily_avatar_1",name:"i avatar",description:"Thay i avatar 1 ln",icon:xl,type:"daily",requirement:1,reward:25,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyAvatarChanged)??0}},{id:"daily_card_view_3",name:"Xem th",description:"Xem chi tit 3 th bt k",icon:Bm,type:"daily",requirement:3,reward:25,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.dailyCardViewed)??0}}],gy=[{id:"weekly_streak_7",name:"Streak tun",description:"Duy tr streak 7 ngy",icon:zr,type:"weekly",requirement:7,reward:150,getValue:e=>(e==null?void 0:e.streak)??0},{id:"weekly_xp_500",name:"XP tun",description:"Kim 500 XP trong tun",icon:Vr,type:"weekly",requirement:500,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyXP)??0}},{id:"weekly_perfect_3",name:"Hon ho",description:"3 bi quiz 100% trong tun",icon:me,type:"weekly",requirement:3,reward:250,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyPerfect)??0}},{id:"weekly_conquest_5",name:"Chin binh tun",description:"Hon thnh 5 trn chinh chin",icon:Ci,type:"weekly",requirement:5,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyConquests)??0}},{id:"weekly_conquest_wins_3",name:"Chui chin thng",description:"Thng 3 trn chinh chin",icon:vr,type:"weekly",requirement:3,reward:300,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyConquestWins)??0}},{id:"weekly_gacha_10",name:"Nh su tp",description:"Quay gacha 10 ln trong tun",icon:Xt,type:"weekly",requirement:10,reward:250,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyGachaPulls)??0}},{id:"weekly_tower_20",name:"Chinh phc thp",description:"Vt qua 20 tng thp trong tun",icon:Yu,type:"weekly",requirement:20,reward:200,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyTowerFloors)??0}},{id:"weekly_card_view_15",name:"Khm ph th",description:"Xem chi tit 15 th trong tun",icon:Bm,type:"weekly",requirement:15,reward:150,getValue:e=>{var t;return((t=e==null?void 0:e.questProgress)==null?void 0:t.weeklyCardViewed)??0}}];function got(){var k,P;const e=we(),{user:t,addGems:n,claimDailyQuest:i,claimWeeklyQuest:r}=te(),[s,o]=I.useState(!1),[a,c]=I.useState(null),h=[...((k=t==null?void 0:t.questProgress)==null?void 0:k.claimedDailyQuests)||[],...((P=t==null?void 0:t.questProgress)==null?void 0:P.claimedWeeklyQuests)||[]],u=A=>{const N=A.getValue(t)>=A.requirement,T=h.includes(A.id);return N&&!T},d=A=>{const M=A.getValue(t);return Math.min(M/A.requirement*100,100)},f=async A=>{await n(A.reward),A.type==="daily"?await i(A.id):await r(A.id),c({quest:A,gems:A.reward}),o(!0),Se({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]})},v=dy.filter(A=>u(A)).length,y=gy.filter(A=>u(A)).length,_=v+y,[w,x]=I.useState(!1),C=async()=>{if(w)return;const A=dy.filter(T=>u(T)),M=gy.filter(T=>u(T)),N=[...A,...M];if(N.length!==0){x(!0);try{const T=N.reduce((E,R)=>E+R.reward,0);for(const E of A)await i(E.id);for(const E of M)await r(E.id);await n(T),c({quest:{name:`${N.length} nhim v`},gems:T}),o(!0),Se({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(T){console.error("Error claiming all quests:",T)}finally{x(!1)}}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:s&&!!a,onClose:()=>o(!1),title:"Nhim v hon thnh!",subtitle:a==null?void 0:a.quest.name,rewards:a?[{type:"gems",amount:a.gems}]:[],gradientFrom:"var(--duo-green)",gradientTo:"var(--duo-blue)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-3 px-3 bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Ji,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(Ve,{className:"w-5 h-5 text-white shrink-0"}),l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Nhim v"})]}),l.jsx("p",{className:"text-white/80 text-xs truncate",children:"Hon thnh  nhn gems"})]}),_>0&&l.jsxs("button",{onClick:C,disabled:w,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Be,{className:"w-3.5 h-3.5"}),"Nhn (",_,")"]})]})}),l.jsxs("div",{className:"px-4 pt-32 pb-28 space-y-5",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(vu,{className:"w-5 h-5 text-[var(--duo-orange)]"}),l.jsx("h2",{className:"font-bold text-foreground",children:"Nhim v ngy"}),v>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:v})]}),l.jsx("div",{className:"space-y-2.5",children:dy.map(A=>{const M=A.icon,N=d(A),T=A.getValue(t),E=T>=A.requirement,R=h.includes(A.id),D=E&&!R;return l.jsx("div",{className:`card-3d p-3 ${D?"border-[var(--duo-green)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${E?"bg-[var(--duo-green)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(M,{className:`w-5 h-5 ${E?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground",children:A.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:A.description}),!E&&l.jsxs("div",{className:"mt-1.5",children:[l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${N}%`}})}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-0.5",children:[T,"/",A.requirement]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-sm",children:A.reward})]}),D?l.jsx("button",{onClick:()=>f(A),className:"btn-3d btn-3d-green px-4 py-2 text-sm min-w-[56px]",children:"Nhn"}):R?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):null]})]})},A.id)})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(nB,{className:"w-5 h-5 text-[var(--duo-purple)]"}),l.jsx("h2",{className:"font-bold text-foreground",children:"Nhim v tun"}),y>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:y})]}),l.jsx("div",{className:"space-y-2.5",children:gy.map(A=>{const M=A.icon,N=d(A),T=A.getValue(t),E=T>=A.requirement,R=h.includes(A.id),D=E&&!R;return l.jsx("div",{className:`card-3d p-3 ${D?"border-[var(--duo-purple)] border-2":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${E?"bg-[var(--duo-purple)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(M,{className:`w-5 h-5 ${E?"text-[var(--duo-purple)]":"text-[var(--muted-foreground)]"}`})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-sm text-foreground",children:A.name}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:A.description}),!E&&l.jsxs("div",{className:"mt-1.5",children:[l.jsx("div",{className:"progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${N}%`}})}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-0.5",children:[T,"/",A.requirement]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold text-sm",children:A.reward})]}),D?l.jsx("button",{onClick:()=>f(A),className:"btn-3d btn-3d-purple px-4 py-2 text-sm min-w-[56px]",children:"Nhn"}):R?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):null]})]})},A.id)})})]})]})]})}const ij=Zu()(nj((e,t)=>({theme:"dark",toggleTheme:()=>{const n=t().theme==="dark"?"light":"dark";e({theme:n}),fy(n)},setTheme:n=>{e({theme:n}),fy(n)}}),{name:"quiz-theme",onRehydrateStorage:()=>e=>{e&&fy(e.theme)}}));function fy(e){const t=document.documentElement;e==="light"?(t.classList.add("light"),t.classList.remove("dark")):(t.classList.add("dark"),t.classList.remove("light"))}function fot(){var X,tt;const e=we(),{theme:t,toggleTheme:n}=ij(),{user:i,addGems:r,useRedeemCode:s,updateUsername:o}=te(),[a,c]=I.useState(!1),[h,u]=I.useState(""),[d,f]=I.useState("idle"),[v,y]=I.useState(0),[_,w]=I.useState(!1),[x,C]=I.useState(0),[k,P]=I.useState(!1),[A,M]=I.useState(""),[N,T]=I.useState("idle"),[E,R]=I.useState(!1),D=(i==null?void 0:i.claimedAchievementRewards)??[],j=[{id:"daily_xp_50",requirement:50,getValue:O=>(O==null?void 0:O.dailyProgress)??0},{id:"daily_correct_10",requirement:10,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyCorrect)??0}},{id:"daily_quiz_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyQuizzes)??0}},{id:"daily_conquest_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyConquests)??0}},{id:"daily_gacha_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyGachaPulls)??0}},{id:"daily_tower_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyTowerFloors)??0}},{id:"daily_avatar_1",requirement:1,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyAvatarChanged)??0}},{id:"daily_card_view_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.dailyCardViewed)??0}}],L=[{id:"weekly_streak_7",requirement:7,getValue:O=>(O==null?void 0:O.streak)??0},{id:"weekly_xp_500",requirement:500,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyXP)??0}},{id:"weekly_perfect_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyPerfect)??0}},{id:"weekly_conquest_5",requirement:5,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyConquests)??0}},{id:"weekly_conquest_wins_3",requirement:3,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyConquestWins)??0}},{id:"weekly_gacha_10",requirement:10,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyGachaPulls)??0}},{id:"weekly_tower_20",requirement:20,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyTowerFloors)??0}},{id:"weekly_card_view_15",requirement:15,getValue:O=>{var B;return((B=O==null?void 0:O.questProgress)==null?void 0:B.weeklyCardViewed)??0}}],lt=[...((X=i==null?void 0:i.questProgress)==null?void 0:X.claimedDailyQuests)||[],...((tt=i==null?void 0:i.questProgress)==null?void 0:tt.claimedWeeklyQuests)||[]],dt=[...j,...L].filter(O=>O.getValue(i)>=O.requirement&&!lt.includes(O.id)).length,Y=[...j,...L].filter(O=>O.getValue(i)>=O.requirement).length,W=j.length+L.length,U=O=>{var K,at,ct,vt,Rt;if(!i)return 0;const B=(K=i.gachaInventory)==null?void 0:K.gachaStats,nt=((B==null?void 0:B.totalURCards)??0)+((B==null?void 0:B.totalSRCards)??0)+((B==null?void 0:B.totalRCards)??0)+((B==null?void 0:B.totalNCards)??0);switch(O){case"streak":return i.streak;case"correct":return i.totalCorrect;case"perfect":return i.perfectLessons??0;case"level":return i.level??1;case"gems":return i.gems??0;case"conquest":return((at=i.conquestStats)==null?void 0:at.totalConquests)??0;case"conquest_wins":return((ct=i.conquestStats)==null?void 0:ct.bestWinStreak)??0;case"rank_points":return((vt=i.conquestStats)==null?void 0:vt.rankPoints)??0;case"gacha_pulls":return((Rt=i.gachaInventory)==null?void 0:Rt.totalPulls)??0;case"gacha_ur":return(B==null?void 0:B.totalURCards)??0;case"gacha_sr":return(B==null?void 0:B.totalSRCards)??0;case"gacha_total_cards":return nt;case"gacha_collections":return(B==null?void 0:B.completedCollections)??0;case"quizzes":return i.totalQuizzes??0;case"tower_floor":case"tower_complete":return 0;default:return 0}},Q=O=>U(O.type)>=O.requirement,F=cr.filter(O=>Q(O)).length,q=cr.filter(O=>Q(O)&&!D.includes(O.id)).length;I.useEffect(()=>{(async()=>{if(i!=null&&i.oderId)try{const B=i.claimedMails||[],nt=i.deletedMails||[],K=Wr(kt,"mails"),at=cl(K,Of("active","==",!0)),Rt=(await Ia(at)).docs.filter(ht=>{const st=ht.data(),Tt=st.targetUserId;return st.type==="leaderboard_reward"?Tt===i.oderId:!Tt||Tt===i.oderId}).filter(ht=>!B.includes(ht.id)&&!nt.includes(ht.id)).length;C(Rt)}catch(B){console.error("Error checking mail:",B)}})()},[i==null?void 0:i.oderId,i==null?void 0:i.claimedMails,i==null?void 0:i.deletedMails]);const $=async()=>{if(!A.trim())return;await o(A)?(T("success"),setTimeout(()=>{P(!1),M(""),T("idle")},1e3)):T("error")},H=async()=>{if(!(!h.trim()||!i))try{const O=Wr(kt,"redeemCodes"),B=cl(O,Of("code","==",h.toUpperCase())),nt=await Ia(B);if(nt.empty){f("error");return}const K=nt.docs[0],at=K.data();if((i.usedRedeemCodes||[]).includes(K.id)){f("error");return}if(at.usageLimit&&at.usedCount>=at.usageLimit){f("error");return}await r(at.reward),await s(K.id),await Kt(Dt(kt,"redeemCodes",K.id),{usedCount:(at.usedCount||0)+1}),y(at.reward),c(!1),w(!0),u(""),f("idle"),Se({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(O){console.error("Redeem error:",O),f("error")}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:_,onClose:()=>w(!1),title:"i m thnh cng!",subtitle:"Bn  nhn c phn thng",rewards:[{type:"gems",amount:v}],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-blue)"}),k&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Px,{className:"w-8 h-8 text-[var(--duo-blue)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"i tn hin th"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Tn t 2-20 k t"}),l.jsx("input",{type:"text",value:A,onChange:O=>{M(O.target.value),T("idle")},placeholder:(i==null?void 0:i.odername)||"Nhp tn mi",maxLength:20,className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg mb-3"}),N==="success"&&l.jsx("p",{className:"text-[var(--duo-green)] text-center text-sm mb-3",children:"i tn thnh cng!"}),N==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"Khng th i tn. Vui lng th li."}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{P(!1),M(""),T("idle")},className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"Hy"}),l.jsx("button",{onClick:$,disabled:!A.trim()||A.trim().length<2,className:"flex-1 btn-3d btn-3d-blue py-3 disabled:opacity-50",children:"Lu"})]})]})}),E&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(dG,{className:"w-8 h-8 text-[var(--duo-red)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Xa cache?"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"D liu tm s b xa v trang s c ti li. D liu ti khon vn c gi nguyn."}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"Hy"}),l.jsx("button",{onClick:()=>{localStorage.clear(),window.location.href=window.location.origin},className:"flex-1 btn-3d btn-3d-red py-3",children:"Xa"})]})]})}),a&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Be,{className:"w-8 h-8 text-[var(--duo-purple)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Nhp m i thng"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Nhp m  nhn gems min ph"}),l.jsx("input",{type:"text",value:h,onChange:O=>{u(O.target.value.toUpperCase()),f("idle")},placeholder:"VD: QTDA2024",className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg uppercase mb-3"}),d==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"M khng hp l hoc  s dng"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{c(!1),u(""),f("idle")},className:"flex-1 py-3 rounded-xl bg-[var(--secondary)] text-foreground font-bold",children:"ng"}),l.jsx("button",{onClick:H,className:"flex-1 btn-3d btn-3d-green py-3",children:"i thng"})]})]})}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsx("h1",{className:"font-bold text-xl text-white",children:"Ti"})}),l.jsxs("div",{className:"px-4 pt-28 pb-32",children:[i&&l.jsxs("div",{className:"card-3d p-4 mb-5",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center shrink-0",children:[i.equippedFrame&&l.jsx("img",{src:Ne(i.equippedFrame,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden border-2 border-[var(--border)] shadow-lg",children:i.equippedAvatar||i.avatar?l.jsx("img",{src:i.equippedAvatar?Ne(i.equippedAvatar,100):i.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):i.odername.charAt(0).toUpperCase()})]}),i.equippedBadge&&l.jsx("div",{className:"w-12 h-12 shrink-0",children:l.jsx("img",{src:Ne(i.equippedBadge,80),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"font-bold text-lg text-foreground truncate",children:i.odername}),l.jsx("button",{onClick:()=>{M(i.odername),P(!0)},className:"p-1.5 rounded-lg bg-[var(--secondary)] border-2 border-[var(--border)] shadow-[0_2px_0_var(--border)] active:translate-y-0.5 active:shadow-none shrink-0",children:l.jsx(Px,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:["Level ",i.level,"  ",Dn(i.exp)," XP"]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>e(`/profile/${i.oderId}`),className:"flex-1 py-3 px-4 rounded-xl bg-[var(--secondary)] text-foreground font-bold flex items-center justify-center gap-2 border-2 border-[var(--border)] shadow-[0_4px_0_var(--border)] active:translate-y-1 active:shadow-none",children:[l.jsx(xl,{className:"w-5 h-5"}),l.jsx("span",{children:"H s"})]}),l.jsxs("button",{onClick:()=>e("/customize"),className:"flex-1 btn-3d btn-3d-purple py-3 px-4 flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Trang b"})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>e("/mailbox"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-orange)]/20 flex items-center justify-center",children:l.jsx(fM,{className:"w-5 h-5 text-[var(--duo-orange)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Hm th"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhn qu t h thng"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[x>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:x}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/quests"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx(ji,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Nhim v"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[Y,"/",W," hon thnh"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[dt>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:dt}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/achievements"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx(vr,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Thnh tu"}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[F,"/",cr.length,"  t"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[q>0&&l.jsx("span",{className:"bg-[var(--duo-red)] text-white text-xs px-2 py-0.5 rounded-full",children:q}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]})]}),l.jsxs("button",{onClick:()=>e("/stats"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(hM,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Thng k"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phn tch chi tit"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>e("/card-inventory"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Kho th"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Xem th  su tp"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>e("/shop"),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[var(--duo-purple)]/20 to-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Be,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Ca hng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Mua tim, XP boost, streak freeze"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsxs("button",{onClick:()=>c(!0),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Be,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"M i thng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Nhp m nhn gems"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsx("h3",{className:"text-sm font-semibold text-[var(--muted-foreground)] mt-4 mb-2",children:"Ci t"}),l.jsxs("button",{onClick:n,className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:t==="dark"?l.jsx(UB,{className:"w-5 h-5 text-[var(--duo-yellow)]"}):l.jsx(rG,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Ch  ti"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:t==="dark"?"ang bt":"ang tt"})]})]}),l.jsx("div",{className:`w-14 h-8 rounded-full p-1 ${t==="dark"?"bg-[var(--duo-green)]":"bg-[var(--secondary)]"}`,children:l.jsx("div",{className:"w-6 h-6 rounded-full bg-white shadow-md",style:{transform:t==="dark"?"translateX(24px)":"translateX(0)"}})})]}),l.jsxs("button",{onClick:()=>R(!0),className:"card-3d w-full p-4 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(pM,{className:"w-5 h-5 text-[var(--duo-red)]"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Xa cache"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Xa d liu tm & reload"})]})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]}),l.jsx("div",{className:"card-3d p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Rx,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Quiz QTDA"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phin bn 1.0.0"})]})]})})]})]})]})}function mot(){var N,T,E,R,D,j,L,lt,dt,Y,W,U,Q,F,q,$,H,X,tt,O,B,nt,K,at,ct,vt,Rt,ht,st,Tt,Nt,Jt,Et,Gt,yn,oe;const e=we(),{user:t}=te(),{chapters:n}=ds(),[i,r]=I.useState("overview");I.useEffect(()=>{ds.getState().loadQuiz()},[]);const s=((t==null?void 0:t.totalCorrect)??0)+((t==null?void 0:t.totalWrong)??0),o=s>0?Math.round(((t==null?void 0:t.totalCorrect)??0)/s*100):0,a=t==null?void 0:t.conquestStats,c=(a==null?void 0:a.rankPoints)??0,h=ps(c),u=((a==null?void 0:a.totalConquestCorrect)??0)+((a==null?void 0:a.totalConquestWrong)??0),d=u>0?Math.round(((a==null?void 0:a.totalConquestCorrect)??0)/u*100):0,f=["T2","T3","T4","T5","T6","T7","CN"],v=new Date,y=v.getDay()===0?6:v.getDay()-1,_=(t==null?void 0:t.streak)??0,w=f.map((ft,St)=>{const ae=y-St;return ae>=0&&ae<_?Math.floor(Math.random()*50)+20:0}),x=Math.max(...w,1),C=n.map(ft=>{var ae;const St=(ae=t==null?void 0:t.chapterProgress)==null?void 0:ae[ft.id];return{...ft,completed:(St==null?void 0:St.completed)??0,correct:(St==null?void 0:St.correct)??0,stars:(St==null?void 0:St.stars)??0,bestScore:(St==null?void 0:St.bestScore)??0,isCompleted:(St==null?void 0:St.isCompleted)??!1}}),k=C.filter(ft=>ft.isCompleted).length,[P,A]=I.useState(0);I.useEffect(()=>{try{const ft=localStorage.getItem("tower_progress");if(ft){const St=JSON.parse(ft);A(St.currentFloor||0)}}catch(ft){console.error("Error loading tower progress:",ft)}},[]);const M=kf(t,P);return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-blue)] to-[var(--duo-purple)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(hM,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Thng k"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Phn tch chi tit qu trnh hc"})]})]})}),l.jsx("div",{className:"fixed top-[108px] left-0 right-0 z-40 px-4 py-2 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsx("div",{className:"flex gap-1.5 overflow-x-auto no-scrollbar",children:[{id:"overview",label:"Tng quan",icon:vM},{id:"chapters",label:"Chng",icon:tl},{id:"history",label:"Lch s",icon:vu},{id:"gacha",label:"Gacha",icon:Xt}].map(ft=>l.jsxs("button",{onClick:()=>r(ft.id),className:`flex items-center justify-center gap-1 py-2 px-3 rounded-xl text-xs font-semibold whitespace-nowrap shrink-0 ${i===ft.id?"bg-[var(--duo-green)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(ft.icon,{className:"w-3.5 h-3.5"}),ft.label]},ft.id))})}),l.jsxs("div",{className:"px-4 pt-44 pb-28",children:[i==="overview"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(ai,{className:"w-6 h-6 text-[var(--duo-green)]"})}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:(t==null?void 0:t.totalCorrect)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu ng"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx($r,{className:"w-6 h-6 text-[var(--duo-red)]"})}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.totalWrong)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu sai"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Dc,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"im theo lnh vc"]}),l.jsx("div",{className:"bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] rounded-2xl p-4 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-white/80 text-sm",children:"Tng im"}),l.jsx("p",{className:"text-3xl font-bold text-white",children:Dn(M.totalScore)})]}),l.jsx("div",{className:"w-14 h-14 rounded-full bg-white/20 flex items-center justify-center",children:l.jsx(Ve,{className:"w-7 h-7 text-white"})})]})}),l.jsx("div",{className:"space-y-3",children:[{label:"Luyn tp",score:M.quizScore,icon:tl,color:"var(--duo-green)",bgColor:"var(--duo-green)"},{label:"Chinh Chin",score:M.conquestScore,icon:Ci,color:"var(--duo-purple)",bgColor:"var(--duo-purple)"},{label:"B su tp",score:M.gachaScore,icon:Xt,color:"var(--duo-yellow)",bgColor:"var(--duo-yellow)"},{label:"Thp Luyn Ngc",score:M.towerScore,icon:Yu,color:"var(--duo-orange)",bgColor:"var(--duo-orange)"},{label:"Thnh tu",score:M.achievementScore,icon:vr,color:"var(--duo-blue)",bgColor:"var(--duo-blue)"}].map(ft=>{const St=M.totalScore>0?ft.score/M.totalScore*100:0;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center shrink-0",style:{backgroundColor:`${ft.bgColor}20`},children:l.jsx(ft.icon,{className:"w-4.5 h-4.5",style:{color:ft.color}})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-foreground",children:ft.label}),l.jsx("span",{className:"text-sm font-bold",style:{color:ft.color},children:Dn(ft.score)})]}),l.jsx("div",{className:"h-1.5 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.min(St,100)}%`,backgroundColor:ft.color}})})]})]},ft.label)})})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(ji,{className:"w-5 h-5 text-[var(--duo-blue)]"})," chnh xc tng"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"relative w-24 h-24",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",children:[l.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"var(--secondary)",strokeWidth:"8"}),l.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:o>=70?"var(--duo-green)":o>=50?"var(--duo-yellow)":"var(--duo-red)",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${o/100*251} 251`})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[o,"%"]})})]}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tng cu"}),l.jsx("span",{className:"font-bold text-foreground",children:s})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"ng"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:(t==null?void 0:t.totalCorrect)??0})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Sai"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.totalWrong)??0})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5 mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:(t==null?void 0:t.exp)??0}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"XP"})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx(Ve,{className:"w-5 h-5 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsxs("p",{className:"text-sm font-bold text-foreground",children:["Lv.",(t==null?void 0:t.level)??1]}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"Cp "})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx(me,{className:"w-5 h-5 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:(t==null?void 0:t.perfectLessons)??0}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"100%"})]}),l.jsxs("div",{className:"card-3d p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5 mx-auto mb-1"}),l.jsx("p",{className:"text-sm font-bold text-foreground",children:Dn((t==null?void 0:t.gems)??0)}),l.jsx("p",{className:"text-[9px] text-[var(--muted-foreground)]",children:"Gems"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(vu,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Hot ng tun ny"]}),l.jsx("div",{className:"flex items-end justify-between h-24 gap-1",children:f.map((ft,St)=>l.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[l.jsx("div",{className:"w-full flex-1 flex items-end",children:l.jsx("div",{className:`w-full rounded-t-lg ${w[St]>0?"bg-[var(--duo-green)]":"bg-[var(--secondary)]"}`,style:{height:`${w[St]/x*100}%`,minHeight:"4px"}})}),l.jsx("span",{className:"text-[10px] text-[var(--muted-foreground)]",children:ft})]},ft))}),l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3 pt-3 border-t border-[var(--border)]",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-6 h-6"}),l.jsxs("span",{className:"font-bold text-[var(--duo-orange)]",children:[(t==null?void 0:t.streak)??0," ngy streak"]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Ci,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Chinh Chin"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:qa(h),alt:h.rankName,className:"w-16 h-16 mx-auto object-contain"}),l.jsx("p",{className:"text-sm font-bold text-foreground mt-1",children:h.rankName}),l.jsxs("p",{className:"text-xs text-[var(--duo-purple)] font-bold",children:[c," RP"]})]}),l.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-foreground",children:(a==null?void 0:a.totalConquests)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng trn"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsxs("p",{className:"text-lg font-bold text-foreground",children:[d,"%"]}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:" chnh xc"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-[var(--duo-green)]",children:(a==null?void 0:a.totalConquestCorrect)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Cu ng"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-2 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-[var(--duo-orange)]",children:(a==null?void 0:a.bestWinStreak)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Win streak"})]})]})]})]})]}),i==="chapters"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-bold text-foreground",children:"Tin  chng"}),l.jsxs("span",{className:"text-sm text-[var(--duo-green)] font-bold",children:[k,"/",n.length]})]}),l.jsx("div",{className:"progress-duo h-3",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${k/Math.max(n.length,1)*100}%`}})})]}),l.jsx("div",{className:"space-y-2",children:C.map((ft,St)=>{const ae=["#ff9600","#ffc800","#58cc02","#1cb0f6","#ce82ff","#ff4b4b"],xn=ae[St%ae.length],Jn=ft.completed>0?Math.round(ft.completed/ft.totalQuestions*100):0;return l.jsx("div",{className:"card-3d p-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold shrink-0",style:{background:xn},children:ft.id}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h4",{className:"font-bold text-sm text-foreground truncate",children:ft.name}),ft.isCompleted&&l.jsx(ai,{className:"w-4 h-4 text-[var(--duo-green)] shrink-0"})]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("div",{className:"flex-1 progress-duo h-1.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${Jn}%`}})}),l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:[Jn,"%"]})]})]}),l.jsxs("div",{className:"text-right shrink-0",children:[ft.stars>0&&l.jsx("div",{className:"flex items-center gap-0.5 mb-1",children:[...Array(3)].map((Ii,Xn)=>l.jsx(me,{className:`w-3 h-3 ${Xn<ft.stars?"text-[var(--duo-yellow)] fill-[var(--duo-yellow)]":"text-[var(--muted-foreground)]"}`},Xn))}),ft.bestScore>0&&l.jsxs("p",{className:"text-xs text-[var(--duo-green)] font-bold",children:[ft.bestScore," XP"]})]})]})},ft.id)})})]}),i==="history"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Ju,{className:"w-5 h-5 text-[var(--duo-blue)]"}),"Streak"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-8 h-8 mx-auto mb-1"}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-orange)]",children:(t==null?void 0:t.streak)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hin ti"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(zr,{className:"w-8 h-8 text-[var(--duo-red)] mx-auto mb-1"}),l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-red)]",children:(t==null?void 0:t.longestStreak)??0}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Di nht"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(ji,{className:"w-5 h-5 text-[var(--duo-green)]"}),"Mc tiu hm nay"]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tin "}),l.jsxs("span",{className:"font-bold text-foreground",children:[(t==null?void 0:t.dailyProgress)??0,"/",(t==null?void 0:t.dailyGoal)??50," XP"]})]}),l.jsx("div",{className:"progress-duo h-3",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${Math.min(((t==null?void 0:t.dailyProgress)??0)/((t==null?void 0:t.dailyGoal)??50)*100,100)}%`,background:((t==null?void 0:t.dailyProgress)??0)>=((t==null?void 0:t.dailyGoal)??50)?"var(--duo-yellow)":void 0}})})]}),((t==null?void 0:t.dailyProgress)??0)>=((t==null?void 0:t.dailyGoal)??50)&&l.jsx(ai,{className:"w-8 h-8 text-[var(--duo-green)]"})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Ve,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Ct mc"]}),l.jsx("div",{className:"space-y-3",children:[{label:"Cu ng u tin",value:1,current:(t==null?void 0:t.totalCorrect)??0,icon:ai},{label:"50 cu ng",value:50,current:(t==null?void 0:t.totalCorrect)??0,icon:ji},{label:"100 cu ng",value:100,current:(t==null?void 0:t.totalCorrect)??0,icon:me},{label:"Level 5",value:5,current:(t==null?void 0:t.level)??1,icon:Ve},{label:"7 ngy streak",value:7,current:(t==null?void 0:t.streak)??0,icon:zr},{label:"100 Rank Points",value:100,current:(a==null?void 0:a.rankPoints)??0,icon:Ci}].map((ft,St)=>{const ae=ft.current>=ft.value;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${ae?"bg-[var(--duo-green)]/20":"bg-[var(--secondary)]"}`,children:l.jsx(ft.icon,{className:`w-4 h-4 ${ae?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"}`})}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:`text-sm font-semibold ${ae?"text-foreground":"text-[var(--muted-foreground)]"}`,children:ft.label})}),ae?l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}):l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:[ft.current,"/",ft.value]})]},St)})})]})]}),i==="gacha"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Tng quan Gacha"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(Ts,{className:"w-6 h-6 text-[var(--duo-purple)] mx-auto mb-1"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((N=t==null?void 0:t.gachaInventory)==null?void 0:N.totalPulls)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng ln quay"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",alt:"shard",className:"w-6 h-6 mx-auto mb-1"}),l.jsx("p",{className:"text-xl font-bold text-[var(--duo-blue)]",children:Dn(((T=t==null?void 0:t.gachaInventory)==null?void 0:T.shards)??0)}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Mnh ghp"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(me,{className:"w-5 h-5 text-[var(--duo-orange)]"}),"Th theo  him"]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[l.jsxs("div",{className:"bg-gradient-to-b from-[#FFD700]/20 to-[#FFD700]/5 rounded-xl p-3 text-center border border-[#FFD700]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#FFD700] mb-1",children:"UR"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((R=(E=t==null?void 0:t.gachaInventory)==null?void 0:E.gachaStats)==null?void 0:R.totalURCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#9B59B6]/20 to-[#9B59B6]/5 rounded-xl p-3 text-center border border-[#9B59B6]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#9B59B6] mb-1",children:"SR"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((j=(D=t==null?void 0:t.gachaInventory)==null?void 0:D.gachaStats)==null?void 0:j.totalSRCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#3498DB]/20 to-[#3498DB]/5 rounded-xl p-3 text-center border border-[#3498DB]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#3498DB] mb-1",children:"R"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((lt=(L=t==null?void 0:t.gachaInventory)==null?void 0:L.gachaStats)==null?void 0:lt.totalRCards)??0})]}),l.jsxs("div",{className:"bg-gradient-to-b from-[#95A5A6]/20 to-[#95A5A6]/5 rounded-xl p-3 text-center border border-[#95A5A6]/30",children:[l.jsx("p",{className:"text-xs font-bold text-[#95A5A6] mb-1",children:"N"}),l.jsx("p",{className:"text-xl font-bold text-foreground",children:((Y=(dt=t==null?void 0:t.gachaInventory)==null?void 0:dt.gachaStats)==null?void 0:Y.totalNCards)??0})]})]}),l.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--border)]",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Tng th unique"}),l.jsx("span",{className:"font-bold text-foreground",children:(((U=(W=t==null?void 0:t.gachaInventory)==null?void 0:W.gachaStats)==null?void 0:U.totalURCards)??0)+(((F=(Q=t==null?void 0:t.gachaInventory)==null?void 0:Q.gachaStats)==null?void 0:F.totalSRCards)??0)+((($=(q=t==null?void 0:t.gachaInventory)==null?void 0:q.gachaStats)==null?void 0:$.totalRCards)??0)+(((X=(H=t==null?void 0:t.gachaInventory)==null?void 0:H.gachaStats)==null?void 0:X.totalNCards)??0)})]})})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(vr,{className:"w-5 h-5 text-[var(--duo-green)]"}),"Phn thng su tp"]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(xl,{className:"w-6 h-6 text-[var(--duo-blue)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((O=(tt=t==null?void 0:t.gachaInventory)==null?void 0:tt.gachaStats)==null?void 0:O.totalAvatars)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Avatar"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(bf,{className:"w-6 h-6 text-[var(--duo-purple)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((nt=(B=t==null?void 0:t.gachaInventory)==null?void 0:B.gachaStats)==null?void 0:nt.totalFrames)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Khung"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx(vr,{className:"w-6 h-6 text-[var(--duo-yellow)] mx-auto mb-1"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:((at=(K=t==null?void 0:t.gachaInventory)==null?void 0:K.gachaStats)==null?void 0:at.totalBadges)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Huy hiu"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"B su tp"]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-blue)] flex items-center justify-center",children:l.jsx("span",{className:"text-3xl font-bold text-white",children:((vt=(ct=t==null?void 0:t.gachaInventory)==null?void 0:ct.gachaStats)==null?void 0:vt.completedCollections)??0})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-lg font-bold text-foreground",children:"Gi hon thnh"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"S b su tp  thu thp  th"}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsx("span",{className:"text-xs text-[var(--muted-foreground)]",children:"ang tham gia:"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:Object.keys(((Rt=t==null?void 0:t.gachaInventory)==null?void 0:Rt.cards)??{}).length})]})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("h3",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[l.jsx(ji,{className:"w-5 h-5 text-[var(--duo-red)]"}),"T l may mn"]}),(((ht=t==null?void 0:t.gachaInventory)==null?void 0:ht.totalPulls)??0)>0?l.jsx("div",{className:"space-y-2",children:[{label:"UR",count:((Tt=(st=t==null?void 0:t.gachaInventory)==null?void 0:st.gachaStats)==null?void 0:Tt.totalURCards)??0,color:"#FFD700",rate:3},{label:"SR",count:((Jt=(Nt=t==null?void 0:t.gachaInventory)==null?void 0:Nt.gachaStats)==null?void 0:Jt.totalSRCards)??0,color:"#9B59B6",rate:18},{label:"R",count:((Gt=(Et=t==null?void 0:t.gachaInventory)==null?void 0:Et.gachaStats)==null?void 0:Gt.totalRCards)??0,color:"#3498DB",rate:39},{label:"N",count:((oe=(yn=t==null?void 0:t.gachaInventory)==null?void 0:yn.gachaStats)==null?void 0:oe.totalNCards)??0,color:"#95A5A6",rate:40}].map(ft=>{var xn,Jn,Ii,Xn,Zn,Ai,ti,Ri;const St=(((Jn=(xn=t==null?void 0:t.gachaInventory)==null?void 0:xn.gachaStats)==null?void 0:Jn.totalURCards)??0)+(((Xn=(Ii=t==null?void 0:t.gachaInventory)==null?void 0:Ii.gachaStats)==null?void 0:Xn.totalSRCards)??0)+(((Ai=(Zn=t==null?void 0:t.gachaInventory)==null?void 0:Zn.gachaStats)==null?void 0:Ai.totalRCards)??0)+(((Ri=(ti=t==null?void 0:t.gachaInventory)==null?void 0:ti.gachaStats)==null?void 0:Ri.totalNCards)??0),ae=St>0?(ft.count/St*100).toFixed(1):"0";return l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-xs font-bold w-6",style:{color:ft.color},children:ft.label}),l.jsx("div",{className:"flex-1 h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(ft.count/Math.max(St,1)*100,100)}%`,background:ft.color}})}),l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)] w-16 text-right",children:[ae,"% (",ft.rate,"%)"]})]},ft.label)})}):l.jsx("p",{className:"text-center text-[var(--muted-foreground)] py-4",children:"Cha c d liu quay gacha"})]})]})]})]})}function pot(){const e=we(),{user:t,addGems:n,claimMail:i,deleteMail:r}=te(),[s,o]=I.useState([]),[a,c]=I.useState(!0),[h,u]=I.useState(!1),[d,f]=I.useState(null),v=(t==null?void 0:t.claimedMails)||[];I.useEffect(()=>{(async()=>{if(t)try{const A=Wr(kt,"mails"),M=cl(A,Of("active","==",!0)),T=(await Ia(M)).docs.map(D=>({id:D.id,...D.data()})).filter(D=>{const j=D,L=j.targetUserId;return j.type==="leaderboard_reward"?L===t.oderId:!L||L===t.oderId});T.sort((D,j)=>new Date(j.createdAt).getTime()-new Date(D.createdAt).getTime());const E=t.deletedMails||[],R=T.filter(D=>!E.includes(D.id));o(R)}catch(A){console.error("Error loading mails:",A)}finally{c(!1)}})()},[t]);const y=async P=>{v.includes(P.id)||(await n(P.reward),await i(P.id),f({title:P.title,gems:P.reward}),u(!0),Se({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]}))},_=async P=>{v.includes(P.id)&&(await r(P.id),o(A=>A.filter(M=>M.id!==P.id)))},w=s.filter(P=>!v.includes(P.id)).length,[x,C]=I.useState(!1),k=async()=>{if(x)return;const P=s.filter(A=>!v.includes(A.id));if(P.length!==0){C(!0);try{const A=P.reduce((M,N)=>M+N.reward,0);for(const M of P)await i(M.id);await n(A),f({title:`${P.length} th`,gems:A}),u(!0),Se({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#1cb0f6","#ce82ff"]})}catch(A){console.error("Error claiming all mails:",A)}finally{C(!1)}}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:h&&!!d,onClose:()=>u(!1),title:"Nhn qu thnh cng!",subtitle:d==null?void 0:d.title,rewards:d?[{type:"gems",amount:d.gems}]:[],gradientFrom:"var(--duo-orange)",gradientTo:"var(--duo-yellow)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-3 px-3 bg-gradient-to-r from-[var(--duo-orange)] to-[var(--duo-yellow)]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-9 h-9 flex items-center justify-center shrink-0",children:l.jsx(Ji,{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Hm th"}),l.jsx("p",{className:"text-white/80 text-xs truncate",children:w>0?`${w} th cha nhn`:"Khng c th mi"})]}),w>0&&l.jsxs("button",{onClick:k,disabled:x,className:"btn-3d btn-3d-green px-3 py-1.5 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Be,{className:"w-3.5 h-3.5"}),"Nhn (",w,")"]})]})}),l.jsx("div",{className:"px-4 pt-30 pb-28",children:a?l.jsx("div",{className:"text-center py-10",children:l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"ang ti..."})}):s.length===0?l.jsxs("div",{className:"text-center py-10",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(PB,{className:"w-10 h-10 text-[var(--muted-foreground)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Hm th trng"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Qu t h thng s xut hin  y"})]}):l.jsx("div",{className:"space-y-3",children:s.map(P=>{const A=v.includes(P.id);return l.jsx("div",{className:`card-3d p-4 ${A?"":"border-[var(--duo-orange)] border-2"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 ${A?"bg-[var(--secondary)]":"bg-[var(--duo-orange)]/20"}`,children:l.jsx(fM,{className:`w-6 h-6 ${A?"text-[var(--muted-foreground)]":"text-[var(--duo-orange)]"}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-bold text-foreground",children:P.title}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1 line-clamp-2",children:P.content}),l.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsxs("span",{className:"text-sm font-bold text-[var(--duo-blue)]",children:[P.reward," Gems"]})]})]}),A?l.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[l.jsx(ai,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("button",{onClick:()=>_(P),className:"w-9 h-9 rounded-lg bg-red-500/10 flex items-center justify-center hover:bg-red-500/20 transition-colors",children:l.jsx(pM,{className:"w-4 h-4 text-red-500"})})]}):l.jsx("button",{onClick:()=>y(P),className:"btn-3d btn-3d-green px-4 py-2.5 text-sm shrink-0 min-w-[60px]",children:"Nhn"})]})},P.id)})})})]})}function vot(){const e=we(),{user:t,spendGems:n,refillHearts:i,buyUnlimitedHearts:r,hasUnlimitedHearts:s,getUnlimitedHeartsTimeLeft:o,buyXPBoost:a,hasXPBoost:c,getXPBoostTimeLeft:h,buyStreakFreeze:u,getStreakFreezeCount:d}=te(),[f,v]=I.useState(null),[y,_]=I.useState(null),[w,x]=I.useState(null),[C,k]=I.useState(!1),[P,A]=I.useState(!1),[M,N]=I.useState(!1),[T,E]=I.useState(!1),[R,D]=I.useState(!1),[j,L]=I.useState(0);I.useEffect(()=>{const U=()=>{const F=o();_(F);const q=h();if(x(q),!(t!=null&&t.lastHeartRefill)){v(null);return}if((t.hearts??5)>=(t.maxHearts??5)){v(null);return}const $=new Date(t.lastHeartRefill).getTime(),H=Date.now(),X=$+30*60*1e3,tt=Math.max(0,X-H);if(tt<=0){v("Sp c!");return}const O=Math.floor(tt/6e4),B=Math.floor(tt%6e4/1e3);v(`${O}:${B.toString().padStart(2,"0")}`)};U();const Q=setInterval(U,1e3);return()=>clearInterval(Q)},[t==null?void 0:t.lastHeartRefill,t==null?void 0:t.hearts,t==null?void 0:t.maxHearts,o,h]);const lt=async()=>{if(!t)return;if(t.gems<500){alert("Khng  gems!");return}await n(500)&&(await i(),N(!0),Se({particleCount:60,spread:50,origin:{y:.6},colors:["#ff4b4b","#ff6b6b","#ffc800"]}))},dt=async()=>{if(((t==null?void 0:t.gems)??0)<3e3){alert("Khng  gems! Cn 3000 gems.");return}k(!0);const U=await r();k(!1),U?(A(!0),Se({particleCount:100,spread:70,origin:{y:.6},colors:["#ffc800","#ff9600","#ce82ff"]})):alert("C li xy ra!")},Y=async U=>{const F={1:500,3:1200,8:2500}[U];if(((t==null?void 0:t.gems)??0)<F){alert(`Khng  gems! Cn ${F} gems.`);return}k(!0);const q=await a(U);k(!1),q?(L(U),E(!0),Se({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#89e219","#ffc800"]})):alert("C li xy ra!")},W=async()=>{if(((t==null?void 0:t.gems)??0)<1e3){alert("Khng  gems! Cn 1000 gems.");return}if(d()>=5){alert("Bn  c ti a 5 Streak Freeze!");return}k(!0);const U=await u();k(!1),U?(D(!0),Se({particleCount:60,spread:50,origin:{y:.6},colors:["#1cb0f6","#84d8ff","#ffffff"]})):alert("C li xy ra!")};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/settings"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Be,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Ca hng"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Mua vt phm h tr hc tp"})]})]})}),l.jsxs("div",{className:"px-4 pt-32 pb-28 space-y-4",children:[t&&l.jsx("div",{className:"card-3d p-4",children:l.jsxs("div",{className:"flex items-center justify-around",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-lg text-[var(--duo-blue)]",children:Dn(t.gems??0)}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Gems"})]})]}),l.jsx("div",{className:"w-px h-10 bg-[var(--border)]"}),s()?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-lg text-[var(--duo-red)]",children:""}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tim v hn"})]})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsxs("p",{className:"font-bold text-lg text-[var(--duo-red)]",children:[t.hearts??5,"/",t.maxHearts??5]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tim"})]})]})]})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-4 h-4"}),"Tim"]}),t&&(t.hearts??5)<(t.maxHearts??5)&&l.jsxs("div",{className:"card-3d p-3 mb-3 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ju,{className:"w-5 h-5 text-[var(--duo-blue)]"}),l.jsx("span",{className:"text-sm text-foreground",children:"Tim tip theo"})]}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:f})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t&&(t.hearts??5)<(t.maxHearts??5)&&(t.gems??0)>=500&&l.jsxs("button",{onClick:lt,className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"500"})]})]}),t&&(t.hearts??5)<(t.maxHearts??5)&&(t.gems??0)<500&&l.jsxs("div",{className:"card-3d p-4 text-center opacity-50",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-red)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Hi y tim"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-red)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4 grayscale"}),l.jsx("span",{className:"font-bold",children:"Thiu gems"})]})]}),t&&(t.hearts??5)>=(t.maxHearts??5)&&l.jsxs("div",{className:"card-3d p-4 text-center opacity-50",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx("img",{src:"/AppAssets/Heart.png",alt:"heart",className:"w-8 h-8"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Tim  y"}),l.jsx("p",{className:"text-xs text-[var(--duo-green)]",children:"5/5"})]}),s()?l.jsxs("div",{className:"card-3d p-4 text-center border-2 border-[var(--duo-yellow)]",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-2",children:l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)] animate-pulse"})}),l.jsx("p",{className:"font-bold text-[var(--duo-yellow)] mb-1",children:"Tim v hn"}),l.jsxs("p",{className:"text-xs text-[var(--duo-green)] font-bold",children:["Cn ",y]})]}):l.jsxs("button",{onClick:dt,disabled:C||((t==null?void 0:t.gems)??0)<3e3,className:`card-3d p-4 text-center ${((t==null?void 0:t.gems)??0)<3e3?"opacity-50":""}`,children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-yellow)]/20 flex items-center justify-center mb-2",children:l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Tim v hn 24h"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"3000"})]})]})]})]}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx(Vr,{className:"w-4 h-4 text-[var(--duo-green)]"}),"XP Boost (x2)"]}),c()&&l.jsxs("div",{className:"card-3d p-3 mb-3 flex items-center justify-between border-2 border-[var(--duo-green)]",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Vr,{className:"w-5 h-5 text-[var(--duo-green)] animate-pulse"}),l.jsx("span",{className:"text-sm font-bold text-[var(--duo-green)]",children:"XP x2 ang hot ng!"})]}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:w})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("button",{onClick:()=>Y(1),disabled:C||((t==null?void 0:t.gems)??0)<500,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<500?"opacity-50":""}`,children:[l.jsx("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(Vr,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"1 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"500"})]})]}),l.jsxs("button",{onClick:()=>Y(3),disabled:C||((t==null?void 0:t.gems)??0)<1200,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<1200?"opacity-50":""}`,children:[l.jsx("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2",children:l.jsx(Vr,{className:"w-5 h-5 text-[var(--duo-green)]"})}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"3 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"1200"})]})]}),l.jsxs("button",{onClick:()=>Y(8),disabled:C||((t==null?void 0:t.gems)??0)<2500,className:`card-3d p-3 text-center ${((t==null?void 0:t.gems)??0)<2500?"opacity-50":""}`,children:[l.jsxs("div",{className:"w-10 h-10 mx-auto rounded-xl bg-[var(--duo-green)]/20 flex items-center justify-center mb-2 relative",children:[l.jsx(Vr,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("span",{className:"absolute -top-1 -right-1 bg-[var(--duo-orange)] text-white text-[8px] px-1 rounded-full font-bold",children:"HOT"})]}),l.jsx("p",{className:"font-bold text-foreground text-sm mb-1",children:"8 gi"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{className:"font-bold text-xs",children:"2500"})]})]})]})]}),l.jsxs("div",{children:[l.jsxs("h2",{className:"font-bold text-sm text-[var(--muted-foreground)] mb-3 flex items-center gap-2",children:[l.jsx(Vv,{className:"w-4 h-4 text-[var(--duo-blue)]"}),"Streak Freeze"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-blue)]/20 flex items-center justify-center mb-2",children:l.jsx(Vv,{className:"w-6 h-6 text-[var(--duo-blue)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"ang c"}),l.jsxs("p",{className:"text-lg font-bold text-[var(--duo-blue)]",children:[d(),"/5"]})]}),l.jsxs("button",{onClick:W,disabled:C||((t==null?void 0:t.gems)??0)<1e3||d()>=5,className:`card-3d p-4 text-center ${((t==null?void 0:t.gems)??0)<1e3||d()>=5?"opacity-50":""}`,children:[l.jsx("div",{className:"w-12 h-12 mx-auto rounded-2xl bg-[var(--duo-blue)]/20 flex items-center justify-center mb-2",children:l.jsx(Vv,{className:"w-6 h-6 text-[var(--duo-blue)]"})}),l.jsx("p",{className:"font-bold text-foreground mb-1",children:"Mua thm"}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"}),l.jsx("span",{className:"font-bold",children:"1000"})]})]})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-2 text-center",children:"Streak Freeze t ng bo v streak khi bn qun hc 1 ngy"})]})]}),l.jsx(Gn,{isOpen:P,onClose:()=>A(!1),title:"Tim v hn  kch hot!",subtitle:"Bn c th hc khng gii hn trong 24 gi",rewards:[{type:"custom",amount:24,icon:"/AppAssets/Heart.png",label:"gi tim v hn "}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-yellow)",gradientTo:"var(--duo-orange)"}),l.jsx(Gn,{isOpen:M,onClose:()=>N(!1),title:"Hi tim thnh cng!",subtitle:"Tim ca bn  c hi y",rewards:[{type:"hearts",amount:5,label:"Tim"}],buttonText:"Tip tc hc!",gradientFrom:"var(--duo-red)",gradientTo:"var(--duo-pink)"}),l.jsx(Gn,{isOpen:T,onClose:()=>E(!1),title:"XP Boost  kch hot!",subtitle:`Nhn x2 XP trong ${j} gi ti`,rewards:[{type:"custom",amount:2,icon:"/AppAssets/Lighting.png",label:`x XP trong ${j}h`}],buttonText:"Hc ngay!",gradientFrom:"var(--duo-green)",gradientTo:"#89e219"}),l.jsx(Gn,{isOpen:R,onClose:()=>D(!1),title:"Mua Streak Freeze thnh cng!",subtitle:"Streak ca bn s c bo v khi qun hc",rewards:[{type:"custom",amount:d(),icon:"/AppAssets/Fire.png",label:"Streak Freeze"}],buttonText:"Tuyt vi!",gradientFrom:"var(--duo-blue)",gradientTo:"#84d8ff"})]})}const yot=[5,10,15,20,25,30,40,50],xot=[{id:"login-7days",title:"ng nhp 7 ngy",description:"Nhn thng mi ngy ng nhp",icon:lM,color:"var(--duo-green)",bgColor:"var(--duo-green)",route:"/event-login-7days",badge:"Hng ngy"},{id:"level-rewards",title:"Thng cp ",description:"Nhn qu khi t cp  mi",icon:Ve,color:"var(--duo-purple)",bgColor:"var(--duo-purple)",route:"/event-level-rewards",badge:"Vnh vin"},{id:"tower",title:"Thp Luyn Ngc",description:"Leo thp, sai 1 cu l ri xung y!",icon:zr,color:"#8B5CF6",bgColor:"#8B5CF6",route:"/event-tower",badge:"Th thch"}];function _ot(){const e=we(),{user:t}=te(),[n,i]=I.useState({});return I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const s=Dt(kt,"users",t.oderId),o=await Qr(s);if(!o.exists())return;const a=o.data(),c={},h=a.loginEvent||{claimedDays:[],lastClaimDate:""},u=new Date().toDateString();h.lastClaimDate!==u&&h.claimedDays.length<7&&(c["login-7days"]=1);const f=a.claimedLevelRewards||[],v=t.level||1,y=yot.filter(_=>v>=_&&!f.includes(_)).length;y>0&&(c["level-rewards"]=y),i(c)}catch(s){console.error("Error checking rewards:",s)}})()},[t==null?void 0:t.oderId,t==null?void 0:t.level]),l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-orange)] to-[var(--duo-yellow)]",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(vu,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"S kin"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Cc s kin c bit"})]}),l.jsxs("div",{className:"px-4 pt-32 pb-28",children:[l.jsx("div",{className:"space-y-3",children:xot.map(r=>{const s=r.icon,o=n[r.id]||0;return l.jsxs("button",{onClick:()=>e(r.route),className:`w-full card-3d p-4 flex items-center gap-4 ${o>0?"border-2 border-[var(--duo-green)]":""}`,children:[l.jsxs("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center relative",style:{backgroundColor:`${r.bgColor}20`},children:[l.jsx(s,{className:"w-7 h-7",style:{color:r.color}}),o>0&&l.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full bg-[var(--duo-red)] flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:o})})]}),l.jsxs("div",{className:"flex-1 text-left min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("p",{className:"font-bold text-foreground whitespace-nowrap",children:r.title}),l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full text-white whitespace-nowrap",style:{backgroundColor:r.color},children:r.badge}),o>0&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-green)] text-white whitespace-nowrap flex items-center gap-1",children:[l.jsx(Be,{className:"w-3 h-3"}),"C qu!"]})]}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mt-1",children:r.description})]}),l.jsx(sr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})]},r.id)})}),l.jsx("div",{className:"mt-6 p-4 rounded-2xl bg-[var(--secondary)] border-2 border-dashed border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Be,{className:"w-6 h-6 text-[var(--muted-foreground)]"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-foreground",children:"Sp c thm s kin!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Hy quay li sau nh"})]})]})})]})]})}const nI=[{day:1,gems:50,label:"Ngy 1"},{day:2,gems:75,label:"Ngy 2"},{day:3,gems:100,label:"Ngy 3"},{day:4,gems:125,label:"Ngy 4"},{day:5,gems:150,label:"Ngy 5"},{day:6,gems:200,label:"Ngy 6"},{day:7,gems:500,label:"Ngy 7",special:!0}];function wot(){const e=we(),{user:t,addGems:n}=te(),[i,r]=I.useState({currentDay:1,claimedDays:[],lastClaimDate:""}),[s,o]=I.useState(!1),[a,c]=I.useState(!1),[h,u]=I.useState(0);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const _=Dt(kt,"users",t.oderId),w=await Qr(_);if(w.exists()){const C=w.data().loginEvent||{currentDay:1,claimedDays:[],lastClaimDate:""},k=new Date().toDateString(),P=C.lastClaimDate;if(P){const A=new Date(P),M=new Date(k);if(Math.floor((M.getTime()-A.getTime())/(1e3*60*60*24))>1||C.claimedDays.length>=7){r({currentDay:1,claimedDays:[],lastClaimDate:""});return}if(A.toDateString()===k){r(C);return}r({...C,currentDay:C.claimedDays.length+1})}else r(C)}}catch(_){console.error("Error loading login data:",_)}})()},[t==null?void 0:t.oderId]);const d=()=>{const y=new Date().toDateString();return i.lastClaimDate!==y&&i.currentDay<=7},f=async y=>{if(!(t!=null&&t.oderId)||s||y!==i.currentDay||!d())return;o(!0);const _=nI.find(w=>w.day===y);if(_)try{const w=new Date().toDateString(),x=[...i.claimedDays,y],C={currentDay:y+1,claimedDays:x,lastClaimDate:w},k=Dt(kt,"users",t.oderId);await Kt(k,{loginEvent:C}),await n(_.gems),r(C),u(_.gems),c(!0),Se({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#1cb0f6"]})}catch(w){console.error("Error claiming reward:",w)}finally{o(!1)}},v=y=>i.claimedDays.includes(y)?"claimed":y===i.currentDay&&d()?"available":y<i.currentDay?"missed":"locked";return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a,onClose:()=>c(!1),title:"im danh thnh cng!",subtitle:"Phn thng ng nhp hng ngy",rewards:[{type:"gems",amount:h}],gradientFrom:"var(--duo-green)",gradientTo:"var(--duo-teal)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-teal)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-white",children:"ng nhp 7 ngy"}),l.jsx("p",{className:"text-white/80 text-sm",children:"Nhn thng mi ngy!"})]})]})}),l.jsxs("div",{className:"px-4 pt-32 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(lM,{className:"w-5 h-5 text-[var(--duo-green)]"}),l.jsx("span",{className:"font-semibold text-foreground",children:"Tin "})]}),l.jsxs("span",{className:"text-sm text-[var(--muted-foreground)]",children:[i.claimedDays.length,"/7 ngy"]})]}),l.jsx("div",{className:"h-3 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-green)] to-[var(--duo-teal)] transition-all duration-500",style:{width:`${i.claimedDays.length/7*100}%`}})})]}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:nI.map(y=>{const _=v(y.day),w=y.special;return l.jsxs("button",{onClick:()=>f(y.day),disabled:_!=="available"||s,className:`card-3d relative p-4 ${w?"col-span-2":""} ${_==="available"||_==="claimed"?"border-2 border-[var(--duo-green)]":""}`,children:[_==="claimed"&&l.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-4 h-4 text-white"})}),_==="locked"&&l.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Xu,{className:"w-3 h-3 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:`flex ${w?"items-center gap-4":"flex-col items-center"}`,children:[l.jsx("div",{className:`${w?"w-16 h-16 flex-shrink-0":"w-12 h-12 mb-2"} rounded-xl flex items-center justify-center ${w?"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]":"bg-[var(--duo-blue)]/20"}`,children:w?l.jsx(Be,{className:"w-8 h-8 text-white"}):l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-6 h-6"})}),l.jsxs("div",{className:w?"flex-1 text-left":"text-center",children:[l.jsx("p",{className:`font-bold ${w?"text-lg":"text-sm"} ${_==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:y.label}),l.jsxs("div",{className:`flex items-center gap-1 ${w?"":"justify-center"}`,children:[l.jsxs("span",{className:`font-bold ${w?"text-2xl":"text-lg"} ${w?"text-[var(--duo-orange)]":"text-[var(--duo-blue)]"}`,children:["+",y.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:w?"w-6 h-6":"w-4 h-4"})]}),w&&l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Phn thng c bit!"})]})]}),_==="available"&&l.jsx("div",{className:`btn-3d btn-3d-green py-2 text-sm ${w?"mt-3":"mt-2"}`,children:"Nhn ngay!"})]},y.day)})}),l.jsx("div",{className:"mt-4 card-3d p-4",children:l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"ng nhp mi ngy  nhn thng. Nu b l 1 ngy, tin  s b reset!"})})]})]})}const gg=[{level:5,gems:500,label:"Cp 5"},{level:10,gems:1e3,label:"Cp 10",special:!0},{level:15,gems:1200,label:"Cp 15"},{level:20,gems:1500,label:"Cp 20",special:!0},{level:25,gems:1800,label:"Cp 25"},{level:30,gems:2500,label:"Cp 30",special:!0},{level:35,gems:2e3,label:"Cp 35"},{level:40,gems:3e3,label:"Cp 40",special:!0},{level:45,gems:2500,label:"Cp 45"},{level:50,gems:5e3,label:"Cp 50",special:!0,legendary:!0},{level:55,gems:3e3,label:"Cp 55"},{level:60,gems:4e3,label:"Cp 60",special:!0},{level:65,gems:3500,label:"Cp 65"},{level:70,gems:5e3,label:"Cp 70",special:!0},{level:75,gems:4500,label:"Cp 75"},{level:80,gems:6e3,label:"Cp 80",special:!0},{level:85,gems:5500,label:"Cp 85"},{level:90,gems:8e3,label:"Cp 90",special:!0},{level:95,gems:7e3,label:"Cp 95"},{level:100,gems:15e3,label:"Cp 100",special:!0,legendary:!0}];function bot(){const e=we(),{user:t,addGems:n}=te(),[i,r]=I.useState([]),[s,o]=I.useState(!1),[a,c]=I.useState(!1),[h,u]=I.useState(0);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId)try{const w=Dt(kt,"users",t.oderId),x=await Qr(w);if(x.exists()){const C=x.data();r(C.claimedLevelRewards||[])}}catch(w){console.error("Error loading claimed levels:",w)}})()},[t==null?void 0:t.oderId]);const d=_=>i.includes(_)?"claimed":((t==null?void 0:t.level)||1)>=_?"available":"locked",f=async _=>{if(!(t!=null&&t.oderId)||s||d(_)!=="available")return;o(!0);const w=gg.find(x=>x.level===_);if(w)try{const x=[...i,_],C=Dt(kt,"users",t.oderId);await Kt(C,{claimedLevelRewards:x}),await n(w.gems),r(x),u(w.gems),c(!0),Se({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#ffc800","#ce82ff"]})}catch(x){console.error("Error claiming reward:",x)}finally{o(!1)}},v=i.length,y=gg.filter(_=>((t==null?void 0:t.level)||1)>=_.level&&!i.includes(_.level)).length;return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:a,onClose:()=>c(!1),title:"Nhn thng thnh cng!",subtitle:"Phn thng cp ",rewards:[{type:"gems",amount:h}],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-pink)"}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h1",{className:"font-bold text-xl text-white",children:"Thng cp "}),l.jsx("p",{className:"text-white/80 text-sm",children:"Nhn qu khi ln cp!"})]}),y>0&&l.jsx("div",{className:"bg-[var(--duo-red)] px-3 py-1.5 rounded-full",children:l.jsx("span",{className:"text-white text-sm font-bold",children:y})})]})}),l.jsxs("div",{className:"px-4 pt-32 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-pink)] flex items-center justify-center",children:l.jsx(me,{className:"w-7 h-7 text-white"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Cp  hin ti"}),l.jsx("p",{className:"font-bold text-2xl text-foreground",children:(t==null?void 0:t.level)||1})]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:(t==null?void 0:t.gems)||0})]})]}),(()=>{const _=_X((t==null?void 0:t.exp)||0),w=_.current/_.required*100;return l.jsxs("div",{className:"mt-4",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"EXP"}),l.jsxs("span",{className:"text-foreground font-medium",children:[_.current,"/",_.required]})]}),l.jsx("div",{className:"h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",style:{width:`${w}%`}})})]})})()]}),l.jsxs("div",{className:"flex gap-3 mb-4",children:[l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:v}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"})]}),l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-orange)]",children:y}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"C th nhn"})]}),l.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-[var(--secondary)] text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--muted-foreground)]",children:gg.length-v-y}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cha m"})]})]}),l.jsx("div",{className:"space-y-3",children:gg.map(_=>{const w=d(_.level),x=_.special,C=_.legendary;return l.jsxs("button",{onClick:()=>f(_.level),disabled:w!=="available"||s,className:`card-3d w-full p-4 flex items-center gap-4 ${C?"border-2 border-[var(--duo-yellow)]":w==="available"||w==="claimed"?"border-2 border-[var(--duo-green)]":"opacity-60"}`,children:[l.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center ${C?"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]":x?"bg-gradient-to-br from-[var(--duo-purple)] to-[var(--duo-pink)]":"bg-[var(--duo-blue)]/20"}`,children:C?l.jsx(Ve,{className:"w-7 h-7 text-white"}):x?l.jsx(Be,{className:"w-6 h-6 text-white"}):l.jsx("span",{className:"font-bold text-lg text-[var(--duo-blue)]",children:_.level})}),l.jsxs("div",{className:"flex-1 text-left",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:`font-bold ${w==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:_.label}),C&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-yellow)] text-black font-bold",children:"LEGENDARY"}),x&&!C&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-purple)] text-white",children:"c bit"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("span",{className:`font-bold text-lg ${C?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"}`,children:["+",_.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]})]}),w==="claimed"?l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-5 h-5 text-white"})}):w==="available"?l.jsx("div",{className:"btn-3d btn-3d-green px-4 py-2 text-sm",children:"Nhn"}):l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Xu,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]},_.level)})}),l.jsx("div",{className:"mt-4 card-3d p-4",children:l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Hon thnh quiz  nhn EXP v ln cp. EXP cn tng dn theo level!"})})]})]})}function Tot(e){if(e<=0)return"ang reset...";const t=Math.floor(e/1e3),n=Math.floor(t/60),i=Math.floor(n/60),s=Math.floor(i/24),o=i%24,a=n%60,c=t%60;return s>0?`${s}n ${o}g ${a}p`:`${o}g ${a}p ${c}s`}function Cot(){const e=we(),t=Jb(),{currentFloor:n,highestFloor:i,claimedFloors:r,totalFloors:s,activeFloor:o,currentQuestion:a,selectedAnswer:c,isAnswered:h,isCorrect:u,initTower:d,startFloor:f,selectAnswer:v,completeFloor:y,failFloor:_,claimReward:w,exitQuiz:x,resetTower:C,getNextResetTime:k}=t,{addGems:P,incrementDailyTowerFloors:A}=te(),[M,N]=I.useState(!1),[T,E]=I.useState(!1),[R,D]=I.useState(0),[j,L]=I.useState(null),lt=I.useRef(null),[dt,Y]=I.useState("");I.useEffect(()=>{d()},[]),I.useEffect(()=>{const $=()=>{const tt=k()-Date.now();Y(Tot(tt)),tt<=0&&d()};$();const H=setInterval($,1e3);return()=>clearInterval(H)},[k,d]),I.useEffect(()=>{s>0&&!o&&lt.current&&setTimeout(()=>{var $;($=lt.current)==null||$.scrollIntoView({behavior:"smooth",block:"center"})},300)},[s,o]),I.useEffect(()=>{L(null)},[o]);const W=()=>{!j||h||v(j)};I.useEffect(()=>{h&&o&&u&&Se({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]})},[h,u,o]);const U=async()=>{if(u){const $=r.includes(o);y();const H=w(o);H>0&&await P(H),$||await A(),!$&&H>0?(D(H),N(!0)):x()}else E(!0)},Q=()=>{N(!1),D(0),x()},F=()=>{_(),E(!1)};if(o&&a)return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 pt-12 pb-4 px-4 bg-background",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:()=>x(),className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(zr,{className:"w-5 h-5 text-[#8B5CF6]"}),l.jsxs("span",{className:"font-bold text-foreground",children:["Tng ",o,"/",s]})]}),r.includes(o)?l.jsx("div",{className:"w-10"}):l.jsxs("div",{className:"flex items-center gap-1 text-[var(--duo-blue)]",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold",children:["+",Wh(o)]})]})]})}),l.jsxs("div",{className:"px-4 pt-24 pb-32",children:[l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:a.question}),l.jsx("div",{className:"space-y-2.5",children:a.options.map($=>{const H=j===$.id,X=c===$.id,tt=$.id===a.correctAnswer,O=h&&tt&&u,B=h&&X&&!tt;return l.jsxs("button",{onClick:()=>!h&&L($.id),disabled:h,className:qt("option-btn w-full p-3 text-left flex items-center gap-3",H&&!h&&"selected",O&&"correct",B&&"wrong"),children:[l.jsx("div",{className:qt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",O&&"bg-[var(--duo-green)] text-white",B&&"bg-[var(--duo-red)] text-white",!h&&!H&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",H&&!h&&"bg-[var(--duo-blue)] text-white"),children:O?l.jsx(Cr,{className:"w-4 h-4"}):B?l.jsx($r,{className:"w-4 h-4"}):$.id}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:$.text})]},$.id)})})]}),l.jsx("div",{className:qt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",h?u?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:h?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u?l.jsx(Cr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:qt("font-bold text-xl",u?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:u?"Chnh xc!":"Sai mt ri!"})})]}),l.jsx("button",{onClick:U,className:qt("btn-3d w-full py-3.5 text-base flex items-center justify-center gap-2",u?"btn-3d-green":"btn-3d-orange"),children:u?r.includes(o)?"TIP TC":l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),"NHN +",Wh(o)]}):"RT THP"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:W,disabled:!j,className:qt("btn-3d w-full py-3.5 text-base",j?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})}),l.jsx(Gn,{isOpen:M,onClose:Q,title:`Vt qua tng ${o}!`,subtitle:"Tip tc leo thp no!",rewards:[{type:"gems",amount:R}],gradientFrom:"#8B5CF6",gradientTo:"#A855F7"}),T&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsx("div",{className:"w-20 h-20 rounded-full bg-[var(--duo-red)]/20 flex items-center justify-center",children:l.jsx(ow,{className:"w-10 h-10 text-[var(--duo-red)]"})})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Rt xung y thp!"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Bn phi leo li t tng 1. Qu  nhn vn gi nguyn!"}),l.jsxs("button",{onClick:F,className:"w-full btn-3d btn-3d-purple py-3 font-bold",children:[l.jsx(yu,{className:"w-4 h-4 mr-2 inline"}),"Leo li t u"]})]})})]});const q=r.length;return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-3 px-4 bg-gradient-to-r from-[#8B5CF6] to-[#A855F7]",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center shrink-0",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"font-bold text-lg text-white truncate",children:"Thp Luyn Ngc"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("p",{className:"text-white/80 text-xs whitespace-nowrap",children:[s," tng"]}),l.jsxs("div",{className:"flex items-center gap-1 bg-white/20 rounded-lg px-2 py-0.5 shrink-0",children:[l.jsx(Ju,{className:"w-3 h-3 text-white shrink-0"}),l.jsx("span",{className:"text-white text-[10px] font-medium whitespace-nowrap",children:dt})]})]})]})]})}),l.jsxs("div",{className:"px-4 pt-32 pb-28",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-[#8B5CF6] to-[#A855F7] flex items-center justify-center",children:l.jsx(zr,{className:"w-7 h-7 text-white"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Tng hin ti"}),l.jsxs("p",{className:"font-bold text-2xl text-foreground",children:[n,"/",s]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Cao nht"}),l.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[l.jsx(me,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-lg text-foreground",children:i})]})]})]}),l.jsx("div",{className:"mt-3 h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[#8B5CF6] to-[#A855F7] transition-all",style:{width:`${i/s*100}%`}})})]}),l.jsxs("div",{className:"flex gap-3 mb-4",children:[l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--duo-green)]",children:q}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"})]}),l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[#8B5CF6]",children:i}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" vt"})]}),l.jsxs("div",{className:"flex-1 card-3d p-3 text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-[var(--muted-foreground)]",children:s-i}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cn li"})]})]}),l.jsx("div",{className:"space-y-2",children:Array.from({length:s},($,H)=>s-H).map($=>{const H=$<=n,X=$<=i,tt=r.includes($),O=$===n,B=Wh($),nt=$%100===0||$%50===0||$%10===0,K=$===s;return l.jsxs("div",{ref:O?lt:null,className:qt("card-3d p-3 flex items-center gap-3",K&&"border-2 border-[var(--duo-yellow)]",O&&!K&&"border-2 border-[#8B5CF6]",X&&!O&&!K&&"border-2 border-[var(--duo-green)]",!H&&"opacity-50"),children:[l.jsx("div",{className:qt("w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",K&&"bg-gradient-to-br from-[var(--duo-yellow)] to-[var(--duo-orange)]",nt&&!K&&"bg-gradient-to-br from-[#8B5CF6] to-[#A855F7]",X&&!nt&&!K&&"bg-[var(--duo-green)]",!X&&!nt&&!K&&"bg-[var(--secondary)]"),children:X?l.jsx(Rn,{className:"w-6 h-6 text-white"}):l.jsx("span",{className:qt("font-bold",nt||K?"text-white":"text-foreground"),children:$})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("p",{className:qt("font-bold",O?"text-[#8B5CF6]":"text-foreground"),children:["Tng ",$]}),K&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[var(--duo-yellow)] text-black font-bold",children:"NH"}),nt&&!K&&$%50===0&&l.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-[#8B5CF6] text-white",children:"Mc"})]}),l.jsx("div",{className:"flex items-center gap-1",children:tt?l.jsx("span",{className:"text-xs text-[var(--duo-green)]",children:" nhn thng"}):l.jsxs(l.Fragment,{children:[l.jsxs("span",{className:qt("font-bold",K?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"),children:["+",B]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]})})]}),H&&O?l.jsxs("button",{onClick:()=>f($),className:"btn-3d btn-3d-purple px-4 py-2 text-sm flex items-center gap-1",children:[l.jsx(HB,{className:"w-4 h-4"}),"Vo"]}):tt?l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-5 h-5 text-white"})}):H?null:l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Xu,{className:"w-4 h-4 text-[var(--muted-foreground)]"})})]},$)})}),l.jsx("div",{className:"mt-6 card-3d p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Be,{className:"w-5 h-5 text-[var(--duo-yellow)] flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-[var(--muted-foreground)]",children:[l.jsx("p",{className:"font-semibold text-foreground mb-1",children:"Lut chi:"}),l.jsxs("ul",{className:"space-y-1",children:[l.jsx("li",{children:" Mi tng 1 cu hi, tr li ng  ln tng tip"}),l.jsx("li",{children:" Phn thng: Tng N = N x 10 gems"}),l.jsx("li",{children:" Sai 1 cu = Rt xung tng 1, leo li t u"}),l.jsx("li",{children:" Qu  nhn vn gi nguyn khi rt"}),l.jsx("li",{className:"text-[#8B5CF6] font-medium",children:" Reset v tng 1 mi th 2 hng tun"})]})]})]})}),i>0&&l.jsxs("button",{onClick:()=>{confirm("Bn c chc mun reset thp? Tin trnh s mt nhng qu  nhn vn gi!")&&C()},className:"w-full mt-4 py-3 text-[var(--muted-foreground)] text-sm",children:[l.jsx(yu,{className:"w-4 h-4 mr-1 inline"}),"Reset thp (gi qu  nhn)"]})]})]})}const cn={COST_PER_PULL:150,PULLS_SINGLE:1,PULLS_MULTI:10,PITY_UR:200,DUPLICATE_SHARDS:{40:50,30:10,20:1,10:1},RATES:{40:3,30:18,20:39,10:40},UR_EXCHANGE_COST:145},Bp={totalNCards:0,totalRCards:0,totalSRCards:0,totalURCards:0,totalAvatars:0,totalFrames:0,totalBadges:0,completedCollections:0},my={cards:{},rewards:[],shards:0,totalPulls:0,pityCounters:{},gachaStats:Bp};async function Wa(e){try{const t=Dt(kt,"users",e),n=await Qr(t);return n.exists()&&n.data().gachaInventory||my}catch(t){return console.error("Error getting gacha inventory:",t),my}}async function kot(e,t){try{const n=Dt(kt,"users",e);return await Kt(n,{gachaInventory:t}),!0}catch(n){return console.error("Error updating gacha inventory:",n),!1}}function Not(e,t){if(t>=cn.PITY_UR-1){const a=e.filter(c=>c.card_scarcity===40);if(a.length>0)return{card:a[Math.floor(Math.random()*a.length)],resetPity:!0}}const n=Math.random()*100;let i=0,r=10;for(const[a,c]of Object.entries(cn.RATES))if(i+=c,n<i){r=parseInt(a);break}let s=e.filter(a=>a.card_scarcity===r);s.length===0&&(s=e);const o=s[Math.floor(Math.random()*s.length)];return{card:o,resetPity:o.card_scarcity===40}}async function Eot(e,t,n,i,r){const s=cn.COST_PER_PULL*i;if(r<s)return{success:!1,results:[],newGems:r,newShards:0,error:"Khng  Gems!"};try{const o=await Wa(e),a=[];let c=0;o.cards[t]||(o.cards[t]={});const h=0;o.pityCounters[h]===void 0&&(o.pityCounters[h]=0);for(let y=0;y<i;y++){const{card:_,resetPity:w}=Not(n.item_list,o.pityCounters[h]),x=_.card_img,C=!o.cards[t][x];let k=0;if(C)switch(o.cards[t][x]=1,o.gachaStats||(o.gachaStats={...Bp}),_.card_scarcity){case 10:o.gachaStats.totalNCards++;break;case 20:o.gachaStats.totalRCards++;break;case 30:o.gachaStats.totalSRCards++;break;case 40:o.gachaStats.totalURCards++;break}else o.cards[t][x]++,k=cn.DUPLICATE_SHARDS[_.card_scarcity]||5,c+=k;w?o.pityCounters[h]=0:o.pityCounters[h]++,a.push({cardImg:_.card_img,cardScarcity:_.card_scarcity,isNew:C,shardsGained:k,videoList:_.video_list,width:_.width,height:_.height})}o.shards+=c,o.totalPulls+=i;const u=Dt(kt,"users",e),d=r-s;await Kt(u,{gems:d,gachaInventory:o});const f=te.getState(),v=f.user;v&&te.setState({user:{...v,gems:d,gachaInventory:o}});try{await f.incrementDailyGachaPulls(i),await f.checkAchievements()}catch(y){console.warn("Failed to update gacha quest progress:",y)}return{success:!0,results:a,newGems:d,newShards:o.shards}}catch(o){return console.error("Error pulling gacha:",o),{success:!1,results:[],newGems:r,newShards:0,error:"C li xy ra!"}}}function Sot(e,t,n){var i;return!!((i=e.cards[t])!=null&&i[n])}async function Iot(e,t,n){try{const i=await Wa(e);i.gachaStats||(i.gachaStats={...Bp});for(const o of n){if(i.rewards.some(h=>h.collectionId===t&&h.image===o.redeem_item_image))continue;let c="badge";switch(o.redeem_item_type===1e3?c="avatar":o.redeem_item_type===3?c="frame":o.redeem_item_type===1001&&(c="badge"),i.rewards.push({type:c,image:o.redeem_item_image||"",name:o.redeem_item_name||"",obtainedAt:new Date().toISOString(),collectionId:t}),c){case"avatar":i.gachaStats.totalAvatars++;break;case"frame":i.gachaStats.totalFrames++;break;case"badge":i.gachaStats.totalBadges++;break}}const r=Dt(kt,"users",e);await Kt(r,{gachaInventory:i});const s=te.getState().user;return s&&te.setState({user:{...s,gachaInventory:i}}),!0}catch(i){return console.error("Error claiming all rewards:",i),!1}}function Aot(e,t){return e.rewards.some(n=>n.collectionId===t)}async function Rot(e,t,n){var i;try{const r=await Wa(e),s=cn.UR_EXCHANGE_COST;if((i=r.cards[t])!=null&&i[n])return{success:!1,error:"Bn  s hu th ny!"};if(r.shards<s)return{success:!1,error:`Khng  mnh! Cn ${s} mnh.`};r.shards-=s,r.cards[t]||(r.cards[t]={}),r.cards[t][n]=1,r.gachaStats||(r.gachaStats={...Bp}),r.gachaStats.totalURCards++;const o=Dt(kt,"users",e);await Kt(o,{gachaInventory:r});const a=te.getState().user;return a&&te.setState({user:{...a,gachaInventory:r}}),{success:!0,newShards:r.shards}}catch(r){return console.error("Error exchanging shards:",r),{success:!1,error:"C li xy ra!"}}}const py=6;function Pot(){const e=we(),[t]=oM(),{user:n}=te(),[i,r]=I.useState([]),[s,o]=I.useState(!0),[a,c]=I.useState(null),[h,u]=I.useState(null),[d,f]=I.useState({}),v=t.get("tab")||"all",y=parseInt(t.get("page")||"1",10),[_,w]=I.useState(v),[x,C]=I.useState(y),k="gacha_card_counts",P=24*60*60*1e3;I.useEffect(()=>{const W=localStorage.getItem(k);if(W)try{const U=JSON.parse(W);Date.now()-U.timestamp<P&&f(U.data)}catch{}},[]);const A=async()=>{try{o(!0),c(null);const W=await tj();r(W)}catch(W){console.error("Fetch error:",W),c("Khng th ti d liu")}finally{o(!1)}};I.useEffect(()=>{A()},[]),I.useEffect(()=>{n!=null&&n.oderId&&Wa(n.oderId).then(u)},[n==null?void 0:n.oderId]);const[M,N]=I.useState(!1);I.useEffect(()=>{M&&(C(1),N(!1))},[_,M]);const T=W=>{N(!0),w(W)},E=W=>{if(!h)return!1;const U=d[W]||0,Q=h.cards[W]?Object.keys(h.cards[W]).length:0;return Q>0&&Q<U},R=W=>{if(!h)return!1;const U=d[W]||0,Q=h.cards[W]?Object.keys(h.cards[W]).length:0;return U>0&&Q>=U},D=I.useMemo(()=>{if(!h)return _==="all"?i:[];const W=h.bookmarked||[];switch(_){case"bookmarked":return i.filter(U=>W.includes(U.id));case"spinning":return i.filter(U=>E(U.id));case"completed":return i.filter(U=>R(U.id));case"all":default:return i.filter(U=>!W.includes(U.id)&&!E(U.id)&&!R(U.id))}},[i,h,_,d]),j=Math.ceil(D.length/py),L=(x-1)*py,lt=D.slice(L,L+py);I.useEffect(()=>{if(lt.length===0)return;(async()=>{const U=lt.filter(F=>d[F.id]===void 0).map(F=>F.id);if(U.length===0)return;const Q={...d};await Promise.all(U.map(async F=>{try{const q=await Vu(F);Q[F]=q.reduce(($,H)=>{var X;return $+(((X=H.item_list)==null?void 0:X.length)||0)},0)}catch{Q[F]=0}})),f(Q),localStorage.setItem(k,JSON.stringify({data:Q,timestamp:Date.now()}))})()},[lt.map(W=>W.id).join(",")]);const dt=async(W,U)=>{if(U.stopPropagation(),!(n!=null&&n.oderId)||!h)return;const Q=h.bookmarked||[];let F;Q.includes(W)?F=Q.filter($=>$!==W):F=[...Q,W];const q={...h,bookmarked:F};u(q),await kot(n.oderId,q)},Y=()=>{switch(_){case"bookmarked":return"from-[var(--duo-yellow)] to-[var(--duo-orange)]";case"spinning":return"from-[var(--duo-blue)] to-[var(--duo-purple)]";case"completed":return"from-[var(--duo-green)] to-[#10b981]";default:return"from-[#8b5cf6] to-[#ec4899]"}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r ${Y()}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xt,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Gacha"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"B su tp th s"})]}),l.jsx("div",{className:"fixed top-[116px] left-0 right-0 z-40 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>T("all"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${_==="all"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Dk,{className:"w-4 h-4"}),"Tt c"]}),l.jsxs("button",{onClick:()=>T("bookmarked"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${_==="bookmarked"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Lv,{className:"w-4 h-4"})," lu"]}),l.jsxs("button",{onClick:()=>T("spinning"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${_==="spinning"?"bg-[var(--duo-blue)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Lk,{className:"w-4 h-4"}),"ang quay"]}),l.jsxs("button",{onClick:()=>T("completed"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${_==="completed"?"bg-[var(--duo-green)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(Cr,{className:"w-4 h-4"}),"Hon thnh"]})]})}),l.jsx("div",{className:"px-4 pt-[180px] pb-28",children:s?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(qi,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]}):a?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:a}),l.jsx("button",{onClick:A,className:"btn-3d btn-3d-purple px-4 py-2",children:"Th li"})]}):D.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[_==="all"?l.jsx(Dk,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):_==="bookmarked"?l.jsx(Lv,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):_==="spinning"?l.jsx(Lk,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}):l.jsx(Cr,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:_==="all"?"Tt c gi  c phn loi":_==="bookmarked"?"Cha c gi no c lu":_==="spinning"?"Cha c gi no ang quay":"Cha c gi no hon thnh"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-2 gap-3",children:lt.map(W=>{var $;const U=d[W.id]||0,Q=h!=null&&h.cards[W.id]?Object.keys(h.cards[W.id]).length:0,F=U>0&&Q>=U,q=($=h==null?void 0:h.bookmarked)==null?void 0:$.includes(W.id);return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>e(`/gacha/${W.id}?tab=${_}&page=${x}`),className:"w-full rounded-xl overflow-hidden bg-[var(--secondary)] transition-transform hover:scale-105 active:scale-95 shadow-lg",children:[l.jsx("img",{src:Ne(W.act_square_img,400),alt:"",className:"w-full h-auto",referrerPolicy:"no-referrer",loading:"lazy"}),Q>0&&l.jsx("div",{className:`absolute top-2 left-2 px-2 py-1 rounded-lg text-xs font-bold ${F?"bg-[var(--duo-green)] text-white":"bg-black/60 text-white"}`,children:F?l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Rn,{className:"w-3 h-3"}),"Xong"]}):`${Q}/${U}`})]}),l.jsx("button",{onClick:H=>dt(W.id,H),className:`absolute top-2 right-2 p-1.5 rounded-lg transition-all ${q?"bg-[var(--duo-yellow)] text-white":"bg-black/60 text-white hover:bg-black/80"}`,children:q?l.jsx(YO,{className:"w-4 h-4"}):l.jsx(Lv,{className:"w-4 h-4"})})]},W.id)})}),j>1&&l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[l.jsx("button",{onClick:()=>C(1),disabled:x===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(lB,{className:"w-4 h-4 text-foreground"})}),l.jsx("button",{onClick:()=>C(W=>Math.max(1,W-1)),disabled:x===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(rw,{className:"w-4 h-4 text-foreground"})}),l.jsxs("div",{className:"px-4 py-2 rounded-xl bg-[var(--duo-purple)] text-white font-bold text-sm",children:[x," / ",j]}),l.jsx("button",{onClick:()=>C(W=>Math.min(j,W+1)),disabled:x===j,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(sr,{className:"w-4 h-4 text-foreground"})}),l.jsx("button",{onClick:()=>C(j),disabled:x===j,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(uB,{className:"w-4 h-4 text-foreground"})})]})]})})]})}function Xb({videoList:e,imageUrl:t,className:n="w-full h-full object-contain",imageSize:i=600,timeout:r=8e3,collectionId:s,lotteryId:o}){const[a,c]=I.useState("loading"),[h,u]=I.useState(null),d=I.useRef(null),f=I.useRef(null),v=e&&e.length>1&&e[1],y=h||(v?e[1]:null),_=Ne(t,i),w=I.useCallback(async()=>{if(!s||!o||!t)return null;console.log("[VideoCard] Fetching fresh URL via proxy...");const A=await iot(s,o,t);return A&&(console.log("[VideoCard] Got fresh URL:",A.substring(0,60)+"..."),u(A)),A},[s,o,t]),x=I.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null)},[]);I.useEffect(()=>{if(console.log("[VideoCard] Card changed, resetting state"),c("loading"),u(null),x(),!v){console.log("[VideoCard] No video, showing image:",t),c("error");return}console.log("[VideoCard] Loading video:",y);const A=setTimeout(()=>{c(M=>M==="loading"?(console.warn("[VideoCard] Timeout after",r,"ms:",y),"error"):M)},r);return()=>{clearTimeout(A),x()}},[y,t,v,r,x]);const C=I.useCallback(()=>{var A;x(),console.log("[VideoCard] Video can play:",y),c("playing"),(A=d.current)==null||A.play().catch(M=>{console.error("[VideoCard] Autoplay blocked:",M.message,y),c("error")})},[x,y]),k=I.useCallback(async A=>{const M=A.currentTarget,N=M.error;if((N==null?void 0:N.code)===1){console.log("[VideoCard] Load aborted (normal when switching cards):",y);return}console.error("[VideoCard] Video error:",{url:y,code:N==null?void 0:N.code,message:N==null?void 0:N.message,networkState:M.networkState,readyState:M.readyState}),!(!h&&s&&o&&(console.log("[VideoCard] Trying to fetch fresh URL..."),await w()))&&(x(),c("error"))},[x,y,h,s,o,w]),P=I.useCallback(()=>{console.log("[VideoCard] Data loaded, buffering:",y),x(),f.current=setTimeout(()=>{c(A=>A==="loading"?(console.warn("[VideoCard] Buffering timeout:",y),"error"):A)},3e3)},[x,y]);return!v||a==="error"?l.jsx("img",{src:_,alt:"",className:n,referrerPolicy:"no-referrer"}):l.jsx("video",{ref:d,className:n,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,poster:_,onCanPlay:C,onError:k,onLoadedData:P,children:l.jsx("source",{src:y,type:"video/mp4"})},y)}const Zb=I.createContext({});function tT(e){const t=I.useRef(null);return t.current===null&&(t.current=e()),t.current}const rj=typeof window<"u",sj=rj?I.useLayoutEffect:I.useEffect,Gp=I.createContext(null);function eT(e,t){e.indexOf(t)===-1&&e.push(t)}function nT(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Jr=(e,t,n)=>n>t?t:n<e?e:n;let iT=()=>{};const Ps={},oj=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function aj(e){return typeof e=="object"&&e!==null}const cj=e=>/^0[^.\s]+$/u.test(e);function rT(e){let t;return()=>(t===void 0&&(t=e()),t)}const Hi=e=>e,Mot=(e,t)=>n=>t(e(n)),vd=(...e)=>e.reduce(Mot),qu=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i};class sT{constructor(){this.subscriptions=[]}add(t){return eT(this.subscriptions,t),()=>nT(this.subscriptions,t)}notify(t,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,n,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vs=e=>e*1e3,Fi=e=>e/1e3;function lj(e,t){return t?e*(1e3/t):0}const hj=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Dot=1e-7,Lot=12;function Vot(e,t,n,i,r){let s,o,a=0;do o=t+(n-t)/2,s=hj(o,i,r)-e,s>0?n=o:t=o;while(Math.abs(s)>Dot&&++a<Lot);return o}function yd(e,t,n,i){if(e===t&&n===i)return Hi;const r=s=>Vot(s,0,1,e,n);return s=>s===0||s===1?s:hj(r(s),t,i)}const uj=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,dj=e=>t=>1-e(1-t),gj=yd(.33,1.53,.69,.99),oT=dj(gj),fj=uj(oT),mj=e=>(e*=2)<1?.5*oT(e):.5*(2-Math.pow(2,-10*(e-1))),aT=e=>1-Math.sin(Math.acos(e)),pj=dj(aT),vj=uj(aT),qot=yd(.42,0,1,1),jot=yd(0,0,.58,1),yj=yd(.42,0,.58,1),Fot=e=>Array.isArray(e)&&typeof e[0]!="number",xj=e=>Array.isArray(e)&&typeof e[0]=="number",Uot={linear:Hi,easeIn:qot,easeInOut:yj,easeOut:jot,circIn:aT,circInOut:vj,circOut:pj,backIn:oT,backInOut:fj,backOut:gj,anticipate:mj},Oot=e=>typeof e=="string",iI=e=>{if(xj(e)){iT(e.length===4);const[t,n,i,r]=e;return yd(t,n,i,r)}else if(Oot(e))return Uot[e];return e},fg=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Bot(e,t){let n=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(h.schedule(u),e()),u(a)}const h={schedule:(u,d=!1,f=!1)=>{const y=f&&r?n:i;return d&&o.add(u),y.has(u)||y.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(a=u,r){s=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,s&&(s=!1,h.process(u))}};return h}const Got=40;function _j(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=fg.reduce((k,P)=>(k[P]=Bot(s),k),{}),{setup:a,read:c,resolveKeyframes:h,preUpdate:u,update:d,preRender:f,render:v,postRender:y}=o,_=()=>{const k=Ps.useManualTiming?r.timestamp:performance.now();n=!1,Ps.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(k-r.timestamp,Got),1)),r.timestamp=k,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),u.process(r),d.process(r),f.process(r),v.process(r),y.process(r),r.isProcessing=!1,n&&t&&(i=!1,e(_))},w=()=>{n=!0,i=!0,r.isProcessing||e(_)};return{schedule:fg.reduce((k,P)=>{const A=o[P];return k[P]=(M,N=!1,T=!1)=>(n||w(),A.schedule(M,N,T)),k},{}),cancel:k=>{for(let P=0;P<fg.length;P++)o[fg[P]].cancel(k)},state:r,steps:o}}const{schedule:_e,cancel:Vo,state:wn,steps:vy}=_j(typeof requestAnimationFrame<"u"?requestAnimationFrame:Hi,!0);let $g;function Hot(){$g=void 0}const Hn={now:()=>($g===void 0&&Hn.set(wn.isProcessing||Ps.useManualTiming?wn.timestamp:performance.now()),$g),set:e=>{$g=e,queueMicrotask(Hot)}},wj=e=>t=>typeof t=="string"&&t.startsWith(e),bj=wj("--"),$ot=wj("var(--"),cT=e=>$ot(e)?zot.test(e.split("/*")[0].trim()):!1,zot=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function rI(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Vl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},ju={...Vl,transform:e=>Jr(0,1,e)},mg={...Vl,default:1},Qh=e=>Math.round(e*1e5)/1e5,lT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Kot(e){return e==null}const Wot=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,hT=(e,t)=>n=>!!(typeof n=="string"&&Wot.test(n)&&n.startsWith(e)||t&&!Kot(n)&&Object.prototype.hasOwnProperty.call(n,t)),Tj=(e,t,n)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(lT);return{[e]:parseFloat(r),[t]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Qot=e=>Jr(0,255,e),yy={...Vl,transform:e=>Math.round(Qot(e))},ga={test:hT("rgb","red"),parse:Tj("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+yy.transform(e)+", "+yy.transform(t)+", "+yy.transform(n)+", "+Qh(ju.transform(i))+")"};function Yot(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const q0={test:hT("#"),parse:Yot,transform:ga.transform},xd=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ys=xd("deg"),Hr=xd("%"),yt=xd("px"),Jot=xd("vh"),Xot=xd("vw"),sI={...Hr,parse:e=>Hr.parse(e)/100,transform:e=>Hr.transform(e*100)},Cc={test:hT("hsl","hue"),parse:Tj("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+Hr.transform(Qh(t))+", "+Hr.transform(Qh(n))+", "+Qh(ju.transform(i))+")"},$e={test:e=>ga.test(e)||q0.test(e)||Cc.test(e),parse:e=>ga.test(e)?ga.parse(e):Cc.test(e)?Cc.parse(e):q0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ga.transform(e):Cc.transform(e),getAnimatableNone:e=>{const t=$e.parse(e);return t.alpha=0,$e.transform(t)}},Zot=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function tat(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(lT))==null?void 0:t.length)||0)+(((n=e.match(Zot))==null?void 0:n.length)||0)>0}const Cj="number",kj="color",eat="var",nat="var(",oI="${}",iat=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Fu(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=t.replace(iat,c=>($e.test(c)?(i.color.push(s),r.push(kj),n.push($e.parse(c))):c.startsWith(nat)?(i.var.push(s),r.push(eat),n.push(c)):(i.number.push(s),r.push(Cj),n.push(parseFloat(c))),++s,oI)).split(oI);return{values:n,split:a,indexes:i,types:r}}function Nj(e){return Fu(e).values}function Ej(e){const{split:t,types:n}=Fu(e),i=t.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=t[o],r[o]!==void 0){const a=n[o];a===Cj?s+=Qh(r[o]):a===kj?s+=$e.transform(r[o]):s+=r[o]}return s}}const rat=e=>typeof e=="number"?0:$e.test(e)?$e.getAnimatableNone(e):e;function sat(e){const t=Nj(e);return Ej(e)(t.map(rat))}const qo={test:tat,parse:Nj,createTransformer:Ej,getAnimatableNone:sat};function xy(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function oat({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let r=0,s=0,o=0;if(!t)r=s=o=n;else{const a=n<.5?n*(1+t):n+t-n*t,c=2*n-a;r=xy(c,a,e+1/3),s=xy(c,a,e),o=xy(c,a,e-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function pm(e,t){return n=>n>0?t:e}const Ee=(e,t,n)=>e+(t-e)*n,_y=(e,t,n)=>{const i=e*e,r=n*(t*t-i)+i;return r<0?0:Math.sqrt(r)},aat=[q0,ga,Cc],cat=e=>aat.find(t=>t.test(e));function aI(e){const t=cat(e);if(!t)return!1;let n=t.parse(e);return t===Cc&&(n=oat(n)),n}const cI=(e,t)=>{const n=aI(e),i=aI(t);if(!n||!i)return pm(e,t);const r={...n};return s=>(r.red=_y(n.red,i.red,s),r.green=_y(n.green,i.green,s),r.blue=_y(n.blue,i.blue,s),r.alpha=Ee(n.alpha,i.alpha,s),ga.transform(r))},j0=new Set(["none","hidden"]);function lat(e,t){return j0.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function hat(e,t){return n=>Ee(e,t,n)}function uT(e){return typeof e=="number"?hat:typeof e=="string"?cT(e)?pm:$e.test(e)?cI:gat:Array.isArray(e)?Sj:typeof e=="object"?$e.test(e)?cI:uat:pm}function Sj(e,t){const n=[...e],i=n.length,r=e.map((s,o)=>uT(s)(s,t[o]));return s=>{for(let o=0;o<i;o++)n[o]=r[o](s);return n}}function uat(e,t){const n={...e,...t},i={};for(const r in n)e[r]!==void 0&&t[r]!==void 0&&(i[r]=uT(e[r])(e[r],t[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}}function dat(e,t){const n=[],i={color:0,var:0,number:0};for(let r=0;r<t.values.length;r++){const s=t.types[r],o=e.indexes[s][i[s]],a=e.values[o]??0;n[r]=a,i[s]++}return n}const gat=(e,t)=>{const n=qo.createTransformer(t),i=Fu(e),r=Fu(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?j0.has(e)&&!r.values.length||j0.has(t)&&!i.values.length?lat(e,t):vd(Sj(dat(i,r),r.values),n):pm(e,t)};function Ij(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Ee(e,t,n):uT(e)(e,t)}const fat=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>_e.update(t,n),stop:()=>Vo(t),now:()=>wn.isProcessing?wn.timestamp:Hn.now()}},Aj=(e,t,n=10)=>{let i="";const r=Math.max(Math.round(t/n),2);for(let s=0;s<r;s++)i+=Math.round(e(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},vm=2e4;function dT(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<vm;)t+=n,i=e.next(t);return t>=vm?1/0:t}function mat(e,t=100,n){const i=n({...e,keyframes:[0,t]}),r=Math.min(dT(i),vm);return{type:"keyframes",ease:s=>i.next(r*s).value/t,duration:Fi(r)}}const pat=5;function Rj(e,t,n){const i=Math.max(t-pat,0);return lj(n-e(i),t-i)}const De={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},wy=.001;function vat({duration:e=De.duration,bounce:t=De.bounce,velocity:n=De.velocity,mass:i=De.mass}){let r,s,o=1-t;o=Jr(De.minDamping,De.maxDamping,o),e=Jr(De.minDuration,De.maxDuration,Fi(e)),o<1?(r=h=>{const u=h*o,d=u*e,f=u-n,v=F0(h,o),y=Math.exp(-d);return wy-f/v*y},s=h=>{const d=h*o*e,f=d*n+n,v=Math.pow(o,2)*Math.pow(h,2)*e,y=Math.exp(-d),_=F0(Math.pow(h,2),o);return(-r(h)+wy>0?-1:1)*((f-v)*y)/_}):(r=h=>{const u=Math.exp(-h*e),d=(h-n)*e+1;return-wy+u*d},s=h=>{const u=Math.exp(-h*e),d=(n-h)*(e*e);return u*d});const a=5/e,c=xat(r,s,a);if(e=vs(e),isNaN(c))return{stiffness:De.stiffness,damping:De.damping,duration:e};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:e}}}const yat=12;function xat(e,t,n){let i=n;for(let r=1;r<yat;r++)i=i-e(i)/t(i);return i}function F0(e,t){return e*Math.sqrt(1-t*t)}const _at=["duration","bounce"],wat=["stiffness","damping","mass"];function lI(e,t){return t.some(n=>e[n]!==void 0)}function bat(e){let t={velocity:De.velocity,stiffness:De.stiffness,damping:De.damping,mass:De.mass,isResolvedFromDuration:!1,...e};if(!lI(e,wat)&&lI(e,_at))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,s=2*Jr(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:De.mass,stiffness:r,damping:s}}else{const n=vat(e);t={...t,...n,mass:De.mass},t.isResolvedFromDuration=!0}return t}function ym(e=De.visualDuration,t=De.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:u,duration:d,velocity:f,isResolvedFromDuration:v}=bat({...n,velocity:-Fi(n.velocity||0)}),y=f||0,_=h/(2*Math.sqrt(c*u)),w=o-s,x=Fi(Math.sqrt(c/u)),C=Math.abs(w)<5;i||(i=C?De.restSpeed.granular:De.restSpeed.default),r||(r=C?De.restDelta.granular:De.restDelta.default);let k;if(_<1){const A=F0(x,_);k=M=>{const N=Math.exp(-_*x*M);return o-N*((y+_*x*w)/A*Math.sin(A*M)+w*Math.cos(A*M))}}else if(_===1)k=A=>o-Math.exp(-x*A)*(w+(y+x*w)*A);else{const A=x*Math.sqrt(_*_-1);k=M=>{const N=Math.exp(-_*x*M),T=Math.min(A*M,300);return o-N*((y+_*x*w)*Math.sinh(T)+A*w*Math.cosh(T))/A}}const P={calculatedDuration:v&&d||null,next:A=>{const M=k(A);if(v)a.done=A>=d;else{let N=A===0?y:0;_<1&&(N=A===0?vs(y):Rj(k,A,M));const T=Math.abs(N)<=i,E=Math.abs(o-M)<=r;a.done=T&&E}return a.value=a.done?o:M,a},toString:()=>{const A=Math.min(dT(P),vm),M=Aj(N=>P.next(A*N).value,A,30);return A+"ms "+M},toTransition:()=>{}};return P}ym.applyToOptions=e=>{const t=mat(e,100,ym);return e.ease=t.ease,e.duration=vs(t.duration),e.type="keyframes",e};function U0({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:u}){const d=e[0],f={done:!1,value:d},v=T=>a!==void 0&&T<a||c!==void 0&&T>c,y=T=>a===void 0?c:c===void 0||Math.abs(a-T)<Math.abs(c-T)?a:c;let _=n*t;const w=d+_,x=o===void 0?w:o(w);x!==w&&(_=x-d);const C=T=>-_*Math.exp(-T/i),k=T=>x+C(T),P=T=>{const E=C(T),R=k(T);f.done=Math.abs(E)<=h,f.value=f.done?x:R};let A,M;const N=T=>{v(f.value)&&(A=T,M=ym({keyframes:[f.value,y(f.value)],velocity:Rj(k,T,f.value),damping:r,stiffness:s,restDelta:h,restSpeed:u}))};return N(0),{calculatedDuration:null,next:T=>{let E=!1;return!M&&A===void 0&&(E=!0,P(T),N(T)),A!==void 0&&T>=A?M.next(T-A):(!E&&P(T),f)}}}function Tat(e,t,n){const i=[],r=n||Ps.mix||Ij,s=e.length-1;for(let o=0;o<s;o++){let a=r(e[o],e[o+1]);if(t){const c=Array.isArray(t)?t[o]||Hi:t;a=vd(c,a)}i.push(a)}return i}function Cat(e,t,{clamp:n=!0,ease:i,mixer:r}={}){const s=e.length;if(iT(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Tat(t,i,r),c=a.length,h=u=>{if(o&&u<e[0])return t[0];let d=0;if(c>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=qu(e[d],e[d+1],u);return a[d](f)};return n?u=>h(Jr(e[0],e[s-1],u)):h}function kat(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=qu(0,t,i);e.push(Ee(n,1,r))}}function Nat(e){const t=[0];return kat(t,e.length-1),t}function Eat(e,t){return e.map(n=>n*t)}function Sat(e,t){return e.map(()=>t||yj).splice(0,e.length-1)}function Yh({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const r=Fot(i)?i.map(iI):iI(i),s={done:!1,value:t[0]},o=Eat(n&&n.length===t.length?n:Nat(t),e),a=Cat(o,t,{ease:Array.isArray(r)?r:Sat(t,r)});return{calculatedDuration:e,next:c=>(s.value=a(c),s.done=c>=e,s)}}const Iat=e=>e!==null;function gT(e,{repeat:t,repeatType:n="loop"},i,r=1){const s=e.filter(Iat),a=r<0||t&&n!=="loop"&&t%2===1?0:s.length-1;return!a||i===void 0?s[a]:i}const Aat={decay:U0,inertia:U0,tween:Yh,keyframes:Yh,spring:ym};function Pj(e){typeof e.type=="string"&&(e.type=Aat[e.type])}class fT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const Rat=e=>e/100;class mT extends fT{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:n}=this.options;n&&n.updatedAt!==Hn.now()&&this.tick(Hn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Pj(t);const{type:n=Yh,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=t;let{keyframes:a}=t;const c=n||Yh;c!==Yh&&typeof a[0]!="number"&&(this.mixKeyframes=vd(Rat,Ij(a[0],a[1])),a=[0,100]);const h=c({...t,keyframes:a});s==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...a].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=dT(h));const{calculatedDuration:u}=h;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=h}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:h=0,keyframes:u,repeat:d,repeatType:f,repeatDelay:v,type:y,onUpdate:_,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-r/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-h*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?x<0:x>r;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let k=this.currentTime,P=i;if(d){const T=Math.min(this.currentTime,r)/a;let E=Math.floor(T),R=T%1;!R&&T>=1&&(R=1),R===1&&E--,E=Math.min(E,d+1),!!(E%2)&&(f==="reverse"?(R=1-R,v&&(R-=v/a)):f==="mirror"&&(P=o)),k=Jr(0,1,R)*a}const A=C?{done:!1,value:u[0]}:P.next(k);s&&(A.value=s(A.value));let{done:M}=A;!C&&c!==null&&(M=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return N&&y!==U0&&(A.value=gT(u,this.options,w,this.speed)),_&&_(A.value),N&&this.finish(),A}then(t,n){return this.finished.then(t,n)}get duration(){return Fi(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Fi(t)}get time(){return Fi(this.currentTime)}set time(t){var n;t=vs(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Hn.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Fi(this.currentTime))}play(){var r,s;if(this.isStopped)return;const{driver:t=fat,startTime:n}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(s=(r=this.options).onPlay)==null||s.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Hn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function Pat(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const fa=e=>e*180/Math.PI,O0=e=>{const t=fa(Math.atan2(e[1],e[0]));return B0(t)},Mat={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:O0,rotateZ:O0,skewX:e=>fa(Math.atan(e[1])),skewY:e=>fa(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},B0=e=>(e=e%360,e<0&&(e+=360),e),hI=O0,uI=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),dI=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Dat={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:uI,scaleY:dI,scale:e=>(uI(e)+dI(e))/2,rotateX:e=>B0(fa(Math.atan2(e[6],e[5]))),rotateY:e=>B0(fa(Math.atan2(-e[2],e[0]))),rotateZ:hI,rotate:hI,skewX:e=>fa(Math.atan(e[4])),skewY:e=>fa(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function G0(e){return e.includes("scale")?1:0}function H0(e,t){if(!e||e==="none")return G0(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=Dat,r=n;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=Mat,r=a}if(!r)return G0(t);const s=i[t],o=r[1].split(",").map(Vat);return typeof s=="function"?s(o):o[s]}const Lat=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return H0(n,t)};function Vat(e){return parseFloat(e.trim())}const ql=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],jl=new Set(ql),gI=e=>e===Vl||e===yt,qat=new Set(["x","y","z"]),jat=ql.filter(e=>!qat.has(e));function Fat(e){const t=[];return jat.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const co={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>H0(t,"x"),y:(e,{transform:t})=>H0(t,"y")};co.translateX=co.x;co.translateY=co.y;const xa=new Set;let $0=!1,z0=!1,K0=!1;function Mj(){if(z0){const e=Array.from(xa).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const r=Fat(i);r.length&&(n.set(i,r),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))==null||a.set(o)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}z0=!1,$0=!1,xa.forEach(e=>e.complete(K0)),xa.clear()}function Dj(){xa.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(z0=!0)})}function Uat(){K0=!0,Dj(),Mj(),K0=!1}class pT{constructor(t,n,i,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(xa.add(this),$0||($0=!0,_e.read(Dj),_e.resolveKeyframes(Mj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:r}=this;if(t[0]===null){const s=r==null?void 0:r.get(),o=t[t.length-1];if(s!==void 0)t[0]=s;else if(i&&n){const a=i.readValue(n,o);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=o),r&&s===void 0&&r.set(t[0])}Pat(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),xa.delete(this)}cancel(){this.state==="scheduled"&&(xa.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Oat=e=>e.startsWith("--");function Bat(e,t,n){Oat(t)?e.style.setProperty(t,n):e.style[t]=n}const Gat=rT(()=>window.ScrollTimeline!==void 0),Hat={};function $at(e,t){const n=rT(e);return()=>Hat[t]??n()}const Lj=$at(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),kh=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,fI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:kh([0,.65,.55,1]),circOut:kh([.55,0,1,.45]),backIn:kh([.31,.01,.66,-.59]),backOut:kh([.33,1.53,.69,.99])};function Vj(e,t){if(e)return typeof e=="function"?Lj()?Aj(e,t):"ease-out":xj(e)?kh(e):Array.isArray(e)?e.map(n=>Vj(n,t)||fI.easeOut):fI[e]}function zat(e,t,n,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:c}={},h=void 0){const u={[t]:n};c&&(u.offset=c);const d=Vj(a,r);Array.isArray(d)&&(u.easing=d);const f={delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(f.pseudoElement=h),e.animate(u,f)}function qj(e){return typeof e=="function"&&"applyToOptions"in e}function Kat({type:e,...t}){return qj(e)&&Lj()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Wat extends fT{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:n,name:i,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:c}=t;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=t,iT(typeof t.type!="string");const h=Kat(t);this.animation=zat(n,i,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=gT(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):Bat(n,i,u),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,i;const t=((i=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:i.call(n).duration)||0;return Fi(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Fi(t)}get time(){return Fi(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=vs(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Gat()?(this.animation.timeline=t,Hi):n(this)}}const jj={anticipate:mj,backInOut:fj,circInOut:vj};function Qat(e){return e in jj}function Yat(e){typeof e.ease=="string"&&Qat(e.ease)&&(e.ease=jj[e.ease])}const by=10;class Jat extends Wat{constructor(t){Yat(t),Pj(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:i,onComplete:r,element:s,...o}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const a=new mT({...o,autoplay:!1}),c=Math.max(by,Hn.now()-this.startTime),h=Jr(0,by,c-by);n.setWithVelocity(a.sample(Math.max(0,c-h)).value,a.sample(c).value,h),a.stop()}}const mI=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(qo.test(e)||e==="0")&&!e.startsWith("url("));function Xat(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function Zat(e,t,n,i){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],o=mI(r,t),a=mI(s,t);return!o||!a?!1:Xat(e)||(n==="spring"||qj(n))&&i}function W0(e){e.duration=0,e.type="keyframes"}const tct=new Set(["opacity","clipPath","filter","transform"]),ect=rT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function nct(e){var u;const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:s,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=t.owner.getProps();return ect()&&n&&tct.has(n)&&(n!=="transform"||!h)&&!c&&!i&&r!=="mirror"&&s!==0&&o!=="inertia"}const ict=40;class rct extends fT{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:c,motionValue:h,element:u,...d}){var y;super(),this.stop=()=>{var _,w;this._animation&&(this._animation.stop(),(_=this.stopTimeline)==null||_.call(this)),(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=Hn.now();const f={autoplay:t,delay:n,type:i,repeat:r,repeatDelay:s,repeatType:o,name:c,motionValue:h,element:u,...d},v=(u==null?void 0:u.KeyframeResolver)||pT;this.keyframeResolver=new v(a,(_,w,x)=>this.onKeyframesResolved(_,w,f,!x),c,h,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,i,r){var w,x;this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:c,isHandoff:h,onUpdate:u}=i;this.resolvedAt=Hn.now(),Zat(t,s,o,a)||((Ps.instantAnimations||!c)&&(u==null||u(gT(t,i,n))),t[0]=t[t.length-1],W0(i),i.repeat=0);const f={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>ict?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:t},v=!h&&nct(f),y=(x=(w=f.motionValue)==null?void 0:w.owner)==null?void 0:x.current,_=v?new Jat({...f,element:y}):new mT(f);_.finished.then(()=>{this.notifyFinished()}).catch(Hi),this.pendingTimeline&&(this.stopTimeline=_.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=_}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),Uat()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function Fj(e,t,n,i=0,r=1){const s=Array.from(e).sort((h,u)=>h.sortNodePosition(u)).indexOf(t),o=e.size,a=(o-1)*i;return typeof n=="function"?n(s,o):r===1?s*i:a-s*i}const sct=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function oct(e){const t=sct.exec(e);if(!t)return[,];const[,n,i,r]=t;return[`--${n??i}`,r]}function Uj(e,t,n=1){const[i,r]=oct(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const o=s.trim();return oj(o)?parseFloat(o):o}return cT(r)?Uj(r,t,n+1):r}const act={type:"spring",stiffness:500,damping:25,restSpeed:10},cct=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),lct={type:"keyframes",duration:.8},hct={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},uct=(e,{keyframes:t})=>t.length>2?lct:jl.has(e)?e.startsWith("scale")?cct(t[1]):act:hct,dct=e=>e!==null;function gct(e,{repeat:t,repeatType:n="loop"},i){const r=e.filter(dct),s=t&&n!=="loop"&&t%2===1?0:r.length-1;return r[s]}function vT(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}function fct({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...u}){return!!Object.keys(u).length}const yT=(e,t,n,i={},r,s)=>o=>{const a=vT(i,e)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-vs(c);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-h,onUpdate:f=>{t.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:s?void 0:r};fct(a)||Object.assign(u,uct(e,u)),u.duration&&(u.duration=vs(u.duration)),u.repeatDelay&&(u.repeatDelay=vs(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(W0(u),u.delay===0&&(d=!0)),(Ps.instantAnimations||Ps.skipAnimations)&&(d=!0,W0(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&t.get()!==void 0){const f=gct(u.keyframes,a);if(f!==void 0){_e.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new mT(u):new rct(u)};function pI(e){const t=[{},{}];return e==null||e.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function xT(e,t,n,i){if(typeof t=="function"){const[r,s]=pI(i);t=t(n!==void 0?n:e.custom,r,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,s]=pI(i);t=t(n!==void 0?n:e.custom,r,s)}return t}function zc(e,t,n){const i=e.getProps();return xT(i,t,n!==void 0?n:i.custom,e)}const Oj=new Set(["width","height","top","left","right","bottom",...ql]),vI=30,mct=e=>!isNaN(parseFloat(e));class pct{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var s;const r=Hn.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Hn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=mct(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new sT);const i=this.events[t].add(n);return t==="change"?()=>{i(),_e.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Hn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>vI)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,vI);return lj(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gl(e,t){return new pct(e,t)}const Q0=e=>Array.isArray(e);function vct(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,gl(n))}function yct(e){return Q0(e)?e[e.length-1]||0:e}function xct(e,t){const n=zc(e,t);let{transitionEnd:i={},transition:r={},...s}=n||{};s={...s,...i};for(const o in s){const a=yct(s[o]);vct(e,o,a)}}const Vn=e=>!!(e&&e.getVelocity);function _ct(e){return!!(Vn(e)&&e.add)}function Y0(e,t){const n=e.getValue("willChange");if(_ct(n))return n.add(t);if(!n&&Ps.WillChange){const i=new Ps.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function _T(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const wct="framerAppearId",Bj="data-"+_T(wct);function Gj(e){return e.props[Bj]}function bct({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function Hj(e,t,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:o,...a}=t;i&&(s=i);const c=[],h=r&&e.animationState&&e.animationState.getState()[r];for(const u in a){const d=e.getValue(u,e.latestValues[u]??null),f=a[u];if(f===void 0||h&&bct(h,u))continue;const v={delay:n,...vT(s||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(f)&&f===y&&!v.velocity)continue;let _=!1;if(window.MotionHandoffAnimation){const x=Gj(e);if(x){const C=window.MotionHandoffAnimation(x,u,_e);C!==null&&(v.startTime=C,_=!0)}}Y0(e,u),d.start(yT(u,d,f,e.shouldReduceMotion&&Oj.has(u)?{type:!1}:v,e,_));const w=d.animation;w&&c.push(w)}return o&&Promise.all(c).then(()=>{_e.update(()=>{o&&xct(e,o)})}),c}function J0(e,t,n={}){var c;const i=zc(e,t,n.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(Hj(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=r;return Tct(e,t,h,u,d,f,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[h,u]=a==="beforeChildren"?[s,o]:[o,s];return h().then(()=>u())}else return Promise.all([s(),o(n.delay)])}function Tct(e,t,n=0,i=0,r=0,s=1,o){const a=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),a.push(J0(c,t,{...o,delay:n+(typeof i=="function"?0:i)+Fj(e.variantChildren,c,i,r,s)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(a)}function Cct(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const r=t.map(s=>J0(e,s,n));i=Promise.all(r)}else if(typeof t=="string")i=J0(e,t,n);else{const r=typeof t=="function"?zc(e,t,n.custom):t;i=Promise.all(Hj(e,r,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}const kct={test:e=>e==="auto",parse:e=>e},$j=e=>t=>t.test(e),zj=[Vl,yt,Hr,Ys,Xot,Jot,kct],yI=e=>zj.find($j(e));function Nct(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||cj(e):!0}const Ect=new Set(["brightness","contrast","saturate","opacity"]);function Sct(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(lT)||[];if(!i)return e;const r=n.replace(i,"");let s=Ect.has(t)?1:0;return i!==n&&(s*=100),t+"("+s+r+")"}const Ict=/\b([a-z-]*)\(.*?\)/gu,X0={...qo,getAnimatableNone:e=>{const t=e.match(Ict);return t?t.map(Sct).join(" "):e}},xI={...Vl,transform:Math.round},Act={rotate:Ys,rotateX:Ys,rotateY:Ys,rotateZ:Ys,scale:mg,scaleX:mg,scaleY:mg,scaleZ:mg,skew:Ys,skewX:Ys,skewY:Ys,distance:yt,translateX:yt,translateY:yt,translateZ:yt,x:yt,y:yt,z:yt,perspective:yt,transformPerspective:yt,opacity:ju,originX:sI,originY:sI,originZ:yt},wT={borderWidth:yt,borderTopWidth:yt,borderRightWidth:yt,borderBottomWidth:yt,borderLeftWidth:yt,borderRadius:yt,radius:yt,borderTopLeftRadius:yt,borderTopRightRadius:yt,borderBottomRightRadius:yt,borderBottomLeftRadius:yt,width:yt,maxWidth:yt,height:yt,maxHeight:yt,top:yt,right:yt,bottom:yt,left:yt,inset:yt,insetBlock:yt,insetBlockStart:yt,insetBlockEnd:yt,insetInline:yt,insetInlineStart:yt,insetInlineEnd:yt,padding:yt,paddingTop:yt,paddingRight:yt,paddingBottom:yt,paddingLeft:yt,paddingBlock:yt,paddingBlockStart:yt,paddingBlockEnd:yt,paddingInline:yt,paddingInlineStart:yt,paddingInlineEnd:yt,margin:yt,marginTop:yt,marginRight:yt,marginBottom:yt,marginLeft:yt,marginBlock:yt,marginBlockStart:yt,marginBlockEnd:yt,marginInline:yt,marginInlineStart:yt,marginInlineEnd:yt,backgroundPositionX:yt,backgroundPositionY:yt,...Act,zIndex:xI,fillOpacity:ju,strokeOpacity:ju,numOctaves:xI},Rct={...wT,color:$e,backgroundColor:$e,outlineColor:$e,fill:$e,stroke:$e,borderColor:$e,borderTopColor:$e,borderRightColor:$e,borderBottomColor:$e,borderLeftColor:$e,filter:X0,WebkitFilter:X0},Kj=e=>Rct[e];function Wj(e,t){let n=Kj(e);return n!==X0&&(n=qo),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Pct=new Set(["auto","none","0"]);function Mct(e,t,n){let i=0,r;for(;i<e.length&&!r;){const s=e[i];typeof s=="string"&&!Pct.has(s)&&Fu(s).values.length&&(r=e[i]),i++}if(r&&n)for(const s of t)e[s]=Wj(n,r)}class Dct extends pT{constructor(t,n,i,r,s){super(t,n,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let d=t[u];if(typeof d=="string"&&(d=d.trim(),cT(d))){const f=Uj(d,n.current);f!==void 0&&(t[u]=f),u===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Oj.has(i)||t.length!==2)return;const[r,s]=t,o=yI(r),a=yI(s),c=rI(r),h=rI(s);if(c!==h&&co[i]){this.needsMeasurement=!0;return}if(o!==a)if(gI(o)&&gI(a))for(let u=0;u<t.length;u++){const d=t[u];typeof d=="string"&&(t[u]=parseFloat(d))}else co[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let r=0;r<t.length;r++)(t[r]===null||Nct(t[r]))&&i.push(r);i.length&&Mct(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=co[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&t.getValue(i,r).jump(r,!1)}measureEndState(){var a;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=co[n](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([c,h])=>{t.getValue(c).set(h)}),this.resolveNoneKeyframes()}}function Lct(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const r=(n==null?void 0:n[e])??i.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}const Qj=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Yj(e){return aj(e)&&"offsetHeight"in e}const{schedule:bT}=_j(queueMicrotask,!1),ir={x:!1,y:!1};function Jj(){return ir.x||ir.y}function Vct(e){return e==="x"||e==="y"?ir[e]?null:(ir[e]=!0,()=>{ir[e]=!1}):ir.x||ir.y?null:(ir.x=ir.y=!0,()=>{ir.x=ir.y=!1})}function Xj(e,t){const n=Lct(e),i=new AbortController,r={passive:!0,...t,signal:i.signal};return[n,r,()=>i.abort()]}function _I(e){return!(e.pointerType==="touch"||Jj())}function qct(e,t,n={}){const[i,r,s]=Xj(e,n),o=a=>{if(!_I(a))return;const{target:c}=a,h=t(c,a);if(typeof h!="function"||!c)return;const u=d=>{_I(d)&&(h(d),c.removeEventListener("pointerleave",u))};c.addEventListener("pointerleave",u,r)};return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const Zj=(e,t)=>t?e===t?!0:Zj(e,t.parentElement):!1,TT=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,jct=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function t4(e){return jct.has(e.tagName)||e.isContentEditable===!0}const zg=new WeakSet;function wI(e){return t=>{t.key==="Enter"&&e(t)}}function Ty(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Fct=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=wI(()=>{if(zg.has(n))return;Ty(n,"down");const r=wI(()=>{Ty(n,"up")}),s=()=>Ty(n,"cancel");n.addEventListener("keyup",r,t),n.addEventListener("blur",s,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function bI(e){return TT(e)&&!Jj()}function Uct(e,t,n={}){const[i,r,s]=Xj(e,n),o=a=>{const c=a.currentTarget;if(!bI(a))return;zg.add(c);const h=t(c,a),u=(v,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",f),zg.has(c)&&zg.delete(c),bI(v)&&typeof h=="function"&&h(v,{success:y})},d=v=>{u(v,c===window||c===document||n.useGlobalTarget||Zj(c,v.target))},f=v=>{u(v,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",f,r)};return i.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),Yj(a)&&(a.addEventListener("focus",h=>Fct(h,r)),!t4(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function e4(e){return aj(e)&&"ownerSVGElement"in e}function Oct(e){return e4(e)&&e.tagName==="svg"}const Bct=[...zj,$e,qo],Gct=e=>Bct.find($j(e)),TI=()=>({translate:0,scale:1,origin:0,originPoint:0}),kc=()=>({x:TI(),y:TI()}),CI=()=>({min:0,max:0}),Ze=()=>({x:CI(),y:CI()}),Z0={current:null},n4={current:!1},Hct=typeof window<"u";function $ct(){if(n4.current=!0,!!Hct)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Z0.current=e.matches;e.addEventListener("change",t),t()}else Z0.current=!1}const zct=new WeakMap;function Hp(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Uu(e){return typeof e=="string"||Array.isArray(e)}const CT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kT=["initial",...CT];function $p(e){return Hp(e.animate)||kT.some(t=>Uu(e[t]))}function i4(e){return!!($p(e)||e.variants)}function Kct(e,t,n){for(const i in t){const r=t[i],s=n[i];if(Vn(r))e.addValue(i,r);else if(Vn(s))e.addValue(i,gl(r,{owner:e}));else if(s!==r)if(e.hasValue(i)){const o=e.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=e.getStaticValue(i);e.addValue(i,gl(o!==void 0?o:r,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const kI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let xm={};function r4(e){xm=e}function Wct(){return xm}class Qct{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=pT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Hn.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,_e.render(this.render,!1,!0))};const{latestValues:c,renderState:h}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=h,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=$p(n),this.isVariantNode=i4(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const v=d[f];c[f]!==void 0&&Vn(v)&&v.set(c[f])}}mount(t){var n;this.current=t,zct.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(n4.current||$ct(),this.shouldReduceMotion=Z0.current),(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Vo(this.notifyUpdate),Vo(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const i=this.features[n];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=jl.has(t);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&_e.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;typeof window<"u"&&window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{r(),s&&s(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in xm){const n=xm[t];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[t]&&r&&i(this.props)&&(this.features[t]=new r(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ze()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<kI.length;i++){const r=kI[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=t[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Kct(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=gl(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(oj(i)||cj(i))?i=parseFloat(i):!Gct(i)&&qo.test(n)&&(i=Wj(t,n)),this.setBaseTarget(t,Vn(i)?i.get():i)),Vn(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const o=xT(this.props,n,(s=this.presenceContext)==null?void 0:s.custom);o&&(i=o[t])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,t);return r!==void 0&&!Vn(r)?r:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new sT),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){bT.render(this.render)}}class s4 extends Qct{constructor(){super(...arguments),this.KeyframeResolver=Dct}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){const i=t.style;return i?i[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Vn(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}class zo{constructor(t){this.isMounted=!1,this.node=t}update(){}}function o4({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function Yct({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Jct(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function Cy(e){return e===void 0||e===1}function t_({scale:e,scaleX:t,scaleY:n}){return!Cy(e)||!Cy(t)||!Cy(n)}function sa(e){return t_(e)||a4(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function a4(e){return NI(e.x)||NI(e.y)}function NI(e){return e&&e!=="0%"}function _m(e,t,n){const i=e-n,r=t*i;return n+r}function EI(e,t,n,i,r){return r!==void 0&&(e=_m(e,r,i)),_m(e,n,i)+t}function e_(e,t=0,n=1,i,r){e.min=EI(e.min,t,n,i,r),e.max=EI(e.max,t,n,i,r)}function c4(e,{x:t,y:n}){e_(e.x,t.translate,t.scale,t.originPoint),e_(e.y,n.translate,n.scale,n.originPoint)}const SI=.999999999999,II=1.0000000000001;function Xct(e,t,n,i=!1){const r=n.length;if(!r)return;t.x=t.y=1;let s,o;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Ec(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,c4(e,o)),i&&sa(s.latestValues)&&Ec(e,s.latestValues))}t.x<II&&t.x>SI&&(t.x=1),t.y<II&&t.y>SI&&(t.y=1)}function Nc(e,t){e.min=e.min+t,e.max=e.max+t}function AI(e,t,n,i,r=.5){const s=Ee(e.min,e.max,r);e_(e,t,n,s,i)}function Ec(e,t){AI(e.x,t.x,t.scaleX,t.scale,t.originX),AI(e.y,t.y,t.scaleY,t.scale,t.originY)}function l4(e,t){return o4(Jct(e.getBoundingClientRect(),t))}function Zct(e,t,n){const i=l4(e,n),{scroll:r}=t;return r&&(Nc(i.x,r.offset.x),Nc(i.y,r.offset.y)),i}const tlt={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},elt=ql.length;function nlt(e,t,n){let i="",r=!0;for(let s=0;s<elt;s++){const o=ql[s],a=e[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||n){const h=Qj(a,wT[o]);if(!c){r=!1;const u=tlt[o]||o;i+=`${u}(${h}) `}n&&(t[o]=h)}}return i=i.trim(),n?i=n(t,r?"":i):r&&(i="none"),i}function NT(e,t,n){const{style:i,vars:r,transformOrigin:s}=e;let o=!1,a=!1;for(const c in t){const h=t[c];if(jl.has(c)){o=!0;continue}else if(bj(c)){r[c]=h;continue}else{const u=Qj(h,wT[c]);c.startsWith("origin")?(a=!0,s[c]=u):i[c]=u}}if(t.transform||(o||n?i.transform=nlt(t,e.transform,n):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:u=0}=s;i.transformOrigin=`${c} ${h} ${u}`}}function h4(e,{style:t,vars:n},i,r){const s=e.style;let o;for(o in t)s[o]=t[o];r==null||r.applyProjectionStyles(s,i);for(o in n)s.setProperty(o,n[o])}function RI(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ph={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(yt.test(e))e=parseFloat(e);else return e;const n=RI(e,t.target.x),i=RI(e,t.target.y);return`${n}% ${i}%`}},ilt={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,r=qo.parse(e);if(r.length>5)return i;const s=qo.createTransformer(e),o=typeof r[0]!="number"?1:0,a=n.x.scale*t.x,c=n.y.scale*t.y;r[0+o]/=a,r[1+o]/=c;const h=Ee(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}},n_={borderRadius:{...ph,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ph,borderTopRightRadius:ph,borderBottomLeftRadius:ph,borderBottomRightRadius:ph,boxShadow:ilt};function u4(e,{layout:t,layoutId:n}){return jl.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!n_[e]||e==="opacity")}function ET(e,t,n){var o;const i=e.style,r=t==null?void 0:t.style,s={};if(!i)return s;for(const a in i)(Vn(i[a])||r&&Vn(r[a])||u4(a,e)||((o=n==null?void 0:n.getValue(a))==null?void 0:o.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function rlt(e){return window.getComputedStyle(e)}class slt extends s4{constructor(){super(...arguments),this.type="html",this.renderInstance=h4}readValueFromInstance(t,n){var i;if(jl.has(n))return(i=this.projection)!=null&&i.isProjecting?G0(n):Lat(t,n);{const r=rlt(t),s=(bj(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return l4(t,n)}build(t,n,i){NT(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return ET(t,n,i)}}const olt={offset:"stroke-dashoffset",array:"stroke-dasharray"},alt={offset:"strokeDashoffset",array:"strokeDasharray"};function clt(e,t,n=1,i=0,r=!0){e.pathLength=1;const s=r?olt:alt;e[s.offset]=yt.transform(-i);const o=yt.transform(t),a=yt.transform(n);e[s.array]=`${o} ${a}`}const llt=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function d4(e,{attrX:t,attrY:n,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},c,h,u){if(NT(e,a,h),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f}=e;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox);for(const v of llt)d[v]!==void 0&&(f[v]=d[v],delete d[v]);t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),i!==void 0&&(d.scale=i),r!==void 0&&clt(d,r,s,o,!1)}const g4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),f4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function hlt(e,t,n,i){h4(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(g4.has(r)?r:_T(r),t.attrs[r])}function m4(e,t,n){const i=ET(e,t,n);for(const r in e)if(Vn(e[r])||Vn(t[r])){const s=ql.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=e[r]}return i}class ult extends s4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ze}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(jl.has(n)){const i=Kj(n);return i&&i.default||0}return n=g4.has(n)?n:_T(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return m4(t,n,i)}build(t,n,i){d4(t,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,n,i,r){hlt(t,n,i,r)}mount(t){this.isSVGTag=f4(t.tagName),super.mount(t)}}const dlt=kT.length;function p4(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?p4(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<dlt;n++){const i=kT[n],r=e.props[i];(Uu(r)||r===!1)&&(t[i]=r)}return t}function v4(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}const glt=[...CT].reverse(),flt=CT.length;function mlt(e){return t=>Promise.all(t.map(({animation:n,options:i})=>Cct(e,n,i)))}function plt(e){let t=mlt(e),n=PI(),i=!0;const r=c=>(h,u)=>{var f;const d=zc(e,u,c==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(d){const{transition:v,transitionEnd:y,..._}=d;h={...h,..._,...y}}return h};function s(c){t=c(e)}function o(c){const{props:h}=e,u=p4(e.parent)||{},d=[],f=new Set;let v={},y=1/0;for(let w=0;w<flt;w++){const x=glt[w],C=n[x],k=h[x]!==void 0?h[x]:u[x],P=Uu(k),A=x===c?C.isActive:null;A===!1&&(y=w);let M=k===u[x]&&k!==h[x]&&P;if(M&&i&&e.manuallyAnimateOnMount&&(M=!1),C.protectedKeys={...v},!C.isActive&&A===null||!k&&!C.prevProp||Hp(k)||typeof k=="boolean")continue;const N=vlt(C.prevProp,k);let T=N||x===c&&C.isActive&&!M&&P||w>y&&P,E=!1;const R=Array.isArray(k)?k:[k];let D=R.reduce(r(x),{});A===!1&&(D={});const{prevResolvedValues:j={}}=C,L={...j,...D},lt=W=>{T=!0,f.has(W)&&(E=!0,f.delete(W)),C.needsAnimating[W]=!0;const U=e.getValue(W);U&&(U.liveStyle=!1)};for(const W in L){const U=D[W],Q=j[W];if(v.hasOwnProperty(W))continue;let F=!1;Q0(U)&&Q0(Q)?F=!v4(U,Q):F=U!==Q,F?U!=null?lt(W):f.add(W):U!==void 0&&f.has(W)?lt(W):C.protectedKeys[W]=!0}C.prevProp=k,C.prevResolvedValues=D,C.isActive&&(v={...v,...D}),i&&e.blockInitialAnimation&&(T=!1);const dt=M&&N;T&&(!dt||E)&&d.push(...R.map(W=>{const U={type:x};if(typeof W=="string"&&i&&!dt&&e.manuallyAnimateOnMount&&e.parent){const{parent:Q}=e,F=zc(Q,W);if(Q.enteringChildren&&F){const{delayChildren:q}=F.transition||{};U.delay=Fj(Q.enteringChildren,e,q)}}return{animation:W,options:U}}))}if(f.size){const w={};if(typeof h.initial!="boolean"){const x=zc(e,Array.isArray(h.initial)?h.initial[0]:h.initial);x&&x.transition&&(w.transition=x.transition)}f.forEach(x=>{const C=e.getBaseTarget(x),k=e.getValue(x);k&&(k.liveStyle=!0),w[x]=C??null}),d.push({animation:w})}let _=!!d.length;return i&&(h.initial===!1||h.initial===h.animate)&&!e.manuallyAnimateOnMount&&(_=!1),i=!1,_?t(d):Promise.resolve()}function a(c,h){var d;if(n[c].isActive===h)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(f=>{var v;return(v=f.animationState)==null?void 0:v.setActive(c,h)}),n[c].isActive=h;const u=o(c);for(const f in n)n[f].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=PI()}}}function vlt(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!v4(t,e):!1}function Zo(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PI(){return{animate:Zo(!0),whileInView:Zo(),whileHover:Zo(),whileTap:Zo(),whileDrag:Zo(),whileFocus:Zo(),exit:Zo()}}function MI(e,t){e.min=t.min,e.max=t.max}function nr(e,t){MI(e.x,t.x),MI(e.y,t.y)}function DI(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const y4=1e-4,ylt=1-y4,xlt=1+y4,x4=.01,_lt=0-x4,wlt=0+x4;function $n(e){return e.max-e.min}function blt(e,t,n){return Math.abs(e-t)<=n}function LI(e,t,n,i=.5){e.origin=i,e.originPoint=Ee(t.min,t.max,e.origin),e.scale=$n(n)/$n(t),e.translate=Ee(n.min,n.max,e.origin)-e.originPoint,(e.scale>=ylt&&e.scale<=xlt||isNaN(e.scale))&&(e.scale=1),(e.translate>=_lt&&e.translate<=wlt||isNaN(e.translate))&&(e.translate=0)}function Jh(e,t,n,i){LI(e.x,t.x,n.x,i?i.originX:void 0),LI(e.y,t.y,n.y,i?i.originY:void 0)}function VI(e,t,n){e.min=n.min+t.min,e.max=e.min+$n(t)}function Tlt(e,t,n){VI(e.x,t.x,n.x),VI(e.y,t.y,n.y)}function qI(e,t,n){e.min=t.min-n.min,e.max=e.min+$n(t)}function wm(e,t,n){qI(e.x,t.x,n.x),qI(e.y,t.y,n.y)}function jI(e,t,n,i,r){return e-=t,e=_m(e,1/n,i),r!==void 0&&(e=_m(e,1/r,i)),e}function Clt(e,t=0,n=1,i=.5,r,s=e,o=e){if(Hr.test(t)&&(t=parseFloat(t),t=Ee(o.min,o.max,t/100)-o.min),typeof t!="number")return;let a=Ee(s.min,s.max,i);e===s&&(a-=t),e.min=jI(e.min,t,n,a,r),e.max=jI(e.max,t,n,a,r)}function FI(e,t,[n,i,r],s,o){Clt(e,t[n],t[i],t[r],t.scale,s,o)}const klt=["x","scaleX","originX"],Nlt=["y","scaleY","originY"];function UI(e,t,n,i){FI(e.x,t,klt,n?n.x:void 0,i?i.x:void 0),FI(e.y,t,Nlt,n?n.y:void 0,i?i.y:void 0)}function OI(e){return e.translate===0&&e.scale===1}function _4(e){return OI(e.x)&&OI(e.y)}function BI(e,t){return e.min===t.min&&e.max===t.max}function Elt(e,t){return BI(e.x,t.x)&&BI(e.y,t.y)}function GI(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function w4(e,t){return GI(e.x,t.x)&&GI(e.y,t.y)}function HI(e){return $n(e.x)/$n(e.y)}function $I(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Pi(e){return[e("x"),e("y")]}function Slt(e,t,n){let i="";const r=e.x.translate/t.x,s=e.y.translate/t.y,o=(n==null?void 0:n.z)||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:h,rotate:u,rotateX:d,rotateY:f,skewX:v,skewY:y}=n;h&&(i=`perspective(${h}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),f&&(i+=`rotateY(${f}deg) `),v&&(i+=`skewX(${v}deg) `),y&&(i+=`skewY(${y}deg) `)}const a=e.x.scale*t.x,c=e.y.scale*t.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const b4=["TopLeft","TopRight","BottomLeft","BottomRight"],Ilt=b4.length,zI=e=>typeof e=="string"?parseFloat(e):e,KI=e=>typeof e=="number"||yt.test(e);function Alt(e,t,n,i,r,s){r?(e.opacity=Ee(0,n.opacity??1,Rlt(i)),e.opacityExit=Ee(t.opacity??1,0,Plt(i))):s&&(e.opacity=Ee(t.opacity??1,n.opacity??1,i));for(let o=0;o<Ilt;o++){const a=`border${b4[o]}Radius`;let c=WI(t,a),h=WI(n,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||KI(c)===KI(h)?(e[a]=Math.max(Ee(zI(c),zI(h),i),0),(Hr.test(h)||Hr.test(c))&&(e[a]+="%")):e[a]=h}(t.rotate||n.rotate)&&(e.rotate=Ee(t.rotate||0,n.rotate||0,i))}function WI(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Rlt=T4(0,.5,pj),Plt=T4(.5,.95,Hi);function T4(e,t,n){return i=>i<e?0:i>t?1:n(qu(e,t,i))}function Mlt(e,t,n){const i=Vn(e)?e:gl(e);return i.start(yT("",i,t,n)),i.animation}function Ou(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}const Dlt=(e,t)=>e.depth-t.depth;class Llt{constructor(){this.children=[],this.isDirty=!1}add(t){eT(this.children,t),this.isDirty=!0}remove(t){nT(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Dlt),this.isDirty=!1,this.children.forEach(t)}}function Vlt(e,t){const n=Hn.now(),i=({timestamp:r})=>{const s=r-n;s>=t&&(Vo(i),e(s-t))};return _e.setup(i,!0),()=>Vo(i)}function Kg(e){return Vn(e)?e.get():e}class qlt{constructor(){this.members=[]}add(t){eT(this.members,t),t.scheduleRender()}remove(t){if(nT(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(r=>t===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Wg={hasAnimatedSinceResize:!0,hasEverUpdated:!1},ky=["","X","Y","Z"],jlt=1e3;let Flt=0;function Ny(e,t,n,i){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),i&&(i[e]=0))}function C4(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Gj(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",_e,!(r||s))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&C4(i)}function k4({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=t==null?void 0:t()){this.id=Flt++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Blt),this.nodes.forEach(zlt),this.nodes.forEach(Klt),this.nodes.forEach(Glt)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Llt)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new sT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=e4(o)&&!Oct(o),this.instance=o;const{layoutId:a,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||a)&&(this.isLayoutDirty=!0),e){let u,d=0;const f=()=>this.root.updateBlockedByResize=!1;_e.read(()=>{d=window.innerWidth}),e(o,()=>{const v=window.innerWidth;v!==d&&(d=v,this.root.updateBlockedByResize=!0,u&&u(),u=Vlt(f,250),Wg.hasAnimatedSinceResize&&(Wg.hasAnimatedSinceResize=!1,this.nodes.forEach(JI)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&h&&(a||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:f,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||h.getDefaultTransition()||Xlt,{onLayoutAnimationStart:_,onLayoutAnimationComplete:w}=h.getProps(),x=!this.targetLayout||!w4(this.targetLayout,v),C=!d&&f;if(this.options.layoutRoot||this.resumeFrom||C||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...vT(y,"layout"),onPlay:_,onComplete:w};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(u,C)}else d||JI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Vo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Wlt),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&C4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(QI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(YI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach($lt),this.nodes.forEach(Ult),this.nodes.forEach(Olt)):this.nodes.forEach(YI),this.clearAllSnapshots();const a=Hn.now();wn.delta=Jr(0,1e3/60,a-wn.timestamp),wn.timestamp=a,wn.isProcessing=!0,vy.update.process(wn),vy.preRender.process(wn),vy.render.process(wn),wn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,bT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Hlt),this.sharedNodes.forEach(Qlt)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_e.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_e.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!$n(this.snapshot.measuredBox.x)&&!$n(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Ze(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!_4(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,u=h!==this.prevTransformTemplateValue;o&&this.instance&&(a||sa(this.latestValues)||u)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),Zlt(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return Ze();const a=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(tht))){const{scroll:u}=this.root;u&&(Nc(a.x,u.offset.x),Nc(a.y,u.offset.y))}return a}removeElementScroll(o){var c;const a=Ze();if(nr(a,o),(c=this.scroll)!=null&&c.wasRoot)return a;for(let h=0;h<this.path.length;h++){const u=this.path[h],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&nr(a,o),Nc(a.x,d.offset.x),Nc(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const c=Ze();nr(c,o);for(let h=0;h<this.path.length;h++){const u=this.path[h];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ec(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),sa(u.latestValues)&&Ec(c,u.latestValues)}return sa(this.latestValues)&&Ec(c,this.latestValues),c}removeTransform(o){const a=Ze();nr(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!sa(h.latestValues))continue;t_(h.latestValues)&&h.updateSnapshot();const u=Ze(),d=h.measurePageBox();nr(u,d),UI(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,u)}return sa(this.latestValues)&&UI(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var v;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==a;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!this.layout||!(u||d))return;this.resolvedRelativeTargetAt=wn.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ze(),this.targetWithTransforms=Ze()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Tlt(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nr(this.target,this.layout.layoutBox),c4(this.target,this.targetDelta)):nr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||t_(this.parent.latestValues)||a4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ze(),this.relativeTargetOrigin=Ze(),wm(this.relativeTargetOrigin,a,c),nr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var y;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(c=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===wn.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;nr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Xct(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Ze());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(DI(this.prevProjectionDelta.x,this.projectionDelta.x),DI(this.prevProjectionDelta.y,this.projectionDelta.y)),Jh(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!$I(this.projectionDelta.x,this.prevProjectionDelta.x)||!$I(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=kc(),this.projectionDelta=kc(),this.projectionDeltaWithTransform=kc()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},u={...this.latestValues},d=kc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=Ze(),v=c?c.source:void 0,y=this.layout?this.layout.source:void 0,_=v!==y,w=this.getStack(),x=!w||w.members.length<=1,C=!!(_&&!x&&this.options.crossfade===!0&&!this.path.some(Jlt));this.animationProgress=0;let k;this.mixTargetDelta=P=>{const A=P/1e3;XI(d.x,o.x,A),XI(d.y,o.y,A),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(wm(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ylt(this.relativeTarget,this.relativeTargetOrigin,f,A),k&&Elt(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Ze()),nr(k,this.relativeTarget)),_&&(this.animationValues=u,Alt(u,h,this.latestValues,A,C,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,c,h;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(h=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||h.stop(),this.pendingAnimation&&(Vo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_e.update(()=>{Wg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=gl(0)),this.currentAnimation=Mlt(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jlt),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:u}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&N4(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||Ze();const d=$n(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+d;const f=$n(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}nr(a,c),Ec(a,u),Jh(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new qlt),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&Ny("z",o,h,this.animationValues);for(let u=0;u<ky.length;u++)Ny(`rotate${ky[u]}`,o,h,this.animationValues),Ny(`skew${ky[u]}`,o,h,this.animationValues);o.render();for(const u in h)o.setStaticValue(u,h[u]),this.animationValues&&(this.animationValues[u]=h[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Kg(a==null?void 0:a.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Kg(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!sa(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=h.animationValues||h.latestValues;this.applyTransformsToTarget();let d=Slt(this.projectionDeltaWithTransform,this.treeScale,u);c&&(d=c(u,d)),o.transform=d;const{x:f,y:v}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${v.origin*100}% 0`,h.animationValues?o.opacity=h===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=h===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const y in n_){if(u[y]===void 0)continue;const{correct:_,applyTo:w,isCSSVariable:x}=n_[y],C=d==="none"?u[y]:_(u[y],h);if(w){const k=w.length;for(let P=0;P<k;P++)o[w[P]]=C}else x?this.options.visualElement.renderState.vars[y]=C:o[y]=C}this.options.layoutId&&(o.pointerEvents=h===this?Kg(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(QI),this.root.sharedNodes.clear()}}}function Ult(e){e.updateLayout()}function Olt(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=e.layout,{animationType:s}=e.options,o=t.source!==e.layout.source;s==="size"?Pi(d=>{const f=o?t.measuredBox[d]:t.layoutBox[d],v=$n(f);f.min=i[d].min,f.max=f.min+v}):N4(s,t.layoutBox,i)&&Pi(d=>{const f=o?t.measuredBox[d]:t.layoutBox[d],v=$n(i[d]);f.max=f.min+v,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+v)});const a=kc();Jh(a,i,t.layoutBox);const c=kc();o?Jh(c,e.applyTransform(r,!0),t.measuredBox):Jh(c,i,t.layoutBox);const h=!_4(a);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:v}=d;if(f&&v){const y=Ze();wm(y,t.layoutBox,f.layoutBox);const _=Ze();wm(_,i,v.layoutBox),w4(y,_)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=_,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function Blt(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Glt(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Hlt(e){e.clearSnapshot()}function QI(e){e.clearMeasurements()}function YI(e){e.isLayoutDirty=!1}function $lt(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function JI(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function zlt(e){e.resolveTargetDelta()}function Klt(e){e.calcProjection()}function Wlt(e){e.resetSkewAndRotation()}function Qlt(e){e.removeLeadSnapshot()}function XI(e,t,n){e.translate=Ee(t.translate,0,n),e.scale=Ee(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function ZI(e,t,n,i){e.min=Ee(t.min,n.min,i),e.max=Ee(t.max,n.max,i)}function Ylt(e,t,n,i){ZI(e.x,t.x,n.x,i),ZI(e.y,t.y,n.y,i)}function Jlt(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Xlt={duration:.45,ease:[.4,0,.1,1]},tA=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),eA=tA("applewebkit/")&&!tA("chrome/")?Math.round:Hi;function nA(e){e.min=eA(e.min),e.max=eA(e.max)}function Zlt(e){nA(e.x),nA(e.y)}function N4(e,t,n){return e==="position"||e==="preserve-aspect"&&!blt(HI(t),HI(n),.2)}function tht(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const eht=k4({attachResizeListener:(e,t)=>Ou(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ey={current:void 0},E4=k4({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ey.current){const e=new eht({});e.mount(window),e.setOptions({layoutScroll:!0}),Ey.current=e}return Ey.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),ST=I.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function iA(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function nht(...e){return t=>{let n=!1;const i=e.map(r=>{const s=iA(r,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():iA(e[r],null)}}}}function iht(...e){return I.useCallback(nht(...e),e)}class rht extends I.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const i=n.offsetParent,r=Yj(i)&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function sht({children:e,isPresent:t,anchorX:n,root:i}){var u;const r=I.useId(),s=I.useRef(null),o=I.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=I.useContext(ST),c=((u=e.props)==null?void 0:u.ref)??(e==null?void 0:e.ref),h=iht(s,c);return I.useInsertionEffect(()=>{const{width:d,height:f,top:v,left:y,right:_}=o.current;if(t||!s.current||!d||!f)return;const w=n==="left"?`left: ${y}`:`right: ${_}`;s.current.dataset.motionPopId=r;const x=document.createElement("style");a&&(x.nonce=a);const C=i??document.head;return C.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${f}px !important;
            ${w}px !important;
            top: ${v}px !important;
          }
        `),()=>{C.contains(x)&&C.removeChild(x)}},[t]),l.jsx(rht,{isPresent:t,childRef:s,sizeRef:o,children:I.cloneElement(e,{ref:h})})}const oht=({children:e,initial:t,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o,anchorX:a,root:c})=>{const h=tT(aht),u=I.useId();let d=!0,f=I.useMemo(()=>(d=!1,{id:u,initial:t,isPresent:n,custom:r,onExitComplete:v=>{h.set(v,!0);for(const y of h.values())if(!y)return;i&&i()},register:v=>(h.set(v,!1),()=>h.delete(v))}),[n,h,i]);return s&&d&&(f={...f}),I.useMemo(()=>{h.forEach((v,y)=>h.set(y,!1))},[n]),I.useEffect(()=>{!n&&!h.size&&i&&i()},[n]),o==="popLayout"&&(e=l.jsx(sht,{isPresent:n,anchorX:a,root:c,children:e})),l.jsx(Gp.Provider,{value:f,children:e})};function aht(){return new Map}function S4(e=!0){const t=I.useContext(Gp);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=t,s=I.useId();I.useEffect(()=>{if(e)return r(s)},[e]);const o=I.useCallback(()=>e&&i&&i(s),[s,i,e]);return!n&&i?[!1,o]:[!0]}const pg=e=>e.key||"";function rA(e){const t=[];return I.Children.forEach(e,n=>{I.isValidElement(n)&&t.push(n)}),t}const cht=({children:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1,anchorX:a="left",root:c})=>{const[h,u]=S4(o),d=I.useMemo(()=>rA(e),[e]),f=o&&!h?[]:d.map(pg),v=I.useRef(!0),y=I.useRef(d),_=tT(()=>new Map),w=I.useRef(new Set),[x,C]=I.useState(d),[k,P]=I.useState(d);sj(()=>{v.current=!1,y.current=d;for(let N=0;N<k.length;N++){const T=pg(k[N]);f.includes(T)?(_.delete(T),w.current.delete(T)):_.get(T)!==!0&&_.set(T,!1)}},[k,f.length,f.join("-")]);const A=[];if(d!==x){let N=[...d];for(let T=0;T<k.length;T++){const E=k[T],R=pg(E);f.includes(R)||(N.splice(T,0,E),A.push(E))}return s==="wait"&&A.length&&(N=A),P(rA(N)),C(d),null}const{forceRender:M}=I.useContext(Zb);return l.jsx(l.Fragment,{children:k.map(N=>{const T=pg(N),E=o&&!h?!1:d===k||f.includes(T),R=()=>{if(w.current.has(T))return;if(w.current.add(T),_.has(T))_.set(T,!0);else return;let D=!0;_.forEach(j=>{j||(D=!1)}),D&&(M==null||M(),P(y.current),o&&(u==null||u()),i&&i())};return l.jsx(oht,{isPresent:E,initial:!v.current||n?void 0:!1,custom:t,presenceAffectsLayout:r,mode:s,root:c,onExitComplete:E?void 0:R,anchorX:a,children:N},T)})})},I4=I.createContext({strict:!1}),sA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let oA=!1;function lht(){if(oA)return;const e={};for(const t in sA)e[t]={isEnabled:n=>sA[t].some(i=>!!n[i])};r4(e),oA=!0}function A4(){return lht(),Wct()}function hht(e){const t=A4();for(const n in e)t[n]={...t[n],...e[n]};r4(t)}const uht=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function bm(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||uht.has(e)}let R4=e=>!bm(e);function dht(e){typeof e=="function"&&(R4=t=>t.startsWith("on")?!bm(t):e(t))}try{dht(require("@emotion/is-prop-valid").default)}catch{}function ght(e,t,n){const i={};for(const r in e)r==="values"&&typeof e.values=="object"||(R4(r)||n===!0&&bm(r)||!t&&!bm(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}const zp=I.createContext({});function fht(e,t){if($p(e)){const{initial:n,animate:i}=e;return{initial:n===!1||Uu(n)?n:void 0,animate:Uu(i)?i:void 0}}return e.inherit!==!1?t:{}}function mht(e){const{initial:t,animate:n}=fht(e,I.useContext(zp));return I.useMemo(()=>({initial:t,animate:n}),[aA(t),aA(n)])}function aA(e){return Array.isArray(e)?e.join(" "):e}const IT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function P4(e,t,n){for(const i in t)!Vn(t[i])&&!u4(i,n)&&(e[i]=t[i])}function pht({transformTemplate:e},t){return I.useMemo(()=>{const n=IT();return NT(n,t,e),Object.assign({},n.vars,n.style)},[t])}function vht(e,t){const n=e.style||{},i={};return P4(i,n,e),Object.assign(i,pht(e,t)),i}function yht(e,t){const n={},i=vht(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const M4=()=>({...IT(),attrs:{}});function xht(e,t,n,i){const r=I.useMemo(()=>{const s=M4();return d4(s,t,f4(i),e.transformTemplate,e.style),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};P4(s,e.style,e),r.style={...s,...r.style}}return r}const _ht=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function AT(e){return typeof e!="string"||e.includes("-")?!1:!!(_ht.indexOf(e)>-1||/[A-Z]/u.test(e))}function wht(e,t,n,{latestValues:i},r,s=!1,o){const c=(o??AT(e)?xht:yht)(t,i,r,e),h=ght(t,typeof e=="string",s),u=e!==I.Fragment?{...h,...c,ref:n}:{},{children:d}=t,f=I.useMemo(()=>Vn(d)?d.get():d,[d]);return I.createElement(e,{...u,children:f})}function bht({scrapeMotionValuesFromProps:e,createRenderState:t},n,i,r){return{latestValues:Tht(n,i,r,e),renderState:t()}}function Tht(e,t,n,i){const r={},s=i(e,{});for(const f in s)r[f]=Kg(s[f]);let{initial:o,animate:a}=e;const c=$p(e),h=i4(e);t&&h&&!c&&e.inherit!==!1&&(o===void 0&&(o=t.initial),a===void 0&&(a=t.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!Hp(d)){const f=Array.isArray(d)?d:[d];for(let v=0;v<f.length;v++){const y=xT(e,f[v]);if(y){const{transitionEnd:_,transition:w,...x}=y;for(const C in x){let k=x[C];if(Array.isArray(k)){const P=u?k.length-1:0;k=k[P]}k!==null&&(r[C]=k)}for(const C in _)r[C]=_[C]}}}return r}const D4=e=>(t,n)=>{const i=I.useContext(zp),r=I.useContext(Gp),s=()=>bht(e,t,i,r);return n?s():tT(s)},Cht=D4({scrapeMotionValuesFromProps:ET,createRenderState:IT}),kht=D4({scrapeMotionValuesFromProps:m4,createRenderState:M4}),Nht=Symbol.for("motionComponentSymbol");function Eht(e,t,n){const i=I.useRef(n);I.useInsertionEffect(()=>{i.current=n});const r=I.useRef(null);return I.useCallback(s=>{var a;s&&((a=e.onMount)==null||a.call(e,s)),t&&(s?t.mount(s):t.unmount());const o=i.current;if(typeof o=="function")if(s){const c=o(s);typeof c=="function"&&(r.current=c)}else r.current?(r.current(),r.current=null):o(s);else o&&(o.current=s)},[t])}const L4=I.createContext({});function Nh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Sht(e,t,n,i,r,s){var w,x;const{visualElement:o}=I.useContext(zp),a=I.useContext(I4),c=I.useContext(Gp),h=I.useContext(ST).reducedMotion,u=I.useRef(null);i=i||a.renderer,!u.current&&i&&(u.current=i(e,{visualState:t,parent:o,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h,isSVG:s}));const d=u.current,f=I.useContext(L4);d&&!d.projection&&r&&(d.type==="html"||d.type==="svg")&&Iht(u.current,n,r,f);const v=I.useRef(!1);I.useInsertionEffect(()=>{d&&v.current&&d.update(n,c)});const y=n[Bj],_=I.useRef(!!y&&!((w=window.MotionHandoffIsComplete)!=null&&w.call(window,y))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,y)));return sj(()=>{d&&(v.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),_.current&&d.animationState&&d.animationState.animateChanges())}),I.useEffect(()=>{d&&(!_.current&&d.animationState&&d.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)==null||C.call(window,y)}),_.current=!1),d.enteringChildren=void 0)}),d}function Iht(e,t,n,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:V4(e.parent)),e.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Nh(a),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:c,layoutRoot:h})}function V4(e){if(e)return e.options.allowProjection!==!1?e.projection:V4(e.parent)}function Sy(e,{forwardMotionProps:t=!1,type:n}={},i,r){i&&hht(i);const s=n?n==="svg":AT(e),o=s?kht:Cht;function a(h,u){let d;const f={...I.useContext(ST),...h,layoutId:Aht(h)},{isStatic:v}=f,y=mht(h),_=o(h,v);if(!v&&rj){Rht();const w=Pht(f);d=w.MeasureLayout,y.visualElement=Sht(e,_,f,r,w.ProjectionNode,s)}return l.jsxs(zp.Provider,{value:y,children:[d&&y.visualElement?l.jsx(d,{visualElement:y.visualElement,...f}):null,wht(e,h,Eht(_,y.visualElement,u),_,v,t,s)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=I.forwardRef(a);return c[Nht]=e,c}function Aht({layoutId:e}){const t=I.useContext(Zb).id;return t&&e!==void 0?t+"-"+e:e}function Rht(e,t){I.useContext(I4).strict}function Pht(e){const t=A4(),{drag:n,layout:i}=t;if(!n&&!i)return{};const r={...n,...i};return{MeasureLayout:n!=null&&n.isEnabled(e)||i!=null&&i.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Mht(e,t){if(typeof Proxy>"u")return Sy;const n=new Map,i=(s,o)=>Sy(s,o,e,t),r=(s,o)=>i(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?i:(n.has(o)||n.set(o,Sy(o,void 0,e,t)),n.get(o))})}const Dht=(e,t)=>t.isSVG??AT(e)?new ult(t):new slt(t,{allowProjection:e!==I.Fragment});class Lht extends zo{constructor(t){super(t),t.animationState||(t.animationState=plt(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Hp(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Vht=0;class qht extends zo{constructor(){super(...arguments),this.id=Vht++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const r=this.node.animationState.setActive("exit",!t);n&&!t&&r.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const jht={animation:{Feature:Lht},exit:{Feature:qht}};function _d(e){return{point:{x:e.pageX,y:e.pageY}}}const Fht=e=>t=>TT(t)&&e(t,_d(t));function Xh(e,t,n,i){return Ou(e,t,Fht(n),i)}const q4=({current:e})=>e?e.ownerDocument.defaultView:null,cA=(e,t)=>Math.abs(e-t);function Uht(e,t){const n=cA(e.x,t.x),i=cA(e.y,t.y);return Math.sqrt(n**2+i**2)}const lA=new Set(["auto","scroll"]);class j4{constructor(t,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=v=>{this.handleScroll(v.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Ay(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,_=Uht(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!_)return;const{point:w}=v,{timestamp:x}=wn;this.history.push({...w,timestamp:x});const{onStart:C,onMove:k}=this.handlers;y||(C&&C(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,v)},this.handlePointerMove=(v,y)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=Iy(y,this.transformPagePoint),_e.update(this.updatePoint,!0)},this.handlePointerUp=(v,y)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:x}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=Ay(v.type==="pointercancel"?this.lastMoveEventInfo:Iy(y,this.transformPagePoint),this.history);this.startEvent&&_&&_(v,C),w&&w(v,C)},!TT(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const c=_d(t),h=Iy(c,this.transformPagePoint),{point:u}=h,{timestamp:d}=wn;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=n;f&&f(t,Ay(h,this.history)),this.removeListeners=vd(Xh(this.contextWindow,"pointermove",this.handlePointerMove),Xh(this.contextWindow,"pointerup",this.handlePointerUp),Xh(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(t){let n=t.parentElement;for(;n;){const i=getComputedStyle(n);(lA.has(i.overflowX)||lA.has(i.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const n=this.scrollPositions.get(t);if(!n)return;const i=t===window,r=i?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s={x:r.x-n.x,y:r.y-n.y};s.x===0&&s.y===0||(i?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s.x,this.lastMoveEventInfo.point.y+=s.y):this.history.length>0&&(this.history[0].x-=s.x,this.history[0].y-=s.y),this.scrollPositions.set(t,r),_e.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Vo(this.updatePoint)}}function Iy(e,t){return t?{point:t(e.point)}:e}function hA(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ay({point:e},t){return{point:e,delta:hA(e,F4(t)),offset:hA(e,Oht(t)),velocity:Bht(t,.1)}}function Oht(e){return e[0]}function F4(e){return e[e.length-1]}function Bht(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=F4(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>vs(t)));)n--;if(!i)return{x:0,y:0};const s=Fi(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Ght(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?Ee(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?Ee(n,e,i.max):Math.min(e,n)),e}function uA(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function Hht(e,{top:t,left:n,bottom:i,right:r}){return{x:uA(e.x,n,r),y:uA(e.y,t,i)}}function dA(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function $ht(e,t){return{x:dA(e.x,t.x),y:dA(e.y,t.y)}}function zht(e,t){let n=.5;const i=$n(e),r=$n(t);return r>i?n=qu(t.min,t.max-i,e.min):i>r&&(n=qu(e.min,e.max-r,t.min)),Jr(0,1,n)}function Kht(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const i_=.35;function Wht(e=i_){return e===!1?e=0:e===!0&&(e=i_),{x:gA(e,"left","right"),y:gA(e,"top","bottom")}}function gA(e,t,n){return{min:fA(e,t),max:fA(e,n)}}function fA(e,t){return typeof e=="number"?e:e[t]||0}const Qht=new WeakMap;class Yht{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ze(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{n?(this.stopAnimation(),this.snapToCursor(_d(d).point)):this.pauseAnimation()},o=(d,f)=>{this.stopAnimation();const{drag:v,dragPropagation:y,onDragStart:_}=this.getProps();if(v&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Vct(v),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Pi(x=>{let C=this.getAxisMotionValue(x).get()||0;if(Hr.test(C)){const{projection:k}=this.visualElement;if(k&&k.layout){const P=k.layout.layoutBox[x];P&&(C=$n(P)*(parseFloat(C)/100))}}this.originPoint[x]=C}),_&&_e.postRender(()=>_(d,f)),Y0(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},a=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f;const{dragPropagation:v,dragDirectionLock:y,onDirectionLock:_,onDrag:w}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:x}=f;if(y&&this.currentDirection===null){this.currentDirection=Jht(x),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",f.point,x),this.updateAxis("y",f.point,x),this.visualElement.render(),w&&w(d,f)},c=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f,this.stop(d,f),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>Pi(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new j4(t,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:q4(this.visualElement),element:this.visualElement.current})}stop(t,n){const i=t||this.latestPointerEvent,r=n||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&_e.postRender(()=>a(i,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,i){const{drag:r}=this.getProps();if(!i||!vg(t,r,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(o=Ght(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,r=this.constraints;t&&Nh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Hht(i.layoutBox,t):this.constraints=!1,this.elastic=Wht(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Pi(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Kht(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Nh(t))return!1;const i=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Zct(i,r.root,this.visualElement.getTransformPagePoint());let o=$ht(r.layout.layoutBox,s);if(n){const a=n(Yct(o));this.hasMutatedConstraints=!!a,a&&(o=o4(a))}return o}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=Pi(u=>{if(!vg(u,n,this.currentDirection))return;let d=c&&c[u]||{};o&&(d={min:0,max:0});const f=r?200:1e6,v=r?40:1e7,y={type:"inertia",velocity:i?t[u]:0,bounceStiffness:f,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(h).then(a)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return Y0(this.visualElement,t),i.start(yT(t,i,0,n,this.visualElement,!1))}stopAnimation(){Pi(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Pi(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Pi(n=>{const{drag:i}=this.getProps();if(!vg(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n],c=s.get()||0;s.set(t[n]-Ee(o,a,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Nh(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Pi(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=zht({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Pi(o=>{if(!vg(o,t,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(Ee(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;Qht.set(this.visualElement,this);const t=this.visualElement.current,n=Xh(t,"pointerdown",c=>{const{drag:h,dragListener:u=!0}=this.getProps();h&&u&&!t4(c.target)&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Nh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),_e.read(i);const o=Ou(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(Pi(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=c[u].translate,d.set(d.get()+c[u].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=i_,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function vg(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function Jht(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class Xht extends zo{constructor(t){super(t),this.removeGroupControls=Hi,this.removeListeners=Hi,this.controls=new Yht(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Hi}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const mA=e=>(t,n)=>{e&&_e.postRender(()=>e(t,n))};class Zht extends zo{constructor(){super(...arguments),this.removePointerDownListener=Hi}onPointerDown(t){this.session=new j4(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:q4(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:mA(t),onStart:mA(n),onMove:i,onEnd:(s,o)=>{delete this.session,r&&_e.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Xh(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Ry=!1;class tut extends I.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=t;s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),Ry&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Wg.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,{projection:o}=i;return o&&(o.isPresent=s,Ry=!0,r||t.layoutDependency!==n||n===void 0||t.isPresent!==s?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||_e.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),bT.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=t;Ry=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function U4(e){const[t,n]=S4(),i=I.useContext(Zb);return l.jsx(tut,{...e,layoutGroup:i,switchLayoutGroup:I.useContext(L4),isPresent:t,safeToRemove:n})}const eut={pan:{Feature:Zht},drag:{Feature:Xht,ProjectionNode:E4,MeasureLayout:U4}};function pA(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,s=i[r];s&&_e.postRender(()=>s(t,_d(t)))}class nut extends zo{mount(){const{current:t}=this.node;t&&(this.unmount=qct(t,(n,i)=>(pA(this.node,i,"Start"),r=>pA(this.node,r,"End"))))}unmount(){}}class iut extends zo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=vd(Ou(this.node.current,"focus",()=>this.onFocus()),Ou(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function vA(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),s=i[r];s&&_e.postRender(()=>s(t,_d(t)))}class rut extends zo{mount(){const{current:t}=this.node;t&&(this.unmount=Uct(t,(n,i)=>(vA(this.node,i,"Start"),(r,{success:s})=>vA(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const r_=new WeakMap,Py=new WeakMap,sut=e=>{const t=r_.get(e.target);t&&t(e)},out=e=>{e.forEach(sut)};function aut({root:e,...t}){const n=e||document;Py.has(n)||Py.set(n,{});const i=Py.get(n),r=JSON.stringify(t);return i[r]||(i[r]=new IntersectionObserver(out,{root:e,...t})),i[r]}function cut(e,t,n){const i=aut(t);return r_.set(e,n),i.observe(e),()=>{r_.delete(e),i.unobserve(e)}}const lut={some:0,all:1};class hut extends zo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=t,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:lut[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=h?u:d;f&&f(c)};return cut(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(uut(t,n))&&this.startObserver()}unmount(){}}function uut({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const dut={inView:{Feature:hut},tap:{Feature:rut},focus:{Feature:iut},hover:{Feature:nut}},gut={layout:{ProjectionNode:E4,MeasureLayout:U4}},fut={...jht,...dut,...eut,...gut},Ge=Mht(fut,Dht);function mut(e){return Math.max(...e.map(t=>t.cardScarcity))}function put({isOpen:e,onClose:t,results:n,isLoading:i,skipLoading:r=!1}){const[s,o]=I.useState(0),[a,c]=I.useState(!1),[h,u]=I.useState("loading"),[d,f]=I.useState({}),[v,y]=I.useState(!1),[_,w]=I.useState(!1),[x,C]=I.useState(!1);I.useEffect(()=>{e&&i&&(u("loading"),w(!1),y(!1),C(!0),c(!1),o(0),f({})),e&&r&&n.length>0&&!i&&(u("reveal"),c(!1),o(0),f({}))},[e,i]),I.useEffect(()=>{e||(u("loading"),w(!1),y(!1),C(!1),c(!1),o(0),f({}))},[e]),I.useEffect(()=>{if(x&&h==="loading"){const E=setTimeout(()=>y(!0),1e3),R=setTimeout(()=>w(!0),2e3);return()=>{clearTimeout(E),clearTimeout(R)}}},[x,h]),I.useEffect(()=>{e&&n.length>0&&!i&&_&&h==="loading"&&u("reveal")},[e,n,i,_,h]);const k=()=>{w(!0)},P=()=>{s<n.length-1?o(s+1):(c(!0),u("done"))},A=()=>{const E=n.findIndex((R,D)=>D>s&&R.cardScarcity===40&&R.isNew);E!==-1?o(E):(c(!0),u("done"))};if(!e)return null;const M=n[s],N=(M==null?void 0:M.cardScarcity)===40,T=n.length>0?mut(n):10;return l.jsx(cht,{children:l.jsxs(Ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[200] bg-black/90 flex items-center justify-center",onClick:E=>E.stopPropagation(),children:[h==="loading"&&v&&!i&&l.jsx("button",{onClick:k,className:"absolute top-20 right-4 px-4 py-2 rounded-xl bg-white/10 z-10 text-white text-sm font-medium",children:"B qua"}),h==="reveal"&&n.length>1&&l.jsx("button",{onClick:A,className:"absolute top-20 right-4 px-4 py-2 rounded-xl bg-white/10 z-10 text-white text-sm font-medium",children:"B qua"}),h==="loading"&&l.jsxs(Ge.div,{initial:{opacity:1},animate:{opacity:1},className:"absolute inset-0 flex flex-col items-center justify-center",children:[l.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${mt(T)}30 0%, transparent 70%)`}}),l.jsx(Ge.div,{animate:{rotate:360},transition:{duration:3,repeat:1/0,ease:"linear"},className:"w-32 h-32 rounded-full border-4",style:{borderColor:`${mt(T)}`,borderTopColor:"transparent",borderRightColor:`${mt(T)}60`}}),l.jsx(Ge.div,{animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 flex items-center justify-center",children:l.jsx(me,{className:"w-10 h-10",style:{color:mt(T)},fill:mt(T)})})]}),l.jsx("p",{className:"text-white mt-6 text-lg",children:"ang quay..."}),(T===40||T===30)&&l.jsxs(Ge.p,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"mt-2 text-sm font-bold",style:{color:mt(T)},children:[T===40&&"C th UR!",T===30&&"C th SR!"]})]}),h==="reveal"&&M&&!a&&l.jsxs(Ge.div,{className:"flex flex-col items-center px-4 perspective-1000",onClick:P,children:[l.jsx(Ge.div,{initial:{opacity:0,scale:.5},animate:{opacity:N?.9:M.cardScarcity===30?.7:.5,scale:1},transition:{duration:.5},className:`absolute rounded-full blur-3xl ${N?"w-[400px] h-[400px]":M.cardScarcity===30?"w-[350px] h-[350px]":"w-72 h-72"}`,style:{backgroundColor:mt(M.cardScarcity)+(N?"70":M.cardScarcity===30?"60":"40")}}),l.jsxs("div",{className:"relative",children:[N&&l.jsx(Ge.div,{animate:{opacity:[.4,.8,.4],scale:[1,1.02,1]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"absolute -inset-2 rounded-2xl pointer-events-none",style:{background:`linear-gradient(45deg, ${mt(40)}60, ${mt(40)}30, ${mt(40)}60)`,filter:"blur(8px)"}}),M.cardScarcity===30&&l.jsx(Ge.div,{animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute -inset-1.5 rounded-2xl pointer-events-none",style:{background:`linear-gradient(45deg, ${mt(30)}50, ${mt(30)}20, ${mt(30)}50)`,filter:"blur(6px)"}}),l.jsxs(Ge.div,{initial:{rotateY:180,scale:.8},animate:{rotateY:0,scale:1},transition:{type:"spring",stiffness:100,damping:15,duration:.8},className:"relative rounded-2xl overflow-hidden border-4 shadow-2xl max-w-[280px] min-h-[300px] bg-gradient-to-b from-gray-800 to-gray-900",style:{borderColor:mt(M.cardScarcity),aspectRatio:M.width&&M.height?M.width/M.height:2/3,transformStyle:"preserve-3d",boxShadow:`0 0 ${N?"60px":"30px"} ${mt(M.cardScarcity)}${N?"80":"50"}`},children:[l.jsx(Ge.div,{className:"absolute inset-0 z-20 pointer-events-none",initial:{x:"-100%",opacity:0},animate:{x:"200%",opacity:[0,.5,0]},transition:{duration:1,delay:.3},style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)",transform:"skewX(-20deg)"}}),ja(M.videoList)&&!d[s]?l.jsx("video",{className:"w-full h-full object-contain",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,poster:Ne(M.cardImg,400),onError:()=>f(E=>({...E,[s]:!0})),children:l.jsx("source",{src:M.videoList[1],type:"video/mp4"})},M.videoList[1]):l.jsx("img",{src:Ne(M.cardImg,400),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer",loading:"eager",decoding:"sync",onError:E=>{const R=E.target;R.src.includes("@")&&(R.src=M.cardImg)}}),M.isNew&&l.jsx(Ge.div,{initial:{scale:0,rotate:-15},animate:{scale:1,rotate:0},transition:{type:"spring",delay:.5},className:"absolute top-2 left-2 px-3 py-1 bg-[var(--duo-green)] text-white text-xs font-bold rounded-full shadow-lg",children:"MI!"}),M.shardsGained>0&&l.jsxs(Ge.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"absolute top-2 right-2 px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded-full flex items-center gap-1 shadow-lg",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-4 h-4"}),"+",M.shardsGained]})]})]}),l.jsxs(Ge.div,{initial:{y:30,opacity:0,scale:.8},animate:{y:0,opacity:1,scale:1},transition:{delay:.4,type:"spring",stiffness:200},className:"mt-5 flex items-center gap-2",children:[l.jsx(Ge.div,{animate:N?{rotate:[0,360]}:{},transition:{duration:3,repeat:1/0,ease:"linear"},children:l.jsx(me,{className:N?"w-8 h-8":"w-6 h-6",style:{color:mt(M.cardScarcity)},fill:mt(M.cardScarcity)})}),l.jsx(Ge.span,{animate:N?{scale:[1,1.05,1]}:{},transition:{duration:1,repeat:1/0},className:`font-bold ${N?"text-3xl":"text-2xl"}`,style:{color:mt(M.cardScarcity)},children:fr(M.cardScarcity)}),N&&l.jsx(Ge.div,{animate:{rotate:[0,-360]},transition:{duration:3,repeat:1/0,ease:"linear"},children:l.jsx(me,{className:"w-8 h-8",style:{color:mt(M.cardScarcity)},fill:mt(M.cardScarcity)})})]}),l.jsxs(Ge.p,{initial:{opacity:0},animate:{opacity:[.3,.8,.3]},transition:{duration:1.5,repeat:1/0},className:"text-white/70 mt-4 text-sm",children:["Chm  tip tc (",s+1,"/",n.length,")"]})]},s),a&&l.jsxs(Ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full h-full flex flex-col",children:[l.jsxs("h2",{className:"text-white text-xl font-bold text-center pt-16 pb-4 flex items-center justify-center gap-2 flex-shrink-0",children:[l.jsx(Xt,{className:"w-6 h-6 text-[var(--duo-yellow)]"}),"Kt qu (",n.length," th)"]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-2 max-w-md mx-auto",children:n.map((E,R)=>l.jsxs(Ge.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:R*.05},className:`relative aspect-[2/3] rounded-xl overflow-hidden border-2 ${E.cardScarcity===40?"ring-2 ring-yellow-400/50":""}`,style:{borderColor:mt(E.cardScarcity)},children:[l.jsx("img",{src:Ne(E.cardImg,200),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer",crossOrigin:"anonymous",onError:D=>{const j=D.target;j.src.includes("@")&&(j.src=E.cardImg)}}),E.isNew&&l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 bg-[var(--duo-green)] text-white text-[10px] font-bold rounded",children:"MI"}),E.shardsGained>0&&l.jsxs("div",{className:"absolute top-1 right-1 px-1.5 py-0.5 bg-purple-500 text-white text-[10px] font-bold rounded flex items-center gap-0.5",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-3 h-3"}),"+",E.shardsGained]})]},R))})}),l.jsx("div",{className:"flex-shrink-0 p-4 bg-black/50",children:l.jsx("button",{onClick:t,className:"w-full max-w-md mx-auto block btn-3d btn-3d-purple py-3",children:"ng"})})]})]})})}function vut({isOpen:e,onClose:t,collectionId:n,urCards:i,inventory:r,userId:s,onExchangeSuccess:o}){const[a,c]=I.useState(null),[h,u]=I.useState(!1);if(!e)return null;const d=(r==null?void 0:r.shards)||0,f=cn.UR_EXCHANGE_COST,v=d>=f,y=i.filter(w=>{var x;return!((x=r==null?void 0:r.cards[n])!=null&&x[w.card_img])}),_=async()=>{if(!a||!v||h)return;u(!0);const w=await Rot(s,n,a.card_img);if(w.success){const x=a;c(null),t(),o(x)}else alert(w.error||"C li xy ra!");u(!1)};return l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:t,children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:w=>w.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("button",{onClick:t,className:"w-10 h-10 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"text-center",children:[l.jsxs("h2",{className:"font-bold text-lg flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"i mnh ly th UR"]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn th UR bn mun s hu"})]}),l.jsxs("button",{onClick:_,disabled:!a||!v||h,className:`btn-3d px-4 py-2 rounded-xl text-sm font-bold text-white flex items-center gap-1.5 ${a&&v?"btn-3d-yellow":"btn-3d-gray opacity-60"}`,children:[l.jsx(Rn,{className:"w-4 h-4"}),"i"]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-8 h-8"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Mnh hin c"}),l.jsx("p",{className:"font-bold text-lg",children:Dn(d)})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chi ph i"}),l.jsx("p",{className:"font-bold text-lg text-[var(--duo-yellow)]",children:Dn(f)})]})]}),!v&&a&&l.jsxs("p",{className:"text-center text-xs text-[var(--duo-red)] mt-2 pt-2 border-t border-[var(--border)]",children:["Khng  mnh! Cn thm ",Dn(f-d)," ","mnh"]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:y.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(me,{className:"w-10 h-10 text-[var(--duo-yellow)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)] font-medium",children:"Bn  s hu tt c th UR!"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Hy th b su tp khc nh"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-3",children:y.map((w,x)=>{const C=(a==null?void 0:a.card_img)===w.card_img,k=ja(w.video_list);return l.jsxs("button",{onClick:()=>c(C?null:w),className:`relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all shadow-md hover:shadow-lg ${C?"ring-2 ring-[var(--duo-yellow)] shadow-[var(--duo-yellow)]/30":""}`,style:{borderColor:mt(w.card_scarcity)},children:[l.jsx("img",{src:Co(w.card_img,200),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),k&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 py-1 text-center text-[10px] font-bold text-white",style:{backgroundColor:mt(w.card_scarcity)},children:fr(w.card_scarcity)}),C&&l.jsx("div",{className:"absolute inset-0 bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--duo-yellow)] flex items-center justify-center shadow-lg",children:l.jsx(Rn,{className:"w-6 h-6 text-white"})})})]},x)})})})]})})}function yut(){var ct,vt,Rt,ht;const{id:e}=JP(),t=we(),[n]=oM(),{user:i}=te(),r=n.get("tab")||"all",s=n.get("page")||"1",o=()=>t(`/gacha?tab=${r}&page=${s}`),[a,c]=I.useState(null),[h,u]=I.useState([]),[d,f]=I.useState(!0),[v,y]=I.useState(null),[_,w]=I.useState(0),[x,C]=I.useState(null),[k,P]=I.useState(null),[A,M]=I.useState(!1),[N,T]=I.useState([]),[E,R]=I.useState(!1),[D,j]=I.useState(!1),[L,lt]=I.useState(!1),[dt,Y]=I.useState(!1),[W,U]=I.useState(!1),Q=e?parseInt(e):0;I.useEffect(()=>{if(k){const st=Aot(k,Q);lt(st)}},[k,Q]),I.useEffect(()=>{e&&q(parseInt(e))},[e]),I.useEffect(()=>{i!=null&&i.oderId&&F()},[i==null?void 0:i.oderId]);const F=async()=>{if(!(i!=null&&i.oderId))return;const st=await Wa(i.oderId);P(st)},q=async st=>{try{f(!0),y(null);const[Tt,Nt]=await Promise.all([ej(st),Vu(st)]);if(!Tt){y("Khng tm thy b su tp");return}c(Tt),u(Nt)}catch(Tt){console.error("Fetch error:",Tt),y("Khng th ti d liu")}finally{f(!1)}},$=async st=>{if(!i||!H)return;const Tt=cn.COST_PER_PULL*st;if(i.gems<Tt){alert("Khng  Gems!");return}M(!0),R(!0),T([]);const Nt=await Eot(i.oderId,Q,H,st,i.gems);Nt.success?(T(Nt.results),await F(),te.setState(Jt=>({user:Jt.user?{...Jt.user,gems:Nt.newGems}:null}))):(alert(Nt.error||"C li xy ra!"),R(!1)),M(!1)},H=h[_],X=(ct=H==null?void 0:H.item_list)==null?void 0:ct.reduce((st,Tt)=>{const Nt=Tt.card_scarcity;return st[Nt]||(st[Nt]=[]),st[Nt].push(Tt),st},{}),tt=X?Object.keys(X).map(Number).sort((st,Tt)=>Tt-st):[],O=k!=null&&k.cards[Q]?Object.keys(k.cards[Q]).length:0,B=((vt=H==null?void 0:H.item_list)==null?void 0:vt.length)||0,nt=B>0&&O>=B,K=()=>{var Jt,Et,Gt,yn;if(!H)return[];const st=[3,1001,1e3],Tt=((Et=(Jt=H.collect_list)==null?void 0:Jt.collect_infos)==null?void 0:Et.filter(oe=>st.includes(oe.redeem_item_type||0)))||[],Nt=((yn=(Gt=H.collect_list)==null?void 0:Gt.collect_chain)==null?void 0:yn.filter(oe=>st.includes(oe.redeem_item_type||0)))||[];return[...Tt,...Nt]},at=async()=>{if(!(i!=null&&i.oderId))return;const st=K();if(await Iot(i.oderId,Q,st)){lt(!0);const Jt=Date.now()+3e3,Et=()=>{Se({particleCount:7,angle:60,spread:55,origin:{x:0},colors:["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#DDA0DD"]}),Se({particleCount:7,angle:120,spread:55,origin:{x:1},colors:["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#DDA0DD"]}),Date.now()<Jt&&requestAnimationFrame(Et)};Et(),j(!0),await F()}};return d?l.jsx(se,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[l.jsx(qi,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]})}):v||!a?l.jsx(se,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen px-4",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:v}),l.jsx("button",{onClick:o,className:"btn-3d btn-3d-purple px-4 py-2",children:"Quay li"})]})}):l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:o,className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Chi tit b su tp"})]})}),l.jsxs("div",{className:"pt-28 pb-32 px-4",children:[l.jsx("div",{className:"card-3d overflow-hidden mb-4",children:l.jsx("img",{src:Ne(a.act_square_img,800),alt:"Banner",className:"w-full h-auto",referrerPolicy:"no-referrer"})}),l.jsx("div",{className:"card-3d p-3 mb-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-5 h-5"}),l.jsx("span",{className:"font-bold text-[var(--duo-blue)]",children:Dn((i==null?void 0:i.gems)||0)}),l.jsx("span",{className:"text-sm text-[var(--muted-foreground)]",children:"Gems"})]})}),l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium",children:"Tin  su tp"}),l.jsxs("span",{className:"text-sm font-bold text-[var(--duo-purple)]",children:[O,"/",B]})]}),l.jsx("div",{className:"h-2 bg-[var(--secondary)] rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] transition-all",style:{width:`${B>0?O/B*100:0}%`}})})]}),l.jsxs("div",{className:"card-3d p-3 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"text-sm font-medium",children:"T l ri"}),k&&l.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Bo him:"}),l.jsxs("span",{className:"font-bold text-[var(--duo-yellow)]",children:[k.pityCounters[0]||0,"/",cn.PITY_UR]})]})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(me,{className:"w-4 h-4 mx-auto mb-1",style:{color:mt(40)},fill:mt(40)}),l.jsx("div",{className:"font-bold",style:{color:mt(40)},children:"UR"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[cn.RATES[40],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(me,{className:"w-4 h-4 mx-auto mb-1",style:{color:mt(30)},fill:mt(30)}),l.jsx("div",{className:"font-bold",style:{color:mt(30)},children:"SR"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[cn.RATES[30],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(me,{className:"w-4 h-4 mx-auto mb-1",style:{color:mt(20)},fill:mt(20)}),l.jsx("div",{className:"font-bold",style:{color:mt(20)},children:"R"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[cn.RATES[20],"%"]})]}),l.jsxs("div",{className:"p-2 rounded-lg bg-[var(--secondary)]",children:[l.jsx(me,{className:"w-4 h-4 mx-auto mb-1",style:{color:mt(10)},fill:mt(10)}),l.jsx("div",{className:"font-bold",style:{color:mt(10)},children:"N"}),l.jsxs("div",{className:"text-[var(--muted-foreground)]",children:[cn.RATES[10],"%"]})]})]}),l.jsxs("p",{className:"text-[10px] text-[var(--muted-foreground)] mt-2 text-center",children:["m bo UR sau ",cn.PITY_UR," ln quay khng trng (tch ly chung tt c gi)"]})]}),k&&l.jsx("div",{className:"card-3d p-3 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:"/IconPack/Currency/Crystal/256w/Crystal Blue 256px.png",className:"w-6 h-6"}),l.jsxs("div",{children:[l.jsxs("div",{className:"font-bold",children:[Dn(k.shards)," mnh"]}),l.jsxs("div",{className:"text-[10px] text-[var(--muted-foreground)]",children:["i ",cn.UR_EXCHANGE_COST," mnh = 1 th UR"]})]})]}),l.jsx("button",{onClick:()=>Y(!0),className:"btn-3d btn-3d-purple px-3 py-2 text-sm",children:"i th"})]})}),h.length>1&&l.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:h.map((st,Tt)=>l.jsxs("button",{onClick:()=>w(Tt),className:`px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap ${_===Tt?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-foreground"}`,children:["Pool ",Tt+1]},Tt))}),H&&l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsx("h3",{className:"font-bold mb-3",children:"Danh sch th"}),tt.map(st=>l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(me,{className:"w-4 h-4",style:{color:mt(st)},fill:mt(st)}),l.jsxs("span",{className:"font-bold text-sm",style:{color:mt(st)},children:[fr(st)," (",X[st].length,")"]})]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:X[st].map((Tt,Nt)=>{const Jt=ja(Tt.video_list),Et=k?Sot(k,Q,Tt.card_img):!1;return l.jsxs("button",{onClick:()=>Et&&C(Tt),disabled:!Et,className:`relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all ${Et?"bg-[var(--secondary)] hover:scale-105":"bg-black/30 brightness-50 cursor-not-allowed"}`,style:{borderColor:Et?mt(Tt.card_scarcity):"var(--border)"},children:[l.jsx("img",{src:Co(Tt.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer",loading:"lazy"}),Jt&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})})]},Nt)})})]},st)),(()=>{var Gt,yn,oe,ft;const st=[3,1001,1e3],Tt=((yn=(Gt=H.collect_list)==null?void 0:Gt.collect_infos)==null?void 0:yn.filter(St=>st.includes(St.redeem_item_type||0)))||[],Nt=((ft=(oe=H.collect_list)==null?void 0:oe.collect_chain)==null?void 0:ft.filter(St=>st.includes(St.redeem_item_type||0)))||[],Jt=[...Tt,...Nt];if(Jt.length===0)return null;const Et=St=>{switch(St){case 3:return{icon:bf,label:"Khung"};case 1001:return{icon:Xt,label:"Huy hiu"};case 1e3:return{icon:xl,label:"Avatar"};default:return{icon:Be,label:"Thng"}}};return l.jsxs("div",{className:"mt-4 pt-4 border-t border-[var(--border)]",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Be,{className:"w-4 h-4 text-[var(--duo-yellow)]"}),l.jsx("span",{className:"font-bold text-sm",children:"Phn thng"})]}),l.jsx("div",{className:"flex gap-3 flex-wrap",children:Jt.map((St,ae)=>{const{icon:xn,label:Jn}=Et(St.redeem_item_type||0);return l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[St.redeem_item_image&&l.jsx("img",{src:Co(St.redeem_item_image,100),alt:"",className:"w-12 h-12 rounded-lg object-cover",referrerPolicy:"no-referrer"}),l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-[var(--muted-foreground)]",children:[l.jsx(xn,{className:"w-3 h-3"}),l.jsx("span",{children:Jn})]})]},ae)})})]})})()]})]}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-background/95 backdrop-blur-sm border-t border-[var(--border)]",children:nt?l.jsx("button",{onClick:()=>!L&&at(),disabled:L,className:`w-full btn-3d py-3 ${L?"btn-3d-gray opacity-60":"btn-3d-yellow"}`,children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Be,{className:"w-5 h-5"}),l.jsx("span",{children:L?" nhn phn thng":"Nhn phn thng"})]})}):l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:()=>$(1),disabled:A||!i||i.gems<cn.COST_PER_PULL,className:"flex-1 btn-3d btn-3d-purple py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Quay x1"})]}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs opacity-80 mt-0.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{children:cn.COST_PER_PULL})]})]}),l.jsxs("button",{onClick:()=>$(10),disabled:A||!i||i.gems<cn.COST_PER_PULL*10,className:"flex-1 btn-3d btn-3d-red py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5"}),l.jsx("span",{children:"Quay x10"})]}),l.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs opacity-80 mt-0.5",children:[l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-3 h-3"}),l.jsx("span",{children:cn.COST_PER_PULL*10})]})]})]})}),x&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>C(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:st=>st.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:x.width>0&&x.height>0?x.width/x.height:2/3},children:l.jsx(Xb,{videoList:x.video_list,imageUrl:x.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:Q,lotteryId:(Rt=h[_])==null?void 0:Rt.lottery_id})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:mt(x.card_scarcity)},children:fr(x.card_scarcity)}),ja(x.video_list)&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]})]}),l.jsx("button",{onClick:()=>C(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})}),l.jsx(put,{isOpen:E,onClose:()=>{R(!1),T([]),U(!1)},results:N,isLoading:A,skipLoading:W}),D&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>j(!1),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full",onClick:st=>st.stopPropagation(),children:[l.jsxs("div",{className:"p-4 border-b border-[var(--border)] text-center",children:[l.jsxs("h2",{className:"font-bold text-lg flex items-center justify-center gap-2",children:[l.jsx(Be,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"Phn thng su tp"]}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mt-1",children:"Chc mng bn  hon thnh b su tp!"})]}),l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"flex justify-center gap-4 mb-4",children:K().map((st,Tt)=>{const Nt=Jt=>{switch(Jt){case 3:return"Khung";case 1001:return"Huy hiu";case 1e3:return"Avatar";default:return"Thng"}};return l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[st.redeem_item_image&&l.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden border-2 border-[var(--duo-yellow)] bg-[var(--secondary)]",children:l.jsx("img",{src:Co(st.redeem_item_image,100),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"})}),l.jsx("span",{className:"text-xs font-medium text-[var(--muted-foreground)]",children:Nt(st.redeem_item_type||0)})]},Tt)})}),l.jsx("button",{onClick:()=>j(!1),className:"w-full btn-3d btn-3d-purple py-3",children:"ng"})]})]})}),l.jsx(vut,{isOpen:dt,onClose:()=>Y(!1),collectionId:Q,urCards:((ht=H==null?void 0:H.item_list)==null?void 0:ht.filter(st=>st.card_scarcity===40))||[],inventory:k,userId:(i==null?void 0:i.oderId)||"",onExchangeSuccess:st=>{T([{cardImg:st.card_img,cardScarcity:st.card_scarcity,isNew:!0,shardsGained:0,videoList:st.video_list,width:st.width,height:st.height}]),U(!0),R(!0),F()}})]})}function xut(){var k,P,A,M,N;const e=we(),{user:t,equipAvatar:n,equipFrame:i,equipBadge:r,incrementDailyAvatarChanged:s,incrementDailyFrameChanged:o,incrementDailyBadgeChanged:a}=te(),[c,h]=I.useState("avatar"),u=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="avatar"):[]},[(k=t==null?void 0:t.gachaInventory)==null?void 0:k.rewards]),d=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="frame"):[]},[(P=t==null?void 0:t.gachaInventory)==null?void 0:P.rewards]),f=I.useMemo(()=>{var T;return(T=t==null?void 0:t.gachaInventory)!=null&&T.rewards?t.gachaInventory.rewards.filter(E=>E.type==="badge"):[]},[(A=t==null?void 0:t.gachaInventory)==null?void 0:A.rewards]),v=(t==null?void 0:t.equippedAvatar)||(t==null?void 0:t.avatar),y=t==null?void 0:t.equippedFrame,_=t==null?void 0:t.equippedBadge,w=async T=>{await n(T),await s()},x=async T=>{await i(T),await o()},C=async T=>{await r(T),await a()};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(rw,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xt,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Trang b"})]}),l.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Ty chnh h s"})]})]})}),l.jsx("div",{className:"px-4 pt-32 pb-4",children:l.jsxs("div",{className:"card-3d p-6 flex flex-col items-center",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-3",children:"Xem trc"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center",children:[y&&l.jsx("img",{src:Ne(y,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden border-2 border-[var(--border)]",children:v?l.jsx("img",{src:t!=null&&t.equippedAvatar?Ne(v,100):v,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((M=t==null?void 0:t.odername)==null?void 0:M.charAt(0).toUpperCase())||"?"})]}),_&&l.jsx("div",{className:"w-12 h-12",children:l.jsx("img",{src:Ne(_,100),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})})]}),l.jsx("p",{className:"font-bold text-foreground mt-3",children:t==null?void 0:t.odername}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:["Level ",(t==null?void 0:t.level)||1]})]})}),l.jsx("div",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>h("avatar"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="avatar"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(xl,{className:"w-4 h-4"}),"Avatar"]}),l.jsxs("button",{onClick:()=>h("frame"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="frame"?"bg-[var(--duo-blue)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(bf,{className:"w-4 h-4"}),"Khung"]}),l.jsxs("button",{onClick:()=>h("badge"),className:`flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-semibold text-sm transition-all ${c==="badge"?"bg-[var(--duo-yellow)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:[l.jsx(vr,{className:"w-4 h-4"}),"Huy hiu"]})]})}),l.jsxs("div",{className:"px-4 pb-28",children:[c==="avatar"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>w(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all ${t!=null&&t.equippedAvatar?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx("div",{className:"w-full h-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-xl",children:t!=null&&t.avatar?l.jsx("img",{src:t.avatar,alt:"",className:"w-full h-full object-cover"}):((N=t==null?void 0:t.odername)==null?void 0:N.charAt(0).toUpperCase())||"?"}),!(t!=null&&t.equippedAvatar)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]}),u.map((T,E)=>{const R=(t==null?void 0:t.equippedAvatar)===T.image;return l.jsxs("button",{onClick:()=>w(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:Ne(T.image,150),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]},E)}),u.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]}),c==="frame"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>x(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] flex items-center justify-center ${t!=null&&t.equippedFrame?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx(bf,{className:"w-8 h-8 text-[var(--muted-foreground)]"}),!(t!=null&&t.equippedFrame)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]}),d.map((T,E)=>{const R=(t==null?void 0:t.equippedFrame)===T.image;return l.jsxs("button",{onClick:()=>x(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:Ne(T.image,150),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]},E)}),d.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]}),c==="badge"&&l.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[l.jsxs("button",{onClick:()=>C(null),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] flex items-center justify-center ${t!=null&&t.equippedBadge?"border-[var(--border)]":"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30"}`,children:[l.jsx(vr,{className:"w-8 h-8 text-[var(--muted-foreground)]"}),!(t!=null&&t.equippedBadge)&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]}),f.map((T,E)=>{const R=(t==null?void 0:t.equippedBadge)===T.image;return l.jsxs("button",{onClick:()=>C(T.image),className:`relative aspect-square rounded-xl overflow-hidden border-3 transition-all bg-[var(--secondary)] ${R?"border-[var(--duo-green)] ring-2 ring-[var(--duo-green)]/30":"border-[var(--border)]"}`,children:[l.jsx("img",{src:Ne(T.image,150),alt:"",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"}),R&&l.jsx("div",{className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-3 h-3 text-white"})})]},E)}),f.length===0&&l.jsx("div",{className:"col-span-3 text-center py-6",children:l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Hon thnh gacha  nhn thm"})})]})]})]})}const My=12;function _ut(){var P;const e=we(),{user:t,incrementDailyCardViewed:n}=te(),[i,r]=I.useState(!0),[s,o]=I.useState([]),[a,c]=I.useState("all"),[h,u]=I.useState(1),[d,f]=I.useState(null);I.useEffect(()=>{t!=null&&t.oderId&&v()},[t==null?void 0:t.oderId]),I.useEffect(()=>{u(1)},[a]);const v=async()=>{if(t!=null&&t.oderId){r(!0);try{const[A,M]=await Promise.all([Wa(t.oderId),tj()]),N=[],T=Object.keys(A.cards).map(Number);for(const E of T){const R=Object.keys(A.cards[E]);if(R.length===0)continue;const D=M.find(L=>L.id===E),j=(D==null?void 0:D.name)||(D==null?void 0:D.act_title)||`Collection ${E}`;try{const L=await Vu(E);for(const lt of L)for(const dt of lt.item_list||[])R.includes(dt.card_img)&&N.push({card:dt,collectionId:E,collectionName:j,count:A.cards[E][dt.card_img]})}catch(L){console.warn(`Failed to load lotteries for collection ${E}:`,L)}}o(N)}catch(A){console.error("Error loading card inventory:",A)}finally{r(!1)}}},y=I.useMemo(()=>{switch(a){case"ur":return s.filter(A=>A.card.card_scarcity===40);case"sr":return s.filter(A=>A.card.card_scarcity===30);case"r":return s.filter(A=>A.card.card_scarcity===20);case"n":return s.filter(A=>A.card.card_scarcity===10);default:return s}},[s,a]),_=Math.ceil(y.length/My),w=(h-1)*My,x=y.slice(w,w+My),C=I.useMemo(()=>({total:s.length,ur:s.filter(A=>A.card.card_scarcity===40).length,sr:s.filter(A=>A.card.card_scarcity===30).length,r:s.filter(A=>A.card.card_scarcity===20).length,n:s.filter(A=>A.card.card_scarcity===10).length}),[s]),k=A=>{switch(A){case"ur":return mt(40);case"sr":return mt(30);case"r":return mt(20);case"n":return mt(10);default:return"var(--duo-purple)"}};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 pt-12 pb-4 px-4 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-pink)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ts,{className:"w-6 h-6 text-white"}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"Kho th"})]}),l.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[C.total," th  su tp"]})]})]})}),l.jsx("div",{className:"fixed top-[116px] left-0 right-0 z-40 bg-[var(--card)] border-b border-[var(--border)]",children:l.jsxs("div",{className:"flex gap-2 px-4 py-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>c("all"),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all ${a==="all"?"bg-[var(--duo-purple)] text-white":"bg-[var(--secondary)] text-[var(--muted-foreground)]"}`,children:["Tt c (",C.total,")"]}),l.jsxs("button",{onClick:()=>c("ur"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="ur"?mt(40):"var(--secondary)",color:a==="ur"?"white":"var(--muted-foreground)"},children:[l.jsx(me,{className:"w-4 h-4",fill:a==="ur"?"white":mt(40)}),"UR (",C.ur,")"]}),l.jsxs("button",{onClick:()=>c("sr"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="sr"?mt(30):"var(--secondary)",color:a==="sr"?"white":"var(--muted-foreground)"},children:[l.jsx(me,{className:"w-4 h-4",fill:a==="sr"?"white":mt(30)}),"SR (",C.sr,")"]}),l.jsxs("button",{onClick:()=>c("r"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="r"?mt(20):"var(--secondary)",color:a==="r"?"white":"var(--muted-foreground)"},children:[l.jsx(me,{className:"w-4 h-4",fill:a==="r"?"white":mt(20)}),"R (",C.r,")"]}),l.jsxs("button",{onClick:()=>c("n"),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-sm font-semibold whitespace-nowrap transition-all",style:{backgroundColor:a==="n"?mt(10):"var(--secondary)",color:a==="n"?"white":"var(--muted-foreground)"},children:[l.jsx(me,{className:"w-4 h-4",fill:a==="n"?"white":mt(10)}),"N (",C.n,")"]})]})}),l.jsx("div",{className:"px-4 pt-[180px] pb-24",children:i?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(qi,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]}):y.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[l.jsx(Ts,{className:"w-16 h-16 text-[var(--muted-foreground)] mb-4"}),l.jsx("p",{className:"text-[var(--muted-foreground)]",children:a==="all"?"Cha c th no":`Cha c th ${fr(a==="ur"?40:a==="sr"?30:a==="r"?20:10)}`})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-3 gap-2",children:x.map((A,M)=>{const N=ja(A.card.video_list);return l.jsxs("button",{onClick:()=>{f(A),n()},className:"relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all hover:scale-105 active:scale-95",style:{borderColor:mt(A.card.card_scarcity)},children:[l.jsx("img",{src:Co(A.card.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer",loading:"lazy"}),l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 rounded text-[10px] font-bold text-white",style:{backgroundColor:mt(A.card.card_scarcity)},children:fr(A.card.card_scarcity)}),N&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})}),A.count>1&&l.jsxs("div",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 rounded bg-black/70 text-[10px] font-bold text-white",children:["x",A.count]})]},`${A.collectionId}-${A.card.card_img}-${M}`)})}),_>1&&l.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[l.jsx("button",{onClick:()=>u(A=>Math.max(1,A-1)),disabled:h===1,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(rw,{className:"w-4 h-4 text-foreground"})}),l.jsxs("div",{className:"px-4 py-2 rounded-xl text-white font-bold text-sm",style:{backgroundColor:k(a)},children:[h," / ",_]}),l.jsx("button",{onClick:()=>u(A=>Math.min(_,A+1)),disabled:h===_,className:"p-2 rounded-xl bg-[var(--secondary)] disabled:opacity-40",children:l.jsx(sr,{className:"w-4 h-4 text-foreground"})})]})]})}),d&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>f(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:A=>A.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:d.card.width>0&&d.card.height>0?d.card.width/d.card.height:2/3},children:l.jsx(Xb,{videoList:d.card.video_list,imageUrl:d.card.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:d.collectionId})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:mt(d.card.card_scarcity)},children:fr(d.card.card_scarcity)}),l.jsxs("div",{className:"flex items-center gap-2",children:[((P=d.card.video_list)==null?void 0:P.length)>0&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]}),d.count>1&&l.jsxs("span",{className:"text-xs text-[var(--muted-foreground)]",children:["x",d.count]})]})]}),l.jsx("button",{onClick:()=>f(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})})]})}function wut(){var U,Q,F,q,$,H,X,tt,O,B,nt;const{id:e}=JP(),t=we(),{user:n}=te(),[i,r]=I.useState(null),[s,o]=I.useState(!0),[a,c]=I.useState(null),[h,u]=I.useState([]),[d,f]=I.useState(!1),[v,y]=I.useState(!1),[_,w]=I.useState([]),[x,C]=I.useState([]),[k,P]=I.useState(!1),[A,M]=I.useState(null),[N,T]=I.useState(null),E=(n==null?void 0:n.oderId)===e;I.useEffect(()=>{e&&R(e)},[e]);const R=async K=>{o(!0),c(null);try{const at=Dt(kt,"users",K),ct=await Qr(at);if(!ct.exists()){c("Khng tm thy ngi dng");return}const vt=ct.data();r(vt);const Rt=vt.showcase;Rt&&Rt.length>0&&await D(Rt)}catch(at){console.error("Error fetching profile:",at),c("Khng th ti h s")}finally{o(!1)}},D=async K=>{f(!0);try{const at=[],ct=[...new Set(K.map(vt=>vt.collectionId))];for(const vt of ct){const Rt=await Vu(vt);for(const ht of Rt)for(const st of ht.item_list||[])K.find(Nt=>Nt.cardImg===st.card_img&&Nt.collectionId===vt)&&at.push({...st,collectionId:vt})}u(at)}catch(at){console.error("Error loading showcase cards:",at)}finally{f(!1)}},j=async()=>{if(!(n!=null&&n.oderId))return;y(!0),P(!0);const K=(i==null?void 0:i.showcase)||[];C(K);try{const at=await Wa(n.oderId),ct=[],vt=Object.keys(at.cards).map(Number);for(const Rt of vt){const ht=Object.keys(at.cards[Rt]);if(ht.length===0)continue;const st=await Vu(Rt);for(const Tt of st)for(const Nt of Tt.item_list||[])ht.includes(Nt.card_img)&&ct.push({...Nt,collectionId:Rt})}w(ct)}catch(at){console.error("Error loading owned cards:",at)}finally{P(!1)}},L=K=>{if(x.find(ct=>ct.cardImg===K.card_img&&ct.collectionId===K.collectionId))C(x.filter(ct=>!(ct.cardImg===K.card_img&&ct.collectionId===K.collectionId)));else{if(x.length>=6)return;C([...x,{cardImg:K.card_img,collectionId:K.collectionId}])}},lt=async()=>{if(n!=null&&n.oderId)try{const{updateDoc:K}=await Tf(async()=>{const{updateDoc:ct}=await Promise.resolve().then(()=>jD);return{updateDoc:ct}},void 0),at=Dt(kt,"users",n.oderId);await K(at,{showcase:x}),await D(x),y(!1),i&&r({...i,showcase:x})}catch(K){console.error("Error saving showcase:",K)}};if(s)return l.jsx(se,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[l.jsx(qi,{className:"w-10 h-10 text-[var(--duo-purple)] animate-spin"}),l.jsx("p",{className:"text-[var(--muted-foreground)] mt-3",children:"ang ti..."})]})});if(a||!i)return l.jsx(se,{className:"bg-background min-h-screen",children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-screen px-4",children:[l.jsx("p",{className:"text-[var(--duo-red)] mb-4",children:a}),l.jsx("button",{onClick:()=>t(-1),className:"btn-3d btn-3d-purple px-4 py-2",children:"Quay li"})]})});const dt=ps(((U=i.conquestStats)==null?void 0:U.rankPoints)??0),Y=(Q=i.gachaInventory)==null?void 0:Q.gachaStats,W=((Y==null?void 0:Y.totalURCards)??0)+((Y==null?void 0:Y.totalSRCards)??0)+((Y==null?void 0:Y.totalRCards)??0)+((Y==null?void 0:Y.totalNCards)??0);return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-[var(--duo-purple)] to-[var(--duo-blue)] pt-12 pb-4 px-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>t(-1),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsx("h1",{className:"font-bold text-xl text-white",children:"H s"})]})}),l.jsxs("div",{className:"pt-28 pb-24 px-4",children:[l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsxs("div",{className:"relative w-[88px] h-[88px] flex items-center justify-center shrink-0",children:[i.equippedFrame&&l.jsx("img",{src:Ne(i.equippedFrame,120),alt:"Frame",className:"absolute inset-0 w-[88px] h-[88px] object-contain z-10 pointer-events-none",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--duo-blue)] flex items-center justify-center text-white font-bold text-lg overflow-hidden",children:i.equippedAvatar||i.avatar?l.jsx("img",{src:i.equippedAvatar?Ne(i.equippedAvatar,100):i.avatar,alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):((F=i.odername)==null?void 0:F.charAt(0).toUpperCase())||"?"})]}),i.equippedBadge&&l.jsx("div",{className:"w-12 h-12 shrink-0",children:l.jsx("img",{src:Ne(i.equippedBadge,80),alt:"Badge",className:"w-full h-full object-contain",referrerPolicy:"no-referrer"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h2",{className:"font-bold text-lg text-foreground truncate",children:i.odername||"Ngi chi"}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:["Level ",i.level??1]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:qa(dt),alt:"",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:((q=i.conquestStats)==null?void 0:q.rankPoints)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Rank Points"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:"/AppAssets/Fire.png",alt:"streak",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:i.streak??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Streak"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-xl p-3 text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-10 h-10"})}),l.jsx("p",{className:"font-bold text-sm",children:i.exp??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"XP"})]})]}),l.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--border)]",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mb-2",children:"im theo lnh vc"}),l.jsxs("div",{className:"grid grid-cols-5 gap-1.5",children:[l.jsxs("div",{className:"bg-[var(--duo-green)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-green)]",children:((i.totalCorrect??0)*10+(i.perfectLessons??0)*50).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Quiz"})]}),l.jsxs("div",{className:"bg-[var(--duo-purple)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-purple)]",children:(((($=i.conquestStats)==null?void 0:$.rankPoints)??0)+(((H=i.conquestStats)==null?void 0:H.totalConquests)??0)*5).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Battle"})]}),l.jsxs("div",{className:"bg-[var(--duo-yellow)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-yellow)]",children:(((Y==null?void 0:Y.totalURCards)??0)*100+((Y==null?void 0:Y.totalSRCards)??0)*50+((Y==null?void 0:Y.totalRCards)??0)*20+((Y==null?void 0:Y.totalNCards)??0)*5).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Gacha"})]}),l.jsxs("div",{className:"bg-[var(--duo-orange)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-orange)]",children:"-"}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Tower"})]}),l.jsxs("div",{className:"bg-[var(--duo-blue)]/10 rounded-lg p-2 text-center",children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-blue)]",children:((((X=i.achievements)==null?void 0:X.length)??0)*25).toLocaleString()}),l.jsx("p",{className:"text-[8px] text-[var(--muted-foreground)]",children:"Achieve"})]})]})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("h3",{className:"font-bold mb-3 flex items-center gap-2",children:[l.jsx(Ci,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"Chinh Chin"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tng trn:"}),l.jsx("span",{className:"font-bold",children:((tt=i.conquestStats)==null?void 0:tt.totalConquests)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Chui thng:"}),l.jsx("span",{className:"font-bold",children:((O=i.conquestStats)==null?void 0:O.bestWinStreak)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tr li ng:"}),l.jsx("span",{className:"font-bold text-[var(--duo-green)]",children:((B=i.conquestStats)==null?void 0:B.totalConquestCorrect)??0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"Tr li sai:"}),l.jsx("span",{className:"font-bold text-[var(--duo-red)]",children:((nt=i.conquestStats)==null?void 0:nt.totalConquestWrong)??0})]})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-4",children:[l.jsxs("h3",{className:"font-bold mb-3 flex items-center gap-2",children:[l.jsx(Ts,{className:"w-5 h-5 text-[var(--duo-purple)]"}),"B su tp"]}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:mt(40)},children:(Y==null?void 0:Y.totalURCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"UR"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:mt(30)},children:(Y==null?void 0:Y.totalSRCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"SR"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",style:{color:mt(20)},children:(Y==null?void 0:Y.totalRCards)??0}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"R"})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"font-bold",children:W}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)]",children:"Tng"})]})]})]}),l.jsxs("div",{className:"card-3d p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[l.jsx(Xt,{className:"w-5 h-5 text-[var(--duo-yellow)]"}),"T trng by"]}),E&&!v&&l.jsxs("button",{onClick:j,className:"btn-3d btn-3d-blue px-4 py-1.5 rounded-xl text-sm font-bold text-white flex items-center gap-1.5",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),"Chnh sa"]})]}),d?l.jsx("div",{className:"flex justify-center py-8",children:l.jsx(qi,{className:"w-6 h-6 animate-spin text-[var(--muted-foreground)]"})}):h.length===0&&!v?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Xt,{className:"w-12 h-12 text-[var(--muted-foreground)] mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:E?"Cha c th trng by. Bm chnh sa  thm!":"Cha c th trng by"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-2",children:h.map((K,at)=>l.jsxs("button",{onClick:()=>T(K),className:"relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-transform hover:scale-105 active:scale-95",style:{borderColor:mt(K.card_scarcity)},children:[l.jsx("img",{src:Co(K.card_img,300),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute top-1 left-1 px-1.5 py-0.5 rounded text-[10px] font-bold text-white",style:{backgroundColor:mt(K.card_scarcity)},children:fr(K.card_scarcity)}),ja(K.video_list)&&l.jsx("div",{className:"absolute top-1 right-1 p-1 rounded-full bg-black/50",children:l.jsx(Xt,{className:"w-3 h-3 text-white"})})]},`${K.collectionId}-${K.card_img}-${at}`))})]})]}),N&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4",onClick:()=>T(null),children:l.jsxs("div",{className:"bg-background rounded-2xl overflow-hidden max-w-sm w-full max-h-[85vh] flex flex-col",onClick:K=>K.stopPropagation(),children:[l.jsx("div",{className:"relative flex-1 min-h-0",style:{aspectRatio:N.width>0&&N.height>0?N.width/N.height:2/3},children:l.jsx(Xb,{videoList:N.video_list,imageUrl:N.card_img,className:"w-full h-full object-contain",imageSize:600,collectionId:N.collectionId})}),l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:"px-3 py-1 rounded-lg text-sm font-bold text-white",style:{backgroundColor:mt(N.card_scarcity)},children:fr(N.card_scarcity)}),ja(N.video_list)&&l.jsxs("span",{className:"flex items-center gap-1 text-xs text-[var(--muted-foreground)]",children:[l.jsx(Xt,{className:"w-3 h-3"}),"Th ng"]})]}),l.jsx("button",{onClick:()=>T(null),className:"w-full btn-3d btn-3d-purple py-2",children:"ng"})]})]})}),v&&l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:()=>y(!1),children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[90vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:K=>K.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("button",{onClick:()=>y(!1),className:"w-10 h-10 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"font-bold text-lg",children:"T trng by"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn th yu thch  khoe"})]}),l.jsxs("button",{onClick:lt,className:"btn-3d btn-3d-green px-4 py-2 rounded-xl text-sm font-bold text-white flex items-center gap-1.5",children:[l.jsx(Rn,{className:"w-4 h-4"}),"Lu"]})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsxs("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-semibold text-[var(--muted-foreground)]",children:" chn"}),l.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-[var(--duo-purple)]/20 text-[var(--duo-purple)]",children:[x.length,"/6"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex gap-2 overflow-x-auto flex-1 py-1 scrollbar-hide",children:x.length===0?l.jsxs("div",{className:"flex items-center gap-2 py-3",children:[l.jsx(Xt,{className:"w-4 h-4 text-[var(--muted-foreground)]"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chm vo th bn di  chn"})]}):x.map((K,at)=>{const ct=_.find(vt=>vt.card_img===K.cardImg&&vt.collectionId===K.collectionId);return ct?l.jsxs("button",{onClick:()=>L(ct),className:"relative w-14 h-[4.5rem] rounded-xl overflow-hidden border-2 shrink-0 group shadow-md hover:shadow-lg transition-all hover:scale-105",style:{borderColor:mt(ct.card_scarcity)},children:[l.jsx("img",{src:Co(ct.card_img,100),alt:"",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 group-active:opacity-100 transition-opacity",children:l.jsx(Fr,{className:"w-5 h-5 text-white"})})]},at):null})}),x.length>0&&l.jsx("button",{onClick:()=>C([]),className:"p-2 rounded-xl shrink-0 bg-[var(--duo-red)]/15 border-2 border-[var(--duo-red)]/30 active:scale-95 transition-transform",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--duo-red)]"})})]})]})}),l.jsx("div",{className:"px-5 pb-3",children:l.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide",children:[l.jsxs("button",{onClick:()=>M(null),className:`flex items-center gap-1.5 py-2 px-4 rounded-full text-xs font-bold whitespace-nowrap transition-all ${A===null?"bg-gradient-to-r from-[var(--duo-purple)] to-purple-500 text-white shadow-lg shadow-[var(--duo-purple)]/30":"bg-[var(--secondary)] text-[var(--muted-foreground)] hover:bg-[var(--border)]"}`,children:[l.jsx(Xt,{className:"w-3.5 h-3.5"}),"Tt c"]}),[40,30,20,10].map(K=>l.jsxs("button",{onClick:()=>M(K),className:"flex items-center gap-1.5 py-2 px-4 rounded-full text-xs font-bold whitespace-nowrap transition-all",style:{background:A===K?`linear-gradient(135deg, ${mt(K)}, ${mt(K)}dd)`:"var(--secondary)",color:A===K?"white":"var(--muted-foreground)",boxShadow:A===K?`0 4px 12px ${mt(K)}40`:"none"},children:[l.jsx(me,{className:"w-3.5 h-3.5",fill:A===K?"white":mt(K)}),fr(K)]},K))]})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:k?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[l.jsx(qi,{className:"w-10 h-10 animate-spin text-[var(--duo-purple)] mb-3"}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"ang ti th..."})]}):_.length===0?l.jsxs("div",{className:"text-center py-16",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-full bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Ts,{className:"w-10 h-10 text-[var(--muted-foreground)]"})}),l.jsx("p",{className:"text-[var(--muted-foreground)] font-medium",children:"Cha c th no"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:"Hy quay gacha  su tm th nh!"})]}):l.jsx("div",{className:"grid grid-cols-3 gap-3",children:_.filter(K=>A===null||K.card_scarcity===A).map((K,at)=>{const ct=x.some(vt=>vt.cardImg===K.card_img&&vt.collectionId===K.collectionId);return l.jsxs("button",{onClick:()=>L(K),className:`relative aspect-[3/4] rounded-2xl overflow-hidden border-2 transition-all duration-200 ${ct?"ring-3 ring-[var(--duo-green)] ring-offset-2 ring-offset-[var(--background)] scale-[0.98]":"hover:scale-[1.02] active:scale-[0.98]"}`,style:{borderColor:mt(K.card_scarcity),boxShadow:ct?`0 8px 24px ${mt(K.card_scarcity)}40`:`0 4px 12px ${mt(K.card_scarcity)}20`},children:[l.jsx("img",{src:Co(K.card_img,200),alt:"",className:"w-full h-full object-cover object-top",referrerPolicy:"no-referrer"}),l.jsx("div",{className:"absolute top-1.5 left-1.5 px-2 py-0.5 rounded-full text-[10px] font-bold text-white shadow-sm",style:{backgroundColor:mt(K.card_scarcity)},children:fr(K.card_scarcity)}),ct&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[var(--duo-green)]/60 to-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx("div",{className:"w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-lg",children:l.jsx(Rn,{className:"w-6 h-6 text-[var(--duo-green)]"})})})]},`${K.collectionId}-${K.card_img}-${at}`)})})})]})})]})}const but=[{id:"random",name:"Ngu nhin",desc:"10 cu hi ngu nhin",icon:QB,color:"#ff9600",shadow:"#ea7e00"},{id:"quick",name:"Nhanh",desc:"5 cu - Luyn nhanh",icon:Vr,color:"#58cc02",shadow:"#46a302"},{id:"timeattack",name:"Chy ua",desc:"10 cu trong 60 giy",icon:Ju,color:"#1cb0f6",shadow:"#1899d6"},{id:"survival",name:"Hardcore",desc:"10 cu - 1 sai = Thua",icon:ow,color:"#ff4b4b",shadow:"#ea2b2b"}];function Tut(){const e=we(),{startRandomQuiz:t,startTimeAttack:n,startSurvival:i}=ds(),{user:r}=te(),s=a=>{switch(a){case"random":t(10);break;case"quick":t(5);break;case"timeattack":n(60);break;case"survival":i(1);break}e("/quiz")},o=a=>{s(a)};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-16 pb-4 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Ji,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-foreground",children:"Luyn Tp"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chn ch  luyn"})]})]})}),r&&l.jsxs("div",{className:"px-4 py-3 flex items-center justify-center gap-6 bg-[var(--card)] border-b-2 border-[var(--border)]",children:[l.jsx("div",{className:"flex items-center gap-1.5 bg-[var(--duo-green)]/20 px-3 py-1 rounded-full",children:l.jsx("span",{className:"text-sm font-bold text-[var(--duo-green)]",children:"Khng gii hn tim"})}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("img",{src:"/AppAssets/Lighting.png",alt:"xp",className:"w-5 h-5"}),l.jsxs("span",{className:"font-bold text-foreground",children:[Dn(r.exp)," XP"]})]})]}),l.jsx("div",{className:"px-4 py-6 space-y-4",children:but.map(a=>{const c=a.icon;return l.jsxs("button",{onClick:()=>o(a.id),className:"btn-mode w-full p-4 rounded-2xl text-left flex items-center gap-4",style:{background:a.color,boxShadow:`0 5px 0 ${a.shadow}`,"--shadow-color":a.shadow},children:[l.jsx("div",{className:"w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center",children:l.jsx(c,{className:"w-8 h-8 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-bold text-lg text-white",children:a.name}),l.jsx("p",{className:"text-sm text-white/80",children:a.desc})]})]},a.id)})})]})}const Cut=5,yg={rankPoints:0,highestRankId:"wood_1",totalConquests:0,totalConquestCorrect:0,totalConquestWrong:0,bestWinStreak:0,currentWinStreak:0,lastConquestDate:""},RT=Zu((e,t)=>({isActive:!1,isLoading:!1,questions:[],currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:0,rank:ps(0),rankPoints:0,initialRankPoints:0,initialRankId:"wood_1",userId:"",results:[],loadConquestStats:async n=>{try{const i=Dt(kt,"users",n),r=await Qr(i);return r.exists()&&r.data().conquestStats||yg}catch(i){return console.error("Error loading conquest stats:",i),yg}},startConquest:async(n,i=0)=>{e({isLoading:!0});const r=await t().loadConquestStats(n),s=(r==null?void 0:r.rankPoints)||i,o=ps(s);try{const a=await Qst(o,Cut);e({isActive:!0,isLoading:!1,questions:a,currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:Date.now(),rank:o,rankPoints:s,initialRankPoints:s,initialRankId:o.rankId,userId:n,results:[]})}catch(a){console.error("Error starting conquest:",a),e({isLoading:!1})}},submitAnswer:n=>{const{questions:i,currentIndex:r,rank:s,rankPoints:o,results:a,correctCount:c,wrongCount:h,score:u}=t(),d=i[r];if(!d)return{correct:!1,points:0};const f=Zst(d,n),y=Yst(f,s,0),_=Jst(s),w=o+y,x=Math.max(_,w),C=ps(x);return e({correctCount:f?c+1:c,wrongCount:f?h:h+1,score:u+(f?10:0),rankPoints:x,rank:C,results:[...a,{questionId:d.id,correct:f,points:y}]}),{correct:f,points:y}},nextQuestion:async()=>{const{currentIndex:n,questions:i}=t(),r=n+1;return r>=i.length?!1:(e({currentIndex:r}),!0)},endConquest:async()=>{const{score:n,correctCount:i,wrongCount:r,results:s,userId:o,rankPoints:a,rank:c,initialRankPoints:h,initialRankId:u,startTime:d}=t(),f=s.reduce((_,w)=>_+w.points,0),v=i+r,y=v>0?Math.round(i/v*100):0;if(e({isActive:!1}),o)try{const _=Dt(kt,"users",o),w=await Qr(_);if(w.exists()){const x=w.data(),C=x.conquestStats||yg,k=f>0,P=k?C.currentWinStreak+1:0,A=Math.max(C.bestWinStreak,P),M=C.highestRankId||"wood",N=c.rankId;let T=0;if(N!==M&&a>(C.rankPoints||0)){const dt=Xst[N];dt&&(T=dt.gems)}const E={rankPoints:a,highestRankId:a>(C.rankPoints||0)?c.rankId:C.highestRankId,totalConquests:C.totalConquests+1,totalConquestCorrect:C.totalConquestCorrect+i,totalConquestWrong:C.totalConquestWrong+r,bestWinStreak:A,currentWinStreak:P,lastConquestDate:new Date().toISOString()};let R=Math.max(0,Math.floor(f/10));y>=90&&i>=3&&(R+=5);const D=te.getState(),j=D.getXPMultiplier(),L=i*10*j;await Kt(_,{conquestStats:E,totalCorrect:(x.totalCorrect||0)+i,totalWrong:(x.totalWrong||0)+r,exp:(x.exp||0)+L,gems:(x.gems||0)+R+T});const lt={oderId:o,startTime:new Date(d).toISOString(),endTime:new Date().toISOString(),rankBefore:u,rankAfter:c.rankId,pointsBefore:h,pointsAfter:a,pointsGained:f,correctCount:i,wrongCount:r,totalQuestions:v,accuracy:y};await vp(Wr(kt,"conquestSessions"),lt),await D.incrementDailyConquests(),k&&await D.incrementWeeklyConquestWins(),console.log("Conquest synced to Firebase:",E)}}catch(_){console.error("Error syncing conquest to Firebase:",_)}return{totalScore:n,correct:i,wrong:r,pointsGained:f}},resetConquest:()=>{e({isActive:!1,isLoading:!1,questions:[],currentIndex:0,score:0,correctCount:0,wrongCount:0,startTime:0,initialRankPoints:0,initialRankId:"wood_1",results:[]})}}));function kut({question:e,onAnswer:t,disabled:n}){const i=e.pairs||[],[r,s]=I.useState(null),[o,a]=I.useState({}),c=i.map((_,w)=>({text:_.left,index:w})),h=i.map((_,w)=>({text:_.right,index:w})),u=_=>{n||s(_)},d=_=>{if(n||r===null)return;const w={...o,[r]:_};a(w),s(null);const x=Object.entries(w).map(([C,k])=>`${C}-${k}`);t(x)},f=()=>{n||(a({}),s(null),t([]))},v=_=>o[_],y=_=>Object.values(o).includes(_);return l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Chn mt mc bn tri, sau  chn mc tng ng bn phi"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("div",{className:"space-y-2",children:c.map(_=>{const w=r===_.index,x=v(_.index)!==void 0;return l.jsx("button",{onClick:()=>u(_.index),disabled:n,className:qt("option-btn w-full p-3 text-left text-sm",w&&"selected",x&&"correct"),children:_.text},`left-${_.index}`)})}),l.jsx("div",{className:"space-y-2",children:h.map(_=>{const w=y(_.index);return l.jsx("button",{onClick:()=>d(_.index),disabled:n||r===null||w,className:qt("option-btn w-full p-3 text-left text-sm",w&&"correct",r!==null&&!w&&"border-[var(--duo-blue)]/50"),children:_.text},`right-${_.index}`)})})]}),Object.keys(o).length>0&&l.jsxs("div",{className:"card-3d p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" ni:"}),!n&&l.jsxs("button",{onClick:f,className:"flex items-center gap-1 px-2 py-1 rounded-lg bg-[var(--duo-orange)]/20 text-[var(--duo-orange)] text-xs font-bold",children:[l.jsx(yu,{className:"w-3 h-3"}),"Lm li"]})]}),l.jsx("div",{className:"space-y-1",children:Object.entries(o).map(([_,w])=>{var x,C;return l.jsxs("p",{className:"text-sm text-foreground",children:[(x=c[Number(_)])==null?void 0:x.text," "," ",(C=h[w])==null?void 0:C.text]},_)})})]})]})}function Nut({question:e,onAnswer:t,disabled:n}){const[i,r]=I.useState(()=>[...e.items||[]].sort(()=>Math.random()-.5)),s=(o,a)=>{if(n)return;const c=a==="up"?o-1:o+1;if(c<0||c>=i.length)return;const h=[...i];[h[o],h[c]]=[h[c],h[o]],r(h),t(h)};return l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)]",children:"Sp xp cc mc theo th t ng (dng nt mi tn  di chuyn)"}),l.jsx("div",{className:"space-y-2",children:i.map((o,a)=>l.jsxs("div",{className:"option-btn flex items-center gap-2 p-3",children:[l.jsx(SB,{className:"w-5 h-5 text-[var(--muted-foreground)]"}),l.jsx("span",{className:"w-7 h-7 rounded-lg bg-[var(--duo-blue)] text-white text-sm font-bold flex items-center justify-center",children:a+1}),l.jsx("span",{className:"flex-1 text-foreground text-sm",children:o}),!n&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>s(a,"up"),disabled:a===0,className:qt("w-8 h-8 rounded-lg flex items-center justify-center",a===0?"bg-[var(--secondary)] opacity-30":"bg-[var(--duo-blue)] text-white"),children:l.jsx(zO,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>s(a,"down"),disabled:a===i.length-1,className:qt("w-8 h-8 rounded-lg flex items-center justify-center",a===i.length-1?"bg-[var(--secondary)] opacity-30":"bg-[var(--duo-blue)] text-white"),children:l.jsx(GO,{className:"w-4 h-4"})})]})]},`${o}-${a}`))}),n&&e.correctAnswer&&l.jsxs("div",{className:"card-3d p-3",style:{background:"rgba(88, 204, 2, 0.15)",borderColor:"var(--duo-green)"},children:[l.jsx("p",{className:"text-xs text-[var(--duo-green)] mb-1 font-bold",children:"Th t ng:"}),l.jsx("ol",{className:"list-decimal list-inside text-sm text-[var(--duo-green)]",children:e.correctAnswer.map((o,a)=>l.jsx("li",{children:o},a))})]})]})}const Eut=["d n","qun l","k hoch","tin ","chi ph","cht lng","ri ro","phm vi","ngun lc","thi gian","giao tip","truyn thng","kim sot","gim st","nh gi"];function Sut({question:e,onAnswer:t,disabled:n}){const[i,r]=I.useState(null),s=I.useMemo(()=>{const c=String(e.correctAnswer);let h=[];return e.distractors&&e.distractors.length>=3?h=e.distractors.slice(0,3):h=Eut.filter(v=>v.toLowerCase()!==c.toLowerCase()).sort(()=>Math.random()-.5).slice(0,3),[...h,c].sort(()=>Math.random()-.5)},[e.correctAnswer,e.distractors]),o=c=>{n||(r(c),t(c))},a=e.question.split("___");return l.jsxs("div",{className:"space-y-5",children:[l.jsx("div",{className:"card-3d p-4",children:l.jsxs("p",{className:"text-base text-foreground leading-relaxed",children:[a[0],l.jsx("span",{className:qt("inline-block min-w-[80px] mx-1 px-3 py-1 rounded-lg border-2 border-dashed text-center",i?"border-[var(--duo-blue)] bg-[var(--duo-blue)]/20 text-[var(--duo-blue)] font-bold":"border-[var(--muted-foreground)] text-[var(--muted-foreground)]"),children:i||"______"}),a[1]]})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] mb-3",children:"Chn t ph hp:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((c,h)=>{const u=i===c,d=n&&c===e.correctAnswer,f=n&&u&&c!==e.correctAnswer;return l.jsx("button",{onClick:()=>o(c),disabled:n,className:qt("px-4 py-2.5 rounded-xl font-bold text-sm border-2",d&&"bg-[var(--duo-green)]/20 border-[var(--duo-green)] text-[var(--duo-green)]",f&&"bg-[var(--duo-red)]/20 border-[var(--duo-red)] text-[var(--duo-red)]",u&&!n&&"bg-[var(--duo-blue)]/20 border-[var(--duo-blue)] text-[var(--duo-blue)]",!u&&!d&&!f&&"bg-[var(--card)] border-[var(--border)] text-foreground shadow-[0_4px_0_var(--border)]",!n&&"active:translate-y-1 active:shadow-none"),children:c},h)})})]}),n&&i!==e.correctAnswer&&l.jsx("div",{className:"p-3 rounded-xl bg-[var(--duo-green)]/20 border-2 border-[var(--duo-green)]",children:l.jsxs("p",{className:"text-sm text-[var(--duo-green)]",children:["p n ng: ",l.jsx("strong",{children:String(e.correctAnswer)})]})})]})}function Iut({question:e,onAnswer:t,disabled:n}){var a;const[i,r]=I.useState([]),s=c=>{if(n)return;const h=i.includes(c)?i.filter(u=>u!==c):[...i,c];r(h),t(h)},o=Array.isArray(e.correctAnswer)?e.correctAnswer:[e.correctAnswer];return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-xl bg-[var(--duo-purple)]/20 border border-[var(--duo-purple)]/30",children:[l.jsx(Vk,{className:"w-4 h-4 text-[var(--duo-purple)]"}),l.jsxs("p",{className:"text-xs text-[var(--duo-purple)] font-medium",children:["Chn TT C p n ng (",o.length," p n)"]})]}),l.jsx("div",{className:"space-y-2.5",children:(a=e.options)==null?void 0:a.map((c,h)=>{const u=i.includes(c),d=o.includes(c),f=n&&d,v=n&&u&&!d,y=n&&!u&&d;return l.jsxs("button",{onClick:()=>s(c),disabled:n,className:qt("option-btn w-full p-3 text-left flex items-center gap-3",u&&!n&&"selected",f&&"correct",v&&"wrong",y&&"border-[var(--duo-yellow)] bg-[var(--duo-yellow)]/10"),children:[l.jsx("div",{className:qt("w-7 h-7 rounded-lg flex items-center justify-center shrink-0",f&&"bg-[var(--duo-green)] text-white",v&&"bg-[var(--duo-red)] text-white",y&&"bg-[var(--duo-yellow)] text-white",!n&&u&&"bg-[var(--duo-blue)] text-white",!n&&!u&&"bg-[var(--secondary)] text-[var(--muted-foreground)]"),children:f?l.jsx(Cr,{className:"w-4 h-4"}):v?l.jsx($r,{className:"w-4 h-4"}):y?l.jsx(Cr,{className:"w-4 h-4"}):u?l.jsx(Vk,{className:"w-4 h-4"}):l.jsx(eG,{className:"w-4 h-4"})}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:c})]},h)})}),n&&l.jsxs("div",{className:"text-xs text-[var(--muted-foreground)] mt-2",children:["Bn chn ng:"," ",i.filter(c=>o.includes(c)).length,"/",o.length]})]})}function Aut({question:e,onAnswer:t,disabled:n}){var o;const[i,r]=I.useState(null),s=a=>{n||(r(a),t(a))};return l.jsxs("div",{className:"space-y-4",children:[e.scenario&&l.jsx("div",{className:"card-3d p-4 bg-gradient-to-br from-[var(--duo-purple)]/10 to-[var(--duo-blue)]/10 border-[var(--duo-purple)]/30",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center shrink-0",children:l.jsx(wB,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs font-bold text-[var(--duo-purple)] mb-1",children:"TNH HUNG"}),l.jsx("p",{className:"text-sm text-foreground leading-relaxed",children:e.scenario})]})]})}),l.jsx("div",{className:"space-y-2.5",children:(o=e.options)==null?void 0:o.map((a,c)=>{const h=i===a,u=a===e.correctAnswer,d=n&&u,f=n&&h&&!u;return l.jsxs("button",{onClick:()=>s(a),disabled:n,className:qt("option-btn w-full p-3 text-left flex items-center gap-3",h&&!n&&"selected",d&&"correct",f&&"wrong"),children:[l.jsx("div",{className:qt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",d&&"bg-[var(--duo-green)] text-white",f&&"bg-[var(--duo-red)] text-white",!n&&!h&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",h&&!n&&"bg-[var(--duo-blue)] text-white"),children:d?l.jsx(Cr,{className:"w-4 h-4"}):f?l.jsx($r,{className:"w-4 h-4"}):String.fromCharCode(65+c)}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:a})]},c)})})]})}function Rut({question:e,onEnd:t}){const{submitAnswer:n,nextQuestion:i,isLoading:r,questions:s,currentIndex:o}=RT(),[a,c]=I.useState(null),[h,u]=I.useState(!1),[d,f]=I.useState(null),[v,y]=I.useState(!1),_=(o+1)/s.length*100,w=o===s.length-1,x=()=>{if(!a)return;const A=n(a);f(A),u(!0),A.correct&&Se({particleCount:60,spread:60,origin:{y:.7},colors:["#58cc02","#89e219","#ffc800"]})},C=async()=>{if(y(!0),!await i()){t();return}c(null),u(!1),f(null),y(!1)},k=()=>{var A;return l.jsx("div",{className:"space-y-2.5",children:(A=e.options)==null?void 0:A.map((M,N)=>{const T=a===M,E=M===e.correctAnswer,R=h&&E,D=h&&T&&!E;return l.jsxs("button",{onClick:()=>!h&&c(M),disabled:h,className:qt("option-btn w-full p-3 text-left flex items-center gap-3",T&&!h&&"selected",R&&"correct",D&&"wrong"),children:[l.jsx("div",{className:qt("w-7 h-7 rounded-lg flex items-center justify-center font-bold text-xs shrink-0",R&&"bg-[var(--duo-green)] text-white",D&&"bg-[var(--duo-red)] text-white",!h&&!T&&"bg-[var(--secondary)] text-[var(--muted-foreground)]",T&&!h&&"bg-[var(--duo-blue)] text-white"),children:R?l.jsx(Cr,{className:"w-4 h-4"}):D?l.jsx($r,{className:"w-4 h-4"}):String.fromCharCode(65+N)}),l.jsx("span",{className:"flex-1 text-sm text-foreground",children:M})]},N)})})},P=()=>{switch(e.type){case"matching":return l.jsx(kut,{question:e,onAnswer:c,disabled:h});case"ordering":return l.jsx(Nut,{question:e,onAnswer:c,disabled:h});case"fill_blank":return l.jsx(Sut,{question:e,onAnswer:c,disabled:h});case"multi_select":return l.jsx(Iut,{question:e,onAnswer:c,disabled:h});case"scenario":return l.jsx(Aut,{question:e,onAnswer:c,disabled:h});case"multiple_choice":case"true_false":default:return k()}};return l.jsxs("div",{className:"flex flex-col h-full px-4 py-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${_}%`}})}),l.jsx("div",{className:"flex justify-between items-center mt-2 text-sm",children:l.jsxs("span",{className:"text-[var(--muted-foreground)]",children:["Cu ",o+1,"/",s.length]})})]}),l.jsxs("div",{className:qt("inline-block px-3 py-1 rounded-full text-xs mb-3 w-fit",e.type==="multi_select"&&"bg-[var(--duo-purple)]/20 text-[var(--duo-purple)]",e.type==="scenario"&&"bg-[var(--duo-orange)]/20 text-[var(--duo-orange)]",e.type!=="multi_select"&&e.type!=="scenario"&&"bg-[var(--secondary)] text-[var(--muted-foreground)]"),children:[e.type==="multiple_choice"&&"Trc nghim",e.type==="true_false"&&"ng/Sai",e.type==="fill_blank"&&"in t",e.type==="matching"&&"Ni cp",e.type==="ordering"&&"Sp xp",e.type==="multi_select"&&"Chn nhiu",e.type==="scenario"&&"Tnh hung"]}),l.jsx("h2",{className:"text-lg font-bold text-foreground mb-5 leading-relaxed",children:e.question}),l.jsx("div",{className:"flex-1",children:P()}),l.jsx("div",{className:"h-28"}),l.jsx("div",{className:qt("fixed bottom-0 left-0 right-0 z-40 safe-bottom",h&&d?d.correct?"bg-[#d7ffb8]":"bg-[#ffdfe0]":"bg-[var(--card)] border-t-2 border-[var(--border)]"),children:h&&d?l.jsxs("div",{className:"px-4 pt-4 pb-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[d.correct?l.jsx(Cr,{className:"w-10 h-10 text-[var(--duo-green)]"}):l.jsx($r,{className:"w-10 h-10 text-[var(--duo-red)]"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:qt("font-bold text-xl",d.correct?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:d.correct?"Chnh xc!":"Sai mt ri!"}),l.jsxs("span",{className:qt("font-bold text-lg",d.correct?"text-[var(--duo-green)]":"text-[var(--duo-red)]"),children:[d.points>=0?"+":"",d.points," RP"]})]}),e.explanation&&l.jsx("p",{className:qt("text-sm mt-1 line-clamp-2",d.correct?"text-[var(--duo-green)]/70":"text-[var(--duo-red)]/70"),children:e.explanation})]})]}),l.jsx("button",{onClick:C,disabled:v,className:qt("btn-3d w-full py-3.5 text-base",d.correct?"btn-3d-green":"btn-3d-orange"),children:v?"ANG TI...":w?"XEM KT QU":"TIP TC"})]}):l.jsx("div",{className:"px-4 pt-4 pb-6",children:l.jsx("button",{onClick:x,disabled:!a||r,className:qt("btn-3d w-full py-3.5 text-base",a?"btn-3d-green":"bg-[var(--secondary)] text-[var(--muted-foreground)] cursor-not-allowed shadow-[0_5px_0_var(--border)]"),children:"KIM TRA"})})})]})}function Put({result:e,rank:t,onPlayAgain:n,onGoBack:i}){const[r,s]=I.useState(!1),[o,a]=I.useState([]),{addGems:c}=te(),h=e.correct+e.wrong>0?Math.round(e.correct/(e.correct+e.wrong)*100):0;I.useEffect(()=>{(async()=>{const f=[],v=e.correct*25;let y=0,_="";h>=90&&e.correct>=3?(y=100,_="Bonus chinh chin!"):h>=70&&e.correct>=3&&(y=60,_="Chin u tt!");const w=v+y;w>0&&(await c(w),f.push({type:"gems",amount:w,label:_||`${e.correct} cu ng`}));const x=e.correct*10;x>0&&f.push({type:"xp",amount:x}),f.length>0&&(a(f),s(!0)),h>=70&&Se({particleCount:100,spread:70,origin:{y:.6},colors:["#58cc02","#89e219","#ffc800","#ce82ff"]})})()},[h,e.correct,c]);const u=e.pointsGained>0;return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx(Gn,{isOpen:r,onClose:()=>s(!1),title:u?"Chin thng!":"Hon thnh!",subtitle:`${e.pointsGained>=0?"+":""}${e.pointsGained} RP`,rewards:o,gradientFrom:u?"var(--duo-purple)":"var(--duo-blue)",gradientTo:u?"#ec4899":"var(--duo-purple)"}),l.jsxs("div",{className:"pt-16 px-4 pb-28",children:[l.jsx("div",{className:"text-center mb-6",children:l.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Kt Qu Chinh Chin"})}),l.jsxs("div",{className:"card-3d p-6 text-center mb-6",style:{background:"linear-gradient(135deg, var(--duo-purple) 0%, #ec4899 100%)",border:"none"},children:[l.jsx("img",{src:qa(t),alt:t.rankName,className:"w-24 h-24 mx-auto mb-3 object-contain"}),l.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:t.rankName}),l.jsxs("p",{className:"text-white/80 mb-3",children:[t.points," Rank Points"]}),l.jsxs("div",{className:`inline-flex items-center gap-1 px-3 py-1.5 rounded-full ${e.pointsGained>=0?"bg-[var(--duo-green)]":"bg-[var(--duo-red)]"}`,children:[e.pointsGained>=0?l.jsx(vM,{className:"w-4 h-4 text-white"}):l.jsx(lG,{className:"w-4 h-4 text-white"}),l.jsxs("span",{className:"font-bold text-white",children:[e.pointsGained>=0?"+":"",e.pointsGained," RP"]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx(Ve,{className:"w-6 h-6 mx-auto mb-2 text-[var(--duo-yellow)]"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:e.totalScore}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"im"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsx(ji,{className:"w-6 h-6 mx-auto mb-2 text-[var(--duo-blue)]"}),l.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[h,"%"]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Chnh xc"})]}),l.jsxs("div",{className:"card-3d p-4 text-center",children:[l.jsxs("div",{className:"flex justify-center gap-2 mb-2",children:[l.jsx("span",{className:"text-[var(--duo-green)] font-bold text-lg",children:e.correct}),l.jsx("span",{className:"text-[var(--muted-foreground)]",children:"/"}),l.jsx("span",{className:"text-[var(--duo-red)] font-bold text-lg",children:e.wrong})]}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"ng/Sai"})]})]}),l.jsxs("div",{className:"card-3d p-4 mb-6",children:[l.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[l.jsx("span",{className:"text-[var(--muted-foreground)]",children:" chnh xc"}),l.jsxs("span",{className:"font-bold text-foreground",children:[h,"%"]})]}),l.jsx("div",{className:"progress-duo",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${h}%`,background:h>=80?"var(--duo-green)":h>=60?"var(--duo-yellow)":h>=40?"var(--duo-orange)":"var(--duo-red)"}})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:n,className:"btn-3d btn-3d-purple w-full py-3.5 text-base flex items-center justify-center gap-2",children:[l.jsx(yu,{className:"w-5 h-5"}),"Chi Li"]}),l.jsxs("button",{onClick:i,className:"card-3d w-full py-3.5 text-base font-bold text-foreground flex items-center justify-center gap-2",children:[l.jsx(sw,{className:"w-5 h-5"}),"V Trang Ch"]})]})]})]})}function Mut(e,t){const n=Ue.find(r=>r.id===e);if(!n)return"/Rank/Wood/rank-wood-1_NoOL_large.png";if(e==="master")return"/Rank/master.png";const i=8-t;return`/Rank/${n.folder}/rank-${e}-${i}_NoOL_large.png`}function Dut(e,t){const n=Ue.findIndex(a=>a.id===e);if(n===-1)return 0;const i=Ue[n],r=Ue[n+1];if(!r||i.id==="master")return i.minScore;const s=(r.minScore-i.minScore)/i.tiers,o=i.tiers-t;return Math.floor(i.minScore+o*s)}function Lut(){const e=[],t=Ue.filter(r=>r.id!=="master"),n={wood:100,stone:150,bronze:250,silver:400,gold:600,platinum:900,amethyst:1300,onyx:2e3};if(t.forEach(r=>{const s=n[r.id]||100;for(let o=7;o>=1;o--){const a=Dut(r.id,o),c=1+(8-o)*.15,h=Math.round(s*c);e.push({id:`${r.id}_${o}`,rankId:r.id,rankName:r.name,tier:o,minPoints:a,gems:h,label:`${r.name} ${o}`,rankFolder:r.folder})}}),Ue.find(r=>r.id==="master"))for(let r=4e3;r<=1e4;r+=100){const s=r,o=5e3+Math.floor((r-4e3)/100)*100;e.push({id:`master_${s}`,rankId:"master",rankName:"Huyn Thoi",tier:0,minPoints:s,gems:o,label:`Huyn Thoi ${s} RP`,isMaster:!0,masterMilestone:s})}return e}const Dy=Lut();function Vut({isOpen:e,onClose:t,userRankPoints:n}){const{user:i,addGems:r}=te(),[s,o]=I.useState([]),[a,c]=I.useState(!1),[h,u]=I.useState(!1),[d,f]=I.useState(null);if(I.useEffect(()=>{i!=null&&i.claimedRankRewards&&o(i.claimedRankRewards)},[i==null?void 0:i.claimedRankRewards]),!e)return null;const v=k=>s.includes(k.id)?"claimed":n>=k.minPoints?"available":"locked",y=async k=>{if(!(!(i!=null&&i.oderId)||a)&&v(k)==="available"){c(!0);try{const P=[...s,k.id],A=Dt(kt,"users",i.oderId);await Kt(A,{claimedRankRewards:P}),await r(k.gems),o(P),f({gems:k.gems,label:k.label}),u(!0),Se({particleCount:80,spread:60,origin:{y:.6},colors:["#58cc02","#ffc800","#ce82ff"]})}catch(P){console.error("Error claiming rank reward:",P)}finally{c(!1)}}},_=async()=>{if(!(i!=null&&i.oderId)||a)return;const k=Dy.filter(P=>v(P)==="available");if(k.length!==0){c(!0);try{const P=k.map(T=>T.id),A=k.reduce((T,E)=>T+E.gems,0),M=[...s,...P],N=Dt(kt,"users",i.oderId);await Kt(N,{claimedRankRewards:M}),await r(A),o(M),f({gems:A,label:`${k.length} phn thng`}),u(!0),Se({particleCount:150,spread:100,origin:{y:.5},colors:["#58cc02","#ffc800","#ce82ff","#1cb0f6"]})}catch(P){console.error("Error claiming all rank rewards:",P)}finally{c(!1)}}},w=Dy.filter(k=>v(k)==="available").length,x=s.length,C=ps(n);return l.jsxs(l.Fragment,{children:[l.jsx(Gn,{isOpen:h&&!!d,onClose:()=>u(!1),title:"Nhn qu thnh cng!",subtitle:(d==null?void 0:d.label)||"",rewards:d?[{type:"gems",amount:d.gems}]:[],gradientFrom:"var(--duo-purple)",gradientTo:"var(--duo-blue)"}),l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 backdrop-blur-sm",onClick:t,children:l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-b from-[var(--card)] to-[var(--background)] rounded-t-[2rem] max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 shadow-2xl",onClick:k=>k.stopPropagation(),children:[l.jsx("div",{className:"flex justify-center pt-4 pb-2",children:l.jsx("div",{className:"w-12 h-1.5 bg-[var(--border)] rounded-full"})}),l.jsx("div",{className:"px-4 pb-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:t,className:"w-9 h-9 rounded-xl flex items-center justify-center bg-[var(--secondary)] border-2 border-[var(--border)] active:scale-95 transition-transform shrink-0",children:l.jsx(Fr,{className:"w-4 h-4 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-center",children:[l.jsxs("h2",{className:"font-bold text-base flex items-center justify-center gap-1.5",children:[l.jsx(Ve,{className:"w-4 h-4 text-[var(--duo-yellow)] shrink-0"}),l.jsx("span",{className:"truncate",children:"Qu Rank"})]}),l.jsx("p",{className:"text-[10px] text-[var(--muted-foreground)] truncate",children:"Nhn qu khi t mc"})]}),w>0?l.jsxs("button",{onClick:_,disabled:a,className:"btn-3d btn-3d-green px-2 py-1 rounded-lg text-xs font-bold text-white flex items-center gap-1 shrink-0",children:[l.jsx(Be,{className:"w-3.5 h-3.5"}),"Nhn (",w,")"]}):l.jsx("div",{className:"w-9"})]})}),l.jsx("div",{className:"px-5 pb-4",children:l.jsx("div",{className:"bg-[var(--secondary)]/50 rounded-2xl p-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:qa(C),alt:C.rankName,className:"w-12 h-12 object-contain"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-bold text-foreground",children:C.rankName}),l.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:[n," Rank Points"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:" nhn"}),l.jsx("p",{className:"font-bold text-[var(--duo-green)]",children:x})]}),w>0&&l.jsx("div",{className:"bg-[var(--duo-red)] px-2 py-1 rounded-full",children:l.jsx("span",{className:"text-white text-xs font-bold",children:w})})]})})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 pb-8",children:l.jsx("div",{className:"space-y-2",children:Dy.map(k=>{const P=v(k),A=k.isMaster,M=Mut(k.rankId,k.tier);return l.jsxs("div",{className:`card-3d p-3 flex items-center gap-3 ${P==="available"?"border-[var(--duo-green)] border-2":P==="claimed"?"opacity-70":"opacity-50"}`,children:[l.jsx("div",{className:"w-12 h-12 flex-shrink-0 flex items-center justify-center",children:l.jsx("img",{src:M,alt:k.label,className:`w-10 h-10 object-contain ${P==="locked"?"grayscale":""}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:`font-bold text-sm truncate ${P==="claimed"?"text-[var(--muted-foreground)]":"text-foreground"}`,children:k.label}),l.jsxs("p",{className:"text-xs text-[var(--muted-foreground)]",children:[k.minPoints," RP"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs("span",{className:`font-bold ${A?"text-[var(--duo-yellow)]":"text-[var(--duo-blue)]"}`,children:["+",k.gems]}),l.jsx("img",{src:"/AppAssets/BlueDiamond.png",alt:"gem",className:"w-4 h-4"})]}),P==="claimed"?l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--duo-green)] flex items-center justify-center",children:l.jsx(Rn,{className:"w-4 h-4 text-white"})}):P==="available"?l.jsx("button",{onClick:()=>y(k),disabled:a,className:"btn-3d btn-3d-green px-3 py-1.5 text-xs",children:"Nhn"}):l.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--muted-foreground)]/30 flex items-center justify-center",children:l.jsx(Xu,{className:"w-3 h-3 text-[var(--muted-foreground)]"})})]},k.id)})})})]})})]})}function qut(){var Y;const e=we(),{user:t,initUser:n}=te(),{isActive:i,isLoading:r,questions:s,currentIndex:o,rank:a,rankPoints:c,correctCount:h,wrongCount:u,startConquest:d,endConquest:f,resetConquest:v,loadConquestStats:y}=RT(),[_,w]=I.useState(!1),[x,C]=I.useState(null),[k,P]=I.useState(null),[A,M]=I.useState(!0),[N,T]=I.useState(!1);I.useEffect(()=>{(async()=>{if(t!=null&&t.oderId){M(!0);const U=await y(t.oderId);P(U),M(!1)}})()},[t==null?void 0:t.oderId,y]);const E=(k==null?void 0:k.rankPoints)??((Y=t==null?void 0:t.conquestStats)==null?void 0:Y.rankPoints)??(t==null?void 0:t.totalScore)??0,R=ps(E),D=async()=>{t!=null&&t.oderId&&await d(t.oderId,E)},j=async()=>{w(!0);const W=await f();if(C(W),await n(),t!=null&&t.oderId){const U=await y(t.oderId);P(U)}},L=()=>{w(!1),C(null),v()};if(_)return x?l.jsx(Put,{result:x,rank:a,onPlayAgain:L,onGoBack:()=>e("/")}):l.jsx(se,{className:"bg-background min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(qi,{className:"w-12 h-12 animate-spin text-[var(--duo-purple)] mx-auto mb-4"}),l.jsx("p",{className:"text-foreground font-bold",children:"ang tnh kt qu..."})]})});if(i&&s.length>0)return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-16 pb-2 px-4 bg-background sticky top-0 z-10",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("button",{onClick:j,className:"w-10 h-10 rounded-xl bg-[var(--secondary)] flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-[var(--muted-foreground)]"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--duo-green)]",children:[l.jsx("span",{className:"text-sm",children:""}),l.jsx("span",{className:"font-bold",children:h})]}),l.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--duo-red)]",children:[l.jsx("span",{className:"text-sm",children:""}),l.jsx("span",{className:"font-bold",children:u})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("img",{src:qa(a),alt:a.rankName,className:"w-8 h-8 object-contain"}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:"text-xs font-bold text-foreground",children:[c," RP"]})})]})]})}),l.jsx("div",{style:{minHeight:"calc(100vh - 100px)"},children:r?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-3",children:[l.jsx(qi,{className:"w-8 h-8 animate-spin text-[var(--duo-purple)]"}),l.jsx("span",{className:"text-foreground font-bold",children:"ang to cu hi..."})]}):l.jsx(Rut,{question:s[o],onEnd:j})})]});const lt=()=>{const W=Ue.findIndex(q=>q.id===R.rankId);if(W===-1||W>=Ue.length-1)return 100;const U=Ue[W].minScore,Q=Ue[W+1].minScore,F=(E-U)/(Q-U)*100;return Math.min(100,Math.max(0,F))},dt=()=>{const W=Ue.findIndex(U=>U.id===R.rankId);return W===-1||W>=Ue.length-1?"Max Rank":Ue[W+1].name};return l.jsxs(se,{className:"bg-background min-h-screen",children:[l.jsx("div",{className:"pt-16 pb-3 px-4 bg-[var(--card)] border-b-2 border-[var(--border)]",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:()=>e("/"),className:"btn-back-3d w-10 h-10 flex items-center justify-center",children:l.jsx(Fr,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"font-bold text-xl text-foreground",children:"Chinh Chin"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"u tr vi AI - Leo rank"})]})]})}),l.jsx("div",{className:"px-4 py-4 pb-28 overflow-y-auto",style:{height:"calc(100vh - 100px)"},children:A?l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-3",children:[l.jsx(qi,{className:"w-8 h-8 animate-spin text-[var(--duo-purple)]"}),l.jsx("span",{className:"text-foreground font-bold",children:"ang ti d liu..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"card-3d p-6 text-center mb-4",children:[l.jsx("img",{src:qa(R),alt:R.rankName,className:"w-24 h-24 mx-auto mb-4 object-contain"}),l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-1",children:R.rankName}),l.jsxs("p",{className:"text-[var(--muted-foreground)] mb-4",children:[E," Rank Points"]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-xs text-[var(--muted-foreground)] mb-1",children:[l.jsx("span",{children:R.rankName}),l.jsx("span",{children:dt()})]}),l.jsx("div",{className:"progress-duo h-2.5",children:l.jsx("div",{className:"progress-duo-fill",style:{width:`${lt()}%`}})})]}),k&&k.totalConquests>0&&l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4 text-xs",children:[l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Tng trn"}),l.jsx("p",{className:"font-bold text-foreground",children:k.totalConquests})]}),l.jsxs("div",{className:"bg-[var(--secondary)] rounded-lg p-2",children:[l.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Chui thng tt nht"}),l.jsx("p",{className:"font-bold text-foreground",children:k.bestWinStreak})]})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:Ue.slice(0,8).map(W=>l.jsx("div",{className:`h-11 rounded-xl flex items-center justify-center ${W.id===R.rankId?"bg-[var(--duo-purple)]/20 border-2 border-[var(--duo-purple)]":"bg-[var(--secondary)] border-2 border-transparent"}`,children:l.jsx("p",{className:"text-[11px] font-bold text-foreground",children:W.shortName})},W.id))}),l.jsxs("button",{onClick:()=>T(!0),className:"w-full btn-3d btn-3d-yellow py-3 flex items-center justify-center gap-2",children:[l.jsx(Be,{className:"w-5 h-5"}),l.jsx("span",{children:"Xem Qu Rank"})]})]}),l.jsxs("div",{className:"space-y-2.5 mb-4",children:[l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-purple)]/20 flex items-center justify-center",children:l.jsx(Ci,{className:"w-5 h-5 text-[var(--duo-purple)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"AI To "}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Cu hi c AI to da trn rank ca bn"})]})]}),l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-yellow)]/20 flex items-center justify-center",children:l.jsx(Ve,{className:"w-5 h-5 text-[var(--duo-yellow)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"Leo Rank"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Tr li ng +RP, sai -RP. Rank cng cao cng kh!"})]})]}),l.jsxs("div",{className:"card-3d p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--duo-blue)]/20 flex items-center justify-center",children:l.jsx(Vr,{className:"w-5 h-5 text-[var(--duo-blue)]"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-foreground",children:"a Dng Cu Hi"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)]",children:"Trc nghim, in t, ni cp, sp xp..."})]})]})]}),l.jsx("button",{onClick:D,disabled:r||!(t!=null&&t.oderId),className:`btn-3d w-full py-4 text-lg flex items-center justify-center gap-2 ${r?"bg-[var(--secondary)] text-[var(--muted-foreground)] shadow-[0_5px_0_var(--border)] cursor-not-allowed":"btn-3d-purple"}`,children:r?l.jsxs(l.Fragment,{children:[l.jsx(qi,{className:"w-5 h-5 animate-spin"}),"ang chun b..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Ci,{className:"w-5 h-5"}),"BT U CHINH CHIN"]})})]})}),l.jsx(Vut,{isOpen:N,onClose:()=>T(!1),userRankPoints:E})]})}function yA(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function jut(...e){return t=>{let n=!1;const i=e.map(r=>{const s=yA(r,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():yA(e[r],null)}}}}var Fut=Symbol.for("react.lazy"),Tm=w3[" use ".trim().toString()];function Uut(e){return typeof e=="object"&&e!==null&&"then"in e}function O4(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===Fut&&"_payload"in e&&Uut(e._payload)}function Out(e){const t=Gut(e),n=I.forwardRef((i,r)=>{let{children:s,...o}=i;O4(s)&&typeof Tm=="function"&&(s=Tm(s._payload));const a=I.Children.toArray(s),c=a.find($ut);if(c){const h=c.props.children,u=a.map(d=>d===c?I.Children.count(h)>1?I.Children.only(null):I.isValidElement(h)?h.props.children:null:d);return l.jsx(t,{...o,ref:r,children:I.isValidElement(h)?I.cloneElement(h,void 0,u):null})}return l.jsx(t,{...o,ref:r,children:s})});return n.displayName=`${e}.Slot`,n}var But=Out("Slot");function Gut(e){const t=I.forwardRef((n,i)=>{let{children:r,...s}=n;if(O4(r)&&typeof Tm=="function"&&(r=Tm(r._payload)),I.isValidElement(r)){const o=Kut(r),a=zut(s,r.props);return r.type!==I.Fragment&&(a.ref=i?jut(i,o):o),I.cloneElement(r,a)}return I.Children.count(r)>1?I.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Hut=Symbol("radix.slottable");function $ut(e){return I.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Hut}function zut(e,t){const n={...t};for(const i in t){const r=e[i],s=t[i];/^on[A-Z]/.test(i)?r&&s?n[i]=(...a)=>{const c=s(...a);return r(...a),c}:r&&(n[i]=r):i==="style"?n[i]={...r,...s}:i==="className"&&(n[i]=[r,s].filter(Boolean).join(" "))}return{...e,...n}}function Kut(e){var i,r;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}const xA=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,_A=xM,Wut=(e,t)=>n=>{var i;if((t==null?void 0:t.variants)==null)return _A(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:s}=t,o=Object.keys(r).map(h=>{const u=n==null?void 0:n[h],d=s==null?void 0:s[h];if(u===null)return null;const f=xA(u)||xA(d);return r[h][f]}),a=n&&Object.entries(n).reduce((h,u)=>{let[d,f]=u;return f===void 0||(h[d]=f),h},{}),c=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((h,u)=>{let{class:d,className:f,...v}=u;return Object.entries(v).every(y=>{let[_,w]=y;return Array.isArray(w)?w.includes({...s,...a}[_]):{...s,...a}[_]===w})?[...h,d,f]:h},[]);return _A(e,o,c,n==null?void 0:n.class,n==null?void 0:n.className)},Qut=Wut("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function wA({className:e,variant:t,size:n,asChild:i=!1,...r}){const s=i?But:"button";return l.jsx(s,{"data-slot":"button",className:qt(Qut({variant:t,size:n,className:e})),...r})}function Yut({className:e,...t}){return l.jsx("div",{"data-slot":"card",className:qt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Jut({className:e,...t}){return l.jsx("div",{"data-slot":"card-header",className:qt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Xut({className:e,...t}){return l.jsx("div",{"data-slot":"card-title",className:qt("leading-none font-semibold",e),...t})}function Zut({className:e,...t}){return l.jsx("div",{"data-slot":"card-content",className:qt("px-6",e),...t})}function tdt(){const[e,t]=I.useState("idle"),[n,i]=I.useState(""),[r,s]=I.useState(null),o=async()=>{t("loading"),i("ang kt ni Firebase...");try{const h=(await Ia(Wr(kt,"test"))).docs.map(u=>({id:u.id,...u.data()}));t("success"),i(`Kt ni thnh cng! Tm thy ${h.length} documents.`),s(h)}catch(c){t("error"),i(`Li: ${c.message}`),s(null)}},a=async()=>{t("loading"),i("ang thm d liu test...");try{const c=await vp(Wr(kt,"test"),{message:"Hello from Quiz App!",timestamp:DD(),random:Math.random()});t("success"),i(`Thm d liu thnh cng! ID: ${c.id}`),s({id:c.id})}catch(c){t("error"),i(`Li: ${c.message}`)}};return l.jsx(se,{className:"bg-background p-4",children:l.jsxs(Yut,{children:[l.jsx(Jut,{children:l.jsxs(Xut,{className:"flex items-center gap-2",children:[l.jsx(zr,{className:"h-5 w-5 text-orange-500"}),"Test Firebase Connection"]})}),l.jsxs(Zut,{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(wA,{onClick:o,disabled:e==="loading",children:[e==="loading"&&l.jsx(qi,{className:"mr-2 h-4 w-4 animate-spin"}),"Test Connection"]}),l.jsx(wA,{variant:"outline",onClick:a,disabled:e==="loading",children:"Insert Test Data"})]}),e!=="idle"&&l.jsxs("div",{className:"rounded-lg border p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e==="loading"&&l.jsx(qi,{className:"h-5 w-5 animate-spin text-blue-500"}),e==="success"&&l.jsx(ai,{className:"h-5 w-5 text-green-500"}),e==="error"&&l.jsx($r,{className:"h-5 w-5 text-red-500"}),l.jsx("span",{className:e==="success"?"text-green-600":e==="error"?"text-red-600":"",children:n})]}),r!==null&&l.jsx("pre",{className:"mt-2 rounded bg-muted p-2 text-xs overflow-auto",children:JSON.stringify(r,null,2)})]}),l.jsxs("div",{className:"rounded-lg bg-orange-50 dark:bg-orange-950 p-4 text-sm",children:[l.jsx("p",{className:"font-medium text-orange-800 dark:text-orange-200 mb-2",children:" Firebase Firestore  c cu hnh!"}),l.jsx("p",{className:"text-orange-700 dark:text-orange-300",children:"Nh bt Firestore trong Firebase Console v set rules cho php read/write."})]})]})]})})}const edt=[{path:"/",icon:sw,label:"Trang ch"},{path:"/leaderboard",icon:Ve,label:"Xp hng"},{path:"/gacha",icon:Xt,label:"Gacha"},{path:"/events",icon:vu,label:"S kin"},{path:"/settings",icon:xl,label:"Ti"}];function ndt(){const e=Ds(),t=we(),{isActive:n}=RT(),{activeFloor:i}=Jb();return e.pathname==="/quiz"||e.pathname==="/conquest"&&n||e.pathname.startsWith("/gacha/")||e.pathname==="/event-tower"&&i?null:l.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",children:l.jsx("div",{className:"bg-[var(--card)] border-t-2 border-[var(--border)] pb-[env(safe-area-inset-bottom)]",children:l.jsx("div",{className:"flex items-center justify-around py-1 px-1",children:edt.map(r=>{const s=e.pathname===r.path,o=r.icon;return l.jsxs("button",{onClick:()=>t(r.path),className:qt("flex-1 flex flex-col items-center gap-0.5 py-2 rounded-xl min-w-0",s?"text-[var(--duo-green)]":"text-[var(--muted-foreground)]"),children:[l.jsx("div",{className:qt("p-1.5 rounded-xl",s&&"bg-[var(--duo-green)]/20"),children:l.jsx(o,{className:"w-5 h-5"})}),l.jsx("span",{className:"text-[10px] font-semibold whitespace-nowrap truncate max-w-full px-1",children:r.label})]},r.path)})})})})}const idt=()=>{const{theme:e,setTheme:t}=ij(),{user:n,updateUsername:i}=te(),[r,s]=I.useState(!1),[o,a]=I.useState(""),[c,h]=I.useState("idle");I.useEffect(()=>{if(!localStorage.getItem("quiz-theme")){const d=window.matchMedia("(prefers-color-scheme: dark)").matches;t(d?"dark":"light")}},[t]),I.useEffect(()=>{document.documentElement.setAttribute("data-theme",e),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e)},[e]),I.useEffect(()=>{if((n==null?void 0:n.odername)==="Ngi chi"){const d=setTimeout(()=>{s(!0)},500);return()=>clearTimeout(d)}},[n==null?void 0:n.odername]);const u=async()=>{if(!o.trim()||o.trim().length<2)return;await i(o.trim())?(h("success"),setTimeout(()=>{s(!1),a(""),h("idle")},1e3)):h("error")};return l.jsxs("div",{className:e,children:[r&&l.jsx("div",{className:"fixed inset-0 bg-black/70 z-[100] flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-[var(--card)] rounded-3xl p-6 max-w-sm w-full",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-[var(--duo-green)]/20 flex items-center justify-center",children:l.jsx(Px,{className:"w-8 h-8 text-[var(--duo-green)]"})}),l.jsx("h2",{className:"text-xl font-bold text-foreground text-center mb-2",children:"Cho mng bn! "}),l.jsx("p",{className:"text-sm text-[var(--muted-foreground)] text-center mb-4",children:"Hy t tn cho mnh  bt u nh!"}),l.jsx("input",{type:"text",value:o,onChange:d=>{a(d.target.value),h("idle")},placeholder:"Nhp tn ca bn",maxLength:20,autoFocus:!0,className:"w-full p-3 rounded-xl bg-[var(--secondary)] text-foreground text-center font-bold text-lg mb-3"}),c==="success"&&l.jsx("p",{className:"text-[var(--duo-green)] text-center text-sm mb-3",children:"t tn thnh cng!"}),c==="error"&&l.jsx("p",{className:"text-[var(--duo-red)] text-center text-sm mb-3",children:"Khng th t tn. Vui lng th li."}),l.jsx("button",{onClick:u,disabled:!o.trim()||o.trim().length<2,className:"w-full btn-3d btn-3d-green py-3 disabled:opacity-50",children:"Bt u chi!"}),l.jsx("p",{className:"text-xs text-[var(--muted-foreground)] text-center mt-3",children:"Tn t 2-20 k t"})]})}),l.jsxs(IU,{children:[l.jsx(Me,{path:"/",element:l.jsx(wX,{})}),l.jsx(Me,{path:"/quiz",element:l.jsx(NX,{})}),l.jsx(Me,{path:"/leaderboard",element:l.jsx(oot,{})}),l.jsx(Me,{path:"/achievements",element:l.jsx(dot,{})}),l.jsx(Me,{path:"/quests",element:l.jsx(got,{})}),l.jsx(Me,{path:"/settings",element:l.jsx(fot,{})}),l.jsx(Me,{path:"/stats",element:l.jsx(mot,{})}),l.jsx(Me,{path:"/mailbox",element:l.jsx(pot,{})}),l.jsx(Me,{path:"/shop",element:l.jsx(vot,{})}),l.jsx(Me,{path:"/events",element:l.jsx(_ot,{})}),l.jsx(Me,{path:"/event-login-7days",element:l.jsx(wot,{})}),l.jsx(Me,{path:"/event-level-rewards",element:l.jsx(bot,{})}),l.jsx(Me,{path:"/event-tower",element:l.jsx(Cot,{})}),l.jsx(Me,{path:"/gacha",element:l.jsx(Pot,{})}),l.jsx(Me,{path:"/gacha/:id",element:l.jsx(yut,{})}),l.jsx(Me,{path:"/customize",element:l.jsx(xut,{})}),l.jsx(Me,{path:"/card-inventory",element:l.jsx(_ut,{})}),l.jsx(Me,{path:"/profile/:id",element:l.jsx(wut,{})}),l.jsx(Me,{path:"/battle",element:l.jsx(Tut,{})}),l.jsx(Me,{path:"/conquest",element:l.jsx(qut,{})}),l.jsx(Me,{path:"/test-firebase",element:l.jsx(tdt,{})})]}),l.jsx(ndt,{}),l.jsx(VO,{position:"top-center",richColors:!0})]})},bA=document.getElementById("root");bA&&qP(bA).render(l.jsx(it.StrictMode,{children:l.jsx(tO,{children:l.jsx(idt,{})})}));
